<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cortex XDR Fundamentals | Cortex XDR</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link active" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Cortex XDR Pages</div>
                <ul class="sidebar-nav">
                                        <li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="agent-deployment.html" class="sidebar-nav-link">
                            <i class="fas fa-download"></i>
                            <span>Agent Deployment</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-collection.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Collection</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-reference.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>XQL Reference</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="bioc-rules.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>BIOC Rules</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="analytics.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-line"></i>
                            <span>Analytics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="causality.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>Causality Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-management.html" class="sidebar-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Incident Management</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="response-actions.html" class="sidebar-nav-link">
                            <i class="fas fa-bolt"></i>
                            <span>Response Actions</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-skull-crossbones"></i>
                            <span>Threat Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="reporting.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Reporting</span>
                        </a>
                    </li>
<li class="sidebar-nav-item">
                        <a href="fundamentals.html" class="sidebar-nav-link active">
                            <i class="fas fa-code"></i>
                            <span>Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-management.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Management</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="response-actions.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>Response Actions</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-hunting.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Xql Hunting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-reference.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Xql Reference</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Cortex XDR</a>
                    <span class="separator">/</span>
                    <span class="current">Fundamentals</span>
                </div>

                <h1><i class="fas fa-shield-alt"></i> Cortex XDR Fundamentals</h1>
                <p class="lead">Cortex XDR by Palo Alto Networks is an extended detection and response platform that integrates endpoint, network, and cloud data for comprehensive threat detection and response.</p>

                <!-- XDR Overview -->
                <h2><i class="fas fa-info-circle"></i> What is Cortex XDR?</h2>
                <div class="config-section">
                    <p>Cortex XDR provides:</p>
                    <ul style="color: #8b949e;">
                        <li><strong>Endpoint Protection:</strong> Next-gen antivirus and behavioral protection</li>
                        <li><strong>EDR:</strong> Endpoint detection and response</li>
                        <li><strong>XDR:</strong> Cross-data source detection (endpoint + network + cloud)</li>
                        <li><strong>Investigation:</strong> Causality analysis and threat hunting</li>
                        <li><strong>Response:</strong> Automated and manual remediation</li>
                    </ul>

                    <h4>Cortex XDR Tiers</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Tier</th><th>Capabilities</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Prevent</strong></td>
                                <td>Endpoint protection, malware prevention</td>
                            </tr>
                            <tr>
                                <td><strong>Pro per Endpoint</strong></td>
                                <td>Prevent + EDR, behavioral analytics</td>
                            </tr>
                            <tr>
                                <td><strong>Pro per TB</strong></td>
                                <td>Full XDR with third-party data ingestion</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Console Navigation -->
                <h2><i class="fas fa-compass"></i> Console Navigation</h2>
                <div class="config-section">
                    <div class="arch-diagram">Cortex XDR Console Structure:

Dashboard
├── Security Overview
├── Threat Intelligence
└── Custom Widgets

Incident Response
├── Incidents
├── Alerts
├── Starred Incidents
└── Exclusions

Investigation
├── Query Center
├── Causality View
├── Timeline
└── IOC Matching

Response
├── Action Center
├── Live Terminal
├── Scripts Library
└── Response Actions

Assets
├── Endpoints
├── Endpoint Groups
└── Host Insights

Rules
├── BIOC Rules
├── Correlation Rules
├── IOC Rules
└── Exceptions

Reports
└── Scheduled Reports

Settings
├── Configurations
├── Integrations
└── User Management</div>
                </div>

                <!-- Endpoints -->
                <h2><i class="fas fa-desktop"></i> Endpoint Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Assets → Endpoints</span></p>

                    <h4>Endpoint Information</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Field</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Endpoint Name</strong></td><td>Device hostname</td></tr>
                            <tr><td><strong>Endpoint Status</strong></td><td>Connected, Disconnected, Uninstalled</td></tr>
                            <tr><td><strong>Agent Version</strong></td><td>Installed agent version</td></tr>
                            <tr><td><strong>OS Type</strong></td><td>Windows, macOS, Linux</td></tr>
                            <tr><td><strong>Last Seen</strong></td><td>Last agent communication</td></tr>
                            <tr><td><strong>Content Version</strong></td><td>Protection content version</td></tr>
                            <tr><td><strong>Isolation Status</strong></td><td>Isolated or Not Isolated</td></tr>
                        </tbody>
                    </table>

                    <h4>Endpoint Details Page</h4>
                    <div class="arch-diagram">Endpoint Details Sections:

Overview:
- Basic endpoint information
- Agent health status
- Protection status

Alerts:
- Alerts on this endpoint
- Alert timeline

Incidents:
- Incidents involving endpoint
- Incident status

Security Events:
- Recent security events
- Process executions
- Network connections

Vulnerabilities:
- Host Insights findings
- Security recommendations

Actions:
- Isolate/Unisolate
- Scan endpoint
- Retrieve files
- Live Terminal</div>
                </div>

                <!-- Alerts -->
                <h2><i class="fas fa-bell"></i> Alert Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Incident Response → Alerts</span></p>

                    <h4>Alert Severity</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Severity</th><th>Description</th><th>Action</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Critical</strong></td>
                                <td>Immediate threat, active attack</td>
                                <td>Immediate response</td>
                            </tr>
                            <tr>
                                <td><strong>High</strong></td>
                                <td>Significant threat detected</td>
                                <td>Priority investigation</td>
                            </tr>
                            <tr>
                                <td><strong>Medium</strong></td>
                                <td>Suspicious activity</td>
                                <td>Standard triage</td>
                            </tr>
                            <tr>
                                <td><strong>Low</strong></td>
                                <td>Minor security event</td>
                                <td>Review as time permits</td>
                            </tr>
                            <tr>
                                <td><strong>Informational</strong></td>
                                <td>Security-relevant information</td>
                                <td>Awareness only</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Alert Sources</h4>
                    <div class="arch-diagram">Alert Sources in Cortex XDR:

XDR Analytics:
- Behavioral detections
- Machine learning models
- Anomaly detection

BIOC (Behavioral IOC):
- Built-in behavioral rules
- Palo Alto threat research

IOC Matching:
- Hash blocklist
- IP/Domain blocklist
- Custom indicators

Correlation Rules:
- Custom XQL-based rules
- Multi-event correlation

Third-Party:
- Ingested alerts from other tools
- Network firewall alerts
- Cloud security alerts</div>
                </div>

                <!-- Incidents -->
                <h2><i class="fas fa-folder-open"></i> Incident Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Incident Response → Incidents</span></p>

                    <h4>Incident Structure</h4>
                    <div class="arch-diagram">Incident Components:

Incident Overview:
├── Incident ID and Name
├── Severity (Critical/High/Medium/Low)
├── Status (New/Under Investigation/Resolved)
├── Assigned analyst
├── Creation time
└── Related alerts count

Alerts Tab:
├── All related alerts
├── Alert timeline
└── Alert details

Causality View:
├── Process tree visualization
├── Parent-child relationships
├── Network connections
├── File operations
└── Registry changes

Timeline:
├── Chronological events
├── All entity activities
└── Pivoting capabilities

Key Artifacts:
├── Files (hashes, paths)
├── Processes
├── Network connections
├── Users
└── Registry entries</div>

                    <h4>Incident Status Workflow</h4>
                    <div class="arch-diagram">Status Transitions:

NEW
 │  Incident created, awaiting triage
 ▼
UNDER_INVESTIGATION
 │  Analyst actively working
 ▼
RESOLVED
 ├── Resolved - True Positive
 ├── Resolved - False Positive
 ├── Resolved - Duplicate
 └── Resolved - Other</div>
                </div>

                <!-- Causality View -->
                <h2><i class="fas fa-project-diagram"></i> Causality View</h2>
                <div class="config-section">
                    <p>The Causality View shows the attack chain and relationships between entities.</p>

                    <h4>Causality Components</h4>
                    <div class="arch-diagram">Causality Chain Elements:

CGO (Causality Group Owner):
└── The root process that started the chain
    Usually explorer.exe for user-initiated activity

Process Nodes:
├── Process name and PID
├── Command line
├── User context
├── Execution time
└── Connections to other nodes

Relationship Types:
├── Created Process (parent-child)
├── Network Connection
├── File Operation
├── Registry Operation
└── Module Load

Investigation Actions:
├── Expand node for details
├── Pivot to related entities
├── View in Query Center
└── Take response action</div>

                    <h4>Reading Causality Chain</h4>
                    <div class="arch-diagram">Example Attack Chain:

explorer.exe (CGO - User shell)
    │
    └── outlook.exe (Email client)
            │
            └── WINWORD.EXE (Opened attachment)
                    │
                    └── cmd.exe (Macro executed)
                            │
                            └── powershell.exe (Download cradle)
                                    │
                                    ├── Network: evil.com:443
                                    └── File: C:\Users\...\malware.exe
                                            │
                                            └── malware.exe (Payload)
                                                    │
                                                    ├── Registry: Run key
                                                    └── Network: C2 server

Key Questions:
1. How did the attack start? (Email attachment)
2. What technique was used? (Macro → PowerShell)
3. What persistence was established? (Registry)
4. Is there C2 communication? (Yes, C2 server)</div>
                </div>

                <!-- Query Center -->
                <h2><i class="fas fa-search"></i> Query Center</h2>
                <div class="config-section">
                    <p><span class="console-path">Investigation → Query Center</span></p>
                    <p>Query Center uses XQL (XDR Query Language) to search telemetry data.</p>

                    <h4>XQL Basics</h4>
                    <div class="arch-diagram">Basic XQL Structure:

dataset = xdr_data
| filter [conditions]
| fields [columns to display]
| sort [field] [asc/desc]
| limit [number]

Example Queries:

// Find all PowerShell executions
dataset = xdr_data
| filter event_type = PROCESS and action_process_image_name = "powershell.exe"
| fields agent_hostname, actor_effective_username, action_process_image_command_line
| limit 100

// Find network connections to specific IP
dataset = xdr_data
| filter event_type = NETWORK and action_remote_ip = "1.2.3.4"
| fields agent_hostname, actor_process_image_name, action_remote_port

// Find file creations in temp folder
dataset = xdr_data
| filter event_type = FILE and action_file_path contains "\\Temp\\"
| fields agent_hostname, action_file_name, action_file_path</div>

                    <h4>Key Datasets</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Dataset</th><th>Data</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>xdr_data</strong></td><td>All endpoint telemetry</td></tr>
                            <tr><td><strong>xdr_alerts</strong></td><td>Alert data</td></tr>
                            <tr><td><strong>cloud_audit_logs</strong></td><td>Cloud activity logs</td></tr>
                            <tr><td><strong>firewall_data</strong></td><td>Network firewall logs</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Response Actions -->
                <h2><i class="fas fa-shield-alt"></i> Response Actions</h2>
                <div class="config-section">
                    <p><span class="console-path">Response → Action Center</span></p>

                    <h4>Endpoint Actions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Action</th><th>Description</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Isolate Endpoint</strong></td>
                                <td>Block all network except XDR</td>
                                <td>Active compromise</td>
                            </tr>
                            <tr>
                                <td><strong>Kill Process</strong></td>
                                <td>Terminate running process</td>
                                <td>Stop malicious process</td>
                            </tr>
                            <tr>
                                <td><strong>Quarantine File</strong></td>
                                <td>Move file to quarantine</td>
                                <td>Contain malware</td>
                            </tr>
                            <tr>
                                <td><strong>Block Hash</strong></td>
                                <td>Add to global blocklist</td>
                                <td>Prevent execution</td>
                            </tr>
                            <tr>
                                <td><strong>Retrieve File</strong></td>
                                <td>Download file for analysis</td>
                                <td>Malware analysis</td>
                            </tr>
                            <tr>
                                <td><strong>Run Script</strong></td>
                                <td>Execute remediation script</td>
                                <td>Custom remediation</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Live Terminal</h4>
                    <div class="arch-diagram">Live Terminal Commands:

Navigation:
- cd [path] - Change directory
- dir / ls - List directory
- pwd - Current directory

Investigation:
- processes - List running processes
- netstat - Network connections
- reg query - Registry query
- sc query - Service status

File Operations:
- get [file] - Download file
- put [file] - Upload file
- delete [file] - Delete file

Remediation:
- kill [pid] - Kill process
- remediate [file] - Quarantine file
- script [name] - Run script</div>
                </div>

                <!-- BIOC Rules -->
                <h2><i class="fas fa-cog"></i> BIOC Rules</h2>
                <div class="config-section">
                    <p><span class="console-path">Rules → BIOC Rules</span></p>
                    <p>Behavioral Indicators of Compromise detect attack patterns.</p>

                    <h4>BIOC Rule Categories</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Malware:</strong> Known malware behaviors</li>
                        <li><strong>Exploit:</strong> Exploitation techniques</li>
                        <li><strong>Credential Theft:</strong> Credential access attempts</li>
                        <li><strong>Lateral Movement:</strong> Spread techniques</li>
                        <li><strong>Persistence:</strong> Persistence mechanisms</li>
                        <li><strong>Defense Evasion:</strong> Security bypass attempts</li>
                    </ul>

                    <h4>BIOC Rule Actions</h4>
                    <div class="arch-diagram">Rule Actions:

Alert:
- Generate alert when triggered
- No blocking action

Alert and Block:
- Generate alert
- Block/prevent the action

Disabled:
- Rule not active</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is the Causality Group Owner (CGO)?</button>
                        <div class="qa-answer">
                            <p>The CGO is the root process at the top of a process chain. It represents the origin point of all activity in that chain.</p>
                            <ul>
                                <li>For user activity, typically explorer.exe</li>
                                <li>For services, typically services.exe or svchost.exe</li>
                                <li>Helps understand how an attack originated</li>
                                <li>Used to trace the full attack path</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does XDR differ from EDR?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>EDR:</strong> Endpoint-only telemetry and detection</li>
                                <li><strong>XDR:</strong> Extends to network, cloud, identity data</li>
                                <li><strong>Correlation:</strong> XDR correlates across data sources</li>
                                <li><strong>Visibility:</strong> XDR provides broader attack visibility</li>
                            </ul>
                            <p style="margin-top: 12px;">XDR = EDR + Network + Cloud + Identity correlation</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you investigate a suspicious alert in Cortex XDR?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Review alert details:</strong> What triggered? Severity?</li>
                                <li><strong>Check Causality View:</strong> How did it happen?</li>
                                <li><strong>Examine process chain:</strong> Parent processes, command lines</li>
                                <li><strong>Check network connections:</strong> Any C2?</li>
                                <li><strong>Look for persistence:</strong> Registry, scheduled tasks</li>
                                <li><strong>Search for scope:</strong> Other affected hosts?</li>
                                <li><strong>Take action:</strong> Isolate, block, remediate</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>