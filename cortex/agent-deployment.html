<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Deployment | Cortex XDR</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Cortex XDR Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="fundamentals.html" class="nav-link"><i class="fas fa-book"></i> Fundamentals</a>
                    <a href="agent-deployment.html" class="nav-link active"><i class="fas fa-download"></i> Agent Deployment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection</div>
                    <a href="analytics.html" class="nav-link"><i class="fas fa-chart-line"></i> Analytics Engine</a>
                    <a href="bioc-rules.html" class="nav-link"><i class="fas fa-code"></i> BIOC Rules</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Investigation</div>
                    <a href="xql-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> XQL Hunting</a>
                    <a href="xql-reference.html" class="nav-link"><i class="fas fa-book-open"></i> XQL Reference</a>
                    <a href="incident-management.html" class="nav-link"><i class="fas fa-clipboard-list"></i> Incident Management</a>
                    <a href="causality.html" class="nav-link"><i class="fas fa-project-diagram"></i> Causality Analysis</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Response</div>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-bolt"></i> Response Actions</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Cortex XDR</a><span class="separator">/</span>
                    <span class="current">Agent Deployment</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-download"></i> Cortex XDR Agent Deployment</h1>
                <p class="lead">Deploy Cortex XDR agents across your enterprise. Learn installation packages, deployment methods, and agent configuration options.</p>

                <!-- Agent Overview -->
                <h2><i class="fas fa-info-circle"></i> Agent Overview</h2>
                <div class="config-section">
                    <p><span class="console-path">Endpoints → Agent Installation → Agent Installers</span></p>

                    <h4>Agent Types</h4>
                    <div class="code-block">Cortex XDR Agent Types:

STANDARD AGENT (Traps):
├── Endpoint protection (EPP)
├── Exploit prevention
├── Malware prevention
├── Device control
└── Host firewall

XDR AGENT:
├── All Standard features +
├── Extended detection (XDR)
├── Full telemetry collection
├── Behavioral analytics
├── Network traffic analysis
└── Cloud analysis integration

AGENT COMPONENTS:
├── cyserver.exe       - Core service
├── cytray.exe         - System tray
├── CyveraService      - Main protection service
├── cyupdate.exe       - Content updates
└── cytool.exe         - Command line utility</div>

                    <h4>Supported Platforms</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Platform</th><th>Versions</th><th>Architecture</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Windows</strong></td><td>7 SP1+, 10, 11, Server 2008 R2-2022</td><td>x64, x86</td></tr>
                            <tr><td><strong>macOS</strong></td><td>10.15+ (Catalina and later)</td><td>Intel, Apple Silicon</td></tr>
                            <tr><td><strong>Linux</strong></td><td>RHEL 6+, Ubuntu 16.04+, CentOS, SUSE</td><td>x64</td></tr>
                            <tr><td><strong>Android</strong></td><td>8.0+</td><td>ARM</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Installation Packages -->
                <h2><i class="fas fa-box"></i> Installation Packages</h2>
                <div class="config-section">
                    <p><span class="console-path">Endpoints → Agent Installation → Agent Installers</span></p>

                    <div class="code-block">Package Types:

STANDALONE INSTALLER:
├── Full offline package
├── Contains all components
├── For manual/script deployment
└── Larger file size (~150 MB)

DEPLOYMENT PACKAGE (MSI):
├── Smaller initial download
├── Downloads components during install
├── For enterprise deployment tools
└── Requires internet during install

VDI PACKAGE:
├── Optimized for virtual desktops
├── Non-persistent support
├── Golden image compatible
└── Reduced resource usage

Package Configuration:
├── Distribution ID (required)
├── Content version
├── Agent version
└── Hash verification</div>
                </div>

                <!-- Windows Deployment -->
                <h2><i class="fab fa-windows"></i> Windows Deployment</h2>
                <div class="config-section">
                    <h4>Command Line Installation</h4>
                    <div class="code-block"># Basic silent install
msiexec /i "cortex.msi" /qn DISTRIBUTION_ID=<DIST_ID>

# With logging
msiexec /i "cortex.msi" /qn /l*v "C:\install.log" DISTRIBUTION_ID=<DIST_ID>

# With proxy
msiexec /i "cortex.msi" /qn DISTRIBUTION_ID=<DIST_ID> PROXY_HOST=proxy.domain.com PROXY_PORT=8080

# Standalone package
cortex_installer.exe --distID <DIST_ID> --quiet

# Custom install directory
msiexec /i "cortex.msi" /qn DISTRIBUTION_ID=<DIST_ID> INSTALLDIR="D:\CortexXDR"

# Uninstall
msiexec /x "cortex.msi" /qn PASSWORD=<UNINSTALL_PASSWORD>

# Or with cytool
"C:\Program Files\Palo Alto Networks\Traps\cytool.exe" uninstall --password <PASSWORD></div>

                    <h4>SCCM/MECM Deployment</h4>
                    <div class="code-block">SCCM Deployment:

1. CREATE APPLICATION
   Software Library → Applications → Create Application
   ├── Type: MSI
   ├── Content: \\server\share\CortexXDR\cortex.msi
   └── Install: msiexec /i "cortex.msi" /qn DISTRIBUTION_ID=<ID>

2. DETECTION METHOD
   Registry: HKLM\SOFTWARE\Palo Alto Networks\Traps
   └── Value: ProductVersion exists

3. REQUIREMENTS
   ├── OS: Windows 10 or later
   ├── Disk space: 500 MB
   └── Memory: 2 GB

4. DEPLOYMENT
   ├── Action: Install
   ├── Purpose: Required
   └── Schedule: As soon as possible

5. SUPERSEDENCE (Optional)
   Supersede older Traps versions</div>

                    <h4>Group Policy Deployment</h4>
                    <div class="code-block"># Create deployment share
\\dc\NETLOGON\CortexXDR\cortex.msi

# GPO Software Installation
Computer Configuration → Policies → 
Software Settings → Software Installation → 
New Package → Select MSI

# Transform file for DISTRIBUTION_ID
Create MST file with Orca or similar:
Property: DISTRIBUTION_ID = <YOUR_DIST_ID>

# Startup Script Method
powershell.exe -ExecutionPolicy Bypass -File \\dc\NETLOGON\deploy-cortex.ps1

# deploy-cortex.ps1
$msiPath = "\\dc\NETLOGON\CortexXDR\cortex.msi"
$distID = "YOUR_DIST_ID"
$logPath = "C:\Windows\Temp\cortex_install.log"

if (!(Get-Service -Name CyveraService -ErrorAction SilentlyContinue)) {
    Start-Process msiexec -ArgumentList "/i `"$msiPath`" /qn /l*v `"$logPath`" DISTRIBUTION_ID=$distID" -Wait
}</div>
                </div>

                <!-- Linux Deployment -->
                <h2><i class="fab fa-linux"></i> Linux Deployment</h2>
                <div class="config-section">
                    <div class="code-block"># RHEL/CentOS Installation
sudo rpm -ivh cortex-xdr-<version>.rpm
sudo /opt/traps/bin/cytool register --distro-id <DIST_ID>

# Ubuntu/Debian Installation
sudo dpkg -i cortex-xdr_<version>_amd64.deb
sudo /opt/traps/bin/cytool register --distro-id <DIST_ID>

# With proxy
sudo /opt/traps/bin/cytool register --distro-id <DIST_ID> \
    --proxy-host proxy.domain.com --proxy-port 8080

# Verify installation
sudo /opt/traps/bin/cytool info

# Check service status
sudo systemctl status traps_pmd

# Uninstall
# RHEL: sudo rpm -e cortex-xdr
# Ubuntu: sudo dpkg -r cortex-xdr</div>

                    <h4>Ansible Deployment</h4>
                    <div class="code-block"># cortex-deploy.yml
---
- name: Deploy Cortex XDR Agent
  hosts: linux_servers
  become: yes
  vars:
    dist_id: "YOUR_DIST_ID"
    package_path: "files/cortex-xdr.rpm"
    
  tasks:
    - name: Copy Cortex package
      copy:
        src: "{{ package_path }}"
        dest: /tmp/cortex-xdr.rpm
        
    - name: Install Cortex XDR
      yum:
        name: /tmp/cortex-xdr.rpm
        state: present
      when: ansible_os_family == "RedHat"
        
    - name: Register agent
      command: /opt/traps/bin/cytool register --distro-id {{ dist_id }}
      args:
        creates: /opt/traps/config/registered
        
    - name: Verify agent
      command: /opt/traps/bin/cytool info
      register: agent_status
      
    - debug:
        var: agent_status.stdout_lines</div>
                </div>

                <!-- macOS Deployment -->
                <h2><i class="fab fa-apple"></i> macOS Deployment</h2>
                <div class="config-section">
                    <div class="code-block"># Manual Installation
# Download PKG from console

# Install package
sudo installer -pkg CortexXDR.pkg -target /

# Register with distribution ID
sudo /Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool register --distro-id <DIST_ID>

# Verify
sudo /Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool info

# Required Approvals:
System Preferences → Security & Privacy → Privacy
├── Full Disk Access: Cortex XDR
├── System Extensions: Palo Alto Networks
└── Network Extensions: Palo Alto Networks

# Jamf Deployment
1. Upload PKG to Jamf
2. Create policy with PKG
3. Add post-install script for registration
4. Deploy MDM profile for approvals</div>
                </div>

                <!-- Agent Configuration -->
                <h2><i class="fas fa-cog"></i> Agent Configuration</h2>
                <div class="config-section">
                    <p><span class="console-path">Endpoints → Policy Management → Agent Settings</span></p>

                    <div class="code-block">Agent Settings Profiles:

PROTECTION SETTINGS:
├── Malware Protection: Enable/Disable
├── Exploit Protection: Enable/Disable
├── Behavioral Threat Protection: Enable/Disable
├── Device Control: Enable/Disable
└── Host Firewall: Enable/Disable

COLLECTION SETTINGS:
├── XDR Data Collection: Full/Minimal
├── Network Traffic Analysis: Enable/Disable
├── Hash Calculation: All files/On-demand
└── File Acquisition: Allow/Deny

OPERATIONAL SETTINGS:
├── Content Update Frequency
├── Agent Auto-Update
├── Proxy Configuration
├── Bandwidth Throttling
└── Diagnostic Logging Level

ENDPOINT GROUPS:
├── Assign profiles by group
├── Dynamic group rules
├── Priority ordering
└── Policy inheritance</div>
                </div>

                <!-- Troubleshooting -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting</h2>
                <div class="config-section">
                    <div class="code-block"># Windows - Check agent status
"C:\Program Files\Palo Alto Networks\Traps\cytool.exe" info

# Windows - Service check
sc query CyveraService

# Windows - Connectivity test
"C:\Program Files\Palo Alto Networks\Traps\cytool.exe" connectivity

# Windows - Logs
C:\ProgramData\Cyvera\Logs\

# Linux - Check status
sudo /opt/traps/bin/cytool info
sudo systemctl status traps_pmd

# macOS - Check status
sudo /Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool info

Common Issues:

1. AGENT NOT CONNECTING
   □ Verify Distribution ID
   □ Check network connectivity to cortex.paloaltonetworks.com
   □ Verify proxy settings
   □ Check firewall rules (port 443)

2. INSTALLATION FAILS
   □ Check system requirements
   □ Verify admin rights
   □ Check for conflicting AV
   □ Review install logs

3. AGENT NOT REPORTING
   □ Check agent service running
   □ Verify agent version current
   □ Run connectivity test
   □ Review cortex console for errors</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What is a Distribution ID and why is it important?</button>
                        <div class="qa-answer">
                            <p>The <strong>Distribution ID</strong> uniquely identifies your Cortex XDR tenant:</p>
                            <ul>
                                <li>Links agents to your management console</li>
                                <li>Required for agent registration</li>
                                <li>Found in Agent Installation settings</li>
                                <li>Without it, agent won't connect to your instance</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you deploy Cortex XDR agents at scale?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>SCCM/MECM:</strong> Application deployment with MSI</li>
                                <li><strong>Intune:</strong> Win32 app or line-of-business app</li>
                                <li><strong>GPO:</strong> Software installation or startup script</li>
                                <li><strong>Ansible/Puppet:</strong> Configuration management for Linux</li>
                                <li><strong>Jamf:</strong> PKG deployment with MDM profile for macOS</li>
                            </ul>
                            <p>Key: Include Distribution ID in deployment package.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you verify agent is working correctly?</button>
                        <div class="qa-answer">
                            <ol>
                                <li>Run <code>cytool info</code> - shows agent status, version, registration</li>
                                <li>Run <code>cytool connectivity</code> - tests cloud connection</li>
                                <li>Check services are running (CyveraService)</li>
                                <li>Verify agent appears in Cortex console</li>
                                <li>Check protection policies applied</li>
                            </ol>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>