<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cortex XDR - Complete Reference Guide | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Compendium</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Cortex XDR</div>
                    <a href="index.html" class="nav-link active"><i class="fas fa-home"></i> Overview</a>
                    <a href="xql-reference.html" class="nav-link"><i class="fas fa-code"></i> XQL Reference</a>
                    <a href="xql-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Hunting</a>
                    <a href="bioc-rules.html" class="nav-link"><i class="fas fa-shield-virus"></i> BIOC Rules</a>
                    <a href="analytics.html" class="nav-link"><i class="fas fa-chart-bar"></i> Analytics</a>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-bolt"></i> Response Actions</a>
                    <a href="causality.html" class="nav-link"><i class="fas fa-project-diagram"></i> Causality Analysis</a>
                    <a href="agent-deployment.html" class="nav-link"><i class="fas fa-download"></i> Deployment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Other Platforms</div>
                    <a href="../mde/index.html" class="nav-link"><i class="fab fa-microsoft"></i> Microsoft Defender</a>
                    <a href="../crowdstrike/index.html" class="nav-link"><i class="fas fa-crow"></i> CrowdStrike</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-crosshairs"></i> Cortex XDR</h1>
                    <p class="lead">Palo Alto Networks Extended Detection and Response platform - comprehensive threat hunting, detection engineering, and response capabilities</p>
                </div>

                <!-- Architecture Overview -->
                <section class="content-section">
                    <h2><i class="fas fa-sitemap"></i> Architecture Overview</h2>
                    <div class="workflow-diagram">
<pre>
╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                              CORTEX XDR ARCHITECTURE                                                                  ║
╠══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                                                       ║
║    ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐   ║
║    │                                              DATA SOURCES                                                                    │   ║
║    ├───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┐             │   ║
║    │   Cortex XDR  │   Palo Alto   │    Cloud      │   Identity    │   Network     │    3rd Party  │   Custom      │             │   ║
║    │    Agent      │   Firewall    │   Workloads   │   Providers   │   Sensors     │    Logs       │   Collectors  │             │   ║
║    │  (Endpoint)   │   (NGFW)      │  (Prisma)     │  (AD/Azure)   │  (Network)    │  (Syslog)     │  (API)        │             │   ║
║    └───────┬───────┴───────┬───────┴───────┬───────┴───────┬───────┴───────┬───────┴───────┬───────┴───────┬───────┘             │   ║
║            │               │               │               │               │               │               │                      │   ║
║            └───────────────┴───────────────┴───────────────┴───────────────┴───────────────┴───────────────┘                      │   ║
║                                                            │                                                                      │   ║
║                                                            ▼                                                                      │   ║
║    ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐   ║
║    │                                        CORTEX DATA LAKE                                                                     │   ║
║    │  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐                        │   ║
║    │  │   Endpoint Data     │  │   Network Data      │  │   Cloud Data        │  │   Identity Data     │                        │   ║
║    │  │   • Process events  │  │   • Firewall logs   │  │   • AWS/Azure/GCP   │  │   • Auth events     │                        │   ║
║    │  │   • File events     │  │   • DNS queries     │  │   • Container logs  │  │   • Access logs     │                        │   ║
║    │  │   • Registry        │  │   • Traffic flows   │  │   • Kubernetes      │  │   • Directory       │                        │   ║
║    │  │   • Network conn    │  │   • URL filtering   │  │   • Serverless      │  │     changes         │                        │   ║
║    │  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘                        │   ║
║    └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘   ║
║                                                            │                                                                      │   ║
║                    ┌───────────────────────────────────────┼───────────────────────────────────────┐                             │   ║
║                    ▼                                       ▼                                       ▼                             │   ║
║    ┌──────────────────────────────┐    ┌──────────────────────────────┐    ┌──────────────────────────────┐                      │   ║
║    │     DETECTION ENGINE         │    │     ANALYTICS ENGINE         │    │     THREAT INTEL             │                      │   ║
║    │                              │    │                              │    │                              │                      │   ║
║    │  • BIOC (Behavioral IOC)     │    │  • Machine Learning          │    │  • Unit 42 Threat Intel      │                      │   ║
║    │  • Analytics Alerts          │    │  • User Behavior Analytics   │    │  • AutoFocus Integration     │                      │   ║
║    │  • Correlation Rules         │    │  • Entity Risk Scoring       │    │  • WildFire Verdicts         │                      │   ║
║    │  • Custom Detection Rules    │    │  • Anomaly Detection         │    │  • External TI Feeds         │                      │   ║
║    └──────────────────────────────┘    └──────────────────────────────┘    └──────────────────────────────┘                      │   ║
║                    │                                       │                                       │                             │   ║
║                    └───────────────────────────────────────┼───────────────────────────────────────┘                             │   ║
║                                                            ▼                                                                      │   ║
║    ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐   ║
║    │                                           INCIDENT MANAGEMENT                                                               │   ║
║    │                                                                                                                             │   ║
║    │  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │   ║
║    │  │     ALERTS      │ ─► │   INCIDENTS     │ ─► │   CAUSALITY     │ ─► │    RESPONSE     │ ─► │   REPORTING     │           │   ║
║    │  │                 │    │                 │    │    ANALYSIS     │    │    ACTIONS      │    │                 │           │   ║
║    │  │  Grouped &      │    │  Deduplicated   │    │  Attack chain   │    │  • Isolate      │    │  • Dashboards   │           │   ║
║    │  │  Prioritized    │    │  & Correlated   │    │  visualization  │    │  • Quarantine   │    │  • Reports      │           │   ║
║    │  │                 │    │                 │    │                 │    │  • Remediate    │    │  • Exports      │           │   ║
║    │  └─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘           │   ║
║    └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘   ║
║                                                                                                                                       ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
</pre>
                    </div>
                </section>

                <!-- Key Capabilities -->
                <section class="content-section">
                    <h2><i class="fas fa-star"></i> Key Capabilities</h2>
                    <div class="card-grid">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon orange"><i class="fas fa-shield-virus"></i></div>
                                <div>
                                    <div class="card-title">BIOC Detection</div>
                                    <div class="card-subtitle">Behavioral Indicators of Compromise</div>
                                </div>
                            </div>
                            <div class="card-body">
                                Custom detection rules based on endpoint behaviors - process execution, file operations, network connections, and registry modifications with granular control over severity and response actions.
                            </div>
                            <a href="bioc-rules.html" class="card-link">Learn BIOC Rules <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon purple"><i class="fas fa-code"></i></div>
                                <div>
                                    <div class="card-title">XQL Query Language</div>
                                    <div class="card-subtitle">Powerful Threat Hunting</div>
                                </div>
                            </div>
                            <div class="card-body">
                                XDR Query Language for searching across all data sources - endpoints, network, cloud, and identity. Filter, aggregate, join datasets, and visualize results.
                            </div>
                            <a href="xql-reference.html" class="card-link">XQL Reference <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon cyan"><i class="fas fa-project-diagram"></i></div>
                                <div>
                                    <div class="card-title">Causality Analysis</div>
                                    <div class="card-subtitle">Attack Chain Visualization</div>
                                </div>
                            </div>
                            <div class="card-body">
                                Automated attack chain reconstruction showing how an incident progressed from initial access through impact, with full process tree and network connection mapping.
                            </div>
                            <a href="causality.html" class="card-link">Causality Guide <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon green"><i class="fas fa-bolt"></i></div>
                                <div>
                                    <div class="card-title">Response Actions</div>
                                    <div class="card-subtitle">Automated Remediation</div>
                                </div>
                            </div>
                            <div class="card-body">
                                Built-in response capabilities including endpoint isolation, file quarantine, process termination, script execution, and integration with XSOAR for automated playbooks.
                            </div>
                            <a href="response-actions.html" class="card-link">Response Actions <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                </section>

                <!-- XQL Quick Reference -->
                <section class="content-section">
                    <h2><i class="fas fa-code"></i> XQL Quick Reference</h2>
                    
                    <h3>Basic Query Structure</h3>
                    <pre><code>dataset = xdr_data
| filter event_type = PROCESS and action_process_image_name = "powershell.exe"
| filter action_process_image_command_line contains "-enc" or action_process_image_command_line contains "-encoded"
| fields agent_hostname, actor_process_image_name, action_process_image_name, action_process_image_command_line, _time
| sort desc _time
| limit 100</code></pre>

                    <h3>Essential Threat Hunting Queries</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Use Case</th>
                                    <th>XQL Query</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>LSASS Access</strong></td>
                                    <td><code>dataset = xdr_data | filter event_type = PROCESS and action_process_image_name = "lsass.exe" and actor_process_image_name != "svchost.exe"</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Suspicious PowerShell</strong></td>
                                    <td><code>dataset = xdr_data | filter action_process_image_name = "powershell.exe" and (action_process_image_command_line contains "IEX" or action_process_image_command_line contains "Invoke-Expression")</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Lateral Movement (PsExec)</strong></td>
                                    <td><code>dataset = xdr_data | filter event_type = PROCESS and action_process_image_name in ("psexec.exe", "psexesvc.exe")</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Scheduled Task Creation</strong></td>
                                    <td><code>dataset = xdr_data | filter event_type = PROCESS and action_process_image_name = "schtasks.exe" and action_process_image_command_line contains "/create"</code></td>
                                </tr>
                                <tr>
                                    <td><strong>External Network Connections</strong></td>
                                    <td><code>dataset = xdr_data | filter event_type = NETWORK and action_external_hostname != null | comp count() by action_external_hostname | sort desc count</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Agent Profiles -->
                <section class="content-section">
                    <h2><i class="fas fa-cogs"></i> Agent Configuration Profiles</h2>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Profile</th>
                                    <th>Prevention</th>
                                    <th>Collection</th>
                                    <th>Response</th>
                                    <th>Best For</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Full Protection</strong></td>
                                    <td>Block all threats</td>
                                    <td>All telemetry</td>
                                    <td>Full response</td>
                                    <td>Production endpoints</td>
                                </tr>
                                <tr>
                                    <td><strong>Detection Only</strong></td>
                                    <td>Alert only</td>
                                    <td>All telemetry</td>
                                    <td>Manual only</td>
                                    <td>Initial rollout / Testing</td>
                                </tr>
                                <tr>
                                    <td><strong>Server Profile</strong></td>
                                    <td>Conservative</td>
                                    <td>Enhanced logging</td>
                                    <td>Full response</td>
                                    <td>Critical servers</td>
                                </tr>
                                <tr>
                                    <td><strong>VDI Profile</strong></td>
                                    <td>Optimized</td>
                                    <td>Reduced telemetry</td>
                                    <td>Limited</td>
                                    <td>Virtual desktops</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Navigation Cards -->
                <section class="content-section">
                    <h2><i class="fas fa-book"></i> Documentation Sections</h2>
                    <div class="card-grid">
                        <div class="platform-card">
                            <div class="platform-card-header cortex">
                                <h3>XQL Reference</h3>
                                <span>Complete Query Language Guide</span>
                            </div>
                            <div class="platform-card-body">
                                <ul>
                                    <li>Query syntax and operators</li>
                                    <li>Functions and aggregations</li>
                                    <li>Dataset joins</li>
                                    <li>Performance optimization</li>
                                </ul>
                                <a href="xql-reference.html" class="btn btn-primary"><i class="fas fa-arrow-right"></i> XQL Reference</a>
                            </div>
                        </div>

                        <div class="platform-card">
                            <div class="platform-card-header cortex">
                                <h3>BIOC Rules</h3>
                                <span>Behavioral Detection Engineering</span>
                            </div>
                            <div class="platform-card-body">
                                <ul>
                                    <li>Rule creation workflow</li>
                                    <li>Process and file rules</li>
                                    <li>Network and registry rules</li>
                                    <li>Testing and tuning</li>
                                </ul>
                                <a href="bioc-rules.html" class="btn btn-primary"><i class="fas fa-arrow-right"></i> BIOC Rules</a>
                            </div>
                        </div>

                        <div class="platform-card">
                            <div class="platform-card-header cortex">
                                <h3>Response Actions</h3>
                                <span>Containment & Remediation</span>
                            </div>
                            <div class="platform-card-body">
                                <ul>
                                    <li>Isolation procedures</li>
                                    <li>File quarantine</li>
                                    <li>Script execution</li>
                                    <li>XSOAR integration</li>
                                </ul>
                                <a href="response-actions.html" class="btn btn-primary"><i class="fas fa-arrow-right"></i> Response Guide</a>
                            </div>
                        </div>
                    </div>
                </section>

            </main>
        </div>
    </div>
</body>
</html>
