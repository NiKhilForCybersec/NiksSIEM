<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Engine | Cortex XDR</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Cortex XDR Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="fundamentals.html" class="nav-link"><i class="fas fa-book"></i> Fundamentals</a>
                    <a href="agent-deployment.html" class="nav-link"><i class="fas fa-download"></i> Agent Deployment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection</div>
                    <a href="analytics.html" class="nav-link active"><i class="fas fa-chart-line"></i> Analytics Engine</a>
                    <a href="bioc-rules.html" class="nav-link"><i class="fas fa-code"></i> BIOC Rules</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Investigation</div>
                    <a href="xql-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> XQL Hunting</a>
                    <a href="xql-reference.html" class="nav-link"><i class="fas fa-book-open"></i> XQL Reference</a>
                    <a href="incident-management.html" class="nav-link"><i class="fas fa-clipboard-list"></i> Incident Management</a>
                    <a href="causality.html" class="nav-link"><i class="fas fa-project-diagram"></i> Causality Analysis</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Response</div>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-bolt"></i> Response Actions</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Cortex XDR</a><span class="separator">/</span>
                    <span class="current">Analytics Engine</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-brain"></i> Cortex XDR Analytics Engine</h1>
                <p class="lead">Master Cortex XDR's multi-layer detection engine. Understand local analysis, cloud analytics, behavioral threat protection, and machine learning-powered detection capabilities.</p>

                <!-- Analytics Overview -->
                <h2><i class="fas fa-info-circle"></i> Analytics Overview</h2>
                <div class="config-section">
                    <h4>Detection Architecture</h4>
                    <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────┐
│                     CORTEX XDR ANALYTICS ENGINE                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   ENDPOINT (Local Analysis)          CLOUD (Advanced Analytics)                │
│   ─────────────────────────          ──────────────────────────                │
│                                                                                 │
│   ┌─────────────────────┐           ┌─────────────────────────────────────┐   │
│   │   CORTEX AGENT      │           │         CORTEX XDR CLOUD            │   │
│   │                     │           │                                     │   │
│   │  ┌───────────────┐  │   Raw     │  ┌─────────────┐  ┌─────────────┐  │   │
│   │  │ Local Static  │  │   Data    │  │    Cloud    │  │  Behavioral │  │   │
│   │  │   Analysis    │──┼──────────▶│  │  Analytics  │  │   Threat    │  │   │
│   │  └───────────────┘  │           │  │   Engine    │  │  Protection │  │   │
│   │                     │           │  └─────────────┘  └─────────────┘  │   │
│   │  ┌───────────────┐  │           │         │               │          │   │
│   │  │ Exploit       │  │           │         ▼               ▼          │   │
│   │  │ Prevention    │  │           │  ┌─────────────┐  ┌─────────────┐  │   │
│   │  └───────────────┘  │           │  │     ML      │  │   MITRE     │  │   │
│   │                     │           │  │   Models    │  │  Mapping    │  │   │
│   │  ┌───────────────┐  │           │  └─────────────┘  └─────────────┘  │   │
│   │  │ Behavioral    │  │           │         │               │          │   │
│   │  │   Analysis    │  │           │         ▼               ▼          │   │
│   │  └───────────────┘  │           │  ┌───────────────────────────────┐ │   │
│   │                     │  ◀────────┼──│    ALERTS & INCIDENTS        │ │   │
│   │  ┌───────────────┐  │  Response │  │    (Causality Analysis)      │ │   │
│   │  │ Device Control│  │  Actions  │  └───────────────────────────────┘ │   │
│   │  └───────────────┘  │           │                                     │   │
│   │                     │           │  ┌───────────────────────────────┐ │   │
│   └─────────────────────┘           │  │   CUSTOM DETECTION RULES     │ │   │
│                                      │  │   (BIOC, IOC, Correlation)   │ │   │
│                                      │  └───────────────────────────────┘ │   │
│                                      │                                     │   │
│                                      └─────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
                    </div>

                    <h4>Detection Layers</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Layer</th><th>Location</th><th>Capabilities</th><th>Response Time</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Local Static</strong></td><td>Endpoint</td><td>File hash, signatures, WildFire verdict cache</td><td>Milliseconds</td></tr>
                            <tr><td><strong>Exploit Prevention</strong></td><td>Endpoint</td><td>Memory protection, technique blocking</td><td>Real-time</td></tr>
                            <tr><td><strong>Behavioral Analysis</strong></td><td>Endpoint</td><td>Process behavior, suspicious patterns</td><td>Seconds</td></tr>
                            <tr><td><strong>Cloud Analytics</strong></td><td>Cloud</td><td>ML models, cross-customer intelligence</td><td>Seconds-Minutes</td></tr>
                            <tr><td><strong>BTP</strong></td><td>Cloud</td><td>Behavioral threat protection, UEBA</td><td>Minutes</td></tr>
                            <tr><td><strong>Custom Rules</strong></td><td>Cloud</td><td>BIOC, IOC, Correlation rules</td><td>Configurable</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Local Analysis -->
                <h2><i class="fas fa-laptop"></i> Local Analysis (Endpoint)</h2>
                <div class="config-section">
                    <h4>Static Analysis</h4>
                    <div class="code-block">Local Static Analysis:

HASH-BASED DETECTION:
├── Known malware hash matching
├── WildFire verdict cache
├── Custom hash blocklist
└── Real-time lookup for unknowns

FILE ANALYSIS:
├── PE header inspection
├── Import table analysis
├── Packer/obfuscation detection
├── Certificate validation
└── Entropy analysis

SIGNATURE-BASED:
├── YARA-like pattern matching
├── Behavioral signatures
├── Exploit signatures
└── Updated via content updates

CONFIGURATION PATH:
Endpoints → Endpoint Management → Profiles → 
  Malware Security Profile</div>

                    <h4>Exploit Prevention</h4>
                    <div class="code-block">Exploit Prevention Techniques:

MEMORY PROTECTION:
├── DEP (Data Execution Prevention) enforcement
├── ASLR (Address Space Layout Randomization)
├── Stack pivot detection
├── Return-oriented programming (ROP) mitigation
├── JIT (Just-In-Time) spraying prevention
└── Heap spray detection

TECHNIQUE BLOCKING:
├── DLL injection detection
├── Process hollowing prevention
├── Reflective DLL loading
├── Thread execution hijacking
├── APC injection detection
└── AtomBombing prevention

PROTECTED APPLICATIONS:
├── Web browsers (Chrome, Edge, Firefox)
├── Office applications
├── PDF readers
├── Java applications
├── Flash (legacy)
└── Custom application protection

CONFIGURATION:
Endpoints → Endpoint Management → Profiles → 
  Exploit Security Profile
  
PROFILE SETTINGS:
├── Protection Mode: Prevent / Detect / Disabled
├── Child Process Protection
├── DLL Security
├── Threat Prevention
└── Application-specific settings</div>

                    <h4>Behavioral Analysis</h4>
                    <div class="code-block">Local Behavioral Analysis:

MONITORED BEHAVIORS:
├── Process execution chains
├── File system modifications
├── Registry changes
├── Network connections
├── Privilege escalation attempts
├── Credential access patterns
└── Persistence mechanisms

DETECTION EXAMPLES:
├── Office spawning PowerShell
├── Script interpreter abuse
├── Unusual process lineage
├── Suspicious command-line arguments
├── Known attack tool patterns
└── Living-off-the-land technique detection

RESPONSE OPTIONS:
├── Alert only (log and notify)
├── Quarantine file
├── Kill process
├── Block network connection
└── Isolate endpoint

TUNING:
├── Per-process exclusions
├── Signed process exceptions
├── Path-based exclusions
├── Hash-based allowlisting
└── Profile-based configuration</div>
                </div>

                <!-- Cloud Analytics -->
                <h2><i class="fas fa-cloud"></i> Cloud Analytics</h2>
                <div class="config-section">
                    <h4>Machine Learning Models</h4>
                    <div class="code-block">Cortex XDR ML Capabilities:

MODEL TYPES:
├── Supervised Classification
│   ├── Malware vs benign files
│   ├── Malicious vs legitimate behavior
│   └── Trained on labeled threat data
│
├── Unsupervised Anomaly Detection
│   ├── Baseline deviation detection
│   ├── Rare behavior identification
│   └── No labeled data required
│
└── Behavioral Sequencing
    ├── Attack chain recognition
    ├── Multi-stage threat correlation
    └── Temporal pattern analysis

ML USE CASES:
├── Unknown malware detection
├── Zero-day exploit identification
├── Insider threat detection
├── Lateral movement detection
├── Data exfiltration identification
└── Command & control detection

TRAINING DATA:
├── Palo Alto Networks threat intelligence
├── WildFire sample analysis
├── Customer telemetry (anonymized)
├── Red team and attack simulations
└── Continuous model updates</div>

                    <h4>Behavioral Threat Protection (BTP)</h4>
                    <div class="code-block">Behavioral Threat Protection:

WHAT IS BTP:
├── Cloud-based behavioral analytics
├── Cross-endpoint correlation
├── User and entity behavior analytics
├── Advanced attack detection
└── ML-powered threat identification

BTP DETECTION CATEGORIES:

CREDENTIAL THEFT:
├── LSASS memory access
├── SAM database dumping
├── DCSync/DCShadow
├── Kerberoasting
└── Pass-the-hash/ticket

MALWARE:
├── Ransomware behavior
├── Cryptominer activity
├── Backdoor indicators
├── Worm-like propagation
└── Rootkit behavior

EXPLOITATION:
├── Memory corruption
├── Privilege escalation
├── Kernel exploits
├── Browser exploits
└── Office exploits

LATERAL MOVEMENT:
├── Remote service exploitation
├── WMI/PowerShell remoting
├── PsExec-like behavior
├── Pass-the-hash movement
└── RDP tunneling

COMMAND & CONTROL:
├── Beaconing patterns
├── DNS tunneling
├── HTTP(S) C2 channels
├── Encrypted channel detection
└── DGA (Domain Generation Algorithm)

BTP CONFIGURATION:
Detection Rules → Analytics BIOC Rules → 
  Behavioral Threat Protection</div>
                </div>

                <!-- Alert Categories -->
                <h2><i class="fas fa-bell"></i> Alert Categories</h2>
                <div class="config-section">
                    <h4>Alert Classification</h4>
                    <div class="code-block">Cortex XDR Alert Categories:

SEVERITY LEVELS:
├── CRITICAL: Confirmed active threat
├── HIGH: Likely malicious, immediate investigation
├── MEDIUM: Suspicious, requires review
├── LOW: Informational, possible benign
└── INFORMATIONAL: Tracking only

ALERT SOURCES:
├── XDR Agent (local detection)
├── XDR Analytics (cloud ML)
├── BTP Rules (behavioral)
├── BIOC Rules (custom)
├── IOC Rules (indicators)
└── Correlation Rules (multi-event)

ALERT CATEGORIES BY TACTIC:
┌──────────────────────────────────────────────────────────┐
│ MITRE Tactic          │ Example Alerts                  │
├──────────────────────────────────────────────────────────┤
│ Initial Access        │ Phishing attachment execution   │
│ Execution             │ Malicious script execution      │
│ Persistence           │ Registry run key modification   │
│ Privilege Escalation  │ Token manipulation detected     │
│ Defense Evasion       │ Process injection detected      │
│ Credential Access     │ LSASS memory dump attempt       │
│ Discovery             │ Network scanning activity       │
│ Lateral Movement      │ Remote service exploitation     │
│ Collection            │ Sensitive file access           │
│ Exfiltration          │ Large data transfer detected    │
│ Command & Control     │ Beaconing activity detected     │
│ Impact                │ Ransomware encryption activity  │
└──────────────────────────────────────────────────────────┘</div>

                    <h4>Alert Lifecycle</h4>
                    <div class="code-block">Alert Lifecycle Flow:

1. DETECTION
   └── Analytics engine identifies threat
       ├── Local agent detection
       ├── Cloud ML detection
       └── Rule-based detection

2. ALERT CREATION
   └── Alert generated with:
       ├── Severity assignment
       ├── Category classification
       ├── MITRE ATT&CK mapping
       ├── Evidence collection
       └── Causality chain

3. INCIDENT GROUPING
   └── Related alerts grouped:
       ├── Same endpoint
       ├── Same user
       ├── Temporal proximity
       └── Causality relationship

4. INVESTIGATION
   └── Analyst reviews:
       ├── Alert details
       ├── Causality view
       ├── Timeline
       └── Related artifacts

5. VERDICT
   ├── True Positive → Remediate
   ├── False Positive → Tune
   └── Undetermined → Escalate

6. RESPONSE
   └── Actions taken:
       ├── Containment
       ├── Eradication
       ├── Recovery
       └── Documentation</div>
                </div>

                <!-- MITRE ATT&CK Coverage -->
                <h2><i class="fas fa-shield-alt"></i> MITRE ATT&CK Coverage</h2>
                <div class="config-section">
                    <div class="code-block">Cortex XDR MITRE ATT&CK Coverage:

HIGH COVERAGE TACTICS:
├── Execution (T1059, T1053, T1047)
│   └── Script interpreters, scheduled tasks, WMI
├── Persistence (T1547, T1543, T1053)
│   └── Registry run keys, services, scheduled tasks
├── Defense Evasion (T1055, T1070, T1036)
│   └── Injection, log clearing, masquerading
├── Credential Access (T1003, T1558)
│   └── LSASS dumping, Kerberos attacks
└── Command & Control (T1071, T1095, T1573)
    └── Web protocols, non-standard ports, encrypted

COVERAGE VISUALIZATION:
PATH: Investigation → Analytics → MITRE ATT&CK

COVERAGE METRICS:
├── Techniques covered: 150+
├── Sub-techniques covered: 300+
├── Custom rules can extend coverage
└── Regular content updates add more

VIEWING COVERAGE:
1. Navigate to MITRE ATT&CK matrix view
2. See highlighted techniques (detected)
3. Click technique for alert examples
4. Identify gaps for custom rule development</div>
                </div>

                <!-- Analytics Configuration -->
                <h2><i class="fas fa-cog"></i> Analytics Configuration</h2>
                <div class="config-section">
                    <p><span class="console-path">Detection Rules → Analytics Rules</span></p>

                    <div class="code-block">Analytics Rule Configuration:

RULE TYPES:
├── Analytics BIOC Rules (behavioral)
├── IOC Rules (indicators)
├── Correlation Rules (multi-event)
└── Exception Rules (allowlisting)

BIOC RULE STRUCTURE:
{
  "name": "Suspicious PowerShell Download",
  "description": "PowerShell downloading executable",
  "severity": "HIGH",
  "mitre_tactic": "Execution",
  "mitre_technique": "T1059.001",
  "query": {
    "process_name": "powershell.exe",
    "command_line": ["*downloadfile*", "*invoke-webrequest*"],
    "network_connection": true
  }
}

TUNING OPTIONS:
├── Severity override
├── Process exclusions
├── User exclusions
├── Hash allowlist
├── Path exclusions
└── Signature exclusions

BEST PRACTICES:
├── Start with OOTB rules enabled
├── Monitor false positive rate
├── Create targeted exceptions
├── Document all exclusions
├── Regular rule review
└── Test custom rules thoroughly</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Explain Cortex XDR's detection layers.</button>
                        <div class="qa-answer">
                            <p>Cortex XDR uses multi-layer detection:</p>
                            <ul>
                                <li><strong>Local Static:</strong> Hash matching, file analysis on endpoint</li>
                                <li><strong>Exploit Prevention:</strong> Memory protection, technique blocking</li>
                                <li><strong>Behavioral Analysis:</strong> Process/behavior monitoring locally</li>
                                <li><strong>Cloud Analytics:</strong> ML models, cross-customer intelligence</li>
                                <li><strong>BTP:</strong> Behavioral threat protection, UEBA</li>
                                <li><strong>Custom Rules:</strong> BIOC, IOC, Correlation</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What is Behavioral Threat Protection?</button>
                        <div class="qa-answer">
                            <p><strong>BTP</strong> is cloud-based behavioral analytics that detects:</p>
                            <ul>
                                <li>Credential theft (LSASS, Kerberoasting)</li>
                                <li>Ransomware behavior patterns</li>
                                <li>Lateral movement techniques</li>
                                <li>Command & control communication</li>
                            </ul>
                            <p>It uses ML and cross-customer intelligence for detection.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How does Cortex XDR use machine learning?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Supervised:</strong> Classify malware vs benign files</li>
                                <li><strong>Unsupervised:</strong> Anomaly detection, baseline deviation</li>
                                <li><strong>Behavioral Sequencing:</strong> Attack chain recognition</li>
                            </ul>
                            <p>Models trained on WildFire samples, threat intel, and customer telemetry.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What exploit prevention techniques does Cortex XDR use?</button>
                        <div class="qa-answer">
                            <ul>
                                <li>DEP/ASLR enforcement</li>
                                <li>Stack pivot and ROP detection</li>
                                <li>JIT spraying prevention</li>
                                <li>DLL injection detection</li>
                                <li>Process hollowing prevention</li>
                            </ul>
                            <p>Configured via Exploit Security Profiles per endpoint group.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>