<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics | Cortex XDR | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Cortex XDR</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="agent-deployment.html" class="nav-link"><i class="fas fa-download"></i> Agent Deployment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection</div>
                    <a href="bioc-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> BIOC Rules</a>
                    <a href="analytics.html" class="nav-link active"><i class="fas fa-brain"></i> Analytics (ML)</a>
                    <a href="causality.html" class="nav-link"><i class="fas fa-sitemap"></i> Causality Analysis</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Hunting & Response</div>
                    <a href="xql-hunting.html" class="nav-link"><i class="fas fa-search"></i> XQL Hunting</a>
                    <a href="xql-reference.html" class="nav-link"><i class="fas fa-book"></i> XQL Reference</a>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-hand-paper"></i> Response Actions</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Cortex XDR</a><span class="separator">/</span>
                    <span class="current">Analytics</span>
                </div>
            </header>
            <main class="main-content">
<div class="content-header">
            <h1>ğŸŸ  Analytics & Machine Learning</h1>
            <p>Cortex XDR's behavioral analytics and ML-powered threat detection</p>
        </div>
        <section class="content-section">
            <h2>Analytics Engine Overview</h2>
            <div class="architecture-diagram">
                <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CORTEX XDR ANALYTICS ENGINE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                          DATA SOURCES                                    â”‚    â”‚
â”‚  â”‚  [Endpoint] [Network] [Cloud] [Identity] [Third-Party]                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚                                           â”‚
â”‚                                     â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     DETECTION ENGINES                                    â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚   Behavioral â”‚   ML-Based   â”‚    Rules     â”‚   Threat     â”‚   Custom    â”‚    â”‚
â”‚  â”‚   Analytics  â”‚  Detection   â”‚   Engine     â”‚   Intel      â”‚   BIOC      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚                                           â”‚
â”‚                                     â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     ALERT CORRELATION                                    â”‚    â”‚
â”‚  â”‚         Grouping â†’ Deduplication â†’ Scoring â†’ Incident Creation          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </pre>
            </div>
        </section>
        <section class="content-section">
            <h2>Analytics BIOC Categories</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Detection Type</th>
                        <th>Examples</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Behavioral Threat Protection</strong></td>
                        <td>Process behavior anomalies</td>
                        <td>Unusual child processes, injection techniques</td>
                    </tr>
                    <tr>
                        <td><strong>Credential Theft</strong></td>
                        <td>Memory access patterns</td>
                        <td>LSASS access, SAM dumping</td>
                    </tr>
                    <tr>
                        <td><strong>Ransomware</strong></td>
                        <td>File encryption patterns</td>
                        <td>Mass file modifications, shadow copy deletion</td>
                    </tr>
                    <tr>
                        <td><strong>Exploit Prevention</strong></td>
                        <td>Memory manipulation</td>
                        <td>ROP chains, heap spraying</td>
                    </tr>
                    <tr>
                        <td><strong>Malware</strong></td>
                        <td>Static + behavioral</td>
                        <td>Known signatures, behavioral matching</td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section class="content-section">
            <h2>Machine Learning Models</h2>
            <h3>Local Analysis (On-Endpoint)</h3>
            <div class="info-box">
                <p>Lightweight ML models running on endpoints for real-time file analysis before execution.</p>
            </div>
            <ul>
                <li><strong>Static ML</strong>: Analyzes PE headers, imports, sections without execution</li>
                <li><strong>Local Behavioral</strong>: Monitors process behavior against baseline</li>
                <li><strong>Verdict Caching</strong>: Stores decisions for previously analyzed files</li>
            </ul>
            <h3>Cloud Analysis (WildFire)</h3>
            <div class="info-box">
                <p>Advanced analysis in Palo Alto Networks cloud for unknown files.</p>
            </div>
            <ul>
                <li><strong>Dynamic Analysis</strong>: Sandbox execution with behavioral monitoring</li>
                <li><strong>Bare Metal Analysis</strong>: Detects VM-aware malware</li>
                <li><strong>Deep Learning</strong>: Neural networks trained on millions of samples</li>
            </ul>
        </section>
        <section class="content-section">
            <h2>Analytics Alert Types</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Alert Type</th>
                        <th>Source</th>
                        <th>Confidence</th>
                        <th>Response</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Malware</strong></td>
                        <td>Signature/ML match</td>
                        <td>High</td>
                        <td>Block + Quarantine</td>
                    </tr>
                    <tr>
                        <td><strong>Behavioral Threat</strong></td>
                        <td>Behavioral analysis</td>
                        <td>Medium-High</td>
                        <td>Alert + Block (configurable)</td>
                    </tr>
                    <tr>
                        <td><strong>Analytics BIOC</strong></td>
                        <td>Correlation rules</td>
                        <td>Varies</td>
                        <td>Alert</td>
                    </tr>
                    <tr>
                        <td><strong>Custom BIOC</strong></td>
                        <td>User-defined XQL</td>
                        <td>User-defined</td>
                        <td>Alert</td>
                    </tr>
                    <tr>
                        <td><strong>IOC Match</strong></td>
                        <td>Threat intelligence</td>
                        <td>High</td>
                        <td>Alert + Block</td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section class="content-section">
            <h2>Tuning Analytics</h2>
            <h3>Reducing False Positives</h3>
            <div class="code-block">
                <pre><code># Add hash to allowlist
Endpoints â†’ Action Center â†’ Hash Exceptions â†’ Add to Allow List
# Add path exclusion
Profiles â†’ Select Profile â†’ Malware Security Profile â†’ Add Exclusion
Exclude: C:\CustomApp\legitimate_tool.exe
# Create exception for analytics BIOC
Rules â†’ Analytics BIOC Rules â†’ Select Rule â†’ Add Exception
Exception: actor_process_image_name = "approved_admin_tool.exe"</code></pre>
            </div>
            <h3>XQL for False Positive Analysis</h3>
            <div class="code-block">
                <pre><code>// Find frequent alert sources (potential FPs)
dataset = xdr_data 
| filter alert_name = "Suspicious PowerShell Activity"
| comp count() as alert_count by action_process_image_path
| sort desc alert_count
| filter alert_count > 10
| limit 20
// Analyze alert patterns by user
dataset = xdr_data 
| filter event_type = ENUM.EVENT_TYPE_ALERT
| comp count() as alerts by action_process_username, alert_name
| sort desc alerts
| limit 50</code></pre>
            </div>
        </section>
        <section class="interview-section">
            <h2>ğŸ’¼ Interview Questions</h2>
            <div class="interview-qa">
                <h4>Q: How does Cortex XDR use machine learning for threat detection?</h4>
                <p><strong>A:</strong> Cortex XDR uses ML at multiple layers. On the endpoint, lightweight static ML models analyze file characteristics like PE headers and import tables before execution. If a file is unknown, it's sent to WildFire cloud for deep analysis using dynamic sandboxing and neural networks trained on millions of samples. Beyond file-based detection, behavioral ML builds baselines of normal activity for users and endpoints, then flags anomalies like unusual process relationships or data access patterns. The Analytics BIOC engine correlates events across endpoints to detect attack patterns that might not trigger on individual events. This multi-layer approach catches both known malware and novel threats.</p>
            </div>
        </section>
        <div class="navigation-links">
            <a href="causality.html">â† Causality</a>
            <a href="xql-hunting.html">XQL Hunting â†’</a>
        </div>
            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>