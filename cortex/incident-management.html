<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Management | Cortex XDR</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Cortex XDR Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="fundamentals.html" class="nav-link"><i class="fas fa-book"></i> Fundamentals</a>
                    <a href="agent-deployment.html" class="nav-link"><i class="fas fa-download"></i> Agent Deployment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection</div>
                    <a href="analytics.html" class="nav-link"><i class="fas fa-chart-line"></i> Analytics Engine</a>
                    <a href="bioc-rules.html" class="nav-link"><i class="fas fa-code"></i> BIOC Rules</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Investigation</div>
                    <a href="xql-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> XQL Hunting</a>
                    <a href="xql-reference.html" class="nav-link"><i class="fas fa-book-open"></i> XQL Reference</a>
                    <a href="incident-management.html" class="nav-link active"><i class="fas fa-clipboard-list"></i> Incident Management</a>
                    <a href="causality.html" class="nav-link"><i class="fas fa-project-diagram"></i> Causality Analysis</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Response</div>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-bolt"></i> Response Actions</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Cortex XDR</a><span class="separator">/</span>
                    <span class="current">Incident Management</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-clipboard-list"></i> Incident Management</h1>
                <p class="lead">Master incident management in Cortex XDR. Learn to triage alerts, investigate incidents, use the causality chain, and manage the complete incident lifecycle.</p>

                <!-- Incident Overview -->
                <h2><i class="fas fa-info-circle"></i> Incident Overview</h2>
                <div class="config-section">
                    <p><span class="console-path">Incidents → Incident Management</span></p>

                    <h4>Incident vs Alert</h4>
                    <div class="code-block">Cortex XDR Hierarchy:

INCIDENT:
- Container for related alerts
- Unified investigation view
- Single entity for tracking
- Assigned to analyst

ALERT:
- Individual detection
- Part of an incident
- Specific trigger event
- May be standalone or grouped

Automatic Grouping:
- Same endpoint
- Same user
- Related processes
- Time proximity
- Causality connection</div>

                    <h4>Incident Severity</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Severity</th><th>Description</th><th>Response</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Critical</strong></td><td>Active threat, immediate risk</td><td>Immediate response</td></tr>
                            <tr><td><strong>High</strong></td><td>Serious threat, requires action</td><td>Same day response</td></tr>
                            <tr><td><strong>Medium</strong></td><td>Potential threat, investigation needed</td><td>24-48 hour response</td></tr>
                            <tr><td><strong>Low</strong></td><td>Minor issue, informational</td><td>As time permits</td></tr>
                            <tr><td><strong>Informational</strong></td><td>FYI, no immediate action</td><td>Review during maintenance</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Incident Queue -->
                <h2><i class="fas fa-list"></i> Incident Queue</h2>
                <div class="config-section">
                    <p><span class="console-path">Incidents → All Incidents</span></p>

                    <h4>Queue Columns</h4>
                    <div class="code-block">Key Incident Fields:

IDENTIFICATION:
- Incident ID: Unique identifier
- Incident Name: Auto-generated description
- Created: When first alert triggered

CLASSIFICATION:
- Severity: Critical/High/Medium/Low/Info
- Status: New/Under Investigation/Resolved
- Assigned To: Analyst owner

SCOPE:
- Alert Count: Number of grouped alerts
- Endpoint Count: Affected hosts
- User Count: Affected users

DETAILS:
- Description: Auto-generated summary
- Categories: MITRE tactics involved
- Detection Source: XDR/Network/Cloud</div>

                    <h4>Filtering and Prioritization</h4>
                    <div class="code-block">Effective Queue Management:

PRIORITY FILTERS:
1. Severity = Critical, High
2. Status = New (unassigned)
3. Alert Count > 5 (multiple detections)

USEFUL FILTERS:
- Time range (last 24h, 7d)
- Assigned to me
- Specific endpoint/user
- MITRE tactic category
- Detection source

SORT BY:
- Severity (Critical first)
- Created time (newest first)
- Alert count (most alerts first)</div>
                </div>

                <!-- Causality View -->
                <h2><i class="fas fa-project-diagram"></i> Causality View</h2>
                <div class="config-section">
                    <p><span class="console-path">Incident → Causality View</span></p>

                    <h4>Understanding Causality</h4>
                    <div class="code-block">Causality Chain Components:

CAUSALITY GRAPH:
- Visual process tree
- Parent-child relationships
- Network connections
- File operations
- Registry changes

NODE TYPES:
- Process: Running executable
- File: Created/modified files
- Network: Connections made
- Registry: Registry operations
- User: User context

CAUSALITY GROUP OWNER (CGO):
- Root cause process
- Origin of the attack chain
- Key for understanding attack

RELATIONSHIPS:
- Created by: Process spawned process
- Loaded: DLL/module loaded
- Connected to: Network connection
- Wrote: File written
- Modified: Registry changed</div>

                    <h4>Reading the Causality Chain</h4>
                    <div class="code-block">Analysis Approach:

1. FIND THE CGO
   - Identify root cause
   - How did attack start?
   - What user/process initiated?

2. FOLLOW THE CHAIN
   - What processes spawned?
   - What files were created?
   - What connections made?

3. IDENTIFY TECHNIQUES
   - Execution methods
   - Persistence mechanisms
   - Lateral movement
   - Data access

Example Chain:
outlook.exe
  └── winword.exe (opened attachment)
        └── cmd.exe (macro execution)
              └── powershell.exe (download cradle)
                    └── malware.exe (payload)
                          └── Connection to C2</div>
                </div>

                <!-- Alert Investigation -->
                <h2><i class="fas fa-search"></i> Alert Investigation</h2>
                <div class="config-section">
                    <h4>Alert Details</h4>
                    <div class="code-block">Alert Information:

DETECTION:
- Alert Name: What was detected
- Description: Detailed explanation
- MITRE ATT&CK: Mapped techniques
- Severity: Alert-level severity

SOURCE:
- Detection Source: XDR/Analytics/BIOC
- Detection Module: Specific detection
- Endpoint: Affected host
- User: Associated user

ARTIFACTS:
- Process: Command line, path, hash
- File: Name, path, SHA256
- Network: IP, port, domain
- Registry: Key, value, data

TIMELINE:
- First seen: Initial detection
- Last seen: Most recent activity
- Duration: Time span</div>

                    <h4>Investigation Steps</h4>
                    <div class="code-block">Alert Investigation Workflow:

1. READ THE ALERT
   □ What was detected?
   □ What's the severity?
   □ What technique is involved?

2. REVIEW CAUSALITY
   □ Find the CGO
   □ Trace the attack chain
   □ Identify all artifacts

3. CHECK SCOPE
   □ Is this isolated?
   □ Other endpoints affected?
   □ Same user elsewhere?

4. GATHER EVIDENCE
   □ Screenshot causality
   □ Note key artifacts
   □ Document timeline

5. DETERMINE VERDICT
   □ True Positive: Take action
   □ False Positive: Document, tune
   □ Benign: Close with notes</div>
                </div>

                <!-- Incident Status Management -->
                <h2><i class="fas fa-tasks"></i> Status Management</h2>
                <div class="config-section">
                    <h4>Incident Lifecycle</h4>
                    <div class="code-block">Incident Status Flow:

NEW
 │ Analyst reviews
 ▼
UNDER INVESTIGATION
 │ Analysis ongoing
 │ Response actions taken
 ▼
RESOLVED - TRUE POSITIVE
 │ Confirmed threat
 │ Remediation complete
 ▼
CLOSED

OR:

RESOLVED - FALSE POSITIVE
 │ Not a real threat
 │ Tuning needed
 ▼
CLOSED

OR:

RESOLVED - DUPLICATE
 │ Already handled
 ▼
CLOSED</div>

                    <h4>Resolution Categories</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Resolution</th><th>When to Use</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>True Positive</strong></td><td>Real security incident, action taken</td></tr>
                            <tr><td><strong>False Positive</strong></td><td>Incorrect detection, create exception</td></tr>
                            <tr><td><strong>Security Test</strong></td><td>Authorized penetration test/red team</td></tr>
                            <tr><td><strong>Duplicate</strong></td><td>Same as existing incident</td></tr>
                            <tr><td><strong>Other</strong></td><td>Doesn't fit other categories</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- XQL for Incidents -->
                <h2><i class="fas fa-code"></i> XQL for Investigation</h2>
                <div class="config-section">
                    <h4>Incident Investigation Queries</h4>
                    <div class="code-block">// All alerts for a host
dataset = xdr_data
| filter agent_hostname = "WORKSTATION01"
| filter event_type = ENUM.EVENT_TYPE.ALERT
| fields _time, alert_name, alert_description, action_process_image_path

// Process activity for user
dataset = xdr_data
| filter event_type = PROCESS
| filter actor_effective_username = "jdoe"
| fields _time, agent_hostname, action_process_image_name, 
         action_process_image_command_line

// Network connections from endpoint
dataset = xdr_data
| filter agent_hostname = "WORKSTATION01"
| filter event_type = NETWORK
| filter action_remote_ip != null
| fields _time, action_process_image_name, action_remote_ip, 
         action_remote_port, action_local_port

// File creation timeline
dataset = xdr_data
| filter agent_hostname = "WORKSTATION01"
| filter event_type = FILE
| filter action_file_name != null
| sort asc _time
| fields _time, action_file_name, action_file_path, 
         actor_process_image_name</div>
                </div>

                <!-- Bulk Operations -->
                <h2><i class="fas fa-clone"></i> Bulk Operations</h2>
                <div class="config-section">
                    <div class="code-block">Bulk Incident Management:

SELECT MULTIPLE:
- Checkbox selection
- Shift+click for range
- Select all visible

BULK ACTIONS:
- Assign to analyst
- Change status
- Change severity
- Add comment
- Link incidents

USE CASES:
- Assign related incidents to one analyst
- Close multiple false positives
- Bulk update after policy change</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you use the Causality View to investigate an incident?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Find the CGO:</strong> Identify the root cause process</li>
                                <li><strong>Read left-to-right:</strong> Follow the attack chain chronologically</li>
                                <li><strong>Check relationships:</strong> Process spawns, file writes, network connections</li>
                                <li><strong>Identify techniques:</strong> Map to MITRE ATT&CK</li>
                                <li><strong>Document artifacts:</strong> Hashes, IPs, paths for response</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you prioritize incidents in the queue?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Severity:</strong> Critical and High first</li>
                                <li><strong>Asset value:</strong> Servers, executives, critical systems</li>
                                <li><strong>Alert count:</strong> More alerts = more activity</li>
                                <li><strong>Age:</strong> Don't let incidents go stale</li>
                                <li><strong>Active threats:</strong> Ransomware, C2 = immediate</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between an incident and an alert in Cortex XDR?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Alert:</strong> Single detection event from a specific rule</li>
                                <li><strong>Incident:</strong> Container grouping related alerts together</li>
                                <li>Incidents provide unified view for investigation</li>
                                <li>Multiple alerts can be correlated into one incident</li>
                                <li>Analysts work at incident level for efficiency</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>