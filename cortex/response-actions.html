<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Response Actions | Cortex XDR</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link active" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Cortex XDR Pages</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="agent-deployment.html" class="sidebar-nav-link">
                            <i class="fas fa-download"></i>
                            <span>Agent Deployment</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="analytics.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>Analytics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="bioc-rules.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>Bioc Rules</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="causality.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>Causality</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-management.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Management</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="response-actions.html" class="sidebar-nav-link active">
                            <i class="fas fa-terminal"></i>
                            <span>Response Actions</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-hunting.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Xql Hunting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-reference.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Xql Reference</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Cortex XDR</a>
                    <span class="separator">/</span>
                    <span class="current">Response Actions</span>
                </div>

                <h1><i class="fas fa-shield-alt"></i> Response Actions</h1>
                <p class="lead">Master incident response capabilities in Cortex XDR. Learn containment, Live Terminal, remediation scripts, and automated response workflows.</p>

                <!-- Response Actions Overview -->
                <h2><i class="fas fa-bolt"></i> Response Capabilities</h2>
                <div class="config-section">
                    <p><span class="console-path">Response → Action Center</span></p>

                    <h4>Available Response Actions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Action</th><th>Description</th><th>Location</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Isolate Endpoint</strong></td>
                                <td>Block network except XDR</td>
                                <td>Endpoint / Alert</td>
                            </tr>
                            <tr>
                                <td><strong>Kill Process</strong></td>
                                <td>Terminate running process</td>
                                <td>Causality View</td>
                            </tr>
                            <tr>
                                <td><strong>Quarantine File</strong></td>
                                <td>Remove and secure file</td>
                                <td>Alert / Live Terminal</td>
                            </tr>
                            <tr>
                                <td><strong>Block Hash</strong></td>
                                <td>Add to global blocklist</td>
                                <td>Alert / Policy</td>
                            </tr>
                            <tr>
                                <td><strong>Live Terminal</strong></td>
                                <td>Remote shell access</td>
                                <td>Endpoint Details</td>
                            </tr>
                            <tr>
                                <td><strong>Run Script</strong></td>
                                <td>Execute remediation script</td>
                                <td>Scripts Library</td>
                            </tr>
                            <tr>
                                <td><strong>Retrieve File</strong></td>
                                <td>Download file for analysis</td>
                                <td>Alert / Live Terminal</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Endpoint Isolation -->
                <h2><i class="fas fa-unlink"></i> Endpoint Isolation</h2>
                <div class="config-section">
                    <p><span class="console-path">Assets → Endpoints → [Endpoint] → Isolate</span></p>

                    <h4>Isolation Behavior</h4>
                    <div class="arch-diagram">Isolation Effects:

What's Blocked:
- All inbound network traffic
- All outbound network traffic
- Lateral movement prevented
- C2 communication stopped

What's Allowed:
- Cortex XDR cloud communication
- Agent telemetry continues
- Live Terminal sessions work
- Policy updates received

User Experience:
- No network connectivity
- Browser/apps won't connect
- Can still log in locally
- Desktop notification shown</div>

                    <h4>Isolation Workflow</h4>
                    <div class="arch-diagram">1. Initiate Isolation
   From Endpoint: Assets → Endpoints → [Name] → Isolate
   From Alert: Right-click host → Isolate Endpoint
   From Incident: Response Actions → Isolate

2. Confirm Action
   - Add comment (required)
   - Click "Isolate"
   - Status changes to "Isolated"

3. Continue Investigation
   - Start Live Terminal (still works)
   - Review causality chain
   - Check for lateral movement
   - Identify scope

4. Remediate
   - Use Live Terminal to clean
   - Remove persistence
   - Kill malicious processes
   - Quarantine files

5. Unisolate
   - Verify threat eliminated
   - Click "Unisolate"
   - Monitor for recurrence</div>

                    <h4>When to Isolate</h4>
                    <div class="arch-diagram">Isolate Immediately:
✓ Active ransomware execution
✓ Confirmed C2 communication
✓ Credential theft in progress
✓ Lateral movement observed
✓ Data exfiltration detected

Consider Alternatives:
- Low severity detection
- Possible false positive
- Critical business system
- After-hours (coordinate first)</div>
                </div>

                <!-- Live Terminal -->
                <h2><i class="fas fa-terminal"></i> Live Terminal</h2>
                <div class="config-section">
                    <p><span class="console-path">Assets → Endpoints → [Endpoint] → Live Terminal</span></p>

                    <h4>Live Terminal Capabilities</h4>
                    <div class="arch-diagram">Session Features:

Navigation:
- Full filesystem access
- Directory browsing
- File operations

Investigation:
- Process listing
- Network connections
- Registry queries
- Service status

Response:
- Kill processes
- Delete files
- Run scripts
- Collect artifacts

Forensics:
- File retrieval
- Memory collection
- Registry export</div>

                    <h4>Basic Commands</h4>
                    <div class="arch-diagram"># Navigation
cd [path]              # Change directory
dir / ls               # List files
pwd                    # Current directory

# File Operations
cat [file]             # View file contents
get [file]             # Download file
put [file]             # Upload file
delete [file]          # Delete file

# Process Information
processes              # List all processes
netstat                # Network connections

# System Information
ipconfig               # Network configuration
reg query [key]        # Registry query

# Services
sc query               # List services
sc query [name]        # Service status</div>

                    <h4>Advanced Commands</h4>
                    <div class="arch-diagram"># Process Control
kill [pid]             # Terminate process

# Remediation
remediate [file]       # Quarantine file
script [name]          # Run script from library

# Collection
collect                # Collect investigation package
memdump [pid]          # Dump process memory

# Registry
reg delete [key]       # Delete registry key/value

# Scheduled Tasks
schtasks /query        # List scheduled tasks
schtasks /delete       # Remove task</div>

                    <h4>Live Terminal Investigation Examples</h4>
                    <div class="arch-diagram"># Investigate suspicious process
processes
# Note PID of suspicious process
netstat | findstr [pid]

# Get suspicious file
cd C:\Users\victim\AppData\Local\Temp
dir
get malware.exe

# Check persistence
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
reg query HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run

# Check scheduled tasks
schtasks /query /fo LIST /v | findstr /i "malware"

# Kill and quarantine
kill [pid]
remediate C:\path\to\malware.exe

# Verify removal
processes | findstr malware
dir C:\path\to\</div>
                </div>

                <!-- Scripts Library -->
                <h2><i class="fas fa-code"></i> Scripts Library</h2>
                <div class="config-section">
                    <p><span class="console-path">Response → Scripts Library</span></p>

                    <h4>Built-in Scripts</h4>
                    <div class="arch-diagram">Pre-built Scripts:

Investigation:
- Get process list
- Get network connections
- Get scheduled tasks
- Get services
- Get autoruns
- Collect system info

Remediation:
- Delete file
- Kill process
- Remove registry key
- Remove scheduled task
- Clear browser cache

Forensics:
- Memory acquisition
- Collect event logs
- Export registry hives</div>

                    <h4>Custom Script Creation</h4>
                    <div class="arch-diagram">Creating Custom Scripts:

1. Navigate to Scripts Library
   Response → Scripts Library

2. Click "New Script"
   - Name: Descriptive name
   - Description: What it does
   - Script type: PowerShell/Shell/Python
   - Content: Script code

3. Set Permissions
   - Who can run
   - Which endpoints

4. Test Script
   - Run on test endpoint
   - Verify results

Script Types:
- PowerShell (.ps1) - Windows
- Shell (.sh) - Linux/Mac
- Python (.py) - Cross-platform</div>

                    <h4>Example Remediation Script</h4>
                    <div class="arch-diagram"># Remove-Persistence.ps1
# Remove common persistence mechanisms

param(
    [string]$MalwareName = "malware"
)

# Remove from Run keys
$runKeys = @(
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run",
    "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
)

foreach ($key in $runKeys) {
    $items = Get-ItemProperty -Path $key -ErrorAction SilentlyContinue
    $items.PSObject.Properties | Where-Object { 
        $_.Value -like "*$MalwareName*" 
    } | ForEach-Object {
        Remove-ItemProperty -Path $key -Name $_.Name -Force
        Write-Output "Removed: $($_.Name) from $key"
    }
}

# Remove scheduled tasks
Get-ScheduledTask | Where-Object { 
    $_.TaskName -like "*$MalwareName*" 
} | Unregister-ScheduledTask -Confirm:$false

# Remove services
Get-Service | Where-Object { 
    $_.Name -like "*$MalwareName*" -or $_.DisplayName -like "*$MalwareName*" 
} | ForEach-Object {
    Stop-Service $_.Name -Force
    sc.exe delete $_.Name
    Write-Output "Removed service: $($_.Name)"
}

Write-Output "Persistence removal complete"</div>
                </div>

                <!-- Action Center -->
                <h2><i class="fas fa-tasks"></i> Action Center</h2>
                <div class="config-section">
                    <p><span class="console-path">Response → Action Center</span></p>

                    <h4>Action Center Features</h4>
                    <div class="arch-diagram">Action Center Views:

Pending Actions:
- Actions awaiting completion
- Status tracking
- Cancel if needed

Completed Actions:
- Historical actions
- Success/failure status
- Audit trail

Action Types Tracked:
- Isolate/Unisolate
- File quarantine
- Process termination
- Script execution
- File retrieval
- Scan requests</div>

                    <h4>Bulk Actions</h4>
                    <div class="arch-diagram">Performing Bulk Actions:

From Endpoints View:
1. Select multiple endpoints
2. Click "Actions"
3. Choose action type
4. Confirm

Bulk Action Types:
- Isolate multiple endpoints
- Run script on multiple endpoints
- Scan multiple endpoints

Use Cases:
- Widespread malware outbreak
- Campaign affecting multiple hosts
- Proactive threat hunting response</div>
                </div>

                <!-- XSOAR Integration -->
                <h2><i class="fas fa-robot"></i> XSOAR Automated Response</h2>
                <div class="config-section">
                    <h4>Automated Playbook Actions</h4>
                    <div class="arch-diagram">XSOAR Response Commands:

Endpoint Actions:
!xdr-isolate-endpoint endpoint_id=<id>
!xdr-unisolate-endpoint endpoint_id=<id>
!xdr-endpoint-scan endpoint_id=<id>

File Actions:
!xdr-file-quarantine endpoint_id=<id> file_path=<path>
!xdr-file-retrieve endpoint_id=<id> file_path=<path>
!xdr-blocklist-files hash_list=<hashes>

Process Actions:
!xdr-kill-process endpoint_id=<id> process_name=<name>

Script Actions:
!xdr-run-script endpoint_ids=<ids> script_uid=<uid></div>

                    <h4>Example Automated Playbook</h4>
                    <div class="arch-diagram">Malware Response Playbook:

Trigger: High severity malware alert

Steps:
1. Enrich Indicators
   - Hash lookup in VirusTotal
   - IP reputation check
   - Domain analysis

2. Assess Scope
   - Query for hash across environment
   - Identify all affected hosts

3. Contain (if confirmed malicious)
   - Isolate affected endpoints
   - Block hash globally

4. Remediate
   - Kill malicious processes
   - Quarantine malware files
   - Run persistence removal script

5. Notify
   - Create ticket
   - Send Teams notification
   - Update incident</div>
                </div>

                <!-- Response Playbooks -->
                <h2><i class="fas fa-book"></i> Response Playbooks</h2>
                <div class="config-section">
                    <h4>Ransomware Response</h4>
                    <div class="arch-diagram">Ransomware Playbook:

IMMEDIATE (0-5 minutes):
□ Isolate affected endpoint(s)
□ Block ransomware hash globally
□ Identify ransomware family
□ Alert IR team

SCOPE (5-30 minutes):
□ Search for hash across environment
□ Check for lateral movement
□ Identify encryption scope
□ Find patient zero

CONTAIN (30-60 minutes):
□ Isolate all affected systems
□ Block C2 infrastructure
□ Disable compromised accounts
□ Preserve evidence

ERADICATE:
□ Live Terminal to remove malware
□ Clear persistence mechanisms
□ Verify removal on all systems
□ Document IOCs

RECOVER:
□ Restore from backups
□ Unisolate gradually
□ Monitor for re-infection</div>

                    <h4>Credential Theft Response</h4>
                    <div class="arch-diagram">Credential Theft Playbook:

IMMEDIATE:
□ Isolate source device
□ Identify tool used
□ Determine accounts accessed
□ Reset compromised passwords

INVESTIGATE:
□ Review causality chain
□ Check for LSASS access
□ Look for DCSync attempts
□ Review authentication logs

SCOPE:
□ Search for tool hash
□ Check other endpoints
□ Identify lateral movement
□ Map compromised accounts

REMEDIATE:
□ Reset all compromised passwords
□ Revoke active sessions
□ Remove attacker persistence
□ Enable additional controls</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk through your Live Terminal investigation workflow.</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Review alert:</strong> Understand what triggered detection</li>
                                <li><strong>Check processes:</strong> Run 'processes' to find malicious ones</li>
                                <li><strong>Network connections:</strong> 'netstat' to find C2</li>
                                <li><strong>File analysis:</strong> Navigate to suspicious files, 'get' for analysis</li>
                                <li><strong>Persistence:</strong> Check run keys, scheduled tasks, services</li>
                                <li><strong>Remediate:</strong> Kill process, quarantine file, remove persistence</li>
                                <li><strong>Verify:</strong> Confirm removal, check for related activity</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does endpoint isolation work in Cortex XDR?</button>
                        <div class="qa-answer">
                            <ul>
                                <li>Blocks all network traffic except XDR cloud</li>
                                <li>Agent continues sending telemetry</li>
                                <li>Live Terminal sessions still function</li>
                                <li>User loses network but can work locally</li>
                                <li>Must manually unisolate when safe</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Key benefit:</strong> Stops lateral movement and C2 while allowing continued investigation.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: When would you use a script vs manual Live Terminal?</button>
                        <div class="qa-answer">
                            <p><strong>Use Scripts for:</strong></p>
                            <ul>
                                <li>Repeated remediation tasks</li>
                                <li>Complex multi-step procedures</li>
                                <li>Bulk actions on multiple hosts</li>
                                <li>Standardized evidence collection</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Use Manual for:</strong></p>
                            <ul>
                                <li>Initial investigation/exploration</li>
                                <li>Unique situations</li>
                                <li>When you need to see results interactively</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>