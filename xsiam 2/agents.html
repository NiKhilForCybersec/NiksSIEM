<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cortex XDR Agent - Complete Configuration Guide | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <main class="main-content">
            <a href="../index.html" class="back-home"><i class="fas fa-arrow-left"></i> Nik's SIEM</a>
            
            <div class="breadcrumb">
                <a href="../index.html">Home</a>
                <span class="separator">/</span>
                <a href="index.html">XSIAM</a>
                <span class="separator">/</span>
                <span class="current">Cortex XDR Agent - Complete Configuration Guide</span>
            </div>

<h1><i class="fas fa-desktop"></i> Cortex XDR Agent - Complete Configuration Guide</h1>
                <p class="lead">The Cortex XDR agent is the endpoint sensor that collects telemetry and enables response actions. This guide covers installation, policy configuration, data collection tuning, and troubleshooting with actual console paths and commands.</p>

                <!-- Agent Overview -->
                <h2><i class="fas fa-info-circle"></i> What Data Does the Agent Collect?</h2>
                
                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-database"></i> Agent Telemetry Categories</h4>
                    <p>The Cortex XDR agent collects the following data types (all configurable via policy):</p>
                </div>

                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Data Type</th>
                                <th>What It Captures</th>
                                <th>XDM Dataset</th>
                                <th>Typical Volume</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Process Execution</strong></td>
                                <td>Every process start: path, command line, parent process, user, hash</td>
                                <td><span class="field-ref">xdr_data</span> event_type=PROCESS</td>
                                <td>~500-2000 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>File Operations</strong></td>
                                <td>Create, modify, delete, rename of files (configurable paths)</td>
                                <td><span class="field-ref">xdr_data</span> event_type=FILE</td>
                                <td>~1000-5000 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>Network Connections</strong></td>
                                <td>Outbound/inbound connections: IP, port, process, bytes</td>
                                <td><span class="field-ref">xdr_data</span> event_type=NETWORK</td>
                                <td>~200-1000 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>Registry (Windows)</strong></td>
                                <td>Key creation, modification, deletion (security-relevant keys)</td>
                                <td><span class="field-ref">xdr_data</span> event_type=REGISTRY</td>
                                <td>~100-500 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>Module/DLL Loads</strong></td>
                                <td>Libraries loaded by processes</td>
                                <td><span class="field-ref">xdr_data</span> event_type=LOAD_IMAGE</td>
                                <td>~500-2000 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>Authentication</strong></td>
                                <td>Local logons, logoffs, failed attempts</td>
                                <td><span class="field-ref">xdr_data</span> event_type=AUTH</td>
                                <td>~10-100 events/endpoint/day</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Installation Methods -->
                <h2><i class="fas fa-download"></i> Agent Installation Methods</h2>

                <h3>Method 1: Manual Installation (Single Endpoint)</h3>
                <div class="config-section">
                    <h4>Step 1: Download Agent Package</h4>
                    <div class="console-path">XSIAM Console → Settings → Endpoints → Agent Installation</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Navigate to Agent Downloads</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Go to Settings (gear icon) → Endpoints → Agent Installation</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Select Platform & Version</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Choose: Windows (64-bit), macOS, or Linux. Select latest stable version.</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Download Package</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Download includes: installer + distribution ID (auto-configured)</p>
                        </div>
                    </div>

                    <h4>Windows Installation Command</h4>
                    <div class="code-block">
<span class="code-comment"># Run as Administrator</span>
<span class="code-command">msiexec</span> /i CortexXDR_x64.msi /qn <span class="code-param">DISTRIBUTION_ID</span>=<span class="code-value">"your-distribution-id"</span>

<span class="code-comment"># With custom installation path</span>
<span class="code-command">msiexec</span> /i CortexXDR_x64.msi /qn <span class="code-param">DISTRIBUTION_ID</span>=<span class="code-value">"your-distribution-id"</span> <span class="code-param">INSTALLDIR</span>=<span class="code-value">"C:\Program Files\Cortex XDR"</span>

<span class="code-comment"># Silent install with logging</span>
<span class="code-command">msiexec</span> /i CortexXDR_x64.msi /qn /l*v <span class="code-value">C:\temp\cortex_install.log</span> <span class="code-param">DISTRIBUTION_ID</span>=<span class="code-value">"your-distribution-id"</span>
                    </div>

                    <h4>macOS Installation Command</h4>
                    <div class="code-block">
<span class="code-comment"># Install the PKG file</span>
<span class="code-command">sudo</span> installer -pkg CortexXDR.pkg -target /

<span class="code-comment"># The distribution ID is embedded in the package</span>
<span class="code-comment"># Verify installation</span>
<span class="code-command">/Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool</span> info
                    </div>

                    <h4>Linux Installation Commands</h4>
                    <div class="code-block">
<span class="code-comment"># RHEL/CentOS (RPM)</span>
<span class="code-command">sudo</span> rpm -ivh cortex-xdr-agent.rpm

<span class="code-comment"># Ubuntu/Debian (DEB)</span>
<span class="code-command">sudo</span> dpkg -i cortex-xdr-agent.deb

<span class="code-comment"># Verify agent status</span>
<span class="code-command">sudo</span> /opt/traps/bin/cytool runtime status
                    </div>
                </div>

                <h3>Method 2: Mass Deployment via SCCM/Intune</h3>
                <div class="config-section">
                    <h4>Microsoft Intune Deployment</h4>
                    <div class="console-path">Intune Admin Center → Apps → Windows → Add → Line-of-business app</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Prepare the MSI Package</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Download MSI from XSIAM console. Note: Intune requires the MSI, not EXE.</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Create App in Intune</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Apps → Windows → Add → Select "Line-of-business app" → Upload MSI</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Configure Command Line Arguments</strong>
                            <div class="code-block" style="margin-top: 8px;">
<span class="code-comment"># Command line arguments field:</span>
<span class="code-param">DISTRIBUTION_ID</span>=<span class="code-value">"your-distribution-id"</span> <span class="code-param">REBOOT</span>=<span class="code-value">ReallySuppress</span>
                            </div>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div>
                            <strong>Assign to Device Groups</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Assignments → Add group → Select "All devices" or specific device groups</p>
                        </div>
                    </div>

                    <h4>SCCM Deployment</h4>
                    <div class="code-block">
<span class="code-comment"># Create Application in SCCM</span>
<span class="code-comment"># Software Library → Applications → Create Application</span>

<span class="code-comment"># Installation Program:</span>
<span class="code-command">msiexec</span> /i CortexXDR_x64.msi /qn DISTRIBUTION_ID=<span class="code-value">"your-id"</span> REBOOT=ReallySuppress

<span class="code-comment"># Detection Method: File exists</span>
Path: C:\Program Files\Palo Alto Networks\Traps
File: cyserver.exe

<span class="code-comment"># Uninstall Program:</span>
<span class="code-command">msiexec</span> /x {Product-GUID} /qn
                    </div>

                    <h4>GPO Deployment</h4>
                    <div class="code-block">
<span class="code-comment"># 1. Copy MSI to network share accessible by all computers</span>
\\server\share\CortexXDR_x64.msi

<span class="code-comment"># 2. Create GPO: Computer Configuration → Policies → Software Settings</span>
<span class="code-comment"># 3. Right-click "Software Installation" → New → Package</span>
<span class="code-comment"># 4. Browse to MSI on network share</span>
<span class="code-comment"># 5. Select "Assigned" deployment method</span>

<span class="code-comment"># For command-line parameters, use MST transform file or startup script instead</span>
                    </div>
                </div>

                <!-- Agent Profiles & Policies -->
                <h2><i class="fas fa-cog"></i> Agent Profiles & Policy Configuration</h2>
                
                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-exclamation-triangle"></i> Understanding Agent Policies</h4>
                    <p>Agent behavior is controlled by <strong>Endpoint Profiles</strong>. Each profile defines what data to collect, what to block, and response capabilities. Profiles are assigned to <strong>Endpoint Groups</strong> based on rules (OS, hostname pattern, AD group, etc.).</p>
                </div>

                <div class="console-path">XSIAM Console → Settings → Endpoints → Policy Management → Profiles</div>

                <h3>Creating an Endpoint Profile</h3>
                <div class="config-section">
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Navigate to Profiles</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Settings → Endpoints → Policy Management → Profiles → + New Profile</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Select Profile Type</strong>
                            <ul style="color: #8b949e; margin: 4px 0; font-size: 0.9rem;">
                                <li><strong>Windows Workstation</strong> - For desktops/laptops</li>
                                <li><strong>Windows Server</strong> - Optimized for server workloads</li>
                                <li><strong>macOS</strong> - Mac endpoints</li>
                                <li><strong>Linux</strong> - Linux servers/workstations</li>
                            </ul>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Configure Profile Settings</strong>
                            <p style="color: #8b949e; margin: 4px 0;">See detailed settings below</p>
                        </div>
                    </div>
                </div>

                <h3>Profile Settings Deep Dive</h3>

                <h4>Malware Protection Settings</h4>
                <div class="config-section">
                    <table class="policy-table">
                        <thead>
                            <tr>
                                <th>Setting</th>
                                <th>Options</th>
                                <th>Recommendation</th>
                                <th>Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Malware Protection</strong></td>
                                <td>Enabled / Disabled</td>
                                <td><span class="toggle-on">Enabled</span></td>
                                <td>Real-time scanning of files</td>
                            </tr>
                            <tr>
                                <td><strong>Malware Protection Action</strong></td>
                                <td>Block and Quarantine / Report Only</td>
                                <td>Block and Quarantine</td>
                                <td>Blocks execution of known malware</td>
                            </tr>
                            <tr>
                                <td><strong>Behavioral Threat Protection</strong></td>
                                <td>Enabled / Disabled</td>
                                <td><span class="toggle-on">Enabled</span></td>
                                <td>Detects suspicious behavior patterns</td>
                            </tr>
                            <tr>
                                <td><strong>Anti-Ransomware</strong></td>
                                <td>Enabled / Disabled</td>
                                <td><span class="toggle-on">Enabled</span></td>
                                <td>Protects against encryption attacks</td>
                            </tr>
                            <tr>
                                <td><strong>Exploit Protection</strong></td>
                                <td>Enabled / Disabled</td>
                                <td><span class="toggle-on">Enabled</span></td>
                                <td>Blocks memory exploitation techniques</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h4>Data Collection Settings (THE KEY PART)</h4>
                <div class="config-section">
                    <div class="console-path">Profile → Data Collection → Extended Data Collection</div>
                    
                    <div class="info-box" style="border-color: #3fb950;">
                        <h4><i class="fas fa-database"></i> This Is Where You Control What Data Gets Sent to XSIAM</h4>
                        <p>The "Extended Data Collection" section determines the telemetry richness. More collection = better detection but more data volume.</p>
                    </div>

                    <table class="policy-table">
                        <thead>
                            <tr>
                                <th>Collection Setting</th>
                                <th>What It Collects</th>
                                <th>Recommendation</th>
                                <th>Volume Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Process Execution</strong></td>
                                <td>All process starts with full command line, parent process, user</td>
                                <td><span class="toggle-on">Always Enable</span></td>
                                <td>High - but essential</td>
                            </tr>
                            <tr>
                                <td><strong>Command Line Logging</strong></td>
                                <td>Full command line arguments for every process</td>
                                <td><span class="toggle-on">Always Enable</span></td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>File Operations</strong></td>
                                <td>File create/modify/delete/rename events</td>
                                <td><span class="toggle-on">Enable</span></td>
                                <td>High</td>
                            </tr>
                            <tr>
                                <td><strong>Network Connections</strong></td>
                                <td>All TCP/UDP connections with process context</td>
                                <td><span class="toggle-on">Enable</span></td>
                                <td>Medium-High</td>
                            </tr>
                            <tr>
                                <td><strong>Registry Operations</strong></td>
                                <td>Registry key changes (Windows only)</td>
                                <td><span class="toggle-on">Enable</span></td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>Module/Image Loads</strong></td>
                                <td>DLL/SO loads by processes</td>
                                <td>Enable for high-security endpoints</td>
                                <td>Very High</td>
                            </tr>
                            <tr>
                                <td><strong>Script Execution</strong></td>
                                <td>PowerShell, VBScript, JScript content</td>
                                <td><span class="toggle-on">Always Enable</span></td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>DNS Queries</strong></td>
                                <td>All DNS lookups from endpoint</td>
                                <td>Enable if no NGFW DNS logging</td>
                                <td>High</td>
                            </tr>
                        </tbody>
                    </table>

                    <div style="margin-top: 16px; padding: 16px; background: #21262d; border-radius: 8px;">
                        <strong style="color: #d29922;">Critical for Detection:</strong>
                        <p style="color: #8b949e; margin: 8px 0 0 0;">Without <strong>Command Line Logging</strong> and <strong>Script Execution</strong> enabled, you will miss most attack techniques. These are essential for detecting encoded PowerShell, living-off-the-land attacks, and lateral movement.</p>
                    </div>
                </div>

                <h4>Response Actions Configuration</h4>
                <div class="config-section">
                    <div class="console-path">Profile → Response Actions</div>
                    
                    <table class="policy-table">
                        <thead>
                            <tr>
                                <th>Capability</th>
                                <th>What It Enables</th>
                                <th>Recommendation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Live Terminal</strong></td>
                                <td>Remote command execution on endpoint</td>
                                <td><span class="toggle-on">Enable</span> (requires approval workflow)</td>
                            </tr>
                            <tr>
                                <td><strong>File Retrieval</strong></td>
                                <td>Download files from endpoint for analysis</td>
                                <td><span class="toggle-on">Enable</span></td>
                            </tr>
                            <tr>
                                <td><strong>Network Isolation</strong></td>
                                <td>Isolate endpoint from network (except XSIAM)</td>
                                <td><span class="toggle-on">Enable</span></td>
                            </tr>
                            <tr>
                                <td><strong>Process Termination</strong></td>
                                <td>Kill running processes remotely</td>
                                <td><span class="toggle-on">Enable</span></td>
                            </tr>
                            <tr>
                                <td><strong>File Quarantine</strong></td>
                                <td>Quarantine malicious files</td>
                                <td><span class="toggle-on">Enable</span></td>
                            </tr>
                            <tr>
                                <td><strong>Script Execution</strong></td>
                                <td>Run remediation scripts remotely</td>
                                <td>Enable with approval</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Assigning Profiles to Endpoints -->
                <h2><i class="fas fa-users-cog"></i> Assigning Profiles to Endpoints</h2>
                
                <div class="config-section">
                    <div class="console-path">Settings → Endpoints → Policy Management → Endpoint Groups</div>
                    
                    <h4>Step 1: Create Endpoint Group</h4>
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>New Endpoint Group</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Endpoint Groups → + New Group → Name: "Windows Workstations"</p>
                        </div>
                    </div>
                    
                    <h4>Step 2: Define Group Rules</h4>
                    <p style="color: #8b949e;">Groups are dynamic - endpoints automatically join based on matching rules:</p>
                    
                    <div class="code-block">
<span class="code-comment"># Example Group Rules:</span>

<span class="code-comment"># All Windows 10/11 workstations</span>
<span class="code-param">os_type</span> = <span class="code-value">"Windows"</span> AND <span class="code-param">os_version</span> contains <span class="code-value">"10"</span>

<span class="code-comment"># Servers by hostname pattern</span>
<span class="code-param">hostname</span> matches <span class="code-value">"SRV-*"</span> OR <span class="code-param">hostname</span> matches <span class="code-value">"*-SERVER"</span>

<span class="code-comment"># By Active Directory OU</span>
<span class="code-param">ad_ou</span> contains <span class="code-value">"OU=Finance"</span>

<span class="code-comment"># By IP range</span>
<span class="code-param">ip_address</span> in_subnet <span class="code-value">"10.50.0.0/16"</span>

<span class="code-comment"># High-security endpoints (executives)</span>
<span class="code-param">ad_groups</span> contains <span class="code-value">"Executive-Laptops"</span>
                    </div>

                    <h4>Step 3: Assign Profile to Group</h4>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Link Profile</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Edit Group → Profile Assignment → Select your profile → Save</p>
                            <p style="color: #d29922; margin: 4px 0; font-size: 0.9rem;">Note: Changes propagate to endpoints within 5-15 minutes</p>
                        </div>
                    </div>
                </div>

                <!-- Verifying Data Collection -->
                <h2><i class="fas fa-search"></i> Verifying Data Collection is Working</h2>
                
                <div class="config-section">
                    <h4>Method 1: Check in XSIAM Console</h4>
                    <div class="console-path">Investigation → XQL Search</div>
                    
                    <div class="code-block">
<span class="code-comment">// Verify process events from specific endpoint</span>
<span class="code-command">dataset</span> = xdr_data
| <span class="code-command">filter</span> agent_hostname = <span class="code-value">"WORKSTATION-001"</span>
| <span class="code-command">filter</span> event_type = PROCESS
| <span class="code-command">fields</span> _time, action_process_image_name, action_process_command_line, actor_process_image_name
| <span class="code-command">sort</span> desc _time
| <span class="code-command">limit</span> 100
                    </div>

                    <div class="code-block">
<span class="code-comment">// Check all event types from endpoint in last hour</span>
<span class="code-command">dataset</span> = xdr_data
| <span class="code-command">filter</span> agent_hostname = <span class="code-value">"WORKSTATION-001"</span>
| <span class="code-command">filter</span> _time > ago(1h)
| <span class="code-command">comp</span> count = <span class="code-command">count</span>() by event_type
| <span class="code-command">sort</span> desc count
                    </div>

                    <h4>Expected Output (Healthy Endpoint)</h4>
                    <div class="code-block">
<span class="code-comment">// You should see something like:</span>
event_type          count
----------------------------
PROCESS             847
FILE                1,234
NETWORK             312
REGISTRY            156
LOAD_IMAGE          2,891
AUTH                23
                    </div>

                    <h4>Method 2: Check on Endpoint Locally</h4>
                    <div class="code-block">
<span class="code-comment"># Windows - Check agent status</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> info

<span class="code-comment"># Expected output includes:</span>
<span class="code-comment"># Agent Status: Protected</span>
<span class="code-comment"># Server Connectivity: Connected</span>
<span class="code-comment"># Last Check-in: [recent timestamp]</span>

<span class="code-comment"># Check what's being collected</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> runtime status

<span class="code-comment"># macOS</span>
<span class="code-command">/Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool</span> info

<span class="code-comment"># Linux</span>
<span class="code-command">sudo</span> /opt/traps/bin/cytool runtime status
                    </div>
                </div>

                <!-- Common Issues -->
                <h2><i class="fas fa-bug"></i> Troubleshooting Common Issues</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Issue</th>
                                <th>Symptoms</th>
                                <th>Resolution</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>No data in XSIAM</strong></td>
                                <td>XQL returns no events for endpoint</td>
                                <td>Check agent connectivity: <code>cytool info</code>. Verify endpoint can reach *.paloaltonetworks.com:443</td>
                            </tr>
                            <tr>
                                <td><strong>Missing command lines</strong></td>
                                <td>Process events show but command_line is empty</td>
                                <td>Enable "Command Line Logging" in profile. Check Windows audit policy (Process Creation auditing)</td>
                            </tr>
                            <tr>
                                <td><strong>Missing network events</strong></td>
                                <td>No NETWORK event_type in data</td>
                                <td>Enable "Network Connections" in profile Data Collection settings</td>
                            </tr>
                            <tr>
                                <td><strong>Agent not updating policy</strong></td>
                                <td>Old profile settings still active</td>
                                <td>Force policy refresh: <code>cytool checkin</code> or wait 15 minutes</td>
                            </tr>
                            <tr>
                                <td><strong>High CPU usage</strong></td>
                                <td>Agent consuming >5% CPU constantly</td>
                                <td>Check for scanning exclusion needs. Reduce "Module Loads" collection on busy servers.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Diagnostic Commands</h3>
                <div class="code-block">
<span class="code-comment"># Full diagnostic dump (Windows)</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> diagnostic create

<span class="code-comment"># Check connectivity to XSIAM</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> connectivity test

<span class="code-comment"># Force immediate check-in</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> checkin

<span class="code-comment"># View local agent logs</span>
<span class="code-comment"># Windows: C:\ProgramData\Cyvera\Logs\</span>
<span class="code-comment"># macOS: /Library/Application Support/PaloAltoNetworks/Traps/logs/</span>
<span class="code-comment"># Linux: /var/log/traps/</span>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you configure the Cortex XDR agent to collect specific data types?</button>
                        <div class="qa-answer">
                            <p><strong>Data collection is controlled via Endpoint Profiles:</strong></p>
                            <ol>
                                <li>Navigate to <strong>Settings → Endpoints → Policy Management → Profiles</strong></li>
                                <li>Create or edit a profile for your OS type</li>
                                <li>Go to the <strong>Data Collection</strong> section</li>
                                <li>Enable specific collection types:
                                    <ul>
                                        <li><strong>Process Execution</strong> - Essential for all detection</li>
                                        <li><strong>Command Line Logging</strong> - Critical for seeing what processes actually do</li>
                                        <li><strong>Network Connections</strong> - For C2 detection</li>
                                        <li><strong>File Operations</strong> - For ransomware and data exfil detection</li>
                                        <li><strong>Registry Operations</strong> - For persistence detection (Windows)</li>
                                        <li><strong>Script Execution</strong> - For PowerShell attack detection</li>
                                    </ul>
                                </li>
                                <li>Assign profile to an Endpoint Group</li>
                                <li>Endpoints pick up new policy within 5-15 minutes</li>
                            </ol>
                            <p><strong>Verification:</strong> Run XQL query filtering by agent_hostname and check event_type distribution</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you deploy Cortex XDR agent to 10,000 Windows endpoints?</button>
                        <div class="qa-answer">
                            <p><strong>For enterprise deployment, I'd use existing deployment infrastructure:</strong></p>
                            <p><strong>Option 1: Microsoft Intune (if available)</strong></p>
                            <ol>
                                <li>Download MSI from XSIAM console</li>
                                <li>Create Line-of-business app in Intune</li>
                                <li>Set command line: <code>DISTRIBUTION_ID="your-id" REBOOT=ReallySuppress</code></li>
                                <li>Assign to "All Windows devices" group</li>
                                <li>Monitor deployment status in Intune</li>
                            </ol>
                            <p><strong>Option 2: SCCM</strong></p>
                            <ol>
                                <li>Create Application with MSI deployment type</li>
                                <li>Set detection method (cyserver.exe exists)</li>
                                <li>Deploy to device collection</li>
                                <li>Use phased deployment for risk management</li>
                            </ol>
                            <p><strong>Option 3: GPO (if no MDM/SCCM)</strong></p>
                            <ol>
                                <li>Host MSI on network share</li>
                                <li>Create Software Installation GPO</li>
                                <li>Link to OU containing target computers</li>
                            </ol>
                            <p><strong>Best Practice:</strong> Deploy to pilot group (100-500) first, monitor for issues, then expand to full deployment in waves.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: An endpoint shows as connected but you're not seeing expected telemetry. How do you troubleshoot?</button>
                        <div class="qa-answer">
                            <p><strong>Systematic troubleshooting approach:</strong></p>
                            <ol>
                                <li><strong>Verify profile assignment:</strong>
                                    <ul>
                                        <li>Check which profile is assigned to the endpoint</li>
                                        <li>Verify the profile has correct Data Collection settings enabled</li>
                                    </ul>
                                </li>
                                <li><strong>Check local agent status:</strong>
                                    <div class="code-block" style="margin: 8px 0;">cytool info<br>cytool runtime status</div>
                                    <p style="color: #8b949e; margin: 4px 0;">Look for "Protected" status and recent policy timestamp</p>
                                </li>
                                <li><strong>Force policy refresh:</strong>
                                    <div class="code-block" style="margin: 8px 0;">cytool checkin</div>
                                </li>
                                <li><strong>Verify with XQL:</strong>
                                    <div class="code-block" style="margin: 8px 0;">dataset = xdr_data | filter agent_hostname = "HOSTNAME" | comp count() by event_type</div>
                                </li>
                                <li><strong>Check for specific missing data:</strong>
                                    <ul>
                                        <li>Missing command lines → Enable "Command Line Logging" in profile</li>
                                        <li>Missing network → Enable "Network Connections" collection</li>
                                        <li>Missing registry → Enable "Registry Operations" (Windows only)</li>
                                    </ul>
                                </li>
                                <li><strong>Review agent logs:</strong>
                                    <p style="color: #8b949e; margin: 4px 0;">Check C:\ProgramData\Cyvera\Logs\ for errors</p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>

        </main>
    </div>
    <script>
        // Q&A toggle functionality
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) { answer.style.display = 'block'; }
            });
        });
    </script>
</body>
</html>