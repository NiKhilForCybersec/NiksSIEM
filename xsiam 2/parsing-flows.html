<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parsing & XDM Normalization | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <main class="main-content">
            <a href="../index.html" class="back-home"><i class="fas fa-arrow-left"></i> Nik's SIEM</a>
            
            <div class="breadcrumb">
                <a href="../index.html">Home</a>
                <span class="separator">/</span>
                <a href="index.html">XSIAM</a>
                <span class="separator">/</span>
                <span class="current">Parsing & XDM Normalization</span>
            </div>

<h1><i class="fas fa-stream"></i> Parsing & XDM Normalization</h1>
                <p class="lead">Understanding how XSIAM parses raw logs and maps them to the XDM (XSIAM Data Model) is crucial for effective querying and detection engineering. This guide covers the parsing pipeline, XDM field reference, and custom parser creation.</p>

                <!-- What is XDM -->
                <h2><i class="fas fa-database"></i> What is XDM (XSIAM Data Model)?</h2>
                
                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-lightbulb"></i> XDM Explained</h4>
                    <p><strong>XDM is XSIAM's normalization schema</strong> - a standard set of field names that all log sources are mapped to. This means you can write ONE query that works across firewalls, endpoints, cloud logs, and any other source.</p>
                </div>

                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-random"></i> Why XDM Matters</div>
                    <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; margin-top: 16px; align-items: center;">
                        <div>
                            <h4 style="color: #f85149; text-align: center;">Without Normalization</h4>
                            <div style="background: #21262d; padding: 12px; border-radius: 6px; font-family: monospace; font-size: 0.8rem;">
                                <div style="margin-bottom: 8px;"><span style="color: #8b949e;">Palo Alto:</span> src_ip</div>
                                <div style="margin-bottom: 8px;"><span style="color: #8b949e;">Cisco ASA:</span> srcAddress</div>
                                <div style="margin-bottom: 8px;"><span style="color: #8b949e;">AWS:</span> sourceIPAddress</div>
                                <div><span style="color: #8b949e;">Windows:</span> IpAddress</div>
                            </div>
                            <p style="color: #f85149; font-size: 0.85rem; text-align: center; margin-top: 8px;">4 different queries needed!</p>
                        </div>
                        <div style="font-size: 2rem; color: #58a6ff;">→</div>
                        <div>
                            <h4 style="color: #3fb950; text-align: center;">With XDM</h4>
                            <div style="background: #1a4d2e; padding: 12px; border-radius: 6px; font-family: monospace; font-size: 0.8rem;">
                                <div style="margin-bottom: 8px;"><span style="color: #8b949e;">All sources:</span> <span style="color: #3fb950;">xdm.source.ipv4</span></div>
                            </div>
                            <p style="color: #3fb950; font-size: 0.85rem; text-align: center; margin-top: 8px;">ONE query works everywhere!</p>
                        </div>
                    </div>
                </div>

                <!-- XDM Field Categories -->
                <h2><i class="fas fa-layer-group"></i> XDM Field Categories</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Prefix</th>
                                <th>Common Fields</th>
                                <th>Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Source</strong></td>
                                <td><code>xdm.source.*</code></td>
                                <td>ipv4, ipv6, host.hostname, port, user.username</td>
                                <td>Where traffic/action originated</td>
                            </tr>
                            <tr>
                                <td><strong>Target</strong></td>
                                <td><code>xdm.target.*</code></td>
                                <td>ipv4, ipv6, host.hostname, port, user.username</td>
                                <td>Destination of traffic/action</td>
                            </tr>
                            <tr>
                                <td><strong>Event</strong></td>
                                <td><code>xdm.event.*</code></td>
                                <td>type, outcome, description, original_event_type</td>
                                <td>What happened</td>
                            </tr>
                            <tr>
                                <td><strong>Network</strong></td>
                                <td><code>xdm.network.*</code></td>
                                <td>protocol, application_protocol, direction</td>
                                <td>Network context</td>
                            </tr>
                            <tr>
                                <td><strong>Auth</strong></td>
                                <td><code>xdm.auth.*</code></td>
                                <td>auth_method, outcome, privilege_level</td>
                                <td>Authentication events</td>
                            </tr>
                            <tr>
                                <td><strong>Observer</strong></td>
                                <td><code>xdm.observer.*</code></td>
                                <td>type, name, vendor, product</td>
                                <td>Device that generated log</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Complete XDM Field Reference -->
                <h2><i class="fas fa-book"></i> XDM Field Reference (Most Used)</h2>
                
                <div class="config-section">
                    <h3>Source Fields (xdm.source.*)</h3>
                    <div style="font-family: monospace; font-size: 0.85rem;">
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.ipv4</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source IPv4 address</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.ipv6</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source IPv6 address</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.port</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source port number</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.host.hostname</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source hostname</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.user.username</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source username</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.user.domain</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source user domain</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.process.name</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source process name</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.process.pid</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source process ID</span>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h3>Target Fields (xdm.target.*)</h3>
                    <div style="font-family: monospace; font-size: 0.85rem;">
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.ipv4</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Destination IPv4 address</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.port</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Destination port number</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.host.hostname</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Destination hostname</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.user.username</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Target username (for auth events)</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.url</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Target URL</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.file.path</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Target file path</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.file.sha256</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Target file SHA256 hash</span>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h3>Event Fields (xdm.event.*)</h3>
                    <div style="font-family: monospace; font-size: 0.85rem;">
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.type</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Event type (NETWORK, AUTH, PROCESS, FILE)</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.outcome</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Outcome (SUCCESS, FAILURE, UNKNOWN)</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.operation</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Operation performed</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.description</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Human-readable description</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.original_event_type</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Original event type from source</span>
                        </div>
                    </div>
                </div>

                <!-- Example Mappings by Source -->
                <h2><i class="fas fa-exchange-alt"></i> Example Field Mappings by Source</h2>
                
                <div class="config-section">
                    <h3>Palo Alto NGFW → XDM</h3>
                    <div class="code-block">
<span style="color: #8b949e;">// Raw Palo Alto fields → XDM normalized fields</span>

src                     →  xdm.source.ipv4
dst                     →  xdm.target.ipv4
sport                   →  xdm.source.port
dport                   →  xdm.target.port
srcuser                 →  xdm.source.user.username
action                  →  xdm.event.outcome (allow=SUCCESS, deny=FAILURE)
app                     →  xdm.network.application_protocol
rule                    →  xdm.alert.name
bytes_sent              →  xdm.source.sent_bytes
bytes_received          →  xdm.target.sent_bytes
                    </div>
                </div>

                <div class="config-section">
                    <h3>Windows Security Events → XDM</h3>
                    <div class="code-block">
<span style="color: #8b949e;">// Windows Event ID 4624 (Successful Logon) → XDM</span>

TargetUserName          →  xdm.target.user.username
TargetDomainName        →  xdm.target.user.domain
IpAddress               →  xdm.source.ipv4
LogonType               →  xdm.auth.auth_method
WorkstationName         →  xdm.source.host.hostname
SubjectUserName         →  xdm.source.user.username
EventID                 →  xdm.event.original_event_type
Status                  →  xdm.event.outcome

<span style="color: #8b949e;">// Logon Type mapping:</span>
<span style="color: #8b949e;">// 2 = Interactive, 3 = Network, 10 = RemoteInteractive (RDP)</span>
                    </div>
                </div>

                <div class="config-section">
                    <h3>AWS CloudTrail → XDM</h3>
                    <div class="code-block">
<span style="color: #8b949e;">// AWS CloudTrail fields → XDM</span>

sourceIPAddress         →  xdm.source.ipv4
userIdentity.userName   →  xdm.source.user.username
eventName               →  xdm.event.operation
eventSource             →  xdm.observer.name
awsRegion               →  xdm.observer.location
errorCode               →  xdm.event.outcome (null=SUCCESS, else=FAILURE)
eventType               →  xdm.event.type
                    </div>
                </div>

                <!-- Using XDM in Queries -->
                <h2><i class="fas fa-terminal"></i> Using XDM Fields in XQL Queries</h2>
                
                <div class="config-section">
                    <h4>Query That Works Across ALL Sources</h4>
                    <div class="code-block">
<span style="color: #8b949e;">// Find all failed authentications from any source</span>
<span style="color: #ff7b72;">dataset</span> = xdr_data, panw_ngfw_traffic_raw, microsoft_windows_raw, aws_cloudtrail_raw
| <span style="color: #ff7b72;">filter</span> xdm.event.type = "AUTH"
| <span style="color: #ff7b72;">filter</span> xdm.event.outcome = "FAILURE"
| <span style="color: #ff7b72;">comp</span> failed_attempts = <span style="color: #d2a8ff;">count</span>() <span style="color: #ff7b72;">by</span> xdm.target.user.username, xdm.source.ipv4
| <span style="color: #ff7b72;">filter</span> failed_attempts >= 5
| <span style="color: #ff7b72;">sort</span> desc failed_attempts
                    </div>
                    <p style="color: #3fb950; margin-top: 12px;">This single query detects brute force attacks whether they hit your firewall, Windows servers, or cloud resources!</p>
                </div>

                <div class="config-section">
                    <h4>Network Connections to Specific Port</h4>
                    <div class="code-block">
<span style="color: #8b949e;">// Find all connections to port 3389 (RDP) from any source</span>
<span style="color: #ff7b72;">dataset</span> = xdr_data, panw_ngfw_traffic_raw
| <span style="color: #ff7b72;">filter</span> xdm.target.port = 3389
| <span style="color: #ff7b72;">fields</span> _time, xdm.source.ipv4, xdm.target.ipv4, xdm.source.user.username
| <span style="color: #ff7b72;">sort</span> desc _time
| <span style="color: #ff7b72;">limit</span> 100
                    </div>
                </div>

                <!-- Custom Parser Creation -->
                <h2><i class="fas fa-plus-circle"></i> Creating Custom Parsers</h2>
                
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → Parsing Rules → + New Parsing Rule</div>
                    
                    <div class="info-box" style="border-color: #d29922;">
                        <h4><i class="fas fa-exclamation-triangle"></i> When You Need Custom Parsers</h4>
                        <ul style="color: #8b949e;">
                            <li>Ingesting logs from unsupported vendors</li>
                            <li>Custom application logs</li>
                            <li>Logs with non-standard formats</li>
                            <li>Need to extract additional fields not in default parser</li>
                        </ul>
                    </div>

                    <h4>Custom Parser Example (JSON Log)</h4>
                    <div class="code-block">
<span style="color: #8b949e;">// Sample raw log (custom application):</span>
{"timestamp":"2024-02-15T14:30:00Z","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success"}

<span style="color: #8b949e;">// Parsing rule definition:</span>
[PARSER]
name = custom_app_auth
vendor = CustomCorp
product = MyApp
format = json

[MAPPING]
_time = json_extract(raw, "$.timestamp")
xdm.source.user.username = json_extract(raw, "$.user")
xdm.event.operation = json_extract(raw, "$.action")
xdm.source.ipv4 = json_extract(raw, "$.src_ip")
xdm.event.outcome = if(json_extract(raw, "$.result") = "success", "SUCCESS", "FAILURE")
                    </div>

                    <h4>Custom Parser Example (Syslog/Regex)</h4>
                    <div class="code-block">
<span style="color: #8b949e;">// Sample raw log (legacy syslog):</span>
Feb 15 14:30:00 server01 myapp: USER=jsmith ACTION=login SRC=10.0.1.50 STATUS=OK

<span style="color: #8b949e;">// Parsing rule with regex:</span>
[PARSER]
name = legacy_app_syslog
vendor = LegacyCorp
product = LegacyApp
format = syslog

[EXTRACT]
pattern = USER=(?P&lt;user&gt;\S+)\s+ACTION=(?P&lt;action&gt;\S+)\s+SRC=(?P&lt;src_ip&gt;\S+)\s+STATUS=(?P&lt;status&gt;\S+)

[MAPPING]
xdm.source.user.username = user
xdm.event.operation = action
xdm.source.ipv4 = src_ip
xdm.event.outcome = if(status = "OK", "SUCCESS", "FAILURE")
                    </div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is XDM and why is it important for detection engineering?</button>
                        <div class="qa-answer">
                            <p><strong>XDM (XSIAM Data Model) is XSIAM's normalization schema that maps all log sources to standard field names.</strong></p>
                            <p><strong>Why it matters:</strong></p>
                            <ul>
                                <li><strong>Write once, detect everywhere:</strong> One correlation rule can detect attacks across firewall, endpoint, cloud, and identity logs</li>
                                <li><strong>Faster investigations:</strong> No need to remember that Palo Alto uses "src" while Windows uses "IpAddress" - both map to xdm.source.ipv4</li>
                                <li><strong>Easier onboarding:</strong> New data sources automatically work with existing rules if properly mapped</li>
                            </ul>
                            <p><strong>Key XDM categories:</strong></p>
                            <ul>
                                <li><code>xdm.source.*</code> - Where it came from (IP, user, process)</li>
                                <li><code>xdm.target.*</code> - Where it went (IP, port, file)</li>
                                <li><code>xdm.event.*</code> - What happened (type, outcome)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you create a detection rule that works across multiple log sources?</button>
                        <div class="qa-answer">
                            <p><strong>Use XDM normalized fields instead of raw fields:</strong></p>
                            <div class="code-block" style="margin: 8px 0;">// WRONG - Only works for Palo Alto
dataset = panw_ngfw_traffic_raw
| filter src_ip = "10.0.0.5"

// RIGHT - Works for ANY source
dataset = panw_ngfw_traffic_raw, xdr_data, aws_cloudtrail_raw
| filter xdm.source.ipv4 = "10.0.0.5"</div>
                            <p><strong>Key principle:</strong> Always use xdm.* fields in correlation rules. Raw fields (src_ip, sourceIPAddress, etc.) are source-specific and won't match across different log types.</p>
                        </div>
                    </div>
                </div>

                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>

                <!-- Comprehensive Troubleshooting -->
                <h2><i class="fas fa-tools"></i> Comprehensive Troubleshooting</h2>
                <div class="config-section">
                    <h4>Systematic Troubleshooting Methodology</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <ol style="color: #8b949e;">
                            <li><strong>Define the Problem:</strong> Clearly articulate what is not working as expected. Gather specific error messages, timestamps, and affected components.</li>
                            <li><strong>Gather Information:</strong> Collect relevant logs, metrics, and configuration details. Document recent changes that might be related.</li>
                            <li><strong>Analyze Data:</strong> Review collected information for patterns and anomalies. Compare against baseline behavior and known-good configurations.</li>
                            <li><strong>Develop Hypothesis:</strong> Form theories about potential root causes. Prioritize based on likelihood and impact.</li>
                            <li><strong>Test Solutions:</strong> Implement fixes in a controlled manner. Test one change at a time to isolate the effective solution.</li>
                            <li><strong>Document Resolution:</strong> Record the root cause and solution. Update runbooks and knowledge base for future reference.</li>
                        </ol>
                    </div>

                    <h4>Common Issues and Resolutions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Category</th><th>Issue</th><th>Diagnostic Steps</th><th>Resolution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td rowspan="2"><strong>Connectivity</strong></td>
                                <td>Agent not reporting</td>
                                <td>Check agent service status, network connectivity, firewall rules</td>
                                <td>Restart service, verify network path, update firewall rules</td>
                            </tr>
                            <tr>
                                <td>API timeouts</td>
                                <td>Test API endpoint, check rate limits, verify credentials</td>
                                <td>Retry with backoff, request limit increase, refresh credentials</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Data Quality</strong></td>
                                <td>Missing fields</td>
                                <td>Review parsing rules, check source format, validate schema</td>
                                <td>Update parser, fix source configuration, adjust schema mapping</td>
                            </tr>
                            <tr>
                                <td>Duplicate events</td>
                                <td>Audit data sources, check collection paths, review timestamps</td>
                                <td>Consolidate sources, implement deduplication, fix time sync</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Performance</strong></td>
                                <td>Slow queries</td>
                                <td>Analyze query execution plan, check resource utilization</td>
                                <td>Optimize query, add indexes, scale resources</td>
                            </tr>
                            <tr>
                                <td>High latency</td>
                                <td>Monitor queue depths, check processing bottlenecks</td>
                                <td>Scale processing capacity, optimize data flow</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Authentication</strong></td>
                                <td>Login failures</td>
                                <td>Verify credentials, check account status, review permissions</td>
                                <td>Reset password, unlock account, grant required permissions</td>
                            </tr>
                            <tr>
                                <td>Token expiration</td>
                                <td>Check token validity, review refresh mechanism</td>
                                <td>Refresh token, update token management configuration</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Diagnostic Commands and Queries</h4>
                    <div class="code-block"># Health Check Queries (adjust syntax for your platform)

# Check system health status
| filter log_type = "system_health"
| sort _time desc
| limit 50

# Monitor error rates over time
| filter severity in ("error", "critical")
| timechart count by component span=1h

# Identify slow operations
| filter operation_time > 30000
| stats avg(operation_time), max(operation_time), count by operation_name
| sort avg(operation_time) desc

# Check connectivity status
| filter event_type = "connectivity"
| stats latest(status), latest(_time) by source_name
| where status != "connected"

# Review authentication failures
| filter event_type = "authentication" and result = "failure"
| stats count by user, source_ip, failure_reason
| sort count desc</div>
                </div>

                <!-- Real-World Use Cases -->
                <h2><i class="fas fa-building"></i> Real-World Implementation Scenarios</h2>
                <div class="config-section">
                    <h4>Scenario 1: Enterprise SOC Deployment</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #3fb950;">
                        <p><strong>Organization Profile:</strong> Fortune 500 company with 50,000 employees, hybrid cloud infrastructure</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>High volume of security events (500+ million events/day)</li>
                            <li>Multiple security tools with siloed data</li>
                            <li>Alert fatigue from excessive false positives</li>
                            <li>Compliance requirements (SOX, PCI-DSS, GDPR)</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Phased rollout starting with critical data sources</li>
                            <li>Custom detection rules based on threat model</li>
                            <li>Automated playbooks for common scenarios</li>
                            <li>Integration with ITSM and CMDB systems</li>
                        </ul>
                        <p style="color: #3fb950;"><strong>Results:</strong> 70% reduction in MTTR, 50% reduction in false positives, unified security visibility</p>
                    </div>

                    <h4>Scenario 2: MSSP Multi-Tenant Operations</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #58a6ff;">
                        <p><strong>Organization Profile:</strong> Managed security provider serving 100+ SMB customers</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Need for strict data isolation between customers</li>
                            <li>Scalable operations with limited staff</li>
                            <li>Standardized service delivery across customers</li>
                            <li>Flexible SLA-based prioritization</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Multi-tenant architecture with customer isolation</li>
                            <li>Shared detection content library with customization</li>
                            <li>Centralized analyst console with customer context</li>
                            <li>Automated reporting and SLA tracking</li>
                        </ul>
                        <p style="color: #58a6ff;"><strong>Results:</strong> 3x increase in customers per analyst, consistent service quality, improved customer satisfaction</p>
                    </div>

                    <h4>Scenario 3: Healthcare Compliance Focus</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #d29922;">
                        <p><strong>Organization Profile:</strong> Regional hospital network with 15 facilities</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>HIPAA compliance requirements for PHI protection</li>
                            <li>Legacy medical devices with limited security logging</li>
                            <li>Need for 6-year log retention</li>
                            <li>Limited IT security staff</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Comprehensive EHR and clinical application monitoring</li>
                            <li>PHI access detection rules</li>
                            <li>Long-term archival storage configuration</li>
                            <li>Pre-built compliance dashboards and reports</li>
                        </ul>
                        <p style="color: #d29922;"><strong>Results:</strong> Audit-ready compliance posture, early detection of PHI access violations, reduced audit preparation time by 80%</p>
                    </div>
                </div>

                <!-- Interview Preparation -->
                <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                <div class="config-section">
                    <h4>Common Interview Questions</h4>
                    <div class="qa-section">
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you approach implementing a new security monitoring capability?</button>
                            <div class="qa-answer">
                                <p><strong>Structured approach:</strong></p>
                                <ol>
                                    <li><strong>Requirements Gathering:</strong> Understand use case, data sources, detection goals, and compliance needs</li>
                                    <li><strong>Design:</strong> Plan data collection, parsing, storage, and detection logic</li>
                                    <li><strong>Implementation:</strong> Configure data sources, build detection rules, set up dashboards</li>
                                    <li><strong>Testing:</strong> Validate with test data, tune for false positives, verify performance</li>
                                    <li><strong>Deployment:</strong> Roll out in phases, monitor for issues, gather feedback</li>
                                    <li><strong>Optimization:</strong> Continuously tune based on operational experience</li>
                                </ol>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle alert fatigue in a SOC environment?</button>
                            <div class="qa-answer">
                                <p><strong>Multi-pronged approach:</strong></p>
                                <ul>
                                    <li><strong>Tune Detection Rules:</strong> Adjust thresholds, add exclusions for known-good behavior</li>
                                    <li><strong>Implement Alert Aggregation:</strong> Group related alerts into incidents</li>
                                    <li><strong>Prioritization:</strong> Use risk scoring to surface high-priority alerts</li>
                                    <li><strong>Automation:</strong> Auto-close or auto-enrich low-severity alerts</li>
                                    <li><strong>Regular Review:</strong> Weekly review of noisy rules for tuning</li>
                                    <li><strong>Metrics Tracking:</strong> Monitor false positive rates by rule</li>
                                </ul>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Describe your experience with security data analysis and threat hunting.</button>
                            <div class="qa-answer">
                                <p><strong>Key competencies to highlight:</strong></p>
                                <ul>
                                    <li><strong>Query Languages:</strong> Proficiency in SPL, KQL, XQL, or similar</li>
                                    <li><strong>Hypothesis-Driven Hunting:</strong> Developing and testing threat hypotheses</li>
                                    <li><strong>IOC Analysis:</strong> Working with threat intelligence to hunt for indicators</li>
                                    <li><strong>Behavioral Analysis:</strong> Identifying anomalous patterns in user and system behavior</li>
                                    <li><strong>Tool Proficiency:</strong> Experience with SIEM, EDR, and analysis tools</li>
                                    <li><strong>Documentation:</strong> Recording findings and developing new detection rules</li>
                                </ul>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you stay current with security threats and platform updates?</button>
                            <div class="qa-answer">
                                <p><strong>Continuous learning approach:</strong></p>
                                <ul>
                                    <li><strong>Threat Intelligence:</strong> Follow threat reports, security blogs, and advisories</li>
                                    <li><strong>Vendor Resources:</strong> Review release notes, attend webinars, complete training</li>
                                    <li><strong>Community Engagement:</strong> Participate in forums, conferences, and user groups</li>
                                    <li><strong>Hands-On Practice:</strong> Lab environments for testing new features</li>
                                    <li><strong>Certifications:</strong> Pursue relevant certifications and continuing education</li>
                                    <li><strong>Knowledge Sharing:</strong> Present learnings to team, write documentation</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <h4>Technical Scenarios to Prepare</h4>
                    <ul style="color: #8b949e;">
                        <li>Walk through investigating a phishing incident from alert to resolution</li>
                        <li>Explain how you would detect lateral movement in your environment</li>
                        <li>Describe your approach to onboarding a new log source</li>
                        <li>Discuss how you would build a detection rule for a specific attack technique</li>
                        <li>Explain capacity planning for a growing environment</li>
                    </ul>
                </div>

                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>

                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>

        </main>
    </div>
    <script>
        // Q&A toggle functionality
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) { answer.style.display = 'block'; }
            });
        });
    </script>
</body>
</html>