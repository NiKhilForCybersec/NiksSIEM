<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture & Enterprise Deployments | Sentinel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link active" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Sentinel Pages</div>
                <ul class="sidebar-nav">
                                        <li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link active">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-connectors.html" class="sidebar-nav-link">
                            <i class="fas fa-plug"></i>
                            <span>Data Connectors</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="event-hub.html" class="sidebar-nav-link">
                            <i class="fas fa-stream"></i>
                            <span>Event Hub Integration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="dcr-dce-guide.html" class="sidebar-nav-link">
                            <i class="fas fa-cogs"></i>
                            <span>DCR & DCE Guide</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="custom-log-onboarding.html" class="sidebar-nav-link">
                            <i class="fas fa-plus-circle"></i>
                            <span>Custom Log Onboarding</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-filter"></i>
                            <span>Parsing & Flows</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-archive"></i>
                            <span>Retention Tiers</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="kql-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>KQL Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="kql-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-rocket"></i>
                            <span>KQL Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="analytics-rules.html" class="sidebar-nav-link">
                            <i class="fas fa-shield-alt"></i>
                            <span>Analytics Rules</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-skull-crossbones"></i>
                            <span>Threat Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="automation.html" class="sidebar-nav-link">
                            <i class="fas fa-robot"></i>
                            <span>Automation & Playbooks</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="workbooks.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Workbooks</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="content-hub.html" class="sidebar-nav-link">
                            <i class="fas fa-store"></i>
                            <span>Content Hub</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-operations.html" class="sidebar-nav-link">
                            <i class="fas fa-users-cog"></i>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="cost-optimization.html" class="sidebar-nav-link">
                            <i class="fas fa-dollar-sign"></i>
                            <span>Cost Optimization</span>
                        </a>
                    </li>
<li class="sidebar-nav-item">
                        <a href="data-ingestion.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Ingestion</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="dcr-dce-guide.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Dcr Dce Guide</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-scenarios.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Enterprise Scenarios</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="event-hub.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Event Hub</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="kql-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>Kql Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="kql-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Kql Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="kql-intermediate.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Kql Intermediate</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Parsing Flows</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Retention Tiers</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="security-usecases.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Security Usecases</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-operations.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Soc Operations</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-hunting.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Hunting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Intel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="workbooks.html" class="sidebar-nav-link">
                            <i class="fas fa-book"></i>
                            <span>Workbooks</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Sentinel</a>
                    <span class="separator">/</span>
                    <span class="current">Architecture</span>
                </div>

                <h1><i class="fas fa-sitemap"></i> Sentinel Architecture & Enterprise Deployments</h1>
            <p class="lead">Complete technical architecture of Microsoft Sentinel with real-world enterprise deployment examples. Understand the cloud-native design, data connectors, workspace strategy, and deployment patterns for organizations of all sizes.</p>

            <!-- Architecture Overview -->
            <h2><i class="fas fa-layer-group"></i> Core Architecture Overview</h2>
            
            <div class="config-section">
                <h3>Microsoft Sentinel Platform Architecture</h3>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                       MICROSOFT SENTINEL ARCHITECTURE                               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   DATA SOURCES                    DATA CONNECTORS              LOG ANALYTICS         │
│   ════════════                    ═══════════════              ═════════════         │
│                                                                                      │
│   ┌────────────────┐            ┌──────────────────┐         ┌───────────────────┐  │
│   │ MICROSOFT 365  │            │                  │         │  LOG ANALYTICS    │  │
│   │ ──────────────  │            │  NATIVE          │         │  WORKSPACE        │  │
│   │ • Exchange     │───────────▶│  CONNECTORS      │────────▶│  ════════════     │  │
│   │ • SharePoint   │  (Free!)   │                  │         │                   │  │
│   │ • Teams        │            │  • One-click     │         │ ┌───────────────┐ │  │
│   │ • OneDrive     │            │    enable        │         │ │ ANALYTICS     │ │  │
│   └────────────────┘            │  • No agent      │         │ │ LOGS (Hot)    │ │  │
│                                 │  • Microsoft     │         │ │ ───────────── │ │  │
│   ┌────────────────┐            │    managed       │         │ │ • Full KQL    │ │  │
│   │ AZURE          │            │                  │         │ │ • Analytics   │ │  │
│   │ ──────────────  │            └──────────────────┘         │ │   rules       │ │  │
│   │ • Azure AD     │───────────▶                             │ │ • 90-730 days │ │  │
│   │ • Activity Logs│  (Free!)   ┌──────────────────┐         │ └───────────────┘ │  │
│   │ • Defender     │            │                  │         │                   │  │
│   │ • Key Vault    │───────────▶│  AZURE MONITOR   │────────▶│ ┌───────────────┐ │  │
│   └────────────────┘            │  AGENT (AMA)     │         │ │ BASIC LOGS    │ │  │
│                                 │                  │         │ │ ───────────── │ │  │
│   ┌────────────────┐            │  • Windows/Linux │         │ │ • Limited KQL │ │  │
│   │ ENDPOINTS      │            │  • CEF/Syslog    │         │ │ • 8 days hot  │ │  │
│   │ ──────────────  │            │  • Custom logs   │         │ │ • Lower cost  │ │  │
│   │ • Windows Svrs │───────────▶│  • DCR-based     │         │ └───────────────┘ │  │
│   │ • Linux Svrs   │            │    collection    │         │                   │  │
│   │ • Workstations │            │                  │         │ ┌───────────────┐ │  │
│   └────────────────┘            └──────────────────┘         │ │ ARCHIVE       │ │  │
│                                                               │ │ ───────────── │ │  │
│   ┌────────────────┐            ┌──────────────────┐         │ │ • Search jobs │ │  │
│   │ NETWORK/SEC    │            │                  │         │ │ • Restore     │ │  │
│   │ ──────────────  │            │  SYSLOG/CEF      │────────▶│ │ • 12 years   │ │  │
│   │ • Firewalls    │───────────▶│  COLLECTOR       │         │ └───────────────┘ │  │
│   │ • Proxies      │            │                  │         │                   │  │
│   │ • IDS/IPS      │            │  • Linux VM with │         └───────────────────┘  │
│   │ • WAF          │            │    AMA agent     │                  │             │
│   └────────────────┘            │  • DCR routing   │                  │             │
│                                 │  • CEF parsing   │                  │             │
│   ┌────────────────┐            │                  │                  │             │
│   │ CLOUD          │            └──────────────────┘                  │             │
│   │ ──────────────  │                                                 │             │
│   │ • AWS          │───────────▶┌──────────────────┐                  │             │
│   │ • GCP          │            │  CLOUD           │─────────────────▶│             │
│   │ • SaaS Apps    │            │  CONNECTORS      │                  │             │
│   └────────────────┘            │                  │                  │             │
│                                 │  • AWS S3        │                  │             │
│   ┌────────────────┐            │  • GCP Pub/Sub   │                  │             │
│   │ CUSTOM/API     │            │  • Service-      │                  │             │
│   │ ──────────────  │            │    specific      │                  │             │
│   │ • REST API     │───────────▶└──────────────────┘                  │             │
│   │ • Logic Apps   │                                                  │             │
│   │ • Azure Func   │───────────▶┌──────────────────┐                  │             │
│   └────────────────┘            │  LOGS INGESTION  │─────────────────▶│             │
│                                 │  API             │                  │             │
│                                 │                  │                  ▼             │
│                                 │  • DCE endpoint  │     ┌───────────────────────┐  │
│                                 │  • DCR transform │     │   SENTINEL FEATURES   │  │
│                                 │  • Custom tables │     │   ════════════════    │  │
│                                 └──────────────────┘     │                       │  │
│                                                          │  ┌─────────────────┐  │  │
│                                                          │  │ ANALYTICS RULES │  │  │
│                                                          │  │ ─────────────── │  │  │
│                                                          │  │ • Scheduled     │  │  │
│                                                          │  │ • NRT (<1 min)  │  │  │
│                                                          │  │ • Fusion (ML)   │  │  │
│                                                          │  │ • Anomaly       │  │  │
│                                                          │  └─────────────────┘  │  │
│                                                          │                       │  │
│                                                          │  ┌─────────────────┐  │  │
│                                                          │  │ AUTOMATION      │  │  │
│                                                          │  │ ─────────────── │  │  │
│                                                          │  │ • Playbooks     │  │  │
│                                                          │  │ • Logic Apps    │  │  │
│                                                          │  │ • Auto rules    │  │  │
│                                                          │  └─────────────────┘  │  │
│                                                          │                       │  │
│                                                          │  ┌─────────────────┐  │  │
│                                                          │  │ HUNTING         │  │  │
│                                                          │  │ ─────────────── │  │  │
│                                                          │  │ • Bookmarks     │  │  │
│                                                          │  │ • Livestream    │  │  │
│                                                          │  │ • Notebooks     │  │  │
│                                                          │  └─────────────────┘  │  │
│                                                          │                       │  │
│                                                          └───────────────────────┘  │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- Data Collection Components -->
            <h2><i class="fas fa-cogs"></i> Data Collection Components</h2>

            <div class="config-section">
                <h3>Azure Monitor Agent (AMA) Architecture</h3>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                    AZURE MONITOR AGENT (AMA) DATA FLOW                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   SERVER/ENDPOINT                    DCE/DCR                   LOG ANALYTICS        │
│   ═══════════════                    ═══════                   ═════════════        │
│                                                                                      │
│   ┌──────────────────────┐         ┌─────────────────────────────────────────────┐  │
│   │     WINDOWS SERVER   │         │           DATA COLLECTION RULE (DCR)        │  │
│   │     ══════════════   │         │           ═════════════════════════         │  │
│   │                      │         │                                             │  │
│   │   ┌────────────────┐ │         │   ┌─────────────────────────────────────┐   │  │
│   │   │   AMA Agent    │ │         │   │         DATA SOURCES                │   │  │
│   │   │   ──────────   │ │         │   │         ════════════                │   │  │
│   │   │   • Windows    │ │         │   │                                     │   │  │
│   │   │     Events     │─┼────────▶│   │   • Windows Events                  │   │  │
│   │   │   • Perf       │ │         │   │     - Security (4624, 4625...)      │   │  │
│   │   │     Counters   │ │         │   │     - System                        │   │  │
│   │   │   • Custom     │ │         │   │     - Application                   │   │  │
│   │   │     Logs       │ │         │   │                                     │   │  │
│   │   └────────────────┘ │         │   │   • Performance Counters            │   │  │
│   │                      │         │   │     - CPU, Memory, Disk             │   │  │
│   └──────────────────────┘         │   │                                     │   │  │
│                                    │   │   • Syslog (Linux)                  │   │  │
│   ┌──────────────────────┐         │   │     - auth, authpriv                │   │  │
│   │     LINUX SERVER     │         │   │     - local0-local7                 │   │  │
│   │     ════════════     │         │   │                                     │   │  │
│   │                      │         │   │   • Custom Text Logs                │   │  │
│   │   ┌────────────────┐ │         │   │     - File pattern match            │   │  │
│   │   │   AMA Agent    │ │         │   │     - Multi-line support            │   │  │
│   │   │   ──────────   │─┼────────▶│   │                                     │   │  │
│   │   │   • Syslog     │ │         │   └─────────────────────────────────────┘   │  │
│   │   │   • CEF        │ │         │                      │                      │  │
│   │   │   • Custom     │ │         │                      ▼                      │  │
│   │   └────────────────┘ │         │   ┌─────────────────────────────────────┐   │  │
│   │                      │         │   │      TRANSFORMATIONS (KQL)          │   │  │
│   └──────────────────────┘         │   │      ══════════════════════         │   │  │
│                                    │   │                                     │   │  │
│   ┌──────────────────────┐         │   │   source                            │   │  │
│   │   SYSLOG COLLECTOR   │         │   │   | where Facility == "authpriv"    │   │  │
│   │   ════════════════   │         │   │   | extend User = extract(...)      │   │  │
│   │                      │         │   │   | project-away RawData            │   │  │
│   │   • Receives syslog  │         │   │                                     │   │  │
│   │     UDP/TCP 514      │         │   └─────────────────────────────────────┘   │  │
│   │   • CEF on TCP 514   │         │                      │                      │  │
│   │   • TLS on 6514      │         │                      ▼                      │  │
│   │                      │         │   ┌─────────────────────────────────────┐   │  │
│   │   ┌────────────────┐ │         │   │        DESTINATIONS                 │   │  │
│   │   │   AMA Agent    │─┼────────▶│   │        ════════════                 │   │  │
│   │   │   (Collector)  │ │         │   │                                     │   │  │
│   │   └────────────────┘ │         │   │   • SecurityEvent → Analytics       │   │  │
│   │                      │         │   │   • Syslog → Basic (verbose)        │   │  │
│   └──────────────────────┘         │   │   • CustomLog_CL → Custom table     │   │  │
│                                    │   │                                     │   │  │
│                                    │   └─────────────────────────────────────┘   │  │
│                                    │                      │                      │  │
│                                    └──────────────────────┼──────────────────────┘  │
│                                                           │                         │
│                                    ┌──────────────────────▼──────────────────────┐  │
│                                    │     DATA COLLECTION ENDPOINT (DCE)         │  │
│                                    │     ══════════════════════════════         │  │
│                                    │                                            │  │
│                                    │     • Regional endpoint                    │  │
│                                    │     • Receives data from agents            │  │
│                                    │     • Routes to Log Analytics              │  │
│                                    │     • Endpoint: <dce>.ingest.monitor.azure │  │
│                                    │                                            │  │
│                                    └────────────────────────────────────────────┘  │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- Enterprise Deployment Examples -->
            <h2><i class="fas fa-building"></i> Enterprise Deployment Examples</h2>

            <!-- Example 1: Insurance Company -->
            <div class="config-section">
                <h3>🏢 Case Study: SecureLife Insurance (8,000 Employees)</h3>
                
                <div class="info-box">
                    <h4>Company Profile</h4>
                    <p><strong>Industry:</strong> Insurance/Financial | <strong>Employees:</strong> 8,000 | <strong>Cloud:</strong> Azure-primary, some AWS | <strong>Compliance:</strong> SOC 2, NYDFS</p>
                </div>

                <h4>Multi-Workspace Architecture</h4>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                    SECURELIFE INSURANCE - SENTINEL DEPLOYMENT                       │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   AZURE TENANT (securelife.com)                                                      │
│   ═════════════════════════════                                                      │
│                                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                         MICROSOFT 365 / ENTRA ID                             │   │
│   │                         ════════════════════════                             │   │
│   │                                                                             │   │
│   │   ┌───────────────┐  ┌───────────────┐  ┌───────────────┐  ┌─────────────┐ │   │
│   │   │   Entra ID    │  │    M365       │  │   Defender    │  │  Defender   │ │   │
│   │   │   ─────────   │  │   ─────────   │  │   for O365    │  │  for Cloud  │ │   │
│   │   │ • Sign-in logs│  │ • Exchange    │  │   ─────────   │  │  ─────────  │ │   │
│   │   │ • Audit logs  │  │ • SharePoint  │  │ • Email       │  │ • CSPM      │ │   │
│   │   │ • Risky users │  │ • Teams       │  │   threats     │  │ • CWPP      │ │   │
│   │   │ • MFA events  │  │ • OneDrive    │  │ • Safe Links  │  │ • Container │ │   │
│   │   └───────┬───────┘  └───────┬───────┘  └───────┬───────┘  └──────┬──────┘ │   │
│   │           │                  │                  │                 │        │   │
│   │           │      FREE INGESTION (Microsoft sources)               │        │   │
│   │           └──────────────────┼──────────────────┼─────────────────┘        │   │
│   │                              │                  │                          │   │
│   └──────────────────────────────┼──────────────────┼──────────────────────────┘   │
│                                  ▼                  ▼                               │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                    PRIMARY LOG ANALYTICS WORKSPACE                          │   │
│   │                    ═══════════════════════════════                          │   │
│   │                    (law-securelife-prod-eastus)                              │   │
│   │                                                                             │   │
│   │   SUBSCRIPTION: Production                                                  │   │
│   │   REGION: East US (primary), West US 2 (geo-redundant)                      │   │
│   │   COMMITMENT TIER: 500 GB/day                                               │   │
│   │                                                                             │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                      DATA SOURCES                                   │   │   │
│   │   │                      ════════════                                   │   │   │
│   │   │                                                                     │   │   │
│   │   │   MICROSOFT (FREE)              AZURE RESOURCES            PAID     │   │   │
│   │   │   ════════════════              ═══════════════            ════     │   │   │
│   │   │                                                                     │   │   │
│   │   │   • SigninLogs                  • AzureActivity         • Custom   │   │   │
│   │   │   • AuditLogs                   • AzureDiagnostics      • Syslog   │   │   │
│   │   │   • SecurityAlert               • AzureMetrics          • CEF      │   │   │
│   │   │   • OfficeActivity              • ContainerLog          • Windows  │   │   │
│   │   │   • EmailEvents                 • AzureFirewall           Events   │   │   │
│   │   │   • IdentityInfo                                                    │   │   │
│   │   │                                                                     │   │   │
│   │   │   FREE: ~200 GB/day             AZURE: ~100 GB/day     PAID: ~200GB│   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                      SENTINEL FEATURES                              │   │   │
│   │   │                      ════════════════                               │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐  │   │   │
│   │   │   │ ANALYTICS   │ │ PLAYBOOKS   │ │  WORKBOOKS  │ │  HUNTING    │  │   │   │
│   │   │   │ ─────────── │ │ ─────────── │ │ ─────────── │ │ ─────────── │  │   │   │
│   │   │   │ • 150 active│ │ • 45 active │ │ • SOC       │ │ • 200+ saved│  │   │   │
│   │   │   │ • 80 NRT    │ │ • Auto-     │ │   Overview  │ │   queries   │  │   │   │
│   │   │   │ • 40 Fusion │ │   enrichment│ │ • Incident  │ │ • MITRE     │  │   │   │
│   │   │   │ • 30 custom │ │ • Ticket    │ │   Dashboard │ │   coverage  │  │   │   │
│   │   │   │             │ │   creation  │ │ • Identity  │ │             │  │   │   │
│   │   │   └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘  │   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   │   DAILY COST BREAKDOWN:                                                     │   │
│   │   ═════════════════════                                                     │   │
│   │   • Microsoft sources: $0 (200 GB free)                                     │   │
│   │   • Azure resources:   ~$250/day (100 GB at commitment tier)                │   │
│   │   • Third-party:       ~$600/day (200 GB at commitment tier)                │   │
│   │   • Sentinel fee:      ~$400/day (500 GB × $2/GB after 100 GB free)         │   │
│   │   ──────────────────────────────────────────────────────                    │   │
│   │   TOTAL: ~$1,250/day = ~$38,000/month                                       │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                  │                                                  │
│                                  │                                                  │
│   ┌──────────────────────────────┼──────────────────────────────────────────────┐   │
│   │                              ▼                                              │   │
│   │              ON-PREMISES DATA CENTER                                        │   │
│   │              ═══════════════════════                                        │   │
│   │                                                                             │   │
│   │   ┌─────────────────────┐    ┌─────────────────────────────────────────┐   │   │
│   │   │  CORE APPLICATIONS  │    │     SYSLOG/CEF COLLECTOR                │   │   │
│   │   │  ═════════════════  │    │     ═══════════════════                 │   │   │
│   │   │                     │    │                                         │   │   │
│   │   │  ┌───────────────┐  │    │  Linux VM: Ubuntu 22.04                 │   │   │
│   │   │  │ Policy Admin  │  │    │  • 8 vCPU, 32 GB RAM                    │   │   │
│   │   │  │ System (Guidw)│  │    │  • AMA agent installed                  │   │   │
│   │   │  │ • Oracle DB   │  │    │  • DCR for CEF parsing                  │   │   │
│   │   │  │ • Custom logs │──┼───▶│  • Receives from:                       │   │   │
│   │   │  └───────────────┘  │    │    - Palo Alto Firewalls (CEF)          │   │   │
│   │   │                     │    │    - F5 WAF (CEF)                        │   │   │
│   │   │  ┌───────────────┐  │    │    - Cisco ISE (Syslog)                  │   │   │
│   │   │  │ Claims System │  │    │    - VMware vCenter (Syslog)             │   │   │
│   │   │  │ (.NET app)    │  │    │                                         │   │   │
│   │   │  │ • App logs    │──┼───▶│  Daily volume: ~100 GB                   │   │   │
│   │   │  └───────────────┘  │    │                                         │   │   │
│   │   │                     │    └─────────────────────────────────────────┘   │   │
│   │   │  ┌───────────────┐  │                                                  │   │
│   │   │  │ Windows Svrs  │  │    ┌─────────────────────────────────────────┐   │   │
│   │   │  │ (200 servers) │  │    │     WINDOWS SERVERS                     │   │   │
│   │   │  │               │──┼───▶│     ═══════════════                     │   │   │
│   │   │  │ • Security    │  │    │                                         │   │   │
│   │   │  │   Events      │  │    │  AMA Agent via Azure Arc                │   │   │
│   │   │  │ • App logs    │  │    │  • DCR: Security Events (4624-4648)     │   │   │
│   │   │  └───────────────┘  │    │  • DCR: PowerShell logging              │   │   │
│   │   │                     │    │  • DCR: Custom app logs                  │   │   │
│   │   └─────────────────────┘    │                                         │   │   │
│   │                              │  Daily volume: ~50 GB                    │   │   │
│   │                              └─────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                              AWS ENVIRONMENT                                │   │
│   │                              ═══════════════                                │   │
│   │                                                                             │   │
│   │   ┌─────────────────────┐    ┌─────────────────────────────────────────┐   │   │
│   │   │  AWS Account        │    │     SENTINEL AWS CONNECTOR              │   │   │
│   │   │  (Legacy workloads) │    │     ═══════════════════════             │   │   │
│   │   │                     │    │                                         │   │   │
│   │   │  ┌───────────────┐  │    │  Via AWS S3:                            │   │   │
│   │   │  │ CloudTrail    │──┼───▶│  • CloudTrail logs                      │   │   │
│   │   │  └───────────────┘  │    │  • VPC Flow Logs                        │   │   │
│   │   │                     │    │  • GuardDuty findings                   │   │   │
│   │   │  ┌───────────────┐  │    │                                         │   │   │
│   │   │  │ GuardDuty     │──┼───▶│  SQS queue triggers Lambda              │   │   │
│   │   │  └───────────────┘  │    │  Lambda sends to Log Analytics API      │   │   │
│   │   │                     │    │                                         │   │   │
│   │   │  ┌───────────────┐  │    │  Daily volume: ~50 GB                   │   │   │
│   │   │  │ VPC Flow Logs │──┼───▶│                                         │   │   │
│   │   │  └───────────────┘  │    └─────────────────────────────────────────┘   │   │
│   │   │                     │                                                  │   │
│   │   └─────────────────────┘                                                  │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
│   RETENTION STRATEGY:                                                                │
│   ═══════════════════                                                                │
│   • Security tables (Analytics tier): 365 days                                       │
│   • Verbose tables (Basic tier): 90 days                                             │
│   • Compliance archive: 7 years (Log Analytics archive + Azure Storage)              │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>

                <h4>Key Design Decisions</h4>
                <ul>
                    <li><strong>Single workspace:</strong> Simplified management, cross-source correlation, unified RBAC</li>
                    <li><strong>Free Microsoft ingestion:</strong> M365, Defender, Entra ID logs are free - significant cost savings</li>
                    <li><strong>500 GB commitment tier:</strong> Reduces per-GB cost from $4.30 to $2.76 (36% savings)</li>
                    <li><strong>Azure Arc for on-prem:</strong> Manage on-prem servers like Azure resources, single agent (AMA)</li>
                    <li><strong>Basic logs tier:</strong> Use for verbose/low-value logs (ContainerLog, network flow) to reduce costs</li>
                </ul>

                <h4>Insurance-Specific Detection Rules</h4>
                <div class="arch-diagram">
Custom Analytics Rules:
├── INS-001: Mass policy lookup (>500 policies/hour by single user)
├── INS-002: Claims adjuster accessing policies outside assigned region
├── INS-003: PII export to personal email/cloud storage
├── INS-004: After-hours access to claims database
├── INS-005: Privileged account used from new device
├── INS-006: Suspicious wire transfer initiation
├── INS-007: Customer SSN accessed without associated claim
└── INS-008: Agent accessing competitor quotes

Fusion Rules (ML-based):
├── Impossible travel + sensitive data access
├── Password spray + internal recon
├── Malicious IP + lateral movement
└── Credential theft + data exfiltration
                </div>
            </div>

            <!-- Multi-Workspace Example -->
            <div class="config-section">
                <h3>🌐 Case Study: GlobalCorp Conglomerate (50,000 Employees)</h3>
                
                <div class="info-box">
                    <h4>Company Profile</h4>
                    <p><strong>Industry:</strong> Diversified Holdings | <strong>Employees:</strong> 50,000 | <strong>Business Units:</strong> 5 (different industries) | <strong>Regions:</strong> NA, EU, APAC | <strong>Compliance:</strong> GDPR, CCPA, SOX</p>
                </div>

                <h4>Multi-Workspace with Central SOC</h4>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│               GLOBALCORP - MULTI-WORKSPACE SENTINEL ARCHITECTURE                    │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│                              AZURE LIGHTHOUSE                                        │
│                              ═══════════════                                         │
│                         (Cross-tenant management)                                    │
│                                    │                                                 │
│                                    ▼                                                 │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                         CENTRAL SOC TENANT                                  │   │
│   │                         ══════════════════                                  │   │
│   │                         (globalcorp-soc.com)                                │   │
│   │                                                                             │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │              CENTRAL SOC WORKSPACE                                  │   │   │
│   │   │              ═════════════════════                                  │   │   │
│   │   │              (law-globalcorp-soc-central)                           │   │   │
│   │   │                                                                     │   │   │
│   │   │   AGGREGATED DATA (via Workspace queries):                          │   │   │
│   │   │   • Cross-BU threat correlation                                     │   │   │
│   │   │   • Enterprise-wide hunting                                         │   │   │
│   │   │   • Unified incident queue                                          │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────────────────────────────────────────────────────────┐   │   │   │
│   │   │   │                  CROSS-WORKSPACE QUERIES                    │   │   │   │
│   │   │   │                  ═══════════════════════                    │   │   │   │
│   │   │   │                                                             │   │   │   │
│   │   │   │   union                                                     │   │   │   │
│   │   │   │       workspace("law-manufacturing-prod").SecurityAlert,    │   │   │   │
│   │   │   │       workspace("law-retail-prod").SecurityAlert,           │   │   │   │
│   │   │   │       workspace("law-finance-prod").SecurityAlert,          │   │   │   │
│   │   │   │       workspace("law-healthcare-prod").SecurityAlert,       │   │   │   │
│   │   │   │       workspace("law-tech-prod").SecurityAlert              │   │   │   │
│   │   │   │   | where TimeGenerated > ago(24h)                          │   │   │   │
│   │   │   │   | summarize count() by AlertName, BusinessUnit            │   │   │   │
│   │   │   │                                                             │   │   │   │
│   │   │   └─────────────────────────────────────────────────────────────┘   │   │   │
│   │   │                                                                     │   │   │
│   │   │   SOC TEAM ROLES:                                                   │   │   │
│   │   │   • Tier 1: View all workspaces, triage queue                       │   │   │
│   │   │   • Tier 2: Investigate across workspaces                           │   │   │
│   │   │   • Tier 3: Hunt across enterprise, manage rules                    │   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                         │                                            │
│              ┌──────────────────────────┼──────────────────────────┐                │
│              │                          │                          │                │
│              ▼                          ▼                          ▼                │
│   ┌──────────────────────┐  ┌──────────────────────┐  ┌──────────────────────┐      │
│   │   MANUFACTURING BU   │  │     RETAIL BU        │  │    FINANCE BU        │      │
│   │   ════════════════   │  │   ════════════       │  │   ══════════         │      │
│   │   (mfg.globalcorp)   │  │  (retail.globalcorp) │  │ (finance.globalcorp) │      │
│   │                      │  │                      │  │                      │      │
│   │  Workspace:          │  │  Workspace:          │  │  Workspace:          │      │
│   │  law-manufacturing   │  │  law-retail-prod     │  │  law-finance-prod    │      │
│   │                      │  │                      │  │                      │      │
│   │  Region: West Europe │  │  Region: East US     │  │  Region: East US     │      │
│   │  (GDPR compliance)   │  │  (PCI-DSS)           │  │  (SOX compliance)    │      │
│   │                      │  │                      │  │                      │      │
│   │  Data:               │  │  Data:               │  │  Data:               │      │
│   │  • OT/ICS logs       │  │  • POS systems       │  │  • Trading systems   │      │
│   │  • Factory network   │  │  • E-commerce        │  │  • Bloomberg feeds   │      │
│   │  • MES systems       │  │  • Store firewalls   │  │  • Wire transfers    │      │
│   │                      │  │                      │  │                      │      │
│   │  Volume: 300 GB/day  │  │  Volume: 800 GB/day  │  │  Volume: 500 GB/day  │      │
│   │                      │  │                      │  │                      │      │
│   │  BU Security Team:   │  │  BU Security Team:   │  │  BU Security Team:   │      │
│   │  3 analysts          │  │  5 analysts          │  │  4 analysts          │      │
│   │  (local monitoring)  │  │  (local monitoring)  │  │  (local monitoring)  │      │
│   │                      │  │                      │  │                      │      │
│   └──────────────────────┘  └──────────────────────┘  └──────────────────────┘      │
│              │                          │                          │                │
│              │                          │                          │                │
│   ┌──────────▼──────────┐  ┌───────────▼───────────┐                                │
│   │   HEALTHCARE BU     │  │      TECH BU          │                                │
│   │   ══════════════    │  │    ════════           │                                │
│   │  (health.globalcorp)│  │  (tech.globalcorp)    │                                │
│   │                     │  │                       │                                │
│   │  Workspace:         │  │  Workspace:           │                                │
│   │  law-healthcare-prod│  │  law-tech-prod        │                                │
│   │                     │  │                       │                                │
│   │  Region: East US    │  │  Region: West US 2    │                                │
│   │  (HIPAA compliance) │  │  (SOC 2)              │                                │
│   │                     │  │                       │                                │
│   │  Data:              │  │  Data:                │                                │
│   │  • EHR systems      │  │  • Kubernetes logs    │                                │
│   │  • Medical devices  │  │  • CI/CD pipelines    │                                │
│   │  • PACS imaging     │  │  • GitHub audit       │                                │
│   │                     │  │                       │                                │
│   │  Volume: 400 GB/day │  │  Volume: 600 GB/day   │                                │
│   │                     │  │                       │                                │
│   │  BU Security Team:  │  │  BU Security Team:    │                                │
│   │  4 analysts         │  │  3 analysts           │                                │
│   │                     │  │                       │                                │
│   └─────────────────────┘  └───────────────────────┘                                │
│                                                                                      │
│   TOTAL ENTERPRISE:                                                                  │
│   ═════════════════                                                                  │
│   • 5 Business Unit workspaces + 1 Central SOC                                       │
│   • 2.6 TB/day total ingestion                                                       │
│   • Regional data residency (EU data stays in EU)                                    │
│   • Azure Lighthouse for cross-tenant visibility                                     │
│   • RBAC: BU teams see only their data, SOC sees all                                 │
│                                                                                      │
│   ESTIMATED MONTHLY COST: ~$180,000                                                  │
│   (Multiple commitment tiers + Sentinel fees)                                        │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>

                <h4>Multi-Workspace Design Rationale</h4>
                <ul>
                    <li><strong>Data residency:</strong> EU manufacturing data must stay in EU region (GDPR)</li>
                    <li><strong>Compliance boundaries:</strong> Each BU has different compliance requirements</li>
                    <li><strong>Cost allocation:</strong> Each BU pays for their own workspace (chargebacks)</li>
                    <li><strong>RBAC separation:</strong> BU teams cannot see other BUs' data</li>
                    <li><strong>Central visibility:</strong> SOC uses cross-workspace queries for enterprise-wide hunting</li>
                    <li><strong>Azure Lighthouse:</strong> Enables central SOC to manage BU workspaces without tenant switching</li>
                </ul>
            </div>

            <!-- Sizing Guidelines -->
            <h2><i class="fas fa-calculator"></i> Sizing & Cost Guidelines</h2>

            <div class="config-section">
                <h3>Commitment Tier Pricing (2024)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Daily Volume</th>
                            <th>Pay-As-You-Go</th>
                            <th>Commitment Tier</th>
                            <th>Savings</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>100 GB/day</td>
                            <td>$430/day</td>
                            <td>$296/day (100 GB tier)</td>
                            <td>31%</td>
                        </tr>
                        <tr>
                            <td>500 GB/day</td>
                            <td>$2,150/day</td>
                            <td>$1,380/day (500 GB tier)</td>
                            <td>36%</td>
                        </tr>
                        <tr>
                            <td>1 TB/day</td>
                            <td>$4,300/day</td>
                            <td>$2,550/day (1 TB tier)</td>
                            <td>41%</td>
                        </tr>
                        <tr>
                            <td>5 TB/day</td>
                            <td>$21,500/day</td>
                            <td>$11,250/day (5 TB tier)</td>
                            <td>48%</td>
                        </tr>
                    </tbody>
                </table>
                <p><em>Note: Microsoft 365, Entra ID, and Defender data are FREE to ingest!</em></p>
            </div>

            <!-- Interview Q&A -->
            <h2><i class="fas fa-comments"></i> Interview Questions</h2>

            <div class="qa-section">
                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: When would you use multiple workspaces vs a single workspace?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Single workspace is preferred for most organizations - it simplifies management, enables cross-source correlation, and has a unified RBAC model. I'd use multiple workspaces for: (1) Data residency requirements - EU data must stay in EU region; (2) Strict compliance boundaries - HIPAA healthcare data separate from retail; (3) Cost allocation - different business units pay for their own data; (4) Different retention requirements - some data needs 7 years, others 90 days. Even with multiple workspaces, I use cross-workspace queries and Azure Lighthouse to maintain central SOC visibility."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you optimize Sentinel costs?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Several strategies: (1) Use commitment tiers - 100 GB/day tier saves 31%, larger tiers save more; (2) Leverage free data sources - M365, Entra ID, Defender are FREE; (3) Use Basic Logs tier for verbose, low-value data like container logs, flow logs; (4) Filter at ingestion using DCR transformations - drop unnecessary fields/events before they're ingested; (5) Move cold data to archive tier after 90 days; (6) Right-size retention - don't keep 2 years of data if compliance only requires 90 days. I typically see 40-60% cost reduction with proper optimization."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Explain the difference between AMA and the legacy Log Analytics agent (MMA).</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "AMA (Azure Monitor Agent) is the current standard - it uses Data Collection Rules (DCRs) for configuration, supports multiple destinations, allows filtering/transformation at collection time, and works with both Azure and on-prem (via Arc). MMA (Microsoft Monitoring Agent) is legacy and being retired in August 2024. Key differences: AMA is more efficient, DCR-based (code-as-config), supports multi-homing natively, and enables ingestion-time transformations. Migration involves installing AMA alongside MMA, validating data, then removing MMA. The DCR approach is much more flexible than MMA's workspace-centric config."</p>
                    </div>
                </div>
            </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>