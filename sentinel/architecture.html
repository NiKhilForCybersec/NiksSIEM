<!DOCTYPE html>
<html lang="en" data-theme="dark" data-platform="sentinel">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentinel Architecture | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>

            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel active"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="../splunk/index.html" class="platform-tab splunk"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
<nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link active"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-connectors.html" class="nav-link"><i class="fas fa-plug"></i> Data Connectors</a>
                    <a href="dcr-dce-guide.html" class="nav-link"><i class="fas fa-cogs"></i> DCR & DCE Deep Dive</a>
                    <a href="event-hub.html" class="nav-link"><i class="fas fa-broadcast-tower"></i> Event Hub Integration</a>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion & Cost</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">KQL Query Language</div>
                    <a href="kql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> KQL Fundamentals</a>
                    <a href="kql-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> KQL Intermediate</a>
                    <a href="kql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced KQL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="analytics-rules.html" class="nav-link"><i class="fas fa-bell"></i> Analytics Rules</a>
                    <a href="automation.html" class="nav-link"><i class="fas fa-robot"></i> Automation</a>
                    <a href="workbooks.html" class="nav-link"><i class="fas fa-chart-bar"></i> Workbooks</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Content & Intelligence</div>
                    <a href="content-hub.html" class="nav-link"><i class="fas fa-cube"></i> Content Hub & ASIM</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intelligence</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users-cog"></i> SOC Operations</a>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Sentinel</a>
                    <span class="separator">/</span>
                    <span class="current">Architecture</span>
                </div>
                <div class="top-actions">
                    <button class="top-btn" onclick="window.print()">
                        <i class="fas fa-print"></i> Print
                    </button>
                </div>
            </header>
            
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-sitemap"></i> Sentinel Architecture</h1>
                    <p class="lead">Understanding Microsoft Sentinel's components and design patterns.</p>
                </div>
                
                <section class="content-section">
                    <h2><i class="fas fa-layer-group"></i> Sentinel Components</h2>
                    
                    <div class="concept-box sentinel">
                        <h3>Microsoft Sentinel Architecture</h3>
                        <div class="architecture-diagram">
<pre style="font-family: 'Fira Code', monospace; font-size: 13px; line-height: 1.4;">
┌─────────────────────────────────────────────────────────────────────┐
│  MICROSOFT SENTINEL (SIEM + SOAR)                                   │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │
│  │  Analytics  │ │  Incidents  │ │  Workbooks  │ │  Hunting    │   │
│  │   Rules     │ │  & Cases    │ │ (Dashboards)│ │  Queries    │   │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │
│  │  Automation │ │  Notebooks  │ │  Watchlists │ │   Threat    │   │
│  │  (Playbooks)│ │ (Jupyter)   │ │             │ │   Intel     │   │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │
└─────────────────────────────────────────────────────────────────────┘
                                    ↑
┌─────────────────────────────────────────────────────────────────────┐
│  LOG ANALYTICS WORKSPACE                                            │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  Tables: SecurityEvent, SigninLogs, AzureActivity, etc.    │   │
│  │  KQL Query Engine | Data Retention | RBAC                   │   │
│  └─────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────┘
                                    ↑
┌─────────────────────────────────────────────────────────────────────┐
│  DATA INGESTION                                                     │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐      │
│  │ Native  │ │  CEF/   │ │   REST  │ │  Azure  │ │ Custom  │      │
│  │ M365    │ │ Syslog  │ │   API   │ │ Monitor │ │  Logs   │      │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘      │
└─────────────────────────────────────────────────────────────────────┘
</pre>
                        </div>
                    </div>
                </section>
                
                <section class="content-section">
                    <h2><i class="fas fa-puzzle-piece"></i> Key Components Explained</h2>
                    
                    <table class="data-table">
                        <thead>
                            <tr><th>Component</th><th>Purpose</th><th>Key Features</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Log Analytics Workspace</strong></td>
                                <td>Data storage and query engine</td>
                                <td>KQL queries, retention policies, RBAC</td>
                            </tr>
                            <tr>
                                <td><strong>Data Connectors</strong></td>
                                <td>Ingest data from sources</td>
                                <td>Native Microsoft, Syslog/CEF, REST API</td>
                            </tr>
                            <tr>
                                <td><strong>Analytics Rules</strong></td>
                                <td>Detect threats and create incidents</td>
                                <td>Scheduled, NRT, Fusion, anomaly rules</td>
                            </tr>
                            <tr>
                                <td><strong>Incidents</strong></td>
                                <td>Case management</td>
                                <td>Alert grouping, assignment, investigation</td>
                            </tr>
                            <tr>
                                <td><strong>Automation</strong></td>
                                <td>Response orchestration</td>
                                <td>Logic Apps playbooks, automation rules</td>
                            </tr>
                            <tr>
                                <td><strong>Workbooks</strong></td>
                                <td>Visualization and reporting</td>
                                <td>Interactive dashboards, templates</td>
                            </tr>
                            <tr>
                                <td><strong>Hunting</strong></td>
                                <td>Proactive threat search</td>
                                <td>Saved queries, bookmarks, livestream</td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                
                <section class="content-section">
                    <h2><i class="fas fa-project-diagram"></i> Workspace Design Patterns</h2>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-building"></i> Single Workspace (Simple)</h4>
                        <p><strong>Best for:</strong> Small to medium organizations</p>
                        <p><strong>Pros:</strong> Simple to manage, unified view, easier correlation</p>
                        <p><strong>Cons:</strong> Single point of failure, limited data segregation</p>
                    </div>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-city"></i> Multiple Workspaces (Complex)</h4>
                        <p><strong>Best for:</strong> Large enterprises, MSSPs, compliance requirements</p>
                        <p><strong>Reasons to use:</strong></p>
                        <ul>
                            <li>Data residency (different regions)</li>
                            <li>Billing separation (per business unit)</li>
                            <li>Access control (tenant separation)</li>
                            <li>Compliance (isolate regulated data)</li>
                        </ul>
                        <p><strong>Cons:</strong> Complex to manage, cross-workspace queries needed</p>
                    </div>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <span class="code-title">Cross-Workspace Queries</span>
                            <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                        </div>
                        <pre><code>// Query across multiple workspaces
union 
    workspace("workspace1").SecurityEvent,
    workspace("workspace2").SecurityEvent
| where EventID == 4625
| summarize count() by Computer

// Using workspace() function
let ws1 = workspace("prod-sentinel").SigninLogs;
let ws2 = workspace("dev-sentinel").SigninLogs;
union ws1, ws2
| where ResultType != 0</code></pre>
                    </div>
                </section>
                
                <section class="content-section">
                    <h2><i class="fas fa-dollar-sign"></i> Data Retention & Costs</h2>
                    
                    <table class="data-table">
                        <thead>
                            <tr><th>Tier</th><th>Retention</th><th>Query Access</th><th>Cost</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Analytics (Hot)</strong></td>
                                <td>Default 90 days</td>
                                <td>Full KQL</td>
                                <td>Per GB ingested</td>
                            </tr>
                            <tr>
                                <td><strong>Basic Logs</strong></td>
                                <td>8 days interactive</td>
                                <td>Limited KQL</td>
                                <td>~50% cheaper</td>
                            </tr>
                            <tr>
                                <td><strong>Archive</strong></td>
                                <td>Up to 12 years</td>
                                <td>Search jobs only</td>
                                <td>Lowest cost</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="tip-box">
                        <h4><i class="fas fa-lightbulb"></i> Cost Optimization Tips</h4>
                        <ul>
                            <li><strong>Use Basic Logs:</strong> For high-volume, low-value logs (e.g., verbose firewall)</li>
                            <li><strong>Filter at ingestion:</strong> Use DCRs to drop unnecessary data</li>
                            <li><strong>Commitment tiers:</strong> Pre-purchase capacity for discounts</li>
                            <li><strong>Review ingestion:</strong> Regularly check what's being ingested</li>
                        </ul>
                    </div>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <span class="code-title">Ingestion Monitoring</span>
                            <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                        </div>
                        <pre><code>// Check daily ingestion by table
Usage
| where TimeGenerated > ago(30d)
| summarize TotalGB = sum(Quantity) / 1000 by DataType
| order by TotalGB desc

// Check billable data
Usage
| where TimeGenerated > ago(1d)
| where IsBillable == true
| summarize BillableGB = sum(Quantity) / 1000</code></pre>
                    </div>
                </section>
                
                <section class="content-section">
                    <h2><i class="fas fa-user-shield"></i> RBAC (Role-Based Access Control)</h2>
                    
                    <table class="data-table">
                        <thead>
                            <tr><th>Role</th><th>Permissions</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Microsoft Sentinel Reader</strong></td>
                                <td>View data, incidents, workbooks (read-only)</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Sentinel Responder</strong></td>
                                <td>Reader + manage incidents</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Sentinel Contributor</strong></td>
                                <td>Responder + create rules, workbooks</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Sentinel Automation Contributor</strong></td>
                                <td>Add playbooks to automation rules</td>
                            </tr>
                            <tr>
                                <td><strong>Logic App Contributor</strong></td>
                                <td>Create and manage Logic Apps</td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                
                <section class="content-section">
                    <h2><i class="fas fa-link"></i> Integration with Defender XDR</h2>
                    
                    <div class="concept-box sentinel">
                        <h3>Unified Security Operations Platform</h3>
                        <p>Microsoft Sentinel integrates with the unified security operations platform:</p>
                        <ul>
                            <li><strong>Unified incidents:</strong> Defender XDR and Sentinel incidents in one portal</li>
                            <li><strong>Advanced hunting:</strong> Query both Defender and Sentinel data</li>
                            <li><strong>Automated investigation:</strong> Leverage Defender's AIR capabilities</li>
                            <li><strong>Entity pages:</strong> Unified view of users, devices, IPs</li>
                        </ul>
                    </div>
                </section>
                
                <section class="content-section">
                    <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                    
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>When would you recommend multiple Log Analytics workspaces?</span>
                        </div>
                        <div class="interview-answer">
                            <strong>Key Scenarios:</strong>
                            <p>Multiple workspaces are recommended when: <strong>Data sovereignty</strong> requires data to stay in specific regions. <strong>Compliance requirements</strong> mandate isolation of certain data types (PCI, HIPAA). <strong>MSSP scenarios</strong> need tenant separation for customer data. <strong>Cost allocation</strong> requires billing to different business units. However, always prefer single workspace when possible because it simplifies correlation, reduces query complexity, and maximizes the value of Fusion ML detection.</p>
                        </div>
                    </div>
                    
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>Explain the difference between Analytics Logs, Basic Logs, and Archive.</span>
                        </div>
                        <div class="interview-answer">
                            <strong>Data Tier Comparison:</strong>
                            <p><strong>Analytics Logs</strong> (Hot Tier) provide full KQL functionality with 90-730 day retention and are used for active detection and investigation. <strong>Basic Logs</strong> cost ~50% less but limit KQL operators and provide only 8 days of interactive query access—ideal for high-volume logs like verbose firewall data. <strong>Archive Tier</strong> is the cheapest option with up to 12 years retention, but requires search jobs for access—used for compliance and long-term forensics.</p>
                        </div>
                    </div>
                </section>

            </main>
            
            <footer class="content-footer">
                <div class="footer-content">
                    <p>Nik's SIEM - Microsoft Sentinel Architecture Guide</p>
                    <p>Personal Reference Guide</p>
                </div>
            </footer>
        </div>
    </div>
    
    <script src="../assets/js/main.js"></script>
</body>
</html>
