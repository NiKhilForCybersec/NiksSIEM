<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workbooks | Sentinel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="content-hub.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Content Hub</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-connectors.html" class="sidebar-nav-link"><i class="fas fa-plug"></i><span>Data Connectors</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="dcr-dce-guide.html" class="sidebar-nav-link"><i class="fas fa-cogs"></i><span>DCR & DCE Guide</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="event-hub.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Event Hub Integration</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-filter"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention & Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="kql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>KQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="kql-intermediate.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>KQL Intermediate</span></a></li>
                    <li class="sidebar-nav-item"><a href="kql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>KQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="workbooks.html" class="sidebar-nav-link"><i class="fas fa-chart-bar"></i><span>Workbooks</span></a></li>
                    <li class="sidebar-nav-item"><a href="notebooks.html" class="sidebar-nav-link"><i class="fas fa-book-open"></i><span>Notebooks</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="analytics-rules.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>Analytics Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="watchlists.html" class="sidebar-nav-link"><i class="fas fa-list-check"></i><span>Watchlists</span></a></li>
                    <li class="sidebar-nav-item"><a href="ueba.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intelligence</span></a></li>
                    <li class="sidebar-nav-item"><a href="hunting.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Hunting</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Security Use Cases -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Security Use Cases</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="security-usecases.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Detection Use Cases</span></a></li>
                    <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise Scenarios</span></a></li>
                </ul>
            </div>
            
            <!-- Automation -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>Automation & Playbooks</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-operations.html" class="sidebar-nav-link"><i class="fas fa-headset"></i><span>SOC Operations</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>RBAC & Permissions</span></a></li>
                    <li class="sidebar-nav-item"><a href="config-reference.html" class="sidebar-nav-link"><i class="fas fa-cog"></i><span>Configuration Reference</span></a></li>
                    <li class="sidebar-nav-item"><a href="devops.html" class="sidebar-nav-link"><i class="fas fa-code-branch"></i><span>Sentinel as Code</span></a></li>
                    <li class="sidebar-nav-item"><a href="advanced-operations.html" class="sidebar-nav-link"><i class="fas fa-cogs"></i><span>Advanced Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Sentinel</a>
                    <span class="separator">/</span>
                    <span class="current">Workbooks</span>
                </div>

                <h1><i class="fas fa-chart-bar"></i> Workbooks</h1>
                <p class="lead">Create interactive dashboards and reports in Microsoft Sentinel using Workbooks. Visualize security data, track metrics, and build SOC operational views with enterprise-grade design patterns.</p>

                <!-- Workbooks Overview -->
                <h2><i class="fas fa-info-circle"></i> Workbooks Overview</h2>
                <div class="config-section">
                    <p><span class="console-path">Sentinel → Threat Management → Workbooks</span></p>

                    <h4>Workbook Capabilities</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Visualizations:</strong> Charts, grids, tiles, maps</li>
                        <li><strong>Interactive:</strong> Parameters, filters, drill-downs</li>
                        <li><strong>Data sources:</strong> Logs, metrics, Azure Resource Graph</li>
                        <li><strong>Templates:</strong> Pre-built and custom</li>
                        <li><strong>Sharing:</strong> Save and share with team</li>
                    </ul>

                    <h4>Workbook Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Description</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Templates</strong></td>
                                <td>Pre-built from Content Hub</td>
                                <td>Quick start, standard views</td>
                            </tr>
                            <tr>
                                <td><strong>My Workbooks</strong></td>
                                <td>Personal saved workbooks</td>
                                <td>Custom analysis</td>
                            </tr>
                            <tr>
                                <td><strong>Shared</strong></td>
                                <td>Team-accessible workbooks</td>
                                <td>SOC dashboards</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Workbook Architecture in Enterprise Environment</h4>
                    <div class="arch-diagram">┌─────────────────────────────────────────────────────────────────────┐
│                    ENTERPRISE WORKBOOK ARCHITECTURE                   │
├─────────────────────────────────────────────────────────────────────┤
│                                                                       │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐   │
│  │   EXECUTIVE     │    │   SOC MANAGER   │    │   SOC ANALYST   │   │
│  │   DASHBOARDS    │    │   DASHBOARDS    │    │   DASHBOARDS    │   │
│  └────────┬────────┘    └────────┬────────┘    └────────┬────────┘   │
│           │                      │                      │             │
│           ▼                      ▼                      ▼             │
│  ┌─────────────────────────────────────────────────────────────────┐ │
│  │                    SHARED WORKBOOK GALLERY                       │ │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐           │ │
│  │  │ Security │ │ Incident │ │ Hunting  │ │ Compli-  │           │ │
│  │  │ Overview │ │ Metrics  │ │ Dashboard│ │ ance     │           │ │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘           │ │
│  └─────────────────────────────────────────────────────────────────┘ │
│                              │                                        │
│           ┌──────────────────┼──────────────────┐                    │
│           ▼                  ▼                  ▼                    │
│  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐        │
│  │ Log Analytics   │ │ Azure Resource  │ │  External       │        │
│  │ Workspace(s)    │ │ Graph           │ │  Data Sources   │        │
│  └─────────────────┘ └─────────────────┘ └─────────────────┘        │
│                                                                       │
│  GOVERNANCE LAYER:                                                   │
│  ┌─────────────────────────────────────────────────────────────────┐ │
│  │ • ARM Templates in Git    • RBAC per workbook                   │ │
│  │ • CI/CD Pipeline          • Version control                     │ │
│  │ • Naming conventions      • Documentation standards             │ │
│  └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘</div>
                </div>

                <!-- Workbook Design Decision Tree -->
                <h2><i class="fas fa-project-diagram"></i> Workbook Design Decision Tree</h2>
                <div class="config-section">
                    <div class="arch-diagram">WORKBOOK TYPE SELECTION DECISION TREE
═══════════════════════════════════════════════════════════════════

START: What is the primary use case?
│
├─► Executive Reporting (board, leadership)
│   │
│   ├─► Need: High-level KPIs, trends, posture
│   │   └─► BUILD: Executive Security Dashboard
│   │       • Monthly/quarterly time ranges
│   │       • Tiles for key metrics (incidents, MTTR, coverage)
│   │       • Minimal interactivity
│   │       • Export-friendly layout
│   │
│   └─► Need: Compliance status, audit readiness
│       └─► BUILD: Compliance Workbook
│           • Control status matrices
│           • Evidence collection links
│           • Historical trending
│
├─► SOC Operations (daily use)
│   │
│   ├─► Need: Alert triage, queue management
│   │   └─► BUILD: SOC Queue Dashboard
│   │       • Real-time refresh (5-15 min)
│   │       • Severity-based views
│   │       • Quick filters (time, type, status)
│   │       • Analyst assignment visibility
│   │
│   ├─► Need: Incident investigation
│   │   └─► BUILD: Investigation Workbook
│   │       • Entity-centric parameters
│   │       • Timeline visualizations
│   │       • Multi-table correlation
│   │       • Drill-down to raw logs
│   │
│   └─► Need: Shift handoff, status reporting
│       └─► BUILD: Operational Status Workbook
│           • Open incident summary
│           • Pending actions
│           • Recent closures with disposition
│
├─► Threat Hunting
│   │
│   └─► BUILD: Hunting Dashboard
│       • Hypothesis tracking
│       • Query result staging
│       • Bookmark integration
│       • MITRE ATT&CK mapping
│
├─► Performance Monitoring
│   │
│   ├─► Need: Data source health
│   │   └─► BUILD: Ingestion Health Workbook
│   │       • Volume trends per source
│   │       • Latency monitoring
│   │       • Gap detection
│   │
│   └─► Need: Detection coverage
│       └─► BUILD: Detection Coverage Workbook
│           • MITRE mapping visualization
│           • Rule trigger rates
│           • Gap analysis
│
└─► Custom Analysis
    │
    └─► BUILD: Analysis Template
        • Flexible parameters
        • Multiple visualization options
        • Export capability</div>
                </div>

                <!-- Essential Workbooks -->
                <h2><i class="fas fa-star"></i> Essential Security Workbooks</h2>
                <div class="config-section">
                    <h4>Built-in Templates</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Workbook</th><th>Purpose</th><th>Key Metrics</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Security Operations Efficiency</strong></td>
                                <td>SOC performance tracking</td>
                                <td>MTTD, MTTR, alert volume</td>
                            </tr>
                            <tr>
                                <td><strong>Azure AD Sign-in Logs</strong></td>
                                <td>Authentication analysis</td>
                                <td>Sign-ins, failures, MFA</td>
                            </tr>
                            <tr>
                                <td><strong>Investigation Insights</strong></td>
                                <td>Entity investigation</td>
                                <td>User/host activity</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Defender for Endpoint</strong></td>
                                <td>Endpoint security</td>
                                <td>Alerts, devices, vulnerabilities</td>
                            </tr>
                            <tr>
                                <td><strong>Threat Intelligence</strong></td>
                                <td>IOC analysis</td>
                                <td>IOC matches, sources</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Enterprise Workbook Portfolio</h4>
                    <p>A mature security operations program typically maintains these workbook categories:</p>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Category</th><th>Workbooks</th><th>Primary Audience</th><th>Refresh Rate</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Executive</strong></td>
                                <td>Security Posture, Risk Dashboard, Compliance Status</td>
                                <td>CISO, Board, Leadership</td>
                                <td>Weekly/Monthly</td>
                            </tr>
                            <tr>
                                <td><strong>Operational</strong></td>
                                <td>SOC Queue, Incident Status, Shift Handoff</td>
                                <td>SOC Manager, Tier Leads</td>
                                <td>5-15 minutes</td>
                            </tr>
                            <tr>
                                <td><strong>Analyst</strong></td>
                                <td>Investigation, Entity 360, Alert Triage</td>
                                <td>SOC Analysts</td>
                                <td>On-demand</td>
                            </tr>
                            <tr>
                                <td><strong>Engineering</strong></td>
                                <td>Ingestion Health, Detection Coverage, Rule Performance</td>
                                <td>Detection Engineers</td>
                                <td>Hourly/Daily</td>
                            </tr>
                            <tr>
                                <td><strong>Hunting</strong></td>
                                <td>Hypothesis Tracker, Anomaly Analysis, IOC Hunt</td>
                                <td>Threat Hunters</td>
                                <td>On-demand</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Creating Workbooks -->
                <h2><i class="fas fa-plus-circle"></i> Creating Custom Workbooks</h2>
                <div class="config-section">
                    <p><span class="console-path">Workbooks → Add workbook</span></p>

                    <h4>Workbook Elements</h4>
                    <div class="arch-diagram">Available Elements:

Text:
- Markdown formatted text
- Headers and descriptions
- Links and documentation

Parameters:
- Time range picker
- Dropdown selections
- Resource picker
- Text input

Query:
- KQL queries
- Visualizations (chart, grid, tile)
- Conditional formatting

Links:
- Navigation between views
- External links
- Action buttons

Groups:
- Organize elements
- Tabs and sections
- Collapsible areas</div>

                    <h4>Adding a Query Visualization</h4>
                    <div class="arch-diagram">1. Click "Add" → "Add query"

2. Enter KQL Query:
SecurityAlert
| where TimeGenerated > ago(7d)
| summarize Count = count() by AlertSeverity
| order by Count desc

3. Select Visualization:
- Bar chart
- Pie chart
- Line chart
- Grid (table)
- Tiles

4. Configure Settings:
- Chart title
- Legend position
- Colors
- Size

5. Save workbook</div>
                </div>

                <!-- Advanced Workbook Techniques -->
                <h2><i class="fas fa-cogs"></i> Advanced Workbook Techniques</h2>
                <div class="config-section">
                    <h4>Groups and Tabs</h4>
                    <p>Organize complex workbooks using groups for tabs, collapsible sections, and conditional visibility:</p>
                    <div class="arch-diagram">GROUP TYPES AND USE CASES
═══════════════════════════════════════════════════════════════

TABS GROUP
├── Use: Multi-page navigation within single workbook
├── Example: Investigation workbook with User/Host/Network tabs
└── Config: Group → Style: Tabs

COLLAPSIBLE GROUP
├── Use: Hide detailed sections until needed
├── Example: Advanced filters, raw data views
└── Config: Group → Make this item conditionally visible

CONDITIONAL VISIBILITY
├── Use: Show/hide sections based on parameter selection
├── Example: Show Linux queries only when OS = Linux
└── Config: Advanced Settings → Make this item conditionally visible
    → Condition: {Parameter} == "value"</div>

                    <h4>Cross-Resource Queries</h4>
                    <p>Query multiple Log Analytics workspaces from a single workbook:</p>
                    <div class="arch-diagram">// Query multiple workspaces using workspace() function
union
    workspace("SecurityWorkspace-Prod").SecurityAlert,
    workspace("SecurityWorkspace-Dev").SecurityAlert
| where TimeGenerated > ago(24h)
| summarize AlertCount = count() by WorkspaceName = _ResourceId
| order by AlertCount desc

// Using Resource parameter for dynamic workspace selection
// 1. Create parameter: Type = Resource, Allow multiple selections
// 2. Query references:
{Workspaces}
| where TimeGenerated {TimeRange}
| summarize count() by Type</div>

                    <h4>Export Functionality</h4>
                    <p>Enable data export for compliance and offline analysis:</p>
                    <div class="arch-diagram">EXPORT OPTIONS
═══════════════════════════════════════════════════════════════

QUERY-LEVEL EXPORT
├── Enable: Query → Advanced Settings → Show export to Excel
├── Format: XLSX with all visible columns
└── Use Case: Analyst data extraction

WORKBOOK-LEVEL EXPORT
├── Enable: Workbook → More → Export as ARM template
├── Format: JSON ARM template
└── Use Case: Version control, deployment automation

PDF EXPORT (Print)
├── Enable: Workbook → More → Print
├── Format: PDF via browser print
└── Use Case: Executive reporting, compliance evidence</div>
                </div>

                <!-- Parameters -->
                <h2><i class="fas fa-sliders-h"></i> Parameters</h2>
                <div class="config-section">
                    <h4>Parameter Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Description</th><th>Example</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Time Range</strong></td>
                                <td>Date/time picker</td>
                                <td>Last 24 hours, 7 days</td>
                            </tr>
                            <tr>
                                <td><strong>Dropdown</strong></td>
                                <td>Selection list</td>
                                <td>Severity filter</td>
                            </tr>
                            <tr>
                                <td><strong>Text</strong></td>
                                <td>Free text input</td>
                                <td>User search</td>
                            </tr>
                            <tr>
                                <td><strong>Resource</strong></td>
                                <td>Azure resource picker</td>
                                <td>Workspace selection</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Time Range Parameter</h4>
                    <div class="arch-diagram">Creating Time Range Parameter:

1. Add → Add parameter
2. Parameter name: TimeRange
3. Parameter type: Time range picker
4. Required: Yes
5. Default: Last 24 hours

Using in Queries:
SecurityAlert
| where TimeGenerated {TimeRange}
| summarize count() by AlertName</div>

                    <h4>Dropdown Parameter</h4>
                    <div class="arch-diagram">Creating Severity Dropdown:

1. Add → Add parameter
2. Parameter name: Severity
3. Parameter type: Dropdown
4. Get data from: Query

Query:
SecurityAlert
| distinct AlertSeverity
| order by AlertSeverity asc

Using in Queries:
SecurityAlert
| where TimeGenerated {TimeRange}
| where AlertSeverity == "{Severity}" or "{Severity}" == "All"
| summarize count() by AlertName</div>

                    <h4>Advanced Parameter Techniques</h4>
                    <div class="arch-diagram">CASCADING PARAMETERS
═══════════════════════════════════════════════════════════════
Create dependent dropdowns where second parameter depends on first:

Parameter 1: AlertProduct
Query: SecurityAlert | distinct ProductName

Parameter 2: AlertName (depends on AlertProduct)
Query: SecurityAlert 
       | where ProductName == "{AlertProduct}"
       | distinct AlertName

MULTI-SELECT PARAMETERS
═══════════════════════════════════════════════════════════════
Enable multiple selections and handle in query:

Parameter: Severities (Allow multiple selections, delimiter: ,)

Query:
SecurityAlert
| where TimeGenerated {TimeRange}
| where AlertSeverity in ({Severities})
| summarize count() by AlertSeverity

HIDDEN PARAMETERS
═══════════════════════════════════════════════════════════════
Store calculated values for use across queries:

Parameter: CurrentUser (Hidden, Default: current_principal_details())
Use: Filter to analyst's assigned incidents</div>
                </div>

                <!-- SOC Dashboard Examples -->
                <h2><i class="fas fa-tachometer-alt"></i> SOC Dashboard Examples</h2>
                <div class="config-section">
                    <h4>Alert Overview Dashboard</h4>
                    <div class="arch-diagram">// Total Alerts Tile
SecurityAlert
| where TimeGenerated {TimeRange}
| count

// Alerts by Severity (Pie Chart)
SecurityAlert
| where TimeGenerated {TimeRange}
| summarize Count = count() by AlertSeverity
| order by Count desc

// Alerts Trend (Line Chart)
SecurityAlert
| where TimeGenerated {TimeRange}
| summarize Count = count() by bin(TimeGenerated, 1h)
| order by TimeGenerated asc

// Top Alert Types (Bar Chart)
SecurityAlert
| where TimeGenerated {TimeRange}
| summarize Count = count() by AlertName
| top 10 by Count
| order by Count desc

// Recent Alerts (Grid)
SecurityAlert
| where TimeGenerated {TimeRange}
| project TimeGenerated, AlertName, AlertSeverity, 
          ProviderName, Status
| order by TimeGenerated desc
| take 100</div>

                    <h4>Incident Status Dashboard</h4>
                    <div class="arch-diagram">// Open Incidents by Severity
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status != "Closed"
| summarize Count = count() by Severity

// Incidents by Status
SecurityIncident
| where TimeGenerated > ago(30d)
| summarize Count = count() by Status

// Mean Time to Triage
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status != "New"
| extend MTTT = datetime_diff('minute', FirstModifiedTime, CreatedTime)
| summarize AvgMTTT = avg(MTTT)

// Incidents by Owner
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Active"
| summarize Count = count() by Owner.assignedTo
| order by Count desc</div>

                    <h4>Enterprise SOC Metrics Dashboard</h4>
                    <div class="arch-diagram">// MTTD - Mean Time to Detect (hours)
// Requires custom field mapping for actual attack time vs detection
SecurityIncident
| where TimeGenerated {TimeRange}
| where Status == "Closed"
| extend MTTD_hours = datetime_diff('hour', CreatedTime, 
         todatetime(AdditionalData.attackStartTime))
| where isnotnull(MTTD_hours) and MTTD_hours > 0
| summarize AvgMTTD = avg(MTTD_hours), 
            MedianMTTD = percentile(MTTD_hours, 50)

// MTTR - Mean Time to Respond (hours)
SecurityIncident
| where TimeGenerated {TimeRange}
| where Status == "Closed"
| extend MTTR_hours = datetime_diff('hour', ClosedTime, CreatedTime)
| summarize AvgMTTR = avg(MTTR_hours),
            MedianMTTR = percentile(MTTR_hours, 50)

// False Positive Rate
SecurityIncident
| where TimeGenerated {TimeRange}
| where Status == "Closed"
| summarize 
    TotalClosed = count(),
    FalsePositives = countif(Classification == "FalsePositive")
| extend FP_Rate = round(100.0 * FalsePositives / TotalClosed, 1)

// Analyst Efficiency Metrics
SecurityIncident
| where TimeGenerated {TimeRange}
| where Status == "Closed"
| summarize 
    IncidentsClosed = count(),
    AvgTimeToClose = avg(datetime_diff('hour', ClosedTime, CreatedTime))
  by Owner.assignedTo
| order by IncidentsClosed desc</div>
                </div>

                <!-- Investigation Workbook -->
                <h2><i class="fas fa-search"></i> Investigation Workbooks</h2>
                <div class="config-section">
                    <h4>User Investigation Template</h4>
                    <div class="arch-diagram">Parameters:
- TimeRange: Time range picker
- UserAccount: Text input

// User Sign-in Activity
SigninLogs
| where TimeGenerated {TimeRange}
| where UserPrincipalName =~ "{UserAccount}"
| project TimeGenerated, ResultType, IPAddress, 
          AppDisplayName, Location = strcat(LocationDetails.city)
| order by TimeGenerated desc

// Failed Sign-ins
SigninLogs
| where TimeGenerated {TimeRange}
| where UserPrincipalName =~ "{UserAccount}"
| where ResultType != 0
| summarize FailedCount = count() by IPAddress, ResultDescription
| order by FailedCount desc

// User Alerts
SecurityAlert
| where TimeGenerated {TimeRange}
| where Entities contains "{UserAccount}"
| project TimeGenerated, AlertName, AlertSeverity, Description

// User Audit Activity
AuditLogs
| where TimeGenerated {TimeRange}
| where InitiatedBy.user.userPrincipalName =~ "{UserAccount}"
| project TimeGenerated, OperationName, Result, TargetResources</div>

                    <h4>Host Investigation Template</h4>
                    <div class="arch-diagram">Parameters:
- TimeRange: Time range picker
- HostName: Text input

// Device Alerts
SecurityAlert
| where TimeGenerated {TimeRange}
| where Entities contains "{HostName}"
| project TimeGenerated, AlertName, AlertSeverity

// Process Executions
DeviceProcessEvents
| where TimeGenerated {TimeRange}
| where DeviceName =~ "{HostName}"
| project TimeGenerated, FileName, ProcessCommandLine, AccountName

// Network Connections
DeviceNetworkEvents
| where TimeGenerated {TimeRange}
| where DeviceName =~ "{HostName}"
| summarize Connections = count() by RemoteIP, RemotePort
| order by Connections desc

// Logon Events
DeviceLogonEvents
| where TimeGenerated {TimeRange}
| where DeviceName =~ "{HostName}"
| project TimeGenerated, AccountName, LogonType, RemoteIP</div>

                    <h4>Entity 360 Investigation Workbook</h4>
                    <div class="arch-diagram">ENTITY 360 WORKBOOK DESIGN
═══════════════════════════════════════════════════════════════

TAB 1: OVERVIEW
├── Entity summary tile (type, risk score, first/last seen)
├── Related incidents list
├── Timeline visualization of all activities
└── Quick stats (alerts, logins, anomalies)

TAB 2: AUTHENTICATION
├── Sign-in trend chart
├── Failed authentication breakdown
├── Location map
├── MFA status and method
└── Risky sign-ins correlation

TAB 3: ACTIVITY
├── File operations
├── Process executions
├── Registry modifications
├── Network connections
└── Privilege operations

TAB 4: RELATIONSHIPS
├── Devices used by user / Users of device
├── Network peers
├── Administrative relationships
├── Group memberships
└── Application access

TAB 5: THREAT CONTEXT
├── MITRE ATT&CK mapping
├── Related threat intel
├── Similar incidents in organization
└── Industry threat correlation</div>
                </div>

                <!-- Visualization Best Practices -->
                <h2><i class="fas fa-palette"></i> Visualization Best Practices</h2>
                <div class="config-section">
                    <div class="arch-diagram">Visualization Selection:

TILES: Single metrics, KPIs
- Total alerts
- Open incidents
- MTTR value

PIE CHARTS: Proportions
- Alerts by severity
- Incidents by status
- Traffic by protocol

BAR CHARTS: Comparisons
- Top attack sources
- Alerts by type
- Users with most failures

LINE CHARTS: Trends over time
- Alert volume trend
- Login attempts
- Incident creation rate

GRIDS: Detailed data
- Alert list
- Investigation results
- Audit trail

MAPS: Geographic data
- Attack sources
- User locations
- Global threat view</div>

                    <h4>Design Tips</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Keep it simple:</strong> Don't overcrowd</li>
                        <li><strong>Use consistent colors:</strong> Red for critical, etc.</li>
                        <li><strong>Add context:</strong> Text explanations</li>
                        <li><strong>Enable interactivity:</strong> Drill-down capability</li>
                        <li><strong>Optimize queries:</strong> Fast-loading dashboards</li>
                    </ul>

                    <h4>Enterprise Visualization Standards</h4>
                    <div class="arch-diagram">COLOR STANDARDS (consistent across all workbooks)
═══════════════════════════════════════════════════════════════
Critical/High:     #FF4444 (Red)
Medium:            #FF8C00 (Orange)
Low:               #FFD700 (Yellow)
Informational:     #00CED1 (Cyan)
Success/Resolved:  #32CD32 (Green)
Neutral/Unknown:   #808080 (Gray)

LAYOUT STANDARDS
═══════════════════════════════════════════════════════════════
┌────────────────────────────────────────────────────────────┐
│ HEADER: Workbook title, Time range parameter, Key filters  │
├────────────────────────────────────────────────────────────┤
│ KPI ROW: 4-6 tiles with key metrics                        │
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐          │
│ │Total│ │ High│ │MTTR │ │ FP% │ │Open │ │Queue│          │
│ └─────┘ └─────┘ └─────┘ └─────┘ └─────┘ └─────┘          │
├────────────────────────────────────────────────────────────┤
│ TREND ROW: Line charts showing time-based patterns          │
├────────────────────────────────────────────────────────────┤
│ BREAKDOWN ROW: Bar/pie charts for categorical analysis      │
├────────────────────────────────────────────────────────────┤
│ DETAIL SECTION: Grids with drill-down capability           │
└────────────────────────────────────────────────────────────┘</div>
                </div>

                <!-- Performance Optimization -->
                <h2><i class="fas fa-tachometer-alt"></i> Workbook Performance Optimization</h2>
                <div class="config-section">
                    <h4>Query Optimization Techniques</h4>
                    <div class="arch-diagram">PERFORMANCE BEST PRACTICES
═══════════════════════════════════════════════════════════════

1. TIME FILTER FIRST
   ✓ SecurityAlert | where TimeGenerated > ago(7d) | ...
   ✗ SecurityAlert | where AlertSeverity == "High" | where TimeGenerated > ago(7d)

2. USE INDEXED COLUMNS EARLY
   High-performance: TimeGenerated, _ResourceId, Computer
   Filter on these columns before others

3. LIMIT DATA EARLY
   ✓ SecurityAlert | where TimeGenerated > ago(1d) | take 1000 | ...
   ✗ SecurityAlert | ... | take 1000

4. AVOID UNNECESSARY COLUMNS
   ✓ | project TimeGenerated, AlertName, Severity
   ✗ | project * 

5. USE MATERIALIZED VIEWS
   For repeated expensive aggregations, consider summarize tables

6. QUERY CACHING
   Enable: Query → Advanced Settings → Use cached results
   TTL: 5-15 minutes for operational dashboards

7. PARALLEL QUERIES
   Split independent queries into separate elements
   Workbooks execute elements in parallel</div>

                    <h4>Common Performance Issues</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Issue</th><th>Symptom</th><th>Solution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Large time range</strong></td>
                                <td>Queries timeout after 10 min</td>
                                <td>Limit default time range, use summarized tables</td>
                            </tr>
                            <tr>
                                <td><strong>Cross-workspace queries</strong></td>
                                <td>Slow performance, high latency</td>
                                <td>Pre-aggregate data, use Azure Data Explorer pools</td>
                            </tr>
                            <tr>
                                <td><strong>Complex regex</strong></td>
                                <td>High CPU, slow execution</td>
                                <td>Use extract() instead of regex, pre-parse fields</td>
                            </tr>
                            <tr>
                                <td><strong>Too many visualizations</strong></td>
                                <td>Dashboard loads slowly</td>
                                <td>Use tabs/groups, lazy loading, limit initial queries</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Version Control and Deployment -->
                <h2><i class="fas fa-code-branch"></i> Version Control & Deployment</h2>
                <div class="config-section">
                    <h4>ARM Template Export</h4>
                    <p>Export workbooks as ARM templates for version control and CI/CD deployment:</p>
                    <div class="arch-diagram">EXPORT PROCESS
═══════════════════════════════════════════════════════════════

1. Open workbook in edit mode
2. Click "Advanced Editor" (code icon)
3. Select "ARM Template" tab
4. Copy JSON content
5. Save to Git repository

TEMPLATE STRUCTURE:
{
  "$schema": "https://schema.management.azure.com/.../deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": { "type": "string" },
    "workbookSourceId": { "type": "string" }
  },
  "resources": [{
    "type": "microsoft.insights/workbooks",
    "apiVersion": "2022-04-01",
    "name": "[guid(parameters('workbookDisplayName'))]",
    "location": "[resourceGroup().location]",
    "properties": {
      "displayName": "[parameters('workbookDisplayName')]",
      "serializedData": "...",
      "sourceId": "[parameters('workbookSourceId')]",
      "category": "sentinel"
    }
  }]
}</div>

                    <h4>CI/CD Pipeline Integration</h4>
                    <div class="arch-diagram">GIT REPOSITORY STRUCTURE
═══════════════════════════════════════════════════════════════
sentinel-workbooks/
├── README.md
├── .github/workflows/
│   └── deploy-workbooks.yml
├── workbooks/
│   ├── executive/
│   │   ├── security-posture.json
│   │   └── compliance-dashboard.json
│   ├── operational/
│   │   ├── soc-queue.json
│   │   └── incident-status.json
│   └── investigation/
│       ├── user-investigation.json
│       └── host-investigation.json
└── parameters/
    ├── prod.parameters.json
    └── dev.parameters.json</div>
                </div>

                <!-- Common Failures -->
                <h2><i class="fas fa-exclamation-triangle"></i> What Enterprises Usually Miss</h2>
                <div class="config-section">
                    <div class="arch-diagram">COMMON WORKBOOK FAILURES AND SOLUTIONS
═══════════════════════════════════════════════════════════════

❌ FAILURE 1: No Workbook Governance
   Problem: Dozens of duplicate/abandoned workbooks, no standards
   Impact: Confusion, inconsistent data, maintenance burden
   Solution: Establish workbook registry, ownership, review cycle
   
❌ FAILURE 2: Over-Engineering Workbooks
   Problem: Single workbook tries to do everything
   Impact: Slow performance, confusing UI, maintenance nightmare
   Solution: Purpose-specific workbooks, linked navigation
   
❌ FAILURE 3: No Version Control
   Problem: Manual portal edits, no change history
   Impact: Lost changes, can't rollback, no audit trail
   Solution: ARM templates in Git, CI/CD deployment
   
❌ FAILURE 4: Ignoring Performance
   Problem: Complex queries, no optimization, no caching
   Impact: Slow dashboards, analyst frustration, abandonment
   Solution: Query optimization, caching, performance testing
   
❌ FAILURE 5: No User Feedback Loop
   Problem: Building what engineers think users need
   Impact: Low adoption, parallel spreadsheet tracking
   Solution: User interviews, usage analytics, iteration
   
❌ FAILURE 6: Hardcoded Values
   Problem: Workspace IDs, time ranges embedded in queries
   Impact: Breaks in new environments, maintenance overhead
   Solution: Parameters for all configurable values
   
❌ FAILURE 7: No Documentation
   Problem: Workbooks without context or instructions
   Impact: Users don't understand what they're seeing
   Solution: Text elements explaining each section
   
❌ FAILURE 8: Inconsistent Metrics
   Problem: Same metric calculated differently across workbooks
   Impact: Conflicting reports, lost credibility
   Solution: Centralized metric definitions, functions library
   
❌ FAILURE 9: No Access Control
   Problem: Everyone can edit shared workbooks
   Impact: Accidental changes, broken dashboards
   Solution: RBAC per workbook, edit vs. view permissions
   
❌ FAILURE 10: Abandoning Templates
   Problem: Not leveraging Content Hub workbooks
   Impact: Reinventing wheel, missing best practices
   Solution: Start with templates, customize incrementally</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you build a SOC metrics dashboard in Sentinel?</button>
                        <div class="qa-answer">
                            <p>I'd follow a structured approach:</p>
                            <ol>
                                <li><strong>Define metrics with stakeholders:</strong> MTTD, MTTR, alert volume, FP rate, analyst efficiency - ensure agreement on calculation methodology</li>
                                <li><strong>Create parameters:</strong> Time range (default 30d for trends), severity filter, analyst filter</li>
                                <li><strong>Build KQL queries:</strong> Calculate each metric with consistent definitions, test performance</li>
                                <li><strong>Design layout:</strong> KPI tiles at top, trend charts middle, breakdown charts, detail grid at bottom</li>
                                <li><strong>Add drill-downs:</strong> Click metrics to see underlying data</li>
                                <li><strong>Implement export:</strong> Enable Excel export for stakeholder distribution</li>
                                <li><strong>Version control:</strong> Export ARM template to Git</li>
                            </ol>
                            <p style="margin-top: 12px;"><strong>Key consideration:</strong> Ensure metric definitions match what's reported elsewhere - MTTR calculated inconsistently across dashboards destroys credibility.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between workbooks and dashboards?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Workbooks:</strong> Interactive, parameters, multiple pages, detailed analysis, primarily KQL-based</li>
                                <li><strong>Azure Dashboards:</strong> Fixed layout, quick overview, pins from various sources including metrics</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Use Workbooks for:</strong> Detailed investigation, SOC operations, interactive analysis, security-specific visualization</p>
                            <p><strong>Use Dashboards for:</strong> At-a-glance monitoring, executive view, cross-service visibility (mixing Sentinel with other Azure services)</p>
                            <p style="margin-top: 12px;"><strong>Enterprise pattern:</strong> Most security teams use workbooks for 90%+ of needs. Azure Dashboards are used primarily for infrastructure monitoring or hybrid views combining security + operations metrics.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you use parameters to make workbooks interactive?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Time range:</strong> Filter all queries by selected period - essential for every workbook</li>
                                <li><strong>Dropdown:</strong> Filter by severity, user, product - populate dynamically from data</li>
                                <li><strong>Text input:</strong> Search for specific entity (IP, user, hash)</li>
                                <li><strong>Resource:</strong> Select workspace or subscription - critical for multi-workspace environments</li>
                            </ul>
                            <p style="margin-top: 12px;">Reference parameters in queries using {ParameterName} syntax.</p>
                            <p style="margin-top: 12px;"><strong>Advanced techniques:</strong></p>
                            <ul>
                                <li>Cascading parameters - second dropdown depends on first selection</li>
                                <li>Multi-select with IN operator handling</li>
                                <li>Hidden parameters for calculated values</li>
                                <li>Conditional visibility based on parameter value</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you design an investigation workbook for SOC analysts?</button>
                        <div class="qa-answer">
                            <p>I'd create an Entity 360 workbook with these components:</p>
                            <ol>
                                <li><strong>Input parameters:</strong> Entity type selector (user/host/IP), entity value input, time range</li>
                                <li><strong>Tab structure:</strong>
                                    <ul>
                                        <li>Overview: Summary tile, risk score, related incidents, timeline</li>
                                        <li>Authentication: Sign-ins, failures, locations, MFA status</li>
                                        <li>Activity: Process, file, network, registry events</li>
                                        <li>Relationships: Associated users/devices, group memberships</li>
                                        <li>Threat Context: MITRE mapping, threat intel matches</li>
                                    </ul>
                                </li>
                                <li><strong>Drill-down capability:</strong> Click any item to see raw logs</li>
                                <li><strong>Action links:</strong> Direct links to incident, isolate device, reset password</li>
                            </ol>
                            <p style="margin-top: 12px;"><strong>Key design principle:</strong> Reduce context switching. Analyst should be able to investigate without leaving the workbook.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle workbook performance issues?</button>
                        <div class="qa-answer">
                            <p>I follow a systematic optimization approach:</p>
                            <ol>
                                <li><strong>Identify bottleneck:</strong> Check query statistics for CPU time, data scanned, execution time</li>
                                <li><strong>Query optimization:</strong>
                                    <ul>
                                        <li>Time filter first (TimeGenerated)</li>
                                        <li>Use indexed columns early</li>
                                        <li>Limit rows before complex operations</li>
                                        <li>Project only needed columns</li>
                                    </ul>
                                </li>
                                <li><strong>Workbook optimization:</strong>
                                    <ul>
                                        <li>Enable query caching (5-15 min TTL)</li>
                                        <li>Split into tabs for lazy loading</li>
                                        <li>Reduce default time range</li>
                                        <li>Use take/limit for preview grids</li>
                                    </ul>
                                </li>
                                <li><strong>Architecture optimization:</strong>
                                    <ul>
                                        <li>Pre-aggregate data with summarize rules</li>
                                        <li>Use Azure Data Explorer for cross-workspace</li>
                                        <li>Consider materialized views for complex calculations</li>
                                    </ul>
                                </li>
                            </ol>
                            <p style="margin-top: 12px;"><strong>Target:</strong> Operational dashboards &lt; 10s, investigation &lt; 30s, trend analysis &lt; 60s</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you manage workbooks across environments (dev/prod)?</button>
                        <div class="qa-answer">
                            <p>I implement infrastructure-as-code practices:</p>
                            <ol>
                                <li><strong>Export as ARM templates:</strong> Use Advanced Editor to extract JSON</li>
                                <li><strong>Parameterize environment-specific values:</strong>
                                    <ul>
                                        <li>Workspace ID as parameter</li>
                                        <li>Resource group references</li>
                                        <li>Subscription IDs</li>
                                    </ul>
                                </li>
                                <li><strong>Git repository structure:</strong>
                                    <ul>
                                        <li>Workbooks organized by category</li>
                                        <li>Parameter files per environment</li>
                                        <li>CI/CD pipeline definitions</li>
                                    </ul>
                                </li>
                                <li><strong>Deployment pipeline:</strong>
                                    <ul>
                                        <li>Validate templates</li>
                                        <li>Deploy to dev, test queries</li>
                                        <li>Promote to prod with approval gate</li>
                                    </ul>
                                </li>
                            </ol>
                            <p style="margin-top: 12px;"><strong>Benefits:</strong> Change tracking, rollback capability, consistent deployments, code review for changes.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you ensure consistent metrics across multiple workbooks?</button>
                        <div class="qa-answer">
                            <p>This is a common enterprise challenge. I'd implement:</p>
                            <ol>
                                <li><strong>Centralized metric definitions:</strong>
                                    <ul>
                                        <li>Document calculation methodology for each metric</li>
                                        <li>Store approved KQL in shared library</li>
                                        <li>Version control with change approval</li>
                                    </ul>
                                </li>
                                <li><strong>KQL functions:</strong>
                                    <ul>
                                        <li>Create saved functions for standard calculations</li>
                                        <li>Example: CalculateMTTR() function used everywhere</li>
                                        <li>Single point of update when logic changes</li>
                                    </ul>
                                </li>
                                <li><strong>Pre-computed tables:</strong>
                                    <ul>
                                        <li>Analytics rules that calculate daily metrics</li>
                                        <li>Store in custom log table</li>
                                        <li>Workbooks query pre-computed values</li>
                                    </ul>
                                </li>
                                <li><strong>Governance process:</strong>
                                    <ul>
                                        <li>Review cycle for metric accuracy</li>
                                        <li>Stakeholder sign-off on definitions</li>
                                        <li>Automated testing of metric consistency</li>
                                    </ul>
                                </li>
                            </ol>
                            <p style="margin-top: 12px;"><strong>Anti-pattern:</strong> Copying KQL between workbooks leads to drift and conflicting numbers.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Describe a workbook you built that had significant business impact.</button>
                        <div class="qa-answer">
                            <p><strong>Example: Detection Coverage Dashboard</strong></p>
                            <p><strong>Business problem:</strong> Leadership asked "Are we protected?" but we couldn't quantify detection coverage against MITRE ATT&CK.</p>
                            <p><strong>Solution built:</strong></p>
                            <ul>
                                <li>Mapped all analytics rules to MITRE techniques</li>
                                <li>Created heatmap visualization showing coverage by tactic</li>
                                <li>Added trend showing coverage improvement over time</li>
                                <li>Included gap analysis highlighting uncovered techniques</li>
                            </ul>
                            <p><strong>Technical implementation:</strong></p>
                            <ul>
                                <li>Query extracting MITRE tags from rule metadata</li>
                                <li>Join with complete MITRE matrix for gap identification</li>
                                <li>Historical tracking via pre-computed daily snapshots</li>
                            </ul>
                            <p><strong>Impact:</strong></p>
                            <ul>
                                <li>Identified 40% coverage gap in Initial Access techniques</li>
                                <li>Prioritized detection engineering roadmap</li>
                                <li>Improved coverage from 35% to 68% over 6 months</li>
                                <li>Monthly executive report on detection maturity</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>
