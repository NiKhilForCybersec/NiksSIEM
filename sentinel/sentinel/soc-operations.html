<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOC Operations | Sentinel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="content-hub.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Content Hub</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-connectors.html" class="sidebar-nav-link"><i class="fas fa-plug"></i><span>Data Connectors</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="dcr-dce-guide.html" class="sidebar-nav-link"><i class="fas fa-cogs"></i><span>DCR & DCE Guide</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="event-hub.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Event Hub Integration</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-filter"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention & Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="kql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>KQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="kql-intermediate.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>KQL Intermediate</span></a></li>
                    <li class="sidebar-nav-item"><a href="kql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>KQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="workbooks.html" class="sidebar-nav-link"><i class="fas fa-chart-bar"></i><span>Workbooks</span></a></li>
                    <li class="sidebar-nav-item"><a href="notebooks.html" class="sidebar-nav-link"><i class="fas fa-book-open"></i><span>Notebooks</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="analytics-rules.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>Analytics Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="watchlists.html" class="sidebar-nav-link"><i class="fas fa-list-check"></i><span>Watchlists</span></a></li>
                    <li class="sidebar-nav-item"><a href="ueba.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intelligence</span></a></li>
                    <li class="sidebar-nav-item"><a href="hunting.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Hunting</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Security Use Cases -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Security Use Cases</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="security-usecases.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Detection Use Cases</span></a></li>
                    <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise Scenarios</span></a></li>
                </ul>
            </div>
            
            <!-- Automation -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>Automation & Playbooks</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-operations.html" class="sidebar-nav-link"><i class="fas fa-headset"></i><span>SOC Operations</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>RBAC & Permissions</span></a></li>
                    <li class="sidebar-nav-item"><a href="config-reference.html" class="sidebar-nav-link"><i class="fas fa-cog"></i><span>Configuration Reference</span></a></li>
                    <li class="sidebar-nav-item"><a href="devops.html" class="sidebar-nav-link"><i class="fas fa-code-branch"></i><span>Sentinel as Code</span></a></li>
                    <li class="sidebar-nav-item"><a href="advanced-operations.html" class="sidebar-nav-link"><i class="fas fa-cogs"></i><span>Advanced Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Sentinel</a>
                    <span class="separator">/</span>
                    <span class="current">Soc Operations</span>
                </div>

                <h1><i class="fas fa-headset"></i> SOC Operations</h1>
                <p class="lead">Day-to-day SOC operations in Microsoft Sentinel. Covers incident management, investigation workflows, and analyst procedures.</p>

                <!-- Incident Lifecycle -->
                <h2><i class="fas fa-sync-alt"></i> Incident Lifecycle</h2>
                <div class="config-section">
                    <div style="text-align: center; padding: 20px;">
                        <span class="status-badge status-new">New</span>
                        <span style="color: #8b949e; margin: 0 8px;">→</span>
                        <span class="status-badge status-active">Active</span>
                        <span style="color: #8b949e; margin: 0 8px;">→</span>
                        <span class="status-badge" style="background: #58a6ff; color: white;">In Progress</span>
                        <span style="color: #8b949e; margin: 0 8px;">→</span>
                        <span class="status-badge status-closed">Closed</span>
                    </div>
                    
                    <h4>Incident Statuses</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Status</th><th>Meaning</th><th>When to Use</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>New</td><td>Unreviewed</td><td>Initial state from analytics rule</td></tr>
                            <tr><td>Active</td><td>Under investigation</td><td>Analyst has started working on it</td></tr>
                            <tr><td>Closed</td><td>Investigation complete</td><td>Resolved with classification</td></tr>
                        </tbody>
                    </table>

                    <h4>Closure Classifications</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>True Positive - Suspicious activity:</strong> Confirmed security incident</li>
                        <li><strong>Benign Positive:</strong> Real activity, but not malicious</li>
                        <li><strong>False Positive:</strong> Detection rule needs tuning</li>
                        <li><strong>Undetermined:</strong> Insufficient evidence</li>
                    </ul>
                </div>

                <!-- Daily Workflow -->
                <h2><i class="fas fa-tasks"></i> Daily SOC Workflow</h2>
                <div class="config-section">
                    <div class="workflow-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Shift Handoff</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Review open incidents from previous shift, check for escalations</p>
                        </div>
                    </div>
                    <div class="workflow-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Triage New Incidents</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Sort by severity, review high/critical first, assign to analysts</p>
                        </div>
                    </div>
                    <div class="workflow-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Investigate & Respond</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Analyze evidence, run playbooks, take containment actions</p>
                        </div>
                    </div>
                    <div class="workflow-step">
                        <div class="step-num">4</div>
                        <div>
                            <strong>Document & Close</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Add comments, set classification, close incident</p>
                        </div>
                    </div>
                    <div class="workflow-step">
                        <div class="step-num">5</div>
                        <div>
                            <strong>Tune & Improve</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Identify FPs, update rules, improve detection coverage</p>
                        </div>
                    </div>
                </div>

                <!-- Incident Investigation -->
                <h2><i class="fas fa-search"></i> Incident Investigation</h2>
                <div class="config-section">
                    <p><span class="azure-path">Sentinel</span> → <span class="azure-path">Incidents</span> → <span class="azure-path">[Select incident]</span></p>
                    
                    <h4>Incident Page Features</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Overview:</strong> Severity, status, owner, MITRE tactics</li>
                        <li><strong>Timeline:</strong> Alerts and bookmarks in chronological order</li>
                        <li><strong>Entities:</strong> Users, hosts, IPs, files involved</li>
                        <li><strong>Investigation graph:</strong> Visual entity relationships</li>
                        <li><strong>Activity log:</strong> Analyst actions and comments</li>
                    </ul>

                    <h4>Investigation Actions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Action</th><th>How</th><th>Purpose</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>View raw alerts</td><td>Timeline → Alerts</td><td>See original detection data</td></tr>
                            <tr><td>Explore entities</td><td>Entities → Click entity</td><td>See entity timeline and related incidents</td></tr>
                            <tr><td>Run investigation</td><td>Investigation → Investigate</td><td>Visual graph of relationships</td></tr>
                            <tr><td>Run playbook</td><td>Actions → Run playbook</td><td>Automated enrichment/response</td></tr>
                            <tr><td>Add bookmark</td><td>Logs → Add bookmark</td><td>Save important evidence</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- KQL for SOC -->
                <h2><i class="fas fa-terminal"></i> Essential KQL for SOC</h2>
                <div class="config-section">
                    <div class="arch-diagram">// My assigned incidents
SecurityIncident
| where Owner contains "analyst@company.com"
| where Status == "Active"
| project Title, Severity, CreatedTime, Status

// Today's incidents by severity
SecurityIncident
| where CreatedTime > startofday(now())
| summarize Count = count() by Severity
| order by Count desc

// MTTR calculation
SecurityIncident
| where ClosedTime > ago(30d)
| extend MTTR_hours = datetime_diff('hour', ClosedTime, CreatedTime)
| summarize avg(MTTR_hours), percentile(MTTR_hours, 50)

// False positive rate by rule
SecurityIncident
| where ClosedTime > ago(30d)
| summarize 
    Total = count(),
    FP = countif(Classification == "FalsePositive")
    by Title
| extend FP_Rate = round(FP * 100.0 / Total, 1)
| order by Total desc</div>
                </div>

                <!-- Automation Rules for SOC -->
                <h2><i class="fas fa-robot"></i> Automation for SOC Efficiency</h2>
                <div class="config-section">
                    <h4>Auto-Assign by Severity</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Critical/High:</strong> Assign to Tier 2 SOC</li>
                        <li><strong>Medium:</strong> Assign to Tier 1 SOC</li>
                        <li><strong>Low/Informational:</strong> Auto-close or assign to triage queue</li>
                    </ul>

                    <h4>Auto-Close Known FPs</h4>
                    <p style="color: #8b949e;">Create automation rules for known false positives to reduce analyst workload.</p>
                    
                    <h4>Auto-Enrich on Creation</h4>
                    <p style="color: #8b949e;">Trigger playbooks to automatically enrich incidents with threat intelligence, asset information.</p>
                </div>

                <!-- Metrics & Reporting -->
                <h2><i class="fas fa-chart-bar"></i> SOC Metrics</h2>
                <div class="config-section">
                    <table class="styled-table">
                        <thead>
                            <tr><th>Metric</th><th>Target</th><th>Query Approach</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>MTTD (Mean Time to Detect)</td><td>&lt;24 hours</td><td>CreatedTime - first event time</td></tr>
                            <tr><td>MTTR (Mean Time to Respond)</td><td>&lt;4 hours</td><td>ClosedTime - CreatedTime</td></tr>
                            <tr><td>False Positive Rate</td><td>&lt;20%</td><td>FP classification count / total</td></tr>
                            <tr><td>Incidents per Analyst</td><td>Monitor trend</td><td>Count by owner</td></tr>
                            <tr><td>Open Incident Age</td><td>&lt;48 hours</td><td>Now - CreatedTime for active</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Best Practices -->
                <h2><i class="fas fa-check-circle"></i> Best Practices</h2>
                <div class="config-section">
                    <ul style="color: #8b949e;">
                        <li><strong>Document everything:</strong> Add comments with investigation steps and findings</li>
                        <li><strong>Use bookmarks:</strong> Save important log entries as evidence</li>
                        <li><strong>Track FPs:</strong> Use classification to identify rules needing tuning</li>
                        <li><strong>Leverage automation:</strong> Use playbooks for repetitive enrichment tasks</li>
                        <li><strong>Entity focus:</strong> Investigate entities, not just incidents - find related activity</li>
                        <li><strong>Regular tuning:</strong> Weekly review of high-FP rules</li>
                    </ul>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through how you investigate an incident in Sentinel.</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Review incident:</strong> Check severity, affected entities, MITRE tactics</li>
                                <li><strong>Examine alerts:</strong> View timeline, understand what triggered the detection</li>
                                <li><strong>Investigate entities:</strong> Click on users/hosts to see their activity timeline</li>
                                <li><strong>Pivot to logs:</strong> Run KQL queries to find related events</li>
                                <li><strong>Check TI:</strong> Look for IOC matches on IPs, domains, hashes</li>
                                <li><strong>Run playbooks:</strong> Automated enrichment (VirusTotal, geo lookup)</li>
                                <li><strong>Document:</strong> Add comments with findings</li>
                                <li><strong>Respond:</strong> Take action if needed (block, isolate)</li>
                                <li><strong>Close:</strong> Set classification, close incident</li>
                            </ol>
                        </div>
                    </div>
                </div>
                <!-- Extended Interview Questions -->
                <h2><i class="fas fa-question-circle"></i> Additional Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you approach troubleshooting in this area?</button>
                        <div class="qa-answer">
                            <p><strong>Systematic troubleshooting approach:</strong></p>
                            <ol>
                                <li><strong>Identify the symptom:</strong> What exactly is not working as expected?</li>
                                <li><strong>Check connectivity:</strong> Verify network paths and authentication</li>
                                <li><strong>Review logs:</strong> Check internal/audit logs for errors</li>
                                <li><strong>Validate configuration:</strong> Compare against documented standards</li>
                                <li><strong>Test incrementally:</strong> Isolate the problem component</li>
                                <li><strong>Document findings:</strong> Record what worked and what didn't</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What metrics would you track for this area?</button>
                        <div class="qa-answer">
                            <p><strong>Key performance indicators:</strong></p>
                            <ul>
                                <li><strong>Availability:</strong> Uptime percentage, service availability</li>
                                <li><strong>Performance:</strong> Query response time, processing latency</li>
                                <li><strong>Volume:</strong> Events per second, data ingestion rate</li>
                                <li><strong>Quality:</strong> Parse success rate, enrichment coverage</li>
                                <li><strong>Efficiency:</strong> Resource utilization, cost per GB</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you ensure high availability?</button>
                        <div class="qa-answer">
                            <p><strong>High availability strategies:</strong></p>
                            <ul>
                                <li><strong>Redundancy:</strong> Multiple instances of critical components</li>
                                <li><strong>Load balancing:</strong> Distribute traffic across instances</li>
                                <li><strong>Failover:</strong> Automatic switchover on failure</li>
                                <li><strong>Monitoring:</strong> Health checks and alerting</li>
                                <li><strong>DR Planning:</strong> Documented recovery procedures</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- SOC Metrics & KPIs -->
                <h2><i class="fas fa-chart-line"></i> SOC Metrics & KPIs</h2>
                <div class="config-section">
                    <div class="arch-diagram">SOC METRICS FRAMEWORK
═══════════════════════════════════════════════════════════════════

KEY PERFORMANCE INDICATORS:
┌─────────────────────────────────────────────────────────────────┐
│  METRIC              │  FORMULA                  │  TARGET      │
├──────────────────────┼───────────────────────────┼──────────────┤
│  MTTD (Detect)       │  Alert time - Attack time │  &lt; 1 hour   │
│  MTTR (Respond)      │  Close time - Alert time  │  &lt; 4 hours  │
│  MTTA (Acknowledge)  │  Assign time - Alert time │  &lt; 15 min   │
│  MTTT (Triage)       │  Triage time - Alert time │  &lt; 30 min   │
│  False Positive Rate │  FP / Total alerts        │  &lt; 30%      │
│  Escalation Rate     │  Escalated / Total        │  &lt; 20%      │
│  Auto-Close Rate     │  Auto-closed / Total      │  &gt; 40%      │
│  Detection Coverage  │  Rules / MITRE techniques │  &gt; 60%      │
└─────────────────────────────────────────────────────────────────┘

OPERATIONAL METRICS:
├── Incidents per analyst per day
├── Backlog aging (incidents open > 24h)
├── SLA compliance percentage
├── Playbook success rate
└── Data source health percentage</div>

                    <h4>KQL Queries for SOC Metrics</h4>
                    <div class="arch-diagram">// MTTR - Mean Time to Respond (by severity)
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| extend MTTR_hours = datetime_diff('hour', ClosedTime, CreatedTime)
| summarize 
    AvgMTTR = avg(MTTR_hours),
    MedianMTTR = percentile(MTTR_hours, 50),
    P90_MTTR = percentile(MTTR_hours, 90),
    IncidentCount = count()
    by Severity
| order by case(Severity, "High", 1, "Medium", 2, "Low", 3, 4)

// MTTA - Mean Time to Acknowledge
SecurityIncident
| where TimeGenerated > ago(30d)
| where isnotempty(Owner)
| extend MTTA_minutes = datetime_diff('minute', FirstModifiedTime, CreatedTime)
| summarize 
    AvgMTTA = avg(MTTA_minutes),
    P90_MTTA = percentile(MTTA_minutes, 90)
    by bin(TimeGenerated, 1d)
| render timechart

// False Positive Rate by Rule
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| summarize 
    TruePositive = countif(Classification == "TruePositive"),
    FalsePositive = countif(Classification == "FalsePositive"),
    BenignPositive = countif(Classification == "BenignPositive"),
    Total = count()
    by Title
| extend FP_Rate = round(100.0 * FalsePositive / Total, 1)
| where Total > 10
| order by FP_Rate desc

// Incident Backlog Aging
SecurityIncident
| where Status != "Closed"
| extend Age_hours = datetime_diff('hour', now(), CreatedTime)
| extend AgeGroup = case(
    Age_hours < 4, "< 4 hours",
    Age_hours < 24, "4-24 hours",
    Age_hours < 72, "1-3 days",
    Age_hours < 168, "3-7 days",
    "> 7 days"
)
| summarize Count = count() by AgeGroup, Severity
| order by case(AgeGroup, "< 4 hours", 1, "4-24 hours", 2, "1-3 days", 3, "3-7 days", 4, 5)

// Analyst Productivity
SecurityIncident
| where TimeGenerated > ago(7d)
| where Status == "Closed"
| where isnotempty(Owner)
| summarize 
    IncidentsClosed = count(),
    AvgMTTR = avg(datetime_diff('minute', ClosedTime, CreatedTime))
    by Owner
| order by IncidentsClosed desc

// Detection Coverage by MITRE Tactic
SecurityAlert
| where TimeGenerated > ago(30d)
| mv-expand tactic = todynamic(Tactics)
| summarize AlertCount = count() by tostring(tactic)
| order by AlertCount desc</div>

                    <h4>SOC Metrics Dashboard Design</h4>
                    <div class="arch-diagram">SOC METRICS DASHBOARD LAYOUT
═══════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────┐
│  EXECUTIVE SUMMARY ROW                                           │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐        │
│  │Open      │  │ Avg MTTR │  │ FP Rate  │  │ SLA      │        │
│  │Incidents │  │ 2.5 hrs  │  │ 28%      │  │ Compliance│        │
│  │ 47       │  │ ▼ 15%    │  │ ▲ 3%     │  │ 94%      │        │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘        │
├─────────────────────────────────────────────────────────────────┤
│  INCIDENT TRENDS (Time Chart)                                    │
│  [=== New Incidents ==== Closed Incidents ===] (30 days)        │
├─────────────────────────────────────────────────────────────────┤
│  BREAKDOWN ROW                                                   │
│  ┌────────────────────┐  ┌────────────────────┐                 │
│  │ By Severity (Pie)  │  │ By Status (Bar)    │                 │
│  │ High: 12%          │  │ New: 15            │                 │
│  │ Medium: 45%        │  │ Active: 22         │                 │
│  │ Low: 43%           │  │ Closed: 850        │                 │
│  └────────────────────┘  └────────────────────┘                 │
├─────────────────────────────────────────────────────────────────┤
│  TOP RULES TABLE                   │  ANALYST PERFORMANCE       │
│  Rule Name    | Count | FP Rate   │  Analyst | Closed | MTTR   │
│  Brute Force  | 125   | 15%       │  Alice   | 45     | 1.2h   │
│  Susp Login   | 98    | 42%       │  Bob     | 38     | 1.8h   │
│  Malware      | 67    | 8%        │  Carol   | 32     | 2.1h   │
└─────────────────────────────────────────────────────────────────┘</div>
                </div>

                <!-- Incident Response Scenarios -->
                <h2><i class="fas fa-fire-extinguisher"></i> Incident Response Playbooks</h2>
                <div class="config-section">
                    <h4>Scenario 1: Business Email Compromise (BEC)</h4>
                    <div class="arch-diagram">BEC INCIDENT RESPONSE PLAYBOOK
═══════════════════════════════════════════════════════════════════

DETECTION TRIGGERS:
├── Inbox rule created forwarding to external
├── Impossible travel followed by mail activity
├── Consent grant to suspicious OAuth app
├── Password spray followed by mail access
└── Executive mailbox accessed from new device

IMMEDIATE ACTIONS (0-15 minutes):
┌─────────────────────────────────────────────────────────────────┐
│ 1. CONTAIN                                                       │
│    □ Reset user password immediately                            │
│    □ Revoke all refresh tokens (Revoke-AzureADUserAllRefreshToken)│
│    □ Block sign-in if severe                                    │
│    □ Remove suspicious inbox rules                              │
│                                                                  │
│ 2. INVESTIGATE                                                   │
│    □ Review sign-in logs (location, device, IP)                 │
│    □ Check Azure AD audit logs for changes                      │
│    □ Search for mail forwarding rules                           │
│    □ Review OAuth app consents                                  │
│    □ Check for sent emails (phishing to contacts?)              │
│                                                                  │
│ 3. SCOPE                                                         │
│    □ Identify all affected accounts                             │
│    □ Search for similar IOCs across tenant                      │
│    □ Check if financial transactions requested                  │
│    □ Review mailbox delegation changes                          │
└─────────────────────────────────────────────────────────────────┘

INVESTIGATION KQL:
// Find suspicious inbox rules
OfficeActivity
| where Operation == "New-InboxRule"
| where Parameters has_any ("forward", "redirect", "delete")
| project TimeGenerated, UserId, Parameters

// Check for OAuth app consents
AuditLogs
| where OperationName == "Consent to application"
| extend AppName = tostring(TargetResources[0].displayName)
| project TimeGenerated, InitiatedBy, AppName

// Sent emails after compromise time
OfficeActivity
| where Operation == "Send"
| where TimeGenerated > datetime(compromise_time)
| project TimeGenerated, UserId, Recipients

RECOVERY ACTIONS:
├── Re-enable account with new password + MFA
├── Review and remove suspicious app consents
├── Notify affected recipients of potential phishing
├── Report to finance team if wire transfer attempted
└── Document incident for lessons learned</div>

                    <h4>Scenario 2: Ransomware Detection</h4>
                    <div class="arch-diagram">RANSOMWARE INCIDENT RESPONSE PLAYBOOK
═══════════════════════════════════════════════════════════════════

DETECTION TRIGGERS:
├── Mass file encryption (high volume file modifications)
├── Ransomware note file creation (.txt, .html in many folders)
├── Known ransomware process names
├── Shadow copy deletion (vssadmin, wmic shadowcopy)
├── MDE/Defender ransomware alerts
└── Abnormal SMB/file share activity

IMMEDIATE ACTIONS (0-5 minutes):
┌─────────────────────────────────────────────────────────────────┐
│ 1. ISOLATE (DO NOT SHUT DOWN - preserves memory)                │
│    □ Network isolate affected hosts via MDE                     │
│    □ Disable affected user accounts                             │
│    □ Block lateral movement (firewall rules)                    │
│    □ Isolate affected network segment                           │
│                                                                  │
│ 2. ASSESS SCOPE                                                  │
│    □ Identify all affected systems                              │
│    □ Check for encryption spreading                             │
│    □ Identify patient zero (initial infection)                  │
│    □ Determine ransomware variant                               │
│                                                                  │
│ 3. PRESERVE EVIDENCE                                             │
│    □ Capture memory from infected hosts                         │
│    □ Collect ransomware samples                                 │
│    □ Document encryption scope                                  │
│    □ Preserve logs before rotation                              │
└─────────────────────────────────────────────────────────────────┘

INVESTIGATION KQL:
// Find file encryption activity
DeviceFileEvents
| where ActionType in ("FileCreated", "FileModified")
| where Timestamp > ago(1h)
| summarize FileCount = count() by DeviceName, bin(Timestamp, 5m)
| where FileCount > 1000
| order by FileCount desc

// Shadow copy deletion
DeviceProcessEvents
| where ProcessCommandLine has_any ("vssadmin", "wmic shadowcopy", "bcdedit")
| where ProcessCommandLine has_any ("delete", "resize shadowstorage")
| project Timestamp, DeviceName, ProcessCommandLine, InitiatingProcessAccountName

// Ransomware note detection
DeviceFileEvents
| where FileName matches regex @"(?i)(readme|decrypt|ransom|restore).*\.(txt|html|hta)"
| summarize NoteCount = count() by DeviceName, FileName
| where NoteCount > 10

// Lateral movement attempts
DeviceNetworkEvents
| where RemotePort in (445, 135, 139)
| where Timestamp > ago(1h)
| summarize ConnectionCount = dcount(RemoteIP) by DeviceName
| where ConnectionCount > 50

DO NOT:
├── Pay ransom without legal/executive approval
├── Shut down systems (lose memory evidence)
├── Restore from backup before full scope known
├── Communicate over potentially compromised channels
└── Delete ransomware samples (needed for analysis)</div>

                    <h4>Scenario 3: Compromised Service Account</h4>
                    <div class="arch-diagram">SERVICE ACCOUNT COMPROMISE RESPONSE
═══════════════════════════════════════════════════════════════════

DETECTION TRIGGERS:
├── Service account login from unusual location
├── Service account used interactively
├── Service account accessing non-typical resources
├── Service account password retrieved from vault
├── Kerberoasting/AS-REP roasting detection
└── Service account added to privileged group

IMMEDIATE ACTIONS:
┌─────────────────────────────────────────────────────────────────┐
│ 1. ASSESS IMPACT                                                 │
│    □ What systems does this account access?                     │
│    □ What permissions does it have?                             │
│    □ Is it a gMSA or traditional service account?               │
│    □ Are there dependent services?                              │
│                                                                  │
│ 2. CONTAIN (Consider service impact)                            │
│    □ Rotate password/credentials immediately                    │
│    □ If gMSA: Force credential refresh                         │
│    □ Revoke any sessions/tokens                                 │
│    □ Isolate source system if compromised                       │
│                                                                  │
│ 3. INVESTIGATE                                                   │
│    □ How was account compromised?                               │
│    □ What actions were performed?                               │
│    □ Were credentials stored insecurely?                        │
│    □ Check for persistence mechanisms                           │
└─────────────────────────────────────────────────────────────────┘

INVESTIGATION KQL:
// Service account unusual activity
let ServiceAccount = "svc_backup@company.com";
SigninLogs
| where UserPrincipalName == ServiceAccount
| where TimeGenerated > ago(7d)
| summarize 
    DistinctIPs = dcount(IPAddress),
    Locations = make_set(Location),
    Apps = make_set(AppDisplayName)
    by bin(TimeGenerated, 1d)

// Kerberoasting detection
SecurityEvent
| where EventID == 4769
| where ServiceName !endswith "$"
| where TicketEncryptionType in ("0x17", "0x18")  // RC4
| summarize RequestCount = count() by ServiceName, IpAddress
| where RequestCount > 10

// Service account group changes
AuditLogs
| where OperationName has "member"
| extend TargetUPN = tostring(TargetResources[0].userPrincipalName)
| where TargetUPN startswith "svc_"
| project TimeGenerated, OperationName, TargetUPN, InitiatedBy</div>
                </div>

                <!-- Health Monitoring -->
                <h2><i class="fas fa-heartbeat"></i> Sentinel Health Monitoring</h2>
                <div class="config-section">
                    <div class="arch-diagram">SENTINEL HEALTH MONITORING FRAMEWORK
═══════════════════════════════════════════════════════════════════

HEALTH AREAS TO MONITOR:
├── Data Connector Health (is data flowing?)
├── Analytics Rule Health (are rules running?)
├── Automation Health (are playbooks succeeding?)
├── Ingestion Latency (is data delayed?)
└── Agent Health (are agents reporting?)

KQL - DATA CONNECTOR HEALTH:
SentinelHealth
| where TimeGenerated > ago(24h)
| where OperationName == "Data fetch status change"
| where Status != "Success"
| summarize FailureCount = count() by SentinelResourceName, Status
| where FailureCount > 0

KQL - DATA INGESTION GAPS:
let ExpectedTables = dynamic(["SigninLogs", "SecurityEvent", "CommonSecurityLog"]);
let CheckPeriod = 1h;
ExpectedTables
| mv-expand TableName = ExpectedTables
| extend Query = strcat(TableName, " | where TimeGenerated > ago(", CheckPeriod, ") | count")
// Execute for each table and check for zero counts

KQL - ANALYTICS RULE HEALTH:
SentinelHealth
| where TimeGenerated > ago(24h)
| where OperationName == "Scheduled analytics rule run"
| where Status != "Success"
| project TimeGenerated, SentinelResourceName, Status, Description

KQL - INGESTION LATENCY:
SigninLogs
| where TimeGenerated > ago(1h)
| extend IngestionDelay = ingestion_time() - TimeGenerated
| summarize 
    AvgDelay = avg(IngestionDelay),
    MaxDelay = max(IngestionDelay),
    P95Delay = percentile(IngestionDelay, 95)
| extend AvgDelayMinutes = AvgDelay / 1m

ALERTING THRESHOLDS:
┌────────────────────────┬─────────────┬─────────────┐
│ Metric                  │ Warning     │ Critical    │
├────────────────────────┼─────────────┼─────────────┤
│ Connector failure       │ 1 failure   │ 3 failures  │
│ Rule execution failure  │ 1 failure   │ 3 failures  │
│ Ingestion latency       │ > 10 min    │ > 30 min    │
│ Data gap                │ > 15 min    │ > 1 hour    │
│ Playbook failure rate   │ > 10%       │ > 25%       │
└────────────────────────┴─────────────┴─────────────┘</div>
                </div>

                <!-- Best Practices -->
                <h2><i class="fas fa-star"></i> Best Practices</h2>
                <div class="config-section">
                    <!-- Troubleshooting Guide -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting Guide</h2>
                <div class="config-section">
                    <h4>Common Issues and Solutions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Issue</th><th>Possible Cause</th><th>Solution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Data not appearing</td>
                                <td>Collection or parsing issue</td>
                                <td>Check collector status, verify parser configuration</td>
                            </tr>
                            <tr>
                                <td>Slow performance</td>
                                <td>Resource constraints or inefficient queries</td>
                                <td>Review resource utilization, optimize queries</td>
                            </tr>
                            <tr>
                                <td>Authentication failures</td>
                                <td>Credential or permission issues</td>
                                <td>Verify credentials, check RBAC configuration</td>
                            </tr>
                            <tr>
                                <td>Missing fields</td>
                                <td>Parser not extracting fields</td>
                                <td>Review parsing rules, update field extraction</td>
                            </tr>
                            <tr>
                                <td>Duplicate events</td>
                                <td>Multiple collection paths</td>
                                <td>Audit data sources, implement deduplication</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Diagnostic Steps</h4>
                    <ol style="color: #8b949e;">
                        <li><strong>Check Status:</strong> Verify component health in console</li>
                        <li><strong>Review Logs:</strong> Examine internal logs for errors</li>
                        <li><strong>Test Connectivity:</strong> Verify network paths and authentication</li>
                        <li><strong>Validate Config:</strong> Compare configuration against documentation</li>
                        <li><strong>Isolate Issue:</strong> Narrow down to specific component</li>
                        <li><strong>Escalate:</strong> Contact support if needed with diagnostics</li>
                    </ol>
                </div>

                <!-- Use Cases -->
                <h2><i class="fas fa-briefcase"></i> Real-World Use Cases</h2>
                <div class="config-section">
                    <h4>Use Case 1: Enterprise SOC</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Large enterprise with 20,000 endpoints, multiple cloud environments</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Centralized collection from all security data sources</li>
                            <li>Custom detection rules aligned to threat model</li>
                            <li>Automated response playbooks for common scenarios</li>
                            <li>Integration with ticketing and CMDB systems</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> 60% reduction in MTTR, improved threat visibility</p>
                    </div>

                    <h4>Use Case 2: MSSP Operations</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Managed security provider serving 50 customers</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Multi-tenant architecture with customer isolation</li>
                            <li>Standardized detection content across customers</li>
                            <li>Centralized analyst workflow and reporting</li>
                            <li>SLA-driven prioritization and escalation</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> Efficient operations at scale, consistent service delivery</p>
                    </div>

                    <h4>Use Case 3: Compliance-Focused</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Healthcare organization with HIPAA requirements</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Comprehensive audit logging for PHI access</li>
                            <li>Long-term retention for compliance evidence</li>
                            <li>Pre-built compliance dashboards and reports</li>
                            <li>Automated compliance violation detection</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> Audit-ready documentation, reduced compliance risk</p>
                    </div>
                </div>

                <!-- Quick Reference -->
                <h2><i class="fas fa-bookmark"></i> Quick Reference</h2>
                <div class="config-section">
                    <h4>Common Commands/Queries</h4>
                    <div class="arch-diagram"># Basic health check query
# Adjust syntax for your platform (XQL/SPL/KQL)

# Check data ingestion rate
| stats count by _time span=1h

# Find recent errors
| filter severity = "error" 
| sort _time desc 
| limit 100

# Top sources by volume
| stats sum(bytes) as total_bytes by source
| sort total_bytes desc
| limit 10

# Detection rule effectiveness
| filter alert_type = "detection"
| stats count by rule_name, disposition
| sort count desc</div>

                    <h4>Key Configuration Files/Paths</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Purpose</th><th>Location/Path</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Main Configuration</td><td>Settings → Configuration</td></tr>
                            <tr><td>Data Sources</td><td>Settings → Data Sources</td></tr>
                            <tr><td>Detection Rules</td><td>Detection → Rules</td></tr>
                            <tr><td>User Management</td><td>Settings → Access Management</td></tr>
                            <tr><td>Audit Logs</td><td>Settings → Audit Trail</td></tr>
                        </tbody>
                    </table>

                    <h4>Important Thresholds</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Metric</th><th>Warning</th><th>Critical</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Query Response Time</td><td>> 30 seconds</td><td>> 120 seconds</td></tr>
                            <tr><td>Ingestion Latency</td><td>> 5 minutes</td><td>> 15 minutes</td></tr>
                            <tr><td>Storage Utilization</td><td>> 70%</td><td>> 85%</td></tr>
                            <tr><td>Error Rate</td><td>> 1%</td><td>> 5%</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- SOC Metrics & KPIs -->
                <h2><i class="fas fa-chart-line"></i> SOC Metrics & KPIs</h2>
                <div class="config-section">
                    <div class="arch-diagram">SOC PERFORMANCE METRICS FRAMEWORK
═══════════════════════════════════════════════════════════════════

KEY METRICS CATEGORIES:
├── EFFICIENCY METRICS (How fast?)
│   ├── MTTD - Mean Time to Detect
│   ├── MTTR - Mean Time to Respond
│   ├── MTTC - Mean Time to Contain
│   └── MTTK - Mean Time to Know (full scope)
│
├── EFFECTIVENESS METRICS (How well?)
│   ├── True Positive Rate
│   ├── False Positive Rate
│   ├── Detection Coverage (MITRE)
│   └── Incident Recurrence Rate
│
├── VOLUME METRICS (How much?)
│   ├── Alerts per Day/Week
│   ├── Incidents per Analyst
│   ├── Events Processed
│   └── Data Ingested (GB)
│
└── QUALITY METRICS (How good?)
    ├── SLA Compliance Rate
    ├── Escalation Rate
    ├── Customer Satisfaction
    └── Analyst Utilization</div>

                    <h4>KQL Queries for SOC Metrics</h4>
                    <div class="arch-diagram">// MEAN TIME TO RESPOND (MTTR)
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| extend ResponseTime = datetime_diff('minute', ClosedTime, CreatedTime)
| summarize 
    MTTR_Minutes = avg(ResponseTime),
    Median_Minutes = percentile(ResponseTime, 50),
    P95_Minutes = percentile(ResponseTime, 95)
| extend MTTR_Hours = MTTR_Minutes / 60

// MTTR BY SEVERITY
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| extend ResponseTime = datetime_diff('minute', ClosedTime, CreatedTime)
| summarize MTTR = avg(ResponseTime) / 60 by Severity
| order by case(
    Severity == "High", 1,
    Severity == "Medium", 2,
    Severity == "Low", 3,
    4)

// FALSE POSITIVE RATE BY RULE
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| summarize 
    Total = count(),
    FalsePositives = countif(Classification == "FalsePositive"),
    TruePositives = countif(Classification == "TruePositive")
    by Title
| extend FP_Rate = round(FalsePositives * 100.0 / Total, 1)
| where Total > 10
| order by FP_Rate desc

// ANALYST PERFORMANCE
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| extend ResponseTime = datetime_diff('minute', ClosedTime, CreatedTime)
| summarize 
    Closed = count(),
    AvgMTTR = avg(ResponseTime) / 60,
    TruePositives = countif(Classification == "TruePositive")
    by Owner
| where isnotempty(Owner)
| order by Closed desc

// INCIDENT VOLUME TREND
SecurityIncident
| where TimeGenerated > ago(30d)
| summarize 
    NewIncidents = countif(Status == "New"),
    ActiveIncidents = countif(Status == "Active"),
    ClosedIncidents = countif(Status == "Closed")
    by bin(TimeGenerated, 1d)
| render timechart

// SLA COMPLIANCE (Target: High=1h, Medium=4h, Low=24h)
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| extend ResponseTime = datetime_diff('minute', ClosedTime, CreatedTime)
| extend SLA_Target = case(
    Severity == "High", 60,
    Severity == "Medium", 240,
    Severity == "Low", 1440,
    1440)
| extend SLA_Met = ResponseTime <= SLA_Target
| summarize 
    Total = count(),
    Met_SLA = countif(SLA_Met),
    SLA_Compliance = round(countif(SLA_Met) * 100.0 / count(), 1)
    by Severity</div>

                    <h4>Executive Dashboard Metrics</h4>
                    <div class="arch-diagram">EXECUTIVE SOC DASHBOARD
═══════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────┐
│  MONTH-OVER-MONTH COMPARISON                                     │
├───────────────────────┬───────────────┬───────────────┬─────────┤
│  Metric               │  This Month   │  Last Month   │  Trend  │
├───────────────────────┼───────────────┼───────────────┼─────────┤
│  Total Incidents      │     847       │     923       │   ▼ 8%  │
│  MTTR (hours)         │     2.3       │     3.1       │  ▼ 26%  │
│  SLA Compliance       │    94.2%      │    89.7%      │   ▲ 5%  │
│  FP Rate              │    22.1%      │    28.4%      │  ▼ 22%  │
│  Detection Coverage   │    72%        │    68%        │   ▲ 6%  │
└───────────────────────┴───────────────┴───────────────┴─────────┘

// KQL FOR MONTH-OVER-MONTH
let ThisMonth = SecurityIncident
    | where TimeGenerated > startofmonth(now())
    | summarize ThisMonth_Count = count();
let LastMonth = SecurityIncident
    | where TimeGenerated between (startofmonth(datetime_add('month', -1, now())) .. startofmonth(now()))
    | summarize LastMonth_Count = count();
ThisMonth | join LastMonth on 1==1
| extend Change_Pct = round((ThisMonth_Count - LastMonth_Count) * 100.0 / LastMonth_Count, 1)</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through how you would handle a BEC (Business Email Compromise) incident.</button>
                        <div class="qa-answer">
                            <p><strong>BEC incident response workflow:</strong></p>
                            <ol>
                                <li><strong>Immediate containment (0-15 min):</strong>
                                    <ul>
                                        <li>Reset user password immediately</li>
                                        <li>Revoke all refresh tokens</li>
                                        <li>Remove suspicious inbox rules (forwarding to external)</li>
                                    </ul>
                                </li>
                                <li><strong>Investigation:</strong>
                                    <ul>
                                        <li>Review sign-in logs for suspicious locations/IPs</li>
                                        <li>Check Azure AD audit logs for OAuth app consents</li>
                                        <li>Search for mail forwarding rules created</li>
                                        <li>Review sent emails for phishing to contacts</li>
                                    </ul>
                                </li>
                                <li><strong>Scope assessment:</strong>
                                    <ul>
                                        <li>Search for similar IOCs across tenant</li>
                                        <li>Check if wire transfer requests were sent</li>
                                        <li>Identify all affected accounts</li>
                                    </ul>
                                </li>
                                <li><strong>Recovery:</strong> Re-enable with MFA, notify affected parties, document lessons learned</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What SOC metrics do you track and why?</button>
                        <div class="qa-answer">
                            <p><strong>Key SOC metrics I track:</strong></p>
                            <table class="styled-table">
                                <thead>
                                    <tr><th>Metric</th><th>Target</th><th>Why It Matters</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td>MTTR</td><td>&lt;2 hours</td><td>Measures response efficiency</td></tr>
                                    <tr><td>False Positive Rate</td><td>&lt;20%</td><td>Detection quality, analyst efficiency</td></tr>
                                    <tr><td>SLA Compliance</td><td>&gt;95%</td><td>Service delivery commitment</td></tr>
                                    <tr><td>Detection Coverage</td><td>&gt;80% MITRE</td><td>Security posture visibility</td></tr>
                                    <tr><td>Incidents/Analyst</td><td>Balanced load</td><td>Team workload distribution</td></tr>
                                </tbody>
                            </table>
                            <p style="margin-top: 12px;"><strong>Reporting:</strong> Weekly operational metrics, monthly executive dashboard, quarterly trend analysis.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you reduce false positive rates in a SOC?</button>
                        <div class="qa-answer">
                            <p><strong>False positive reduction strategies:</strong></p>
                            <ol>
                                <li><strong>Rule tuning:</strong> Analyze FP patterns, add exclusions for known-good behavior</li>
                                <li><strong>Watchlists:</strong> Create allowlists for service accounts, authorized scanners, VPN IPs</li>
                                <li><strong>Threshold adjustment:</strong> Tune thresholds based on baseline data</li>
                                <li><strong>Context enrichment:</strong> Add asset criticality, user risk score to prioritize</li>
                                <li><strong>ML models:</strong> Use UEBA to learn normal behavior, reduce static rule noise</li>
                                <li><strong>Feedback loop:</strong> Track FP by rule, prioritize tuning for high-volume FP generators</li>
                            </ol>
                            <p style="margin-top: 12px;"><strong>Target:</strong> Get FP rate below 20% - above this, analysts spend more time on noise than threats.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you prioritize incidents when the queue is overwhelmed?</button>
                        <div class="qa-answer">
                            <p><strong>Incident prioritization framework:</strong></p>
                            <ol>
                                <li><strong>Severity + Asset criticality:</strong> High severity on critical asset = P1</li>
                                <li><strong>VIP involvement:</strong> Executives/high-value users get priority</li>
                                <li><strong>Active vs historical:</strong> Active threats before historical findings</li>
                                <li><strong>Blast radius:</strong> Incidents affecting many users/systems first</li>
                                <li><strong>SLA compliance:</strong> Incidents approaching SLA breach</li>
                            </ol>
                            <p style="margin-top: 12px;"><strong>When truly overwhelmed:</strong></p>
                            <ul>
                                <li>Auto-close low-severity informational alerts</li>
                                <li>Batch similar incidents (same rule, same pattern)</li>
                                <li>Focus on containment, defer investigation</li>
                                <li>Escalate to leadership for resource allocation</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Describe your shift handoff process.</button>
                        <div class="qa-answer">
                            <p><strong>Effective shift handoff includes:</strong></p>
                            <ol>
                                <li><strong>Open incidents review:</strong> Status, next steps, blockers for each active incident</li>
                                <li><strong>Escalations in progress:</strong> Any pending escalations or leadership notifications</li>
                                <li><strong>System health:</strong> Any connector failures, ingestion gaps, or platform issues</li>
                                <li><strong>Recent changes:</strong> New rules deployed, tuning changes made</li>
                                <li><strong>Intelligence updates:</strong> New threat campaigns, IOCs to watch for</li>
                                <li><strong>Documentation:</strong> Update shared runbook/wiki with handoff notes</li>
                            </ol>
                            <p style="margin-top: 12px;"><strong>Best practice:</strong> 15-minute overlap between shifts, use structured handoff document, verbal walkthrough for critical items.</p>
                        </div>
                    </div>
                </div>

                <!-- Related Topics -->
                <h2><i class="fas fa-link"></i> Related Topics</h2>
                <div class="config-section">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-book" style="color: #58a6ff;"></i> Documentation</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>Official vendor documentation</li>
                                <li>API reference guides</li>
                                <li>Release notes</li>
                            </ul>
                        </div>
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-users" style="color: #58a6ff;"></i> Community</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>User forums</li>
                                <li>Community Slack/Discord</li>
                                <li>Blog posts and articles</li>
                            </ul>
                        </div>
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-graduation-cap" style="color: #58a6ff;"></i> Training</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>Vendor certifications</li>
                                <li>Online courses</li>
                                <li>Hands-on labs</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Real-World Use Cases -->
                </div>
</main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>