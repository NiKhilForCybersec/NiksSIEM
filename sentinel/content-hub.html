<!DOCTYPE html>
<html lang="en" data-theme="dark" data-platform="sentinel">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentinel Content Hub & ASIM Parsers - 100% Complete Reference | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .schema-card { background: var(--card-bg); border-radius: 8px; padding: 1.5rem; margin: 1rem 0; border-left: 4px solid #0078d4; }
        .schema-card h4 { color: #0078d4; margin-top: 0; }
        .parser-table { width: 100%; font-size: 0.85rem; }
        .parser-table th { background: rgba(0,120,212,0.2); position: sticky; top: 0; }
        .content-type-badge { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.75rem; font-weight: 600; margin: 0.25rem; }
        .badge-connector { background: #1a5fb4; color: white; }
        .badge-parser { background: #26a269; color: white; }
        .badge-rule { background: #e66100; color: white; }
        .badge-workbook { background: #813d9c; color: white; }
        .badge-playbook { background: #c01c28; color: white; }
        .badge-hunting { background: #a51d2d; color: white; }
        .solution-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem; }
        .solution-card { background: var(--card-bg); border-radius: 8px; padding: 1rem; border: 1px solid var(--border-color); }
        .solution-card:hover { border-color: #0078d4; }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>

            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel active"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="../splunk/index.html" class="platform-tab splunk"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
<nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-connectors.html" class="nav-link"><i class="fas fa-plug"></i> Data Connectors</a>
                    <a href="dcr-dce-guide.html" class="nav-link"><i class="fas fa-cogs"></i> DCR & DCE Deep Dive</a>
                    <a href="event-hub.html" class="nav-link"><i class="fas fa-broadcast-tower"></i> Event Hub Integration</a>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion & Cost</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">KQL Query Language</div>
                    <a href="kql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> KQL Fundamentals</a>
                    <a href="kql-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> KQL Intermediate</a>
                    <a href="kql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced KQL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="analytics-rules.html" class="nav-link"><i class="fas fa-bell"></i> Analytics Rules</a>
                    <a href="automation.html" class="nav-link"><i class="fas fa-robot"></i> Automation</a>
                    <a href="workbooks.html" class="nav-link"><i class="fas fa-chart-bar"></i> Workbooks</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Content & Intelligence</div>
                    <a href="content-hub.html" class="nav-link active"><i class="fas fa-cube"></i> Content Hub & ASIM</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intelligence</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users-cog"></i> SOC Operations</a>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Sentinel</a>
                    <span class="separator">/</span>
                    <span class="current">Content Hub & ASIM Parsers</span>
                </div>
                <div class="top-actions">
                    <button class="top-btn" onclick="window.print()">
                        <i class="fas fa-print"></i> Print
                    </button>
                </div>
            </header>
            
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-store"></i> Content Hub & ASIM Parsers</h1>
                    <p class="lead">100% Complete Reference - Solutions, Parsers, Analytics Rules, Workbooks, Playbooks, and Hunting Queries</p>
                </div>

                <!-- Table of Contents -->
                <section class="content-section">
                    <div class="concept-box sentinel">
                        <h3><i class="fas fa-list"></i> What's in This Guide</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;">
                            <div><a href="#content-hub">Content Hub Overview</a></div>
                            <div><a href="#asim">ASIM Parsers (All Schemas)</a></div>
                            <div><a href="#solutions">Solutions Catalog</a></div>
                            <div><a href="#analytics">Analytics Rules</a></div>
                            <div><a href="#workbooks">Workbooks</a></div>
                            <div><a href="#playbooks">Playbooks</a></div>
                            <div><a href="#hunting">Hunting Queries</a></div>
                            <div><a href="#watchlists">Watchlists</a></div>
                        </div>
                    </div>
                </section>

                <!-- Content Hub Overview -->
                <section class="content-section" id="content-hub">
                    <h2><i class="fas fa-store"></i> Content Hub Overview</h2>
                    
                    <div class="info-box">
                        <h4>What is Content Hub?</h4>
                        <p>Microsoft Sentinel Content Hub is the centralized marketplace for discovering and deploying out-of-the-box (OOTB) content including:</p>
                        <ul>
                            <li><strong>Solutions</strong> - Packaged integrations with data connectors, parsers, rules, workbooks, and playbooks</li>
                            <li><strong>Standalone Content</strong> - Individual items like analytics rules or hunting queries</li>
                        </ul>
                    </div>

                    <h3>Content Types in Solutions</h3>
                    <div style="margin: 1rem 0;">
                        <span class="content-type-badge badge-connector"><i class="fas fa-plug"></i> Data Connectors</span>
                        <span class="content-type-badge badge-parser"><i class="fas fa-code"></i> Parsers</span>
                        <span class="content-type-badge badge-rule"><i class="fas fa-bell"></i> Analytics Rules</span>
                        <span class="content-type-badge badge-workbook"><i class="fas fa-chart-bar"></i> Workbooks</span>
                        <span class="content-type-badge badge-playbook"><i class="fas fa-robot"></i> Playbooks</span>
                        <span class="content-type-badge badge-hunting"><i class="fas fa-crosshairs"></i> Hunting Queries</span>
                    </div>

                    <h3>Content Hub Statistics (2024)</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Content Type</th><th>Count</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Solutions</strong></td><td>300+</td><td>Packaged integrations from Microsoft and partners</td></tr>
                            <tr><td><strong>Data Connectors</strong></td><td>200+</td><td>Native integrations for data ingestion</td></tr>
                            <tr><td><strong>Analytics Rules</strong></td><td>500+</td><td>Detection rules across all solutions</td></tr>
                            <tr><td><strong>Workbooks</strong></td><td>100+</td><td>Interactive dashboards and reports</td></tr>
                            <tr><td><strong>Playbooks</strong></td><td>200+</td><td>Logic Apps automation templates</td></tr>
                            <tr><td><strong>Hunting Queries</strong></td><td>300+</td><td>Threat hunting queries</td></tr>
                            <tr><td><strong>ASIM Parsers</strong></td><td>100+</td><td>Normalization parsers by schema</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- ASIM Parsers -->
                <section class="content-section" id="asim">
                    <h2><i class="fas fa-code"></i> ASIM (Advanced Security Information Model) Parsers</h2>
                    
                    <div class="concept-box sentinel">
                        <h3>What is ASIM?</h3>
                        <p>ASIM provides a normalization layer that transforms data from different sources into a common schema. This allows:</p>
                        <ul>
                            <li><strong>Source-agnostic queries</strong> - Write one query that works across multiple data sources</li>
                            <li><strong>Content reuse</strong> - Analytics rules and hunting queries work with any normalized data</li>
                            <li><strong>Simplified onboarding</strong> - Add new data sources without rewriting detection content</li>
                        </ul>
                    </div>

                    <h3>ASIM Architecture</h3>
                    <div class="architecture-diagram">
<pre style="font-family: 'Fira Code', monospace; font-size: 12px; line-height: 1.4;">
┌─────────────────────────────────────────────────────────────────────────────┐
│                           ASIM PARSER ARCHITECTURE                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ANALYTICS RULES / HUNTING QUERIES / WORKBOOKS                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  _Im_NetworkSession | where SrcIpAddr == "10.0.0.1"                 │   │
│  │  _Im_Dns | where DnsQuery contains "malware"                        │   │
│  │  _Im_Authentication | where EventResult == "Failure"                │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    ↓                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                      UNIFYING PARSERS                               │   │
│  │  _Im_NetworkSession  │  _Im_Dns  │  _Im_Authentication  │ ...      │   │
│  │  (union of all source-specific parsers)                            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    ↓                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    SOURCE-SPECIFIC PARSERS                          │   │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌────────────┐ │   │
│  │  │_Im_Dns_      │ │_Im_Dns_      │ │_Im_Dns_      │ │ Custom     │ │   │
│  │  │AzureFirewall │ │InfobloxNIOS  │ │CiscoUmbrella │ │ Parsers    │ │   │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    ↓                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        RAW DATA TABLES                              │   │
│  │  CommonSecurityLog │ Syslog │ AzureDiagnostics │ Custom_CL         │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
</pre>
                    </div>

                    <h3>Parser Naming Conventions</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Parser Type</th><th>Built-in Format</th><th>Workspace-Deployed</th><th>Example</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Unifying (with filtering)</strong></td>
                                <td><code>_Im_&lt;Schema&gt;</code></td>
                                <td><code>im&lt;Schema&gt;</code></td>
                                <td><code>_Im_Dns</code>, <code>imDns</code></td>
                            </tr>
                            <tr>
                                <td><strong>Unifying (no filtering)</strong></td>
                                <td><code>_ASim_&lt;Schema&gt;</code></td>
                                <td><code>ASim&lt;Schema&gt;</code></td>
                                <td><code>_ASim_Dns</code>, <code>ASimDns</code></td>
                            </tr>
                            <tr>
                                <td><strong>Source-specific</strong></td>
                                <td><code>_Im_&lt;Schema&gt;_&lt;Source&gt;</code></td>
                                <td><code>vim&lt;Schema&gt;&lt;Source&gt;</code></td>
                                <td><code>_Im_Dns_InfobloxNIOS</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>All ASIM Schemas - Complete Reference</h3>
                    
                    <div class="schema-card">
                        <h4><i class="fas fa-network-wired"></i> Network Session Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_NetworkSession</code></p>
                        <p><strong>Use Case:</strong> Firewall logs, NetFlow, proxy logs, VPN connections</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>SrcIpAddr, DstIpAddr, SrcPortNumber, DstPortNumber, NetworkProtocol, NetworkDirection, DvcAction, SrcBytes, DstBytes, NetworkDuration</code>
                        <p style="margin-top: 0.5rem;"><strong>Built-in Source Parsers:</strong></p>
                        <ul style="font-size: 0.85rem;">
                            <li>Azure Firewall, Azure NSG, AWS VPC Flow, Palo Alto PAN-OS</li>
                            <li>Cisco ASA, Cisco Meraki, Fortinet FortiGate, Check Point</li>
                            <li>Zscaler ZIA, Microsoft 365 Defender, Windows Firewall</li>
                        </ul>
                    </div>

                    <div class="schema-card">
                        <h4><i class="fas fa-globe"></i> DNS Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_Dns</code></p>
                        <p><strong>Use Case:</strong> DNS query/response logs for threat detection</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>DnsQuery, DnsQueryType, DnsResponseCode, DnsResponseName, SrcIpAddr, DstIpAddr, DnsFlags</code>
                        <p style="margin-top: 0.5rem;"><strong>Built-in Source Parsers:</strong></p>
                        <ul style="font-size: 0.85rem;">
                            <li>Azure Firewall DNS Proxy, Windows DNS Server, Microsoft Defender for Endpoint</li>
                            <li>Cisco Umbrella, Infoblox NIOS, Zscaler ZIA, GCP Cloud DNS</li>
                            <li>Azure DNS, Corelight Zeek, Vectra AI</li>
                        </ul>
                    </div>

                    <div class="schema-card">
                        <h4><i class="fas fa-user-shield"></i> Authentication Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_Authentication</code></p>
                        <p><strong>Use Case:</strong> Login success/failure events across identity systems</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>TargetUsername, TargetUserId, SrcIpAddr, LogonType, EventResult, EventResultDetails, TargetAppName</code>
                        <p style="margin-top: 0.5rem;"><strong>Built-in Source Parsers:</strong></p>
                        <ul style="font-size: 0.85rem;">
                            <li>Microsoft Entra ID (Azure AD), Windows Security Events (4624, 4625)</li>
                            <li>Okta, AWS CloudTrail, Linux auth logs</li>
                            <li>Cisco ISE, Microsoft 365 Defender, Sysmon</li>
                        </ul>
                    </div>

                    <div class="schema-card">
                        <h4><i class="fas fa-cog"></i> Process Event Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_ProcessEvent</code></p>
                        <p><strong>Use Case:</strong> Process creation/termination for endpoint detection</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>TargetProcessName, TargetProcessCommandLine, TargetProcessId, ActingProcessName, TargetUsername, TargetProcessFileHash</code>
                        <p style="margin-top: 0.5rem;"><strong>Built-in Source Parsers:</strong></p>
                        <ul style="font-size: 0.85rem;">
                            <li>Windows Security Events (4688), Sysmon (Event 1, 5)</li>
                            <li>Microsoft Defender for Endpoint, CrowdStrike Falcon</li>
                            <li>Linux Auditd, VMware Carbon Black</li>
                        </ul>
                    </div>

                    <div class="schema-card">
                        <h4><i class="fas fa-file"></i> File Event Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_FileEvent</code></p>
                        <p><strong>Use Case:</strong> File creation, modification, deletion events</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>TargetFileName, TargetFilePath, TargetFileHash, ActingProcessName, SrcIpAddr, EventType</code>
                        <p style="margin-top: 0.5rem;"><strong>Built-in Source Parsers:</strong></p>
                        <ul style="font-size: 0.85rem;">
                            <li>Sysmon (Event 11, 23, 26), Microsoft Defender for Endpoint</li>
                            <li>Microsoft 365 SharePoint/OneDrive, Azure Storage</li>
                            <li>Windows Security Events</li>
                        </ul>
                    </div>

                    <div class="schema-card">
                        <h4><i class="fas fa-key"></i> Registry Event Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_RegistryEvent</code></p>
                        <p><strong>Use Case:</strong> Windows registry modifications for persistence detection</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>RegistryKey, RegistryValue, RegistryValueData, RegistryPreviousValue, EventType, ActingProcessName</code>
                        <p style="margin-top: 0.5rem;"><strong>Built-in Source Parsers:</strong></p>
                        <ul style="font-size: 0.85rem;">
                            <li>Sysmon (Event 12, 13, 14), Windows Security Events (4657, 4663)</li>
                            <li>Microsoft Defender for Endpoint</li>
                        </ul>
                    </div>

                    <div class="schema-card">
                        <h4><i class="fas fa-globe-americas"></i> Web Session Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_WebSession</code></p>
                        <p><strong>Use Case:</strong> HTTP/HTTPS traffic, web proxy logs</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>Url, HttpRequestMethod, HttpStatusCode, SrcIpAddr, DstIpAddr, UserAgent, HttpContentType</code>
                        <p style="margin-top: 0.5rem;"><strong>Built-in Source Parsers:</strong></p>
                        <ul style="font-size: 0.85rem;">
                            <li>Zscaler ZIA, Squid Proxy, Apache/IIS logs</li>
                            <li>Palo Alto PAN-OS URL filtering, Cisco Web Security</li>
                        </ul>
                    </div>

                    <div class="schema-card">
                        <h4><i class="fas fa-exclamation-triangle"></i> Audit Event Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_AuditEvent</code></p>
                        <p><strong>Use Case:</strong> Configuration changes, administrative actions</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>Operation, Object, ObjectType, ActorUsername, ActorUserId, EventResult</code>
                    </div>

                    <div class="schema-card">
                        <h4><i class="fas fa-user-cog"></i> User Management Schema</h4>
                        <p><strong>Unifying Parser:</strong> <code>_Im_UserManagement</code></p>
                        <p><strong>Use Case:</strong> User account lifecycle events (create, modify, delete)</p>
                        <p><strong>Key Fields:</strong></p>
                        <code>TargetUsername, TargetUserId, GroupName, EventType, ActorUsername</code>
                    </div>

                    <h3>Using ASIM Parsers - Examples</h3>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <span class="code-title">Query DNS across all sources</span>
                            <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                        </div>
                        <pre><code>// Use _Im_Dns to query all DNS data regardless of source
_Im_Dns(starttime=ago(24h), responsecodename='NXDOMAIN')
| summarize QueryCount = count() by DnsQuery, SrcIpAddr
| where QueryCount > 100
| sort by QueryCount desc</code></pre>
                    </div>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <span class="code-title">Failed authentication across all identity sources</span>
                            <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                        </div>
                        <pre><code>// Detect brute force across Azure AD, Windows, Okta, etc.
_Im_Authentication(starttime=ago(1h))
| where EventResult == "Failure"
| summarize 
    FailureCount = count(),
    DistinctUsers = dcount(TargetUsername),
    Sources = make_set(EventProduct)
    by SrcIpAddr, bin(TimeGenerated, 5m)
| where FailureCount > 20</code></pre>
                    </div>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <span class="code-title">Network connections to known bad IPs</span>
                            <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                        </div>
                        <pre><code>// Query network sessions normalized from all firewalls
let ThreatIPs = dynamic(["203.0.113.1", "198.51.100.5"]);
_Im_NetworkSession(starttime=ago(24h))
| where DstIpAddr in (ThreatIPs) or SrcIpAddr in (ThreatIPs)
| project TimeGenerated, SrcIpAddr, DstIpAddr, DstPortNumber, 
          NetworkProtocol, DvcAction, EventProduct</code></pre>
                    </div>
                </section>

                <!-- Solutions Catalog -->
                <section class="content-section" id="solutions">
                    <h2><i class="fas fa-cubes"></i> Solutions Catalog</h2>
                    
                    <h3>Solution Categories</h3>
                    
                    <div class="tip-box">
                        <h4>Three Types of Solutions</h4>
                        <ul>
                            <li><strong>Product-centric:</strong> Integrations for specific security products (CrowdStrike, Okta, AWS, etc.)</li>
                            <li><strong>Domain-centric:</strong> ASIM-based solutions that work across products (Network Essentials, DNS Essentials)</li>
                            <li><strong>Threat-centric:</strong> Content focused on specific threats (Log4J, Nobelium, etc.)</li>
                        </ul>
                    </div>

                    <h3>Microsoft Solutions (Built-in)</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Solution</th><th>Content Included</th><th>Data Source</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Microsoft Entra ID</strong></td>
                                <td>Connector, 50+ rules, 5 workbooks, 10+ playbooks</td>
                                <td>SigninLogs, AuditLogs, AADRiskyUsers</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Defender XDR</strong></td>
                                <td>Connector, 100+ rules, incident sync</td>
                                <td>Device*, Identity*, Email*, Cloud* tables</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft 365</strong></td>
                                <td>Connector, 30+ rules, 3 workbooks</td>
                                <td>OfficeActivity, SharePoint, Exchange</td>
                            </tr>
                            <tr>
                                <td><strong>Azure Activity</strong></td>
                                <td>Connector, 20+ rules, workbook</td>
                                <td>AzureActivity</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Defender for Cloud</strong></td>
                                <td>Connector, 15+ rules, workbook</td>
                                <td>SecurityAlert, SecurityRecommendation</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Top Third-Party Solutions</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Solution</th><th>Vendor</th><th>Content</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>CrowdStrike Falcon</strong></td><td>CrowdStrike</td><td>Connector, 25+ rules, workbook, playbooks</td></tr>
                            <tr><td><strong>Okta Single Sign-On</strong></td><td>Okta</td><td>Connector, 30+ rules, workbook</td></tr>
                            <tr><td><strong>AWS</strong></td><td>Amazon</td><td>CloudTrail, GuardDuty, VPC Flow connectors</td></tr>
                            <tr><td><strong>Palo Alto PAN-OS</strong></td><td>Palo Alto</td><td>CEF connector, parser, 20+ rules</td></tr>
                            <tr><td><strong>Cisco Umbrella</strong></td><td>Cisco</td><td>Connector, parser, 15+ rules</td></tr>
                            <tr><td><strong>Zscaler ZIA</strong></td><td>Zscaler</td><td>Connector, parser, 20+ rules</td></tr>
                            <tr><td><strong>ServiceNow</strong></td><td>ServiceNow</td><td>Bidirectional playbooks for ticketing</td></tr>
                            <tr><td><strong>Recorded Future</strong></td><td>Recorded Future</td><td>TI connector, enrichment playbooks</td></tr>
                        </tbody>
                    </table>

                    <h3>Domain Solutions (ASIM-based)</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Solution</th><th>Schema</th><th>Content</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Network Session Essentials</strong></td>
                                <td>NetworkSession</td>
                                <td>20+ analytics rules, hunting queries, workbook</td>
                            </tr>
                            <tr>
                                <td><strong>DNS Essentials</strong></td>
                                <td>Dns</td>
                                <td>15+ analytics rules, hunting queries</td>
                            </tr>
                            <tr>
                                <td><strong>Web Session Essentials</strong></td>
                                <td>WebSession</td>
                                <td>10+ analytics rules, hunting queries</td>
                            </tr>
                            <tr>
                                <td><strong>Authentication Essentials</strong></td>
                                <td>Authentication</td>
                                <td>25+ analytics rules, workbook</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- Analytics Rules -->
                <section class="content-section" id="analytics">
                    <h2><i class="fas fa-bell"></i> Analytics Rules Reference</h2>
                    
                    <h3>Rule Types</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Type</th><th>Latency</th><th>Use Case</th><th>KQL Support</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Scheduled</strong></td>
                                <td>5 min - 14 days</td>
                                <td>Standard threat detection</td>
                                <td>Full KQL</td>
                            </tr>
                            <tr>
                                <td><strong>NRT (Near Real-Time)</strong></td>
                                <td>~1 minute</td>
                                <td>Time-sensitive threats</td>
                                <td>Limited (no joins)</td>
                            </tr>
                            <tr>
                                <td><strong>Fusion</strong></td>
                                <td>Varies</td>
                                <td>Multi-stage attack detection</td>
                                <td>ML-based (no custom KQL)</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Security</strong></td>
                                <td>Near real-time</td>
                                <td>Import Defender alerts</td>
                                <td>None (alert passthrough)</td>
                            </tr>
                            <tr>
                                <td><strong>Anomaly</strong></td>
                                <td>Daily</td>
                                <td>Behavioral anomalies</td>
                                <td>Configurable thresholds</td>
                            </tr>
                            <tr>
                                <td><strong>Threat Intelligence</strong></td>
                                <td>Hourly</td>
                                <td>IoC matching</td>
                                <td>Automatic matching</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Top Built-in Detection Rules</h3>
                    <table class="data-table parser-table">
                        <thead>
                            <tr><th>Rule Name</th><th>MITRE Tactic</th><th>Data Source</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Brute force attack against Azure Portal</td><td>Credential Access</td><td>SigninLogs</td></tr>
                            <tr><td>Suspicious sign-in from Tor exit node</td><td>Initial Access</td><td>SigninLogs</td></tr>
                            <tr><td>MFA disabled for user</td><td>Defense Evasion</td><td>AuditLogs</td></tr>
                            <tr><td>New executable via Office application</td><td>Execution</td><td>DeviceProcessEvents</td></tr>
                            <tr><td>PowerShell encoded command</td><td>Execution</td><td>SecurityEvent</td></tr>
                            <tr><td>Known malicious IP connection</td><td>Command & Control</td><td>ThreatIntelligenceIndicator</td></tr>
                            <tr><td>Suspicious inbox forwarding rule</td><td>Collection</td><td>OfficeActivity</td></tr>
                            <tr><td>Mass file deletion</td><td>Impact</td><td>DeviceFileEvents</td></tr>
                            <tr><td>Admin role assigned outside PIM</td><td>Persistence</td><td>AuditLogs</td></tr>
                            <tr><td>DNS request to known DGA domain</td><td>Command & Control</td><td>DnsEvents</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- Workbooks -->
                <section class="content-section" id="workbooks">
                    <h2><i class="fas fa-chart-bar"></i> Workbooks Reference</h2>
                    
                    <h3>Essential Workbooks</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Workbook</th><th>Purpose</th><th>Data Sources</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Azure AD Sign-in Logs</strong></td><td>Identity analytics and risk</td><td>SigninLogs</td></tr>
                            <tr><td><strong>Microsoft Sentinel SOC Operations</strong></td><td>SOC efficiency metrics</td><td>SecurityIncident</td></tr>
                            <tr><td><strong>Security Alerts</strong></td><td>Alert triage and trends</td><td>SecurityAlert</td></tr>
                            <tr><td><strong>Investigation Insights</strong></td><td>Entity investigation</td><td>Multiple</td></tr>
                            <tr><td><strong>Azure Activity</strong></td><td>Azure resource changes</td><td>AzureActivity</td></tr>
                            <tr><td><strong>Microsoft 365</strong></td><td>Office 365 security</td><td>OfficeActivity</td></tr>
                            <tr><td><strong>Threat Intelligence</strong></td><td>IoC analytics</td><td>ThreatIntelligenceIndicator</td></tr>
                            <tr><td><strong>Data Ingestion</strong></td><td>Data volume monitoring</td><td>Usage</td></tr>
                            <tr><td><strong>Zero Trust (TIC3.0)</strong></td><td>Zero Trust compliance</td><td>Multiple</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- Playbooks -->
                <section class="content-section" id="playbooks">
                    <h2><i class="fas fa-robot"></i> Playbooks Reference</h2>
                    
                    <h3>Playbook Categories</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Category</th><th>Examples</th><th>Connectors Used</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Enrichment</strong></td>
                                <td>IP reputation lookup, User risk check</td>
                                <td>VirusTotal, AbuseIPDB, Entra ID</td>
                            </tr>
                            <tr>
                                <td><strong>Notification</strong></td>
                                <td>Teams alert, Email notification</td>
                                <td>Teams, Outlook, Slack</td>
                            </tr>
                            <tr>
                                <td><strong>Ticketing</strong></td>
                                <td>Create ServiceNow ticket, Jira issue</td>
                                <td>ServiceNow, Jira, PagerDuty</td>
                            </tr>
                            <tr>
                                <td><strong>Remediation</strong></td>
                                <td>Block IP, Disable user, Isolate host</td>
                                <td>Firewall APIs, Entra ID, MDE</td>
                            </tr>
                            <tr>
                                <td><strong>Sync</strong></td>
                                <td>Bidirectional incident sync</td>
                                <td>Defender XDR, third-party SIEM</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Top Playbook Templates</h3>
                    <ul>
                        <li><strong>Block-IPAddress-AzureFirewall</strong> - Block malicious IP in Azure Firewall</li>
                        <li><strong>Confirm-AADRiskyUser</strong> - Confirm compromised user in Entra ID Protection</li>
                        <li><strong>Get-VirusTotalIPReport</strong> - Enrich IP with VirusTotal reputation</li>
                        <li><strong>Post-Message-Teams</strong> - Send alert to Teams channel</li>
                        <li><strong>Create-ServiceNow-Incident</strong> - Open ServiceNow ticket</li>
                        <li><strong>Isolate-MDE-Device</strong> - Isolate endpoint via Defender</li>
                        <li><strong>Revoke-AADUserSessions</strong> - Force sign-out for compromised user</li>
                    </ul>
                </section>

                <!-- Hunting Queries -->
                <section class="content-section" id="hunting">
                    <h2><i class="fas fa-crosshairs"></i> Hunting Queries</h2>
                    
                    <div class="info-box">
                        <h4>Hunting Query Features</h4>
                        <ul>
                            <li><strong>Bookmarks</strong> - Save interesting findings for investigation</li>
                            <li><strong>Livestream</strong> - Real-time query execution</li>
                            <li><strong>MITRE Mapping</strong> - Queries mapped to ATT&CK techniques</li>
                            <li><strong>Custom Queries</strong> - Create and share hunting queries</li>
                        </ul>
                    </div>
                    
                    <h3>Top Hunting Queries by Category</h3>
                    <table class="data-table">
                        <thead>
                            <tr><th>Category</th><th>Example Queries</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Initial Access</strong></td>
                                <td>Successful sign-in from blocked country, OAuth app consent</td>
                            </tr>
                            <tr>
                                <td><strong>Persistence</strong></td>
                                <td>New service creation, Scheduled task creation, Registry run keys</td>
                            </tr>
                            <tr>
                                <td><strong>Credential Access</strong></td>
                                <td>LSASS access, Kerberoasting, DCSync detection</td>
                            </tr>
                            <tr>
                                <td><strong>Lateral Movement</strong></td>
                                <td>RDP from unusual source, PsExec usage, WMI remote execution</td>
                            </tr>
                            <tr>
                                <td><strong>Exfiltration</strong></td>
                                <td>Large SharePoint downloads, USB copy operations</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- Watchlists -->
                <section class="content-section" id="watchlists">
                    <h2><i class="fas fa-list-check"></i> Watchlists</h2>
                    
                    <div class="concept-box sentinel">
                        <h3>What are Watchlists?</h3>
                        <p>Watchlists allow you to import external data (CSV) to correlate with Sentinel data. Common uses include:</p>
                        <ul>
                            <li><strong>Allow lists</strong> - Known good IPs, users, applications</li>
                            <li><strong>High-value assets</strong> - Critical servers, VIP users</li>
                            <li><strong>Threat intel</strong> - Custom IoC lists</li>
                            <li><strong>Business context</strong> - Department mappings, asset owners</li>
                        </ul>
                    </div>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <span class="code-title">Using Watchlists in Queries</span>
                            <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                        </div>
                        <pre><code>// Check sign-ins against VIP user watchlist
let VIPUsers = _GetWatchlist('VIPUsers') | project UserPrincipalName;
SigninLogs
| where UserPrincipalName in (VIPUsers)
| where ResultType != 0
| project TimeGenerated, UserPrincipalName, IPAddress, Location

// Exclude known IPs from alerts
let AllowedIPs = _GetWatchlist('AllowedIPs') | project IPAddress;
_Im_NetworkSession
| where DstIpAddr !in (AllowedIPs)
| where DvcAction == "Deny"</code></pre>
                    </div>
                </section>

                <!-- Interview Prep -->
                <section class="content-section">
                    <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                    
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>What is ASIM and why is it important?</span>
                        </div>
                        <div class="interview-answer">
                            <p><strong>ASIM (Advanced Security Information Model)</strong> is Microsoft Sentinel's normalization framework that transforms data from different sources into a common schema. It's important because: <strong>1)</strong> It enables source-agnostic detection - write one analytics rule that works across all firewall vendors. <strong>2)</strong> It simplifies onboarding new data sources without rewriting detection content. <strong>3)</strong> It reduces content maintenance by using common field names like <code>SrcIpAddr</code> instead of vendor-specific names. <strong>4)</strong> It powers domain solutions like Network Session Essentials that provide out-of-the-box detections across multiple products.</p>
                        </div>
                    </div>
                    
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>Explain the difference between Solutions and standalone content in Content Hub.</span>
                        </div>
                        <div class="interview-answer">
                            <p><strong>Solutions</strong> are packaged integrations that bundle multiple content types together - typically including a data connector, parsers, analytics rules, workbooks, and playbooks for a specific product or domain. For example, the CrowdStrike solution includes everything needed to ingest, detect, visualize, and respond to CrowdStrike data. <strong>Standalone content</strong> consists of individual items like a single analytics rule or hunting query that can be deployed independently. Solutions provide end-to-end value, while standalone content offers flexibility for specific needs.</p>
                        </div>
                    </div>
                </section>

            </main>
            
            <footer class="content-footer">
                <div class="footer-content">
                    <p>Nik's SIEM - Microsoft Sentinel Content Hub & ASIM Reference</p>
                    <p>Personal Reference Guide</p>
                </div>
            </footer>
        </div>
    </div>
    
    <script src="../assets/js/main.js"></script>
</body>
</html>
