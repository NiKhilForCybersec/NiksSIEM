<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KQL Fundamentals | Microsoft Sentinel | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Sentinel</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-connectors.html" class="nav-link"><i class="fas fa-plug"></i> Connectors</a>
                    <a href="dcr-dce-guide.html" class="nav-link"><i class="fas fa-cogs"></i> DCR & DCE</a>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">KQL</div>
                    <a href="kql-fundamentals.html" class="nav-link active"><i class="fas fa-terminal"></i> Fundamentals</a>
                    <a href="kql-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> Intermediate</a>
                    <a href="kql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection</div>
                    <a href="analytics-rules.html" class="nav-link"><i class="fas fa-bell"></i> Analytics Rules</a>
                    <a href="automation.html" class="nav-link"><i class="fas fa-robot"></i> Automation</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Sentinel</a>
                    <span class="separator">/</span>
                    <span class="current">KQL Fundamentals</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-terminal"></i> KQL Fundamentals</h1>
                <p class="lead">Kusto Query Language (KQL) is the foundation of everything you do in Microsoft Sentinel - from threat hunting to detection rules to workbook visualizations. Master these fundamentals to become effective at security operations in the Microsoft ecosystem.</p>

                <div class="prereq-box">
                    <h4><i class="fas fa-clipboard-check"></i> Prerequisites</h4>
                    <div class="prereq-grid">
                        <div class="prereq-item"><i class="fas fa-check-circle"></i><span>Basic SQL knowledge helpful but not required</span></div>
                        <div class="prereq-item"><i class="fas fa-check-circle"></i><span>Understanding of log data structures</span></div>
                        <div class="prereq-item"><i class="fas fa-check-circle"></i><span>Access to Sentinel workspace or Log Analytics</span></div>
                        <div class="prereq-item"><i class="fas fa-check-circle"></i><span>Familiarity with security events</span></div>
                    </div>
                    <p style="margin-top: 1rem; margin-bottom: 0;"><span class="badge green">Foundational</span> <span class="badge blue" style="margin-left: 0.5rem;">~60 min</span></p>
                </div>

                <h2><i class="fas fa-lightbulb"></i> What is KQL?</h2>

                <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> KQL in a Nutshell</h4>
                    <p>KQL is a <strong>read-only</strong> query language optimized for exploring large volumes of telemetry data. It uses a <strong>pipe-based syntax</strong> where you start with a data source and chain operators together. Think of it like Unix pipes - data flows from left to right through each transformation.</p>
                </div>

                <h3>KQL vs SQL Comparison</h3>
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr><th>Concept</th><th>SQL</th><th>KQL</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Select columns</strong></td><td>SELECT col1, col2</td><td>| project col1, col2</td></tr>
                            <tr><td><strong>Filter rows</strong></td><td>WHERE condition</td><td>| where condition</td></tr>
                            <tr><td><strong>Sort results</strong></td><td>ORDER BY col</td><td>| sort by col</td></tr>
                            <tr><td><strong>Limit rows</strong></td><td>LIMIT 10 / TOP 10</td><td>| take 10</td></tr>
                            <tr><td><strong>Aggregate</strong></td><td>GROUP BY with COUNT</td><td>| summarize count() by col</td></tr>
                            <tr><td><strong>Add column</strong></td><td>SELECT col, expr AS new</td><td>| extend new = expr</td></tr>
                            <tr><td><strong>Rename column</strong></td><td>SELECT col AS alias</td><td>| project-rename alias = col</td></tr>
                        </tbody>
                    </table>
                </div>

                <h2><i class="fas fa-code"></i> Basic Query Structure</h2>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> KQL Query Anatomy</div>
<pre>
TableName                           // 1. Start with a table
| where TimeGenerated > ago(24h)    // 2. Filter rows (time is almost always first)
| where Column == "value"           // 3. Additional filters
| extend NewColumn = expression     // 4. Add calculated columns
| summarize count() by GroupColumn  // 5. Aggregate data
| sort by count_ desc               // 6. Sort results
| take 10                           // 7. Limit output
</pre>
                </div>

                <div class="info-box warning">
                    <h4><i class="fas fa-exclamation-triangle"></i> Golden Rule: Always Filter Time First!</h4>
                    <p>The single most important performance optimization is filtering by <code>TimeGenerated</code> early in your query. Sentinel stores data in time-partitioned chunks, so time filtering dramatically reduces data scanned.</p>
                </div>

                <h2><i class="fas fa-filter"></i> Essential Operators</h2>

                <h3>where - Filter Rows</h3>
                <p>The <code>where</code> operator filters rows based on conditions. It's the equivalent of SQL's WHERE clause.</p>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> where Examples</div>
<pre>
// Basic equality
SigninLogs
| where ResultType == 0  // Successful logins (note: double equals!)

// Not equals
SigninLogs
| where ResultType != 0  // Failed logins

// String contains (case-insensitive)
SecurityEvent
| where CommandLine contains "powershell"

// String contains (case-sensitive)  
SecurityEvent
| where CommandLine contains_cs "PowerShell"

// Multiple conditions (AND)
SigninLogs
| where ResultType != 0 and AppDisplayName == "Microsoft Teams"

// Multiple conditions (OR)
SigninLogs
| where ResultType == 50126 or ResultType == 50053

// In a list
SigninLogs
| where ResultType in (50126, 50053, 50057)

// Not in a list
SigninLogs
| where ResultType !in (0, 50140)

// Starts with / Ends with
SecurityEvent
| where ProcessName startswith "cmd"
| where ProcessName endswith ".exe"

// Regex match (use sparingly - expensive!)
SecurityEvent
| where ProcessName matches regex @"^(cmd|powershell)\.exe$"

// Null checks
SecurityEvent
| where isnotempty(CommandLine)
| where isnotnull(ParentProcessName)
</pre>
                </div>

                <h3>project - Select Columns</h3>
                <p>Use <code>project</code> to select specific columns and optionally rename them.</p>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> project Examples</div>
<pre>
// Select specific columns
SigninLogs
| project TimeGenerated, UserPrincipalName, IPAddress, ResultType

// Rename columns
SigninLogs
| project Time = TimeGenerated, User = UserPrincipalName, IP = IPAddress

// Remove columns (keep all except listed)
SigninLogs
| project-away RawEventData, AdditionalDetails

// Reorder columns (keep all, reorder specified)
SigninLogs
| project-reorder TimeGenerated, UserPrincipalName, IPAddress
</pre>
                </div>

                <h3>extend - Add Calculated Columns</h3>
                <p>Use <code>extend</code> to add new columns based on expressions.</p>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> extend Examples</div>
<pre>
// Simple calculation
SecurityEvent
| extend ProcessPath = strcat(ProcessFolder, "\\", ProcessName)

// Conditional column
SigninLogs
| extend LoginStatus = iff(ResultType == 0, "Success", "Failure")

// Case statement
SigninLogs
| extend RiskLevel = case(
    ResultType == 0, "None",
    ResultType in (50126, 50053), "Medium",
    ResultType in (50057, 53003), "High",
    "Unknown"
)

// Parse JSON
AzureActivity
| extend ParsedProps = parse_json(Properties)
| extend ResourceName = ParsedProps.resource

// Extract from string
SecurityEvent
| extend Domain = extract(@"^([^\\]+)\\", 1, Account)
| extend Username = extract(@"\\(.+)$", 1, Account)

// Time calculations
SigninLogs
| extend HourOfDay = datetime_part("hour", TimeGenerated)
| extend DayOfWeek = dayofweek(TimeGenerated)
</pre>
                </div>

                <h3>summarize - Aggregate Data</h3>
                <p>The <code>summarize</code> operator is essential for aggregations - counting, statistics, and grouping.</p>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> summarize Examples</div>
<pre>
// Count all rows
SigninLogs
| summarize TotalLogins = count()

// Count by group
SigninLogs
| summarize LoginCount = count() by UserPrincipalName

// Multiple aggregations
SigninLogs
| summarize 
    TotalLogins = count(),
    UniqueUsers = dcount(UserPrincipalName),
    UniqueIPs = dcount(IPAddress)

// Count by multiple columns
SigninLogs
| summarize count() by UserPrincipalName, AppDisplayName

// Distinct count
SigninLogs
| summarize UniqueUsers = dcount(UserPrincipalName)

// First/Last value
SecurityEvent
| summarize 
    FirstSeen = min(TimeGenerated),
    LastSeen = max(TimeGenerated)
    by Computer

// Make a list
SigninLogs
| summarize IPAddresses = make_set(IPAddress) by UserPrincipalName

// Statistics
Perf
| summarize 
    AvgCPU = avg(CounterValue),
    MaxCPU = max(CounterValue),
    MinCPU = min(CounterValue),
    StdDev = stdev(CounterValue)
    by Computer

// Time binning (essential for time series!)
SigninLogs
| summarize LoginCount = count() by bin(TimeGenerated, 1h)
</pre>
                </div>

                <h3>sort and take - Order and Limit</h3>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> sort and take Examples</div>
<pre>
// Sort descending (default)
SigninLogs
| summarize count() by UserPrincipalName
| sort by count_ desc

// Sort ascending
SecurityEvent
| sort by TimeGenerated asc

// Take top N
SigninLogs
| summarize count() by UserPrincipalName
| sort by count_ desc
| take 10

// Shorthand: top
SigninLogs
| summarize count() by UserPrincipalName
| top 10 by count_ desc
</pre>
                </div>

                <h2><i class="fas fa-clock"></i> Time Operations</h2>

                <p>Time handling is critical in security queries. Here are the essential time operations:</p>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> Time Operations</div>
<pre>
// Relative time (most common)
| where TimeGenerated > ago(24h)    // Last 24 hours
| where TimeGenerated > ago(7d)     // Last 7 days
| where TimeGenerated > ago(30m)    // Last 30 minutes

// Time range
| where TimeGenerated between (ago(7d) .. ago(1d))  // 7 days ago to 1 day ago

// Specific datetime
| where TimeGenerated > datetime(2024-01-15 00:00:00)

// Time parts
| extend Hour = datetime_part("hour", TimeGenerated)
| extend DayOfWeek = dayofweek(TimeGenerated)  // 0=Sunday
| extend WeekOfYear = week_of_year(TimeGenerated)

// Format datetime
| extend FormattedTime = format_datetime(TimeGenerated, "yyyy-MM-dd HH:mm:ss")

// Time binning for charts
| summarize count() by bin(TimeGenerated, 1h)   // Hourly bins
| summarize count() by bin(TimeGenerated, 15m)  // 15-minute bins
| summarize count() by bin(TimeGenerated, 1d)   // Daily bins

// Calculate time difference
| extend Duration = datetime_diff("minute", EndTime, StartTime)
</pre>
                </div>

                <h2><i class="fas fa-font"></i> String Operations</h2>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> String Functions</div>
<pre>
// Concatenate strings
| extend FullName = strcat(FirstName, " ", LastName)

// String length
| extend CmdLength = strlen(CommandLine)

// Substring
| extend First10Chars = substring(CommandLine, 0, 10)

// Upper/Lower case
| extend UpperCmd = toupper(CommandLine)
| extend LowerCmd = tolower(CommandLine)

// Trim whitespace
| extend TrimmedValue = trim(" ", RawValue)

// Split string into array
| extend PathParts = split(FilePath, "\\")
| extend FileName = PathParts[-1]  // Last element

// Replace
| extend CleanCmd = replace_string(CommandLine, "  ", " ")

// Extract with regex
| extend IPAddress = extract(@"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})", 1, Message)

// Parse key=value pairs
| parse Message with * "user=" User " " *
| parse-kv Message as (user:string, ip:string) with (pair_delimiter=" ", kv_delimiter="=")

// Check if contains
| where CommandLine has "password"           // Word boundary match (fast)
| where CommandLine contains "password"      // Substring match
| where CommandLine has_any ("pass", "pwd")  // Any of these words
</pre>
                </div>

                <div class="info-box success">
                    <h4><i class="fas fa-bolt"></i> Performance Tip: has vs contains</h4>
                    <p><code>has</code> is faster than <code>contains</code> because it uses term indexes. Use <code>has</code> when searching for whole words, <code>contains</code> only when you need substring matching.</p>
                </div>

                <h2><i class="fas fa-search"></i> Common Security Queries</h2>

                <h3>Failed Login Analysis</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> Failed Logins - Multiple Scenarios</div>
<pre>
// Basic failed login count by user
SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType != 0
| summarize FailedAttempts = count() by UserPrincipalName
| where FailedAttempts > 10
| sort by FailedAttempts desc

// Failed logins with error details
SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType != 0
| summarize 
    FailedAttempts = count(),
    UniqueIPs = dcount(IPAddress),
    Apps = make_set(AppDisplayName)
    by UserPrincipalName, ResultType, ResultDescription
| sort by FailedAttempts desc

// Potential brute force (many failures then success)
let FailedLogins = SigninLogs
| where TimeGenerated > ago(1h)
| where ResultType != 0
| summarize FailCount = count() by UserPrincipalName, IPAddress;
let SuccessfulLogins = SigninLogs
| where TimeGenerated > ago(1h)
| where ResultType == 0
| distinct UserPrincipalName, IPAddress;
FailedLogins
| join kind=inner SuccessfulLogins on UserPrincipalName, IPAddress
| where FailCount > 5

// Impossible travel (simplified)
SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType == 0
| summarize Locations = make_set(Location) by UserPrincipalName
| where array_length(Locations) > 1
</pre>
                </div>

                <h3>Process Execution Analysis</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> Process Hunting Queries</div>
<pre>
// Suspicious process names
SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID == 4688  // Process creation
| where ProcessName has_any ("mimikatz", "procdump", "psexec", "wce")
| project TimeGenerated, Computer, Account, ProcessName, CommandLine

// PowerShell with encoded commands
SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID == 4688
| where ProcessName endswith "powershell.exe"
| where CommandLine contains "-enc" or CommandLine contains "-encoded"
| project TimeGenerated, Computer, Account, CommandLine

// Processes spawned by unusual parents
SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID == 4688
| where ParentProcessName endswith "outlook.exe" 
    or ParentProcessName endswith "excel.exe"
    or ParentProcessName endswith "word.exe"
| where ProcessName has_any ("cmd.exe", "powershell.exe", "wscript.exe", "cscript.exe")
| project TimeGenerated, Computer, ParentProcessName, ProcessName, CommandLine

// Rare processes by computer
SecurityEvent
| where TimeGenerated > ago(7d)
| where EventID == 4688
| summarize ExecutionCount = count() by ProcessName, Computer
| where ExecutionCount == 1
</pre>
                </div>

                <h2><i class="fas fa-comments"></i> Interview Questions</h2>

                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: What is KQL and where is it used?</button>
                        <div class="qa-answer">
                            <p><strong>Answer:</strong> KQL (Kusto Query Language) is a read-only query language developed by Microsoft for exploring large datasets. It's used in:</p>
                            <ul>
                                <li><strong>Microsoft Sentinel</strong> - Analytics rules, hunting, workbooks</li>
                                <li><strong>Azure Monitor / Log Analytics</strong> - Log queries</li>
                                <li><strong>Microsoft Defender XDR</strong> - Advanced Hunting</li>
                                <li><strong>Azure Data Explorer</strong> - Big data analytics</li>
                                <li><strong>Azure Resource Graph</strong> - Resource queries</li>
                            </ul>
                            <p>KQL uses pipe-based syntax where data flows through operators. It's optimized for time-series log data and includes built-in functions for security analysis.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q: What's the difference between 'has' and 'contains' in KQL?</button>
                        <div class="qa-answer">
                            <p><strong>Answer:</strong></p>
                            <ul>
                                <li><strong>has:</strong> Matches whole terms/words, uses term index, <em>case-insensitive</em>, very fast</li>
                                <li><strong>contains:</strong> Matches substrings anywhere, doesn't use index, <em>case-insensitive</em>, slower</li>
                            </ul>
                            <p><strong>Example:</strong></p>
                            <pre>// "administrator" has "admin" = FALSE (not a whole word)
// "administrator" contains "admin" = TRUE (substring match)

// Performance recommendation:
| where Column has "password"       // Fast - use when possible
| where Column contains "pass"      // Slow - only when substring needed</pre>
                            <p>Also: <code>has_cs</code> and <code>contains_cs</code> are case-sensitive versions.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q: How would you optimize a slow KQL query?</button>
                        <div class="qa-answer">
                            <p><strong>Answer:</strong> KQL optimization strategies:</p>
                            <p><strong>1. Time Filter First:</strong></p>
                            <pre>// Always filter TimeGenerated early
| where TimeGenerated > ago(24h)  // FIRST operator</pre>
                            <p><strong>2. Use Indexed Operators:</strong></p>
                            <ul>
                                <li>Use <code>has</code> instead of <code>contains</code></li>
                                <li>Use <code>==</code> instead of <code>=~</code> when case matters</li>
                                <li>Avoid <code>matches regex</code> when possible</li>
                            </ul>
                            <p><strong>3. Filter Early, Project Late:</strong></p>
                            <pre>// Filter rows first, then select columns
| where Condition
| project OnlyNeededColumns</pre>
                            <p><strong>4. Summarize to Reduce Data:</strong></p>
                            <pre>// Aggregate before joining
| summarize count() by Key
| join OtherTable on Key</pre>
                            <p><strong>5. Use materialize() for Reused Subqueries:</strong></p>
                            <pre>let ReusedData = materialize(Table | where ...);
ReusedData | ...
union ReusedData | ...</pre>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q: Write a KQL query to find users with more than 10 failed logins followed by a success.</button>
                        <div class="qa-answer">
                            <p><strong>Answer:</strong></p>
                            <pre>// Find potential brute force attacks
let timeframe = 1h;
let threshold = 10;
let FailedLogins = SigninLogs
| where TimeGenerated > ago(timeframe)
| where ResultType != 0
| summarize 
    FailedCount = count(),
    FailedTimes = make_list(TimeGenerated)
    by UserPrincipalName, IPAddress;
let SuccessLogins = SigninLogs
| where TimeGenerated > ago(timeframe)
| where ResultType == 0
| summarize 
    SuccessTime = min(TimeGenerated)
    by UserPrincipalName, IPAddress;
FailedLogins
| where FailedCount > threshold
| join kind=inner SuccessLogins on UserPrincipalName, IPAddress
| extend LastFailedTime = array_slice(FailedTimes, -1, -1)[0]
| where SuccessTime > todatetime(LastFailedTime)
| project UserPrincipalName, IPAddress, FailedCount, SuccessTime</pre>
                            <p><strong>Explanation:</strong> We create two intermediate results - failed and successful logins - then join them to find users who had failures followed by success from the same IP.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q: Explain the difference between 'extend' and 'project' in KQL.</button>
                        <div class="qa-answer">
                            <p><strong>Answer:</strong></p>
                            <ul>
                                <li><strong>extend:</strong> Adds new columns while keeping all existing columns</li>
                                <li><strong>project:</strong> Selects only the specified columns (drops everything else)</li>
                            </ul>
                            <p><strong>Example:</strong></p>
                            <pre>// Original table has: TimeGenerated, User, IP, Status

// extend - adds column, keeps all 4 original columns (now 5 total)
| extend StatusText = iff(Status == 0, "Success", "Failure")
// Result: TimeGenerated, User, IP, Status, StatusText

// project - only keeps specified columns
| project TimeGenerated, User, StatusText = iff(Status == 0, "Success", "Failure")
// Result: TimeGenerated, User, StatusText (only 3 columns)</pre>
                            <p><strong>Best practice:</strong> Use <code>extend</code> early for calculations, then <code>project</code> at the end to select final output columns.</p>
                        </div>
                    </div>
                </div>

                <h2><i class="fas fa-arrow-right"></i> Next Steps</h2>

                <div class="next-steps-grid">
                    <a href="kql-intermediate.html" class="next-step-card">
                        <i class="fas fa-layer-group"></i>
                        <h4>KQL Intermediate</h4>
                        <p>Joins, unions, let statements, and subqueries</p>
                    </a>
                    <a href="kql-advanced.html" class="next-step-card">
                        <i class="fas fa-code"></i>
                        <h4>KQL Advanced</h4>
                        <p>ML functions, time-series analysis, optimization</p>
                    </a>
                    <a href="analytics-rules.html" class="next-step-card">
                        <i class="fas fa-bell"></i>
                        <h4>Analytics Rules</h4>
                        <p>Use KQL to build detection rules</p>
                    </a>
                    <a href="../operations/triage-handbook.html" class="next-step-card">
                        <i class="fas fa-search"></i>
                        <h4>Threat Hunting</h4>
                        <p>Apply KQL for proactive threat hunting</p>
                    </a>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <div class="footer-links">
                        <a href="../index.html">Home</a>
                        <a href="index.html">Sentinel</a>
                        <a href="../splunk/index.html">Splunk</a>
                    </div>
                    <p>Nik's SIEM Compendium</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(b => {
            b.addEventListener('click', () => {
                const a = b.nextElementSibling;
                const open = a.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(x => x.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(x => x.classList.remove('active'));
                if (!open) { a.style.display = 'block'; b.classList.add('active'); }
            });
        });
    </script>
</body>
</html>
