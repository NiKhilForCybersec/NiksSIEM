<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KQL Fundamentals | Sentinel | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Sentinel Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-connectors.html" class="nav-link"><i class="fas fa-plug"></i> Data Connectors</a>
                    <a href="dcr-dce-guide.html" class="nav-link"><i class="fas fa-cogs"></i> DCR & DCE Guide</a>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion Patterns</a>
                    <a href="event-hub.html" class="nav-link"><i class="fas fa-broadcast-tower"></i> Event Hub</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & Transform</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">KQL Query Language</div>
                    <a href="kql-fundamentals.html" class="nav-link active"><i class="fas fa-terminal"></i> KQL Fundamentals</a>
                    <a href="kql-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> KQL Intermediate</a>
                    <a href="kql-advanced.html" class="nav-link"><i class="fas fa-code"></i> KQL Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="analytics-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> Analytics Rules</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intelligence</a>
                    <a href="automation.html" class="nav-link"><i class="fas fa-robot"></i> Automation (Playbooks)</a>
                    <a href="content-hub.html" class="nav-link"><i class="fas fa-store"></i> Content Hub</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="workbooks.html" class="nav-link"><i class="fas fa-chart-bar"></i> Workbooks</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Operations</a>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Sentinel</a><span class="separator">/</span>
                    <span class="current">KQL Fundamentals</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-terminal"></i> KQL Fundamentals</h1>
                <p class="lead">Kusto Query Language (KQL) is the query language for Azure Data Explorer, Log Analytics, and Microsoft Sentinel. Master KQL to effectively hunt threats, build detections, and investigate incidents.</p>

                <!-- KQL OVERVIEW -->
                <h2><i class="fas fa-info-circle"></i> What is KQL?</h2>
                
                <div class="info-box">
                    <h4><i class="fas fa-lightbulb"></i> Key Characteristics</h4>
                    <p>KQL is a read-only query language designed for big data analytics. It's optimized for:</p>
                    <ul>
                        <li><strong>Large-scale data:</strong> Processes terabytes efficiently</li>
                        <li><strong>Time-series analysis:</strong> Built-in time functions</li>
                        <li><strong>Pipeline syntax:</strong> Chain operators with pipe (|)</li>
                        <li><strong>Case-sensitive:</strong> Table and column names are case-sensitive</li>
                        <li><strong>Read-only:</strong> Cannot modify data, only query it</li>
                    </ul>
                </div>

                <!-- KQL STRUCTURE -->
                <h2><i class="fas fa-project-diagram"></i> KQL Query Structure</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-stream"></i> KQL Pipeline Flow</div>
                    
                    <div class="flow-row centered">
                        <div class="flow-box primary"><div class="flow-box-title">Table</div><div class="flow-box-subtitle">Data source</div></div>
                        <span class="flow-arrow">|</span>
                        <div class="flow-box success"><div class="flow-box-title">where</div><div class="flow-box-subtitle">Filter rows</div></div>
                        <span class="flow-arrow">|</span>
                        <div class="flow-box warning"><div class="flow-box-title">extend</div><div class="flow-box-subtitle">Add columns</div></div>
                        <span class="flow-arrow">|</span>
                        <div class="flow-box purple"><div class="flow-box-title">summarize</div><div class="flow-box-subtitle">Aggregate</div></div>
                        <span class="flow-arrow">|</span>
                        <div class="flow-box danger"><div class="flow-box-title">project</div><div class="flow-box-subtitle">Select columns</div></div>
                    </div>
                </div>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> Basic Query Structure</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Basic KQL query structure</span>
<span style="color: #79c0ff;">TableName</span>                          <span style="color: #8b949e;">// Start with a table</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(24h)   <span style="color: #8b949e;">// Filter by time</span>
| <span style="color: #f97583;">where</span> Column == <span style="color: #a5d6ff;">"value"</span>          <span style="color: #8b949e;">// Filter by condition</span>
| <span style="color: #f97583;">extend</span> NewColumn = expression    <span style="color: #8b949e;">// Create new column</span>
| <span style="color: #f97583;">summarize</span> count() by GroupColumn <span style="color: #8b949e;">// Aggregate data</span>
| <span style="color: #f97583;">sort by</span> count_ desc              <span style="color: #8b949e;">// Sort results</span>
| <span style="color: #f97583;">take</span> 10                           <span style="color: #8b949e;">// Limit results</span>
</pre>
                </div>

                <!-- COMMON TABLES -->
                <h2><i class="fas fa-table"></i> Common Sentinel Tables</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr><th>Table</th><th>Description</th><th>Common Fields</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SecurityEvent</strong></td>
                                <td>Windows Security Events</td>
                                <td>EventID, Account, Computer, Activity</td>
                                <td>Windows authentication, process creation</td>
                            </tr>
                            <tr>
                                <td><strong>SigninLogs</strong></td>
                                <td>Azure AD Sign-in Logs</td>
                                <td>UserPrincipalName, IPAddress, ResultType, Location</td>
                                <td>Cloud identity authentication</td>
                            </tr>
                            <tr>
                                <td><strong>AuditLogs</strong></td>
                                <td>Azure AD Audit Logs</td>
                                <td>OperationName, Identity, TargetResources</td>
                                <td>Directory changes, app registrations</td>
                            </tr>
                            <tr>
                                <td><strong>Syslog</strong></td>
                                <td>Linux/Network Syslog</td>
                                <td>Facility, SeverityLevel, SyslogMessage, Computer</td>
                                <td>Linux systems, network devices</td>
                            </tr>
                            <tr>
                                <td><strong>CommonSecurityLog</strong></td>
                                <td>CEF Format Logs</td>
                                <td>DeviceVendor, DeviceProduct, Activity, SourceIP</td>
                                <td>Firewalls, IDS/IPS, proxies</td>
                            </tr>
                            <tr>
                                <td><strong>DeviceEvents</strong></td>
                                <td>MDE Advanced Hunting</td>
                                <td>DeviceName, ActionType, FileName, ProcessCommandLine</td>
                                <td>Endpoint detection, process activity</td>
                            </tr>
                            <tr>
                                <td><strong>OfficeActivity</strong></td>
                                <td>Microsoft 365 Activity</td>
                                <td>Operation, UserId, ClientIP, ResultStatus</td>
                                <td>SharePoint, Exchange, Teams</td>
                            </tr>
                            <tr>
                                <td><strong>AzureActivity</strong></td>
                                <td>Azure Resource Activity</td>
                                <td>OperationName, Caller, ResourceGroup, ActivityStatus</td>
                                <td>Azure resource management</td>
                            </tr>
                            <tr>
                                <td><strong>SecurityIncident</strong></td>
                                <td>Sentinel Incidents</td>
                                <td>Title, Severity, Status, Owner</td>
                                <td>Incident tracking, SOC metrics</td>
                            </tr>
                            <tr>
                                <td><strong>SecurityAlert</strong></td>
                                <td>Security Alerts</td>
                                <td>AlertName, Severity, Entities, ProviderName</td>
                                <td>Alert analysis, correlation</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FILTERING -->
                <h2><i class="fas fa-filter"></i> Filtering Data with where</h2>

                <h3>Basic Comparison Operators</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> Comparison Operators</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Equality (case-sensitive)</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> EventID == 4625

<span style="color: #8b949e;">// Equality (case-insensitive)</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> Account =~ <span style="color: #a5d6ff;">"ADMIN"</span>

<span style="color: #8b949e;">// Not equal</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> Account != <span style="color: #a5d6ff;">"SYSTEM"</span>

<span style="color: #8b949e;">// Greater than / Less than</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> EventID >= 4624 <span style="color: #f97583;">and</span> EventID <= 4634

<span style="color: #8b949e;">// Multiple values with in</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> EventID <span style="color: #f97583;">in</span> (4624, 4625, 4634, 4647)

<span style="color: #8b949e;">// Not in list</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> EventID <span style="color: #f97583;">!in</span> (4624, 4634)

<span style="color: #8b949e;">// Between range</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> EventID <span style="color: #f97583;">between</span> (4624 .. 4634)
</pre>
                </div>

                <h3>String Operators</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> String Matching</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Contains (case-sensitive)</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> CommandLine <span style="color: #f97583;">contains</span> <span style="color: #a5d6ff;">"powershell"</span>

<span style="color: #8b949e;">// Contains (case-insensitive) - RECOMMENDED</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> CommandLine <span style="color: #f97583;">contains_cs</span> <span style="color: #a5d6ff;">"PowerShell"</span>

<span style="color: #8b949e;">// Has - word boundary matching (FASTER than contains)</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> CommandLine <span style="color: #f97583;">has</span> <span style="color: #a5d6ff;">"powershell"</span>

<span style="color: #8b949e;">// Has any - matches any word</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> CommandLine <span style="color: #f97583;">has_any</span> (<span style="color: #a5d6ff;">"powershell"</span>, <span style="color: #a5d6ff;">"cmd"</span>, <span style="color: #a5d6ff;">"wscript"</span>)

<span style="color: #8b949e;">// Starts with</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> Account <span style="color: #f97583;">startswith</span> <span style="color: #a5d6ff;">"admin"</span>

<span style="color: #8b949e;">// Ends with</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> Process <span style="color: #f97583;">endswith</span> <span style="color: #a5d6ff;">".exe"</span>

<span style="color: #8b949e;">// Regex matching</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> Account <span style="color: #f97583;">matches regex</span> <span style="color: #a5d6ff;">"admin[0-9]+"</span>

<span style="color: #8b949e;">// Not contains</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> CommandLine <span style="color: #f97583;">!contains</span> <span style="color: #a5d6ff;">"legitimate"</span>
</pre>
                </div>

                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-exclamation-triangle" style="color: #d29922;"></i> Performance Tip: has vs contains</h4>
                    <p><code>has</code> is significantly faster than <code>contains</code> because it uses term indexing. Use <code>has</code> when searching for whole words, and <code>contains</code> only when you need substring matching.</p>
                    <ul>
                        <li><code>has "error"</code> - Fast, matches "error" as a word</li>
                        <li><code>contains "err"</code> - Slower, matches "error", "stderr", "erroneous"</li>
                    </ul>
                </div>

                <h3>Time Filtering</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-clock"></i> Time-based Filtering</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Relative time - last 24 hours</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(24h)

<span style="color: #8b949e;">// Relative time - last 7 days</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(7d)

<span style="color: #8b949e;">// Relative time - last 30 minutes</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(30m)

<span style="color: #8b949e;">// Time range</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated <span style="color: #f97583;">between</span> (ago(7d) .. ago(1d))

<span style="color: #8b949e;">// Specific datetime</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated >= datetime(2024-01-15 00:00:00)
| <span style="color: #f97583;">where</span> TimeGenerated < datetime(2024-01-16 00:00:00)

<span style="color: #8b949e;">// Start of day/week/month</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated >= startofday(ago(7d))
| <span style="color: #f97583;">where</span> TimeGenerated >= startofweek(now())
| <span style="color: #f97583;">where</span> TimeGenerated >= startofmonth(now())

<span style="color: #8b949e;">// Time units: d=days, h=hours, m=minutes, s=seconds, ms=milliseconds</span>
</pre>
                </div>

                <!-- EXTENDING DATA -->
                <h2><i class="fas fa-plus-circle"></i> Creating Columns with extend</h2>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> extend Examples</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Create a new calculated column</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">extend</span> DayOfWeek = dayofweek(TimeGenerated)

<span style="color: #8b949e;">// Create multiple columns</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">extend</span> 
    Hour = hourofday(TimeGenerated),
    DayName = format_datetime(TimeGenerated, <span style="color: #a5d6ff;">"dddd"</span>),
    IsWeekend = dayofweek(TimeGenerated) <span style="color: #f97583;">in</span> (0d, 6d)

<span style="color: #8b949e;">// Conditional column with iff (if-then-else)</span>
<span style="color: #79c0ff;">SigninLogs</span>
| <span style="color: #f97583;">extend</span> LoginResult = <span style="color: #79c0ff;">iff</span>(ResultType == <span style="color: #a5d6ff;">"0"</span>, <span style="color: #a5d6ff;">"Success"</span>, <span style="color: #a5d6ff;">"Failure"</span>)

<span style="color: #8b949e;">// Multiple conditions with case</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">extend</span> EventCategory = <span style="color: #79c0ff;">case</span>(
    EventID == 4624, <span style="color: #a5d6ff;">"Logon Success"</span>,
    EventID == 4625, <span style="color: #a5d6ff;">"Logon Failure"</span>,
    EventID == 4634, <span style="color: #a5d6ff;">"Logoff"</span>,
    EventID == 4648, <span style="color: #a5d6ff;">"Explicit Credentials"</span>,
    EventID == 4672, <span style="color: #a5d6ff;">"Special Privileges"</span>,
    <span style="color: #a5d6ff;">"Other"</span>
)

<span style="color: #8b949e;">// Extract from string</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">extend</span> Domain = tostring(split(Account, <span style="color: #a5d6ff;">"\\"</span>)[0])
| <span style="color: #f97583;">extend</span> Username = tostring(split(Account, <span style="color: #a5d6ff;">"\\"</span>)[1])

<span style="color: #8b949e;">// Parse JSON</span>
<span style="color: #79c0ff;">SigninLogs</span>
| <span style="color: #f97583;">extend</span> City = tostring(LocationDetails.city)
| <span style="color: #f97583;">extend</span> Country = tostring(LocationDetails.countryOrRegion)

<span style="color: #8b949e;">// String concatenation</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">extend</span> FullDescription = strcat(Account, <span style="color: #a5d6ff;">" logged on to "</span>, Computer)
</pre>
                </div>

                <!-- AGGREGATION -->
                <h2><i class="fas fa-calculator"></i> Aggregating with summarize</h2>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> summarize Examples</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Count events</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(24h)
| <span style="color: #f97583;">summarize</span> TotalEvents = count()

<span style="color: #8b949e;">// Count by group</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(24h)
| <span style="color: #f97583;">summarize</span> EventCount = count() <span style="color: #f97583;">by</span> EventID

<span style="color: #8b949e;">// Multiple aggregations</span>
<span style="color: #79c0ff;">SigninLogs</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(7d)
| <span style="color: #f97583;">summarize</span> 
    TotalSignins = count(),
    SuccessCount = countif(ResultType == <span style="color: #a5d6ff;">"0"</span>),
    FailureCount = countif(ResultType != <span style="color: #a5d6ff;">"0"</span>),
    UniqueUsers = dcount(UserPrincipalName),
    UniqueIPs = dcount(IPAddress)
  <span style="color: #f97583;">by</span> bin(TimeGenerated, 1d)

<span style="color: #8b949e;">// Distinct count</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">summarize</span> UniqueComputers = dcount(Computer)

<span style="color: #8b949e;">// Collect values into list</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> EventID == 4625
| <span style="color: #f97583;">summarize</span> 
    FailedCount = count(),
    TargetAccounts = make_set(Account),
    SourceIPs = make_set(IpAddress)
  <span style="color: #f97583;">by</span> Computer

<span style="color: #8b949e;">// Min, Max, Avg, Sum</span>
<span style="color: #79c0ff;">Perf</span>
| <span style="color: #f97583;">where</span> CounterName == <span style="color: #a5d6ff;">"% Processor Time"</span>
| <span style="color: #f97583;">summarize</span> 
    MinCPU = min(CounterValue),
    MaxCPU = max(CounterValue),
    AvgCPU = avg(CounterValue),
    StdDevCPU = stdev(CounterValue)
  <span style="color: #f97583;">by</span> Computer

<span style="color: #8b949e;">// Time binning for charts</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(7d)
| <span style="color: #f97583;">summarize</span> count() <span style="color: #f97583;">by</span> bin(TimeGenerated, 1h)
| <span style="color: #f97583;">render</span> timechart

<span style="color: #8b949e;">// First and last occurrence</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> EventID == 4625
| <span style="color: #f97583;">summarize</span> 
    FirstAttempt = min(TimeGenerated),
    LastAttempt = max(TimeGenerated),
    AttemptCount = count()
  <span style="color: #f97583;">by</span> Account
</pre>
                </div>

                <h3>Common Aggregation Functions</h3>
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr><th>Function</th><th>Description</th><th>Example</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><code>count()</code></td><td>Count of rows</td><td>summarize count()</td></tr>
                            <tr><td><code>countif(condition)</code></td><td>Count where condition is true</td><td>summarize countif(Status == "Failed")</td></tr>
                            <tr><td><code>dcount(column)</code></td><td>Distinct count</td><td>summarize dcount(UserPrincipalName)</td></tr>
                            <tr><td><code>sum(column)</code></td><td>Sum of values</td><td>summarize sum(BytesSent)</td></tr>
                            <tr><td><code>avg(column)</code></td><td>Average</td><td>summarize avg(ResponseTime)</td></tr>
                            <tr><td><code>min(column)</code></td><td>Minimum value</td><td>summarize min(TimeGenerated)</td></tr>
                            <tr><td><code>max(column)</code></td><td>Maximum value</td><td>summarize max(TimeGenerated)</td></tr>
                            <tr><td><code>make_set(column)</code></td><td>Unique values as array</td><td>summarize make_set(IPAddress)</td></tr>
                            <tr><td><code>make_list(column)</code></td><td>All values as array</td><td>summarize make_list(EventID)</td></tr>
                            <tr><td><code>arg_max(column, *)</code></td><td>Row with max value</td><td>summarize arg_max(TimeGenerated, *)</td></tr>
                            <tr><td><code>arg_min(column, *)</code></td><td>Row with min value</td><td>summarize arg_min(TimeGenerated, *)</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- SELECTING AND SORTING -->
                <h2><i class="fas fa-columns"></i> Selecting and Sorting</h2>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> project, sort, take</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Select specific columns</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">project</span> TimeGenerated, Account, Computer, EventID

<span style="color: #8b949e;">// Select and rename columns</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">project</span> Timestamp = TimeGenerated, User = Account, Host = Computer

<span style="color: #8b949e;">// Remove specific columns (keep the rest)</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">project-away</span> TenantId, SourceSystem, MG

<span style="color: #8b949e;">// Reorder columns (specified first, then rest)</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">project-reorder</span> TimeGenerated, Account, Computer

<span style="color: #8b949e;">// Keep only certain columns plus new ones</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">project-keep</span> TimeGenerated, Account, EventID

<span style="color: #8b949e;">// Sort descending</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">sort by</span> TimeGenerated desc

<span style="color: #8b949e;">// Sort by multiple columns</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">summarize</span> count() <span style="color: #f97583;">by</span> Account, Computer
| <span style="color: #f97583;">sort by</span> count_ desc, Account asc

<span style="color: #8b949e;">// Limit results</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">take</span> 100

<span style="color: #8b949e;">// Top N by value</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">summarize</span> count() <span style="color: #f97583;">by</span> Account
| <span style="color: #f97583;">top</span> 10 <span style="color: #f97583;">by</span> count_ desc

<span style="color: #8b949e;">// Distinct values</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">distinct</span> Computer
</pre>
                </div>

                <!-- SECURITY USE CASES -->
                <h2><i class="fas fa-shield-alt"></i> Security Use Cases</h2>

                <h3>Use Case 1: Failed Login Analysis</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-user-times"></i> Brute Force Detection</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Windows Security Event 4625 - Failed Login</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(1h)
| <span style="color: #f97583;">where</span> EventID == 4625
| <span style="color: #f97583;">summarize</span> 
    FailedAttempts = count(),
    UniqueAccounts = dcount(Account),
    TargetAccounts = make_set(Account),
    FirstAttempt = min(TimeGenerated),
    LastAttempt = max(TimeGenerated)
  <span style="color: #f97583;">by</span> IpAddress, Computer
| <span style="color: #f97583;">where</span> FailedAttempts > 10
| <span style="color: #f97583;">extend</span> AttackDuration = LastAttempt - FirstAttempt
| <span style="color: #f97583;">extend</span> AttemptsPerMinute = FailedAttempts / (datetime_diff(<span style="color: #a5d6ff;">'minute'</span>, LastAttempt, FirstAttempt) + 1)
| <span style="color: #f97583;">project</span> 
    IpAddress,
    Computer,
    FailedAttempts,
    UniqueAccounts,
    TargetAccounts,
    AttackDuration,
    AttemptsPerMinute
| <span style="color: #f97583;">sort by</span> FailedAttempts desc
</pre>
                </div>

                <h3>Use Case 2: Azure AD Impossible Travel</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-globe"></i> Impossible Travel Detection</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Detect logins from different countries within 2 hours</span>
<span style="color: #f97583;">let</span> timeThreshold = 2h;
<span style="color: #79c0ff;">SigninLogs</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(7d)
| <span style="color: #f97583;">where</span> ResultType == <span style="color: #a5d6ff;">"0"</span>  <span style="color: #8b949e;">// Successful logins only</span>
| <span style="color: #f97583;">extend</span> Country = tostring(LocationDetails.countryOrRegion)
| <span style="color: #f97583;">extend</span> City = tostring(LocationDetails.city)
| <span style="color: #f97583;">project</span> TimeGenerated, UserPrincipalName, IPAddress, Country, City, AppDisplayName
| <span style="color: #f97583;">sort by</span> UserPrincipalName asc, TimeGenerated asc
| <span style="color: #f97583;">extend</span> PrevTime = prev(TimeGenerated, 1)
| <span style="color: #f97583;">extend</span> PrevCountry = prev(Country, 1)
| <span style="color: #f97583;">extend</span> PrevCity = prev(City, 1)
| <span style="color: #f97583;">extend</span> PrevIP = prev(IPAddress, 1)
| <span style="color: #f97583;">extend</span> PrevUser = prev(UserPrincipalName, 1)
| <span style="color: #f97583;">where</span> UserPrincipalName == PrevUser
| <span style="color: #f97583;">where</span> Country != PrevCountry
| <span style="color: #f97583;">extend</span> TimeDiff = TimeGenerated - PrevTime
| <span style="color: #f97583;">where</span> TimeDiff < timeThreshold
| <span style="color: #f97583;">project</span> 
    TimeGenerated,
    UserPrincipalName,
    CurrentLocation = strcat(City, <span style="color: #a5d6ff;">", "</span>, Country),
    CurrentIP = IPAddress,
    PreviousLocation = strcat(PrevCity, <span style="color: #a5d6ff;">", "</span>, PrevCountry),
    PreviousIP = PrevIP,
    TimeBetweenLogins = TimeDiff
</pre>
                </div>

                <h3>Use Case 3: Suspicious PowerShell</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-terminal"></i> Encoded PowerShell Detection</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Detect encoded PowerShell commands</span>
<span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(24h)
| <span style="color: #f97583;">where</span> EventID == 4688  <span style="color: #8b949e;">// Process Creation</span>
| <span style="color: #f97583;">where</span> NewProcessName <span style="color: #f97583;">has_any</span> (<span style="color: #a5d6ff;">"powershell.exe"</span>, <span style="color: #a5d6ff;">"pwsh.exe"</span>)
| <span style="color: #f97583;">where</span> CommandLine <span style="color: #f97583;">has_any</span> (
    <span style="color: #a5d6ff;">"-enc"</span>, <span style="color: #a5d6ff;">"-encoded"</span>, <span style="color: #a5d6ff;">"-encodedcommand"</span>,
    <span style="color: #a5d6ff;">"FromBase64String"</span>, <span style="color: #a5d6ff;">"IEX"</span>, <span style="color: #a5d6ff;">"Invoke-Expression"</span>,
    <span style="color: #a5d6ff;">"downloadstring"</span>, <span style="color: #a5d6ff;">"bypass"</span>, <span style="color: #a5d6ff;">"hidden"</span>
)
| <span style="color: #f97583;">extend</span> SuspiciousIndicators = pack_array(
    <span style="color: #79c0ff;">iff</span>(CommandLine <span style="color: #f97583;">has</span> <span style="color: #a5d6ff;">"-enc"</span>, <span style="color: #a5d6ff;">"Encoded"</span>, <span style="color: #a5d6ff;">""</span>),
    <span style="color: #79c0ff;">iff</span>(CommandLine <span style="color: #f97583;">has</span> <span style="color: #a5d6ff;">"IEX"</span>, <span style="color: #a5d6ff;">"Invoke-Expression"</span>, <span style="color: #a5d6ff;">""</span>),
    <span style="color: #79c0ff;">iff</span>(CommandLine <span style="color: #f97583;">has</span> <span style="color: #a5d6ff;">"downloadstring"</span>, <span style="color: #a5d6ff;">"Download"</span>, <span style="color: #a5d6ff;">""</span>),
    <span style="color: #79c0ff;">iff</span>(CommandLine <span style="color: #f97583;">has</span> <span style="color: #a5d6ff;">"bypass"</span>, <span style="color: #a5d6ff;">"Bypass"</span>, <span style="color: #a5d6ff;">""</span>)
)
| <span style="color: #f97583;">extend</span> RiskLevel = <span style="color: #79c0ff;">case</span>(
    CommandLine <span style="color: #f97583;">has_all</span> (<span style="color: #a5d6ff;">"-enc"</span>, <span style="color: #a5d6ff;">"downloadstring"</span>), <span style="color: #a5d6ff;">"Critical"</span>,
    CommandLine <span style="color: #f97583;">has</span> <span style="color: #a5d6ff;">"-enc"</span>, <span style="color: #a5d6ff;">"High"</span>,
    <span style="color: #a5d6ff;">"Medium"</span>
)
| <span style="color: #f97583;">project</span> 
    TimeGenerated,
    Computer,
    Account,
    ParentProcessName,
    NewProcessName,
    CommandLine,
    RiskLevel,
    SuspiciousIndicators
| <span style="color: #f97583;">sort by</span> RiskLevel asc, TimeGenerated desc
</pre>
                </div>

                <h3>Use Case 4: Data Exfiltration Detection</h3>
                <div class="code-block">
                    <div class="code-header"><i class="fas fa-file-export"></i> Large Data Transfer</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Detect unusually large outbound data transfers</span>
<span style="color: #f97583;">let</span> threshold_GB = 5;
<span style="color: #79c0ff;">CommonSecurityLog</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(24h)
| <span style="color: #f97583;">where</span> DeviceVendor == <span style="color: #a5d6ff;">"Palo Alto Networks"</span>
| <span style="color: #f97583;">where</span> Activity <span style="color: #f97583;">has</span> <span style="color: #a5d6ff;">"TRAFFIC"</span>
| <span style="color: #f97583;">extend</span> BytesSent = toint(SentBytes)
| <span style="color: #f97583;">summarize</span> 
    TotalBytesSent = sum(BytesSent),
    UniqueDestinations = dcount(DestinationIP),
    TopDestinations = make_set(DestinationIP, 10),
    SessionCount = count()
  <span style="color: #f97583;">by</span> SourceIP, SourceUserName
| <span style="color: #f97583;">extend</span> TotalGB = round(TotalBytesSent / 1073741824.0, 2)
| <span style="color: #f97583;">where</span> TotalGB > threshold_GB
| <span style="color: #f97583;">extend</span> RiskLevel = <span style="color: #79c0ff;">case</span>(
    TotalGB > 50, <span style="color: #a5d6ff;">"Critical"</span>,
    TotalGB > 20, <span style="color: #a5d6ff;">"High"</span>,
    TotalGB > 10, <span style="color: #a5d6ff;">"Medium"</span>,
    <span style="color: #a5d6ff;">"Low"</span>
)
| <span style="color: #f97583;">project</span> 
    SourceIP,
    SourceUserName,
    TotalGB,
    UniqueDestinations,
    SessionCount,
    TopDestinations,
    RiskLevel
| <span style="color: #f97583;">sort by</span> TotalGB desc
</pre>
                </div>

                <!-- BEST PRACTICES -->
                <h2><i class="fas fa-check-double"></i> KQL Best Practices</h2>
                
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1a4d2e; color: #3fb950;"><i class="fas fa-tachometer-alt"></i></div>
                            <div class="comparison-item-title">Performance</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Filter time first (TimeGenerated)</li>
                            <li><i class="fas fa-check"></i> Use <code>has</code> instead of <code>contains</code></li>
                            <li><i class="fas fa-check"></i> Filter before aggregating</li>
                            <li><i class="fas fa-check"></i> Use <code>project</code> to limit columns</li>
                            <li><i class="fas fa-check"></i> Avoid <code>*</code> in production queries</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1c3a5e; color: #58a6ff;"><i class="fas fa-book"></i></div>
                            <div class="comparison-item-title">Readability</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Use meaningful column names</li>
                            <li><i class="fas fa-check"></i> Add comments with //</li>
                            <li><i class="fas fa-check"></i> Use let statements for variables</li>
                            <li><i class="fas fa-check"></i> One operator per line</li>
                            <li><i class="fas fa-check"></i> Consistent indentation</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #4d1a1a; color: #f85149;"><i class="fas fa-ban"></i></div>
                            <div class="comparison-item-title">Avoid</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-times"></i> Leading wildcards in regex</li>
                            <li><i class="fas fa-times"></i> Scanning entire tables</li>
                            <li><i class="fas fa-times"></i> Multiple <code>union</code> without filters</li>
                            <li><i class="fas fa-times"></i> Complex regex when simple works</li>
                            <li><i class="fas fa-times"></i> Unnecessary <code>mv-expand</code></li>
                        </ul>
                    </div>
                </div>

                <!-- ENTERPRISE EXAMPLE -->
                <div class="enterprise-example">
                    <div class="enterprise-example-header">
                        <i class="fas fa-building"></i>
                        <div class="enterprise-example-title">Enterprise Example: Daily Threat Hunting Query</div>
                    </div>
                    <div class="enterprise-example-scenario">
                        <strong>Scenario:</strong> SOC analyst running daily threat hunt across 10,000 endpoints looking for suspicious activity patterns.
                    </div>
                    
                    <div class="code-block" style="margin-top: 16px;">
                        <div class="code-header"><i class="fas fa-crosshairs"></i> Comprehensive Hunt Query</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Daily Threat Hunt - Comprehensive Security Check</span>
<span style="color: #f97583;">let</span> lookback = 24h;
<span style="color: #f97583;">let</span> suspiciousProcesses = dynamic([<span style="color: #a5d6ff;">"mimikatz"</span>, <span style="color: #a5d6ff;">"psexec"</span>, <span style="color: #a5d6ff;">"procdump"</span>]);
<span style="color: #f97583;">let</span> knownGoodIPs = dynamic([<span style="color: #a5d6ff;">"10.0.0.0/8"</span>, <span style="color: #a5d6ff;">"172.16.0.0/12"</span>]);

<span style="color: #8b949e;">// Combine multiple data sources</span>
<span style="color: #f97583;">let</span> FailedLogins = <span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(lookback)
| <span style="color: #f97583;">where</span> EventID == 4625
| <span style="color: #f97583;">summarize</span> FailedCount = count() <span style="color: #f97583;">by</span> Account, Computer
| <span style="color: #f97583;">where</span> FailedCount > 5
| <span style="color: #f97583;">extend</span> AlertType = <span style="color: #a5d6ff;">"Failed Logins"</span>;

<span style="color: #f97583;">let</span> SuspiciousProcesses = <span style="color: #79c0ff;">SecurityEvent</span>
| <span style="color: #f97583;">where</span> TimeGenerated > ago(lookback)
| <span style="color: #f97583;">where</span> EventID == 4688
| <span style="color: #f97583;">where</span> NewProcessName <span style="color: #f97583;">has_any</span> (suspiciousProcesses)
| <span style="color: #f97583;">summarize</span> count() <span style="color: #f97583;">by</span> Account, Computer, NewProcessName
| <span style="color: #f97583;">extend</span> AlertType = <span style="color: #a5d6ff;">"Suspicious Process"</span>;

<span style="color: #8b949e;">// Union results</span>
<span style="color: #f97583;">union</span> FailedLogins, SuspiciousProcesses
| <span style="color: #f97583;">project</span> AlertType, Account, Computer, Details = pack_all()
| <span style="color: #f97583;">sort by</span> AlertType, Computer
</pre>
                    </div>
                    
                    <div style="margin-top: 16px; padding: 12px; background: #161b22; border-radius: 8px;">
                        <p style="color: #8b949e; font-size: 0.85rem; margin: 0;">
                            <strong style="color: #3fb950;">Results:</strong> Query runs in ~15 seconds across 10M events<br>
                            <strong style="color: #58a6ff;">Optimization:</strong> Time filter first, use has instead of contains<br>
                            <strong style="color: #d29922;">Usage:</strong> Run daily as scheduled hunting query
                        </p>
                    </div>
                </div>

                <!-- INTERVIEW QUESTIONS -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: What's the difference between 'has' and 'contains' in KQL?</button>
                        <div class="qa-answer">
                            <p><strong>has operator:</strong></p>
                            <ul>
                                <li>Matches complete terms/words</li>
                                <li>Uses term indexing - very fast</li>
                                <li>Case-insensitive by default</li>
                                <li>Example: <code>"error log"</code> has <code>"error"</code> → true</li>
                                <li>Example: <code>"error log"</code> has <code>"err"</code> → false</li>
                            </ul>
                            <p><strong>contains operator:</strong></p>
                            <ul>
                                <li>Matches substrings anywhere</li>
                                <li>Requires full scan - slower</li>
                                <li>Case-insensitive by default</li>
                                <li>Example: <code>"error log"</code> contains <code>"err"</code> → true</li>
                            </ul>
                            <p><strong>Best Practice:</strong> Use <code>has</code> whenever possible. Only use <code>contains</code> when you need substring matching.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How do you optimize a slow KQL query?</button>
                        <div class="qa-answer">
                            <p><strong>Optimization techniques:</strong></p>
                            <ol>
                                <li><strong>Time filter first:</strong> Always filter on TimeGenerated early</li>
                                <li><strong>Use indexed operators:</strong> has, in, ==, startswith</li>
                                <li><strong>Filter before join:</strong> Reduce rows before expensive operations</li>
                                <li><strong>Project early:</strong> Remove unused columns</li>
                                <li><strong>Avoid regex when possible:</strong> Use has, startswith instead</li>
                                <li><strong>Use summarize hints:</strong> hint.shufflekey for large aggregations</li>
                                <li><strong>Materialize intermediate results:</strong> Use materialize() for reused subqueries</li>
                            </ol>
                            <p><strong>Example optimization:</strong></p>
                            <p>Before: <code>Table | where Column contains "error"</code></p>
                            <p>After: <code>Table | where TimeGenerated > ago(1h) | where Column has "error"</code></p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: Explain the difference between project, project-away, and extend</button>
                        <div class="qa-answer">
                            <p><strong>project:</strong></p>
                            <ul>
                                <li>Selects specific columns to include</li>
                                <li>All other columns are removed</li>
                                <li>Can rename columns</li>
                                <li>Example: <code>| project TimeGenerated, Account</code></li>
                            </ul>
                            <p><strong>project-away:</strong></p>
                            <ul>
                                <li>Removes specific columns</li>
                                <li>Keeps all other columns</li>
                                <li>Useful for removing system columns</li>
                                <li>Example: <code>| project-away TenantId, SourceSystem</code></li>
                            </ul>
                            <p><strong>extend:</strong></p>
                            <ul>
                                <li>Adds new calculated columns</li>
                                <li>Keeps all existing columns</li>
                                <li>Cannot remove columns</li>
                                <li>Example: <code>| extend Hour = hourofday(TimeGenerated)</code></li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How would you detect brute force attacks using KQL?</button>
                        <div class="qa-answer">
                            <p><strong>Brute force detection approach:</strong></p>
                            <ol>
                                <li>Query failed login events (EventID 4625 or SigninLogs failures)</li>
                                <li>Aggregate by source IP within a time window</li>
                                <li>Set threshold for suspicious count</li>
                                <li>Look for multiple targeted accounts</li>
                            </ol>
                            <p><strong>Key query elements:</strong></p>
                            <pre style="background: #0d1117; padding: 12px; border-radius: 8px; color: #f0f6fc;">SigninLogs
| where TimeGenerated > ago(1h)
| where ResultType != "0"
| summarize 
    FailedCount = count(),
    UniqueAccounts = dcount(UserPrincipalName)
  by IPAddress
| where FailedCount > 10
| where UniqueAccounts > 3</pre>
                            <p><strong>Enhanced detection:</strong> Add velocity calculation (attempts per minute), check for password spray patterns (many accounts, few attempts each).</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: What is the 'let' statement used for?</button>
                        <div class="qa-answer">
                            <p><strong>let statement uses:</strong></p>
                            <ul>
                                <li><strong>Variables:</strong> Store values for reuse</li>
                                <li><strong>Subqueries:</strong> Define reusable query blocks</li>
                                <li><strong>Functions:</strong> Create inline functions</li>
                                <li><strong>Dynamic arrays:</strong> Define lists for filtering</li>
                            </ul>
                            <p><strong>Examples:</strong></p>
                            <pre style="background: #0d1117; padding: 12px; border-radius: 8px; color: #f0f6fc;">// Variable
let threshold = 10;

// Dynamic array
let suspiciousProcesses = dynamic(["mimikatz", "psexec"]);

// Subquery
let HighRiskUsers = SigninLogs
| where RiskLevel == "High"
| distinct UserPrincipalName;

// Use in main query
SecurityEvent
| where Account in (HighRiskUsers)
| where ProcessName has_any (suspiciousProcesses)</pre>
                        </div>
                    </div>
                </div>

                <!-- QUICK REFERENCE -->
                <h2><i class="fas fa-bookmark"></i> Quick Reference</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr><th>Category</th><th>Operator</th><th>Example</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Filter</strong></td><td>where</td><td>| where EventID == 4625</td></tr>
                            <tr><td><strong>Aggregate</strong></td><td>summarize</td><td>| summarize count() by Account</td></tr>
                            <tr><td><strong>Transform</strong></td><td>extend</td><td>| extend Hour = hourofday(TimeGenerated)</td></tr>
                            <tr><td><strong>Select</strong></td><td>project</td><td>| project TimeGenerated, Account</td></tr>
                            <tr><td><strong>Sort</strong></td><td>sort by</td><td>| sort by TimeGenerated desc</td></tr>
                            <tr><td><strong>Limit</strong></td><td>take / top</td><td>| take 100</td></tr>
                            <tr><td><strong>Join</strong></td><td>join</td><td>| join kind=inner (Table2) on Key</td></tr>
                            <tr><td><strong>Union</strong></td><td>union</td><td>union Table1, Table2</td></tr>
                            <tr><td><strong>Variable</strong></td><td>let</td><td>let threshold = 10;</td></tr>
                            <tr><td><strong>Render</strong></td><td>render</td><td>| render timechart</td></tr>
                        </tbody>
                    </table>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
