<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Log Source Onboarding - Complete Guide | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link active" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Splunk Pages</div>
                <ul class="sidebar-nav">
                                        <li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-onboarding.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Onboarding</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="apps-tas.html" class="sidebar-nav-link">
                            <i class="fas fa-puzzle-piece"></i>
                            <span>Apps & TAs</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="custom-log-onboarding.html" class="sidebar-nav-link active">
                            <i class="fas fa-plus-circle"></i>
                            <span>Custom Log Onboarding</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-filter"></i>
                            <span>Parsing & Props/Transforms</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-archive"></i>
                            <span>Index & Retention</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>SPL Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-rocket"></i>
                            <span>SPL Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="es-overview.html" class="sidebar-nav-link">
                            <i class="fas fa-shield-alt"></i>
                            <span>Enterprise Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="correlation-searches.html" class="sidebar-nav-link">
                            <i class="fas fa-search"></i>
                            <span>Correlation Searches</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="notable-events.html" class="sidebar-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Notable Events</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="risk-based-alerting.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Risk-Based Alerting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-skull-crossbones"></i>
                            <span>Threat Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soar.html" class="sidebar-nav-link">
                            <i class="fas fa-robot"></i>
                            <span>SOAR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="dashboards.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-line"></i>
                            <span>Dashboards</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="administration.html" class="sidebar-nav-link">
                            <i class="fas fa-cog"></i>
                            <span>Administration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="troubleshooting.html" class="sidebar-nav-link">
                            <i class="fas fa-tools"></i>
                            <span>Troubleshooting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-scenarios.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Enterprise Scenarios</span>
                        </a>
                    </li>
<li class="sidebar-nav-item">
                        <a href="data-ingestion.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Ingestion</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-models.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Models</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-scenarios.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Enterprise Scenarios</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-security.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Enterprise Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="es-overview.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Es Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="forwarders.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Forwarders</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="notable-events.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-circle"></i>
                            <span>Notable Events</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Parsing Flows</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Retention Tiers</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="risk-based-alerting.html" class="sidebar-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Risk Based Alerting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="security-usecases.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Security Usecases</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soar.html" class="sidebar-nav-link">
                            <i class="fas fa-robot"></i>
                            <span>Soar</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>Spl Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Spl Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-intermediate.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Spl Intermediate</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-hunting.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Hunting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Intel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="troubleshooting.html" class="sidebar-nav-link">
                            <i class="fas fa-wrench"></i>
                            <span>Troubleshooting</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Custom Log Onboarding</span>
                </div>

                <h1><i class="fas fa-file-import"></i> Custom Log Source Onboarding - Complete Guide</h1>
                <p class="lead">The definitive guide to onboarding any custom log source into Splunk. Covers every step from planning through field extraction, CIM mapping, and detection rules.</p>

                <div class="info-box" style="border-color: #3fb950;">
                    <h4><i class="fas fa-bookmark"></i> What This Guide Covers</h4>
                    <p>This guide walks through onboarding a <strong>custom application log</strong> that isn't natively supported. By the end, you'll have:</p>
                    <ul style="color: #8b949e; margin-top: 8px;">
                        <li>Log data flowing into Splunk via forwarder or HEC</li>
                        <li>Custom sourcetype with field extractions</li>
                        <li>CIM-compliant data model mapping</li>
                        <li>Working correlation searches</li>
                    </ul>
                </div>

                <!-- TABLE OF CONTENTS -->
                <div class="config-section">
                    <h3><i class="fas fa-list"></i> Table of Contents</h3>
                    <ol style="color: #8b949e; line-height: 2;">
                        <li><a href="#phase1" style="color: #3fb950;">Phase 1: Planning & Prerequisites</a></li>
                        <li><a href="#phase2" style="color: #3fb950;">Phase 2: Choose Ingestion Method</a></li>
                        <li><a href="#phase3" style="color: #3fb950;">Phase 3: Configure Data Input</a></li>
                        <li><a href="#phase4" style="color: #3fb950;">Phase 4: Create Sourcetype & Props</a></li>
                        <li><a href="#phase5" style="color: #3fb950;">Phase 5: Field Extractions</a></li>
                        <li><a href="#phase6" style="color: #3fb950;">Phase 6: CIM Mapping</a></li>
                        <li><a href="#phase7" style="color: #3fb950;">Phase 7: Verify & Test</a></li>
                        <li><a href="#phase8" style="color: #3fb950;">Phase 8: Create Detections</a></li>
                        <li><a href="#examples" style="color: #3fb950;">Complete Examples</a></li>
                    </ol>
                </div>

                <!-- PHASE 1 -->
                <div class="phase-header" id="phase1">
                    <span class="phase-num">PHASE 1</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Planning & Prerequisites</span>
                </div>

                <h3>1.1 Gather Log Source Information</h3>
                <table class="styled-table">
                    <thead>
                        <tr><th>Information</th><th>Why Needed</th><th>Example</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><strong>Log format</strong></td><td>Determines parsing approach</td><td>JSON, syslog, CSV, custom</td></tr>
                        <tr><td><strong>Log location</strong></td><td>Input configuration</td><td>/var/log/myapp/*.log</td></tr>
                        <tr><td><strong>Volume estimate</strong></td><td>Licensing, indexer sizing</td><td>~500 MB/day</td></tr>
                        <tr><td><strong>Sample logs (20+)</strong></td><td>Build field extractions</td><td>Export from source</td></tr>
                        <tr><td><strong>Field documentation</strong></td><td>Understand data meaning</td><td>Vendor docs</td></tr>
                        <tr><td><strong>Retention requirement</strong></td><td>Index configuration</td><td>90 days hot, 1 year total</td></tr>
                    </tbody>
                </table>

                <h3>1.2 Analyze Log Format</h3>
                <div class="config-section">
                    <h4>Example: JSON Logs</h4>
                    <div class="example-log">{"timestamp":"2024-02-15T14:30:00Z","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success"}</div>
                    <p style="color: #3fb950;">✓ JSON - Use INDEXED_EXTRACTIONS or spath</p>

                    <h4>Example: Key-Value Syslog</h4>
                    <div class="example-log">Feb 15 14:30:00 app-server myapp: USER=jsmith ACTION=login SRC=10.0.1.50 RESULT=success</div>
                    <p style="color: #d29922;">△ Key-Value - Use KV_MODE or regex</p>

                    <h4>Example: Delimited</h4>
                    <div class="example-log">2024-02-15T14:30:00|INFO|jsmith|login|10.0.1.50|success</div>
                    <p style="color: #d29922;">△ Pipe-delimited - Use DELIMS or regex</p>
                </div>

                <!-- PHASE 2 -->
                <div class="phase-header" id="phase2">
                    <span class="phase-num">PHASE 2</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Choose Ingestion Method</span>
                </div>

                <div class="config-section" style="border: 2px solid #d29922;">
                    <h3><i class="fas fa-question-circle" style="color: #d29922;"></i> Decision Tree</h3>
                    <p><strong>Q1: Where is the log data?</strong></p>
                    <p style="margin-left: 20px;">→ <strong>On a server/endpoint:</strong> Universal Forwarder (most common)</p>
                    <p style="margin-left: 20px;">→ <strong>In a cloud service with API:</strong> HTTP Event Collector (HEC)</p>
                    <p style="margin-left: 20px;">→ <strong>Network device (syslog):</strong> Syslog input on Heavy Forwarder</p>
                    <p style="margin-left: 20px;">→ <strong>Database:</strong> DB Connect app</p>
                </div>

                <table class="styled-table">
                    <thead>
                        <tr><th>Method</th><th>Best For</th><th>Config Location</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><strong>Universal Forwarder</strong></td><td>File-based logs on servers</td><td>inputs.conf on forwarder</td></tr>
                        <tr><td><strong>Heavy Forwarder</strong></td><td>Syslog, parsing at edge</td><td>inputs.conf + props.conf on HF</td></tr>
                        <tr><td><strong>HEC</strong></td><td>API/webhook, cloud apps</td><td>Settings → Data Inputs → HTTP Event Collector</td></tr>
                        <tr><td><strong>Scripted Input</strong></td><td>Custom API polling</td><td>inputs.conf with script</td></tr>
                    </tbody>
                </table>

                <!-- PHASE 3 -->
                <div class="phase-header" id="phase3">
                    <span class="phase-num">PHASE 3</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Configure Data Input</span>
                </div>

                <h3>3A. Universal Forwarder (File Monitor)</h3>
                <div class="config-section">
                    <p><strong>File Location:</strong> <span class="file-path">$SPLUNK_HOME/etc/apps/myapp_inputs/local/inputs.conf</span></p>
                    
                    <div class="arch-diagram"># inputs.conf - Monitor log files

[monitor:///var/log/myapp/application.log]
disabled = false
index = myapp
sourcetype = myapp:application
# Optional settings:
# host_segment = 3
# whitelist = \.log$
# ignoreOlderThan = 7d
# crcSalt = <SOURCE>

[monitor:///var/log/myapp/auth.log]
disabled = false
index = myapp
sourcetype = myapp:auth</div>

                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div><strong>Create app directory on forwarder:</strong>
                            <div class="arch-diagram">mkdir -p $SPLUNK_HOME/etc/apps/myapp_inputs/local</div>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div><strong>Create inputs.conf</strong> (as shown above)</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div><strong>Restart forwarder:</strong>
                            <div class="arch-diagram">$SPLUNK_HOME/bin/splunk restart</div>
                        </div>
                    </div>
                </div>

                <h3>3B. HTTP Event Collector (HEC)</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Inputs → HTTP Event Collector → New Token</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div><strong>Enable HEC globally:</strong> Settings → Data Inputs → HTTP Event Collector → Global Settings → Enable</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div><strong>Create token:</strong>
                            <table style="color: #8b949e; font-size: 0.9rem; width: 100%;">
                                <tr><td>Name:</td><td>myapp-hec-token</td></tr>
                                <tr><td>Source type:</td><td>Select → myapp:application</td></tr>
                                <tr><td>Index:</td><td>myapp</td></tr>
                                <tr><td>Enable indexer acknowledgment:</td><td>Yes (for guaranteed delivery)</td></tr>
                            </table>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div><strong>Send data via HEC:</strong>
                            <div class="arch-diagram">curl -k "https://splunk-hec.company.com:8088/services/collector/event" \
  -H "Authorization: Splunk YOUR-HEC-TOKEN" \
  -d '{"event": {"user": "jsmith", "action": "login"}, "sourcetype": "myapp:application", "index": "myapp"}'</div>
                        </div>
                    </div>
                </div>

                <h3>3C. Syslog Input (Heavy Forwarder)</h3>
                <div class="config-section">
                    <p><strong>File Location:</strong> <span class="file-path">$SPLUNK_HOME/etc/apps/myapp_inputs/local/inputs.conf</span></p>
                    
                    <div class="arch-diagram"># inputs.conf - Syslog listener on Heavy Forwarder

[udp://514]
connection_host = ip
sourcetype = syslog

[tcp://514]
connection_host = ip
sourcetype = syslog

# For dedicated port per source:
[tcp://1514]
connection_host = ip
sourcetype = myapp:syslog
index = myapp</div>
                </div>

                <!-- PHASE 4 -->
                <div class="phase-header" id="phase4">
                    <span class="phase-num">PHASE 4</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Create Sourcetype & Props</span>
                </div>

                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-info-circle"></i> What is a Sourcetype?</h4>
                    <p>A <strong>sourcetype</strong> is Splunk's way of identifying a data format. It determines how data is:</p>
                    <ul style="color: #8b949e;">
                        <li>Parsed into events (line breaking, timestamp extraction)</li>
                        <li>Field extracted (transforms, regex)</li>
                        <li>Displayed in search results</li>
                    </ul>
                </div>

                <h3>4.1 Create props.conf</h3>
                <div class="config-section">
                    <p><strong>File Location:</strong> <span class="file-path">$SPLUNK_HOME/etc/apps/myapp_TA/local/props.conf</span></p>
                    
                    <h4>For JSON Logs:</h4>
                    <div class="arch-diagram">[myapp:application]
DATETIME_CONFIG = 
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
TIME_PREFIX = "timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 32
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 10000
KV_MODE = json
# Or for deeper JSON: 
# INDEXED_EXTRACTIONS = json</div>

                    <h4>For Syslog Key-Value:</h4>
                    <div class="arch-diagram">[myapp:syslog]
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 32
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = auto
# Custom extractions in transforms.conf</div>

                    <h4>For Multiline Logs (e.g., Java stack traces):</h4>
                    <div class="arch-diagram">[myapp:application]
TIME_FORMAT = %Y-%m-%d %H:%M:%S
SHOULD_LINEMERGE = true
LINE_BREAKER = ([\r\n]+)\d{4}-\d{2}-\d{2}
BREAK_ONLY_BEFORE = ^\d{4}-\d{2}-\d{2}
MUST_BREAK_AFTER = 
MAX_EVENTS = 256</div>
                </div>

                <!-- PHASE 5 -->
                <div class="phase-header" id="phase5">
                    <span class="phase-num">PHASE 5</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Field Extractions</span>
                </div>

                <h3>5.1 Automatic Extractions (KV_MODE)</h3>
                <div class="config-section">
                    <p>For simple key=value or JSON, props.conf handles extraction:</p>
                    <div class="arch-diagram"># props.conf
[myapp:application]
KV_MODE = json       # For JSON logs
# KV_MODE = auto     # For key=value pairs</div>
                </div>

                <h3>5.2 Regex Extractions (transforms.conf)</h3>
                <div class="config-section">
                    <p><strong>File:</strong> <span class="file-path">$SPLUNK_HOME/etc/apps/myapp_TA/local/transforms.conf</span></p>
                    
                    <div class="arch-diagram"># transforms.conf

[myapp_extract_user]
REGEX = USER=(?<user>\S+)
FORMAT = user::$1

[myapp_extract_action]
REGEX = ACTION=(?<action>\S+)
FORMAT = action::$1

[myapp_extract_src_ip]
REGEX = SRC=(?<src_ip>\d+\.\d+\.\d+\.\d+)
FORMAT = src_ip::$1

[myapp_extract_result]
REGEX = RESULT=(?<result>\w+)
FORMAT = result::$1</div>

                    <p>Reference in props.conf:</p>
                    <div class="arch-diagram"># props.conf
[myapp:syslog]
REPORT-user = myapp_extract_user
REPORT-action = myapp_extract_action
REPORT-src_ip = myapp_extract_src_ip
REPORT-result = myapp_extract_result</div>
                </div>

                <h3>5.3 Field Extraction via UI</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Fields → Field Extractions → New Field Extraction</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>Search for sample events: <code>index=myapp sourcetype=myapp:application</code></div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>Click event → Extract Fields → Select extraction method (Regex or Delimiter)</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>Highlight values to extract, name fields, validate against other events</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div>Save to appropriate app (creates transforms.conf automatically)</div>
                    </div>
                </div>

                <!-- PHASE 6 -->
                <div class="phase-header" id="phase6">
                    <span class="phase-num">PHASE 6</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">CIM Mapping (For Enterprise Security)</span>
                </div>

                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-info-circle"></i> Why CIM Mapping?</h4>
                    <p>The <strong>Common Information Model (CIM)</strong> normalizes field names across data sources. Required for:</p>
                    <ul style="color: #8b949e;">
                        <li>Enterprise Security correlation searches</li>
                        <li>Cross-source searches (correlate firewall + endpoint + app logs)</li>
                        <li>Out-of-box dashboards and reports</li>
                    </ul>
                </div>

                <h3>6.1 Create Field Aliases</h3>
                <div class="config-section">
                    <p><strong>File:</strong> <span class="file-path">props.conf</span></p>
                    
                    <div class="arch-diagram"># props.conf - CIM field aliases for Authentication data model
[myapp:auth]
# Map your fields to CIM fields
FIELDALIAS-user = user AS user
FIELDALIAS-src = src_ip AS src
FIELDALIAS-action = action AS action
FIELDALIAS-app = sourcetype AS app

# Calculated field for CIM
EVAL-vendor_product = "MyApp"
EVAL-action = case(result=="success", "success", result=="failure", "failure", true(), "unknown")</div>
                </div>

                <h3>6.2 Add to Data Model</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Models → Authentication → Edit → Add Dataset</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>Open Authentication data model</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>Add Dataset → Root Event → Constraint: <code>sourcetype=myapp:auth</code></div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>Map fields to CIM schema (user, src, dest, action, etc.)</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div>Save and rebuild data model acceleration</div>
                    </div>
                </div>

                <h3>6.3 Common CIM Data Models</h3>
                <table class="styled-table">
                    <thead>
                        <tr><th>Data Model</th><th>Use For</th><th>Key CIM Fields</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>Authentication</td><td>Logins, auth events</td><td>user, src, dest, action, app</td></tr>
                        <tr><td>Network Traffic</td><td>Firewall, flow data</td><td>src_ip, dest_ip, dest_port, bytes</td></tr>
                        <tr><td>Endpoint</td><td>Process, file events</td><td>process, process_path, user, dest</td></tr>
                        <tr><td>Web</td><td>Proxy, web server logs</td><td>url, http_method, status, src</td></tr>
                        <tr><td>Malware</td><td>AV, EDR alerts</td><td>signature, file_path, action, user</td></tr>
                    </tbody>
                </table>

                <!-- PHASE 7 -->
                <div class="phase-header" id="phase7">
                    <span class="phase-num">PHASE 7</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Verify & Test</span>
                </div>

                <h3>7.1 Verify Data Ingestion</h3>
                <div class="config-section">
                    <div class="arch-diagram"># Check data is arriving
index=myapp sourcetype=myapp:application earliest=-1h
| stats count by host, sourcetype

# Verify field extractions
index=myapp sourcetype=myapp:application earliest=-1h
| table _time user action src_ip result

# Check for parsing errors
index=_internal sourcetype=splunkd component=LineBreakingProcessor
| search myapp
| stats count by log_level</div>
                </div>

                <h3>7.2 Verify CIM Compliance</h3>
                <div class="config-section">
                    <div class="arch-diagram"># Test CIM mapping with data model
| datamodel Authentication Successful_Authentication search
| search sourcetype=myapp:auth
| table _time user src action app

# Validate required fields exist
index=myapp sourcetype=myapp:auth
| stats count by user, src, action
| where isnull(user) OR isnull(src) OR isnull(action)</div>
                </div>

                <!-- PHASE 8 -->
                <div class="phase-header" id="phase8">
                    <span class="phase-num">PHASE 8</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Create Detection Rules</span>
                </div>

                <h3>8.1 Correlation Search Examples</h3>
                <div class="config-section">
                    <div class="console-path">Enterprise Security → Configure → Content → Content Management → Create New Content → Correlation Search</div>
                    
                    <h4>Brute Force Detection:</h4>
                    <div class="arch-diagram">| tstats summariesonly=true count from datamodel=Authentication.Failed_Authentication 
  where nodename=Authentication.Failed_Authentication sourcetype=myapp:auth
  by _time, Authentication.user, Authentication.src span=5m
| rename Authentication.* AS *
| where count > 10
| eval rule_name="MyApp Brute Force"</div>

                    <h4>Login from New Location:</h4>
                    <div class="arch-diagram">| tstats summariesonly=true values(Authentication.src) as current_src 
  from datamodel=Authentication.Successful_Authentication 
  where sourcetype=myapp:auth earliest=-1h
  by Authentication.user
| join Authentication.user [
    | tstats summariesonly=true values(Authentication.src) as historical_src 
      from datamodel=Authentication.Successful_Authentication 
      where sourcetype=myapp:auth earliest=-30d latest=-1h
      by Authentication.user
  ]
| eval new_src=mvfilter(NOT match(current_src, historical_src))
| where isnotnull(new_src)</div>
                </div>

                <!-- COMPLETE EXAMPLE -->
                <div class="phase-header" id="examples">
                    <span class="phase-num">EXAMPLE</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Complete End-to-End: Java Application</span>
                </div>

                <div class="config-section">
                    <h4>Sample Log:</h4>
                    <div class="example-log">{"@timestamp":"2024-02-15T14:30:00.123Z","level":"INFO","logger":"AuthService","user_id":"jsmith","client_ip":"10.0.1.50","action":"LOGIN","result":"SUCCESS","session_id":"sess-abc123"}</div>

                    <h4>1. inputs.conf (on Universal Forwarder):</h4>
                    <div class="arch-diagram">[monitor:///var/log/javaapp/auth.log]
disabled = false
index = javaapp
sourcetype = javaapp:auth</div>

                    <h4>2. props.conf (on Indexer or via app):</h4>
                    <div class="arch-diagram">[javaapp:auth]
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N%Z
TIME_PREFIX = "@timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 35
SHOULD_LINEMERGE = false
KV_MODE = json

# CIM field aliases
FIELDALIAS-user = user_id AS user
FIELDALIAS-src = client_ip AS src
EVAL-vendor_product = "JavaApp AuthService"
EVAL-action = lower(action)
EVAL-app = "javaapp"</div>

                    <h4>3. Verification:</h4>
                    <div class="arch-diagram">index=javaapp sourcetype=javaapp:auth
| table _time user src action result session_id</div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through onboarding a custom log source in Splunk.</button>
                        <div class="qa-answer">
                            <p><strong>Complete process:</strong></p>
                            <ol>
                                <li><strong>Planning:</strong> Gather sample logs, identify format (JSON, syslog, delimited), estimate volume</li>
                                <li><strong>Ingestion:</strong> Choose method - Universal Forwarder for files, HEC for API/webhook, Heavy Forwarder for syslog</li>
                                <li><strong>Configure input:</strong> Create inputs.conf with monitor stanza, set index and sourcetype</li>
                                <li><strong>Create sourcetype:</strong> props.conf defines timestamp extraction, line breaking, KV_MODE</li>
                                <li><strong>Field extraction:</strong> For complex formats, use transforms.conf with regex; reference via REPORT- in props.conf</li>
                                <li><strong>CIM mapping:</strong> Add FIELDALIAS and EVAL statements to map to CIM fields</li>
                                <li><strong>Verify:</strong> Search the data, check field extractions work</li>
                                <li><strong>Detection:</strong> Create correlation searches using the data model</li>
                            </ol>
                            <p><strong>Key files:</strong> inputs.conf (what to collect), props.conf (how to parse), transforms.conf (field extraction)</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between KV_MODE, REPORT, and EXTRACT in props.conf?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>KV_MODE:</strong> Automatic extraction for simple formats. Options: json, auto (key=value), none</li>
                                <li><strong>REPORT-fieldname:</strong> References a transform in transforms.conf. Used for complex regex extractions. Search-time extraction.</li>
                                <li><strong>EXTRACT-fieldname:</strong> Inline regex directly in props.conf. Simpler but less reusable. Search-time extraction.</li>
                            </ul>
                            <p><strong>Best practice:</strong> Use KV_MODE=json for JSON logs. Use REPORT with transforms.conf for complex formats (more maintainable, reusable).</p>
                        </div>
                    </div>
                </div>
                <!-- Extended Interview Questions -->
                <h2><i class="fas fa-question-circle"></i> Additional Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you approach troubleshooting in this area?</button>
                        <div class="qa-answer">
                            <p><strong>Systematic troubleshooting approach:</strong></p>
                            <ol>
                                <li><strong>Identify the symptom:</strong> What exactly is not working as expected?</li>
                                <li><strong>Check connectivity:</strong> Verify network paths and authentication</li>
                                <li><strong>Review logs:</strong> Check internal/audit logs for errors</li>
                                <li><strong>Validate configuration:</strong> Compare against documented standards</li>
                                <li><strong>Test incrementally:</strong> Isolate the problem component</li>
                                <li><strong>Document findings:</strong> Record what worked and what didn't</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What metrics would you track for this area?</button>
                        <div class="qa-answer">
                            <p><strong>Key performance indicators:</strong></p>
                            <ul>
                                <li><strong>Availability:</strong> Uptime percentage, service availability</li>
                                <li><strong>Performance:</strong> Query response time, processing latency</li>
                                <li><strong>Volume:</strong> Events per second, data ingestion rate</li>
                                <li><strong>Quality:</strong> Parse success rate, enrichment coverage</li>
                                <li><strong>Efficiency:</strong> Resource utilization, cost per GB</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you ensure high availability?</button>
                        <div class="qa-answer">
                            <p><strong>High availability strategies:</strong></p>
                            <ul>
                                <li><strong>Redundancy:</strong> Multiple instances of critical components</li>
                                <li><strong>Load balancing:</strong> Distribute traffic across instances</li>
                                <li><strong>Failover:</strong> Automatic switchover on failure</li>
                                <li><strong>Monitoring:</strong> Health checks and alerting</li>
                                <li><strong>DR Planning:</strong> Documented recovery procedures</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Best Practices -->
                <h2><i class="fas fa-star"></i> Best Practices</h2>
                <div class="config-section">
                    <!-- Troubleshooting Guide -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting Guide</h2>
                <div class="config-section">
                    <h4>Common Issues and Solutions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Issue</th><th>Possible Cause</th><th>Solution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Data not appearing</td>
                                <td>Collection or parsing issue</td>
                                <td>Check collector status, verify parser configuration</td>
                            </tr>
                            <tr>
                                <td>Slow performance</td>
                                <td>Resource constraints or inefficient queries</td>
                                <td>Review resource utilization, optimize queries</td>
                            </tr>
                            <tr>
                                <td>Authentication failures</td>
                                <td>Credential or permission issues</td>
                                <td>Verify credentials, check RBAC configuration</td>
                            </tr>
                            <tr>
                                <td>Missing fields</td>
                                <td>Parser not extracting fields</td>
                                <td>Review parsing rules, update field extraction</td>
                            </tr>
                            <tr>
                                <td>Duplicate events</td>
                                <td>Multiple collection paths</td>
                                <td>Audit data sources, implement deduplication</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Diagnostic Steps</h4>
                    <ol style="color: #8b949e;">
                        <li><strong>Check Status:</strong> Verify component health in console</li>
                        <li><strong>Review Logs:</strong> Examine internal logs for errors</li>
                        <li><strong>Test Connectivity:</strong> Verify network paths and authentication</li>
                        <li><strong>Validate Config:</strong> Compare configuration against documentation</li>
                        <li><strong>Isolate Issue:</strong> Narrow down to specific component</li>
                        <li><strong>Escalate:</strong> Contact support if needed with diagnostics</li>
                    </ol>
                </div>

                <!-- Use Cases -->
                <h2><i class="fas fa-briefcase"></i> Real-World Use Cases</h2>
                <div class="config-section">
                    <h4>Use Case 1: Enterprise SOC</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Large enterprise with 20,000 endpoints, multiple cloud environments</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Centralized collection from all security data sources</li>
                            <li>Custom detection rules aligned to threat model</li>
                            <li>Automated response playbooks for common scenarios</li>
                            <li>Integration with ticketing and CMDB systems</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> 60% reduction in MTTR, improved threat visibility</p>
                    </div>

                    <h4>Use Case 2: MSSP Operations</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Managed security provider serving 50 customers</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Multi-tenant architecture with customer isolation</li>
                            <li>Standardized detection content across customers</li>
                            <li>Centralized analyst workflow and reporting</li>
                            <li>SLA-driven prioritization and escalation</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> Efficient operations at scale, consistent service delivery</p>
                    </div>

                    <h4>Use Case 3: Compliance-Focused</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Healthcare organization with HIPAA requirements</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Comprehensive audit logging for PHI access</li>
                            <li>Long-term retention for compliance evidence</li>
                            <li>Pre-built compliance dashboards and reports</li>
                            <li>Automated compliance violation detection</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> Audit-ready documentation, reduced compliance risk</p>
                    </div>
                </div>

                <!-- Quick Reference -->
                <h2><i class="fas fa-bookmark"></i> Quick Reference</h2>
                <div class="config-section">
                    <h4>Common Commands/Queries</h4>
                    <div class="arch-diagram"># Basic health check query
# Adjust syntax for your platform (XQL/SPL/KQL)

# Check data ingestion rate
| stats count by _time span=1h

# Find recent errors
| filter severity = "error" 
| sort _time desc 
| limit 100

# Top sources by volume
| stats sum(bytes) as total_bytes by source
| sort total_bytes desc
| limit 10

# Detection rule effectiveness
| filter alert_type = "detection"
| stats count by rule_name, disposition
| sort count desc</div>

                    <h4>Key Configuration Files/Paths</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Purpose</th><th>Location/Path</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Main Configuration</td><td>Settings → Configuration</td></tr>
                            <tr><td>Data Sources</td><td>Settings → Data Sources</td></tr>
                            <tr><td>Detection Rules</td><td>Detection → Rules</td></tr>
                            <tr><td>User Management</td><td>Settings → Access Management</td></tr>
                            <tr><td>Audit Logs</td><td>Settings → Audit Trail</td></tr>
                        </tbody>
                    </table>

                    <h4>Important Thresholds</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Metric</th><th>Warning</th><th>Critical</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Query Response Time</td><td>> 30 seconds</td><td>> 120 seconds</td></tr>
                            <tr><td>Ingestion Latency</td><td>> 5 minutes</td><td>> 15 minutes</td></tr>
                            <tr><td>Storage Utilization</td><td>> 70%</td><td>> 85%</td></tr>
                            <tr><td>Error Rate</td><td>> 1%</td><td>> 5%</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Related Topics -->
                <h2><i class="fas fa-link"></i> Related Topics</h2>
                <div class="config-section">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-book" style="color: #58a6ff;"></i> Documentation</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>Official vendor documentation</li>
                                <li>API reference guides</li>
                                <li>Release notes</li>
                            </ul>
                        </div>
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-users" style="color: #58a6ff;"></i> Community</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>User forums</li>
                                <li>Community Slack/Discord</li>
                                <li>Blog posts and articles</li>
                            </ul>
                        </div>
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-graduation-cap" style="color: #58a6ff;"></i> Training</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>Vendor certifications</li>
                                <li>Online courses</li>
                                <li>Hands-on labs</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
</main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>