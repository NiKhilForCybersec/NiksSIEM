<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Log Source Onboarding - Complete Guide | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">

    <style>
        /* Decision Tree Styles */
        .decision-tree {
            padding: 20px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            margin: 20px 0;
        }
        .decision-node {
            background: #21262d;
            border: 2px solid #30363d;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 10px auto;
            max-width: 400px;
            text-align: center;
        }
        .decision-node h4 {
            color: #e6edf3;
            margin: 0 0 5px 0;
            font-size: 14px;
        }
        .decision-node small {
            color: #8b949e;
            font-size: 12px;
        }
        .decision-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 20px;
            margin: 5px 0;
        }
        .decision-branches {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        .decision-branch {
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 15px;
            min-width: 200px;
            max-width: 300px;
        }
        .decision-branch.yes { border-color: #238636; }
        .decision-branch.no { border-color: #f85149; }
        .branch-label {
            display: block;
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            color: #8b949e;
            font-size: 12px;
        }
        .decision-outcome {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            color: white;
        }
        .decision-outcome i {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }
        .decision-outcome strong {
            display: block;
            margin-bottom: 5px;
        }
        .decision-outcome small {
            opacity: 0.9;
            font-size: 11px;
        }

        /* Flow Diagram Styles */
        .flow-diagram {
            padding: 20px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            margin: 20px 0;
        }
        .flow-step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            background: #21262d;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #58a6ff;
        }
        .flow-icon {
            width: 40px;
            height: 40px;
            background: rgba(88, 166, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #58a6ff;
            flex-shrink: 0;
        }
        .flow-content h4 {
            margin: 0 0 10px 0;
            color: #e6edf3;
            font-size: 14px;
        }
        .flow-content ul {
            margin: 0;
            padding-left: 20px;
            color: #8b949e;
        }
        .flow-content li {
            margin: 5px 0;
            font-size: 13px;
        }
        .flow-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 20px;
            margin: 5px 0;
        }

        /* Enhanced Gap Cards */
        .enterprise-gap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .gap-card {
            background: #21262d;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #30363d;
        }
        .gap-card h4 {
            margin: 0 0 15px 0;
            font-size: 16px;
        }
        .gap-card ul {
            margin: 0;
            padding-left: 20px;
        }
        .gap-card li {
            margin: 8px 0;
            color: #8b949e;
            font-size: 13px;
        }
        .gap-card li strong {
            color: #e6edf3;
        }
        .gap-critical { border-left: 4px solid #f85149; }
        .gap-warning { border-left: 4px solid #d29922; }
        .gap-info { border-left: 4px solid #58a6ff; }
        .gap-best-practice { border-left: 4px solid #238636; }

        /* Quick Reference Cards */
        .quick-ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .quick-ref-card {
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .quick-ref-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        .quick-ref-card h4 {
            color: #58a6ff;
            margin: 0 0 10px 0;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .quick-ref-card p {
            color: #8b949e;
            margin: 0;
            font-size: 13px;
            line-height: 1.5;
        }
    </style>

</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="apps-tas.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Apps & TAs</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-paper-plane"></i><span>Forwarders</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Props/Transforms</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Index & Retention</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>SPL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>SPL Intermediate</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>SPL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i><span>Data Models & CIM</span></a></li>
                    <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>Knowledge Objects</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>Enterprise Security</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Searches</span></a></li>
                    <li class="sidebar-nav-item"><a href="notable-events.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Notable Events</span></a></li>
                    <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-exclamation-triangle"></i><span>Risk-Based Alerting</span></a></li>
                    <li class="sidebar-nav-item"><a href="alerting-actions.html" class="sidebar-nav-link"><i class="fas fa-bolt"></i><span>Alerting & Actions</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Security Use Cases -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Security Use Cases</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="security-usecases.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Detection Use Cases</span></a></li>
                    <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise Scenarios</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="soar.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>SOAR</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intelligence</span></a></li>
                </ul>
            </div>
            
            <!-- Operations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="performance-tuning.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>Performance Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="monitoring-console.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Monitoring Console</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="administration.html" class="sidebar-nav-link"><i class="fas fa-cog"></i><span>Administration</span></a></li>
                    <li class="sidebar-nav-item"><a href="security-rbac.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>Security & RBAC</span></a></li>
                    <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Clustering & HA</span></a></li>
                </ul>
            </div>
            
            <!-- Deployment -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Deployment</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Splunk Cloud</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Custom Log Onboarding</span>
                </div>

                <h1><i class="fas fa-file-import"></i> Custom Log Source Onboarding - Complete Guide</h1>
                <p class="lead">The definitive guide to onboarding any custom log source into Splunk. Covers every step from planning through field extraction, CIM mapping, and detection rules.</p>

                <div class="info-box" style="border-color: #3fb950;">
                    <h4><i class="fas fa-bookmark"></i> What This Guide Covers</h4>
                    <p>This guide walks through onboarding a <strong>custom application log</strong> that isn't natively supported. By the end, you'll have:</p>
                    <ul style="color: #8b949e; margin-top: 8px;">
                        <li>Log data flowing into Splunk via forwarder or HEC</li>
                        <li>Custom sourcetype with field extractions</li>
                        <li>CIM-compliant data model mapping</li>
                        <li>Working correlation searches</li>
                    </ul>
                </div>

                <!-- TABLE OF CONTENTS -->
                <div class="config-section">
                    <h3><i class="fas fa-list"></i> Table of Contents</h3>
                    <ol style="color: #8b949e; line-height: 2;">
                        <li><a href="#phase1" style="color: #3fb950;">Phase 1: Planning & Prerequisites</a></li>
                        <li><a href="#phase2" style="color: #3fb950;">Phase 2: Choose Ingestion Method</a></li>
                        <li><a href="#phase3" style="color: #3fb950;">Phase 3: Configure Data Input</a></li>
                        <li><a href="#phase4" style="color: #3fb950;">Phase 4: Create Sourcetype & Props</a></li>
                        <li><a href="#phase5" style="color: #3fb950;">Phase 5: Field Extractions</a></li>
                        <li><a href="#phase6" style="color: #3fb950;">Phase 6: CIM Mapping</a></li>
                        <li><a href="#phase7" style="color: #3fb950;">Phase 7: Verify & Test</a></li>
                        <li><a href="#phase8" style="color: #3fb950;">Phase 8: Create Detections</a></li>
                        <li><a href="#examples" style="color: #3fb950;">Complete Examples</a></li>
                    </ol>
                </div>

                <!-- PHASE 1 -->
                <div class="phase-header" id="phase1">
                    <span class="phase-num">PHASE 1</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Planning & Prerequisites</span>
                </div>

                <h3>1.1 Gather Log Source Information</h3>
                <table class="styled-table">
                    <thead>
                        <tr><th>Information</th><th>Why Needed</th><th>Example</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><strong>Log format</strong></td><td>Determines parsing approach</td><td>JSON, syslog, CSV, custom</td></tr>
                        <tr><td><strong>Log location</strong></td><td>Input configuration</td><td>/var/log/myapp/*.log</td></tr>
                        <tr><td><strong>Volume estimate</strong></td><td>Licensing, indexer sizing</td><td>~500 MB/day</td></tr>
                        <tr><td><strong>Sample logs (20+)</strong></td><td>Build field extractions</td><td>Export from source</td></tr>
                        <tr><td><strong>Field documentation</strong></td><td>Understand data meaning</td><td>Vendor docs</td></tr>
                        <tr><td><strong>Retention requirement</strong></td><td>Index configuration</td><td>90 days hot, 1 year total</td></tr>
                    </tbody>
                </table>

                <h3>1.2 Analyze Log Format</h3>
                <div class="config-section">
                    <h4>Example: JSON Logs</h4>
                    <div class="example-log">{"timestamp":"2024-02-15T14:30:00Z","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success"}</div>
                    <p style="color: #3fb950;">âœ“ JSON - Use INDEXED_EXTRACTIONS or spath</p>

                    <h4>Example: Key-Value Syslog</h4>
                    <div class="example-log">Feb 15 14:30:00 app-server myapp: USER=jsmith ACTION=login SRC=10.0.1.50 RESULT=success</div>
                    <p style="color: #d29922;">â–³ Key-Value - Use KV_MODE or regex</p>

                    <h4>Example: Delimited</h4>
                    <div class="example-log">2024-02-15T14:30:00|INFO|jsmith|login|10.0.1.50|success</div>
                    <p style="color: #d29922;">â–³ Pipe-delimited - Use DELIMS or regex</p>
                </div>

                <!-- PHASE 2 -->
                <div class="phase-header" id="phase2">
                    <span class="phase-num">PHASE 2</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Choose Ingestion Method</span>
                </div>

                <div class="config-section" style="border: 2px solid #d29922;">
                    <h3><i class="fas fa-question-circle" style="color: #d29922;"></i> Decision Tree</h3>
                    <p><strong>Q1: Where is the log data?</strong></p>
                    <p style="margin-left: 20px;">â†’ <strong>On a server/endpoint:</strong> Universal Forwarder (most common)</p>
                    <p style="margin-left: 20px;">â†’ <strong>In a cloud service with API:</strong> HTTP Event Collector (HEC)</p>
                    <p style="margin-left: 20px;">â†’ <strong>Network device (syslog):</strong> Syslog input on Heavy Forwarder</p>
                    <p style="margin-left: 20px;">â†’ <strong>Database:</strong> DB Connect app</p>
                </div>

                <table class="styled-table">
                    <thead>
                        <tr><th>Method</th><th>Best For</th><th>Config Location</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><strong>Universal Forwarder</strong></td><td>File-based logs on servers</td><td>inputs.conf on forwarder</td></tr>
                        <tr><td><strong>Heavy Forwarder</strong></td><td>Syslog, parsing at edge</td><td>inputs.conf + props.conf on HF</td></tr>
                        <tr><td><strong>HEC</strong></td><td>API/webhook, cloud apps</td><td>Settings â†’ Data Inputs â†’ HTTP Event Collector</td></tr>
                        <tr><td><strong>Scripted Input</strong></td><td>Custom API polling</td><td>inputs.conf with script</td></tr>
                    </tbody>
                </table>

                <!-- PHASE 3 -->
                <div class="phase-header" id="phase3">
                    <span class="phase-num">PHASE 3</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Configure Data Input</span>
                </div>

                <h3>3A. Universal Forwarder (File Monitor)</h3>
                <div class="config-section">
                    <p><strong>File Location:</strong> <span class="file-path">$SPLUNK_HOME/etc/apps/myapp_inputs/local/inputs.conf</span></p>
                    
                    <div class="arch-diagram"># inputs.conf - Monitor log files

[monitor:///var/log/myapp/application.log]
disabled = false
index = myapp
sourcetype = myapp:application
# Optional settings:
# host_segment = 3
# whitelist = \.log$
# ignoreOlderThan = 7d
# crcSalt = <SOURCE>

[monitor:///var/log/myapp/auth.log]
disabled = false
index = myapp
sourcetype = myapp:auth</div>

                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div><strong>Create app directory on forwarder:</strong>
                            <div class="arch-diagram">mkdir -p $SPLUNK_HOME/etc/apps/myapp_inputs/local</div>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div><strong>Create inputs.conf</strong> (as shown above)</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div><strong>Restart forwarder:</strong>
                            <div class="arch-diagram">$SPLUNK_HOME/bin/splunk restart</div>
                        </div>
                    </div>
                </div>

                <h3>3B. HTTP Event Collector (HEC)</h3>
                <div class="config-section">
                    <div class="console-path">Settings â†’ Data Inputs â†’ HTTP Event Collector â†’ New Token</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div><strong>Enable HEC globally:</strong> Settings â†’ Data Inputs â†’ HTTP Event Collector â†’ Global Settings â†’ Enable</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div><strong>Create token:</strong>
                            <table style="color: #8b949e; font-size: 0.9rem; width: 100%;">
                                <tr><td>Name:</td><td>myapp-hec-token</td></tr>
                                <tr><td>Source type:</td><td>Select â†’ myapp:application</td></tr>
                                <tr><td>Index:</td><td>myapp</td></tr>
                                <tr><td>Enable indexer acknowledgment:</td><td>Yes (for guaranteed delivery)</td></tr>
                            </table>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div><strong>Send data via HEC:</strong>
                            <div class="arch-diagram">curl -k "https://splunk-hec.company.com:8088/services/collector/event" \
  -H "Authorization: Splunk YOUR-HEC-TOKEN" \
  -d '{"event": {"user": "jsmith", "action": "login"}, "sourcetype": "myapp:application", "index": "myapp"}'</div>
                        </div>
                    </div>
                </div>

                <h3>3C. Syslog Input (Heavy Forwarder)</h3>
                <div class="config-section">
                    <p><strong>File Location:</strong> <span class="file-path">$SPLUNK_HOME/etc/apps/myapp_inputs/local/inputs.conf</span></p>
                    
                    <div class="arch-diagram"># inputs.conf - Syslog listener on Heavy Forwarder

[udp://514]
connection_host = ip
sourcetype = syslog

[tcp://514]
connection_host = ip
sourcetype = syslog

# For dedicated port per source:
[tcp://1514]
connection_host = ip
sourcetype = myapp:syslog
index = myapp</div>
                </div>

                <!-- PHASE 4 -->
                <div class="phase-header" id="phase4">
                    <span class="phase-num">PHASE 4</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Create Sourcetype & Props</span>
                </div>

                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-info-circle"></i> What is a Sourcetype?</h4>
                    <p>A <strong>sourcetype</strong> is Splunk's way of identifying a data format. It determines how data is:</p>
                    <ul style="color: #8b949e;">
                        <li>Parsed into events (line breaking, timestamp extraction)</li>
                        <li>Field extracted (transforms, regex)</li>
                        <li>Displayed in search results</li>
                    </ul>
                </div>

                <h3>4.1 Create props.conf</h3>
                <div class="config-section">
                    <p><strong>File Location:</strong> <span class="file-path">$SPLUNK_HOME/etc/apps/myapp_TA/local/props.conf</span></p>
                    
                    <h4>For JSON Logs:</h4>
                    <div class="arch-diagram">[myapp:application]
DATETIME_CONFIG = 
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
TIME_PREFIX = "timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 32
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 10000
KV_MODE = json
# Or for deeper JSON: 
# INDEXED_EXTRACTIONS = json</div>

                    <h4>For Syslog Key-Value:</h4>
                    <div class="arch-diagram">[myapp:syslog]
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 32
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = auto
# Custom extractions in transforms.conf</div>

                    <h4>For Multiline Logs (e.g., Java stack traces):</h4>
                    <div class="arch-diagram">[myapp:application]
TIME_FORMAT = %Y-%m-%d %H:%M:%S
SHOULD_LINEMERGE = true
LINE_BREAKER = ([\r\n]+)\d{4}-\d{2}-\d{2}
BREAK_ONLY_BEFORE = ^\d{4}-\d{2}-\d{2}
MUST_BREAK_AFTER = 
MAX_EVENTS = 256</div>
                </div>

                <!-- PHASE 5 -->
                <div class="phase-header" id="phase5">
                    <span class="phase-num">PHASE 5</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Field Extractions</span>
                </div>

                <h3>5.1 Automatic Extractions (KV_MODE)</h3>
                <div class="config-section">
                    <p>For simple key=value or JSON, props.conf handles extraction:</p>
                    <div class="arch-diagram"># props.conf
[myapp:application]
KV_MODE = json       # For JSON logs
# KV_MODE = auto     # For key=value pairs</div>
                </div>

                <h3>5.2 Regex Extractions (transforms.conf)</h3>
                <div class="config-section">
                    <p><strong>File:</strong> <span class="file-path">$SPLUNK_HOME/etc/apps/myapp_TA/local/transforms.conf</span></p>
                    
                    <div class="arch-diagram"># transforms.conf

[myapp_extract_user]
REGEX = USER=(?<user>\S+)
FORMAT = user::$1

[myapp_extract_action]
REGEX = ACTION=(?<action>\S+)
FORMAT = action::$1

[myapp_extract_src_ip]
REGEX = SRC=(?<src_ip>\d+\.\d+\.\d+\.\d+)
FORMAT = src_ip::$1

[myapp_extract_result]
REGEX = RESULT=(?<result>\w+)
FORMAT = result::$1</div>

                    <p>Reference in props.conf:</p>
                    <div class="arch-diagram"># props.conf
[myapp:syslog]
REPORT-user = myapp_extract_user
REPORT-action = myapp_extract_action
REPORT-src_ip = myapp_extract_src_ip
REPORT-result = myapp_extract_result</div>
                </div>

                <h3>5.3 Field Extraction via UI</h3>
                <div class="config-section">
                    <div class="console-path">Settings â†’ Fields â†’ Field Extractions â†’ New Field Extraction</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>Search for sample events: <code>index=myapp sourcetype=myapp:application</code></div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>Click event â†’ Extract Fields â†’ Select extraction method (Regex or Delimiter)</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>Highlight values to extract, name fields, validate against other events</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div>Save to appropriate app (creates transforms.conf automatically)</div>
                    </div>
                </div>

                <!-- PHASE 6 -->
                <div class="phase-header" id="phase6">
                    <span class="phase-num">PHASE 6</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">CIM Mapping (For Enterprise Security)</span>
                </div>

                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-info-circle"></i> Why CIM Mapping?</h4>
                    <p>The <strong>Common Information Model (CIM)</strong> normalizes field names across data sources. Required for:</p>
                    <ul style="color: #8b949e;">
                        <li>Enterprise Security correlation searches</li>
                        <li>Cross-source searches (correlate firewall + endpoint + app logs)</li>
                        <li>Out-of-box dashboards and reports</li>
                    </ul>
                </div>

                <h3>6.1 Create Field Aliases</h3>
                <div class="config-section">
                    <p><strong>File:</strong> <span class="file-path">props.conf</span></p>
                    
                    <div class="arch-diagram"># props.conf - CIM field aliases for Authentication data model
[myapp:auth]
# Map your fields to CIM fields
FIELDALIAS-user = user AS user
FIELDALIAS-src = src_ip AS src
FIELDALIAS-action = action AS action
FIELDALIAS-app = sourcetype AS app

# Calculated field for CIM
EVAL-vendor_product = "MyApp"
EVAL-action = case(result=="success", "success", result=="failure", "failure", true(), "unknown")</div>
                </div>

                <h3>6.2 Add to Data Model</h3>
                <div class="config-section">
                    <div class="console-path">Settings â†’ Data Models â†’ Authentication â†’ Edit â†’ Add Dataset</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>Open Authentication data model</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>Add Dataset â†’ Root Event â†’ Constraint: <code>sourcetype=myapp:auth</code></div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>Map fields to CIM schema (user, src, dest, action, etc.)</div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div>Save and rebuild data model acceleration</div>
                    </div>
                </div>

                <h3>6.3 Common CIM Data Models</h3>
                <table class="styled-table">
                    <thead>
                        <tr><th>Data Model</th><th>Use For</th><th>Key CIM Fields</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>Authentication</td><td>Logins, auth events</td><td>user, src, dest, action, app</td></tr>
                        <tr><td>Network Traffic</td><td>Firewall, flow data</td><td>src_ip, dest_ip, dest_port, bytes</td></tr>
                        <tr><td>Endpoint</td><td>Process, file events</td><td>process, process_path, user, dest</td></tr>
                        <tr><td>Web</td><td>Proxy, web server logs</td><td>url, http_method, status, src</td></tr>
                        <tr><td>Malware</td><td>AV, EDR alerts</td><td>signature, file_path, action, user</td></tr>
                    </tbody>
                </table>

                <!-- PHASE 7 -->
                <div class="phase-header" id="phase7">
                    <span class="phase-num">PHASE 7</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Verify & Test</span>
                </div>

                <h3>7.1 Verify Data Ingestion</h3>
                <div class="config-section">
                    <div class="arch-diagram"># Check data is arriving
index=myapp sourcetype=myapp:application earliest=-1h
| stats count by host, sourcetype

# Verify field extractions
index=myapp sourcetype=myapp:application earliest=-1h
| table _time user action src_ip result

# Check for parsing errors
index=_internal sourcetype=splunkd component=LineBreakingProcessor
| search myapp
| stats count by log_level</div>
                </div>

                <h3>7.2 Verify CIM Compliance</h3>
                <div class="config-section">
                    <div class="arch-diagram"># Test CIM mapping with data model
| datamodel Authentication Successful_Authentication search
| search sourcetype=myapp:auth
| table _time user src action app

# Validate required fields exist
index=myapp sourcetype=myapp:auth
| stats count by user, src, action
| where isnull(user) OR isnull(src) OR isnull(action)</div>
                </div>

                <!-- PHASE 8 -->
                <div class="phase-header" id="phase8">
                    <span class="phase-num">PHASE 8</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Create Detection Rules</span>
                </div>

                <h3>8.1 Correlation Search Examples</h3>
                <div class="config-section">
                    <div class="console-path">Enterprise Security â†’ Configure â†’ Content â†’ Content Management â†’ Create New Content â†’ Correlation Search</div>
                    
                    <h4>Brute Force Detection:</h4>
                    <div class="arch-diagram">| tstats summariesonly=true count from datamodel=Authentication.Failed_Authentication 
  where nodename=Authentication.Failed_Authentication sourcetype=myapp:auth
  by _time, Authentication.user, Authentication.src span=5m
| rename Authentication.* AS *
| where count > 10
| eval rule_name="MyApp Brute Force"</div>

                    <h4>Login from New Location:</h4>
                    <div class="arch-diagram">| tstats summariesonly=true values(Authentication.src) as current_src 
  from datamodel=Authentication.Successful_Authentication 
  where sourcetype=myapp:auth earliest=-1h
  by Authentication.user
| join Authentication.user [
    | tstats summariesonly=true values(Authentication.src) as historical_src 
      from datamodel=Authentication.Successful_Authentication 
      where sourcetype=myapp:auth earliest=-30d latest=-1h
      by Authentication.user
  ]
| eval new_src=mvfilter(NOT match(current_src, historical_src))
| where isnotnull(new_src)</div>
                </div>

                <!-- COMPLETE EXAMPLE -->
                <div class="phase-header" id="examples">
                    <span class="phase-num">EXAMPLE</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Complete End-to-End: Java Application</span>
                </div>

                <div class="config-section">
                    <h4>Sample Log:</h4>
                    <div class="example-log">{"@timestamp":"2024-02-15T14:30:00.123Z","level":"INFO","logger":"AuthService","user_id":"jsmith","client_ip":"10.0.1.50","action":"LOGIN","result":"SUCCESS","session_id":"sess-abc123"}</div>

                    <h4>1. inputs.conf (on Universal Forwarder):</h4>
                    <div class="arch-diagram">[monitor:///var/log/javaapp/auth.log]
disabled = false
index = javaapp
sourcetype = javaapp:auth</div>

                    <h4>2. props.conf (on Indexer or via app):</h4>
                    <div class="arch-diagram">[javaapp:auth]
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N%Z
TIME_PREFIX = "@timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 35
SHOULD_LINEMERGE = false
KV_MODE = json

# CIM field aliases
FIELDALIAS-user = user_id AS user
FIELDALIAS-src = client_ip AS src
EVAL-vendor_product = "JavaApp AuthService"
EVAL-action = lower(action)
EVAL-app = "javaapp"</div>

                    <h4>3. Verification:</h4>
                    <div class="arch-diagram">index=javaapp sourcetype=javaapp:auth
| table _time user src action result session_id</div>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Custom Log Onboarding Decision Trees</h2>
                <div class="config-section">
                    <h3>Decision Tree: Parsing Method Selection</h3>
                    <div class="arch-diagram">NEED TO PARSE A NEW LOG SOURCE?
â”‚
â”œâ”€ What format is the log?
â”‚   â”‚
â”‚   â”œâ”€ JSON?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Use KV_MODE = json
â”‚   â”‚       â”œâ”€ Automatic nested field extraction
â”‚   â”‚       â”œâ”€ Array handling built-in
â”‚   â”‚       â””â”€ Minimal configuration needed
â”‚   â”‚
â”‚   â”œâ”€ Key=Value pairs?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Use KV_MODE = auto
â”‚   â”‚       â”œâ”€ Handles: key=value, key="value"
â”‚   â”‚       â”œâ”€ Set DELIMS if non-standard separators
â”‚   â”‚       â””â”€ Override with EXTRACT if edge cases
â”‚   â”‚
â”‚   â”œâ”€ Syslog (RFC 3164/5424)?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Use TA-syslog or custom props
â”‚   â”‚       â”œâ”€ SHOULD_LINEMERGE = false
â”‚   â”‚       â”œâ”€ Extract timestamp with TIME_FORMAT
â”‚   â”‚       â””â”€ Parse message body separately
â”‚   â”‚
â”‚   â”œâ”€ CSV/Delimited?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Use INDEXED_EXTRACTIONS = csv
â”‚   â”‚       â”œâ”€ FIELD_NAMES = field1,field2,field3
â”‚   â”‚       â”œâ”€ FIELD_DELIMITER = ,
â”‚   â”‚       â””â”€ Handles headers automatically
â”‚   â”‚
â”‚   â””â”€ Complex/Custom format?
â”‚       â”‚
â”‚       â””â”€ Use REPORT + transforms.conf
â”‚           â”œâ”€ Write regex with named capture groups
â”‚           â”œâ”€ Test with rex command first
â”‚           â””â”€ Deploy to transforms.conf</div>

                    <h3>Decision Tree: Timestamp Extraction</h3>
                    <div class="arch-diagram">TIMESTAMP NOT EXTRACTING CORRECTLY?
â”‚
â”œâ”€ Check 1: Is timestamp recognized?
â”‚   â”‚
â”‚   â”œâ”€ Search: index=* sourcetype=mysource
â”‚   â”‚   | eval time_diff=_time-_indextime
â”‚   â”‚   | where time_diff &gt; 60 OR time_diff &lt; -60
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ Large differences? â†’ Timestamp issue
â”‚   â”‚   â””â”€ Timestamps match? â†’ Working correctly
â”‚   â”‚
â”‚   â””â”€ Check raw event for timestamp location
â”‚
â”œâ”€ Check 2: What format is the timestamp?
â”‚   â”‚
â”‚   â”œâ”€ Standard formats (ISO 8601, Unix epoch)?
â”‚   â”‚   â””â”€ Splunk auto-detects, verify TIME_PREFIX
â”‚   â”‚
â”‚   â”œâ”€ Custom format?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Set TIME_FORMAT in props.conf
â”‚   â”‚       â”œâ”€ %Y-%m-%d %H:%M:%S (2024-01-15 14:30:00)
â”‚   â”‚       â”œâ”€ %b %d %H:%M:%S (Jan 15 14:30:00)
â”‚   â”‚       â””â”€ %s.%6N (Unix epoch with microseconds)
â”‚   â”‚
â”‚   â””â”€ Multiple timestamps in event?
â”‚       â”‚
â”‚       â””â”€ Set TIME_PREFIX to match text before timestamp
â”‚           â””â”€ TIME_PREFIX = timestamp=
â”‚
â”œâ”€ Check 3: Timezone handling
â”‚   â”‚
â”‚   â”œâ”€ Logs have timezone info?
â”‚   â”‚   â””â”€ Splunk extracts automatically
â”‚   â”‚
â”‚   â”œâ”€ Logs are UTC with no indicator?
â”‚   â”‚   â””â”€ TZ = UTC
â”‚   â”‚
â”‚   â””â”€ Logs are local time?
â”‚       â””â”€ TZ = America/New_York (or appropriate zone)
â”‚
â””â”€ Check 4: Still not working?
    â”‚
    â””â”€ Test extraction in search:
        | makeresults | eval _raw="your sample log"
        | extract pairdelim="," kvdelim="="
        | eval extracted_time=strptime(timestamp_field,"%Y-%m-%d")</div>

                    <h3>Decision Tree: CIM Mapping Priority</h3>
                    <div class="arch-diagram">MAPPING NEW SOURCE TO CIM?
â”‚
â”œâ”€ Step 1: Identify applicable data models
â”‚   â”‚
â”‚   â”œâ”€ Authentication logs?
â”‚   â”‚   â””â”€ Authentication data model
â”‚   â”‚       â”œâ”€ Required: action, src, user
â”‚   â”‚       â””â”€ Optional: dest, app, signature
â”‚   â”‚
â”‚   â”œâ”€ Network logs (firewall, proxy)?
â”‚   â”‚   â””â”€ Network Traffic data model
â”‚   â”‚       â”œâ”€ Required: action, dest, src
â”‚   â”‚       â””â”€ Optional: bytes_in, bytes_out, dest_port
â”‚   â”‚
â”‚   â”œâ”€ Endpoint logs?
â”‚   â”‚   â””â”€ Endpoint data model
â”‚   â”‚       â”œâ”€ Required: dest, action
â”‚   â”‚       â””â”€ Optional: process, file_path, user
â”‚   â”‚
â”‚   â””â”€ Security alerts?
â”‚       â””â”€ Alerts data model
â”‚           â”œâ”€ Required: signature, severity
â”‚           â””â”€ Optional: src, dest, user
â”‚
â”œâ”€ Step 2: Map fields with priority
â”‚   â”‚
â”‚   â”œâ”€ Direct rename (field exists, wrong name)?
â”‚   â”‚   â””â”€ FIELDALIAS-new = old AS new
â”‚   â”‚
â”‚   â”œâ”€ Value transformation needed?
â”‚   â”‚   â””â”€ EVAL-field = case/if logic
â”‚   â”‚
â”‚   â””â”€ Field doesn't exist but can be derived?
â”‚       â””â”€ EVAL-field = calculation or lookup
â”‚
â””â”€ Step 3: Validate mapping
    â”‚
    â””â”€ | datamodel Authentication search
        | where sourcetype="mysource"
        â””â”€ Verify all required fields populated</div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                <div class="enterprise-gaps">
                    <div class="gap-grid">
                        <div class="gap-category critical">
                            <h4>ðŸ”´ Critical Gaps</h4>
                            <ul>
                                <li><strong>No timestamp validation:</strong> Events indexed with wrong timestamps, detection rules miss them entirely</li>
                                <li><strong>Line breaking failures:</strong> Multiline logs merged or split incorrectly, losing event context</li>
                                <li><strong>No CIM mapping:</strong> Data ingested but ES correlation searches can't find it</li>
                                <li><strong>Hardcoded sourcetypes:</strong> Using vendor TAs for custom logs breaks on TA updates</li>
                                <li><strong>Missing event truncation settings:</strong> Large events silently truncated at 10KB default</li>
                            </ul>
                        </div>
                        <div class="gap-category warning">
                            <h4><i class="fas fa-exclamation-triangle"></i> Operational Gaps</h4>
                            <ul>
                                <li><strong>No onboarding documentation:</strong> Tribal knowledge of parsing logic, no runbooks</li>
                                <li><strong>Config deployed to wrong tier:</strong> props.conf on forwarder when should be on indexer (or vice versa)</li>
                                <li><strong>Stale sourcetype definitions:</strong> Log format changed but parsing never updated</li>
                                <li><strong>No field extraction testing:</strong> REGEX works in dev but fails on production edge cases</li>
                                <li><strong>Inconsistent naming conventions:</strong> sourcetype naming varies (app_auth vs app:auth vs app-auth)</li>
                            </ul>
                        </div>
                        <div class="gap-category info">
                            <h4><i class="fas fa-info-circle"></i> Performance Issues</h4>
                            <ul>
                                <li><strong>Search-time vs index-time confusion:</strong> Extracting expensive fields at search time repeatedly</li>
                                <li><strong>Overly complex REGEX:</strong> Backtracking regex patterns causing search slowdowns</li>
                                <li><strong>No indexed field promotion:</strong> Frequently searched fields not in INDEXED_EXTRACTIONS</li>
                                <li><strong>Bloated events:</strong> Extracting unnecessary fields that consume license</li>
                                <li><strong>Missing acceleration:</strong> High-volume sources not accelerated in data models</li>
                            </ul>
                        </div>
                        <div class="gap-category best-practice">
                            <h4><i class="fas fa-check-circle"></i> Best Practices Often Ignored</h4>
                            <ul>
                                <li><strong>Sample log collection:</strong> Gather diverse samples including errors, edge cases, before building parsing</li>
                                <li><strong>Props.conf ordering:</strong> More specific sourcetypes should come before general ones</li>
                                <li><strong>Test with rex command first:</strong> Validate regex in search before committing to transforms.conf</li>
                                <li><strong>Version control configs:</strong> Track props.conf, transforms.conf changes in Git</li>
                                <li><strong>Validation checklist:</strong> Timestamp, field extraction, CIM mapping, acceleration verified before production</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through onboarding a custom log source in Splunk.</button>
                        <div class="qa-answer">
                            <p><strong>Complete process:</strong></p>
                            <ol>
                                <li><strong>Planning:</strong> Gather sample logs, identify format (JSON, syslog, delimited), estimate volume</li>
                                <li><strong>Ingestion:</strong> Choose method - Universal Forwarder for files, HEC for API/webhook, Heavy Forwarder for syslog</li>
                                <li><strong>Configure input:</strong> Create inputs.conf with monitor stanza, set index and sourcetype</li>
                                <li><strong>Create sourcetype:</strong> props.conf defines timestamp extraction, line breaking, KV_MODE</li>
                                <li><strong>Field extraction:</strong> For complex formats, use transforms.conf with regex; reference via REPORT- in props.conf</li>
                                <li><strong>CIM mapping:</strong> Add FIELDALIAS and EVAL statements to map to CIM fields</li>
                                <li><strong>Verify:</strong> Search the data, check field extractions work</li>
                                <li><strong>Detection:</strong> Create correlation searches using the data model</li>
                            </ol>
                            <p><strong>Key files:</strong> inputs.conf (what to collect), props.conf (how to parse), transforms.conf (field extraction)</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between KV_MODE, REPORT, and EXTRACT in props.conf?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>KV_MODE:</strong> Automatic extraction for simple formats. Options: json, auto (key=value), none</li>
                                <li><strong>REPORT-fieldname:</strong> References a transform in transforms.conf. Used for complex regex extractions. Search-time extraction.</li>
                                <li><strong>EXTRACT-fieldname:</strong> Inline regex directly in props.conf. Simpler but less reusable. Search-time extraction.</li>
                            </ul>
                            <p><strong>Best practice:</strong> Use KV_MODE=json for JSON logs. Use REPORT with transforms.conf for complex formats (more maintainable, reusable).</p>
                        </div>
                    </div>
                </div>
                <!-- Extended Interview Questions -->
                <h2><i class="fas fa-question-circle"></i> Advanced Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: A vendor sends you logs in a custom multiline XML format. Walk me through onboarding this source.</button>
                        <div class="qa-answer">
                            <p><strong>Approach:</strong></p>
                            <ol>
                                <li><strong>Analyze the format:</strong> Get sample logs, identify the XML structure and event boundaries</li>
                                <li><strong>Handle multiline:</strong> Set LINE_BREAKER to split on XML root elements
                                    <div class="arch-diagram">[mysource:xml]
LINE_BREAKER = ([\r\n]+)(?=&lt;\?xml|&lt;Event)
SHOULD_LINEMERGE = false
TRUNCATE = 50000</div>
                                </li>
                                <li><strong>Configure extraction:</strong> Use KV_MODE=xml for automatic field extraction
                                    <div class="arch-diagram">KV_MODE = xml
# Or for complex XML:
REPORT-fields = xml_extract</div>
                                </li>
                                <li><strong>Handle nested elements:</strong> Use SEDCMD to flatten or transforms for XPath-like extraction</li>
                                <li><strong>Map to CIM:</strong> FIELDALIAS for direct mappings, EVAL for transformations</li>
                            </ol>
                            <p><strong>Key challenge:</strong> XML can have variable structure - test with multiple sample events. Use TRUNCATE to handle large events.</p>
                            <p><strong>Validation:</strong> <code>index=myindex sourcetype=mysource:xml | xmlkv | table *</code></p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: You've onboarded a source but timestamps are wrong - events appear hours off. How do you troubleshoot?</button>
                        <div class="qa-answer">
                            <p><strong>Systematic approach:</strong></p>
                            <ol>
                                <li><strong>Verify the issue:</strong>
                                    <div class="arch-diagram">index=myindex sourcetype=mysource earliest=-1h
| eval lag = _indextime - _time
| stats avg(lag) min(lag) max(lag)
# Large lag = timestamp extraction problem</div>
                                </li>
                                <li><strong>Check raw event:</strong> Find the timestamp in _raw and note its exact format</li>
                                <li><strong>Common causes:</strong>
                                    <ul>
                                        <li>TIME_FORMAT doesn't match actual format</li>
                                        <li>TIME_PREFIX missing or wrong (Splunk finding wrong timestamp)</li>
                                        <li>Timezone mismatch (TZ not set, defaults to indexer timezone)</li>
                                        <li>Multiple timestamps in event, Splunk picking the wrong one</li>
                                    </ul>
                                </li>
                                <li><strong>Fix in props.conf:</strong>
                                    <div class="arch-diagram">[mysource]
TIME_PREFIX = timestamp=
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N%z
TZ = UTC
MAX_TIMESTAMP_LOOKAHEAD = 30</div>
                                </li>
                            </ol>
                            <p><strong>Pro tip:</strong> Use strptime() in search to test TIME_FORMAT before deploying.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Explain the difference between search-time and index-time field extraction. When would you use each?</button>
                        <div class="qa-answer">
                            <p><strong>Index-time extraction:</strong></p>
                            <ul>
                                <li>Configured via TRANSFORMS with WRITE_META = true or INDEXED_EXTRACTIONS</li>
                                <li>Fields stored in index, searchable with <code>field=value</code> syntax</li>
                                <li>Uses more storage (tsidx files grow)</li>
                                <li><strong>Use when:</strong> Field is in 90%+ of searches, high-volume index, need fastest performance</li>
                            </ul>
                            <p><strong>Search-time extraction:</strong></p>
                            <ul>
                                <li>Configured via EXTRACT- or REPORT- in props.conf (default)</li>
                                <li>Fields extracted on-the-fly during search</li>
                                <li>More flexible - can modify without reindexing</li>
                                <li><strong>Use when:</strong> Field rarely searched standalone, extraction logic may change, storage costs matter</li>
                            </ul>
                            <p><strong>Real-world example:</strong> For firewall logs, <code>src_ip</code> and <code>dest_ip</code> should be index-time (searched constantly). <code>user_agent</code> string can be search-time (occasional hunting).</p>
                            <p><strong>Trade-off:</strong> Index-time costs storage but improves search speed. Most shops use search-time by default, promote to index-time only for proven high-value fields.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle log sources where the format changes between application versions?</button>
                        <div class="qa-answer">
                            <p><strong>Strategy:</strong></p>
                            <ol>
                                <li><strong>Version detection:</strong> Identify a field or pattern that indicates version
                                    <div class="arch-diagram"># If version in log:
EVAL-log_version = case(match(_raw,"v2\."),2,match(_raw,"v1\."),1,true(),0)</div>
                                </li>
                                <li><strong>Multiple transforms:</strong> Create version-specific extraction rules
                                    <div class="arch-diagram"># transforms.conf
[app_v1_extract]
REGEX = ^(?&lt;timestamp&gt;\d{4}-\d{2}-\d{2})\s+(?&lt;user&gt;\w+)\s+(?&lt;action&gt;\w+)

[app_v2_extract]
REGEX = ^(?&lt;timestamp&gt;[\d-]+T[\d:]+)\|(?&lt;user&gt;[^|]+)\|(?&lt;action&gt;[^|]+)</div>
                                </li>
                                <li><strong>Conditional application:</strong> Use REPORT with conditional transforms or calculated fields</li>
                                <li><strong>Normalize output:</strong> EVAL statements to standardize field values across versions
                                    <div class="arch-diagram">EVAL-action = case(action="LOGIN","login",action="log_in","login",true(),lower(action))</div>
                                </li>
                            </ol>
                            <p><strong>Best practice:</strong> Document version differences. Consider separate sourcetypes if formats are radically different (app:auth:v1 vs app:auth:v2).</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Your regex extraction works for 99% of events but fails on edge cases. How do you handle this?</button>
                        <div class="qa-answer">
                            <p><strong>Approach:</strong></p>
                            <ol>
                                <li><strong>Find the failures:</strong>
                                    <div class="arch-diagram">index=myindex sourcetype=mysource NOT field_that_should_exist=*
| stats count by host
# Identifies which hosts have extraction failures</div>
                                </li>
                                <li><strong>Analyze edge cases:</strong> Look at raw events, identify pattern differences</li>
                                <li><strong>Options for handling:</strong>
                                    <ul>
                                        <li><strong>Broader regex:</strong> Make regex more permissive (risk: false matches)</li>
                                        <li><strong>Multiple REPORT lines:</strong> Splunk tries each until one matches
                                            <div class="arch-diagram">REPORT-fields1 = primary_extract
REPORT-fields2 = fallback_extract</div>
                                        </li>
                                        <li><strong>Calculated field backup:</strong> EVAL to fill missing values</li>
                                    </ul>
                                </li>
                            </ol>
                            <p><strong>Example:</strong> Primary regex assumes standard format, fallback handles quoted values or escaped characters.</p>
                            <p><strong>Validation metric:</strong> Track extraction success rate: <code>| eval extracted=if(isnotnull(field),1,0) | stats avg(extracted)</code></p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through creating a new TA for a custom application from scratch.</button>
                        <div class="qa-answer">
                            <p><strong>Complete process:</strong></p>
                            <ol>
                                <li><strong>Create directory structure:</strong>
                                    <div class="arch-diagram">$SPLUNK_HOME/etc/apps/TA-myapp/
â”œâ”€â”€ default/
â”‚   â”œâ”€â”€ app.conf
â”‚   â”œâ”€â”€ props.conf
â”‚   â””â”€â”€ transforms.conf
â”œâ”€â”€ local/
â”œâ”€â”€ metadata/
â”‚   â””â”€â”€ default.meta
â””â”€â”€ README.md</div>
                                </li>
                                <li><strong>Configure app.conf:</strong>
                                    <div class="arch-diagram">[install]
is_configured = 0

[ui]
is_visible = 0
label = TA for MyApp

[launcher]
author = Your Name
version = 1.0.0</div>
                                </li>
                                <li><strong>Define sourcetypes in props.conf:</strong>
                                    <div class="arch-diagram">[myapp:application]
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
REPORT-fields = myapp_extract
# CIM compliance
FIELDALIAS-user = username AS user
EVAL-vendor_product = "MyApp"</div>
                                </li>
                                <li><strong>Create transforms.conf:</strong>
                                    <div class="arch-diagram">[myapp_extract]
REGEX = ^(?&lt;timestamp&gt;[\d-T:]+)\s+\[(?&lt;level&gt;\w+)\]\s+(?&lt;username&gt;\w+)\s+(?&lt;message&gt;.+)
FORMAT = timestamp::$1 level::$2 username::$3 message::$4</div>
                                </li>
                                <li><strong>Set permissions in default.meta:</strong>
                                    <div class="arch-diagram">[props]
export = system

[transforms]
export = system</div>
                                </li>
                            </ol>
                            <p><strong>Deployment:</strong> Deploy via deployment server to search heads and indexers. Forwarders only need inputs.conf app.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you validate that a newly onboarded source is CIM-compliant?</button>
                        <div class="qa-answer">
                            <p><strong>Validation steps:</strong></p>
                            <ol>
                                <li><strong>Check data model mapping:</strong>
                                    <div class="arch-diagram">| datamodel Authentication search
| search sourcetype="mysource"
| stats count by action, src, dest, user
# All required CIM fields should have values</div>
                                </li>
                                <li><strong>Verify field values:</strong>
                                    <div class="arch-diagram">| datamodel Authentication Authentication search
| where sourcetype="mysource"
| stats values(action) values(src) values(user)
# Values should be normalized (lowercase, consistent format)</div>
                                </li>
                                <li><strong>Test in ES:</strong>
                                    <div class="arch-diagram"># Run an existing correlation search
# Verify your source appears in notable events</div>
                                </li>
                                <li><strong>Check tstats performance:</strong>
                                    <div class="arch-diagram">| tstats count from datamodel=Authentication where sourcetype="mysource" by action
# Should return results (confirms acceleration working)</div>
                                </li>
                            </ol>
                            <p><strong>Common issues:</strong></p>
                            <ul>
                                <li>action field not normalized (should be: success, failure, etc.)</li>
                                <li>User field has domain prefix that doesn't match other sources</li>
                                <li>Timestamp issues preventing data model acceleration</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: A log source is generating 500GB/day but only 10% is useful for security. How do you handle this?</button>
                        <div class="qa-answer">
                            <p><strong>Data reduction strategies:</strong></p>
                            <ol>
                                <li><strong>Filter at source (best):</strong>
                                    <div class="arch-diagram"># inputs.conf on forwarder
[monitor:///var/log/app/audit.log]
# Only send audit logs, not debug logs
whitelist = audit\.log$
blacklist = \.debug\.log$</div>
                                </li>
                                <li><strong>Filter at Heavy Forwarder:</strong>
                                    <div class="arch-diagram"># props.conf - null queue unwanted events
[source::...app.log]
TRANSFORMS-null = setnull_debug

# transforms.conf
[setnull_debug]
REGEX = \[DEBUG\]|\[TRACE\]
DEST_KEY = queue
FORMAT = nullQueue</div>
                                </li>
                                <li><strong>Aggregate high-volume events:</strong> Keep counts instead of individual events for noise like health checks</li>
                                <li><strong>Split sourcetypes:</strong> Route valuable events to security index, noise to summary or null</li>
                            </ol>
                            <p><strong>Trade-offs:</strong></p>
                            <ul>
                                <li>Filtering = lost forensic data (document what's dropped)</li>
                                <li>Solution: Route filtered data to cold storage with longer retention, lower cost</li>
                            </ul>
                            <p><strong>License impact:</strong> 500GB â†’ 50GB = 90% license savings. Calculate ROI before implementing.</p>
                        </div>
                    </div>
                </div>

                <!-- Best Practices -->
                <h2><i class="fas fa-star"></i> Best Practices</h2>
                <div class="config-section">
                    <!-- Troubleshooting Guide -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting Guide</h2>
                <div class="config-section">
                    <h4>Common Issues and Solutions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Issue</th><th>Possible Cause</th><th>Solution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Data not appearing</td>
                                <td>Collection or parsing issue</td>
                                <td>Check collector status, verify parser configuration</td>
                            </tr>
                            <tr>
                                <td>Slow performance</td>
                                <td>Resource constraints or inefficient queries</td>
                                <td>Review resource utilization, optimize queries</td>
                            </tr>
                            <tr>
                                <td>Authentication failures</td>
                                <td>Credential or permission issues</td>
                                <td>Verify credentials, check RBAC configuration</td>
                            </tr>
                            <tr>
                                <td>Missing fields</td>
                                <td>Parser not extracting fields</td>
                                <td>Review parsing rules, update field extraction</td>
                            </tr>
                            <tr>
                                <td>Duplicate events</td>
                                <td>Multiple collection paths</td>
                                <td>Audit data sources, implement deduplication</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Diagnostic Steps</h4>
                    <ol style="color: #8b949e;">
                        <li><strong>Check Status:</strong> Verify component health in console</li>
                        <li><strong>Review Logs:</strong> Examine internal logs for errors</li>
                        <li><strong>Test Connectivity:</strong> Verify network paths and authentication</li>
                        <li><strong>Validate Config:</strong> Compare configuration against documentation</li>
                        <li><strong>Isolate Issue:</strong> Narrow down to specific component</li>
                        <li><strong>Escalate:</strong> Contact support if needed with diagnostics</li>
                    </ol>
                </div>

                <!-- Use Cases -->
                <h2><i class="fas fa-briefcase"></i> Real-World Use Cases</h2>
                <div class="config-section">
                    <h4>Use Case 1: Enterprise SOC</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Large enterprise with 20,000 endpoints, multiple cloud environments</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Centralized collection from all security data sources</li>
                            <li>Custom detection rules aligned to threat model</li>
                            <li>Automated response playbooks for common scenarios</li>
                            <li>Integration with ticketing and CMDB systems</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> 60% reduction in MTTR, improved threat visibility</p>
                    </div>

                    <h4>Use Case 2: MSSP Operations</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Managed security provider serving 50 customers</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Multi-tenant architecture with customer isolation</li>
                            <li>Standardized detection content across customers</li>
                            <li>Centralized analyst workflow and reporting</li>
                            <li>SLA-driven prioritization and escalation</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> Efficient operations at scale, consistent service delivery</p>
                    </div>

                    <h4>Use Case 3: Compliance-Focused</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Healthcare organization with HIPAA requirements</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Comprehensive audit logging for PHI access</li>
                            <li>Long-term retention for compliance evidence</li>
                            <li>Pre-built compliance dashboards and reports</li>
                            <li>Automated compliance violation detection</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> Audit-ready documentation, reduced compliance risk</p>
                    </div>
                </div>

                <!-- Quick Reference -->
                <h2><i class="fas fa-bookmark"></i> Quick Reference</h2>
                <div class="config-section">
                    <h4>Common Commands/Queries</h4>
                    <div class="arch-diagram"># Basic health check query
# Adjust syntax for your platform (XQL/SPL/KQL)

# Check data ingestion rate
| stats count by _time span=1h

# Find recent errors
| filter severity = "error" 
| sort _time desc 
| limit 100

# Top sources by volume
| stats sum(bytes) as total_bytes by source
| sort total_bytes desc
| limit 10

# Detection rule effectiveness
| filter alert_type = "detection"
| stats count by rule_name, disposition
| sort count desc</div>

                    <h4>Key Configuration Files/Paths</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Purpose</th><th>Location/Path</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Main Configuration</td><td>Settings â†’ Configuration</td></tr>
                            <tr><td>Data Sources</td><td>Settings â†’ Data Sources</td></tr>
                            <tr><td>Detection Rules</td><td>Detection â†’ Rules</td></tr>
                            <tr><td>User Management</td><td>Settings â†’ Access Management</td></tr>
                            <tr><td>Audit Logs</td><td>Settings â†’ Audit Trail</td></tr>
                        </tbody>
                    </table>

                    <h4>Important Thresholds</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Metric</th><th>Warning</th><th>Critical</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Query Response Time</td><td>> 30 seconds</td><td>> 120 seconds</td></tr>
                            <tr><td>Ingestion Latency</td><td>> 5 minutes</td><td>> 15 minutes</td></tr>
                            <tr><td>Storage Utilization</td><td>> 70%</td><td>> 85%</td></tr>
                            <tr><td>Error Rate</td><td>> 1%</td><td>> 5%</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Related Topics -->
                <h2><i class="fas fa-link"></i> Related Topics</h2>
                <div class="config-section">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-book" style="color: #58a6ff;"></i> Documentation</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>Official vendor documentation</li>
                                <li>API reference guides</li>
                                <li>Release notes</li>
                            </ul>
                        </div>
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-users" style="color: #58a6ff;"></i> Community</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>User forums</li>
                                <li>Community Slack/Discord</li>
                                <li>Blog posts and articles</li>
                            </ul>
                        </div>
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-graduation-cap" style="color: #58a6ff;"></i> Training</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>Vendor certifications</li>
                                <li>Online courses</li>
                                <li>Hands-on labs</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
</main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>