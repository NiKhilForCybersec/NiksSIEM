<!DOCTYPE html>
<html lang="en" data-theme="dark" data-platform="splunk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Security Overview - Splunk ES Deep Dive | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="index.html" class="platform-tab splunk active"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
                        <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Pipeline</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="forwarders.html" class="nav-link"><i class="fas fa-share"></i> Forwarders Deep Dive</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                    <a href="data-models.html" class="nav-link"><i class="fas fa-cubes"></i> Data Models & CIM</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention & Buckets</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SPL Query Language</div>
                    <a href="spl-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> SPL Fundamentals</a>
                    <a href="spl-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> SPL Intermediate</a>
                    <a href="spl-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced SPL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Enterprise Security</div>
                    <a href="es-overview.html" class="nav-link active"><i class="fas fa-shield-alt"></i> ES Overview</a>
                    <a href="correlation-searches.html" class="nav-link"><i class="fas fa-search-plus"></i> Correlation Searches</a>
                    <a href="notable-events.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Notable Events</a>
                    <a href="risk-based-alerting.html" class="nav-link"><i class="fas fa-chart-line"></i> Risk-Based Alerting</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">TI & Automation</div>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intelligence</a>
                    <a href="soar.html" class="nav-link"><i class="fas fa-robot"></i> Splunk SOAR</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="apps-tas.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> Apps & TAs</a>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-wrench"></i> Troubleshooting</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Enterprise Security Overview</span>
                </div>
            </header>
            
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-shield-alt"></i> Splunk Enterprise Security (ES)</h1>
                    <p class="lead">Premium SIEM application built on Splunk platform - correlation searches, notable events, risk-based alerting, and security workflows</p>
                </div>

                <!-- ES Architecture -->
                <section class="content-section">
                    <h2><i class="fas fa-sitemap"></i> ES Architecture</h2>

                    <div class="architecture-diagram" style="background: var(--card-bg); padding: 1.5rem; border-radius: 8px; font-family: monospace; font-size: 0.65rem; overflow-x: auto;">
<pre>
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                           SPLUNK ENTERPRISE SECURITY ARCHITECTURE                            │
├─────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│   DATA SOURCES              DATA MODELS              CORRELATION           INCIDENT         │
│   ────────────              ───────────              ───────────           ────────         │
│                                                                                              │
│   ┌───────────┐           ┌─────────────┐          ┌─────────────┐      ┌─────────────┐    │
│   │ Firewall  │───CIM────▶│ Network     │─────────▶│ Correlation │─────▶│ Notable     │    │
│   │ Logs      │  Mapping  │ Traffic     │          │ Searches    │      │ Events      │    │
│   └───────────┘           │ Data Model  │          │             │      │             │    │
│                           └─────────────┘          │ Scheduled   │      │ Incident    │    │
│   ┌───────────┐           ┌─────────────┐          │ Searches    │      │ Review      │    │
│   │ Auth      │───CIM────▶│ Authentication│───────▶│ that detect │─────▶│ Queue       │    │
│   │ Logs      │  Mapping  │ Data Model  │          │ threats     │      │             │    │
│   └───────────┘           └─────────────┘          └─────────────┘      └──────┬──────┘    │
│                                                                                 │           │
│   ┌───────────┐           ┌─────────────┐          ┌─────────────┐             │           │
│   │ Endpoint  │───CIM────▶│ Endpoint    │─────────▶│ Risk-Based  │─────────────┘           │
│   │ Logs      │  Mapping  │ Data Model  │          │ Alerting    │                         │
│   └───────────┘           └─────────────┘          │ (RBA)       │      ┌─────────────┐    │
│                                                    └─────────────┘      │ Adaptive    │    │
│   ┌───────────┐           ┌─────────────┐                               │ Response /  │    │
│   │ Threat    │──────────▶│ Threat      │                               │ SOAR        │    │
│   │ Intel     │           │ Intelligence │                              └─────────────┘    │
│   └───────────┘           └─────────────┘                                                   │
│                                                                                              │
│   KEY COMPONENTS:                                                                            │
│   • Data Models (CIM)    - Normalized schemas for security data                             │
│   • Correlation Searches - Scheduled searches that create Notable Events                    │
│   • Notable Events       - Security alerts requiring investigation                          │
│   • Incident Review      - Analyst workflow queue                                           │
│   • Risk Framework       - Risk scoring for assets and identities                           │
│   • Adaptive Response    - Automated response actions (deprecated for SOAR)                │
│                                                                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
                    </div>
                </section>

                <!-- Key Features -->
                <section class="content-section">
                    <h2><i class="fas fa-star"></i> Key Features</h2>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                        <div class="card" style="border-top: 4px solid #65a637;">
                            <div class="card-header"><h3>Notable Events</h3></div>
                            <div class="card-body">
                                <p>Centralized alert queue for security investigations. Each notable has:</p>
                                <ul>
                                    <li>Title, description, severity</li>
                                    <li>Owner assignment</li>
                                    <li>Status workflow</li>
                                    <li>MITRE ATT&CK mapping</li>
                                    <li>Related events</li>
                                </ul>
                            </div>
                        </div>

                        <div class="card" style="border-top: 4px solid #0078d4;">
                            <div class="card-header"><h3>Correlation Searches</h3></div>
                            <div class="card-body">
                                <p>Scheduled searches that detect threats:</p>
                                <ul>
                                    <li>100+ OOTB detections</li>
                                    <li>Custom search creation</li>
                                    <li>Throttling to reduce noise</li>
                                    <li>Risk score assignment</li>
                                    <li>Adaptive response actions</li>
                                </ul>
                            </div>
                        </div>

                        <div class="card" style="border-top: 4px solid #f5a623;">
                            <div class="card-header"><h3>Risk-Based Alerting</h3></div>
                            <div class="card-body">
                                <p>Score risk on assets/users instead of alerting:</p>
                                <ul>
                                    <li>Risk events accumulate</li>
                                    <li>Threshold-based notables</li>
                                    <li>Reduces alert fatigue</li>
                                    <li>Context-rich investigations</li>
                                </ul>
                            </div>
                        </div>

                        <div class="card" style="border-top: 4px solid #e74c3c;">
                            <div class="card-header"><h3>Threat Intelligence</h3></div>
                            <div class="card-body">
                                <p>IOC matching and enrichment:</p>
                                <ul>
                                    <li>Import STIX/TAXII feeds</li>
                                    <li>Custom TI sources</li>
                                    <li>Automatic IOC matching</li>
                                    <li>TI lookups in searches</li>
                                </ul>
                            </div>
                        </div>

                        <div class="card" style="border-top: 4px solid #9b59b6;">
                            <div class="card-header"><h3>Asset & Identity</h3></div>
                            <div class="card-body">
                                <p>Context enrichment for events:</p>
                                <ul>
                                    <li>Asset lookup tables</li>
                                    <li>Identity correlation</li>
                                    <li>Priority/criticality scores</li>
                                    <li>Business unit mapping</li>
                                </ul>
                            </div>
                        </div>

                        <div class="card" style="border-top: 4px solid #1abc9c;">
                            <div class="card-header"><h3>Dashboards</h3></div>
                            <div class="card-body">
                                <p>Pre-built security views:</p>
                                <ul>
                                    <li>Security Posture</li>
                                    <li>Incident Review</li>
                                    <li>Risk Analysis</li>
                                    <li>Threat Activity</li>
                                    <li>Access Center</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Data Models -->
                <section class="content-section">
                    <h2><i class="fas fa-cubes"></i> Common Information Model (CIM)</h2>

                    <p>ES relies on CIM-normalized data for correlation searches. Key data models:</p>

                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Data Model</th>
                                <th>Key Fields</th>
                                <th>Source Examples</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Authentication</strong></td>
                                <td>action, user, src, dest, app</td>
                                <td>Windows Security, Linux auth, VPN</td>
                            </tr>
                            <tr>
                                <td><strong>Network_Traffic</strong></td>
                                <td>action, src, dest, src_port, dest_port, bytes</td>
                                <td>Firewall, NetFlow, Proxy</td>
                            </tr>
                            <tr>
                                <td><strong>Endpoint</strong></td>
                                <td>action, process, process_path, user, dest</td>
                                <td>Sysmon, CrowdStrike, Carbon Black</td>
                            </tr>
                            <tr>
                                <td><strong>Web</strong></td>
                                <td>action, url, http_method, status, user</td>
                                <td>Proxy, WAF, Web server logs</td>
                            </tr>
                            <tr>
                                <td><strong>Email</strong></td>
                                <td>action, src_user, recipient, subject, file_name</td>
                                <td>O365, Exchange, Email gateway</td>
                            </tr>
                            <tr>
                                <td><strong>Change</strong></td>
                                <td>action, object, object_path, user</td>
                                <td>AD changes, file integrity</td>
                            </tr>
                            <tr>
                                <td><strong>Malware</strong></td>
                                <td>action, signature, file_name, file_hash, dest</td>
                                <td>AV, EDR, sandbox</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">SPL</span>
                            <span class="code-title">Using Data Models with tstats</span>
                        </div>
                        <pre><code>// Fast search using accelerated data model
| tstats count from datamodel=Authentication 
    where Authentication.action=failure 
    by Authentication.user, Authentication.src, Authentication.dest
| rename Authentication.* as *
| where count > 10

// Network traffic analysis
| tstats sum(All_Traffic.bytes) as total_bytes 
    from datamodel=Network_Traffic 
    where All_Traffic.action=allowed 
    by All_Traffic.src, All_Traffic.dest
| rename All_Traffic.* as *
| sort -total_bytes</code></pre>
                    </div>
                </section>

                <!-- Incident Review Workflow -->
                <section class="content-section">
                    <h2><i class="fas fa-tasks"></i> Incident Review Workflow</h2>

                    <div class="architecture-diagram" style="background: var(--card-bg); padding: 1.5rem; border-radius: 8px; font-family: monospace; font-size: 0.7rem;">
<pre>
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│   New   │────▶│In       │────▶│ Pending │────▶│Resolved │────▶│ Closed  │
│         │     │Progress │     │         │     │         │     │         │
└─────────┘     └─────────┘     └─────────┘     └─────────┘     └─────────┘
     │               │               │
     │               │               │
     ▼               ▼               ▼
  Assign         Investigate     Await
  Owner          & Document      Action
</pre>
                    </div>

                    <h3>Notable Event Statuses</h3>
                    <table class="styled-table">
                        <tr>
                            <th>Status</th>
                            <th>Description</th>
                            <th>When to Use</th>
                        </tr>
                        <tr>
                            <td><strong>New</strong></td>
                            <td>Unassigned, not investigated</td>
                            <td>Default state from correlation search</td>
                        </tr>
                        <tr>
                            <td><strong>In Progress</strong></td>
                            <td>Analyst actively investigating</td>
                            <td>Analyst picks up the notable</td>
                        </tr>
                        <tr>
                            <td><strong>Pending</strong></td>
                            <td>Waiting on external action</td>
                            <td>Escalated, waiting for response</td>
                        </tr>
                        <tr>
                            <td><strong>Resolved</strong></td>
                            <td>Investigation complete</td>
                            <td>True positive handled, or false positive</td>
                        </tr>
                        <tr>
                            <td><strong>Closed</strong></td>
                            <td>Fully closed</td>
                            <td>No further action needed</td>
                        </tr>
                    </table>

                    <h3>Notable Event Fields</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">SPL</span>
                            <span class="code-title">Query Notable Events</span>
                        </div>
                        <pre><code>// View all open notables
`notable`
| search status_label!="Resolved" AND status_label!="Closed"
| table _time, rule_name, urgency, owner, status_label, security_domain, src, dest, user

// SOC metrics - MTTR
`notable`
| where status_label="Resolved"
| eval resolve_time = status_end - _time
| stats avg(resolve_time) as avg_mttr_seconds by rule_name
| eval avg_mttr_minutes = round(avg_mttr_seconds/60, 2)
| sort -avg_mttr_minutes</code></pre>
                    </div>
                </section>

                <!-- ES Installation -->
                <section class="content-section">
                    <h2><i class="fas fa-download"></i> ES Installation Checklist</h2>

                    <ol>
                        <li><strong>Prerequisites:</strong>
                            <ul>
                                <li>Splunk Enterprise 8.x or 9.x</li>
                                <li>ES license (separate from Splunk license)</li>
                                <li>Search Head (dedicated recommended)</li>
                                <li>8GB+ RAM for ES Search Head</li>
                            </ul>
                        </li>
                        <li><strong>Install ES App:</strong> Upload Splunk_ES.spl to Search Head</li>
                        <li><strong>Install Supporting Add-ons:</strong>
                            <ul>
                                <li>Splunk Common Information Model (CIM)</li>
                                <li>SA-UEBA (if using UEBA features)</li>
                                <li>Technology Add-ons for your data sources</li>
                            </ul>
                        </li>
                        <li><strong>Configure Data Model Acceleration:</strong> Enable acceleration on needed data models</li>
                        <li><strong>Setup Asset & Identity:</strong> Configure asset and identity lookups</li>
                        <li><strong>Enable Correlation Searches:</strong> Review and enable relevant detections</li>
                        <li><strong>Configure Threat Intel:</strong> Add TI feeds if using</li>
                    </ol>
                </section>

                <!-- Interview Section -->
                <section class="content-section interview-section" style="background: linear-gradient(135deg, rgba(101,166,55,0.1), rgba(101,166,55,0.2)); border-radius: 12px; padding: 2rem;">
                    <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>

                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>What is Splunk Enterprise Security and how does it differ from base Splunk?</span>
                        </div>
                        <div class="interview-answer">
                            <p>Splunk Enterprise Security (ES) is a premium SIEM application that runs on top of Splunk Enterprise. While base Splunk is a general-purpose data platform for search, monitoring, and analysis, ES adds security-specific workflows, content, and frameworks.</p>
                            <p><strong>Key differences:</strong></p>
                            <p><strong>Notable Events:</strong> ES provides a dedicated alert queue with investigation workflow. Base Splunk has alerts, but no unified security investigation interface.</p>
                            <p><strong>Correlation Searches:</strong> ES includes 100+ out-of-box security detections mapped to MITRE ATT&CK. Base Splunk requires building alerts from scratch.</p>
                            <p><strong>Data Models:</strong> ES uses CIM-normalized data models for security analytics. tstats queries against accelerated data models are extremely fast.</p>
                            <p><strong>Risk Framework:</strong> ES includes risk-based alerting - assigning risk scores to assets/identities rather than alerting on every event. This dramatically reduces alert fatigue.</p>
                            <p><strong>Asset & Identity:</strong> Built-in enrichment with asset criticality, identity correlation, and business context.</p>
                            <p><strong>Threat Intelligence:</strong> Native TI framework for ingesting and matching IOCs.</p>
                            <p>ES requires a separate license and is typically deployed on dedicated Search Heads for performance.</p>
                        </div>
                    </div>

                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>Explain the role of the Common Information Model (CIM) in Splunk ES.</span>
                        </div>
                        <div class="interview-answer">
                            <p>The Common Information Model (CIM) is a standardized schema that normalizes data from different sources into consistent field names. This is critical for ES because:</p>
                            <p><strong>Vendor-agnostic detection:</strong> A correlation search for failed logins can work across Windows, Linux, Okta, VPN - because they all map to Authentication.action=failure and Authentication.user. Without CIM, you'd need separate rules for each source.</p>
                            <p><strong>Data model acceleration:</strong> CIM data models can be accelerated (pre-computed summaries). Using tstats against accelerated models is 10-100x faster than raw searches. ES correlation searches rely on this for performance.</p>
                            <p><strong>How it works:</strong> Technology Add-ons (TAs) contain props.conf configurations that map source-specific fields to CIM fields via FIELDALIAS, EVAL, and LOOKUP. For example, a Windows TA maps EventCode 4625 to action=failure in the Authentication data model.</p>
                            <p><strong>Key CIM data models for security:</strong> Authentication, Network_Traffic, Endpoint, Web, Email, Malware, Change, Intrusion_Detection.</p>
                            <p>When onboarding a new data source, the first step is always ensuring CIM compliance - either by using an existing TA or creating custom field mappings.</p>
                        </div>
                    </div>
                </section>

            </main>
            
            <footer class="content-footer">
                <div class="footer-content">
                    <p>Nik's SIEM - Splunk Enterprise Security</p>
                    <p>Personal Reference</p>
                </div>
            </footer>
        </div>
    </div>
    
    <script src="../assets/js/main.js"></script>
</body>
</html>
