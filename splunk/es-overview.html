<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Security | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="shared-styles.css">
    <link rel="stylesheet" href="../assets/css/main.css">


</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo"><i class="fas fa-terminal"></i><span>Splunk Reference</span></a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certifications</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-user-graduate" style="color:#7ce38b"></i>Power User</a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog" style="color:#f0883e"></i>Admin</a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt" style="color:#8957e5"></i>ES Admin</a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud" style="color:#39c5cf"></i>Cloud Admin</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Learning</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="when-to-use-what.html" class="sidebar-nav-link"><i class="fas fa-map-signs" style="color:#f0883e"></i>When to Use What</a></li>
                        <li class="sidebar-nav-item"><a href="spl-practice-questions.html" class="sidebar-nav-link"><i class="fas fa-tasks" style="color:#58a6ff"></i>Practice MCQs</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced-mcqs.html" class="sidebar-nav-link"><i class="fas fa-brain" style="color:#a371f7"></i>Advanced MCQs</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Reference</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-code"></i>SPL Fundamentals</a></li>
                        <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-layer-group"></i>SPL Intermediate</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i>SPL Advanced</a></li>
                        <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-lightbulb"></i>Knowledge Objects</a></li>
                        <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i>Data Models</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Administration</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i>Architecture</a></li>
                        <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i>Data Ingestion</a></li>
                        <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-share-alt"></i>Forwarders</a></li>
                        <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i>Clustering & HA</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Enterprise Security</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i>ES Overview</a></li>
                        <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search-plus"></i>Correlation Searches</a></li>
                        <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i>Risk-Based Alerting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Resources</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="lab-exercises.html" class="sidebar-nav-link"><i class="fas fa-flask"></i>Lab Exercises</a></li>
                        <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i>Troubleshooting</a></li>
                    </ul>
                </div>
            </div>
        </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Es Overview</span>
                </div>

                <h1><i class="fas fa-shield-alt"></i> Splunk Enterprise Security (ES)</h1>
                <p class="lead">Splunk Enterprise Security is a premium SIEM solution built on the Splunk platform. It provides security monitoring, incident management, and compliance capabilities for SOC teams.</p>

                <!-- ES COMPONENTS -->
                <h2><i class="fas fa-cubes"></i> ES Core Components</h2>
                
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1c3a5e; color: #58a6ff;"><i class="fas fa-bell"></i></div>
                            <div class="comparison-item-title">Notable Events</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Security incidents/alerts</li>
                            <li><i class="fas fa-check"></i> Created by correlation searches</li>
                            <li><i class="fas fa-check"></i> Workflow: New → In Progress → Resolved</li>
                            <li><i class="fas fa-check"></i> Assignment and ownership</li>
                            <li><i class="fas fa-check"></i> Central investigation queue</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1a4d2e; color: #3fb950;"><i class="fas fa-project-diagram"></i></div>
                            <div class="comparison-item-title">Correlation Searches</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Scheduled detection rules</li>
                            <li><i class="fas fa-check"></i> Uses CIM data models</li>
                            <li><i class="fas fa-check"></i> 100+ built-in detections</li>
                            <li><i class="fas fa-check"></i> Custom rule creation</li>
                            <li><i class="fas fa-check"></i> Adaptive response actions</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #4d3a0d; color: #d29922;"><i class="fas fa-chart-line"></i></div>
                            <div class="comparison-item-title">Risk-Based Alerting</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Accumulate risk scores</li>
                            <li><i class="fas fa-check"></i> Alert on threshold breach</li>
                            <li><i class="fas fa-check"></i> Reduce alert fatigue</li>
                            <li><i class="fas fa-check"></i> User and asset risk</li>
                            <li><i class="fas fa-check"></i> Context-aware detection</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #3d2a5e; color: #a371f7;"><i class="fas fa-search"></i></div>
                            <div class="comparison-item-title">Asset & Identity</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Asset inventory lookup</li>
                            <li><i class="fas fa-check"></i> Identity correlation</li>
                            <li><i class="fas fa-check"></i> Business context enrichment</li>
                            <li><i class="fas fa-check"></i> Priority classification</li>
                            <li><i class="fas fa-check"></i> Automatic enrichment</li>
                        </ul>
                    </div>
                </div>

                <!-- ES WORKFLOW -->
                <h2><i class="fas fa-stream"></i> ES Incident Workflow</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-sitemap"></i> Notable Event Lifecycle</div>
                    
                    <div class="flow-row centered">
                        <div class="flow-box"><div class="flow-box-title">Data Ingestion</div><div class="flow-box-subtitle">Logs arrive</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box primary"><div class="flow-box-title">Data Models</div><div class="flow-box-subtitle">CIM normalization</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box success"><div class="flow-box-title">Correlation</div><div class="flow-box-subtitle">Detection rules</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box warning"><div class="flow-box-title">Notable Event</div><div class="flow-box-subtitle">Incident created</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box purple"><div class="flow-box-title">Investigation</div><div class="flow-box-subtitle">SOC analysis</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box danger"><div class="flow-box-title">Resolution</div><div class="flow-box-subtitle">Close/Escalate</div></div>
                    </div>
                </div>

                <!-- SECURITY DOMAINS -->
                <h2><i class="fas fa-layer-group"></i> ES Security Domains</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr><th>Domain</th><th>Focus Area</th><th>Key Data Models</th><th>Example Detections</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Access</strong></td>
                                <td>Authentication, authorization</td>
                                <td>Authentication, Change</td>
                                <td>Brute force, privilege escalation</td>
                            </tr>
                            <tr>
                                <td><strong>Endpoint</strong></td>
                                <td>Host-based threats</td>
                                <td>Endpoint, Malware</td>
                                <td>Malware, suspicious process</td>
                            </tr>
                            <tr>
                                <td><strong>Network</strong></td>
                                <td>Network traffic</td>
                                <td>Network_Traffic, Network_Sessions</td>
                                <td>Port scan, C2 communication</td>
                            </tr>
                            <tr>
                                <td><strong>Threat</strong></td>
                                <td>Threat intelligence</td>
                                <td>Threat Intelligence</td>
                                <td>IOC matches, known bad IPs</td>
                            </tr>
                            <tr>
                                <td><strong>Identity</strong></td>
                                <td>User behavior</td>
                                <td>Authentication, Change</td>
                                <td>Anomalous behavior, insider threat</td>
                            </tr>
                            <tr>
                                <td><strong>Audit</strong></td>
                                <td>Compliance, audit</td>
                                <td>Change, Audit</td>
                                <td>Policy violations, config changes</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ES DASHBOARDS -->
                <h2><i class="fas fa-tachometer-alt"></i> Key ES Dashboards</h2>
                
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #4d1a1a; color: #f85149;"><i class="fas fa-exclamation-triangle"></i></div>
                            <div class="comparison-item-title">Security Posture</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-chart-pie"></i> Overall security health</li>
                            <li><i class="fas fa-chart-pie"></i> Notable event trends</li>
                            <li><i class="fas fa-chart-pie"></i> Key indicators by domain</li>
                            <li><i class="fas fa-info-circle"></i> Executive summary view</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1c3a5e; color: #58a6ff;"><i class="fas fa-bell"></i></div>
                            <div class="comparison-item-title">Incident Review</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-list"></i> Notable event queue</li>
                            <li><i class="fas fa-list"></i> Filter by status/severity</li>
                            <li><i class="fas fa-list"></i> Assignment tracking</li>
                            <li><i class="fas fa-info-circle"></i> Primary SOC workspace</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1a4d2e; color: #3fb950;"><i class="fas fa-user-secret"></i></div>
                            <div class="comparison-item-title">Risk Analysis</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-users"></i> Top risky users</li>
                            <li><i class="fas fa-server"></i> Top risky assets</li>
                            <li><i class="fas fa-chart-line"></i> Risk score trends</li>
                            <li><i class="fas fa-info-circle"></i> RBA investigation</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #3d2a5e; color: #a371f7;"><i class="fas fa-crosshairs"></i></div>
                            <div class="comparison-item-title">Threat Intelligence</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-globe"></i> IOC match summary</li>
                            <li><i class="fas fa-globe"></i> Threat feed status</li>
                            <li><i class="fas fa-globe"></i> Intel source breakdown</li>
                            <li><i class="fas fa-info-circle"></i> TI enrichment view</li>
                        </ul>
                    </div>
                </div>

                <!-- ENTERPRISE EXAMPLE -->
                <div class="enterprise-example">
                    <div class="enterprise-example-header">
                        <i class="fas fa-building"></i>
                        <div class="enterprise-example-title">Enterprise Example: ES Deployment</div>
                    </div>
                    <div class="enterprise-example-scenario">
                        <strong>Scenario:</strong> Mid-size enterprise (5,000 employees) deploying Splunk ES for their SOC.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 16px;">
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #3fb950; margin-top: 0;">Data Sources</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                <strong>Endpoints:</strong> Windows Event Logs<br>
                                <strong>Network:</strong> Palo Alto, Cisco<br>
                                <strong>Identity:</strong> Active Directory<br>
                                <strong>Cloud:</strong> O365, AWS CloudTrail<br>
                                <strong>Volume:</strong> 200 GB/day
                            </p>
                        </div>
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #58a6ff; margin-top: 0;">Detection Strategy</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                <strong>OOTB rules:</strong> 80 enabled<br>
                                <strong>Custom rules:</strong> 25<br>
                                <strong>RBA rules:</strong> 50 contributing<br>
                                <strong>TI feeds:</strong> 5 active<br>
                                <strong>Data models:</strong> All accelerated
                            </p>
                        </div>
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #d29922; margin-top: 0;">SOC Metrics</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                <strong>Notables/day:</strong> ~150<br>
                                <strong>False positive rate:</strong> 20%<br>
                                <strong>MTTD:</strong> 5 minutes<br>
                                <strong>MTTR:</strong> 45 minutes<br>
                                <strong>Team size:</strong> 6 analysts
                            </p>
                        </div>
                    </div>
                </div>

                <!-- INCIDENT REVIEW DEEP DIVE -->
                <h2><i class="fas fa-clipboard-list"></i> Incident Review Dashboard</h2>
                <div class="config-section">
                    <h3>The Heart of SOC Operations</h3>
                    <p>Incident Review is where analysts spend 80% of their time. Master this dashboard.</p>
                    
                    <div class="info-box info-box-info">
                        <h4><i class="fas fa-store"></i> Sobeys SOC Context</h4>
                        <p>With 1,500+ stores generating ~500 notable events/day, efficient triage is critical. Target: &lt;2 min initial triage per notable.</p>
                    </div>

                    <div class="arch-diagram">
INCIDENT REVIEW WORKFLOW
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                         INCIDENT REVIEW DASHBOARD                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  FILTERS:  [Time: -24h ▼] [Status: New ▼] [Urgency: All ▼] [Owner: * ▼]   │
│                                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  NOTABLE EVENT LIST                                                          │
│  ┌────────┬───────────┬─────────────────────────┬────────┬────────┬──────┐ │
│  │ Time   │ Urgency   │ Rule Name               │ User   │ Status │ Own  │ │
│  ├────────┼───────────┼─────────────────────────┼────────┼────────┼──────┤ │
│  │ 09:15  │ CRITICAL  │ Multiple Failed Logins  │ jsmith │ New    │ --   │ │
│  │ 09:12  │ HIGH      │ Suspicious Process      │ srv01  │ New    │ --   │ │
│  │ 09:10  │ MEDIUM    │ Unusual Network Traffic │ 10.1.x │ New    │ --   │ │
│  └────────┴───────────┴─────────────────────────┴────────┴────────┴──────┘ │
│                                                                              │
│  CLICK ROW TO EXPAND ──────────────────────────────────────────────────────▶│
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │ NOTABLE DETAILS                                                          ││
│  │ Rule: Multiple Failed Logins to Single Host                              ││
│  │ Description: 50 failed logins from 10.1.5.20 to DC01 in 5 minutes       ││
│  │                                                                          ││
│  │ CONTRIBUTING EVENTS (click to drill down):                               ││
│  │ - 50 events from index=wineventlog EventCode=4625                       ││
│  │                                                                          ││
│  │ ADAPTIVE RESPONSE ACTIONS:                                               ││
│  │ [Run Scan ▼] [Disable User ▼] [Block IP ▼] [Create Ticket ▼]            ││
│  │                                                                          ││
│  │ DISPOSITION:                                                             ││
│  │ Status: [In Progress ▼]  Owner: [analyst1 ▼]  Comment: [________]       ││
│  │ [Save]                                                                   ││
│  └─────────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────┘

KEY ACTIONS IN INCIDENT REVIEW:
───────────────────────────────────────────────────────────────────────────────
1. FILTER by urgency (Critical first) and status (New)
2. CLAIM notable by setting yourself as owner
3. INVESTIGATE by clicking contributing events
4. RUN ADAPTIVE RESPONSE actions if needed
5. DISPOSITION with appropriate status and comments
6. CLOSE with resolution category

NOTABLE STATUS OPTIONS:
───────────────────────────────────────────────────────────────────────────────
• New           → Not yet reviewed
• In Progress   → Under investigation
• Pending       → Waiting for external input
• Resolved      → Confirmed threat, remediated
• Closed        → Not a threat (with disposition reason)
                    </div>

                    <h4>Incident Review SPL Queries</h4>
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Query Notable Events Directly</span>
                        </div>
                        <pre><code>` Get all notables from last 24h with store context `
index=notable earliest=-24h
| lookup store_info.csv store_id OUTPUT store_name, region
| eval age_hours = round((now() - _time) / 3600, 1)
| table _time, urgency, rule_name, src, dest, user, store_name, region, status, owner, age_hours
| sort -urgency, -_time

` Count notables by status for SOC metrics `
index=notable earliest=-24h
| stats count by status
| addtotals

` Calculate MTTR (Mean Time to Resolve) `
index=notable status="closed" earliest=-7d
| eval resolution_time = status_time - _time
| stats avg(resolution_time) as avg_mttr, median(resolution_time) as median_mttr
| eval avg_mttr_hours = round(avg_mttr / 3600, 2)
| eval median_mttr_hours = round(median_mttr / 3600, 2)</code></pre>
                    </div>
                </div>

                <!-- INVESTIGATION WORKBENCH -->
                <h2><i class="fas fa-search-plus"></i> Investigation Workbench (ES 7.x+)</h2>
                <div class="config-section">
                    <h3>Advanced Investigation Interface</h3>
                    <p>Investigation Workbench provides visual investigation with automatic entity correlation and timeline views.</p>

                    <div class="arch-diagram">
INVESTIGATION WORKBENCH FEATURES
═══════════════════════════════════════════════════════════════════════════════

1. ENTITY INVESTIGATION
   ─────────────────────────────────────────────────────────────────────────
   • Select user, host, or IP to investigate
   • Automatic correlation across all data sources
   • Timeline of all related events
   • Risk score history

2. VISUAL INVESTIGATION GRAPH
   ─────────────────────────────────────────────────────────────────────────
   [User: jsmith] ──login──▶ [Host: WKS001] ──network──▶ [IP: 192.168.1.50]
         │                         │                           │
         ▼                         ▼                           ▼
   [Process: powershell]    [File: temp.exe]         [External IP: 45.x.x.x]
   
   • Nodes = Entities (users, hosts, IPs, files, processes)
   • Edges = Relationships (login, network connection, process spawn)
   • Color = Risk level
   • Size = Event count

3. TIMELINE VIEW
   ─────────────────────────────────────────────────────────────────────────
   09:00 ──┬── User jsmith logs into WKS001
           │
   09:05 ──┼── PowerShell spawned with encoded command
           │
   09:06 ──┼── Outbound connection to 45.x.x.x:443
           │
   09:07 ──┼── File temp.exe created in C:\Users\jsmith\AppData
           │
   09:10 ──┴── Notable event triggered: Suspicious Process Chain

4. INVESTIGATION ACTIONS
   ─────────────────────────────────────────────────────────────────────────
   • Add to investigation (case management)
   • Run adaptive response
   • Add to threat intelligence (IOC)
   • Export timeline to PDF
                    </div>

                    <h4>Investigation Workbench Best Practices</h4>
                    <ul>
                        <li><strong>Start from Notable:</strong> Always begin investigation from a notable event for context</li>
                        <li><strong>Expand carefully:</strong> Don't expand all nodes - focus on suspicious relationships</li>
                        <li><strong>Use time bounds:</strong> Limit investigation to relevant time window</li>
                        <li><strong>Document in comments:</strong> Add investigation notes to notable for audit trail</li>
                    </ul>
                </div>

                <!-- GLASS TABLES -->
                <h2><i class="fas fa-table"></i> Glass Tables</h2>
                <div class="config-section">
                    <h3>Visual Security Monitoring</h3>
                    <p>Glass Tables are visual representations of your environment with real-time security status overlays.</p>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Glass Table Configuration</span>
                        </div>
                        <pre><code>` Glass Table shows visual representation with overlays `
` Example: Network topology with threat indicators `

Configuration Steps:
1. Navigate: ES → Security Intelligence → Glass Tables
2. Create New Glass Table
3. Upload background image (network diagram, floor plan, etc.)
4. Add indicators (icons that show status)
5. Configure indicator searches:

` Indicator: Firewall Health `
index=pan_system severity=critical earliest=-15m
| stats count as critical_events
| eval status = if(critical_events > 0, "critical", "normal")

` Indicator: DC Health `
index=wineventlog host="DC*" EventCode IN (4625, 4771) earliest=-15m
| stats count as auth_failures
| eval status = case(
    auth_failures > 100, "critical",
    auth_failures > 50, "warning",
    1=1, "normal"
)

6. Position indicators on background image
7. Set refresh interval (60 seconds typical)
8. Save and display on SOC monitors</code></pre>
                    </div>

                    <div class="info-box info-box-tip">
                        <h4>Sobeys Glass Table Ideas</h4>
                        <ul>
                            <li><strong>Store Map:</strong> Canada map with store locations, color-coded by alert status</li>
                            <li><strong>POS Network:</strong> Network diagram showing POS terminals with fraud indicators</li>
                            <li><strong>Data Center:</strong> Server rack view with health status</li>
                            <li><strong>Regional Overview:</strong> Atlantic, Quebec, Ontario, West with key metrics</li>
                        </ul>
                    </div>
                </div>

                <!-- ADAPTIVE RESPONSE -->
                <h2><i class="fas fa-bolt"></i> Adaptive Response Framework</h2>
                <div class="config-section">
                    <h3>Automated Response Actions</h3>
                    <p>Adaptive Response allows automated or analyst-triggered response actions from notable events.</p>

                    <div class="arch-diagram">
ADAPTIVE RESPONSE ACTIONS
═══════════════════════════════════════════════════════════════════════════════

BUILT-IN ACTIONS:
─────────────────────────────────────────────────────────────────────────────
• Run Script        → Execute custom script on Splunk server
• Send Email        → Alert notification
• Create Ticket     → ServiceNow, Jira integration
• Add to Lookup     → Update threat list or watchlist
• Risk Notable      → Generate risk event
• Stream Events     → Forward to external system

THIRD-PARTY ACTIONS (via Add-ons):
─────────────────────────────────────────────────────────────────────────────
• CrowdStrike       → Contain host, run RTR command
• Palo Alto         → Block IP at firewall
• Active Directory  → Disable user account
• Carbon Black      → Isolate endpoint
• ServiceNow        → Create incident ticket
• Phantom/SOAR      → Trigger playbook

SOBEYS COMMON ADAPTIVE RESPONSES:
─────────────────────────────────────────────────────────────────────────────
┌─────────────────────────┬───────────────────────────────────────────────────┐
│ Notable Type            │ Recommended Response                              │
├─────────────────────────┼───────────────────────────────────────────────────┤
│ Brute Force Attack      │ Block IP at firewall + Alert SOC                  │
│ Malware Detected        │ Isolate endpoint + Create ticket                  │
│ Privileged Access       │ Alert security team + Add to watchlist            │
│ POS Fraud Indicator     │ Add to LP watchlist + Alert store manager         │
│ Data Exfiltration       │ Block destination + Isolate source + Escalate     │
│ SAP Critical Activity   │ Alert SAP security + Create SNOW incident         │
└─────────────────────────┴───────────────────────────────────────────────────┘
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Configure Adaptive Response in Correlation Search</span>
                        </div>
                        <pre><code>` In savedsearches.conf `
[Brute Force Attack Detection]
search = | tstats count FROM datamodel=Authentication.Failed_Authentication \
         WHERE * BY Authentication.src, Authentication.dest \
         | where count > 20
action.notable = 1
action.notable.param.rule_title = Brute Force Attack
action.notable.param.severity = high

` Add adaptive response - block at firewall `
action.send_to_palo_alto_firewall = 1
action.send_to_palo_alto_firewall.param.action = block
action.send_to_palo_alto_firewall.param.ip_field = src

` Add adaptive response - create ServiceNow ticket `
action.snow_incident = 1
action.snow_incident.param.category = Security
action.snow_incident.param.priority = 2</code></pre>
                    </div>
                </div>

                <!-- ASSET & IDENTITY FRAMEWORK -->
                <h2><i class="fas fa-users-cog"></i> Asset & Identity Framework</h2>
                <div class="config-section">
                    <h3>Context-Aware Detection</h3>
                    <p>Asset & Identity data enriches events with business context, enabling smarter detection and prioritization.</p>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Asset Lookup (assets.csv)</span>
                        </div>
                        <pre><code>ip,mac,nt_host,dns,owner,priority,lat,long,city,country,bunit,category,pci_domain,is_expected,should_timesync,should_update,requires_av
10.1.1.10,00:11:22:33:44:55,DC01,dc01.sobeys.com,IT Infrastructure,critical,44.6488,-63.5752,Halifax,Canada,IT,server,cardholder,true,true,true,true
10.1.1.20,00:11:22:33:44:56,SQL01,sql01.sobeys.com,DBA Team,high,44.6488,-63.5752,Halifax,Canada,IT,server,cardholder,true,true,true,true
10.2.1.100,00:11:22:33:44:57,POS-STR001-01,pos001.sobeys.com,Store 001,medium,44.6488,-63.5752,Halifax,Canada,Retail,pos,cardholder,true,true,true,true</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Identity Lookup (identities.csv)</span>
                        </div>
                        <pre><code>identity,prefix,nick,first,last,suffix,email,phone,managedBy,priority,bunit,category,watchlist,startDate,endDate
jsmith,Mr,John,John,Smith,,jsmith@sobeys.com,902-555-1234,mwilson,medium,IT,employee,false,2020-01-15,
mwilson,Ms,Mary,Mary,Wilson,,mwilson@sobeys.com,902-555-5678,,high,IT,manager,false,2015-06-01,
admin_sap,,,SAP,Admin,,sap.admin@sobeys.com,,,critical,IT,service_account,true,2018-01-01,</code></pre>
                    </div>

                    <h4>Using Asset/Identity in Searches</h4>
                    <div class="config-block">
                        <pre><code>` Enrich authentication events with identity context `
| tstats count FROM datamodel=Authentication 
  WHERE Authentication.action="failure" 
  BY Authentication.user, Authentication.src, Authentication.dest
| lookup identity_lookup_expanded identity as Authentication.user 
  OUTPUT priority as user_priority, bunit, category, watchlist
| where user_priority="critical" OR watchlist="true"

` Enrich network events with asset context `
| tstats sum(All_Traffic.bytes) as bytes 
  FROM datamodel=Network_Traffic 
  BY All_Traffic.src, All_Traffic.dest
| lookup asset_lookup_by_str ip as All_Traffic.dest 
  OUTPUT priority as dest_priority, category as dest_category, pci_domain
| where pci_domain="cardholder"</code></pre>
                    </div>

                    <div class="info-box info-box-warning">
                        <h4>Sobeys Asset/Identity Requirements</h4>
                        <ul>
                            <li><strong>POS Terminals:</strong> All 10,000+ devices must be in asset lookup with pci_domain=cardholder</li>
                            <li><strong>Store Employees:</strong> Sync from HR system for accurate identity data</li>
                            <li><strong>Service Accounts:</strong> Mark as watchlist=true for extra scrutiny</li>
                            <li><strong>Critical Assets:</strong> DCs, SAP servers, payment systems = priority=critical</li>
                        </ul>
                    </div>
                </div>

                <!-- RISK FRAMEWORK -->
                <h2><i class="fas fa-chart-line"></i> Risk Framework Deep Dive</h2>
                <div class="config-section">
                    <h3>Advanced Risk Configuration</h3>
                    <p>Fine-tune risk scoring for your environment.</p>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Risk Framework Components</span>
                        </div>
                        <pre><code>RISK FRAMEWORK ARCHITECTURE
═══════════════════════════════════════════════════════════════════════════════

                    ┌─────────────────────────────────────────┐
                    │         CORRELATION SEARCH              │
                    │   (Detection Rule)                      │
                    └─────────────────┬───────────────────────┘
                                      │
                                      ▼
                    ┌─────────────────────────────────────────┐
                    │           RISK MODIFIER                 │
                    │  • risk_object (user/host/IP)           │
                    │  • risk_object_type                     │
                    │  • risk_score (1-100)                   │
                    │  • risk_message                         │
                    └─────────────────┬───────────────────────┘
                                      │
                                      ▼
                    ┌─────────────────────────────────────────┐
                    │           RISK INDEX                    │
                    │   index=risk                            │
                    └─────────────────┬───────────────────────┘
                                      │
                                      ▼
                    ┌─────────────────────────────────────────┐
                    │      RISK AGGREGATION SEARCH            │
                    │  Sum risk_score BY risk_object          │
                    │  WHERE total_risk > threshold           │
                    └─────────────────┬───────────────────────┘
                                      │
                                      ▼
                    ┌─────────────────────────────────────────┐
                    │         RISK NOTABLE                    │
                    │  Generated when threshold exceeded      │
                    └─────────────────────────────────────────┘</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Risk Score Guidelines for Sobeys</span>
                        </div>
                        <pre><code>RISK SCORE GUIDELINES
═══════════════════════════════════════════════════════════════════════════════

SCORE RANGES:
─────────────────────────────────────────────────────────────────────────────
  1-20:  Informational (log for context, rarely investigate alone)
         Example: User logged in from new location

 21-40:  Low (investigate if combined with other signals)
         Example: After-hours login, failed password attempt

 41-60:  Medium (worth investigating, likely tuning needed)
         Example: Multiple failed logins, unusual process

 61-80:  High (likely malicious, investigate promptly)
         Example: Malware signature, privilege escalation

 81-100: Critical (confirmed threat or critical asset involved)
         Example: Ransomware execution, DC compromise

SOBEYS-SPECIFIC RISK MODIFIERS:
─────────────────────────────────────────────────────────────────────────────
┌───────────────────────────────────┬───────┬─────────────────────────────────┐
│ Detection                         │ Score │ Notes                           │
├───────────────────────────────────┼───────┼─────────────────────────────────┤
│ Failed login to POS terminal      │ 10    │ Common, needs volume threshold  │
│ Failed login to DC                │ 30    │ More concerning target          │
│ Failed login to SAP               │ 40    │ Critical business system        │
│ Post-tender void (POS)            │ 50    │ Fraud indicator                 │
│ PowerShell encoded command        │ 60    │ Common attack technique         │
│ Service account interactive login │ 70    │ Should never happen             │
│ SAP debug mode enabled            │ 80    │ Critical fraud indicator        │
│ Ransomware IOC match              │ 100   │ Immediate response required     │
└───────────────────────────────────┴───────┴─────────────────────────────────┘

RISK THRESHOLD CONFIGURATION:
─────────────────────────────────────────────────────────────────────────────
Default thresholds (24h rolling):
• User threshold: 100 points → Generate notable
• Host threshold: 100 points → Generate notable

Sobeys recommended:
• User threshold: 75 points (catch fraud faster)
• Host threshold: 100 points (standard)
• PCI assets: 50 points (extra scrutiny for cardholder environment)</code></pre>
                    </div>
                </div>

                <!-- CONTENT MANAGEMENT -->
                <h2><i class="fas fa-folder-open"></i> Content Management</h2>
                <div class="config-section">
                    <h3>Managing Detection Content Lifecycle</h3>
                    
                    <div class="arch-diagram">
DETECTION CONTENT LIFECYCLE
═══════════════════════════════════════════════════════════════════════════════

1. CONTENT SOURCES
   ─────────────────────────────────────────────────────────────────────────
   • ES OOTB rules (~1,200 pre-built)
   • ESCU (ES Content Update) - monthly updates from Splunk
   • Custom rules (organization-specific)
   • Threat research (MITRE, vendor advisories)
   • Incident learnings

2. CONTENT STATES
   ─────────────────────────────────────────────────────────────────────────
   Development → Testing → Production → Tuning → Deprecated
   
   • Development: New rule being written
   • Testing: Validation in non-prod or limited scope
   • Production: Enabled and generating alerts
   • Tuning: Adjusting thresholds based on FP rate
   • Deprecated: No longer relevant, disabled

3. ESCU (Enterprise Security Content Update)
   ─────────────────────────────────────────────────────────────────────────
   Location: Settings → Content Management → Content Updates
   
   Updates include:
   • New correlation searches
   • Updated threat intelligence
   • MITRE ATT&CK mappings
   • Bug fixes
   
   Best Practice: Review ESCU notes before applying, test in non-prod

4. CUSTOM CONTENT MANAGEMENT
   ─────────────────────────────────────────────────────────────────────────
   Naming convention: [ORG]_[CATEGORY]_[TECHNIQUE]_[VERSION]
   
   Examples:
   • SOBEYS_POS_PostTenderVoid_v1
   • SOBEYS_SAP_DebugModeEnabled_v2
   • SOBEYS_AD_ServiceAccountInteractiveLogin_v1
   
   Documentation requirements:
   • Description with business context
   • MITRE ATT&CK mapping
   • Data source requirements
   • Tuning guidance
   • Response playbook link
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: Walk me through how you would investigate a notable event in Splunk ES.</button>
                        <div class="qa-answer">
                            <p><strong>Investigation workflow:</strong></p>
                            <ol>
                                <li><strong>Triage (1-2 min):</strong> Review notable details, urgency, rule description. Claim ownership.</li>
                                <li><strong>Context gathering (5-10 min):</strong>
                                    <ul>
                                        <li>Check Asset/Identity data - is this a critical asset or privileged user?</li>
                                        <li>Review contributing events (drill down from notable)</li>
                                        <li>Check for related notables (same user/host)</li>
                                        <li>Check risk score history for the entity</li>
                                    </ul>
                                </li>
                                <li><strong>Pivot searches:</strong> Search for related activity across data sources</li>
                                <li><strong>Determine if true positive:</strong> Based on evidence</li>
                                <li><strong>Response:</strong> If confirmed, run adaptive response actions</li>
                                <li><strong>Document:</strong> Add investigation notes to notable</li>
                                <li><strong>Disposition:</strong> Close with appropriate status and category</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: What is Risk-Based Alerting and why is it better than traditional alerting?</button>
                        <div class="qa-answer">
                            <p><strong>Traditional alerting problems:</strong></p>
                            <ul>
                                <li>Each rule generates its own alert → alert fatigue</li>
                                <li>Low-fidelity rules either generate noise or get disabled</li>
                                <li>No correlation between related events</li>
                            </ul>
                            <p><strong>RBA solution:</strong></p>
                            <ul>
                                <li>Low-fidelity detections contribute risk scores instead of alerts</li>
                                <li>Risk scores accumulate per entity (user, host)</li>
                                <li>Alert only when cumulative risk exceeds threshold</li>
                                <li>Result: Fewer, higher-fidelity alerts with full context</li>
                            </ul>
                            <p><strong>Example:</strong> Instead of alerting on every failed login (noisy), assign 10 risk points. If same user also has unusual process execution (+40), and data exfiltration indicator (+50), total = 100 → single high-context alert.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How do you maintain and update detection content in ES?</button>
                        <div class="qa-answer">
                            <p><strong>Content management strategy:</strong></p>
                            <ol>
                                <li><strong>ESCU Updates:</strong> Review and apply monthly Enterprise Security Content Updates. Always test in non-prod first.</li>
                                <li><strong>Custom Content:</strong>
                                    <ul>
                                        <li>Use consistent naming convention</li>
                                        <li>Document in wiki with MITRE mapping</li>
                                        <li>Version control (Git for savedsearches.conf)</li>
                                        <li>Peer review before production</li>
                                    </ul>
                                </li>
                                <li><strong>Tuning Cycle:</strong> Weekly review of FP rates, adjust thresholds</li>
                                <li><strong>Deprecation:</strong> Disable rules that are no longer relevant, document why</li>
                                <li><strong>Metrics:</strong> Track detection effectiveness (TP rate, MTTD, coverage)</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: What's the difference between Splunk Core and Enterprise Security?</button>
                        <div class="qa-answer">
                            <p><strong>Splunk Core (Enterprise):</strong></p>
                            <ul>
                                <li>General-purpose data platform</li>
                                <li>Search, dashboards, alerts</li>
                                <li>No security-specific features</li>
                                <li>Basic alerting only</li>
                            </ul>
                            <p><strong>Enterprise Security (ES):</strong></p>
                            <ul>
                                <li>Premium security app on top of Core</li>
                                <li>Notable events with workflow</li>
                                <li>CIM-based correlation searches</li>
                                <li>Risk-based alerting</li>
                                <li>Asset/Identity framework</li>
                                <li>Security-specific dashboards</li>
                                <li>Incident investigation tools</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How do you tune ES to reduce false positives?</button>
                        <div class="qa-answer">
                            <p><strong>ES tuning strategies:</strong></p>
                            <ul>
                                <li><strong>Threshold adjustment:</strong> Increase counts for noisy rules</li>
                                <li><strong>Suppression:</strong> Suppress repeated alerts per entity</li>
                                <li><strong>Lookup whitelists:</strong> Create exception lists</li>
                                <li><strong>Asset/Identity context:</strong> Tune based on asset criticality</li>
                                <li><strong>RBA migration:</strong> Convert noisy rules to risk modifiers</li>
                                <li><strong>Time-based suppression:</strong> Exclude maintenance windows</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: Explain the Asset and Identity framework in ES.</button>
                        <div class="qa-answer">
                            <p><strong>Purpose:</strong> Provide business context for security events.</p>
                            <p><strong>Asset Lookup:</strong></p>
                            <ul>
                                <li>Contains all known hosts/IPs with metadata</li>
                                <li>Key fields: ip, hostname, owner, priority, bunit, category, pci_domain</li>
                                <li>Used to prioritize alerts (critical asset = higher priority)</li>
                            </ul>
                            <p><strong>Identity Lookup:</strong></p>
                            <ul>
                                <li>Contains all known users with metadata</li>
                                <li>Key fields: identity, first, last, email, priority, bunit, watchlist</li>
                                <li>Used to identify privileged users, watchlist individuals</li>
                            </ul>
                            <p><strong>Integration:</strong></p>
                            <ul>
                                <li>Automatically enriches CIM-compliant events</li>
                                <li>Enables filtering by business unit, priority, category</li>
                                <li>Requires regular sync from CMDB/AD/HR systems</li>
                            </ul>
                        </div>
                    </div>
                </div>

                

                <!-- Real-World Use Cases -->
                </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>