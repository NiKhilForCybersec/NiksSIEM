<!DOCTYPE html>
<html lang="en" data-theme="dark" data-platform="splunk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retention & Buckets - Splunk Storage Tiers | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="index.html" class="platform-tab splunk active"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
                        <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Pipeline</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="forwarders.html" class="nav-link"><i class="fas fa-share"></i> Forwarders Deep Dive</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                    <a href="data-models.html" class="nav-link"><i class="fas fa-cubes"></i> Data Models & CIM</a>
                    <a href="retention-tiers.html" class="nav-link active"><i class="fas fa-archive"></i> Retention & Buckets</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SPL Query Language</div>
                    <a href="spl-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> SPL Fundamentals</a>
                    <a href="spl-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> SPL Intermediate</a>
                    <a href="spl-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced SPL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Enterprise Security</div>
                    <a href="es-overview.html" class="nav-link"><i class="fas fa-shield-alt"></i> ES Overview</a>
                    <a href="correlation-searches.html" class="nav-link"><i class="fas fa-search-plus"></i> Correlation Searches</a>
                    <a href="notable-events.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Notable Events</a>
                    <a href="risk-based-alerting.html" class="nav-link"><i class="fas fa-chart-line"></i> Risk-Based Alerting</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">TI & Automation</div>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intelligence</a>
                    <a href="soar.html" class="nav-link"><i class="fas fa-robot"></i> Splunk SOAR</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="apps-tas.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> Apps & TAs</a>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-wrench"></i> Troubleshooting</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-archive"></i> Retention & Buckets</h1>
                    <p class="lead">Splunk bucket lifecycle from hot to frozen with indexes.conf configuration</p>
                </div>

                <section class="content-section">
                    <h2><i class="fas fa-database"></i> Bucket Lifecycle</h2>
                    
                    <div class="architecture-diagram" style="background: var(--card-bg); padding: 1.5rem; border-radius: 8px; font-family: monospace; font-size: 0.7rem;">
<pre>
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│   HOT   │────▶│  WARM   │────▶│  COLD   │────▶│ FROZEN  │
│         │     │         │     │         │     │         │
│ Writing │     │Read-only│     │Read-only│     │ Archive │
│   SSD   │     │  SSD    │     │ HDD/NAS │     │ S3/Blob │
└─────────┘     └─────────┘     └─────────┘     └─────────┘
     │               │               │               │
     │               │               │               │
 Searchable      Searchable      Searchable       Thaw to
   Fast            Fast            Slower          search
</pre>
                    </div>

                    <table class="styled-table">
                        <thead>
                            <tr><th>Tier</th><th>State</th><th>Storage</th><th>Transition Trigger</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Hot</strong></td><td>Actively writing</td><td>Fast SSD</td><td>maxDataSize or maxHotSpanSecs</td></tr>
                            <tr><td><strong>Warm</strong></td><td>Read-only</td><td>SSD/HDD</td><td>maxWarmDBCount exceeded</td></tr>
                            <tr><td><strong>Cold</strong></td><td>Read-only</td><td>HDD/NAS</td><td>frozenTimePeriodInSecs exceeded</td></tr>
                            <tr><td><strong>Frozen</strong></td><td>Archived</td><td>S3/Blob/deleted</td><td>Volume limit or time</td></tr>
                        </tbody>
                    </table>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-cog"></i> indexes.conf Configuration</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">conf</span>
                            <span class="code-title">indexes.conf Examples</span>
                        </div>
                        <pre><code># Security logs - 1 year retention
[security]
homePath = $SPLUNK_DB/security/db
coldPath = /mnt/cold/security/colddb
thawedPath = $SPLUNK_DB/security/thaweddb
maxTotalDataSizeMB = 1000000
frozenTimePeriodInSecs = 31536000  # 365 days
coldToFrozenDir = /mnt/archive/security

# High-volume network logs - 30 days
[netflow]
homePath = $SPLUNK_DB/netflow/db
coldPath = $SPLUNK_DB/netflow/colddb
thawedPath = $SPLUNK_DB/netflow/thaweddb
maxTotalDataSizeMB = 2000000
frozenTimePeriodInSecs = 2592000  # 30 days
# No coldToFrozenDir = data deleted</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-cloud"></i> SmartStore (Cloud Tiering)</h2>
                    <p>SmartStore moves warm/cold data to S3/GCS/Azure Blob while caching locally:</p>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">conf</span>
                            <span class="code-title">SmartStore Configuration</span>
                        </div>
                        <pre><code>[volume:remote_store]
storageType = remote
path = s3://my-splunk-bucket/
remote.s3.access_key = AKIAXXXXXXXX
remote.s3.secret_key = xxxxxxxxxx

[security]
remotePath = volume:remote_store/$_index_name
# Hot stays local, warm/cold in S3 with local cache</code></pre>
                    </div>
                </section>

                <section class="content-section interview-section" style="background: linear-gradient(135deg, rgba(101,166,55,0.1), rgba(101,166,55,0.2)); border-radius: 12px; padding: 2rem;">
                    <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>Explain the Splunk bucket lifecycle and how to configure retention.</span>
                        </div>
                        <div class="interview-answer">
                            <p>Splunk organizes data in buckets that move through lifecycle stages:</p>
                            <p><strong>Hot:</strong> Actively receiving data, on fast storage. Rolls to warm when maxDataSize (750MB default) or maxHotSpanSecs is reached.</p>
                            <p><strong>Warm:</strong> Read-only, still fast. Rolls to cold when bucket count exceeds maxWarmDBCount.</p>
                            <p><strong>Cold:</strong> Read-only, can be on slower storage (coldPath). Rolls to frozen based on frozenTimePeriodInSecs.</p>
                            <p><strong>Frozen:</strong> Either deleted or archived. Set coldToFrozenDir to archive raw data.</p>
                            <p><strong>Configuration:</strong> In indexes.conf, define paths for each tier and retention limits. Different indexes can have different retention - security logs might keep 1 year, netflow only 30 days.</p>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
</body>
</html>
