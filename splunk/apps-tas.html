<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apps & Technology Add-ons | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link active" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Splunk Pages</div>
                <ul class="sidebar-nav">
                                        <li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-onboarding.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Onboarding</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="apps-tas.html" class="sidebar-nav-link active">
                            <i class="fas fa-puzzle-piece"></i>
                            <span>Apps & TAs</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="custom-log-onboarding.html" class="sidebar-nav-link">
                            <i class="fas fa-plus-circle"></i>
                            <span>Custom Log Onboarding</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-filter"></i>
                            <span>Parsing & Props/Transforms</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-archive"></i>
                            <span>Index & Retention</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>SPL Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-rocket"></i>
                            <span>SPL Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="es-overview.html" class="sidebar-nav-link">
                            <i class="fas fa-shield-alt"></i>
                            <span>Enterprise Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="correlation-searches.html" class="sidebar-nav-link">
                            <i class="fas fa-search"></i>
                            <span>Correlation Searches</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="notable-events.html" class="sidebar-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Notable Events</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="risk-based-alerting.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Risk-Based Alerting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-skull-crossbones"></i>
                            <span>Threat Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soar.html" class="sidebar-nav-link">
                            <i class="fas fa-robot"></i>
                            <span>SOAR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="dashboards.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-line"></i>
                            <span>Dashboards</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="administration.html" class="sidebar-nav-link">
                            <i class="fas fa-cog"></i>
                            <span>Administration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="troubleshooting.html" class="sidebar-nav-link">
                            <i class="fas fa-tools"></i>
                            <span>Troubleshooting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-scenarios.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Enterprise Scenarios</span>
                        </a>
                    </li>
<li class="sidebar-nav-item">
                        <a href="data-ingestion.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Ingestion</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-models.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Models</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-scenarios.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Enterprise Scenarios</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-security.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Enterprise Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="es-overview.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Es Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="forwarders.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Forwarders</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="notable-events.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-circle"></i>
                            <span>Notable Events</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Parsing Flows</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Retention Tiers</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="risk-based-alerting.html" class="sidebar-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Risk Based Alerting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="security-usecases.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Security Usecases</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soar.html" class="sidebar-nav-link">
                            <i class="fas fa-robot"></i>
                            <span>Soar</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>Spl Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Spl Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-intermediate.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Spl Intermediate</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-hunting.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Hunting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Intel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="troubleshooting.html" class="sidebar-nav-link">
                            <i class="fas fa-wrench"></i>
                            <span>Troubleshooting</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Apps Tas</span>
                </div>

                <h1><i class="fas fa-puzzle-piece"></i> Apps & Technology Add-ons (TAs)</h1>
                <p class="lead">Complete guide to Technology Add-ons: what they are, how they work, and step-by-step configuration for critical security sources including Windows, CrowdStrike, and Palo Alto.</p>

                <!-- What are TAs -->
                <h2><i class="fas fa-info-circle"></i> Understanding Technology Add-ons</h2>
                <div class="config-section">
                    <div class="arch-diagram">
TECHNOLOGY ADD-ONS (TAs) - WHAT THEY ARE
═══════════════════════════════════════════════════════════════════════════════

DEFINITION:
  Technology Add-ons are packages that extend Splunk's ability to collect,
  parse, and normalize data from specific sources. They contain:
  
  • inputs.conf     - Define data collection (what to collect)
  • props.conf      - Define parsing rules (how to parse)
  • transforms.conf - Advanced parsing and routing
  • eventtypes.conf - Event categorization
  • tags.conf       - CIM data model mapping

WHERE TAs ARE INSTALLED:
─────────────────────────────────────────────────────────────────────────────

  ┌─────────────────────────────────────────────────────────────────────────┐
  │                    TA DEPLOYMENT LOCATIONS                              │
  ├─────────────────────────────────────────────────────────────────────────┤
  │                                                                         │
  │  FORWARDERS (UF/HF)                    SEARCH HEADS                    │
  │  ─────────────────                     ────────────                    │
  │  Install TAs for INPUT collection      Install TAs for PARSING         │
  │                                                                         │
  │  • inputs.conf (what to collect)       • props.conf (field extraction) │
  │  • Only if TA defines inputs           • eventtypes.conf (categories)  │
  │                                        • tags.conf (CIM mapping)        │
  │                                                                         │
  │  ┌─────────────────┐                   ┌─────────────────┐             │
  │  │ Universal       │                   │ Search Head     │             │
  │  │ Forwarder       │──────────────────▶│ Cluster         │             │
  │  │                 │                   │                 │             │
  │  │ Collects data   │                   │ Parses &        │             │
  │  │ Sends to indexer│                   │ extracts fields │             │
  │  └─────────────────┘                   └─────────────────┘             │
  │                                                                         │
  │  HEAVY FORWARDERS                      INDEXERS                        │
  │  ─────────────────                     ────────                        │
  │  Install TAs for BOTH                  Usually NOT needed              │
  │  • Input collection                    • Unless index-time transforms  │
  │  • Local parsing before forwarding     • Or heavy forwarder pattern    │
  │                                                                         │
  └─────────────────────────────────────────────────────────────────────────┘

TA vs APP vs ADD-ON:
─────────────────────────────────────────────────────────────────────────────
  • TA (Technology Add-on): Data input and parsing only, no UI
  • App: Full application with dashboards, reports, UI
  • Add-on: General term, can be either

NAMING CONVENTION:
  • Splunk_TA_* = Official Splunk Technology Add-on
  • TA-* = Third-party or custom Technology Add-on</div>
                </div>

                <!-- Essential Security TAs -->
                <h2><i class="fas fa-shield-alt"></i> Essential Security TAs</h2>
                <div class="config-section">
                    <div class="arch-diagram">ESSENTIAL SECURITY TAs (Splunkbase) - Current Versions January 2025
═══════════════════════════════════════════════════════════════════════════════

ENDPOINT SECURITY:
─────────────────────────────────────────────────────────────────────────────
  ┌─────────────────────────────────┬──────────┬────────────────────────────┐
  │ TA Name                         │ App ID   │ Data Source                │
  ├─────────────────────────────────┼──────────┼────────────────────────────┤
  │ Splunk_TA_windows               │ 742      │ Windows Event Logs, Sysmon │
  │ Splunk_TA_linux                 │ 1919     │ Linux system logs          │
  │ TA-crowdstrike-falcon-event     │ 5082     │ CrowdStrike EDR            │
  │ Splunk_TA_microsoft_sysmon      │ 5709     │ Sysmon specifically        │
  │ TA-carbonblack-*                │ Various  │ Carbon Black EDR           │
  └─────────────────────────────────┴──────────┴────────────────────────────┘

NETWORK SECURITY:
─────────────────────────────────────────────────────────────────────────────
  ┌─────────────────────────────────┬──────────┬────────────────────────────┐
  │ TA Name                         │ App ID   │ Data Source                │
  ├─────────────────────────────────┼──────────┼────────────────────────────┤
  │ Splunk_TA_paloalto              │ 7523     │ Palo Alto Firewall (NEW)   │
  │ Splunk_TA_cisco-asa             │ 5152     │ Cisco ASA Firewall         │
  │ Splunk_TA_fortinet_fortigate    │ 2846     │ FortiGate Firewall         │
  │ Splunk_TA_checkpoint            │ 3958     │ Check Point Firewall       │
  │ TA-Zscaler                      │ 4727     │ Zscaler Cloud Security     │
  └─────────────────────────────────┴──────────┴────────────────────────────┘

CLOUD & IDENTITY:
─────────────────────────────────────────────────────────────────────────────
  ┌─────────────────────────────────┬──────────┬────────────────────────────┐
  │ TA Name                         │ App ID   │ Data Source                │
  ├─────────────────────────────────┼──────────┼────────────────────────────┤
  │ Splunk_TA_microsoft-cloudservices│ 3110    │ Azure AD, O365, Azure      │
  │ Splunk_TA_aws                   │ 1876     │ AWS CloudTrail, GuardDuty  │
  │ TA-okta-identity-cloud          │ 5151     │ Okta SSO                   │
  │ Splunk_TA_google-cloud          │ 5556     │ GCP Audit Logs             │
  └─────────────────────────────────┴──────────┴────────────────────────────┘</div>
                </div>

                <!-- What's Inside a TA -->
                <h2><i class="fas fa-folder-open"></i> Deep Dive: What's Inside a TA</h2>
                <div class="config-section">
                    <div class="arch-diagram">TA DIRECTORY STRUCTURE
═══════════════════════════════════════════════════════════════════════════════

$SPLUNK_HOME/etc/apps/Splunk_TA_windows/
├── default/
│   ├── app.conf              # App metadata
│   ├── inputs.conf           # Default inputs (usually disabled)
│   ├── props.conf            # Parsing and field extraction rules
│   ├── transforms.conf       # Advanced transformations
│   ├── eventtypes.conf       # Event categorization
│   ├── tags.conf             # CIM data model tagging
│   └── data/
│       └── ui/views/         # Any UI components
│
├── local/                    # YOUR customizations go here
│   ├── inputs.conf           # Enable/customize inputs
│   └── props.conf            # Override parsing if needed
│
├── metadata/
│   ├── default.meta          # Permissions
│   └── local.meta
│
├── bin/                      # Scripts (for modular inputs)
│   └── *.py                  # Python collectors for APIs
│
└── README                    # Documentation

KEY CONFIGURATION FILES:
═══════════════════════════════════════════════════════════════════════════════

inputs.conf - WHAT TO COLLECT:
─────────────────────────────────────────────────────────────────────────────
[WinEventLog://Security]
disabled = 0                    # Enable this input
index = wineventlog            # Where to send data
whitelist = 4624,4625,4688     # Only collect these Event IDs

props.conf - HOW TO PARSE:
─────────────────────────────────────────────────────────────────────────────
[WinEventLog:Security]
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
SHOULD_LINEMERGE = false
KV_MODE = xml
FIELDALIAS-user = TargetUserName AS user
FIELDALIAS-src = IpAddress AS src

eventtypes.conf - CATEGORIZE EVENTS:
─────────────────────────────────────────────────────────────────────────────
[wineventlog_security_4624]
search = sourcetype="WinEventLog:Security" EventCode=4624

tags.conf - MAP TO CIM:
─────────────────────────────────────────────────────────────────────────────
[eventtype=wineventlog_security_4624]
authentication = enabled
success = enabled</div>
                </div>

                <!-- Hands-On: Windows TA -->
                <h2><i class="fab fa-windows"></i> Hands-On: Configure Windows TA</h2>
                <div class="config-section">
                    <div class="arch-diagram">
SCENARIO: Configure Splunk_TA_windows to collect security-relevant events only
═══════════════════════════════════════════════════════════════════════════════

GOAL: Collect only important security events to reduce volume while maintaining
      visibility for SOC operations.

STEP 1: EXPLORE THE TA
─────────────────────────────────────────────────────────────────────────────

# List files in the TA
ls -la /opt/splunk/etc/apps/Splunk_TA_windows/

# View default inputs (typically disabled)
cat /opt/splunk/etc/apps/Splunk_TA_windows/default/inputs.conf

# OUTPUT SHOWS:
# [WinEventLog://Application]
# disabled = 1
# 
# [WinEventLog://Security]  
# disabled = 1

# View parsing rules
cat /opt/splunk/etc/apps/Splunk_TA_windows/default/props.conf | head -50

# View CIM field aliases
grep "FIELDALIAS" /opt/splunk/etc/apps/Splunk_TA_windows/default/props.conf

STEP 2: CREATE LOCAL inputs.conf FOR SECURITY MONITORING
─────────────────────────────────────────────────────────────────────────────

# Location: /opt/splunk/etc/apps/Splunk_TA_windows/local/inputs.conf

[WinEventLog://Security]
disabled = 0
index = wineventlog
# Only collect security-relevant events (reduces volume by 80%+)
whitelist = 4624,4625,4648,4672,4688,4689,4697,4698,4699,4700,4701,4702,\
            4720,4722,4723,4724,4725,4726,4727,4728,4729,4730,4731,4732,\
            4733,4734,4735,4737,4738,4740,4756,4757,4768,4769,4770,4771,\
            4776,5140,5145

# CRITICAL EVENTS TO NEVER MISS:
# 4624 - Successful Logon
# 4625 - Failed Logon
# 4648 - Explicit Credential Logon (Pass-the-Hash indicator)
# 4672 - Special Privileges Assigned (Admin logon)
# 4688 - Process Creation (requires command line auditing)
# 4720 - User Account Created
# 4726 - User Account Deleted
# 4728/4732/4756 - User Added to Security Group
# 4768 - Kerberos TGT Requested
# 4769 - Kerberos Service Ticket Requested
# 4771 - Kerberos Pre-Auth Failed

STEP 3: ENABLE POWERSHELL LOGGING
─────────────────────────────────────────────────────────────────────────────

# PowerShell Script Block Logging (requires GPO to enable on endpoints)
[WinEventLog://Microsoft-Windows-PowerShell/Operational]
disabled = 0
index = wineventlog
whitelist = 4103,4104,4105,4106

# 4103 - Module Logging
# 4104 - Script Block Logging (CRITICAL - shows full scripts)
# 4105 - Script Block Start
# 4106 - Script Block Stop

STEP 4: ENABLE SYSMON COLLECTION (if Sysmon is deployed)
─────────────────────────────────────────────────────────────────────────────

[WinEventLog://Microsoft-Windows-Sysmon/Operational]
disabled = 0
index = sysmon
renderXml = true
# renderXml=true preserves full XML for better field extraction

# IMPORTANT for TA-windows v5+:
# Use source= not sourcetype= in searches:
# source="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational"

STEP 5: VERIFY CONFIGURATION
─────────────────────────────────────────────────────────────────────────────

# Check effective config
/opt/splunk/bin/splunk btool inputs list --debug | grep -A5 "WinEventLog"

# Check for config errors
/opt/splunk/bin/splunk btool check

# Restart forwarder to apply
/opt/splunk/bin/splunk restart

# Verify data in Splunk
index=wineventlog sourcetype="WinEventLog:Security" earliest=-1h
| stats count by EventCode
| sort -count</div>
                </div>

                <!-- Hands-On: CrowdStrike TA -->
                <h2><i class="fas fa-crow"></i> Hands-On: Configure CrowdStrike Falcon TA</h2>
                <div class="config-section">
                    <div class="arch-diagram">
SCENARIO: Integrate CrowdStrike Falcon with Splunk
═══════════════════════════════════════════════════════════════════════════════

ARCHITECTURE:

  [CrowdStrike Cloud]                    [Splunk]
        │                                    │
        │  Event Streams API                 │
        │  (OAuth2 authenticated)            │
        ▼                                    │
  ┌─────────────────┐                        │
  │ Heavy Forwarder │ ───TCP 9997──────────► │
  │ + Event Streams │                        │
  │   TA installed  │                        │
  └─────────────────┘                        │

PREREQUISITES:
  1. CrowdStrike Falcon subscription with API access
  2. API Client credentials (Client ID + Secret)
  3. Splunk Heavy Forwarder (NOT UF - TA needs Python)

STEP 1: CREATE CROWDSTRIKE API CLIENT
─────────────────────────────────────────────────────────────────────────────

In Falcon Console:
  Support → API Clients and Keys → Add new API Client

  Name: Splunk_Integration
  
  Scopes (minimum required):
    ✅ Event Streams: Read
    ✅ Detections: Read  
    ✅ Incidents: Read

  Save:
    Client ID: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    Client Secret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

  Note your CrowdStrike cloud:
    US-1: api.crowdstrike.com
    US-2: api.us-2.crowdstrike.com
    EU-1: api.eu-1.crowdstrike.com

STEP 2: INSTALL TA ON HEAVY FORWARDER
─────────────────────────────────────────────────────────────────────────────

# Download from Splunkbase: 
# "CrowdStrike Falcon Event Streams Technical Add-On" (App ID: 5082)

cd /opt/splunk/etc/apps
tar -xvf /tmp/TA-crowdstrike-falcon-event-streams.tgz

# Also install on Search Heads for field extractions

# Restart Splunk
/opt/splunk/bin/splunk restart

STEP 3: CONFIGURE VIA SPLUNK WEB
─────────────────────────────────────────────────────────────────────────────

On Heavy Forwarder: https://heavy-forwarder:8000

1. Apps → CrowdStrike Falcon Event Streams → Configuration

2. Account Tab:
   ┌─────────────────────────────────────────────────────────────────────┐
   │ Account Name: CrowdStrike_Prod                                      │
   │ Client ID: [your_client_id]                                         │
   │ Client Secret: [your_client_secret]                                 │
   │ CrowdStrike Cloud: US-1                                             │
   └─────────────────────────────────────────────────────────────────────┘

3. Inputs Tab → Create New Input:
   ┌─────────────────────────────────────────────────────────────────────┐
   │ Name: crowdstrike_events                                            │
   │ Account: CrowdStrike_Prod                                           │
   │ Index: crowdstrike                                                  │
   │ App ID: splunk_events_prod  ← MUST BE UNIQUE per environment!       │
   │ Event Types: DetectionSummaryEvent, IncidentSummaryEvent,           │
   │              AuthActivityAuditEvent                                 │
   └─────────────────────────────────────────────────────────────────────┘

STEP 4: VERIFY DATA FLOW
─────────────────────────────────────────────────────────────────────────────

# Check data arriving
index=crowdstrike earliest=-1h
| stats count by sourcetype

# Expected sourcetypes:
# crowdstrike:events:sensor

# View recent detections
index=crowdstrike sourcetype="crowdstrike:events:sensor" 
    event_simpleName="DetectionSummaryEvent"
| table _time, ComputerName, UserName, DetectName, Severity, Tactic, Technique

STEP 5: TROUBLESHOOTING
─────────────────────────────────────────────────────────────────────────────

# Check TA internal logs
index=_internal sourcetype=splunkd component=ExecProcessor crowdstrike
| head 50

# Check for API errors
index=_internal source=*ta_crowdstrike* log_level=ERROR

# Common issues:
# 1. "401 Unauthorized" - Wrong Client ID/Secret
# 2. "403 Forbidden" - Missing API scopes
# 3. "No data" - AppID already in use by another input
# 4. "Connection refused" - Firewall blocking api.crowdstrike.com</div>
                </div>

                <!-- Hands-On: Palo Alto TA -->
                <h2><i class="fas fa-fire"></i> Hands-On: Configure Palo Alto TA (Syslog)</h2>
                <div class="config-section">
                    <div class="arch-diagram">
SCENARIO: Collect Palo Alto Firewall logs via Syslog
═══════════════════════════════════════════════════════════════════════════════

IMPORTANT: As of 2024, use the NEW Splunk-supported TA:
           "Splunk Add-on for Palo Alto Networks" (App ID: 7523)
           NOT the deprecated "Palo Alto Networks Add-on" (2757)

ARCHITECTURE:

  [Palo Alto FW/Panorama]  ──Syslog TCP 514──►  [Heavy Forwarder]
                                                     │
                                     ┌───────────────┴───────────────┐
                                     │  Splunk_TA_paloalto          │
                                     │  - Receives syslog            │
                                     │  - Parses to pan:* sourcetypes│
                                     │  - Applies CIM mapping        │
                                     └───────────────┬───────────────┘
                                                     │
                                              TCP 9997
                                                     │
                                                     ▼
                                              [Indexers]

STEP 1: INSTALL TA ON HEAVY FORWARDER
─────────────────────────────────────────────────────────────────────────────

# Download NEW Splunk-supported version from Splunkbase (App ID: 7523)
cd /opt/splunk/etc/apps
tar -xvf /tmp/Splunk_Add-on_for_Palo_Alto_Networks.tgz

STEP 2: CONFIGURE SYSLOG INPUT
─────────────────────────────────────────────────────────────────────────────

# Create local inputs.conf
mkdir -p /opt/splunk/etc/apps/Splunk_TA_paloalto/local

cat > /opt/splunk/etc/apps/Splunk_TA_paloalto/local/inputs.conf << 'EOF'
# Palo Alto syslog input
[tcp://514]
disabled = 0
connection_host = dns
sourcetype = pan:log
index = firewall

# Optional: Use dedicated port per log type
# [tcp://5514]
# sourcetype = pan:traffic
# [tcp://5515]
# sourcetype = pan:threat
EOF

STEP 3: CONFIGURE PALO ALTO TO SEND LOGS
─────────────────────────────────────────────────────────────────────────────

In Palo Alto GUI (Panorama or Firewall):

1. Create Syslog Server Profile
   Device → Server Profiles → Syslog
   
   Name: Splunk_HF
   Servers:
     Name: splunk-hf-01
     Syslog Server: 10.0.0.50 (Heavy Forwarder IP)
     Transport: TCP
     Port: 514
     Format: BSD
     Facility: LOG_USER

2. Create Log Forwarding Profile
   Objects → Log Forwarding
   
   Name: Forward_to_Splunk
   Log Type: Traffic  → Syslog: Splunk_HF
   Log Type: Threat   → Syslog: Splunk_HF
   Log Type: URL      → Syslog: Splunk_HF
   Log Type: WildFire → Syslog: Splunk_HF

3. Apply Log Forwarding to Security Rules
   Policies → Security
   Edit each rule → Actions tab → Log Forwarding: Forward_to_Splunk

4. Commit changes

STEP 4: VERIFY ON SPLUNK
─────────────────────────────────────────────────────────────────────────────

# Check raw data arriving
index=firewall earliest=-15m
| stats count by sourcetype

# Expected sourcetypes:
# pan:traffic  - Firewall traffic logs
# pan:threat   - Threat/IPS logs
# pan:system   - System events
# pan:config   - Configuration changes
# pan:url      - URL filtering logs
# pan:wildfire - WildFire verdict logs

# View traffic summary
index=firewall sourcetype=pan:traffic earliest=-1h
| stats count by action, app, rule
| sort -count

# View threat detections
index=firewall sourcetype=pan:threat earliest=-24h
| stats count by threatid, threat_name, severity
| sort -count

# Check CIM compliance
| tstats count from datamodel=Network_Traffic 
    where nodename=All_Traffic by All_Traffic.action

SOURCETYPE TO LOG TYPE MAPPING:
─────────────────────────────────────────────────────────────────────────────

  Sourcetype        │ Palo Alto Log Type      │ Contains
  ──────────────────┼─────────────────────────┼────────────────────────────
  pan:traffic       │ Traffic                 │ Allow/deny, bytes, sessions
  pan:threat        │ Threat                  │ IPS, antivirus, anti-spyware
  pan:url           │ URL Filtering           │ URL categories, actions
  pan:wildfire      │ WildFire Submissions    │ File verdicts
  pan:config        │ Configuration           │ Config changes
  pan:system        │ System                  │ System events, HA failover
  pan:globalprotect │ GlobalProtect           │ VPN connections
  pan:userid        │ User-ID                 │ User mapping events</div>
                </div>

                <!-- TA Troubleshooting -->
                <h2><i class="fas fa-wrench"></i> TA Troubleshooting Guide</h2>
                <div class="config-section">
                    <div class="arch-diagram">COMMON TA ISSUES AND FIXES
═══════════════════════════════════════════════════════════════════════════════

ISSUE: "Fields not extracting"
─────────────────────────────────────────────────────────────────────────────
Cause: TA not installed on Search Heads
Fix:   Install TA on all Search Heads (field extractions are search-time)

Verify:
  # Check if TA is installed
  /opt/splunk/bin/splunk display app | grep -i "TA"
  
  # Check field extraction
  index=your_index earliest=-1h
  | fieldsummary
  | where count > 0

ISSUE: "Wrong timestamp / events in future"
─────────────────────────────────────────────────────────────────────────────
Cause: TIME_FORMAT mismatch or wrong timezone
Fix:   Check props.conf TIME_FORMAT matches actual log format
       Check TZ setting in props.conf

Debug:
  # See what Splunk thinks the time format is
  /opt/splunk/bin/splunk btool props list --debug | grep -A10 "sourcetype"

ISSUE: "Data going to wrong index"
─────────────────────────────────────────────────────────────────────────────
Cause: inputs.conf missing index= setting
Fix:   Add explicit index= to inputs.conf in local/

Verify:
  # Check effective inputs config
  /opt/splunk/bin/splunk btool inputs list --debug | grep -B2 -A5 "index"

ISSUE: "CrowdStrike/API TA not collecting"
─────────────────────────────────────────────────────────────────────────────
Cause: Wrong credentials, network blocked, or duplicate AppID
Fix:   Check _internal logs, verify API credentials, ensure unique AppID

Debug:
  index=_internal sourcetype=splunkd source=*ta_crowdstrike* log_level=ERROR
  | table _time, message

ISSUE: "Splunk_TA_windows v5 broke my searches"
─────────────────────────────────────────────────────────────────────────────
Cause: v5 changed source vs sourcetype handling for XML events
Fix:   Change searches from sourcetype= to source= for XML events
       Read: docs.splunk.com/Documentation/WindowsAddOn/5.0.1/User/Upgrade

ISSUE: "props.conf changes not taking effect"
─────────────────────────────────────────────────────────────────────────────
Cause: Searching old events (props.conf only affects new events)
Fix:   Wait for new events, or test with: earliest=-5m
       For existing data, re-index or use SEDCMD at search time

ISSUE: "CIM data model not populated"
─────────────────────────────────────────────────────────────────────────────
Cause: Tags not applied or data model not accelerated
Fix:   Check tags, verify data model acceleration

Debug:
  # Check if tags are applied
  index=your_index earliest=-1h
  | head 1
  | eval mytags=mvjoin(tag, ", ")
  | table mytags
  
  # Should show CIM tags like: authentication, success</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What is a Technology Add-on and where do you install it?</button>
                        <div class="qa-answer">
                            <p>"A Technology Add-on (TA) is a package that extends Splunk's ability to collect and parse data from specific sources. It contains inputs.conf for collection, props.conf for parsing, and tags.conf for CIM mapping. Install TAs on forwarders for data collection and on search heads for field extraction. Heavy forwarders get both since they collect AND parse locally."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you onboard a new data source to Splunk?</button>
                        <div class="qa-answer">
                            <p>"First, check Splunkbase for an existing TA. If one exists, install it and configure inputs. If not, analyze the log format - timestamp, delimiters, fields. Create a custom TA with props.conf for parsing, eventtypes.conf for categorization, and tags.conf for CIM compliance. Test in dev, then deploy via Deployment Server to forwarders and Deployer to Search Heads."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Why would you use a Heavy Forwarder for CrowdStrike?</button>
                        <div class="qa-answer">
                            <p>"The CrowdStrike TA uses the Event Streams API which requires Python to authenticate via OAuth2 and pull events. Universal Forwarders don't have Python, so you need a Heavy Forwarder. The HF authenticates to CrowdStrike's cloud API, pulls events, and forwards to indexers. It also allows local parsing before forwarding."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you troubleshoot a TA that's not extracting fields?</button>
                        <div class="qa-answer">
                            <ol>
                                <li>Verify TA is installed on Search Heads (field extraction is search-time)</li>
                                <li>Check btool for config errors: <code>splunk btool props list --debug</code></li>
                                <li>Verify sourcetype matches props.conf stanza</li>
                                <li>Check for conflicts with other TAs</li>
                                <li>Use fieldsummary to see what fields exist</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>