<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apps & Technology Add-ons | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="shared-styles.css">
    <link rel="stylesheet" href="../assets/css/main.css">


</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo"><i class="fas fa-terminal"></i><span>Splunk Reference</span></a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certifications</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-user-graduate" style="color:#7ce38b"></i>Power User</a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog" style="color:#f0883e"></i>Admin</a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt" style="color:#8957e5"></i>ES Admin</a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud" style="color:#39c5cf"></i>Cloud Admin</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Learning</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="when-to-use-what.html" class="sidebar-nav-link"><i class="fas fa-map-signs" style="color:#f0883e"></i>When to Use What</a></li>
                        <li class="sidebar-nav-item"><a href="spl-practice-questions.html" class="sidebar-nav-link"><i class="fas fa-tasks" style="color:#58a6ff"></i>Practice MCQs</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced-mcqs.html" class="sidebar-nav-link"><i class="fas fa-brain" style="color:#a371f7"></i>Advanced MCQs</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Reference</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-code"></i>SPL Fundamentals</a></li>
                        <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-layer-group"></i>SPL Intermediate</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i>SPL Advanced</a></li>
                        <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-lightbulb"></i>Knowledge Objects</a></li>
                        <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i>Data Models</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Administration</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i>Architecture</a></li>
                        <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i>Data Ingestion</a></li>
                        <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-share-alt"></i>Forwarders</a></li>
                        <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i>Clustering & HA</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Enterprise Security</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i>ES Overview</a></li>
                        <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search-plus"></i>Correlation Searches</a></li>
                        <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i>Risk-Based Alerting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Resources</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="lab-exercises.html" class="sidebar-nav-link"><i class="fas fa-flask"></i>Lab Exercises</a></li>
                        <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i>Troubleshooting</a></li>
                    </ul>
                </div>
            </div>
        </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Apps Tas</span>
                </div>

                <h1><i class="fas fa-puzzle-piece"></i> Apps & Technology Add-ons (TAs)</h1>
                <p class="lead">Complete guide to Technology Add-ons: what they are, how they work, and step-by-step configuration for critical security sources including Windows, CrowdStrike, and Palo Alto.</p>

                <!-- What are TAs -->
                <h2><i class="fas fa-info-circle"></i> Understanding Technology Add-ons</h2>
                <div class="config-section">
                    <div class="arch-diagram">
TECHNOLOGY ADD-ONS (TAs) - WHAT THEY ARE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DEFINITION:
  Technology Add-ons are packages that extend Splunk's ability to collect,
  parse, and normalize data from specific sources. They contain:
  
  â€¢ inputs.conf     - Define data collection (what to collect)
  â€¢ props.conf      - Define parsing rules (how to parse)
  â€¢ transforms.conf - Advanced parsing and routing
  â€¢ eventtypes.conf - Event categorization
  â€¢ tags.conf       - CIM data model mapping

WHERE TAs ARE INSTALLED:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                    TA DEPLOYMENT LOCATIONS                              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                         â”‚
  â”‚  FORWARDERS (UF/HF)                    SEARCH HEADS                    â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚
  â”‚  Install TAs for INPUT collection      Install TAs for PARSING         â”‚
  â”‚                                                                         â”‚
  â”‚  â€¢ inputs.conf (what to collect)       â€¢ props.conf (field extraction) â”‚
  â”‚  â€¢ Only if TA defines inputs           â€¢ eventtypes.conf (categories)  â”‚
  â”‚                                        â€¢ tags.conf (CIM mapping)        â”‚
  â”‚                                                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
  â”‚  â”‚ Universal       â”‚                   â”‚ Search Head     â”‚             â”‚
  â”‚  â”‚ Forwarder       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Cluster         â”‚             â”‚
  â”‚  â”‚                 â”‚                   â”‚                 â”‚             â”‚
  â”‚  â”‚ Collects data   â”‚                   â”‚ Parses &        â”‚             â”‚
  â”‚  â”‚ Sends to indexerâ”‚                   â”‚ extracts fields â”‚             â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
  â”‚                                                                         â”‚
  â”‚  HEAVY FORWARDERS                      INDEXERS                        â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
  â”‚  Install TAs for BOTH                  Usually NOT needed              â”‚
  â”‚  â€¢ Input collection                    â€¢ Unless index-time transforms  â”‚
  â”‚  â€¢ Local parsing before forwarding     â€¢ Or heavy forwarder pattern    â”‚
  â”‚                                                                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TA vs APP vs ADD-ON:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ TA (Technology Add-on): Data input and parsing only, no UI
  â€¢ App: Full application with dashboards, reports, UI
  â€¢ Add-on: General term, can be either

NAMING CONVENTION:
  â€¢ Splunk_TA_* = Official Splunk Technology Add-on
  â€¢ TA-* = Third-party or custom Technology Add-on</div>
                </div>

                <!-- Essential Security TAs -->
                <h2><i class="fas fa-shield-alt"></i> Essential Security TAs</h2>
                <div class="config-section">
                    <div class="arch-diagram">ESSENTIAL SECURITY TAs (Splunkbase) - Current Versions January 2025
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENDPOINT SECURITY:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ TA Name                         â”‚ App ID   â”‚ Data Source                â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Splunk_TA_windows               â”‚ 742      â”‚ Windows Event Logs, Sysmon â”‚
  â”‚ Splunk_TA_linux                 â”‚ 1919     â”‚ Linux system logs          â”‚
  â”‚ TA-crowdstrike-falcon-event     â”‚ 5082     â”‚ CrowdStrike EDR            â”‚
  â”‚ Splunk_TA_microsoft_sysmon      â”‚ 5709     â”‚ Sysmon specifically        â”‚
  â”‚ TA-carbonblack-*                â”‚ Various  â”‚ Carbon Black EDR           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NETWORK SECURITY:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ TA Name                         â”‚ App ID   â”‚ Data Source                â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Splunk_TA_paloalto              â”‚ 7523     â”‚ Palo Alto Firewall (NEW)   â”‚
  â”‚ Splunk_TA_cisco-asa             â”‚ 5152     â”‚ Cisco ASA Firewall         â”‚
  â”‚ Splunk_TA_fortinet_fortigate    â”‚ 2846     â”‚ FortiGate Firewall         â”‚
  â”‚ Splunk_TA_checkpoint            â”‚ 3958     â”‚ Check Point Firewall       â”‚
  â”‚ TA-Zscaler                      â”‚ 4727     â”‚ Zscaler Cloud Security     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CLOUD & IDENTITY:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ TA Name                         â”‚ App ID   â”‚ Data Source                â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Splunk_TA_microsoft-cloudservicesâ”‚ 3110    â”‚ Azure AD, O365, Azure      â”‚
  â”‚ Splunk_TA_aws                   â”‚ 1876     â”‚ AWS CloudTrail, GuardDuty  â”‚
  â”‚ TA-okta-identity-cloud          â”‚ 5151     â”‚ Okta SSO                   â”‚
  â”‚ Splunk_TA_google-cloud          â”‚ 5556     â”‚ GCP Audit Logs             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
                </div>

                <!-- What's Inside a TA -->
                <h2><i class="fas fa-folder-open"></i> Deep Dive: What's Inside a TA</h2>
                <div class="config-section">
                    <div class="arch-diagram">TA DIRECTORY STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

$SPLUNK_HOME/etc/apps/Splunk_TA_windows/
â”œâ”€â”€ default/
â”‚   â”œâ”€â”€ app.conf              # App metadata
â”‚   â”œâ”€â”€ inputs.conf           # Default inputs (usually disabled)
â”‚   â”œâ”€â”€ props.conf            # Parsing and field extraction rules
â”‚   â”œâ”€â”€ transforms.conf       # Advanced transformations
â”‚   â”œâ”€â”€ eventtypes.conf       # Event categorization
â”‚   â”œâ”€â”€ tags.conf             # CIM data model tagging
â”‚   â””â”€â”€ data/
â”‚       â””â”€â”€ ui/views/         # Any UI components
â”‚
â”œâ”€â”€ local/                    # YOUR customizations go here
â”‚   â”œâ”€â”€ inputs.conf           # Enable/customize inputs
â”‚   â””â”€â”€ props.conf            # Override parsing if needed
â”‚
â”œâ”€â”€ metadata/
â”‚   â”œâ”€â”€ default.meta          # Permissions
â”‚   â””â”€â”€ local.meta
â”‚
â”œâ”€â”€ bin/                      # Scripts (for modular inputs)
â”‚   â””â”€â”€ *.py                  # Python collectors for APIs
â”‚
â””â”€â”€ README                    # Documentation

KEY CONFIGURATION FILES:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

inputs.conf - WHAT TO COLLECT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[WinEventLog://Security]
disabled = 0                    # Enable this input
index = wineventlog            # Where to send data
whitelist = 4624,4625,4688     # Only collect these Event IDs

props.conf - HOW TO PARSE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[WinEventLog:Security]
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
SHOULD_LINEMERGE = false
KV_MODE = xml
FIELDALIAS-user = TargetUserName AS user
FIELDALIAS-src = IpAddress AS src

eventtypes.conf - CATEGORIZE EVENTS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[wineventlog_security_4624]
search = sourcetype="WinEventLog:Security" EventCode=4624

tags.conf - MAP TO CIM:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[eventtype=wineventlog_security_4624]
authentication = enabled
success = enabled</div>
                </div>

                <!-- Hands-On: Windows TA -->
                <h2><i class="fab fa-windows"></i> Hands-On: Configure Windows TA</h2>
                <div class="config-section">
                    <div class="arch-diagram">
SCENARIO: Configure Splunk_TA_windows to collect security-relevant events only
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GOAL: Collect only important security events to reduce volume while maintaining
      visibility for SOC operations.

STEP 1: EXPLORE THE TA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# List files in the TA
ls -la /opt/splunk/etc/apps/Splunk_TA_windows/

# View default inputs (typically disabled)
cat /opt/splunk/etc/apps/Splunk_TA_windows/default/inputs.conf

# OUTPUT SHOWS:
# [WinEventLog://Application]
# disabled = 1
# 
# [WinEventLog://Security]  
# disabled = 1

# View parsing rules
cat /opt/splunk/etc/apps/Splunk_TA_windows/default/props.conf | head -50

# View CIM field aliases
grep "FIELDALIAS" /opt/splunk/etc/apps/Splunk_TA_windows/default/props.conf

STEP 2: CREATE LOCAL inputs.conf FOR SECURITY MONITORING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Location: /opt/splunk/etc/apps/Splunk_TA_windows/local/inputs.conf

[WinEventLog://Security]
disabled = 0
index = wineventlog
# Only collect security-relevant events (reduces volume by 80%+)
whitelist = 4624,4625,4648,4672,4688,4689,4697,4698,4699,4700,4701,4702,\
            4720,4722,4723,4724,4725,4726,4727,4728,4729,4730,4731,4732,\
            4733,4734,4735,4737,4738,4740,4756,4757,4768,4769,4770,4771,\
            4776,5140,5145

# CRITICAL EVENTS TO NEVER MISS:
# 4624 - Successful Logon
# 4625 - Failed Logon
# 4648 - Explicit Credential Logon (Pass-the-Hash indicator)
# 4672 - Special Privileges Assigned (Admin logon)
# 4688 - Process Creation (requires command line auditing)
# 4720 - User Account Created
# 4726 - User Account Deleted
# 4728/4732/4756 - User Added to Security Group
# 4768 - Kerberos TGT Requested
# 4769 - Kerberos Service Ticket Requested
# 4771 - Kerberos Pre-Auth Failed

STEP 3: ENABLE POWERSHELL LOGGING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# PowerShell Script Block Logging (requires GPO to enable on endpoints)
[WinEventLog://Microsoft-Windows-PowerShell/Operational]
disabled = 0
index = wineventlog
whitelist = 4103,4104,4105,4106

# 4103 - Module Logging
# 4104 - Script Block Logging (CRITICAL - shows full scripts)
# 4105 - Script Block Start
# 4106 - Script Block Stop

STEP 4: ENABLE SYSMON COLLECTION (if Sysmon is deployed)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[WinEventLog://Microsoft-Windows-Sysmon/Operational]
disabled = 0
index = sysmon
renderXml = true
# renderXml=true preserves full XML for better field extraction

# IMPORTANT for TA-windows v5+:
# Use source= not sourcetype= in searches:
# source="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational"

STEP 5: VERIFY CONFIGURATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Check effective config
/opt/splunk/bin/splunk btool inputs list --debug | grep -A5 "WinEventLog"

# Check for config errors
/opt/splunk/bin/splunk btool check

# Restart forwarder to apply
/opt/splunk/bin/splunk restart

# Verify data in Splunk
index=wineventlog sourcetype="WinEventLog:Security" earliest=-1h
| stats count by EventCode
| sort -count</div>
                </div>

                <!-- Hands-On: CrowdStrike TA -->
                <h2><i class="fas fa-crow"></i> Hands-On: Configure CrowdStrike Falcon TA</h2>
                <div class="config-section">
                    <div class="arch-diagram">
SCENARIO: Integrate CrowdStrike Falcon with Splunk
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ARCHITECTURE:

  [CrowdStrike Cloud]                    [Splunk]
        â”‚                                    â”‚
        â”‚  Event Streams API                 â”‚
        â”‚  (OAuth2 authenticated)            â”‚
        â–¼                                    â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
  â”‚ Heavy Forwarder â”‚ â”€â”€â”€TCP 9997â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚
  â”‚ + Event Streams â”‚                        â”‚
  â”‚   TA installed  â”‚                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚

PREREQUISITES:
  1. CrowdStrike Falcon subscription with API access
  2. API Client credentials (Client ID + Secret)
  3. Splunk Heavy Forwarder (NOT UF - TA needs Python)

STEP 1: CREATE CROWDSTRIKE API CLIENT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

In Falcon Console:
  Support â†’ API Clients and Keys â†’ Add new API Client

  Name: Splunk_Integration
  
  Scopes (minimum required):
    âœ… Event Streams: Read
    âœ… Detections: Read  
    âœ… Incidents: Read

  Save:
    Client ID: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    Client Secret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

  Note your CrowdStrike cloud:
    US-1: api.crowdstrike.com
    US-2: api.us-2.crowdstrike.com
    EU-1: api.eu-1.crowdstrike.com

STEP 2: INSTALL TA ON HEAVY FORWARDER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Download from Splunkbase: 
# "CrowdStrike Falcon Event Streams Technical Add-On" (App ID: 5082)

cd /opt/splunk/etc/apps
tar -xvf /tmp/TA-crowdstrike-falcon-event-streams.tgz

# Also install on Search Heads for field extractions

# Restart Splunk
/opt/splunk/bin/splunk restart

STEP 3: CONFIGURE VIA SPLUNK WEB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

On Heavy Forwarder: https://heavy-forwarder:8000

1. Apps â†’ CrowdStrike Falcon Event Streams â†’ Configuration

2. Account Tab:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Account Name: CrowdStrike_Prod                                      â”‚
   â”‚ Client ID: [your_client_id]                                         â”‚
   â”‚ Client Secret: [your_client_secret]                                 â”‚
   â”‚ CrowdStrike Cloud: US-1                                             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Inputs Tab â†’ Create New Input:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Name: crowdstrike_events                                            â”‚
   â”‚ Account: CrowdStrike_Prod                                           â”‚
   â”‚ Index: crowdstrike                                                  â”‚
   â”‚ App ID: splunk_events_prod  â† MUST BE UNIQUE per environment!       â”‚
   â”‚ Event Types: DetectionSummaryEvent, IncidentSummaryEvent,           â”‚
   â”‚              AuthActivityAuditEvent                                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 4: VERIFY DATA FLOW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Check data arriving
index=crowdstrike earliest=-1h
| stats count by sourcetype

# Expected sourcetypes:
# crowdstrike:events:sensor

# View recent detections
index=crowdstrike sourcetype="crowdstrike:events:sensor" 
    event_simpleName="DetectionSummaryEvent"
| table _time, ComputerName, UserName, DetectName, Severity, Tactic, Technique

STEP 5: TROUBLESHOOTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Check TA internal logs
index=_internal sourcetype=splunkd component=ExecProcessor crowdstrike
| head 50

# Check for API errors
index=_internal source=*ta_crowdstrike* log_level=ERROR

# Common issues:
# 1. "401 Unauthorized" - Wrong Client ID/Secret
# 2. "403 Forbidden" - Missing API scopes
# 3. "No data" - AppID already in use by another input
# 4. "Connection refused" - Firewall blocking api.crowdstrike.com</div>
                </div>

                <!-- Hands-On: Palo Alto TA -->
                <h2><i class="fas fa-fire"></i> Hands-On: Configure Palo Alto TA (Syslog)</h2>
                <div class="config-section">
                    <div class="arch-diagram">
SCENARIO: Collect Palo Alto Firewall logs via Syslog
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

IMPORTANT: As of 2024, use the NEW Splunk-supported TA:
           "Splunk Add-on for Palo Alto Networks" (App ID: 7523)
           NOT the deprecated "Palo Alto Networks Add-on" (2757)

ARCHITECTURE:

  [Palo Alto FW/Panorama]  â”€â”€Syslog TCP 514â”€â”€â–º  [Heavy Forwarder]
                                                     â”‚
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚  Splunk_TA_paloalto          â”‚
                                     â”‚  - Receives syslog            â”‚
                                     â”‚  - Parses to pan:* sourcetypesâ”‚
                                     â”‚  - Applies CIM mapping        â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                              TCP 9997
                                                     â”‚
                                                     â–¼
                                              [Indexers]

STEP 1: INSTALL TA ON HEAVY FORWARDER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Download NEW Splunk-supported version from Splunkbase (App ID: 7523)
cd /opt/splunk/etc/apps
tar -xvf /tmp/Splunk_Add-on_for_Palo_Alto_Networks.tgz

STEP 2: CONFIGURE SYSLOG INPUT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Create local inputs.conf
mkdir -p /opt/splunk/etc/apps/Splunk_TA_paloalto/local

cat > /opt/splunk/etc/apps/Splunk_TA_paloalto/local/inputs.conf << 'EOF'
# Palo Alto syslog input
[tcp://514]
disabled = 0
connection_host = dns
sourcetype = pan:log
index = firewall

# Optional: Use dedicated port per log type
# [tcp://5514]
# sourcetype = pan:traffic
# [tcp://5515]
# sourcetype = pan:threat
EOF

STEP 3: CONFIGURE PALO ALTO TO SEND LOGS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

In Palo Alto GUI (Panorama or Firewall):

1. Create Syslog Server Profile
   Device â†’ Server Profiles â†’ Syslog
   
   Name: Splunk_HF
   Servers:
     Name: splunk-hf-01
     Syslog Server: 10.0.0.50 (Heavy Forwarder IP)
     Transport: TCP
     Port: 514
     Format: BSD
     Facility: LOG_USER

2. Create Log Forwarding Profile
   Objects â†’ Log Forwarding
   
   Name: Forward_to_Splunk
   Log Type: Traffic  â†’ Syslog: Splunk_HF
   Log Type: Threat   â†’ Syslog: Splunk_HF
   Log Type: URL      â†’ Syslog: Splunk_HF
   Log Type: WildFire â†’ Syslog: Splunk_HF

3. Apply Log Forwarding to Security Rules
   Policies â†’ Security
   Edit each rule â†’ Actions tab â†’ Log Forwarding: Forward_to_Splunk

4. Commit changes

STEP 4: VERIFY ON SPLUNK
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Check raw data arriving
index=firewall earliest=-15m
| stats count by sourcetype

# Expected sourcetypes:
# pan:traffic  - Firewall traffic logs
# pan:threat   - Threat/IPS logs
# pan:system   - System events
# pan:config   - Configuration changes
# pan:url      - URL filtering logs
# pan:wildfire - WildFire verdict logs

# View traffic summary
index=firewall sourcetype=pan:traffic earliest=-1h
| stats count by action, app, rule
| sort -count

# View threat detections
index=firewall sourcetype=pan:threat earliest=-24h
| stats count by threatid, threat_name, severity
| sort -count

# Check CIM compliance
| tstats count from datamodel=Network_Traffic 
    where nodename=All_Traffic by All_Traffic.action

SOURCETYPE TO LOG TYPE MAPPING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Sourcetype        â”‚ Palo Alto Log Type      â”‚ Contains
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  pan:traffic       â”‚ Traffic                 â”‚ Allow/deny, bytes, sessions
  pan:threat        â”‚ Threat                  â”‚ IPS, antivirus, anti-spyware
  pan:url           â”‚ URL Filtering           â”‚ URL categories, actions
  pan:wildfire      â”‚ WildFire Submissions    â”‚ File verdicts
  pan:config        â”‚ Configuration           â”‚ Config changes
  pan:system        â”‚ System                  â”‚ System events, HA failover
  pan:globalprotect â”‚ GlobalProtect           â”‚ VPN connections
  pan:userid        â”‚ User-ID                 â”‚ User mapping events</div>
                </div>

                <!-- TA Troubleshooting -->
                <h2><i class="fas fa-wrench"></i> TA Troubleshooting Guide</h2>
                <div class="config-section">
                    <div class="arch-diagram">COMMON TA ISSUES AND FIXES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ISSUE: "Fields not extracting"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: TA not installed on Search Heads
Fix:   Install TA on all Search Heads (field extractions are search-time)

Verify:
  # Check if TA is installed
  /opt/splunk/bin/splunk display app | grep -i "TA"
  
  # Check field extraction
  index=your_index earliest=-1h
  | fieldsummary
  | where count > 0

ISSUE: "Wrong timestamp / events in future"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: TIME_FORMAT mismatch or wrong timezone
Fix:   Check props.conf TIME_FORMAT matches actual log format
       Check TZ setting in props.conf

Debug:
  # See what Splunk thinks the time format is
  /opt/splunk/bin/splunk btool props list --debug | grep -A10 "sourcetype"

ISSUE: "Data going to wrong index"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: inputs.conf missing index= setting
Fix:   Add explicit index= to inputs.conf in local/

Verify:
  # Check effective inputs config
  /opt/splunk/bin/splunk btool inputs list --debug | grep -B2 -A5 "index"

ISSUE: "CrowdStrike/API TA not collecting"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: Wrong credentials, network blocked, or duplicate AppID
Fix:   Check _internal logs, verify API credentials, ensure unique AppID

Debug:
  index=_internal sourcetype=splunkd source=*ta_crowdstrike* log_level=ERROR
  | table _time, message

ISSUE: "Splunk_TA_windows v5 broke my searches"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: v5 changed source vs sourcetype handling for XML events
Fix:   Change searches from sourcetype= to source= for XML events
       Read: docs.splunk.com/Documentation/WindowsAddOn/5.0.1/User/Upgrade

ISSUE: "props.conf changes not taking effect"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: Searching old events (props.conf only affects new events)
Fix:   Wait for new events, or test with: earliest=-5m
       For existing data, re-index or use SEDCMD at search time

ISSUE: "CIM data model not populated"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: Tags not applied or data model not accelerated
Fix:   Check tags, verify data model acceleration

Debug:
  # Check if tags are applied
  index=your_index earliest=-1h
  | head 1
  | eval mytags=mvjoin(tag, ", ")
  | table mytags
  
  # Should show CIM tags like: authentication, success</div>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Apps &amp; TAs Decision Trees</h2>
                <div class="config-section">
                    <h3>Decision Tree: TA Selection &amp; Deployment</h3>
                    <div class="arch-diagram">NEW DATA SOURCE TO ONBOARD?
â”‚
â”œâ”€ Check Splunkbase for existing TA
â”‚   â”‚
â”‚   â”œâ”€ TA EXISTS and actively maintained?
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ Last update < 1 year? â†’ Use official TA
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€ Security-related data? â†’ Verify CIM compatibility
â”‚   â”‚   â”‚   â”œâ”€ High volume data? â†’ Test parsing performance
â”‚   â”‚   â”‚   â””â”€ Install locations:
â”‚   â”‚   â”‚       â”œâ”€ UF: inputs.conf only (if TA supports)
â”‚   â”‚   â”‚       â”œâ”€ HF: Full TA (parsing at edge)
â”‚   â”‚   â”‚       â”œâ”€ Indexer: eventtypes, tags (search-time)
â”‚   â”‚   â”‚       â””â”€ SH: Full TA (field extractions, searches)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Stale/unsupported? â†’ Fork and maintain internally
â”‚   â”‚
â”‚   â””â”€ NO TA EXISTS?
â”‚       â”‚
â”‚       â””â”€ BUILD CUSTOM TA
â”‚           â”‚
â”‚           â”œâ”€ Log format analysis
â”‚           â”‚   â”œâ”€ Structured (JSON/XML)? â†’ Minimal parsing needed
â”‚           â”‚   â”œâ”€ Semi-structured (syslog)? â†’ REGEX extractions
â”‚           â”‚   â””â”€ Unstructured? â†’ Complex props.conf + transforms.conf
â”‚           â”‚
â”‚           â””â”€ Create in order:
â”‚               1. inputs.conf (data collection)
â”‚               2. props.conf (parsing, timestamp, linebreaking)
â”‚               3. transforms.conf (field extractions)
â”‚               4. eventtypes.conf (categorization)
â”‚               5. tags.conf (CIM compliance)</div>

                    <h3>Decision Tree: App vs TA vs Add-on Selection</h3>
                    <div class="arch-diagram">WHAT TYPE OF PACKAGE DO YOU NEED?
â”‚
â”œâ”€ Need data COLLECTION and PARSING only?
â”‚   â”‚
â”‚   â””â”€ Use TECHNOLOGY ADD-ON (TA)
â”‚       â”œâ”€ Examples: TA-windows, TA-microsoft-365
â”‚       â”œâ”€ Contains: inputs, props, transforms, eventtypes, tags
â”‚       â””â”€ No dashboards, saved searches, or UI components
â”‚
â”œâ”€ Need DASHBOARDS and SAVED SEARCHES for specific use case?
â”‚   â”‚
â”‚   â””â”€ Use APP
â”‚       â”œâ”€ Examples: Splunk Security Essentials, ES Content Update
â”‚       â”œâ”€ Contains: Dashboards, reports, alerts, navigation
â”‚       â””â”€ Usually requires corresponding TA for data
â”‚
â”œâ”€ Need PLATFORM EXTENSION or INTEGRATION?
â”‚   â”‚
â”‚   â””â”€ Use ADD-ON / SUPPORTING ADD-ON
â”‚       â”œâ”€ Examples: Splunk Add-on for AWS, DB Connect
â”‚       â”œâ”€ Contains: Modular inputs, custom commands, integrations
â”‚       â””â”€ Extends Splunk capabilities beyond basic parsing
â”‚
â””â”€ ENTERPRISE SECURITY (ES) context?
    â”‚
    â”œâ”€ Data collection for ES â†’ Domain Add-ons (DA-*)
    â”œâ”€ CIM compliance â†’ TAs with proper tags
    â””â”€ ES functionality â†’ SA-* (Supporting Add-ons)</div>

                    <h3>Decision Tree: CIM Compliance Assessment</h3>
                    <div class="arch-diagram">IS YOUR DATA CIM COMPLIANT?
â”‚
â”œâ”€ Run validation query:
â”‚   | datamodel Authentication search | head 5
â”‚   â”‚
â”‚   â”œâ”€ RETURNS DATA? â†’ CIM fields are populated
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ Check field completeness:
â”‚   â”‚   â”‚   | datamodel Authentication search
â”‚   â”‚   â”‚   | fieldsummary
â”‚   â”‚   â”‚   | where match(field, "^(user|src|dest|action)")
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€ All required fields present? â†’ Fully CIM compliant
â”‚   â”‚   â”‚   â””â”€ Missing fields? â†’ Partial compliance, update props.conf
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Verify tag application:
â”‚   â”‚       | tstats count from datamodel=Authentication by sourcetype
â”‚   â”‚       â””â”€ Sourcetype appears? â†’ Tags working correctly
â”‚   â”‚
â”‚   â””â”€ NO DATA? â†’ Not CIM mapped
â”‚       â”‚
â”‚       â”œâ”€ Check eventtypes: | eventtype | where eventtype=*authentication*
â”‚       â”œâ”€ Check tags: | head 1 | eval t=mvjoin(tag,",") | table t
â”‚       â””â”€ Missing tags? â†’ Add to tags.conf:
â”‚           [eventtype=your_auth_success]
â”‚           authentication = enabled
â”‚           success = enabled</div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                <div class="enterprise-gaps">
                    <div class="gap-grid">
                        <div class="gap-category critical">
                            <h4>ğŸ”´ Critical Gaps</h4>
                            <ul>
                                <li><strong>Version mismatches:</strong> Different TA versions on forwarders vs search heads causing field inconsistencies</li>
                                <li><strong>No CIM validation:</strong> Installing TAs without verifying data appears in data models</li>
                                <li><strong>Parsing on wrong tier:</strong> Heavy parsing on UFs (should be HFs) or all parsing on indexers</li>
                                <li><strong>Missing dependencies:</strong> Installing app without required TAs (ES without domain add-ons)</li>
                                <li><strong>Incorrect install location:</strong> Full TA on UF when only inputs.conf needed</li>
                            </ul>
                        </div>
                        <div class="gap-category warning">
                            <h4><i class="fas fa-exclamation-triangle"></i> Operational Gaps</h4>
                            <ul>
                                <li><strong>No TA inventory:</strong> No documentation of which TAs installed where</li>
                                <li><strong>Stale TAs:</strong> Using outdated TAs with known parsing issues or security vulnerabilities</li>
                                <li><strong>No update process:</strong> TAs never updated after initial deployment</li>
                                <li><strong>Missing eventtypes:</strong> TAs installed but eventtypes/tags not working</li>
                                <li><strong>Custom TAs undocumented:</strong> Internal TAs with no README or field documentation</li>
                            </ul>
                        </div>
                        <div class="gap-category info">
                            <h4><i class="fas fa-info-circle"></i> Performance Issues</h4>
                            <ul>
                                <li><strong>Expensive REGEX:</strong> TAs with inefficient extractions slowing search time</li>
                                <li><strong>Duplicate extractions:</strong> Same field extracted multiple times by different TAs</li>
                                <li><strong>Unnecessary fields:</strong> Extracting 50+ fields when only 10 are used</li>
                                <li><strong>Search-time vs index-time:</strong> Not optimizing when to extract fields</li>
                                <li><strong>Lookup overhead:</strong> Large automatic lookups in TAs slowing all searches</li>
                            </ul>
                        </div>
                        <div class="gap-category best-practice">
                            <h4><i class="fas fa-check-circle"></i> Best Practices Often Ignored</h4>
                            <ul>
                                <li><strong>Test in dev:</strong> Deploy TAs to test environment before production</li>
                                <li><strong>Validate CIM mapping:</strong> Run datamodel queries after TA deployment</li>
                                <li><strong>Document customizations:</strong> Track any changes to official TAs</li>
                                <li><strong>Monitor TA updates:</strong> Subscribe to Splunkbase notifications for critical TAs</li>
                                <li><strong>Use deployment server:</strong> Centralized TA management instead of manual installation</li>
                            </ul>
                        </div>
                    </div>

                    <h3><i class="fas fa-clipboard-check"></i> TA Deployment Checklist</h3>
                    <div class="checklist-grid">
                        <div class="checklist-section">
                            <h4>Pre-Deployment</h4>
                            <ul>
                                <li><input type="checkbox"> TA version compatibility with Splunk version verified</li>
                                <li><input type="checkbox"> TA dependencies identified and available</li>
                                <li><input type="checkbox"> Install locations determined (UF/HF/IDX/SH)</li>
                                <li><input type="checkbox"> Test environment deployment successful</li>
                            </ul>
                        </div>
                        <div class="checklist-section">
                            <h4>Post-Deployment</h4>
                            <ul>
                                <li><input type="checkbox"> Data flowing to expected index</li>
                                <li><input type="checkbox"> Timestamp parsing correct</li>
                                <li><input type="checkbox"> Key fields extracting properly</li>
                                <li><input type="checkbox"> CIM data models populated (if applicable)</li>
                            </ul>
                        </div>
                        <div class="checklist-section">
                            <h4>Ongoing Maintenance</h4>
                            <ul>
                                <li><input type="checkbox"> TA update alerts configured</li>
                                <li><input type="checkbox"> TA inventory documented</li>
                                <li><input type="checkbox"> Custom modifications tracked in Git</li>
                                <li><input type="checkbox"> Performance impact monitored</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is a Technology Add-on and where do you install it?</button>
                        <div class="qa-answer">
                            <p>"A Technology Add-on (TA) is a package that extends Splunk's ability to collect and parse data from specific sources. It contains inputs.conf for collection, props.conf for parsing, and tags.conf for CIM mapping. Install TAs on forwarders for data collection and on search heads for field extraction. Heavy forwarders get both since they collect AND parse locally."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you onboard a new data source to Splunk?</button>
                        <div class="qa-answer">
                            <p>"First, check Splunkbase for an existing TA. If one exists, install it and configure inputs. If not, analyze the log format - timestamp, delimiters, fields. Create a custom TA with props.conf for parsing, eventtypes.conf for categorization, and tags.conf for CIM compliance. Test in dev, then deploy via Deployment Server to forwarders and Deployer to Search Heads."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Why would you use a Heavy Forwarder for CrowdStrike?</button>
                        <div class="qa-answer">
                            <p>"The CrowdStrike TA uses the Event Streams API which requires Python to authenticate via OAuth2 and pull events. Universal Forwarders don't have Python, so you need a Heavy Forwarder. The HF authenticates to CrowdStrike's cloud API, pulls events, and forwards to indexers. It also allows local parsing before forwarding."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you troubleshoot a TA that's not extracting fields?</button>
                        <div class="qa-answer">
                            <ol>
                                <li>Verify TA is installed on Search Heads (field extraction is search-time)</li>
                                <li>Check btool for config errors: <code>splunk btool props list --debug</code></li>
                                <li>Verify sourcetype matches props.conf stanza</li>
                                <li>Check for conflicts with other TAs</li>
                                <li>Use fieldsummary to see what fields exist</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Explain the relationship between TAs, CIM, and Enterprise Security</button>
                        <div class="qa-answer">
                            <p><strong>The CIM Compliance Chain:</strong></p>
                            <ol>
                                <li><strong>TAs parse raw data</strong> â†’ Create sourcetype-specific fields</li>
                                <li><strong>TAs map to CIM</strong> â†’ eventtypes.conf + tags.conf normalize to common fields</li>
                                <li><strong>Data models query CIM tags</strong> â†’ Authentication, Network_Traffic, etc.</li>
                                <li><strong>ES uses data models</strong> â†’ Correlation searches, notable events, risk rules all query accelerated data models</li>
                            </ol>
                            <p><strong>Example flow:</strong></p>
                            <div class="arch-diagram">Raw Windows log â†’ TA-windows parses â†’ EventCode becomes signature_id
                      â†’ tags: authentication, success
                      â†’ datamodel: Authentication 
                      â†’ ES correlation: "Authentication - Brute Force"</div>
                            <p><strong>Key insight:</strong> If TAs aren't CIM-compliant, ES detections won't see the data, even if it's in Splunk.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle a TA version conflict between environments?</button>
                        <div class="qa-answer">
                            <p><strong>Scenario:</strong> Production has TA v2.0, new deployment requires v3.0 with breaking changes.</p>
                            <p><strong>Approach:</strong></p>
                            <ol>
                                <li><strong>Review changelog:</strong> Identify breaking changes (field renames, parsing changes)</li>
                                <li><strong>Test in dev:</strong> Deploy v3.0, validate all searches/dashboards still work</li>
                                <li><strong>Update dependent content:</strong> Fix any searches using old field names</li>
                                <li><strong>Coordinate deployment:</strong> Update all tiers simultaneously (UF/HF/SH) via deployment server</li>
                                <li><strong>Validate post-update:</strong> Run validation searches to confirm data flows correctly</li>
                            </ol>
                            <p><strong>Key risk:</strong> Partial updates (SH has v3, forwarders have v2) causes parsing mismatches.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you create a custom TA from scratch?</button>
                        <div class="qa-answer">
                            <p><strong>Step-by-step process:</strong></p>
                            <div class="arch-diagram">1. Create directory structure:
   $SPLUNK_HOME/etc/apps/TA-myapp/
   â”œâ”€â”€ default/
   â”‚   â”œâ”€â”€ app.conf
   â”‚   â”œâ”€â”€ inputs.conf
   â”‚   â”œâ”€â”€ props.conf
   â”‚   â”œâ”€â”€ transforms.conf
   â”‚   â”œâ”€â”€ eventtypes.conf
   â”‚   â””â”€â”€ tags.conf
   â””â”€â”€ metadata/
       â””â”€â”€ default.meta

2. app.conf - Define app metadata:
   [install]
   state = enabled
   [ui]
   is_visible = false
   label = TA for MyApp
   [launcher]
   version = 1.0.0

3. props.conf - Parsing configuration:
   [source::myapp.log]
   TIME_FORMAT = %Y-%m-%d %H:%M:%S
   TIME_PREFIX = timestamp=
   SHOULD_LINEMERGE = false
   LINE_BREAKER = ([\r\n]+)
   TRANSFORMS-sourcetype = set_myapp_sourcetype

   [myapp:security]
   REPORT-fields = extract_myapp_fields

4. transforms.conf - Field extractions:
   [set_myapp_sourcetype]
   REGEX = .
   DEST_KEY = MetaData:Sourcetype
   FORMAT = sourcetype::myapp:security

   [extract_myapp_fields]
   REGEX = user=(?&lt;user&gt;\w+)\s+action=(?&lt;action&gt;\w+)

5. eventtypes.conf + tags.conf - CIM mapping</div>
                            <p><strong>Pro tip:</strong> Use Splunk Add-on Builder app for faster development.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between index-time and search-time extractions?</button>
                        <div class="qa-answer">
                            <p><strong>Index-Time Extractions (transforms.conf with DEST_KEY):</strong></p>
                            <ul>
                                <li>Happen once during ingestion</li>
                                <li>Stored in index - cannot be changed later</li>
                                <li>Uses: sourcetype assignment, host override, index routing</li>
                                <li>Performance: Faster searches (pre-extracted)</li>
                            </ul>
                            <p><strong>Search-Time Extractions (props.conf EXTRACT/REPORT):</strong></p>
                            <ul>
                                <li>Happen every search</li>
                                <li>Can be modified without re-indexing</li>
                                <li>Uses: Most field extractions, calculated fields</li>
                                <li>Performance: Slower (extracted on demand)</li>
                            </ul>
                            <p><strong>When to use index-time:</strong> Routing decisions, metadata that won't change, high-cardinality fields searched frequently.</p>
                            <p><strong>When to use search-time:</strong> Everything else - flexibility trumps performance for most fields.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you validate CIM compliance for a data source?</button>
                        <div class="qa-answer">
                            <p><strong>Validation queries:</strong></p>
                            <div class="arch-diagram">// Step 1: Check tags are applied
index=your_index sourcetype=your_sourcetype earliest=-1h
| head 1
| eval all_tags = mvjoin(tag, ", ")
| table sourcetype all_tags
// Should show: authentication, success (or relevant CIM tags)

// Step 2: Verify datamodel population
| tstats count from datamodel=Authentication 
  where sourcetype=your_sourcetype by sourcetype
// Should return count > 0

// Step 3: Check field completeness
| datamodel Authentication search
| where sourcetype="your_sourcetype"
| fieldsummary
| where match(field, "^(user|src|dest|action|app|signature)")
| table field count distinct_count
// All required fields should have values

// Step 4: Validate field values
| datamodel Authentication search
| where sourcetype="your_sourcetype"
| stats dc(user) dc(src) dc(dest) values(action)
// Should show expected diversity and correct action values</div>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you manage TA deployment across hundreds of forwarders?</button>
                        <div class="qa-answer">
                            <p><strong>Deployment Server architecture:</strong></p>
                            <ol>
                                <li><strong>Server Classes:</strong> Group forwarders by role (Windows servers, Linux, Network devices)</li>
                                <li><strong>Deployment Apps:</strong> Create separate apps per TA/config type</li>
                                <li><strong>serverclass.conf:</strong> Map apps to server classes</li>
                            </ol>
                            <div class="arch-diagram">// serverclass.conf example
[serverClass:Windows_Servers]
whitelist.0 = *-win-*
restartSplunkd = true

[serverClass:Windows_Servers:app:TA-windows]
[serverClass:Windows_Servers:app:TA-microsoft-sysmon]

[serverClass:Linux_Servers]
whitelist.0 = *-lnx-*

[serverClass:Linux_Servers:app:TA-nix]</div>
                            <p><strong>Best practices:</strong></p>
                            <ul>
                                <li>Use Git for version control of deployment apps</li>
                                <li>Implement change management for production deployments</li>
                                <li>Monitor deployment status via <code>| rest /services/deployment/server/clients</code></li>
                                <li>Stagger restarts for large deployments</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>