<!DOCTYPE html>
<html lang="en" data-theme="dark" data-platform="splunk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Models & CIM - Common Information Model | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="index.html" class="platform-tab splunk active"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
                        <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Pipeline</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="forwarders.html" class="nav-link"><i class="fas fa-share"></i> Forwarders Deep Dive</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                    <a href="data-models.html" class="nav-link active"><i class="fas fa-cubes"></i> Data Models & CIM</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention & Buckets</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SPL Query Language</div>
                    <a href="spl-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> SPL Fundamentals</a>
                    <a href="spl-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> SPL Intermediate</a>
                    <a href="spl-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced SPL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Enterprise Security</div>
                    <a href="es-overview.html" class="nav-link"><i class="fas fa-shield-alt"></i> ES Overview</a>
                    <a href="correlation-searches.html" class="nav-link"><i class="fas fa-search-plus"></i> Correlation Searches</a>
                    <a href="notable-events.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Notable Events</a>
                    <a href="risk-based-alerting.html" class="nav-link"><i class="fas fa-chart-line"></i> Risk-Based Alerting</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">TI & Automation</div>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intelligence</a>
                    <a href="soar.html" class="nav-link"><i class="fas fa-robot"></i> Splunk SOAR</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="apps-tas.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> Apps & TAs</a>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-wrench"></i> Troubleshooting</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-cubes"></i> Data Models & CIM</h1>
                    <p class="lead">Common Information Model for normalized security data and accelerated searches</p>
                </div>

                <section class="content-section">
                    <h2><i class="fas fa-sitemap"></i> What is CIM?</h2>
                    <p>The Common Information Model (CIM) is a standardized schema that normalizes fields from different data sources. This enables vendor-agnostic detections and accelerated searches.</p>
                    
                    <div class="architecture-diagram" style="background: var(--card-bg); padding: 1.5rem; border-radius: 8px; font-family: monospace; font-size: 0.7rem;">
<pre>
RAW DATA                          CIM NORMALIZATION                 DATA MODEL
────────                          ─────────────────                 ──────────

Windows Security:                 props.conf mapping:               Authentication
  EventCode=4625                    FIELDALIAS-user                   ├── action = failure
  TargetUserName=jsmith             EVAL-action                       ├── user = jsmith
  IpAddress=10.0.0.1                                                  ├── src = 10.0.0.1
                                                                      └── dest = dc01
Linux auth.log:                   
  Failed password for             Same CIM fields!
  jsmith from 10.0.0.1            

Okta:                             
  outcome.result=FAILURE          All map to Authentication
  actor.alternateId=jsmith        data model with same fields
</pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-table"></i> Key Security Data Models</h2>
                    
                    <table class="styled-table">
                        <thead>
                            <tr><th>Data Model</th><th>Key Fields</th><th>Common Sources</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Authentication</strong></td>
                                <td>action, user, src, dest, app, authentication_method</td>
                                <td>Windows Security, Linux auth, VPN, Okta, LDAP</td>
                            </tr>
                            <tr>
                                <td><strong>Network_Traffic</strong></td>
                                <td>action, src, dest, src_port, dest_port, bytes, transport</td>
                                <td>Firewalls, NetFlow, IDS/IPS, Proxy</td>
                            </tr>
                            <tr>
                                <td><strong>Endpoint.Processes</strong></td>
                                <td>action, process, process_path, process_id, parent_process, user, dest</td>
                                <td>Sysmon, CrowdStrike, Carbon Black, MDE</td>
                            </tr>
                            <tr>
                                <td><strong>Endpoint.Filesystem</strong></td>
                                <td>action, file_name, file_path, file_hash, user, dest</td>
                                <td>Sysmon, EDR, FIM tools</td>
                            </tr>
                            <tr>
                                <td><strong>Web</strong></td>
                                <td>action, url, http_method, status, src, dest, user</td>
                                <td>Proxy, WAF, Web server logs</td>
                            </tr>
                            <tr>
                                <td><strong>Email</strong></td>
                                <td>action, src_user, recipient, subject, file_name, url</td>
                                <td>O365, Exchange, Email gateway</td>
                            </tr>
                            <tr>
                                <td><strong>Malware</strong></td>
                                <td>action, signature, file_name, file_hash, dest, user</td>
                                <td>AV, EDR, Sandbox</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-rocket"></i> Data Model Acceleration</h2>
                    <p>Accelerated data models pre-compute summaries for fast searching with <code>tstats</code>:</p>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">SPL</span>
                            <span class="code-title">tstats vs Regular Search</span>
                        </div>
                        <pre><code>// SLOW: Regular search (scans raw data)
index=* sourcetype=*security* action=failure
| stats count by user, src

// FAST: tstats on accelerated data model (10-100x faster)
| tstats count from datamodel=Authentication 
    where Authentication.action=failure 
    by Authentication.user, Authentication.src
| rename Authentication.* as *</code></pre>
                    </div>

                    <h3>Enable Acceleration</h3>
                    <p>Settings → Data Models → Select model → Edit Acceleration</p>
                    <ul>
                        <li><strong>Acceleration:</strong> Enable</li>
                        <li><strong>Summary Range:</strong> 7 days (typical for security)</li>
                        <li><strong>Backfill:</strong> Enable to populate historical data</li>
                    </ul>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-map-signs"></i> CIM Mapping in props.conf</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">conf</span>
                            <span class="code-title">props.conf - CIM Mapping Example</span>
                        </div>
                        <pre><code>[my_custom_auth_logs]
# Field Aliases - map source fields to CIM
FIELDALIAS-user = username AS user
FIELDALIAS-src = source_ip AS src
FIELDALIAS-dest = target_host AS dest

# Calculated fields
EVAL-action = case(result="success", "success", result="fail", "failure", 1=1, "unknown")
EVAL-vendor_product = "MyCustomApp"
EVAL-app = "authentication"

# Lookups for enrichment
LOOKUP-action_lookup = auth_action_lookup result OUTPUT action

# Tags for data model
# (defined in tags.conf)
# tag authentication = enabled</code></pre>
                    </div>
                </section>

                <section class="content-section interview-section" style="background: linear-gradient(135deg, rgba(101,166,55,0.1), rgba(101,166,55,0.2)); border-radius: 12px; padding: 2rem;">
                    <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>What is the purpose of CIM and why is it important for Splunk ES?</span>
                        </div>
                        <div class="interview-answer">
                            <p>CIM (Common Information Model) normalizes data from different vendors into a standard schema. This is critical for ES because:</p>
                            <p><strong>1. Vendor-agnostic detections:</strong> A single correlation search for "failed logins" works across Windows, Linux, Okta, VPN - because they all map to Authentication.action=failure. Without CIM, you'd need separate rules for each source.</p>
                            <p><strong>2. Accelerated searches:</strong> CIM data models can be accelerated (pre-computed summaries). Using tstats on accelerated models is 10-100x faster than raw searches. ES correlation searches depend on this for performance.</p>
                            <p><strong>3. Out-of-box content:</strong> ES ships with 100+ correlation searches that assume CIM compliance. If your data isn't CIM-mapped, ES detections won't work.</p>
                            <p><strong>Implementation:</strong> Use Technology Add-ons (TAs) for common sources - they include CIM mappings. For custom sources, add FIELDALIAS, EVAL, and tags in props.conf to map to CIM fields.</p>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
</body>
</html>
