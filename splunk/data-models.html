<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Models & CIM | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>
            <div class="sidebar-divider"></div>
            <div class="sidebar-section">
                <div class="sidebar-section-title">Splunk Pages</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Clustering & HA</span></a></li>
                    <li class="sidebar-nav-item"><a href="security-rbac.html" class="sidebar-nav-link"><i class="fas fa-user-lock"></i><span>Security & RBAC</span></a></li>
                    <li class="sidebar-nav-item"><a href="apps-tas.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Apps & TAs</span></a></li>
                    <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-paper-plane"></i><span>Forwarders</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-file-import"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-filter"></i><span>Parsing & Props/Transforms</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Index & Retention</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i><span>Data Models & CIM</span></a></li>
                    <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>Knowledge Objects</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>SPL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>SPL Intermediate</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>SPL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>Enterprise Security</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Correlation Searches</span></a></li>
                    <li class="sidebar-nav-item"><a href="notable-events.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Notable Events</span></a></li>
                    <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-exclamation-triangle"></i><span>Risk-Based Alerting</span></a></li>
                    <li class="sidebar-nav-item"><a href="alerting-actions.html" class="sidebar-nav-link"><i class="fas fa-bolt"></i><span>Alerting & Actions</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intelligence</span></a></li>
                    <li class="sidebar-nav-item"><a href="soar.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>SOAR</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="security-usecases.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Security Use Cases</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-binoculars"></i><span>Threat Hunting</span></a></li>
                    <li class="sidebar-nav-item"><a href="administration.html" class="sidebar-nav-link"><i class="fas fa-cog"></i><span>Administration</span></a></li>
                    <li class="sidebar-nav-item"><a href="performance-tuning.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>Performance Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="monitoring-console.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Monitoring Console</span></a></li>
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-tools"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Splunk Cloud</span></a></li>
                    <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise Scenarios</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Data Models</span>
                </div>

                <h1><i class="fas fa-layer-group"></i> Data Models & CIM</h1>
                <p class="lead">Master the Common Information Model (CIM) for Splunk. Learn data model structure, CIM field mapping, compliance requirements, and hands-on examples for making custom data CIM-compliant.</p>

                <!-- What is CIM -->
                <h2><i class="fas fa-info-circle"></i> Understanding CIM</h2>
                <div class="config-section">
                    <div class="arch-diagram">
COMMON INFORMATION MODEL (CIM) - WHAT IT IS
═══════════════════════════════════════════════════════════════════════════════

DEFINITION:
  CIM is Splunk's standardized data schema that normalizes field names across
  different data sources. It enables:
  
  • Write one search, query many sources
  • Enterprise Security correlation searches work
  • Consistent dashboards across vendors
  • Easier onboarding of new data sources

EXAMPLE - WITHOUT CIM:
─────────────────────────────────────────────────────────────────────────────
  Windows logs:    TargetUserName=john
  Linux logs:      user=john
  Okta logs:       actor.displayName=john
  VPN logs:        username=john

  PROBLEM: Need 4 different searches to find "john"

EXAMPLE - WITH CIM:
─────────────────────────────────────────────────────────────────────────────
  All sources map to: user=john

  ONE SEARCH: | tstats count from datamodel=Authentication by user
  RETURNS: Results from Windows, Linux, Okta, VPN - all normalized

HOW CIM WORKS:
─────────────────────────────────────────────────────────────────────────────

  ┌─────────────────────────────────────────────────────────────────────────┐
  │                         RAW DATA                                        │
  ├─────────────────────────────────────────────────────────────────────────┤
  │ Windows: TargetUserName=john, IpAddress=10.0.0.1, LogonType=3          │
  │ Linux:   user=john, src=10.0.0.1, method=ssh                           │
  │ Okta:    actor.displayName=john, client.ipAddress=10.0.0.1             │
  └────────────────────────────────────────────────┬────────────────────────┘
                                                   │
                                    Field Aliases (props.conf)
                                    Tags (tags.conf)
                                                   │
                                                   ▼
  ┌─────────────────────────────────────────────────────────────────────────┐
  │                    CIM NORMALIZED DATA MODEL                            │
  │                       (Authentication)                                  │
  ├─────────────────────────────────────────────────────────────────────────┤
  │  user = john                                                            │
  │  src = 10.0.0.1                                                         │
  │  action = success                                                       │
  │  app = Windows/Linux/Okta                                               │
  └─────────────────────────────────────────────────────────────────────────┘</div>
                </div>

                <!-- Key CIM Data Models -->
                <h2><i class="fas fa-database"></i> Key CIM Data Models for Security</h2>
                <div class="config-section">
                    <div class="arch-diagram">KEY CIM DATA MODELS - REQUIRED FIELDS
═══════════════════════════════════════════════════════════════════════════════

AUTHENTICATION (Login/Logout Events)
─────────────────────────────────────────────────────────────────────────────
  Sources: Windows Security, Linux auth, VPN, Okta, Azure AD
  
  Required Fields:
  ├── user         - Username attempting authentication
  ├── src          - Source IP address
  ├── dest         - Destination system
  ├── action       - success/failure
  ├── app          - Application name
  └── signature    - Event description
  
  Tags: authentication, (success OR failure)

NETWORK_TRAFFIC (Firewall, Proxy, NetFlow)
─────────────────────────────────────────────────────────────────────────────
  Sources: Palo Alto, Cisco ASA, Fortinet, Proxy logs
  
  Required Fields:
  ├── src_ip       - Source IP address
  ├── dest_ip      - Destination IP address
  ├── src_port     - Source port
  ├── dest_port    - Destination port
  ├── action       - allowed/blocked
  ├── bytes_in     - Bytes received
  ├── bytes_out    - Bytes sent
  └── transport    - tcp/udp
  
  Tags: network, communicate

ENDPOINT (EDR, Antivirus, System Events)
─────────────────────────────────────────────────────────────────────────────
  Sources: CrowdStrike, Carbon Black, Windows Defender, Sysmon
  
  Required Fields:
  ├── dest         - Endpoint hostname
  ├── user         - User context
  ├── file_name    - File involved
  ├── file_path    - Full file path
  ├── file_hash    - MD5/SHA256
  ├── signature    - Detection name
  └── action       - allowed/blocked
  
  Tags: endpoint, (process OR filesystem OR registry)

MALWARE (AV, Sandbox Verdicts)
─────────────────────────────────────────────────────────────────────────────
  Sources: Antivirus, EDR, Sandbox, Email gateway
  
  Required Fields:
  ├── dest         - Affected system
  ├── file_name    - Malware file name
  ├── file_hash    - File hash
  ├── signature    - Malware name/family
  ├── action       - blocked/deferred/allowed
  └── category     - Malware category
  
  Tags: malware, attack

WEB (Proxy, WAF, Web Server)
─────────────────────────────────────────────────────────────────────────────
  Sources: Proxy logs, WAF, Apache/IIS, CDN
  
  Required Fields:
  ├── src          - Client IP
  ├── dest         - Server IP
  ├── url          - Full URL
  ├── http_method  - GET/POST/etc
  ├── status       - HTTP status code
  ├── bytes_in     - Request size
  ├── bytes_out    - Response size
  └── user_agent   - Browser/client
  
  Tags: web</div>
                </div>

                <!-- Making Data CIM Compliant -->
                <h2><i class="fas fa-check-circle"></i> Making Data CIM-Compliant</h2>
                <div class="config-section">
                    <h4>CIM Compliance Requirements</h4>
                    <div class="arch-diagram">THREE STEPS TO CIM COMPLIANCE:
═══════════════════════════════════════════════════════════════════════════════

STEP 1: FIELD ALIASES (props.conf)
─────────────────────────────────────────────────────────────────────────────
Map source-specific fields to CIM standard names

[my:sourcetype]
FIELDALIAS-user = src_user AS user
FIELDALIAS-src = source_ip AS src
FIELDALIAS-action = result AS action

# Computed fields for CIM
EVAL-vendor = "MyVendor"
EVAL-vendor_product = "MyVendor MyProduct"
EVAL-action = case(status="200","allowed", status="403","blocked")

STEP 2: EVENT TYPES (eventtypes.conf)
─────────────────────────────────────────────────────────────────────────────
Categorize events for data model matching

[my_authentication_event]
search = sourcetype="my:sourcetype" action IN ("login","logout","auth")

STEP 3: TAGS (tags.conf)
─────────────────────────────────────────────────────────────────────────────
Tag events for data model inclusion

[eventtype=my_authentication_event]
authentication = enabled
default = enabled</div>

                    <h4>Complete CIM Compliance Example: Custom VPN Logs</h4>
                    <div class="arch-diagram">
HANDS-ON: MAKE CUSTOM VPN LOGS CIM-COMPLIANT FOR ENTERPRISE SECURITY
═══════════════════════════════════════════════════════════════════════════════

SAMPLE VPN LOG FORMAT:

  2024-01-15T10:30:45Z vpn-gw-01 CONNECT user=john.doe@company.com 
      client_ip=203.0.113.50 assigned_ip=10.100.0.25 tunnel=SSL-VPN 
      duration=0 status=connected

  2024-01-15T11:45:32Z vpn-gw-01 AUTH_FAIL user=jane.smith@company.com 
      client_ip=192.0.2.100 reason="invalid_password" attempts=3 status=failed

STEP 1: CREATE props.conf FOR PARSING + CIM MAPPING
─────────────────────────────────────────────────────────────────────────────

# File: $SPLUNK_HOME/etc/apps/TA_custom_vpn/local/props.conf

[custom:vpn]
# Timestamp extraction
TIME_FORMAT = %Y-%m-%dT%H:%M:%S%Z
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 25
TZ = UTC

# Event breaking
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)

# Field extractions
EXTRACT-host = ^\d{4}-\d{2}-\d{2}T[\d:]+Z\s+(?P<vpn_gateway>\S+)
EXTRACT-action_type = ^\S+\s+\S+\s+(?P<action_type>\S+)
EXTRACT-user = user=(?P<src_user>[^\s]+)
EXTRACT-client_ip = client_ip=(?P<client_ip>[\d.]+)
EXTRACT-assigned_ip = assigned_ip=(?P<assigned_ip>[\d.]+)
EXTRACT-tunnel = tunnel=(?P<tunnel_type>\S+)
EXTRACT-status = status=(?P<status>\S+)

# ═══════════════════════════════════════════════════════════════════════════
# CIM FIELD MAPPING - Authentication Data Model
# ═══════════════════════════════════════════════════════════════════════════

# Map to CIM standard field names
FIELDALIAS-user = src_user AS user
FIELDALIAS-src = client_ip AS src
FIELDALIAS-dest = vpn_gateway AS dest
FIELDALIAS-src_ip = client_ip AS src_ip

# Computed fields for CIM compliance
EVAL-vendor = "CustomVendor"
EVAL-vendor_product = "CustomVendor VPN Gateway"
EVAL-product = "VPN Gateway"
EVAL-app = "vpn"

# Map status to CIM action field
EVAL-action = case(
    status=="connected", "success",
    status=="failed", "failure",
    status=="disconnected", "success",
    1==1, "unknown"
)

# Map to CIM signature fields
EVAL-signature = action_type
EVAL-signature_id = case(
    action_type=="CONNECT", "100",
    action_type=="DISCONNECT", "101",
    action_type=="AUTH_FAIL", "200",
    1==1, "0"
)

STEP 2: CREATE eventtypes.conf FOR CIM CATEGORIZATION
─────────────────────────────────────────────────────────────────────────────

# File: $SPLUNK_HOME/etc/apps/TA_custom_vpn/local/eventtypes.conf

[custom_vpn_authentication]
search = sourcetype="custom:vpn" (action_type="CONNECT" OR action_type="AUTH_FAIL")

[custom_vpn_failed_auth]
search = sourcetype="custom:vpn" action_type="AUTH_FAIL"

STEP 3: CREATE tags.conf FOR DATA MODEL ASSIGNMENT
─────────────────────────────────────────────────────────────────────────────

# File: $SPLUNK_HOME/etc/apps/TA_custom_vpn/local/tags.conf

[eventtype=custom_vpn_authentication]
authentication = enabled

[eventtype=custom_vpn_failed_auth]
authentication = enabled
failure = enabled

STEP 4: VERIFY CIM COMPLIANCE
─────────────────────────────────────────────────────────────────────────────

# Check fields are extracted
index=vpn sourcetype="custom:vpn" earliest=-1h
| table _time, user, src, dest, action, app, vendor_product

# Check tags are applied
index=vpn sourcetype="custom:vpn" earliest=-1h
| head 1
| eval mytags=mvjoin(tag, ", ")
| table mytags
# Should show: authentication, success (or failure)

# Check data model inclusion
| tstats count from datamodel=Authentication 
    where nodename=Authentication by Authentication.user, Authentication.src</div>
                </div>

                <!-- Data Model Acceleration -->
                <h2><i class="fas fa-bolt"></i> Data Model Acceleration</h2>
                <div class="config-section">
                    <div class="arch-diagram">DATA MODEL ACCELERATION
═══════════════════════════════════════════════════════════════════════════════

WHAT IS ACCELERATION?
─────────────────────────────────────────────────────────────────────────────
Acceleration pre-computes and stores summaries of data model fields.
This makes tstats queries run in seconds instead of minutes.

WITHOUT ACCELERATION:
  | tstats count from datamodel=Authentication → Scans raw events → SLOW

WITH ACCELERATION:
  | tstats count from datamodel=Authentication → Reads summary → FAST

ENABLE ACCELERATION:
─────────────────────────────────────────────────────────────────────────────
Settings → Data Models → [Model Name] → Edit Acceleration

Configuration:
├── Accelerate: ✓ Enabled
├── Summary Range: 1 Year (typical for security)
├── Backfill: Oldest time to backfill
└── Earliest/Latest allowed: Time bounds

IMPORTANT SETTINGS:
├── acceleration.earliest_time = -1y
├── acceleration.backfill_time = -30d
├── acceleration.max_concurrent = 3 (per search head)

CHECK ACCELERATION STATUS:
─────────────────────────────────────────────────────────────────────────────

# Check if data model is accelerated
| datamodelsimple type=models
| search modelName="Authentication"
| table modelName, acceleration, acceleration.complete

# Check acceleration status detail
| rest /services/admin/summarization
| search datamodel_name="*Authentication*"
| table datamodel_name, complete, earliest_time, latest_time, size_on_disk

# Check acceleration job status
index=_internal sourcetype=scheduler savedsearch_name="*Authentication*"
| stats latest(run_time) as run_time latest(result_count) as count by savedsearch_name

TROUBLESHOOTING ACCELERATION:
─────────────────────────────────────────────────────────────────────────────

ISSUE: Acceleration stuck at low percentage
Cause: Not enough data with correct tags
Fix:   Verify tags are applied: tag=authentication

ISSUE: Acceleration shows 0%
Cause: No matching data or permissions issue
Fix:   Check index permissions, verify data exists

ISSUE: tstats returns no results but raw search works
Cause: Data model not accelerated or field missing from model
Fix:   Enable acceleration, verify field is in data model

# Debug command - compare raw vs accelerated
| tstats prestats=t count from datamodel=Authentication by _time span=1d
| append [search index=* tag=authentication earliest=-7d | stats count by _time span=1d]
| stats sum(count) by _time</div>
                </div>

                <!-- tstats Queries -->
                <h2><i class="fas fa-search"></i> Using tstats with Data Models</h2>
                <div class="config-section">
                    <div class="arch-diagram">TSTATS - FAST QUERIES AGAINST DATA MODELS
═══════════════════════════════════════════════════════════════════════════════

BASIC SYNTAX:
─────────────────────────────────────────────────────────────────────────────
| tstats [options] <stats-function> from datamodel=<DataModel>.<Dataset>
    where <constraints>
    by <fields>

# summariesonly=t - Only use accelerated data (faster, but may miss recent)
# prestats=t - Return raw values for further processing

AUTHENTICATION DATA MODEL EXAMPLES:
─────────────────────────────────────────────────────────────────────────────

# Failed logins by user (last 24h)
| tstats count from datamodel=Authentication 
    where Authentication.action="failure"
    by Authentication.user
| sort -count

# Authentication attempts by source IP
| tstats count from datamodel=Authentication
    where nodename=Authentication
    by Authentication.src
| sort -count
| head 20

# Successful logins over time
| tstats count from datamodel=Authentication
    where Authentication.action="success"
    by _time span=1h
| timechart span=1h sum(count)

NETWORK_TRAFFIC DATA MODEL EXAMPLES:
─────────────────────────────────────────────────────────────────────────────

# Top talkers by bytes
| tstats sum(All_Traffic.bytes) as bytes from datamodel=Network_Traffic
    where nodename=All_Traffic
    by All_Traffic.src_ip
| sort -bytes
| head 20

# Blocked connections by destination
| tstats count from datamodel=Network_Traffic
    where All_Traffic.action="blocked"
    by All_Traffic.dest_ip, All_Traffic.dest_port
| sort -count

# Traffic over time by action
| tstats count from datamodel=Network_Traffic
    by _time span=1h All_Traffic.action
| timechart span=1h sum(count) by All_Traffic.action

ENDPOINT DATA MODEL EXAMPLES:
─────────────────────────────────────────────────────────────────────────────

# Process creation by user
| tstats count from datamodel=Endpoint.Processes
    where nodename=Processes
    by Processes.user, Processes.process_name
| sort -count

# File changes by host
| tstats count from datamodel=Endpoint.Filesystem
    where nodename=Filesystem
    by Filesystem.dest
| sort -count

COMBINING WITH RAW SEARCHES:
─────────────────────────────────────────────────────────────────────────────

# Start with tstats, drill down with raw
| tstats count from datamodel=Authentication
    where Authentication.action="failure" Authentication.user="admin"
    by Authentication.src
| sort -count
| head 5
| map search="search index=* user=admin src=$src$ action=failure"</div>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Data Model Decision Trees</h2>
                <div class="config-section">
                    <h3>Decision Tree: Data Model Selection</h3>
                    <div class="arch-diagram">WHAT DATA MODEL FOR THIS DATA SOURCE?
│
├─ Authentication events (login/logout)?
│   │
│   └─ AUTHENTICATION DATA MODEL
│       ├─ Required fields: action, src, user
│       ├─ Required tag: authentication
│       └─ Use for: Failed logins, brute force, credential theft
│
├─ Network traffic (firewall, proxy, flow)?
│   │
│   └─ NETWORK_TRAFFIC DATA MODEL
│       ├─ Required fields: action, dest, dest_port, src
│       ├─ Required tag: network, communicate
│       └─ Use for: Lateral movement, C2, data exfil
│
├─ DNS queries?
│   │
│   └─ NETWORK_RESOLUTION DATA MODEL
│       ├─ Required fields: query, answer, src
│       ├─ Required tag: network, resolution, dns
│       └─ Use for: DNS tunneling, DGA, threat intel
│
├─ Process execution (Sysmon, EDR)?
│   │
│   └─ ENDPOINT.PROCESSES DATA MODEL
│       ├─ Required fields: process, process_id, parent_process, user
│       ├─ Required tag: endpoint, process, report
│       └─ Use for: Malware, living-off-land, persistence
│
├─ File activity?
│   │
│   └─ ENDPOINT.FILESYSTEM DATA MODEL
│       ├─ Required fields: file_path, file_name, action
│       ├─ Required tag: endpoint, filesystem
│       └─ Use for: Ransomware, dropper activity
│
├─ Web traffic (proxy logs)?
│   │
│   └─ WEB DATA MODEL
│       ├─ Required fields: url, http_method, status
│       ├─ Required tag: web
│       └─ Use for: Webshells, downloads, phishing
│
└─ Security alerts from tools?
    │
    └─ INTRUSION_DETECTION or ALERTS DATA MODEL
        ├─ Required fields: signature, severity, src, dest
        └─ Use for: Correlation with other sources</div>

                    <h3>Decision Tree: CIM Compliance Troubleshooting</h3>
                    <div class="arch-diagram">DATA NOT APPEARING IN DATA MODEL?
│
├─ Step 1: Is data being indexed?
│   │
│   └─ Search: index=myindex | head 10
│       │
│       ├─ No results → Ingestion issue
│       └─ Results found → Continue to Step 2
│
├─ Step 2: Is sourcetype correct?
│   │
│   └─ Search: index=myindex | stats count by sourcetype
│       │
│       ├─ Wrong sourcetype → Fix inputs.conf
│       └─ Correct sourcetype → Continue to Step 3
│
├─ Step 3: Are CIM fields mapped?
│   │
│   └─ Search: index=myindex | head 1 | table user src action
│       │
│       ├─ Fields empty → Add FIELDALIAS in props.conf
│       └─ Fields populated → Continue to Step 4
│
├─ Step 4: Is event type assigned?
│   │
│   └─ Search: index=myindex | head 1 | table eventtype
│       │
│       ├─ No eventtype → Create in eventtypes.conf
│       └─ Has eventtype → Continue to Step 5
│
├─ Step 5: Are tags applied?
│   │
│   └─ Search: index=myindex | head 1 | table tag
│       │
│       ├─ Missing tags → Add in tags.conf
│       └─ Tags present → Continue to Step 6
│
└─ Step 6: Is acceleration working?
    │
    └─ | datamodel Authentication search
        │
        ├─ No data → Acceleration not complete or rebuild needed
        └─ Data appears → CIM compliance verified!</div>

                    <h3>Decision Tree: Acceleration Strategy</h3>
                    <div class="arch-diagram">SHOULD I ACCELERATE THIS DATA MODEL?
│
├─ How much data is in the model?
│   │
│   ├─ &lt;10 GB/day → May not need acceleration
│   │   └─ Test tstats performance first
│   │
│   └─ &gt;10 GB/day → Acceleration recommended
│
├─ How often is it queried?
│   │
│   ├─ ES correlation searches → YES, accelerate
│   │
│   ├─ Frequent dashboard queries → YES, accelerate
│   │
│   └─ Ad-hoc hunting only → Maybe not needed
│
├─ What's the summary cost?
│   │
│   └─ Estimate: 1-3% of raw data size
│       │
│       ├─ Acceptable? → Enable acceleration
│       └─ Too expensive? → Consider selective period
│
└─ Acceleration settings:
    │
    └─ Settings → Data Models → [Model] → Accelerate
        ├─ Summary Range: Match your retention
        ├─ Earliest: -1y (or as needed)
        ├─ Backfill: Yes for historical data
        └─ Monitor: Check acceleration status regularly</div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                <div class="enterprise-gaps">
                    <div class="gap-grid">
                        <div class="gap-category critical">
                            <h4><i class="fas fa-times-circle"></i> Critical Gaps</h4>
                            <ul>
                                <li><strong>No CIM validation:</strong> Data ingested but ES can't find it - correlation searches fail silently</li>
                                <li><strong>Missing tags:</strong> Field aliases done but tags not applied - data model empty</li>
                                <li><strong>Partial CIM mapping:</strong> "action" and "user" mapped but "src" missing - ES rules don't work</li>
                                <li><strong>Acceleration disabled:</strong> ES dashboards crawling because models not accelerated</li>
                                <li><strong>Wrong field normalization:</strong> "action=ALLOWED" instead of "action=allowed" - case mismatch breaks rules</li>
                            </ul>
                        </div>
                        <div class="gap-category warning">
                            <h4><i class="fas fa-exclamation-triangle"></i> Operational Gaps</h4>
                            <ul>
                                <li><strong>Stale accelerations:</strong> New sourcetypes added but acceleration not rebuilt</li>
                                <li><strong>No coverage tracking:</strong> Don't know which sources are CIM-compliant</li>
                                <li><strong>Inconsistent normalization:</strong> Same field mapped differently across sourcetypes</li>
                                <li><strong>Over-indexing:</strong> Every possible field mapped, bloating summaries</li>
                                <li><strong>No documentation:</strong> CIM mappings in props.conf but no reference docs</li>
                            </ul>
                        </div>
                        <div class="gap-category info">
                            <h4><i class="fas fa-info-circle"></i> Performance Issues</h4>
                            <ul>
                                <li><strong>Using search instead of tstats:</strong> Raw searches when accelerated queries available</li>
                                <li><strong>Over-acceleration:</strong> Accelerating models that are rarely queried</li>
                                <li><strong>Too long acceleration range:</strong> Summarizing 5 years when only 90 days queried</li>
                                <li><strong>Rebuild storms:</strong> Frequent props.conf changes triggering rebuilds</li>
                                <li><strong>summariesonly ignorance:</strong> Not using summariesonly=t to force accelerated data</li>
                            </ul>
                        </div>
                        <div class="gap-category best-practice">
                            <h4><i class="fas fa-check-circle"></i> Best Practices Often Ignored</h4>
                            <ul>
                                <li><strong>Test CIM compliance:</strong> <code>| datamodel [Model] search | where sourcetype="new_source"</code></li>
                                <li><strong>Monitor acceleration health:</strong> Check Settings → Data Models for errors</li>
                                <li><strong>Use CIM validator app:</strong> Splunk CIM Validator from Splunkbase</li>
                                <li><strong>Normalize values not just names:</strong> action should be success/failure, not TRUE/FALSE</li>
                                <li><strong>Document CIM coverage:</strong> Matrix of sourcetypes vs data models</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What is CIM and why is it important for Enterprise Security?</button>
                        <div class="qa-answer">
                            <p>"CIM (Common Information Model) is Splunk's standardized schema that normalizes field names across different data sources. Instead of 'TargetUserName' from Windows, 'user' from Linux, and 'actor.displayName' from Okta, CIM maps them all to 'user'. This is critical for Enterprise Security because correlation searches are written against CIM fields - they work across all data sources automatically. Without CIM compliance, ES detections won't work."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you make custom data CIM-compliant?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>props.conf:</strong> Add FIELDALIAS to map source fields to CIM names, EVAL for computed fields</li>
                                <li><strong>eventtypes.conf:</strong> Create event types that categorize your data</li>
                                <li><strong>tags.conf:</strong> Tag event types with CIM tags (authentication, network, etc.)</li>
                                <li><strong>Verify:</strong> Check tags applied and data appears in data model</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What is data model acceleration and when should you use it?</button>
                        <div class="qa-answer">
                            <p>"Acceleration pre-computes summaries of data model fields, making tstats queries run in seconds instead of minutes. Use it when you have large data volumes and need fast queries - especially for ES dashboards and correlation searches. The tradeoff is disk space for summaries (typically 1-3% of raw data) and some processing overhead. Always accelerate the key security models: Authentication, Network_Traffic, Endpoint."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Why would tstats return no results when a raw search works?</button>
                        <div class="qa-answer">
                            <ul>
                                <li>Data model not accelerated</li>
                                <li>Tags not applied to the data</li>
                                <li>Field not included in the data model schema</li>
                                <li>Using summariesonly=t with very recent data not yet summarized</li>
                                <li>Permissions issue - user can't access accelerated summaries</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>