<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Models | Splunk | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Splunk Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="es-overview.html" class="nav-link"><i class="fas fa-shield-alt"></i> Enterprise Security</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="forwarders.html" class="nav-link"><i class="fas fa-share"></i> Forwarders</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & Indexing</a>
                    <a href="apps-tas.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> Apps & TAs</a>
                    <a href="data-models.html" class="nav-link active"><i class="fas fa-cubes"></i> Data Models (CIM)</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SPL Query Language</div>
                    <a href="spl-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> SPL Fundamentals</a>
                    <a href="spl-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> SPL Intermediate</a>
                    <a href="spl-advanced.html" class="nav-link"><i class="fas fa-code"></i> SPL Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">ES Detection</div>
                    <a href="correlation-searches.html" class="nav-link"><i class="fas fa-project-diagram"></i> Correlation Searches</a>
                    <a href="notable-events.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Notable Events</a>
                    <a href="risk-based-alerting.html" class="nav-link"><i class="fas fa-chart-line"></i> Risk-Based Alerting</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intelligence</a>
                    <a href="soar.html" class="nav-link"><i class="fas fa-robot"></i> SOAR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention & Storage</a>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-wrench"></i> Troubleshooting</a>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Splunk</a><span class="separator">/</span>
                    <span class="current">Data Models</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-cubes"></i> Splunk Data Models & CIM</h1>
                <p class="lead">Data Models and the Common Information Model (CIM) are fundamental to Splunk Enterprise Security. They provide a normalized schema for vendor-agnostic detection and enable high-performance searches via tstats.</p>

                <!-- WHAT ARE DATA MODELS -->
                <h2><i class="fas fa-question-circle"></i> What Are Data Models?</h2>
                
                <div class="info-box">
                    <h4><i class="fas fa-lightbulb"></i> Data Model Fundamentals</h4>
                    <p>A Data Model is a hierarchical schema that organizes data into objects, attributes, and relationships. Key benefits:</p>
                    <ul>
                        <li><strong>Normalization:</strong> Consistent field names across vendors</li>
                        <li><strong>Acceleration:</strong> Pre-computed summaries for fast queries</li>
                        <li><strong>Abstraction:</strong> Write queries without knowing source format</li>
                        <li><strong>ES Foundation:</strong> Correlation searches rely on data models</li>
                    </ul>
                </div>

                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-sitemap"></i> Data Model Structure</div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 24px; margin-top: 16px;">
                        <div style="background: #0d1117; border: 2px solid #58a6ff; border-radius: 12px; padding: 20px; text-align: center;">
                            <h4 style="color: #58a6ff; margin-top: 0;"><i class="fas fa-cube"></i> Root Object</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">Top-level container</p>
                            <p style="color: #f0f6fc; font-size: 0.9rem;"><strong>Example:</strong> Authentication</p>
                        </div>
                        <div style="background: #0d1117; border: 2px solid #3fb950; border-radius: 12px; padding: 20px; text-align: center;">
                            <h4 style="color: #3fb950; margin-top: 0;"><i class="fas fa-cubes"></i> Child Objects</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">Specific categories</p>
                            <p style="color: #f0f6fc; font-size: 0.9rem;"><strong>Examples:</strong> Default_Authentication, Privileged_Authentication</p>
                        </div>
                        <div style="background: #0d1117; border: 2px solid #d29922; border-radius: 12px; padding: 20px; text-align: center;">
                            <h4 style="color: #d29922; margin-top: 0;"><i class="fas fa-tags"></i> Fields/Attributes</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">Normalized properties</p>
                            <p style="color: #f0f6fc; font-size: 0.9rem;"><strong>Examples:</strong> user, action, src, dest</p>
                        </div>
                    </div>
                </div>

                <!-- CIM OVERVIEW -->
                <h2><i class="fas fa-link"></i> Common Information Model (CIM)</h2>

                <div class="info-box" style="border-color: #3fb950;">
                    <h4><i class="fas fa-globe"></i> CIM = Splunk's Universal Translator</h4>
                    <p>The CIM is a set of pre-built data models with standardized field names. Think of it like a Rosetta Stone that translates different vendor formats into a common language.</p>
                    <ul>
                        <li><strong>Example:</strong> Windows calls it "SourceIP", Palo Alto calls it "src", Cisco calls it "sourceAddress" → CIM normalizes all to <code>src</code></li>
                        <li><strong>Benefit:</strong> Write one correlation search that works with any vendor's firewall</li>
                    </ul>
                </div>

                <!-- CIM DATA MODELS TABLE -->
                <h2><i class="fas fa-table"></i> Key CIM Data Models for Security</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr><th>Data Model</th><th>Purpose</th><th>Key Fields</th><th>Example Sources</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Authentication</strong></td>
                                <td>Login events</td>
                                <td>user, action, src, dest, app, signature</td>
                                <td>Windows 4624/4625, Okta, Azure AD</td>
                            </tr>
                            <tr>
                                <td><strong>Network_Traffic</strong></td>
                                <td>Network connections</td>
                                <td>src, dest, src_port, dest_port, bytes, action</td>
                                <td>Firewalls, NetFlow, Zeek</td>
                            </tr>
                            <tr>
                                <td><strong>Endpoint</strong></td>
                                <td>Endpoint activity</td>
                                <td>dest, user, process_name, process_path, action</td>
                                <td>Sysmon, CrowdStrike, Carbon Black</td>
                            </tr>
                            <tr>
                                <td><strong>Malware</strong></td>
                                <td>Malware detections</td>
                                <td>signature, file_name, file_hash, action, category</td>
                                <td>AV products, EDR, sandboxes</td>
                            </tr>
                            <tr>
                                <td><strong>Web</strong></td>
                                <td>HTTP activity</td>
                                <td>url, http_method, status, src, dest, user_agent</td>
                                <td>Proxy logs, web servers, WAF</td>
                            </tr>
                            <tr>
                                <td><strong>Intrusion_Detection</strong></td>
                                <td>IDS/IPS alerts</td>
                                <td>signature, severity, src, dest, category</td>
                                <td>Snort, Suricata, Palo Alto</td>
                            </tr>
                            <tr>
                                <td><strong>Change</strong></td>
                                <td>Configuration changes</td>
                                <td>object, action, user, result, object_category</td>
                                <td>AD changes, file integrity, config mgmt</td>
                            </tr>
                            <tr>
                                <td><strong>Email</strong></td>
                                <td>Email activity</td>
                                <td>src_user, recipient, subject, action, file_name</td>
                                <td>Exchange, O365, Proofpoint</td>
                            </tr>
                            <tr>
                                <td><strong>DLP</strong></td>
                                <td>Data loss prevention</td>
                                <td>src, user, action, file_name, dlp_type</td>
                                <td>Symantec DLP, Microsoft Purview</td>
                            </tr>
                            <tr>
                                <td><strong>Vulnerability</strong></td>
                                <td>Vulnerability scans</td>
                                <td>dest, signature, severity, cvss, cve</td>
                                <td>Qualys, Tenable, Rapid7</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- AUTHENTICATION DATA MODEL DEEP DIVE -->
                <h2><i class="fas fa-user-shield"></i> Authentication Data Model Deep Dive</h2>

                <div class="pipeline">
                    <div class="pipeline-stage" data-step="1">
                        <div class="pipeline-stage-title">Authentication</div>
                        <div class="pipeline-stage-desc">Root object</div>
                        <div class="pipeline-stage-details">
                            <p>All authentication events</p>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="2">
                        <div class="pipeline-stage-title">Default_Authentication</div>
                        <div class="pipeline-stage-desc">Child: Standard logins</div>
                        <div class="pipeline-stage-details">
                            <p>Normal user authentication</p>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="3">
                        <div class="pipeline-stage-title">Privileged_Authentication</div>
                        <div class="pipeline-stage-desc">Child: Admin logins</div>
                        <div class="pipeline-stage-details">
                            <p>Elevated privilege auth</p>
                        </div>
                    </div>
                </div>

                <h3>Authentication CIM Fields</h3>
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr><th>CIM Field</th><th>Description</th><th>Windows 4624</th><th>Okta</th><th>Azure AD</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><code>user</code></td><td>Username</td><td>Account_Name</td><td>actor.displayName</td><td>UserPrincipalName</td></tr>
                            <tr><td><code>action</code></td><td>success/failure</td><td>Keywords (Success/Failure)</td><td>outcome.result</td><td>ResultType (0=success)</td></tr>
                            <tr><td><code>src</code></td><td>Source IP</td><td>Source_Network_Address</td><td>client.ipAddress</td><td>IPAddress</td></tr>
                            <tr><td><code>dest</code></td><td>Destination host</td><td>Computer</td><td>N/A</td><td>ResourceDisplayName</td></tr>
                            <tr><td><code>app</code></td><td>Application</td><td>Process_Name</td><td>target.displayName</td><td>AppDisplayName</td></tr>
                            <tr><td><code>signature</code></td><td>Event type</td><td>EventCode</td><td>eventType</td><td>OperationName</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- DATA MODEL ACCELERATION -->
                <h2><i class="fas fa-bolt"></i> Data Model Acceleration</h2>

                <div class="decision-tree">
                    <div class="decision-node">
                        <div class="decision-node-question">Should you accelerate this data model?</div>
                    </div>
                    <div class="decision-paths">
                        <div class="decision-path">
                            <div class="decision-path-label yes">Yes - Accelerate</div>
                            <div class="decision-path-content">
                                <p style="color: #3fb950; font-weight: 600;">→ Enable Acceleration</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">Data model is used in dashboards, correlation searches, or frequent queries. Performance gain worth the storage cost.</p>
                            </div>
                        </div>
                        <div class="decision-path">
                            <div class="decision-path-label no">No - Don't Accelerate</div>
                            <div class="decision-path-content">
                                <p style="color: #d29922; font-weight: 600;">→ Leave Raw</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">Low query volume, small data set, or storage constraints. Ad-hoc queries can use datamodel command.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <h4><i class="fas fa-tachometer-alt"></i> Acceleration Benefits</h4>
                    <ul>
                        <li><strong>Speed:</strong> tstats queries run 10-100x faster than raw search</li>
                        <li><strong>Scale:</strong> Query billions of events in seconds</li>
                        <li><strong>ES Requirement:</strong> Most ES dashboards require accelerated models</li>
                    </ul>
                    <p><strong>Trade-off:</strong> Acceleration uses ~5-10% additional storage. Summary range determines how far back tstats can query.</p>
                </div>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> Checking Acceleration Status</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">| rest /services/datamodel/acceleration</span>
| <span style="color: #f97583;">table</span> title, acceleration, acceleration.earliest_time, 
       "acceleration.cron_schedule", "eai:acl.app"
| <span style="color: #f97583;">sort</span> title
</pre>
                </div>

                <!-- TSTATS QUERIES -->
                <h2><i class="fas fa-terminal"></i> Using tstats with Data Models</h2>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> tstats Query Examples</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Basic tstats - count failed logins</span>
| <span style="color: #f97583;">tstats</span> <span style="color: #79c0ff;">count</span> <span style="color: #f97583;">from</span> datamodel=Authentication
  <span style="color: #f97583;">where</span> Authentication.action=failure
  <span style="color: #f97583;">by</span> Authentication.user, Authentication.src

<span style="color: #8b949e;">// tstats with time binning for charts</span>
| <span style="color: #f97583;">tstats</span> <span style="color: #79c0ff;">count</span> <span style="color: #f97583;">from</span> datamodel=Authentication
  <span style="color: #f97583;">where</span> Authentication.action=failure
  <span style="color: #f97583;">by</span> _time, Authentication.user
  span=1h
| <span style="color: #f97583;">timechart</span> span=1h <span style="color: #79c0ff;">sum</span>(count) <span style="color: #f97583;">by</span> Authentication.user

<span style="color: #8b949e;">// Network Traffic - top talkers</span>
| <span style="color: #f97583;">tstats</span> <span style="color: #79c0ff;">sum</span>(All_Traffic.bytes) <span style="color: #f97583;">as</span> total_bytes
  <span style="color: #f97583;">from</span> datamodel=Network_Traffic.All_Traffic
  <span style="color: #f97583;">by</span> All_Traffic.src
| <span style="color: #f97583;">sort</span> - total_bytes
| <span style="color: #f97583;">head</span> 10

<span style="color: #8b949e;">// Endpoint - suspicious processes</span>
| <span style="color: #f97583;">tstats</span> <span style="color: #79c0ff;">count</span> <span style="color: #f97583;">from</span> datamodel=Endpoint.Processes
  <span style="color: #f97583;">where</span> Processes.process_name=powershell.exe
  <span style="color: #f97583;">by</span> Processes.dest, Processes.user, Processes.parent_process_name
| <span style="color: #f97583;">rename</span> Processes.* <span style="color: #f97583;">as</span> *

<span style="color: #8b949e;">// Malware - detection summary</span>
| <span style="color: #f97583;">tstats</span> <span style="color: #79c0ff;">count</span> <span style="color: #f97583;">from</span> datamodel=Malware
  <span style="color: #f97583;">where</span> Malware.action=allowed
  <span style="color: #f97583;">by</span> Malware.dest, Malware.signature
| <span style="color: #f97583;">sort</span> - count
</pre>
                </div>

                <h3>tstats vs datamodel Command</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1a4d2e; color: #3fb950;"><i class="fas fa-bolt"></i></div>
                            <div class="comparison-item-title">tstats (Accelerated)</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> 10-100x faster</li>
                            <li><i class="fas fa-check"></i> Uses pre-computed summaries</li>
                            <li><i class="fas fa-check"></i> Great for dashboards</li>
                            <li><i class="fas fa-times"></i> Requires acceleration enabled</li>
                            <li><i class="fas fa-times"></i> Limited to accelerated time range</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #4d3a0d; color: #d29922;"><i class="fas fa-search"></i></div>
                            <div class="comparison-item-title">datamodel Command</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Works without acceleration</li>
                            <li><i class="fas fa-check"></i> Access all raw events</li>
                            <li><i class="fas fa-check"></i> Good for ad-hoc queries</li>
                            <li><i class="fas fa-times"></i> Slower performance</li>
                            <li><i class="fas fa-times"></i> Scans raw data</li>
                        </ul>
                    </div>
                </div>

                <!-- MAPPING DATA TO CIM -->
                <h2><i class="fas fa-map"></i> Mapping Data to CIM</h2>

                <div class="pipeline">
                    <div class="pipeline-stage" data-step="1">
                        <div class="pipeline-stage-title">Install TA</div>
                        <div class="pipeline-stage-desc">Technology Add-on</div>
                        <div class="pipeline-stage-details">
                            <p>TAs provide CIM-compliant field extractions</p>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="2">
                        <div class="pipeline-stage-title">Verify Mapping</div>
                        <div class="pipeline-stage-desc">Check field alignment</div>
                        <div class="pipeline-stage-details">
                            <p>Ensure fields match CIM standards</p>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="3">
                        <div class="pipeline-stage-title">Tag Events</div>
                        <div class="pipeline-stage-desc">Apply event tags</div>
                        <div class="pipeline-stage-details">
                            <p>Tags like "authentication" enable data model matching</p>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="4">
                        <div class="pipeline-stage-title">Validate</div>
                        <div class="pipeline-stage-desc">Test with tstats</div>
                        <div class="pipeline-stage-details">
                            <p>Confirm events appear in data model</p>
                        </div>
                    </div>
                </div>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> Example: Mapping Custom Logs to Authentication</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;"># In props.conf - field extractions and aliases</span>
[my_custom_auth_logs]
FIELDALIAS-user = username AS user
FIELDALIAS-src = source_ip AS src
FIELDALIAS-dest = target_server AS dest
EVAL-action = if(status="success", "success", "failure")
EVAL-app = "custom_auth_system"

<span style="color: #8b949e;"># In tags.conf - tag for data model matching</span>
[eventtype=my_custom_auth_success]
authentication = enabled
default = enabled

[eventtype=my_custom_auth_failure]
authentication = enabled
default = enabled

<span style="color: #8b949e;"># In eventtypes.conf - define the event types</span>
[my_custom_auth_success]
search = sourcetype=my_custom_auth_logs status=success

[my_custom_auth_failure]
search = sourcetype=my_custom_auth_logs status=failure
</pre>
                </div>

                <!-- TROUBLESHOOTING -->
                <h2><i class="fas fa-tools"></i> Data Model Troubleshooting</h2>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-bug"></i> Troubleshooting Queries</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Check if events are mapping to Authentication model</span>
| <span style="color: #f97583;">datamodel</span> Authentication <span style="color: #f97583;">search</span>
| <span style="color: #f97583;">stats</span> <span style="color: #79c0ff;">count</span> <span style="color: #f97583;">by</span> sourcetype, source

<span style="color: #8b949e;">// Verify tags are applied correctly</span>
<span style="color: #79c0ff;">index</span>=* <span style="color: #79c0ff;">sourcetype</span>=my_custom_auth_logs
| <span style="color: #f97583;">tags</span>
| <span style="color: #f97583;">stats</span> <span style="color: #79c0ff;">count</span> <span style="color: #f97583;">by</span> tag

<span style="color: #8b949e;">// Check CIM field mapping</span>
<span style="color: #79c0ff;">index</span>=* <span style="color: #79c0ff;">sourcetype</span>=my_custom_auth_logs
| <span style="color: #f97583;">table</span> _time, user, action, src, dest, app
| <span style="color: #f97583;">head</span> 10

<span style="color: #8b949e;">// View acceleration build status</span>
| <span style="color: #f97583;">rest</span> /services/admin/summarization <span style="color: #f97583;">splunk_server</span>=local
| <span style="color: #f97583;">search</span> title="DM_*"
| <span style="color: #f97583;">table</span> title, complete, access_count, last_accessed

<span style="color: #8b949e;">// Force rebuild acceleration (use carefully)</span>
| <span style="color: #f97583;">rest</span> /services/admin/summarization/tstats:DM_Authentication_Authentication/rebuild_pending
</pre>
                </div>

                <!-- ENTERPRISE EXAMPLE -->
                <div class="enterprise-example">
                    <div class="enterprise-example-header">
                        <i class="fas fa-building"></i>
                        <div class="enterprise-example-title">Enterprise Example: Data Model Strategy</div>
                    </div>
                    <div class="enterprise-example-scenario">
                        <strong>Scenario:</strong> Healthcare organization with 500GB/day ingestion implementing Splunk ES with proper CIM compliance.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 16px;">
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #3fb950; margin-top: 0;">CIM-Compliant Sources</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                <strong>Authentication:</strong> AD, Epic (EHR), Citrix<br>
                                <strong>Network:</strong> Palo Alto, Cisco ASA<br>
                                <strong>Endpoint:</strong> CrowdStrike, Sysmon<br>
                                <strong>Email:</strong> Exchange, Proofpoint<br>
                                <strong>DLP:</strong> Symantec
                            </p>
                        </div>
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #58a6ff; margin-top: 0;">Acceleration Config</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                <strong>Authentication:</strong> 90 days (HIPAA)<br>
                                <strong>Network_Traffic:</strong> 30 days<br>
                                <strong>Endpoint:</strong> 90 days<br>
                                <strong>Malware:</strong> 1 year<br>
                                <strong>Storage Impact:</strong> +8% (40GB/day)
                            </p>
                        </div>
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #d29922; margin-top: 0;">Results</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                <strong>ES Dashboard Load:</strong> 2-5 seconds<br>
                                <strong>Correlation Search:</strong> 80 rules active<br>
                                <strong>CIM Compliance:</strong> 95% of sources<br>
                                <strong>Notable Quality:</strong> Low FP rate
                            </p>
                        </div>
                    </div>
                </div>

                <!-- INTERVIEW QUESTIONS -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: What is the CIM and why is it important for ES?</button>
                        <div class="qa-answer">
                            <p>"CIM (Common Information Model) is Splunk's normalized schema that standardizes field names across different vendors and data sources.</p>
                            <p><strong>Why it's important for ES:</strong></p>
                            <ul>
                                <li><strong>Correlation searches work:</strong> ES's OOTB rules rely on CIM fields like <code>user</code>, <code>src</code>, <code>dest</code></li>
                                <li><strong>Dashboards populate:</strong> ES dashboards query data models, not raw data</li>
                                <li><strong>Vendor agnostic:</strong> One rule detects brute force from Windows, Okta, and Azure AD</li>
                            </ul>
                            <p>Without proper CIM mapping, ES doesn't see the data and detections fail silently."</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: What's the difference between tstats and the datamodel command?</button>
                        <div class="qa-answer">
                            <p><strong>tstats (accelerated):</strong></p>
                            <ul>
                                <li>Queries pre-computed TSIDX summaries</li>
                                <li>10-100x faster than raw search</li>
                                <li>Requires acceleration enabled</li>
                                <li>Limited to accelerated time range</li>
                                <li>Best for: Dashboards, scheduled searches</li>
                            </ul>
                            <p><strong>datamodel command:</strong></p>
                            <ul>
                                <li>Searches raw events using data model constraints</li>
                                <li>Works without acceleration</li>
                                <li>Slower but more flexible</li>
                                <li>Best for: Ad-hoc investigation, testing mappings</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How do you troubleshoot data not appearing in a data model?</button>
                        <div class="qa-answer">
                            <p><strong>Troubleshooting steps:</strong></p>
                            <ol>
                                <li><strong>Check field extraction:</strong> Are CIM fields (user, src, dest) being extracted?</li>
                                <li><strong>Verify tags:</strong> Run <code>| tags</code> - are "authentication" tags present?</li>
                                <li><strong>Check TA installation:</strong> Is the Technology Add-on installed on search heads?</li>
                                <li><strong>Test with datamodel command:</strong> <code>| datamodel Authentication search</code></li>
                                <li><strong>Check acceleration:</strong> Is it enabled? Is it building successfully?</li>
                                <li><strong>Time range:</strong> Is the data within the acceleration summary range?</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: Which data models should be accelerated for ES?</button>
                        <div class="qa-answer">
                            <p><strong>Must accelerate (ES depends on these):</strong></p>
                            <ul>
                                <li>Authentication - Login detection</li>
                                <li>Network_Traffic - Network detection</li>
                                <li>Endpoint - Endpoint detection</li>
                                <li>Malware - AV/EDR detection</li>
                                <li>Web - Proxy/web detection</li>
                            </ul>
                            <p><strong>Acceleration recommendations:</strong></p>
                            <ul>
                                <li>30-90 days for most models</li>
                                <li>Match to your compliance retention</li>
                                <li>Budget ~5-10% additional storage</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
