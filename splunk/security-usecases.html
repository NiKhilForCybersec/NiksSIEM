<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Use Cases | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">

    <style>
        /* Decision Tree Styles */
        .decision-tree {
            padding: 20px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            margin: 20px 0;
        }
        .decision-node {
            background: #21262d;
            border: 2px solid #30363d;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 10px auto;
            max-width: 400px;
            text-align: center;
        }
        .decision-node h4 {
            color: #e6edf3;
            margin: 0 0 5px 0;
            font-size: 14px;
        }
        .decision-node small {
            color: #8b949e;
            font-size: 12px;
        }
        .decision-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 20px;
            margin: 5px 0;
        }
        .decision-branches {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        .decision-branch {
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 15px;
            min-width: 200px;
            max-width: 300px;
        }
        .decision-branch.yes { border-color: #238636; }
        .decision-branch.no { border-color: #f85149; }
        .branch-label {
            display: block;
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            color: #8b949e;
            font-size: 12px;
        }
        .decision-outcome {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            color: white;
        }
        .decision-outcome i {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }
        .decision-outcome strong {
            display: block;
            margin-bottom: 5px;
        }
        .decision-outcome small {
            opacity: 0.9;
            font-size: 11px;
        }

        /* Flow Diagram Styles */
        .flow-diagram {
            padding: 20px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            margin: 20px 0;
        }
        .flow-step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            background: #21262d;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #58a6ff;
        }
        .flow-icon {
            width: 40px;
            height: 40px;
            background: rgba(88, 166, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #58a6ff;
            flex-shrink: 0;
        }
        .flow-content h4 {
            margin: 0 0 10px 0;
            color: #e6edf3;
            font-size: 14px;
        }
        .flow-content ul {
            margin: 0;
            padding-left: 20px;
            color: #8b949e;
        }
        .flow-content li {
            margin: 5px 0;
            font-size: 13px;
        }
        .flow-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 20px;
            margin: 5px 0;
        }

        /* Enhanced Gap Cards */
        .enterprise-gap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .gap-card {
            background: #21262d;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #30363d;
        }
        .gap-card h4 {
            margin: 0 0 15px 0;
            font-size: 16px;
        }
        .gap-card ul {
            margin: 0;
            padding-left: 20px;
        }
        .gap-card li {
            margin: 8px 0;
            color: #8b949e;
            font-size: 13px;
        }
        .gap-card li strong {
            color: #e6edf3;
        }
        .gap-critical { border-left: 4px solid #f85149; }
        .gap-warning { border-left: 4px solid #d29922; }
        .gap-info { border-left: 4px solid #58a6ff; }
        .gap-best-practice { border-left: 4px solid #238636; }

        /* Quick Reference Cards */
        .quick-ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .quick-ref-card {
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .quick-ref-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        .quick-ref-card h4 {
            color: #58a6ff;
            margin: 0 0 10px 0;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .quick-ref-card p {
            color: #8b949e;
            margin: 0;
            font-size: 13px;
            line-height: 1.5;
        }
    </style>

</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="apps-tas.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Apps & TAs</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-paper-plane"></i><span>Forwarders</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Props/Transforms</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Index & Retention</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>SPL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>SPL Intermediate</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>SPL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i><span>Data Models & CIM</span></a></li>
                    <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>Knowledge Objects</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>Enterprise Security</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Searches</span></a></li>
                    <li class="sidebar-nav-item"><a href="notable-events.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Notable Events</span></a></li>
                    <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-exclamation-triangle"></i><span>Risk-Based Alerting</span></a></li>
                    <li class="sidebar-nav-item"><a href="alerting-actions.html" class="sidebar-nav-link"><i class="fas fa-bolt"></i><span>Alerting & Actions</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Security Use Cases -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Security Use Cases</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="security-usecases.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Detection Use Cases</span></a></li>
                    <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise Scenarios</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="soar.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>SOAR</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intelligence</span></a></li>
                </ul>
            </div>
            
            <!-- Operations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="performance-tuning.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>Performance Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="monitoring-console.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Monitoring Console</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="administration.html" class="sidebar-nav-link"><i class="fas fa-cog"></i><span>Administration</span></a></li>
                    <li class="sidebar-nav-item"><a href="security-rbac.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>Security & RBAC</span></a></li>
                    <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Clustering & HA</span></a></li>
                </ul>
            </div>
            
            <!-- Deployment -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Deployment</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Splunk Cloud</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Security Usecases</span>
                </div>

                <h1><i class="fas fa-lightbulb"></i> Security Use Cases</h1>
                <p class="lead">Comprehensive library of Splunk security use cases mapped to MITRE ATT&CK. Learn detection logic, implementation steps, and tuning strategies for enterprise security monitoring.</p>

                <!-- Use Case Framework -->
                <h2><i class="fas fa-sitemap"></i> Use Case Development Framework</h2>
                <div class="config-section">
                    <h4>Use Case Lifecycle</h4>
                    <div class="arch-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USE CASE DEVELOPMENT LIFECYCLE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  PHASE 1           PHASE 2           PHASE 3           PHASE 4             â”‚
â”‚  REQUIREMENTS      DEVELOPMENT       DEPLOYMENT        OPERATIONS          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Identify â”‚     â”‚ Design   â”‚     â”‚ Test in  â”‚     â”‚ Monitor  â”‚          â”‚
â”‚  â”‚ Threat   â”‚â”€â”€â”€â”€â–¶â”‚ Detectionâ”‚â”€â”€â”€â”€â–¶â”‚ Lab/Dev  â”‚â”€â”€â”€â”€â–¶â”‚ FP Rate  â”‚          â”‚
â”‚  â”‚ Scenario â”‚     â”‚ Logic    â”‚     â”‚          â”‚     â”‚          â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚       â”‚                â”‚                â”‚                â”‚                 â”‚
â”‚       â–¼                â–¼                â–¼                â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Map to   â”‚     â”‚ Write    â”‚     â”‚ Tune     â”‚     â”‚ Review   â”‚          â”‚
â”‚  â”‚ MITRE    â”‚â”€â”€â”€â”€â–¶â”‚ SPL      â”‚â”€â”€â”€â”€â–¶â”‚ Thresholdâ”‚â”€â”€â”€â”€â–¶â”‚ Quarterlyâ”‚          â”‚
â”‚  â”‚ ATT&CK   â”‚     â”‚ Query    â”‚     â”‚          â”‚     â”‚          â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚       â”‚                â”‚                â”‚                â”‚                 â”‚
â”‚       â–¼                â–¼                â–¼                â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Identify â”‚     â”‚ Create   â”‚     â”‚ Deploy   â”‚     â”‚ Retire   â”‚          â”‚
â”‚  â”‚ Data     â”‚â”€â”€â”€â”€â–¶â”‚ Notable  â”‚â”€â”€â”€â”€â–¶â”‚ to       â”‚â”€â”€â”€â”€â–¶â”‚ Outdated â”‚          â”‚
â”‚  â”‚ Sources  â”‚     â”‚ Event    â”‚     â”‚ Prod     â”‚     â”‚          â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

                    <h4>Use Case Documentation Template</h4>
                    <div class="arch-diagram">USE CASE DOCUMENTATION:

METADATA:
â”œâ”€â”€ Use Case ID: UC-AUTH-001
â”œâ”€â”€ Name: Brute Force Authentication Attack
â”œâ”€â”€ Description: Detects multiple failed logins followed by success
â”œâ”€â”€ MITRE ATT&CK: T1110 (Brute Force)
â”œâ”€â”€ Data Sources: Authentication logs, Windows Security Events
â”œâ”€â”€ Severity: High
â””â”€â”€ Status: Production

DETECTION LOGIC:
â”œâ”€â”€ Threshold: >10 failed logins in 5 minutes
â”œâ”€â”€ Followed by: Successful login within 10 minutes
â”œâ”€â”€ Scope: Per user, per source IP
â””â”€â”€ Exclusions: Service accounts, known scanners

RESPONSE PLAYBOOK:
â”œâ”€â”€ Tier 1: Verify user, check source IP reputation
â”œâ”€â”€ Tier 2: Contact user, review account activity
â”œâ”€â”€ Escalation: Disable account if confirmed compromise
â””â”€â”€ Documentation: Incident ticket required

TUNING HISTORY:
â”œâ”€â”€ v1.0: Initial deployment, threshold 5 failures
â”œâ”€â”€ v1.1: Increased to 10, too many FPs from password resets
â””â”€â”€ v1.2: Added exclusion for helpdesk IP range</div>
                </div>

                <!-- Authentication Use Cases -->
                <h2><i class="fas fa-key"></i> Authentication Use Cases</h2>
                <div class="config-section">
                    <h4>UC-AUTH-001: Brute Force Detection</h4>
                    <div class="arch-diagram">USE CASE: Brute Force Authentication Attack
MITRE: T1110 - Brute Force
DATA MODEL: Authentication

DETECTION LOGIC:
| tstats summariesonly=true count from datamodel=Authentication 
    where Authentication.action=failure 
    by Authentication.user, Authentication.src, _time span=5m
| where count > 10
| join type=inner Authentication.user 
    [| tstats summariesonly=true count from datamodel=Authentication 
       where Authentication.action=success 
       by Authentication.user, Authentication.src, _time span=15m]
| table _time, Authentication.user, Authentication.src, count

CORRELATION SEARCH CONFIG:
â”œâ”€â”€ Schedule: Every 5 minutes
â”œâ”€â”€ Time Range: -15 minutes
â”œâ”€â”€ Throttling: Per user, per src, 1 hour
â””â”€â”€ Notable Event: Yes, Severity High

TUNING CONSIDERATIONS:
â”œâ”€â”€ Exclude service accounts
â”œâ”€â”€ Exclude known vulnerability scanners
â”œâ”€â”€ Adjust threshold based on environment
â””â”€â”€ Consider geographic anomalies</div>

                    <h4>UC-AUTH-002: Impossible Travel</h4>
                    <div class="arch-diagram">USE CASE: Impossible Travel Detection
MITRE: T1078 - Valid Accounts
DATA MODEL: Authentication

DETECTION LOGIC:
| tstats summariesonly=true latest(_time) as latest_time 
    earliest(_time) as earliest_time 
    values(Authentication.src) as sources 
    dc(Authentication.src) as source_count 
    from datamodel=Authentication 
    where Authentication.action=success 
    by Authentication.user
| where source_count > 1
| eval time_diff_hours = (latest_time - earliest_time) / 3600
| where time_diff_hours < 2
| iplocation sources
| eval distance = ... (calculate geographic distance)
| where distance > 500 AND time_diff_hours < (distance / 500)
| table user, sources, time_diff_hours, distance

IMPLEMENTATION NOTES:
â”œâ”€â”€ Requires GeoIP lookup
â”œâ”€â”€ VPN connections may cause false positives
â”œâ”€â”€ Consider excluding mobile users
â””â”€â”€ Integrate with identity provider data</div>

                    <h4>UC-AUTH-003: Password Spray</h4>
                    <div class="arch-diagram">USE CASE: Password Spray Attack
MITRE: T1110.003 - Password Spraying
DATA MODEL: Authentication

DETECTION LOGIC:
| tstats summariesonly=true dc(Authentication.user) as user_count 
    count as attempt_count 
    from datamodel=Authentication 
    where Authentication.action=failure 
    by Authentication.src, _time span=10m
| where user_count > 10 AND attempt_count > 20
| eval spray_ratio = user_count / attempt_count
| where spray_ratio > 0.5
| table _time, Authentication.src, user_count, attempt_count, spray_ratio

KEY INDICATORS:
â”œâ”€â”€ Many unique users targeted
â”œâ”€â”€ Single or few source IPs
â”œâ”€â”€ Short time window
â”œâ”€â”€ Similar failure reasons (wrong password)
â””â”€â”€ Often targets common usernames</div>
                </div>

                <!-- Endpoint Use Cases -->
                <h2><i class="fas fa-desktop"></i> Endpoint Use Cases</h2>
                <div class="config-section">
                    <h4>UC-END-001: Suspicious PowerShell</h4>
                    <div class="arch-diagram">USE CASE: Suspicious PowerShell Execution
MITRE: T1059.001 - PowerShell
DATA MODEL: Endpoint

DETECTION LOGIC:
| tstats summariesonly=true count from datamodel=Endpoint.Processes 
    where Processes.process_name="powershell.exe" OR Processes.process_name="pwsh.exe"
    by Processes.dest, Processes.user, Processes.process, Processes.parent_process
| search Processes.process IN ("*-enc*", "*-encodedcommand*", "*downloadstring*", 
    "*invoke-expression*", "*iex*", "*bypass*", "*hidden*", "*noprofile*")
| table _time, Processes.dest, Processes.user, Processes.process, Processes.parent_process

SEVERITY MATRIX:
â”œâ”€â”€ Encoded + Download: Critical
â”œâ”€â”€ Encoded only: High
â”œâ”€â”€ Download only: Medium
â”œâ”€â”€ Bypass/Hidden: Medium
â””â”€â”€ Base64 in command: High

EXCLUSIONS:
â”œâ”€â”€ Known IT management tools
â”œâ”€â”€ Software deployment systems
â”œâ”€â”€ Signed Microsoft scripts
â””â”€â”€ Documented automation</div>

                    <h4>UC-END-002: Living Off the Land</h4>
                    <div class="arch-diagram">USE CASE: LOLBin Abuse Detection
MITRE: T1218 - System Binary Proxy Execution
DATA MODEL: Endpoint

DETECTION LOGIC:
| tstats summariesonly=true count from datamodel=Endpoint.Processes 
    where Processes.process_name IN ("certutil.exe", "mshta.exe", "regsvr32.exe", 
        "rundll32.exe", "wmic.exe", "cscript.exe", "wscript.exe", "bitsadmin.exe",
        "msiexec.exe", "installutil.exe", "regasm.exe", "regsvcs.exe")
    by Processes.dest, Processes.user, Processes.process_name, 
       Processes.process, Processes.parent_process
| search Processes.process IN ("*http*", "*ftp*", "*/c*", "*-e*", "*-decode*", 
    "*script:*", "*dll:*", "*//e:*")
| table _time, Processes.dest, Processes.user, Processes.process_name, Processes.process

LOLBIN-SPECIFIC PATTERNS:
â”œâ”€â”€ certutil: -decode, -urlcache, -split
â”œâ”€â”€ mshta: http://, javascript:, vbscript:
â”œâ”€â”€ regsvr32: /s /n /u /i:http
â”œâ”€â”€ rundll32: javascript:, http://
â”œâ”€â”€ wmic: /node:, process call create
â””â”€â”€ bitsadmin: /transfer, /addfile</div>

                    <h4>UC-END-003: Persistence Mechanisms</h4>
                    <div class="arch-diagram">USE CASE: Registry Persistence Detection
MITRE: T1547.001 - Registry Run Keys
DATA MODEL: Endpoint

DETECTION LOGIC:
| tstats summariesonly=true count from datamodel=Endpoint.Registry 
    where Registry.registry_path IN ("*\\CurrentVersion\\Run*", 
        "*\\CurrentVersion\\RunOnce*", "*\\CurrentVersion\\RunServices*",
        "*\\Winlogon\\Shell*", "*\\Winlogon\\Userinit*")
    AND Registry.action IN ("created", "modified")
    by Registry.dest, Registry.user, Registry.registry_path, 
       Registry.registry_value_name, Registry.registry_value_data
| table _time, Registry.dest, Registry.user, Registry.registry_path, 
        Registry.registry_value_name, Registry.registry_value_data

OTHER PERSISTENCE LOCATIONS:
â”œâ”€â”€ Scheduled Tasks: EventCode=4698
â”œâ”€â”€ Services: EventCode=7045
â”œâ”€â”€ Startup Folder: file creation monitoring
â”œâ”€â”€ WMI Subscriptions: WMI event logs
â””â”€â”€ DLL Search Order: process monitoring</div>
                </div>

                <!-- Network Use Cases -->
                <h2><i class="fas fa-network-wired"></i> Network Use Cases</h2>
                <div class="config-section">
                    <h4>UC-NET-001: Beaconing Detection</h4>
                    <div class="arch-diagram">USE CASE: C2 Beaconing Detection
MITRE: T1071 - Application Layer Protocol
DATA MODEL: Network_Traffic

DETECTION LOGIC:
index=firewall OR index=proxy
| bin _time span=1h
| stats count as connections 
    dc(dest_port) as unique_ports 
    avg(bytes_out) as avg_bytes 
    stdev(bytes_out) as stdev_bytes
    by src_ip, dest_ip, _time
| where connections > 20 
    AND unique_ports < 3 
    AND stdev_bytes < (avg_bytes * 0.2)
| table src_ip, dest_ip, connections, avg_bytes, stdev_bytes

BEACONING INDICATORS:
â”œâ”€â”€ Regular time intervals (Â±10% variance)
â”œâ”€â”€ Consistent packet sizes
â”œâ”€â”€ Low port diversity
â”œâ”€â”€ Persistent over hours/days
â””â”€â”€ Unusual destination (rare domain/IP)

ADVANCED DETECTION:
| stats count by src_ip, dest_ip, _time span=1m
| streamstats window=60 avg(count) as avg_rate stdev(count) as std_rate by src_ip, dest_ip
| where std_rate < 1  // Very consistent rate</div>

                    <h4>UC-NET-002: Data Exfiltration</h4>
                    <div class="arch-diagram">USE CASE: Large Data Transfer Detection
MITRE: T1048 - Exfiltration Over Alternative Protocol
DATA MODEL: Network_Traffic

DETECTION LOGIC:
| tstats summariesonly=true sum(All_Traffic.bytes_out) as total_bytes 
    from datamodel=Network_Traffic 
    by All_Traffic.src, All_Traffic.dest, _time span=1h
| where total_bytes > 100000000  // 100 MB
| lookup threat_intel dest as All_Traffic.dest OUTPUT threat_score
| where threat_score > 50 OR isnotnull(threat_score)
| table _time, All_Traffic.src, All_Traffic.dest, total_bytes, threat_score

EXFILTRATION INDICATORS:
â”œâ”€â”€ Unusual upload volume
â”œâ”€â”€ Transfer to cloud storage
â”œâ”€â”€ DNS tunneling (high query volume)
â”œâ”€â”€ After-hours transfers
â””â”€â”€ Compressed/encrypted streams</div>

                    <h4>UC-NET-003: Lateral Movement</h4>
                    <div class="arch-diagram">USE CASE: Internal Lateral Movement
MITRE: T1021 - Remote Services
DATA MODEL: Network_Traffic

DETECTION LOGIC:
| tstats summariesonly=true count dc(All_Traffic.dest) as dest_count 
    from datamodel=Network_Traffic 
    where All_Traffic.dest_port IN (445, 135, 3389, 5985, 5986, 22)
    AND All_Traffic.src_category="workstation"
    by All_Traffic.src, _time span=1h
| where dest_count > 5
| table _time, All_Traffic.src, dest_count

LATERAL MOVEMENT PATTERNS:
â”œâ”€â”€ SMB (445): File shares, PsExec
â”œâ”€â”€ RPC (135): WMI, DCOM
â”œâ”€â”€ RDP (3389): Remote desktop
â”œâ”€â”€ WinRM (5985/5986): PowerShell remoting
â”œâ”€â”€ SSH (22): Linux/Unix access
â””â”€â”€ Workstation-to-workstation unusual</div>
                </div>

                <!-- Use Case Priority Matrix -->
                <h2><i class="fas fa-th"></i> Use Case Priority Matrix</h2>
                <div class="config-section">
                    <div class="arch-diagram">USE CASE PRIORITY MATRIX:

TIER 1 - CRITICAL (Deploy First):
â”œâ”€â”€ UC-AUTH-001: Brute Force Detection
â”œâ”€â”€ UC-AUTH-003: Password Spray
â”œâ”€â”€ UC-END-001: Suspicious PowerShell
â”œâ”€â”€ UC-END-002: LOLBin Abuse
â”œâ”€â”€ UC-NET-001: C2 Beaconing
â””â”€â”€ UC-MAL-001: Known Malware Hashes

TIER 2 - HIGH (Deploy Second):
â”œâ”€â”€ UC-AUTH-002: Impossible Travel
â”œâ”€â”€ UC-END-003: Persistence Mechanisms
â”œâ”€â”€ UC-NET-002: Data Exfiltration
â”œâ”€â”€ UC-NET-003: Lateral Movement
â”œâ”€â”€ UC-PRIV-001: Privilege Escalation
â””â”€â”€ UC-CRED-001: Credential Dumping

TIER 3 - MEDIUM (Enhance Coverage):
â”œâ”€â”€ UC-RECON-001: Network Scanning
â”œâ”€â”€ UC-EVADE-001: Log Tampering
â”œâ”€â”€ UC-EVADE-002: Security Tool Disable
â”œâ”€â”€ UC-CLOUD-001: Cloud Config Changes
â””â”€â”€ UC-IAM-001: Permission Changes

IMPLEMENTATION TIMELINE:
â”œâ”€â”€ Month 1: Tier 1 use cases
â”œâ”€â”€ Month 2-3: Tier 2 use cases
â”œâ”€â”€ Month 4-6: Tier 3 use cases
â””â”€â”€ Ongoing: Tuning and optimization</div>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Use Case Decision Trees</h2>
                <div class="config-section">
                    <h3>Decision Tree: Use Case Prioritization</h3>
                    <div class="arch-diagram">WHICH USE CASES TO IMPLEMENT FIRST?
â”‚
â”œâ”€ Data availability assessment:
â”‚   â”‚
â”‚   â”œâ”€ What data do you have TODAY?
â”‚   â”‚   â”œâ”€ Windows Event Logs? â†’ Authentication, Endpoint use cases
â”‚   â”‚   â”œâ”€ Network Firewall/Proxy? â†’ Network use cases
â”‚   â”‚   â”œâ”€ Cloud logs (O365, AWS)? â†’ Cloud use cases
â”‚   â”‚   â””â”€ EDR telemetry? â†’ Advanced endpoint use cases
â”‚   â”‚
â”‚   â””â”€ Prioritize: Use cases matching available data
â”‚
â”œâ”€ Threat landscape assessment:
â”‚   â”‚
â”‚   â”œâ”€ What threats are most likely?
â”‚   â”‚   â”œâ”€ Financially motivated? â†’ Ransomware, BEC
â”‚   â”‚   â”œâ”€ Nation state? â†’ APT persistence, espionage
â”‚   â”‚   â”œâ”€ Insider threat? â†’ Data exfil, privilege abuse
â”‚   â”‚   â””â”€ Industry-specific? â†’ Compliance-driven
â”‚   â”‚
â”‚   â””â”€ Prioritize: Use cases matching threat profile
â”‚
â”œâ”€ Implementation effort:
â”‚   â”‚
â”‚   â”œâ”€ TIER 1 (Quick wins - 1-2 hours each):
â”‚   â”‚   â”œâ”€ Brute force authentication
â”‚   â”‚   â”œâ”€ Impossible travel
â”‚   â”‚   â”œâ”€ Known bad IP/domain
â”‚   â”‚   â””â”€ Admin account usage
â”‚   â”‚
â”‚   â”œâ”€ TIER 2 (Medium effort - 4-8 hours each):
â”‚   â”‚   â”œâ”€ Password spray
â”‚   â”‚   â”œâ”€ Lateral movement
â”‚   â”‚   â”œâ”€ Suspicious PowerShell
â”‚   â”‚   â””â”€ Data exfiltration
â”‚   â”‚
â”‚   â””â”€ TIER 3 (Complex - days to weeks):
â”‚       â”œâ”€ Beaconing detection
â”‚       â”œâ”€ UEBA baselines
â”‚       â”œâ”€ Custom ML models
â”‚       â””â”€ APT TTP chains
â”‚
â””â”€ RECOMMENDED ORDER:
    â”œâ”€ Week 1-2: All Tier 1 use cases
    â”œâ”€ Month 1-2: Tier 2 aligned with top threats
    â””â”€ Month 3+: Tier 3 based on maturity</div>

                    <h3>Decision Tree: Detection Logic Selection</h3>
                    <div class="arch-diagram">WHAT DETECTION APPROACH FOR THIS USE CASE?
â”‚
â”œâ”€ Do you have known-bad indicators?
â”‚   â”‚
â”‚   â”œâ”€ YES (IOCs, signatures)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ SIGNATURE-BASED DETECTION
â”‚   â”‚       â”œâ”€ Threat intel lookup joins
â”‚   â”‚       â”œâ”€ Hash/IP/domain matching
â”‚   â”‚       â””â”€ Fast, low false positives
â”‚   â”‚
â”‚   â””â”€ NO (behavioral detection needed)
â”‚       â”‚
â”‚       â””â”€ Continue to behavioral options...
â”‚
â”œâ”€ Can you define a simple threshold?
â”‚   â”‚
â”‚   â”œâ”€ YES (e.g., >10 failures)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ THRESHOLD-BASED DETECTION
â”‚   â”‚       â”œâ”€ Count-based alerting
â”‚   â”‚       â”œâ”€ Easy to implement and tune
â”‚   â”‚       â””â”€ Risk: Static thresholds miss slow attacks
â”‚   â”‚
â”‚   â””â”€ NO (need relative comparison)
â”‚       â”‚
â”‚       â””â”€ Continue to statistical options...
â”‚
â”œâ”€ Is behavior consistent over time?
â”‚   â”‚
â”‚   â”œâ”€ YES (stable baseline exists)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ BASELINE-ANOMALY DETECTION
â”‚   â”‚       â”œâ”€ Compare to historical average
â”‚   â”‚       â”œâ”€ Z-score or percentile deviation
â”‚   â”‚       â””â”€ Good for login times, data volumes
â”‚   â”‚
â”‚   â””â”€ NO (highly variable)
â”‚       â”‚
â”‚       â””â”€ PEER-GROUP COMPARISON
â”‚           â”œâ”€ Compare user to similar users
â”‚           â”œâ”€ Requires good user grouping
â”‚           â””â”€ Expensive to compute
â”‚
â””â”€ Last resort: RULE CHAINING
    â”œâ”€ Multiple conditions in sequence
    â”œâ”€ "A followed by B within timeframe"
    â””â”€ Most complex but catches sophisticated attacks</div>

                    <h3>Decision Tree: Use Case Tuning</h3>
                    <div class="arch-diagram">USE CASE GENERATING TOO MANY ALERTS?
â”‚
â”œâ”€ What type of false positives?
â”‚   â”‚
â”‚   â”œâ”€ Known-good activity?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ ADD EXCLUSIONS
â”‚   â”‚       â”œâ”€ Service accounts to whitelist
â”‚   â”‚       â”œâ”€ Scanner IPs to ignore
â”‚   â”‚       â”œâ”€ Scheduled task times
â”‚   â”‚       â””â”€ Document all exclusions!
â”‚   â”‚
â”‚   â”œâ”€ Threshold too sensitive?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ ADJUST THRESHOLDS
â”‚   â”‚       â”œâ”€ Analyze alert distribution
â”‚   â”‚       â”œâ”€ Set threshold at 95th percentile
â”‚   â”‚       â””â”€ Consider time-based adjustment
â”‚   â”‚
â”‚   â””â”€ Wrong detection logic?
â”‚       â”‚
â”‚       â””â”€ REDESIGN USE CASE
â”‚           â”œâ”€ Add more conditions
â”‚           â”œâ”€ Require corroborating evidence
â”‚           â””â”€ Consider risk-based scoring
â”‚
â”œâ”€ FP rate target:
â”‚   â”‚
â”‚   â”œâ”€ Critical alerts: &lt;1% FP rate
â”‚   â”œâ”€ High alerts: &lt;5% FP rate
â”‚   â””â”€ Medium alerts: &lt;20% FP rate
â”‚
â””â”€ Tuning process:
    â”œâ”€ Week 1: Deploy in audit mode
    â”œâ”€ Week 2: Analyze all alerts, document patterns
    â”œâ”€ Week 3: Implement exclusions
    â”œâ”€ Week 4: Enable alerting
    â””â”€ Monthly: Review and refine</div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                <div class="enterprise-gaps">
                    <div class="gap-grid">
                        <div class="gap-category critical">
                            <h4>ğŸ”´ Critical Gaps</h4>
                            <ul>
                                <li><strong>No use case documentation:</strong> SPL exists but no description of what it detects or why</li>
                                <li><strong>Outdated exclusions:</strong> Whitelists from 3 years ago with departed employees</li>
                                <li><strong>Copy-paste detections:</strong> Downloaded from Splunkbase but never tested in environment</li>
                                <li><strong>No MITRE mapping:</strong> Can't answer "what techniques can we detect?"</li>
                                <li><strong>Alert fatigue:</strong> 500+ alerts/day, analysts ignoring critical ones</li>
                            </ul>
                        </div>
                        <div class="gap-category warning">
                            <h4><i class="fas fa-exclamation-triangle"></i> Operational Gaps</h4>
                            <ul>
                                <li><strong>No playbooks:</strong> Alert fires but analyst doesn't know investigation steps</li>
                                <li><strong>Missing enrichment:</strong> IP alerts with no WHOIS, user alerts with no HR context</li>
                                <li><strong>Static thresholds:</strong> Same threshold for 100-user branch and 10,000-user HQ</li>
                                <li><strong>No lifecycle management:</strong> Rules created but never reviewed or retired</li>
                                <li><strong>Siloed development:</strong> Multiple analysts creating duplicate use cases</li>
                            </ul>
                        </div>
                        <div class="gap-category info">
                            <h4><i class="fas fa-info-circle"></i> Coverage Gaps</h4>
                            <ul>
                                <li><strong>Only authentication:</strong> 50 login rules, zero network or endpoint detection</li>
                                <li><strong>Missing cloud:</strong> On-prem covered but O365/AWS blind spots</li>
                                <li><strong>No lateral movement:</strong> Detect initial access but miss post-compromise</li>
                                <li><strong>Signature-only:</strong> Known-bad IOCs but no behavioral detection</li>
                                <li><strong>No insider threat:</strong> External threats covered, internal actors ignored</li>
                            </ul>
                        </div>
                        <div class="gap-category best-practice">
                            <h4><i class="fas fa-check-circle"></i> Best Practices Often Ignored</h4>
                            <ul>
                                <li><strong>Test with red team:</strong> Validate use cases catch actual attacks</li>
                                <li><strong>Measure detection rate:</strong> What % of incidents were alerted on?</li>
                                <li><strong>Quarterly review:</strong> Retire low-value, tune noisy, add new coverage</li>
                                <li><strong>Risk-based alerting:</strong> Context determines urgency, not just rule</li>
                                <li><strong>Use case library:</strong> Central catalog of all detections with metadata</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you develop a security use case in Splunk?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Requirements:</strong> Identify threat, map to MITRE, identify data sources</li>
                                <li><strong>Development:</strong> Design detection logic, write SPL query, create notable event</li>
                                <li><strong>Deployment:</strong> Test in dev, tune thresholds, deploy to production</li>
                                <li><strong>Operations:</strong> Monitor FP rate, review quarterly, retire when outdated</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you detect brute force attacks?</button>
                        <div class="qa-answer">
                            <p>Look for multiple failed authentications followed by success:</p>
                            <ul>
                                <li>>10 failed logins in 5 minutes from same source</li>
                                <li>Followed by successful login</li>
                                <li>Use Authentication data model with tstats</li>
                                <li>Exclude service accounts and known scanners</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between brute force and password spray?</button>
                        <div class="qa-answer">
                            <p><strong>Brute Force:</strong> Many passwords against one user</p>
                            <p><strong>Password Spray:</strong> One password against many users</p>
                            <p>Password spray is harder to detect per-user but visible when looking at source IP targeting many users.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you detect C2 beaconing?</button>
                        <div class="qa-answer">
                            <ul>
                                <li>Look for regular time intervals between connections</li>
                                <li>Consistent packet sizes (low standard deviation)</li>
                                <li>Low port diversity</li>
                                <li>Persistent connections over hours/days</li>
                                <li>Unusual or rare destination IPs/domains</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>