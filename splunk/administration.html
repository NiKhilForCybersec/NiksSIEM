<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Splunk Administration | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">


</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo"><i class="fas fa-terminal"></i><span>Splunk Reference</span></a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certifications</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-user-graduate" style="color:#7ce38b"></i>Power User<span class="sidebar-badge" style="color:#7ce38b">SPLK-1002</span></a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog" style="color:#f0883e"></i>Admin<span class="sidebar-badge" style="color:#f0883e">SPLK-1003</span></a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt" style="color:#8957e5"></i>ES Admin<span class="sidebar-badge" style="color:#8957e5">SPLK-3001</span></a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud" style="color:#39c5cf"></i>Cloud Admin<span class="sidebar-badge" style="color:#39c5cf">SPLK-1004</span></a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL & Searching</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-code"></i>SPL Fundamentals</a></li>
                        <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-layer-group"></i>SPL Intermediate</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i>SPL Advanced</a></li>
                        <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-lightbulb"></i>Knowledge Objects</a></li>
                        <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i>Data Models</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Practice</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-practice-questions.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i>SPL MCQs (60Q)</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced-mcqs.html" class="sidebar-nav-link"><i class="fas fa-brain"></i>Advanced MCQs (30Q)</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Administration</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i>Architecture</a></li>
                        <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i>Data Ingestion</a></li>
                        <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-share-alt"></i>Forwarders</a></li>
                        <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i>Parsing & Flows</a></li>
                        <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i>Clustering & HA</a></li>
                        <li class="sidebar-nav-item"><a href="security-rbac.html" class="sidebar-nav-link"><i class="fas fa-user-lock"></i>Security & RBAC</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Enterprise Security</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i>ES Overview</a></li>
                        <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search-plus"></i>Correlation Searches</a></li>
                        <li class="sidebar-nav-item"><a href="notable-events.html" class="sidebar-nav-link"><i class="fas fa-exclamation-triangle"></i>Notable Events</a></li>
                        <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i>Risk-Based Alerting</a></li>
                        <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i>Threat Intelligence</a></li>
                        <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-binoculars"></i>Threat Hunting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Cloud & Automation</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i>Splunk Cloud</a></li>
                        <li class="sidebar-nav-item"><a href="soar.html" class="sidebar-nav-link"><i class="fas fa-robot"></i>SOAR</a></li>
                        <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-pie"></i>Dashboards</a></li>
                        <li class="sidebar-nav-item"><a href="alerting-actions.html" class="sidebar-nav-link"><i class="fas fa-bell"></i>Alerting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Resources</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="lab-exercises.html" class="sidebar-nav-link"><i class="fas fa-flask"></i>Lab Exercises</a></li>
                        <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i>Enterprise Scenarios</a></li>
                        <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i>Troubleshooting</a></li>
                    </ul>
                </div>
            </div>
        </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Administration</span>
                </div>

                <h1><i class="fas fa-cogs"></i> Splunk Administration</h1>
                <p class="lead">Essential Splunk administration tasks for SOC analysts including user management, index administration, data inputs, and troubleshooting common issues.</p>

                <!-- Architecture Overview -->
                <h2><i class="fas fa-sitemap"></i> Splunk Architecture</h2>
                <div class="config-section">
                    <div class="arch-diagram">Splunk Components:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SEARCH HEAD                          â”‚
â”‚  - User interface                                       â”‚
â”‚  - Search processing                                    â”‚
â”‚  - Knowledge objects (saved searches, dashboards)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INDEXER(S)                           â”‚
â”‚  - Data storage                                         â”‚
â”‚  - Index maintenance                                    â”‚
â”‚  - Search execution                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–²
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FORWARDERS (Universal/Heavy)               â”‚
â”‚  - Data collection                                      â”‚
â”‚  - Data forwarding                                      â”‚
â”‚  - (Heavy only) Parsing, filtering                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

                    <h4>Component Roles</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Component</th><th>Function</th><th>Key Config</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Universal Forwarder</strong></td>
                                <td>Lightweight data collection</td>
                                <td>inputs.conf, outputs.conf</td>
                            </tr>
                            <tr>
                                <td><strong>Heavy Forwarder</strong></td>
                                <td>Parsing, filtering, routing</td>
                                <td>props.conf, transforms.conf</td>
                            </tr>
                            <tr>
                                <td><strong>Indexer</strong></td>
                                <td>Storage and search</td>
                                <td>indexes.conf, server.conf</td>
                            </tr>
                            <tr>
                                <td><strong>Search Head</strong></td>
                                <td>User interface, searches</td>
                                <td>savedsearches.conf, web.conf</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Index Management -->
                <h2><i class="fas fa-database"></i> Index Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings â†’ Indexes</span></p>

                    <h4>Default Indexes</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Index</th><th>Purpose</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>main</strong></td><td>Default index for events</td></tr>
                            <tr><td><strong>_internal</strong></td><td>Splunk internal logs</td></tr>
                            <tr><td><strong>_audit</strong></td><td>Audit trail of Splunk access</td></tr>
                            <tr><td><strong>_introspection</strong></td><td>Performance data</td></tr>
                            <tr><td><strong>summary</strong></td><td>Summary index for reports</td></tr>
                        </tbody>
                    </table>

                    <h4>Index Configuration</h4>
                    <div class="arch-diagram"># indexes.conf

[security]
homePath = $SPLUNK_DB/security/db
coldPath = $SPLUNK_DB/security/colddb
thawedPath = $SPLUNK_DB/security/thaweddb
maxDataSize = auto_high_volume
maxTotalDataSizeMB = 500000
frozenTimePeriodInSecs = 7776000  # 90 days

[network]
homePath = $SPLUNK_DB/network/db
coldPath = $SPLUNK_DB/network/colddb
thawedPath = $SPLUNK_DB/network/thaweddb
maxTotalDataSizeMB = 1000000
frozenTimePeriodInSecs = 2592000  # 30 days</div>

                    <h4>Index Lifecycle</h4>
                    <div class="arch-diagram">Data Lifecycle Stages:

HOT â†’ WARM â†’ COLD â†’ FROZEN â†’ DELETED

Hot Buckets:
- Actively written to
- Searchable
- Fastest access

Warm Buckets:
- No longer written
- Searchable
- Fast access

Cold Buckets:
- Older data
- Searchable
- Slower access

Frozen Buckets:
- Archived or deleted
- Not searchable by default
- Can be thawed if needed</div>
                </div>

                <!-- Data Inputs -->
                <h2><i class="fas fa-upload"></i> Data Inputs</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings â†’ Data Inputs</span></p>

                    <h4>Input Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Use Case</th><th>Config File</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Files & Directories</strong></td>
                                <td>Local log files</td>
                                <td>inputs.conf [monitor://]</td>
                            </tr>
                            <tr>
                                <td><strong>Network (TCP/UDP)</strong></td>
                                <td>Syslog, network devices</td>
                                <td>inputs.conf [tcp://] [udp://]</td>
                            </tr>
                            <tr>
                                <td><strong>HTTP Event Collector</strong></td>
                                <td>API-based ingestion</td>
                                <td>inputs.conf [http://]</td>
                            </tr>
                            <tr>
                                <td><strong>Scripted Inputs</strong></td>
                                <td>Custom data collection</td>
                                <td>inputs.conf [script://]</td>
                            </tr>
                            <tr>
                                <td><strong>Windows Inputs</strong></td>
                                <td>Event logs, WMI, Registry</td>
                                <td>inputs.conf [WinEventLog://]</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Common Input Configurations</h4>
                    <div class="arch-diagram"># inputs.conf examples

# Monitor a log file
[monitor:///var/log/secure]
disabled = false
index = security
sourcetype = linux_secure

# Windows Security Event Log
[WinEventLog://Security]
disabled = false
index = wineventlog
evt_resolve_ad_obj = 1
blacklist1 = EventCode="4688" Message="(?:conhost\.exe|RuntimeBroker\.exe)"

# TCP Syslog Input
[tcp://514]
disabled = false
connection_host = dns
index = network
sourcetype = syslog

# HTTP Event Collector
[http://security_events]
disabled = false
index = security
token = your-hec-token-here</div>
                </div>

                <!-- Source Types -->
                <h2><i class="fas fa-tag"></i> Source Type Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings â†’ Source Types</span></p>

                    <h4>Common Security Source Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Source Type</th><th>Data Source</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>WinEventLog:Security</td><td>Windows Security logs</td></tr>
                            <tr><td>WinEventLog:System</td><td>Windows System logs</td></tr>
                            <tr><td>XmlWinEventLog:Security</td><td>Windows XML format</td></tr>
                            <tr><td>linux_secure</td><td>Linux auth logs</td></tr>
                            <tr><td>pan:traffic</td><td>Palo Alto firewall</td></tr>
                            <tr><td>cisco:asa</td><td>Cisco ASA firewall</td></tr>
                            <tr><td>aws:cloudtrail</td><td>AWS CloudTrail</td></tr>
                        </tbody>
                    </table>

                    <h4>Source Type Configuration</h4>
                    <div class="arch-diagram"># props.conf - Source type settings

[custom_app_logs]
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TIME_PREFIX = timestamp=
LINE_BREAKER = ([\r\n]+)
SHOULD_LINEMERGE = false
TRUNCATE = 10000
MAX_TIMESTAMP_LOOKAHEAD = 30

# Field extractions
EXTRACT-user = user=(?<user>\w+)
EXTRACT-action = action=(?<action>\w+)
EXTRACT-src_ip = src_ip=(?<src_ip>\d+\.\d+\.\d+\.\d+)</div>
                </div>

                <!-- User Management -->
                <h2><i class="fas fa-users"></i> User Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings â†’ Access Controls â†’ Users</span></p>

                    <h4>Default Roles</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Role</th><th>Capabilities</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>admin</strong></td>
                                <td>Full access to all features</td>
                            </tr>
                            <tr>
                                <td><strong>power</strong></td>
                                <td>Create alerts, reports, dashboards</td>
                            </tr>
                            <tr>
                                <td><strong>user</strong></td>
                                <td>Run searches, view dashboards</td>
                            </tr>
                            <tr>
                                <td><strong>can_delete</strong></td>
                                <td>Delete events (inherits user)</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Creating Custom Roles</h4>
                    <div class="arch-diagram"># authorize.conf

[role_soc_analyst]
importRoles = user
srchIndexesAllowed = security;network;wineventlog
srchIndexesDefault = security
srchJobsQuota = 10
rtSrchJobsQuota = 5
srchDiskQuota = 1000
cumulativeSrchJobsQuota = 50
cumulativeRTSrchJobsQuota = 25

[role_soc_lead]
importRoles = power
srchIndexesAllowed = security;network;wineventlog;_internal;_audit
srchJobsQuota = 20
schedule_search = enabled
accelerate_search = enabled</div>

                    <h4>Index-Based Access Control</h4>
                    <div class="arch-diagram">Role Index Permissions:

srchIndexesAllowed:
- Indexes the role CAN search
- Comma or semicolon separated

srchIndexesDefault:
- Default indexes for searches
- Used when index not specified

Example Strategy:
- SOC Tier 1: security, network indexes
- SOC Tier 2: + internal, audit indexes
- Admin: All indexes</div>
                </div>

                <!-- Saved Searches and Alerts -->
                <h2><i class="fas fa-bell"></i> Alerts and Scheduled Searches</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings â†’ Searches, Reports, and Alerts</span></p>

                    <h4>Alert Types</h4>
                    <div class="arch-diagram">Alert Types:

Scheduled Alert:
- Runs on schedule (cron)
- Checks for condition
- Triggers action if met

Real-Time Alert:
- Continuous monitoring
- Immediate triggering
- Higher resource usage

Rolling Window:
- Searches rolling time window
- Good for rate-based alerts</div>

                    <h4>Alert Configuration</h4>
                    <div class="arch-diagram"># savedsearches.conf

[Brute Force Detection]
search = index=security sourcetype=WinEventLog:Security EventCode=4625 \
| stats count by src_ip, user \
| where count > 10
cron_schedule = */15 * * * *
enableSched = 1
dispatch.earliest_time = -15m
dispatch.latest_time = now
alert.severity = 4
alert.suppress = 1
alert.suppress.period = 1h
alert.suppress.fields = src_ip,user
alert_condition = search count > 0
action.email = 1
action.email.to = soc@company.com
action.email.subject = Brute Force Alert: $result.src_ip$</div>

                    <h4>Alert Actions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Action</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Send Email</td><td>Notify analysts</td></tr>
                            <tr><td>Webhook</td><td>Integrate with SOAR/ticketing</td></tr>
                            <tr><td>Run Script</td><td>Custom automation</td></tr>
                            <tr><td>Log Event</td><td>Create audit trail</td></tr>
                            <tr><td>Add to Lookup</td><td>Populate threat lists</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Lookups -->
                <h2><i class="fas fa-table"></i> Lookup Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings â†’ Lookups</span></p>

                    <h4>Lookup Types</h4>
                    <div class="arch-diagram">Lookup Types:

CSV Lookups:
- Static file-based
- Good for reference data
- Easy to update

KV Store Lookups:
- Dynamic, database-backed
- Good for changing data
- Searchable and updatable

External Lookups:
- Script-based
- API integration
- Complex enrichment</div>

                    <h4>Creating Lookups</h4>
                    <div class="arch-diagram"># transforms.conf

[threat_intel_ips]
filename = threat_intel_ips.csv
max_matches = 1
min_matches = 1
default_match = unknown
case_sensitive_match = false

[asset_lookup]
filename = assets.csv
max_matches = 1

# Using lookups in searches:
index=network 
| lookup threat_intel_ips ip as src_ip OUTPUT threat_category, threat_score
| where isnotnull(threat_category)

# Automatic lookup (props.conf)
[network_traffic]
LOOKUP-threat = threat_intel_ips ip as src_ip OUTPUT threat_category</div>

                    <h4>Common Security Lookups</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Lookup</th><th>Purpose</th><th>Key Fields</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Asset Inventory</td><td>Host enrichment</td><td>hostname, ip, owner, criticality</td></tr>
                            <tr><td>User Directory</td><td>User enrichment</td><td>username, department, manager</td></tr>
                            <tr><td>Threat Intel IPs</td><td>Malicious IP detection</td><td>ip, category, confidence</td></tr>
                            <tr><td>Threat Intel Domains</td><td>Malicious domain detection</td><td>domain, category, source</td></tr>
                            <tr><td>Known Good Hashes</td><td>Whitelist</td><td>hash, application, vendor</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Troubleshooting -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting</h2>
                <div class="config-section">
                    <h4>Common Issues</h4>
                    <div class="arch-diagram">Data Not Appearing:

1. Check data input status
   Settings â†’ Data Inputs â†’ [type]
   
2. Verify forwarder connectivity
   index=_internal source=*metrics.log group=tcpin_connections
   
3. Check for parsing errors
   index=_internal sourcetype=splunkd component=LineBreakingProcessor ERROR

4. Verify index permissions
   | rest /services/data/indexes | table title, totalEventCount

Search Performance:

1. Check search job inspector
   Job â†’ Inspect Job
   
2. Look for expensive operations
   index=_audit action=search info=completed
   | stats avg(total_run_time) by search
   
3. Use tstats for indexed fields
   | tstats count WHERE index=security by _time span=1h</div>

                    <h4>Useful Diagnostic Searches</h4>
                    <div class="arch-diagram">// Forwarder status
index=_internal source=*metrics.log group=tcpin_connections
| stats latest(connectionType) as type, latest(sourceIp) as ip, 
        latest(fwdType) as fwdType, latest(version) as version by hostname

// Index sizes
| rest /services/data/indexes
| table title, currentDBSizeMB, totalEventCount, maxTotalDataSizeMB

// License usage
index=_internal source=*license_usage.log type=Usage
| stats sum(b) as bytes by idx
| eval GB = round(bytes/1024/1024/1024, 2)

// Ingestion latency
index=_internal source=*metrics.log group=queue name=indexqueue
| timechart avg(current_size) by host</div>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Administration Decision Trees</h2>
                <div class="config-section">
                    <h3>Decision Tree: Index Design Strategy</h3>
                    <div class="arch-diagram">DESIGNING INDEX STRUCTURE
â”‚
â”œâ”€ BY DATA TYPE/SOURCE
â”‚   â”‚
â”‚   â”œâ”€ Security events â†’ index=security
â”‚   â”‚   â”œâ”€ Windows logs, firewall, IDS/IPS
â”‚   â”‚   â””â”€ High retention (1-2 years compliance)
â”‚   â”‚
â”‚   â”œâ”€ Infrastructure logs â†’ index=infra
â”‚   â”‚   â”œâ”€ Syslog, application logs
â”‚   â”‚   â””â”€ Medium retention (90-180 days)
â”‚   â”‚
â”‚   â”œâ”€ High-volume/low-value â†’ index=verbose
â”‚   â”‚   â”œâ”€ Debug logs, performance metrics
â”‚   â”‚   â””â”€ Short retention (7-30 days)
â”‚   â”‚
â”‚   â””â”€ Summary/accelerated â†’ index=summary
â”‚       â””â”€ Report acceleration, scheduled summaries
â”‚
â”œâ”€ SIZING CONSIDERATIONS
â”‚   â”‚
â”‚   â”œâ”€ Expected GB/day per index?
â”‚   â”‚   â”œâ”€ &lt;10 GB/day â†’ Single index fine
â”‚   â”‚   â””â”€ &gt;100 GB/day â†’ Consider splitting
â”‚   â”‚
â”‚   â”œâ”€ Retention requirements?
â”‚   â”‚   â””â”€ retention = maxDataSize + buffer
â”‚   â”‚
â”‚   â””â”€ Search patterns?
â”‚       â”œâ”€ Often searched together â†’ Same index
â”‚       â””â”€ Rarely combined â†’ Separate indexes
â”‚
â””â”€ COMMON MISTAKES TO AVOID
    â”‚
    â”œâ”€ Too many indexes (>50) â†’ Management overhead
    â”œâ”€ Too few indexes â†’ Poor search performance
    â””â”€ No index=main data â†’ License tracking difficult</div>

                    <h3>Decision Tree: License Management</h3>
                    <div class="arch-diagram">LICENSE CAPACITY PLANNING
â”‚
â”œâ”€ Monitor CURRENT usage:
â”‚   â”‚
â”‚   â”œâ”€ Daily license usage trending
â”‚   â”‚   | rest /services/licenser/pools
â”‚   â”‚   | eval usage_pct = used_bytes/effective_byte_quota*100
â”‚   â”‚
â”‚   â”œâ”€ By-index breakdown
â”‚   â”‚   index=_internal source=*license_usage.log type=Usage
â”‚   â”‚   | stats sum(b) as bytes by idx
â”‚   â”‚
â”‚   â””â”€ Top contributors
â”‚       | stats sum(b) by s (sourcetype)
â”‚       | sort -bytes | head 10
â”‚
â”œâ”€ LICENSE ALERTS at:
â”‚   â”‚
â”‚   â”œâ”€ 70% â†’ Warning: Review upcoming data sources
â”‚   â”œâ”€ 85% â†’ Critical: Postpone new sources
â”‚   â””â”€ 95% â†’ Emergency: Consider filtering/dropping
â”‚
â”œâ”€ LICENSE OPTIMIZATION:
â”‚   â”‚
â”‚   â”œâ”€ Filter at source (inputs.conf blacklist)
â”‚   â”œâ”€ Drop noisy sourcetypes (nullQueue)
â”‚   â”œâ”€ Summarize instead of raw events
â”‚   â””â”€ Move to summary indexing for reports
â”‚
â””â”€ CAPACITY PLANNING:
    â”‚
    â”œâ”€ Annual growth rate? (typically 20-30%)
    â”œâ”€ New data sources planned?
    â””â”€ Plan license renewal 6 months ahead</div>

                    <h3>Decision Tree: User Role Design</h3>
                    <div class="arch-diagram">DESIGNING RBAC STRUCTURE
â”‚
â”œâ”€ IDENTIFY user personas:
â”‚   â”‚
â”‚   â”œâ”€ SOC Analyst (L1)
â”‚   â”‚   â”œâ”€ Read: security, notable_events
â”‚   â”‚   â”œâ”€ Write: comments, dispositions
â”‚   â”‚   â””â”€ Apps: ES Incident Review only
â”‚   â”‚
â”‚   â”œâ”€ SOC Analyst (L2/L3)
â”‚   â”‚   â”œâ”€ Read: All security indexes
â”‚   â”‚   â”œâ”€ Write: Saved searches, reports
â”‚   â”‚   â””â”€ Apps: ES, SOAR, hunt capabilities
â”‚   â”‚
â”‚   â”œâ”€ Detection Engineer
â”‚   â”‚   â”œâ”€ Read: All data for detection development
â”‚   â”‚   â”œâ”€ Write: Correlation searches, rules
â”‚   â”‚   â””â”€ Apps: ES, search_admin capabilities
â”‚   â”‚
â”‚   â””â”€ Splunk Admin
â”‚       â”œâ”€ Full access
â”‚       â””â”€ Infrastructure management
â”‚
â”œâ”€ CAPABILITY assignment:
â”‚   â”‚
â”‚   â”œâ”€ schedule_search â†’ Who can create scheduled searches?
â”‚   â”œâ”€ edit_monitor â†’ Who can add data inputs?
â”‚   â”œâ”€ edit_user â†’ Who manages users?
â”‚   â””â”€ admin_all_objects â†’ Full admin (restrict!)
â”‚
â””â”€ INDEX permissions:
    â”‚
    â”œâ”€ srchIndexesAllowed = specific indexes only
    â”œâ”€ srchIndexesDefault = commonly searched
    â””â”€ Don't grant access to _internal unnecessarily</div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                <div class="enterprise-gaps">
                    <div class="gap-grid">
                        <div class="gap-category critical">
                            <h4>ğŸ”´ Critical Gaps</h4>
                            <ul>
                                <li><strong>No license monitoring:</strong> License violations discovered after 5+ warnings</li>
                                <li><strong>Default passwords:</strong> admin/changeme still in use or service accounts with weak passwords</li>
                                <li><strong>No backup strategy:</strong> KV stores, lookups, configs not backed up</li>
                                <li><strong>Expired certificates:</strong> SSL certs expire, cluster communication fails</li>
                                <li><strong>No capacity planning:</strong> Storage/license runs out unexpectedly</li>
                            </ul>
                        </div>
                        <div class="gap-category warning">
                            <h4><i class="fas fa-exclamation-triangle"></i> Operational Gaps</h4>
                            <ul>
                                <li><strong>No health monitoring:</strong> Splunk monitors everything except itself</li>
                                <li><strong>Stale saved searches:</strong> Hundreds of saved searches from departed users</li>
                                <li><strong>No change management:</strong> Config changes made directly without tracking</li>
                                <li><strong>Over-privileged users:</strong> Everyone has admin or power capabilities</li>
                                <li><strong>No retention enforcement:</strong> Data retained longer than policy allows</li>
                            </ul>
                        </div>
                        <div class="gap-category info">
                            <h4><i class="fas fa-info-circle"></i> Performance Issues</h4>
                            <ul>
                                <li><strong>Unoptimized searches:</strong> Scheduled searches scanning full history daily</li>
                                <li><strong>Missing summary indexes:</strong> Reports regenerating from raw data every time</li>
                                <li><strong>Bloated indexes:</strong> Debug logs consuming expensive storage</li>
                                <li><strong>Concurrent search limits:</strong> Default limits causing search queuing</li>
                                <li><strong>No search optimization:</strong> Users writing inefficient searches</li>
                            </ul>
                        </div>
                        <div class="gap-category best-practice">
                            <h4><i class="fas fa-check-circle"></i> Best Practices Often Ignored</h4>
                            <ul>
                                <li><strong>Daily health checks:</strong> Review splunkd.log, queue sizes, license</li>
                                <li><strong>Weekly maintenance:</strong> Clean up orphaned searches, review roles</li>
                                <li><strong>Monthly capacity review:</strong> Storage trending, license planning</li>
                                <li><strong>Quarterly audit:</strong> User access review, retention compliance</li>
                                <li><strong>Version currency:</strong> Keep within 2 major versions of latest</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between Universal and Heavy Forwarder?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Universal Forwarder:</strong> Lightweight, minimal processing, just forwards raw data</li>
                                <li><strong>Heavy Forwarder:</strong> Full Splunk instance, can parse, filter, route, and transform data before forwarding</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Use UF</strong> when: Simple log collection, minimal endpoint impact needed</p>
                            <p><strong>Use HF</strong> when: Need to parse at edge, filter data, route to multiple destinations</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you optimize slow Splunk searches?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Use time range:</strong> Narrow the search window</li>
                                <li><strong>Specify index:</strong> Always include index=</li>
                                <li><strong>Filter early:</strong> Put restrictive filters first</li>
                                <li><strong>Use tstats:</strong> For indexed fields (much faster)</li>
                                <li><strong>Avoid wildcards:</strong> Leading wildcards are expensive</li>
                                <li><strong>Use summary indexing:</strong> Pre-compute common aggregations</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does Splunk handle data retention?</button>
                        <div class="qa-answer">
                            <p>Splunk uses bucket-based storage with configurable retention:</p>
                            <ul>
                                <li><strong>frozenTimePeriodInSecs:</strong> Age-based retention</li>
                                <li><strong>maxTotalDataSizeMB:</strong> Size-based retention</li>
                                <li>Data moves: Hot â†’ Warm â†’ Cold â†’ Frozen</li>
                                <li>Frozen data is deleted or archived (coldToFrozenDir)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>