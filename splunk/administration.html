<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Splunk Administration | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>
            <div class="sidebar-divider"></div>
            <div class="sidebar-section">
                <div class="sidebar-section-title">Splunk Pages</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Clustering & HA</span></a></li>
                    <li class="sidebar-nav-item"><a href="security-rbac.html" class="sidebar-nav-link"><i class="fas fa-user-lock"></i><span>Security & RBAC</span></a></li>
                    <li class="sidebar-nav-item"><a href="apps-tas.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Apps & TAs</span></a></li>
                    <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-paper-plane"></i><span>Forwarders</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-file-import"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-filter"></i><span>Parsing & Props/Transforms</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Index & Retention</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i><span>Data Models & CIM</span></a></li>
                    <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>Knowledge Objects</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>SPL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>SPL Intermediate</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>SPL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>Enterprise Security</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Correlation Searches</span></a></li>
                    <li class="sidebar-nav-item"><a href="notable-events.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Notable Events</span></a></li>
                    <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-exclamation-triangle"></i><span>Risk-Based Alerting</span></a></li>
                    <li class="sidebar-nav-item"><a href="alerting-actions.html" class="sidebar-nav-link"><i class="fas fa-bolt"></i><span>Alerting & Actions</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intelligence</span></a></li>
                    <li class="sidebar-nav-item"><a href="soar.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>SOAR</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="security-usecases.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Security Use Cases</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-binoculars"></i><span>Threat Hunting</span></a></li>
                    <li class="sidebar-nav-item"><a href="administration.html" class="sidebar-nav-link"><i class="fas fa-cog"></i><span>Administration</span></a></li>
                    <li class="sidebar-nav-item"><a href="performance-tuning.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>Performance Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="monitoring-console.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Monitoring Console</span></a></li>
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-tools"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Splunk Cloud</span></a></li>
                    <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise Scenarios</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Administration</span>
                </div>

                <h1><i class="fas fa-cogs"></i> Splunk Administration</h1>
                <p class="lead">Essential Splunk administration tasks for SOC analysts including user management, index administration, data inputs, and troubleshooting common issues.</p>

                <!-- Architecture Overview -->
                <h2><i class="fas fa-sitemap"></i> Splunk Architecture</h2>
                <div class="config-section">
                    <div class="arch-diagram">Splunk Components:

┌─────────────────────────────────────────────────────────┐
│                    SEARCH HEAD                          │
│  - User interface                                       │
│  - Search processing                                    │
│  - Knowledge objects (saved searches, dashboards)       │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                    INDEXER(S)                           │
│  - Data storage                                         │
│  - Index maintenance                                    │
│  - Search execution                                     │
└─────────────────────────────────────────────────────────┘
                          ▲
                          │
┌─────────────────────────────────────────────────────────┐
│              FORWARDERS (Universal/Heavy)               │
│  - Data collection                                      │
│  - Data forwarding                                      │
│  - (Heavy only) Parsing, filtering                      │
└─────────────────────────────────────────────────────────┘</div>

                    <h4>Component Roles</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Component</th><th>Function</th><th>Key Config</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Universal Forwarder</strong></td>
                                <td>Lightweight data collection</td>
                                <td>inputs.conf, outputs.conf</td>
                            </tr>
                            <tr>
                                <td><strong>Heavy Forwarder</strong></td>
                                <td>Parsing, filtering, routing</td>
                                <td>props.conf, transforms.conf</td>
                            </tr>
                            <tr>
                                <td><strong>Indexer</strong></td>
                                <td>Storage and search</td>
                                <td>indexes.conf, server.conf</td>
                            </tr>
                            <tr>
                                <td><strong>Search Head</strong></td>
                                <td>User interface, searches</td>
                                <td>savedsearches.conf, web.conf</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Index Management -->
                <h2><i class="fas fa-database"></i> Index Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Indexes</span></p>

                    <h4>Default Indexes</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Index</th><th>Purpose</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>main</strong></td><td>Default index for events</td></tr>
                            <tr><td><strong>_internal</strong></td><td>Splunk internal logs</td></tr>
                            <tr><td><strong>_audit</strong></td><td>Audit trail of Splunk access</td></tr>
                            <tr><td><strong>_introspection</strong></td><td>Performance data</td></tr>
                            <tr><td><strong>summary</strong></td><td>Summary index for reports</td></tr>
                        </tbody>
                    </table>

                    <h4>Index Configuration</h4>
                    <div class="arch-diagram"># indexes.conf

[security]
homePath = $SPLUNK_DB/security/db
coldPath = $SPLUNK_DB/security/colddb
thawedPath = $SPLUNK_DB/security/thaweddb
maxDataSize = auto_high_volume
maxTotalDataSizeMB = 500000
frozenTimePeriodInSecs = 7776000  # 90 days

[network]
homePath = $SPLUNK_DB/network/db
coldPath = $SPLUNK_DB/network/colddb
thawedPath = $SPLUNK_DB/network/thaweddb
maxTotalDataSizeMB = 1000000
frozenTimePeriodInSecs = 2592000  # 30 days</div>

                    <h4>Index Lifecycle</h4>
                    <div class="arch-diagram">Data Lifecycle Stages:

HOT → WARM → COLD → FROZEN → DELETED

Hot Buckets:
- Actively written to
- Searchable
- Fastest access

Warm Buckets:
- No longer written
- Searchable
- Fast access

Cold Buckets:
- Older data
- Searchable
- Slower access

Frozen Buckets:
- Archived or deleted
- Not searchable by default
- Can be thawed if needed</div>
                </div>

                <!-- Data Inputs -->
                <h2><i class="fas fa-upload"></i> Data Inputs</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Data Inputs</span></p>

                    <h4>Input Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Use Case</th><th>Config File</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Files & Directories</strong></td>
                                <td>Local log files</td>
                                <td>inputs.conf [monitor://]</td>
                            </tr>
                            <tr>
                                <td><strong>Network (TCP/UDP)</strong></td>
                                <td>Syslog, network devices</td>
                                <td>inputs.conf [tcp://] [udp://]</td>
                            </tr>
                            <tr>
                                <td><strong>HTTP Event Collector</strong></td>
                                <td>API-based ingestion</td>
                                <td>inputs.conf [http://]</td>
                            </tr>
                            <tr>
                                <td><strong>Scripted Inputs</strong></td>
                                <td>Custom data collection</td>
                                <td>inputs.conf [script://]</td>
                            </tr>
                            <tr>
                                <td><strong>Windows Inputs</strong></td>
                                <td>Event logs, WMI, Registry</td>
                                <td>inputs.conf [WinEventLog://]</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Common Input Configurations</h4>
                    <div class="arch-diagram"># inputs.conf examples

# Monitor a log file
[monitor:///var/log/secure]
disabled = false
index = security
sourcetype = linux_secure

# Windows Security Event Log
[WinEventLog://Security]
disabled = false
index = wineventlog
evt_resolve_ad_obj = 1
blacklist1 = EventCode="4688" Message="(?:conhost\.exe|RuntimeBroker\.exe)"

# TCP Syslog Input
[tcp://514]
disabled = false
connection_host = dns
index = network
sourcetype = syslog

# HTTP Event Collector
[http://security_events]
disabled = false
index = security
token = your-hec-token-here</div>
                </div>

                <!-- Source Types -->
                <h2><i class="fas fa-tag"></i> Source Type Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Source Types</span></p>

                    <h4>Common Security Source Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Source Type</th><th>Data Source</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>WinEventLog:Security</td><td>Windows Security logs</td></tr>
                            <tr><td>WinEventLog:System</td><td>Windows System logs</td></tr>
                            <tr><td>XmlWinEventLog:Security</td><td>Windows XML format</td></tr>
                            <tr><td>linux_secure</td><td>Linux auth logs</td></tr>
                            <tr><td>pan:traffic</td><td>Palo Alto firewall</td></tr>
                            <tr><td>cisco:asa</td><td>Cisco ASA firewall</td></tr>
                            <tr><td>aws:cloudtrail</td><td>AWS CloudTrail</td></tr>
                        </tbody>
                    </table>

                    <h4>Source Type Configuration</h4>
                    <div class="arch-diagram"># props.conf - Source type settings

[custom_app_logs]
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TIME_PREFIX = timestamp=
LINE_BREAKER = ([\r\n]+)
SHOULD_LINEMERGE = false
TRUNCATE = 10000
MAX_TIMESTAMP_LOOKAHEAD = 30

# Field extractions
EXTRACT-user = user=(?<user>\w+)
EXTRACT-action = action=(?<action>\w+)
EXTRACT-src_ip = src_ip=(?<src_ip>\d+\.\d+\.\d+\.\d+)</div>
                </div>

                <!-- User Management -->
                <h2><i class="fas fa-users"></i> User Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Access Controls → Users</span></p>

                    <h4>Default Roles</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Role</th><th>Capabilities</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>admin</strong></td>
                                <td>Full access to all features</td>
                            </tr>
                            <tr>
                                <td><strong>power</strong></td>
                                <td>Create alerts, reports, dashboards</td>
                            </tr>
                            <tr>
                                <td><strong>user</strong></td>
                                <td>Run searches, view dashboards</td>
                            </tr>
                            <tr>
                                <td><strong>can_delete</strong></td>
                                <td>Delete events (inherits user)</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Creating Custom Roles</h4>
                    <div class="arch-diagram"># authorize.conf

[role_soc_analyst]
importRoles = user
srchIndexesAllowed = security;network;wineventlog
srchIndexesDefault = security
srchJobsQuota = 10
rtSrchJobsQuota = 5
srchDiskQuota = 1000
cumulativeSrchJobsQuota = 50
cumulativeRTSrchJobsQuota = 25

[role_soc_lead]
importRoles = power
srchIndexesAllowed = security;network;wineventlog;_internal;_audit
srchJobsQuota = 20
schedule_search = enabled
accelerate_search = enabled</div>

                    <h4>Index-Based Access Control</h4>
                    <div class="arch-diagram">Role Index Permissions:

srchIndexesAllowed:
- Indexes the role CAN search
- Comma or semicolon separated

srchIndexesDefault:
- Default indexes for searches
- Used when index not specified

Example Strategy:
- SOC Tier 1: security, network indexes
- SOC Tier 2: + internal, audit indexes
- Admin: All indexes</div>
                </div>

                <!-- Saved Searches and Alerts -->
                <h2><i class="fas fa-bell"></i> Alerts and Scheduled Searches</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Searches, Reports, and Alerts</span></p>

                    <h4>Alert Types</h4>
                    <div class="arch-diagram">Alert Types:

Scheduled Alert:
- Runs on schedule (cron)
- Checks for condition
- Triggers action if met

Real-Time Alert:
- Continuous monitoring
- Immediate triggering
- Higher resource usage

Rolling Window:
- Searches rolling time window
- Good for rate-based alerts</div>

                    <h4>Alert Configuration</h4>
                    <div class="arch-diagram"># savedsearches.conf

[Brute Force Detection]
search = index=security sourcetype=WinEventLog:Security EventCode=4625 \
| stats count by src_ip, user \
| where count > 10
cron_schedule = */15 * * * *
enableSched = 1
dispatch.earliest_time = -15m
dispatch.latest_time = now
alert.severity = 4
alert.suppress = 1
alert.suppress.period = 1h
alert.suppress.fields = src_ip,user
alert_condition = search count > 0
action.email = 1
action.email.to = soc@company.com
action.email.subject = Brute Force Alert: $result.src_ip$</div>

                    <h4>Alert Actions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Action</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Send Email</td><td>Notify analysts</td></tr>
                            <tr><td>Webhook</td><td>Integrate with SOAR/ticketing</td></tr>
                            <tr><td>Run Script</td><td>Custom automation</td></tr>
                            <tr><td>Log Event</td><td>Create audit trail</td></tr>
                            <tr><td>Add to Lookup</td><td>Populate threat lists</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Lookups -->
                <h2><i class="fas fa-table"></i> Lookup Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Lookups</span></p>

                    <h4>Lookup Types</h4>
                    <div class="arch-diagram">Lookup Types:

CSV Lookups:
- Static file-based
- Good for reference data
- Easy to update

KV Store Lookups:
- Dynamic, database-backed
- Good for changing data
- Searchable and updatable

External Lookups:
- Script-based
- API integration
- Complex enrichment</div>

                    <h4>Creating Lookups</h4>
                    <div class="arch-diagram"># transforms.conf

[threat_intel_ips]
filename = threat_intel_ips.csv
max_matches = 1
min_matches = 1
default_match = unknown
case_sensitive_match = false

[asset_lookup]
filename = assets.csv
max_matches = 1

# Using lookups in searches:
index=network 
| lookup threat_intel_ips ip as src_ip OUTPUT threat_category, threat_score
| where isnotnull(threat_category)

# Automatic lookup (props.conf)
[network_traffic]
LOOKUP-threat = threat_intel_ips ip as src_ip OUTPUT threat_category</div>

                    <h4>Common Security Lookups</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Lookup</th><th>Purpose</th><th>Key Fields</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Asset Inventory</td><td>Host enrichment</td><td>hostname, ip, owner, criticality</td></tr>
                            <tr><td>User Directory</td><td>User enrichment</td><td>username, department, manager</td></tr>
                            <tr><td>Threat Intel IPs</td><td>Malicious IP detection</td><td>ip, category, confidence</td></tr>
                            <tr><td>Threat Intel Domains</td><td>Malicious domain detection</td><td>domain, category, source</td></tr>
                            <tr><td>Known Good Hashes</td><td>Whitelist</td><td>hash, application, vendor</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Troubleshooting -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting</h2>
                <div class="config-section">
                    <h4>Common Issues</h4>
                    <div class="arch-diagram">Data Not Appearing:

1. Check data input status
   Settings → Data Inputs → [type]
   
2. Verify forwarder connectivity
   index=_internal source=*metrics.log group=tcpin_connections
   
3. Check for parsing errors
   index=_internal sourcetype=splunkd component=LineBreakingProcessor ERROR

4. Verify index permissions
   | rest /services/data/indexes | table title, totalEventCount

Search Performance:

1. Check search job inspector
   Job → Inspect Job
   
2. Look for expensive operations
   index=_audit action=search info=completed
   | stats avg(total_run_time) by search
   
3. Use tstats for indexed fields
   | tstats count WHERE index=security by _time span=1h</div>

                    <h4>Useful Diagnostic Searches</h4>
                    <div class="arch-diagram">// Forwarder status
index=_internal source=*metrics.log group=tcpin_connections
| stats latest(connectionType) as type, latest(sourceIp) as ip, 
        latest(fwdType) as fwdType, latest(version) as version by hostname

// Index sizes
| rest /services/data/indexes
| table title, currentDBSizeMB, totalEventCount, maxTotalDataSizeMB

// License usage
index=_internal source=*license_usage.log type=Usage
| stats sum(b) as bytes by idx
| eval GB = round(bytes/1024/1024/1024, 2)

// Ingestion latency
index=_internal source=*metrics.log group=queue name=indexqueue
| timechart avg(current_size) by host</div>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Administration Decision Trees</h2>
                <div class="config-section">
                    <h3>Decision Tree: Index Design Strategy</h3>
                    <div class="arch-diagram">DESIGNING INDEX STRUCTURE
│
├─ BY DATA TYPE/SOURCE
│   │
│   ├─ Security events → index=security
│   │   ├─ Windows logs, firewall, IDS/IPS
│   │   └─ High retention (1-2 years compliance)
│   │
│   ├─ Infrastructure logs → index=infra
│   │   ├─ Syslog, application logs
│   │   └─ Medium retention (90-180 days)
│   │
│   ├─ High-volume/low-value → index=verbose
│   │   ├─ Debug logs, performance metrics
│   │   └─ Short retention (7-30 days)
│   │
│   └─ Summary/accelerated → index=summary
│       └─ Report acceleration, scheduled summaries
│
├─ SIZING CONSIDERATIONS
│   │
│   ├─ Expected GB/day per index?
│   │   ├─ &lt;10 GB/day → Single index fine
│   │   └─ &gt;100 GB/day → Consider splitting
│   │
│   ├─ Retention requirements?
│   │   └─ retention = maxDataSize + buffer
│   │
│   └─ Search patterns?
│       ├─ Often searched together → Same index
│       └─ Rarely combined → Separate indexes
│
└─ COMMON MISTAKES TO AVOID
    │
    ├─ Too many indexes (>50) → Management overhead
    ├─ Too few indexes → Poor search performance
    └─ No index=main data → License tracking difficult</div>

                    <h3>Decision Tree: License Management</h3>
                    <div class="arch-diagram">LICENSE CAPACITY PLANNING
│
├─ Monitor CURRENT usage:
│   │
│   ├─ Daily license usage trending
│   │   | rest /services/licenser/pools
│   │   | eval usage_pct = used_bytes/effective_byte_quota*100
│   │
│   ├─ By-index breakdown
│   │   index=_internal source=*license_usage.log type=Usage
│   │   | stats sum(b) as bytes by idx
│   │
│   └─ Top contributors
│       | stats sum(b) by s (sourcetype)
│       | sort -bytes | head 10
│
├─ LICENSE ALERTS at:
│   │
│   ├─ 70% → Warning: Review upcoming data sources
│   ├─ 85% → Critical: Postpone new sources
│   └─ 95% → Emergency: Consider filtering/dropping
│
├─ LICENSE OPTIMIZATION:
│   │
│   ├─ Filter at source (inputs.conf blacklist)
│   ├─ Drop noisy sourcetypes (nullQueue)
│   ├─ Summarize instead of raw events
│   └─ Move to summary indexing for reports
│
└─ CAPACITY PLANNING:
    │
    ├─ Annual growth rate? (typically 20-30%)
    ├─ New data sources planned?
    └─ Plan license renewal 6 months ahead</div>

                    <h3>Decision Tree: User Role Design</h3>
                    <div class="arch-diagram">DESIGNING RBAC STRUCTURE
│
├─ IDENTIFY user personas:
│   │
│   ├─ SOC Analyst (L1)
│   │   ├─ Read: security, notable_events
│   │   ├─ Write: comments, dispositions
│   │   └─ Apps: ES Incident Review only
│   │
│   ├─ SOC Analyst (L2/L3)
│   │   ├─ Read: All security indexes
│   │   ├─ Write: Saved searches, reports
│   │   └─ Apps: ES, SOAR, hunt capabilities
│   │
│   ├─ Detection Engineer
│   │   ├─ Read: All data for detection development
│   │   ├─ Write: Correlation searches, rules
│   │   └─ Apps: ES, search_admin capabilities
│   │
│   └─ Splunk Admin
│       ├─ Full access
│       └─ Infrastructure management
│
├─ CAPABILITY assignment:
│   │
│   ├─ schedule_search → Who can create scheduled searches?
│   ├─ edit_monitor → Who can add data inputs?
│   ├─ edit_user → Who manages users?
│   └─ admin_all_objects → Full admin (restrict!)
│
└─ INDEX permissions:
    │
    ├─ srchIndexesAllowed = specific indexes only
    ├─ srchIndexesDefault = commonly searched
    └─ Don't grant access to _internal unnecessarily</div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                <div class="enterprise-gaps">
                    <div class="gap-grid">
                        <div class="gap-category critical">
                            <h4><i class="fas fa-times-circle"></i> Critical Gaps</h4>
                            <ul>
                                <li><strong>No license monitoring:</strong> License violations discovered after 5+ warnings</li>
                                <li><strong>Default passwords:</strong> admin/changeme still in use or service accounts with weak passwords</li>
                                <li><strong>No backup strategy:</strong> KV stores, lookups, configs not backed up</li>
                                <li><strong>Expired certificates:</strong> SSL certs expire, cluster communication fails</li>
                                <li><strong>No capacity planning:</strong> Storage/license runs out unexpectedly</li>
                            </ul>
                        </div>
                        <div class="gap-category warning">
                            <h4><i class="fas fa-exclamation-triangle"></i> Operational Gaps</h4>
                            <ul>
                                <li><strong>No health monitoring:</strong> Splunk monitors everything except itself</li>
                                <li><strong>Stale saved searches:</strong> Hundreds of saved searches from departed users</li>
                                <li><strong>No change management:</strong> Config changes made directly without tracking</li>
                                <li><strong>Over-privileged users:</strong> Everyone has admin or power capabilities</li>
                                <li><strong>No retention enforcement:</strong> Data retained longer than policy allows</li>
                            </ul>
                        </div>
                        <div class="gap-category info">
                            <h4><i class="fas fa-info-circle"></i> Performance Issues</h4>
                            <ul>
                                <li><strong>Unoptimized searches:</strong> Scheduled searches scanning full history daily</li>
                                <li><strong>Missing summary indexes:</strong> Reports regenerating from raw data every time</li>
                                <li><strong>Bloated indexes:</strong> Debug logs consuming expensive storage</li>
                                <li><strong>Concurrent search limits:</strong> Default limits causing search queuing</li>
                                <li><strong>No search optimization:</strong> Users writing inefficient searches</li>
                            </ul>
                        </div>
                        <div class="gap-category best-practice">
                            <h4><i class="fas fa-check-circle"></i> Best Practices Often Ignored</h4>
                            <ul>
                                <li><strong>Daily health checks:</strong> Review splunkd.log, queue sizes, license</li>
                                <li><strong>Weekly maintenance:</strong> Clean up orphaned searches, review roles</li>
                                <li><strong>Monthly capacity review:</strong> Storage trending, license planning</li>
                                <li><strong>Quarterly audit:</strong> User access review, retention compliance</li>
                                <li><strong>Version currency:</strong> Keep within 2 major versions of latest</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between Universal and Heavy Forwarder?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Universal Forwarder:</strong> Lightweight, minimal processing, just forwards raw data</li>
                                <li><strong>Heavy Forwarder:</strong> Full Splunk instance, can parse, filter, route, and transform data before forwarding</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Use UF</strong> when: Simple log collection, minimal endpoint impact needed</p>
                            <p><strong>Use HF</strong> when: Need to parse at edge, filter data, route to multiple destinations</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you optimize slow Splunk searches?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Use time range:</strong> Narrow the search window</li>
                                <li><strong>Specify index:</strong> Always include index=</li>
                                <li><strong>Filter early:</strong> Put restrictive filters first</li>
                                <li><strong>Use tstats:</strong> For indexed fields (much faster)</li>
                                <li><strong>Avoid wildcards:</strong> Leading wildcards are expensive</li>
                                <li><strong>Use summary indexing:</strong> Pre-compute common aggregations</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does Splunk handle data retention?</button>
                        <div class="qa-answer">
                            <p>Splunk uses bucket-based storage with configurable retention:</p>
                            <ul>
                                <li><strong>frozenTimePeriodInSecs:</strong> Age-based retention</li>
                                <li><strong>maxTotalDataSizeMB:</strong> Size-based retention</li>
                                <li>Data moves: Hot → Warm → Cold → Frozen</li>
                                <li>Frozen data is deleted or archived (coldToFrozenDir)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>