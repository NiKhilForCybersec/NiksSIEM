<!DOCTYPE html>
<html lang="en" data-theme="dark" data-platform="splunk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk-Based Alerting - RBA in Splunk ES | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="index.html" class="platform-tab splunk active"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
                        <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Pipeline</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="forwarders.html" class="nav-link"><i class="fas fa-share"></i> Forwarders Deep Dive</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                    <a href="data-models.html" class="nav-link"><i class="fas fa-cubes"></i> Data Models & CIM</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention & Buckets</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SPL Query Language</div>
                    <a href="spl-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> SPL Fundamentals</a>
                    <a href="spl-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> SPL Intermediate</a>
                    <a href="spl-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced SPL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Enterprise Security</div>
                    <a href="es-overview.html" class="nav-link"><i class="fas fa-shield-alt"></i> ES Overview</a>
                    <a href="correlation-searches.html" class="nav-link"><i class="fas fa-search-plus"></i> Correlation Searches</a>
                    <a href="notable-events.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Notable Events</a>
                    <a href="risk-based-alerting.html" class="nav-link active"><i class="fas fa-chart-line"></i> Risk-Based Alerting</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">TI & Automation</div>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intelligence</a>
                    <a href="soar.html" class="nav-link"><i class="fas fa-robot"></i> Splunk SOAR</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="apps-tas.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> Apps & TAs</a>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-wrench"></i> Troubleshooting</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-chart-line"></i> Risk-Based Alerting (RBA)</h1>
                    <p class="lead">Reduce alert fatigue by scoring risk on assets and identities instead of creating individual alerts</p>
                </div>

                <section class="content-section">
                    <h2><i class="fas fa-lightbulb"></i> What is RBA?</h2>
                    <p>Risk-Based Alerting shifts from "one detection = one alert" to accumulating risk scores on assets/identities. A notable is only created when risk exceeds a threshold.</p>
                    
                    <div class="architecture-diagram" style="background: var(--card-bg); padding: 1.5rem; border-radius: 8px; font-family: monospace; font-size: 0.7rem;">
<pre>
TRADITIONAL ALERTING:              RISK-BASED ALERTING:
───────────────────               ────────────────────

Detection 1 → Alert               Detection 1 → Risk +20 (user: jsmith)
Detection 2 → Alert               Detection 2 → Risk +30 (user: jsmith)  
Detection 3 → Alert               Detection 3 → Risk +25 (user: jsmith)
Detection 4 → Alert                              │
        │                                        ▼
        ▼                         Total Risk: 75 → Exceeds threshold (50)
4 separate alerts                               │
(analyst fatigue)                               ▼
                                  ONE Notable with full context
</pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-database"></i> Risk Index</h2>
                    <p>Risk events are stored in the <code>risk</code> index:</p>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">SPL</span>
                            <span class="code-title">Query Risk Events</span>
                        </div>
                        <pre><code>// View all risk events
index=risk
| table _time, risk_object, risk_object_type, risk_score, risk_message, source

// Risk score by user (24h)
index=risk risk_object_type=user earliest=-24h
| stats sum(risk_score) as total_risk, count as event_count, 
    values(risk_message) as risk_reasons by risk_object
| sort -total_risk

// High-risk users over threshold
index=risk risk_object_type=user earliest=-24h
| stats sum(risk_score) as total_risk by risk_object
| where total_risk > 100</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-plus-circle"></i> Creating Risk Rules</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">conf</span>
                            <span class="code-title">savedsearches.conf - Risk Rule</span>
                        </div>
                        <pre><code>[Access - Excessive Failed Logins - Risk]
cron_schedule = */5 * * * *
enableSched = 1
search = | tstats count from datamodel=Authentication where Authentication.action=failure \
    by Authentication.user, Authentication.src \
    | where count >= 5 \
    | rename Authentication.user as user, Authentication.src as src

# Add risk instead of creating notable
action.risk = 1
action.risk.param._risk_object = user
action.risk.param._risk_object_type = user
action.risk.param._risk_score = 30
action.risk.param._risk_message = Excessive failed login attempts from $src$

# No notable creation
action.notable = 0</code></pre>
                    </div>

                    <h3>Risk Score Guidelines</h3>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Risk Score</th><th>Severity</th><th>Example Detections</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>10-20</td><td>Informational</td><td>Unusual login time, new device</td></tr>
                            <tr><td>20-40</td><td>Low</td><td>Failed logins, policy violation</td></tr>
                            <tr><td>40-60</td><td>Medium</td><td>Suspicious PowerShell, lateral movement attempt</td></tr>
                            <tr><td>60-80</td><td>High</td><td>Malware detected, data exfil attempt</td></tr>
                            <tr><td>80-100</td><td>Critical</td><td>Known attack technique, confirmed compromise</td></tr>
                        </tbody>
                    </table>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-bell"></i> Risk Threshold Notables</h2>
                    <p>Create a correlation search that alerts when risk exceeds threshold:</p>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">SPL</span>
                            <span class="code-title">Risk Threshold Correlation Search</span>
                        </div>
                        <pre><code>// Alert when user risk exceeds 100 in 24 hours
index=risk risk_object_type=user earliest=-24h
| stats sum(risk_score) as total_risk, 
    values(risk_message) as risk_reasons,
    dc(source) as detection_count,
    latest(_time) as last_risk_time
by risk_object
| where total_risk >= 100
| rename risk_object as user
| eval risk_reasons = mvjoin(risk_reasons, " | ")</code></pre>
                    </div>
                </section>

                <section class="content-section interview-section" style="background: linear-gradient(135deg, rgba(101,166,55,0.1), rgba(101,166,55,0.2)); border-radius: 12px; padding: 2rem;">
                    <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>Explain Risk-Based Alerting and why it's better than traditional alerting.</span>
                        </div>
                        <div class="interview-answer">
                            <p><strong>Traditional alerting problem:</strong> Each detection creates a separate alert. Low-fidelity detections create thousands of alerts, causing analyst fatigue. High-fidelity detections are missed in the noise.</p>
                            <p><strong>RBA solution:</strong> Instead of alerting on each detection, we assign risk scores to assets or identities. When cumulative risk exceeds a threshold, ONE notable is created containing ALL the contributing detections.</p>
                            <p><strong>Benefits:</strong></p>
                            <ul>
                                <li><strong>Reduced alert volume:</strong> 90%+ reduction in notables</li>
                                <li><strong>Higher fidelity:</strong> Alerts only for aggregated suspicious behavior</li>
                                <li><strong>Better context:</strong> Notable contains full attack story</li>
                                <li><strong>Lower MTTR:</strong> Analysts don't waste time on false positives</li>
                            </ul>
                            <p><strong>Implementation:</strong> Convert correlation searches from action.notable=1 to action.risk=1. Create a threshold search that creates notables when risk exceeds limit (e.g., 100 points in 24 hours).</p>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
</body>
</html>
