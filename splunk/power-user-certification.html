<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power User Certification Guide | Splunk SIEM Reference</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Power User Certification -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Power User Certification</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link active"><i class="fas fa-graduation-cap"></i><span>Certification Guide</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>SPL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>SPL Intermediate</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>SPL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>Knowledge Objects</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i><span>Data Models & CIM</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-paper-plane"></i><span>Forwarders</span></a></li>
                    <li class="sidebar-nav-item"><a href="sap-security.html" class="sidebar-nav-link"><i class="fas fa-industry"></i><span>SAP Security</span></a></li>
                </ul>
            </div>
            
            <!-- Cloud Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Cloud Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="splunk-cloud-mastery.html" class="sidebar-nav-link"><i class="fas fa-cloud-upload-alt"></i><span>Cloud Mastery</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>Enterprise Security</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Searches</span></a></li>
                    <li class="sidebar-nav-item"><a href="retail-security.html" class="sidebar-nav-link"><i class="fas fa-shopping-cart"></i><span>Retail Security</span></a></li>
                </ul>
            </div>
                    <!-- Certification Prep -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Certification Prep</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-certificate"></i><span>Power User Cert</span></a></li>
                    <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog"></i><span>Admin Cert</span></a></li>
                    <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>ES Admin Cert</span></a></li>
                    <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud Admin Cert</span></a></li>
                    <li class="sidebar-nav-item"><a href="lab-exercises.html" class="sidebar-nav-link"><i class="fas fa-flask"></i><span>Lab Exercises</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Power User Certification</span>
                </div>

                <h1><i class="fas fa-graduation-cap"></i> Splunk Core Certified Power User - Complete Guide</h1>
                <p class="lead">Complete certification preparation for the Splunk Core Certified Power User exam. Production-ready skills mapped to retail enterprise scenarios like Sobeys. Master SPL, knowledge objects, data models, and CIM to handle any production task.</p>

                <!-- Exam Overview -->
                <div class="info-box info-box-primary">
                    <h4><i class="fas fa-info-circle"></i> Exam Overview</h4>
                    <table class="compact-table">
                        <tr><td><strong>Exam Name</strong></td><td>Splunk Core Certified Power User</td></tr>
                        <tr><td><strong>Prerequisites</strong></td><td>Splunk Core Certified User (recommended)</td></tr>
                        <tr><td><strong>Questions</strong></td><td>57 multiple choice + hands-on</td></tr>
                        <tr><td><strong>Duration</strong></td><td>57 minutes</td></tr>
                        <tr><td><strong>Passing Score</strong></td><td>70%</td></tr>
                        <tr><td><strong>Cost</strong></td><td>$130 USD</td></tr>
                        <tr><td><strong>Validity</strong></td><td>3 years</td></tr>
                    </table>
                </div>

                <!-- Exam Domains -->
                <h2><i class="fas fa-map"></i> Exam Domains & Weight</h2>
                
                <div class="config-section">
                    <h3>Certification Blueprint</h3>
                    <div class="arch-diagram">
SPLUNK CORE CERTIFIED POWER USER - EXAM DOMAINS
════════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                         EXAM DOMAIN BREAKDOWN                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Domain 1: Using Fields (10%)                        ████░░░░░░  10%       │
│   ────────────────────────────────────────────────                          │
│   • Field extraction                                                         │
│   • Field discovery                                                          │
│   • Using fields in searches                                                 │
│                                                                              │
│   Domain 2: Scheduling Reports & Alerts (10%)         ████░░░░░░  10%       │
│   ────────────────────────────────────────────────                          │
│   • Creating scheduled reports                                               │
│   • Alert configurations                                                     │
│   • Alert actions                                                            │
│                                                                              │
│   Domain 3: Visualizations (10%)                      ████░░░░░░  10%       │
│   ────────────────────────────────────────────────                          │
│   • Chart types and use cases                                                │
│   • Dashboard creation                                                       │
│   • Visualization best practices                                             │
│                                                                              │
│   Domain 4: Working with Time (10%)                   ████░░░░░░  10%       │
│   ────────────────────────────────────────────────                          │
│   • Time modifiers                                                           │
│   • Time formatting                                                          │
│   • Timezone considerations                                                  │
│                                                                              │
│   Domain 5: Statistical Commands (15%)                ██████░░░░  15%       │
│   ────────────────────────────────────────────────                          │
│   • stats, chart, timechart                                                  │
│   • Statistical functions                                                    │
│   • By clause grouping                                                       │
│                                                                              │
│   Domain 6: Comparing Values (10%)                    ████░░░░░░  10%       │
│   ────────────────────────────────────────────────                          │
│   • eval command and functions                                               │
│   • Conditional statements                                                   │
│   • Field comparisons                                                        │
│                                                                              │
│   Domain 7: Result Modification (10%)                 ████░░░░░░  10%       │
│   ────────────────────────────────────────────────                          │
│   • sort, head, tail, dedup                                                  │
│   • Result formatting                                                        │
│   • Field manipulation                                                       │
│                                                                              │
│   Domain 8: Using Lookups (10%)                       ████░░░░░░  10%       │
│   ────────────────────────────────────────────────                          │
│   • Lookup file creation                                                     │
│   • Automatic lookups                                                        │
│   • Lookup commands                                                          │
│                                                                              │
│   Domain 9: Knowledge Objects (10%)                   ████░░░░░░  10%       │
│   ────────────────────────────────────────────────                          │
│   • Event types, tags, macros                                                │
│   • Workflow actions                                                         │
│   • Data models                                                              │
│                                                                              │
│   Domain 10: Creating Field Extractions (5%)          ██░░░░░░░░   5%       │
│   ────────────────────────────────────────────────                          │
│   • Regex extractions                                                        │
│   • Field extraction wizard                                                  │
│   • Delimiter extractions                                                    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

STUDY TIME RECOMMENDATION
════════════════════════════════════════════════════════════════════════════════
• Total: 40-60 hours of preparation
• Focus: Statistical Commands (15%) + Working with Time (10%) = 25% of exam
• Hands-on: At least 50% of study time should be practical SPL work
                    </div>
                </div>

                <!-- Domain 1: Using Fields -->
                <h2><i class="fas fa-list"></i> Domain 1: Using Fields (10%)</h2>
                
                <div class="config-section">
                    <h3>Key Concepts & Production Skills</h3>
                    
                    <h4>Why Fields Matter in Production</h4>
                    <p>In a retail enterprise like Sobeys, fields enable you to quickly filter millions of events to find exactly what you need. Proper field usage turns a 30-minute search into a 3-second answer.</p>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Essential Field Operations</span>
                        </div>
                        <pre><code># FIELD DISCOVERY - Finding Available Fields
# ════════════════════════════════════════════════════════════════════════════

# 1. View all extracted fields for a sourcetype
index=main sourcetype=access_combined earliest=-1h
| fieldsummary
| where count > 100
| table field, count, distinct_count, is_exact

# 2. Find fields with specific values (Sobeys example: find POS with errors)
index=pos_transactions sourcetype=pos:transactions
| stats count by status
| where count > 0

# 3. Check field extraction quality
index=firewall sourcetype=paloalto earliest=-1h
| stats count(src_ip) as has_src, count(dest_ip) as has_dest, count as total
| eval extraction_rate_src = round(has_src/total*100,1)."%"
| eval extraction_rate_dest = round(has_dest/total*100,1)."%"


# USING FIELDS IN SEARCHES
# ════════════════════════════════════════════════════════════════════════════

# Inclusive filter (events WITH these values)
index=security sourcetype=wineventlog EventCode=4625 user=admin*

# Exclusive filter (events WITHOUT these values)
index=network sourcetype=firewall action!=allowed src_ip!=10.0.0.*

# Field existence check
index=main sourcetype=access_combined earliest=-1h
| where isnotnull(clientip)
| where isnull(user)  # Find requests without user identification

# Wildcard matching
index=pos_transactions store_id=STR-00* region="Atlantic*"

# Case sensitivity (fields are case-sensitive!)
index=security user="Admin"    # Different from user="admin"
| eval user_lower = lower(user)
| search user_lower="admin"


# FIELD ALIASES & CALCULATED FIELDS
# ════════════════════════════════════════════════════════════════════════════

# Field alias example (in props.conf):
# FIELDALIAS-user = username AS user

# Calculated field (in props.conf):
# EVAL-response_time_ms = response_time * 1000

# Using calculated fields in search
index=web_logs sourcetype=access_combined
| eval response_category = case(
    response_time_ms < 100, "fast",
    response_time_ms < 500, "normal",
    response_time_ms < 1000, "slow",
    true(), "critical"
)
| stats count by response_category</code></pre>
                    </div>

                    <div class="info-box info-box-warning">
                        <h4><i class="fas fa-exclamation-triangle"></i> Exam Tip - Fields</h4>
                        <ul>
                            <li><strong>Fields are case-sensitive:</strong> user="Admin" ≠ user="admin"</li>
                            <li><strong>Field names cannot contain spaces:</strong> Use underscores (src_ip not src ip)</li>
                            <li><strong>Indexed vs extracted:</strong> Indexed fields (_time, host, source, sourcetype, index) are faster to search</li>
                            <li><strong>Default fields always available:</strong> _time, _raw, host, source, sourcetype, index</li>
                        </ul>
                    </div>
                </div>

                <!-- Domain 2: Scheduling Reports & Alerts -->
                <h2><i class="fas fa-clock"></i> Domain 2: Scheduling Reports & Alerts (10%)</h2>
                
                <div class="config-section">
                    <h3>Production Alert Configurations</h3>
                    
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Alert Types & Use Cases</span>
                        </div>
                        <pre><code># ALERT TYPES
# ════════════════════════════════════════════════════════════════════════════

# 1. SCHEDULED ALERT - Runs on schedule, triggers based on conditions
# Use case: Daily report of failed POS transactions at Sobeys stores

# Search:
index=pos_transactions status="failed" earliest=-24h
| stats count as failed_count by store_id, store_name
| where failed_count > 10
| sort -failed_count

# Schedule: Daily at 6:00 AM
# Trigger: Number of results > 0
# Action: Send email to store_managers@sobeys.com

# 2. REAL-TIME ALERT - Continuous monitoring
# Use case: Detect credit card data exfiltration attempts

# Search:
index=dlp sourcetype=dlp:events rule_name="Credit Card*" action="blocked"

# Schedule: Real-time
# Trigger: Number of results > 5 in 5 minutes
# Throttle: Suppress additional alerts for same user for 30 minutes

# 3. ROLLING WINDOW ALERT - Uses sliding time window
# Use case: Detect brute force login attempts

# Search:
index=security sourcetype=wineventlog EventCode=4625
| stats count by src_ip
| where count > 50

# Schedule: Every 5 minutes with 15-minute window
# Trigger: Number of results > 0


# SCHEDULED REPORT PATTERNS
# ════════════════════════════════════════════════════════════════════════════

# Daily Executive Summary - POS Performance
index=pos_transactions earliest=-24h
| stats count as total_transactions,
    sum(eval(if(status="success",1,0))) as successful,
    sum(eval(if(status="failed",1,0))) as failed,
    avg(response_time) as avg_response_ms,
    sum(amount) as total_revenue
by region
| eval success_rate = round(successful/total_transactions*100,2)."%"
| eval total_revenue = "$".tostring(round(total_revenue,2), "commas")
| table region, total_transactions, success_rate, failed, avg_response_ms, total_revenue

# Weekly Security Posture Report
index=security sourcetype IN (wineventlog, paloalto, crowdstrike) earliest=-7d
| stats dc(user) as unique_users,
    count(eval(action="failure")) as failed_auths,
    count(eval(action="blocked")) as blocked_threats,
    dc(src_ip) as unique_sources
by sourcetype
| sort -failed_auths


# ALERT ACTIONS
# ════════════════════════════════════════════════════════════════════════════

# Available actions:
# • Send email - Most common for notifications
# • Run a script - Execute custom remediation
# • Webhook - Send to Slack, Teams, ServiceNow
# • Log event - Create new indexed event
# • Output to lookup - Update lookup table
# • Send to Splunk SOAR - Trigger playbook

# ServiceNow Integration Example (webhook)
# URL: https://instance.service-now.com/api/now/table/incident
# Method: POST
# Body: {"short_description": "$name$", "description": "$result$"}


# THROTTLING (Critical for Production)
# ════════════════════════════════════════════════════════════════════════════

# Without throttling: Alert fires every 5 min = 288 emails/day = alert fatigue
# With throttling: One alert per unique combination, suppressed for duration

# Throttle by: src_ip, user, store_id (choose fields that make sense)
# Suppress for: 1 hour (adjust based on investigation time)

# Example: Throttle credit card alert by user for 4 hours
# If user "jsmith" triggers alert at 9am, won't trigger again until 1pm</code></pre>
                    </div>

                    <div class="info-box info-box-warning">
                        <h4><i class="fas fa-exclamation-triangle"></i> Exam Tip - Alerts</h4>
                        <ul>
                            <li><strong>Real-time vs Scheduled:</strong> Real-time uses more resources, use only when necessary</li>
                            <li><strong>Cron schedule format:</strong> minute hour day month day-of-week (*/5 * * * * = every 5 min)</li>
                            <li><strong>Throttling prevents alert fatigue:</strong> Always configure for production alerts</li>
                            <li><strong>Priority:</strong> Informational, Low, Medium, High, Critical (affects how ES handles)</li>
                        </ul>
                    </div>
                </div>

                <!-- Domain 4: Working with Time -->
                <h2><i class="fas fa-hourglass-half"></i> Domain 4: Working with Time (10%)</h2>
                
                <div class="config-section">
                    <h3>Time Commands & Modifiers</h3>
                    
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Time Manipulation Mastery</span>
                        </div>
                        <pre><code># TIME MODIFIERS - Specifying Search Windows
# ════════════════════════════════════════════════════════════════════════════

# Relative time modifiers (most common in production)
earliest=-24h latest=now        # Last 24 hours
earliest=-7d latest=now         # Last 7 days
earliest=-1mon latest=now       # Last month
earliest=@d latest=now          # Since midnight today
earliest=-1d@d latest=@d        # Yesterday (full day)
earliest=-1w@w latest=@w        # Last week (Monday to Sunday)

# Snap-to time (@) - rounds to beginning of time unit
# @d = midnight today
# @w = beginning of week (Sunday)
# @mon = first of month
# @y = January 1

# Example: Get all POS transactions from last business week
index=pos_transactions earliest=-1w@w1 latest=@w1
# @w1 snaps to Monday (0=Sunday, 1=Monday)

# Absolute time (for specific incidents)
earliest="01/15/2024:00:00:00" latest="01/15/2024:23:59:59"
earliest="2024-01-15T00:00:00" latest="2024-01-15T23:59:59"


# TIME FUNCTIONS
# ════════════════════════════════════════════════════════════════════════════

# strftime - Format time for display
| eval formatted_time = strftime(_time, "%Y-%m-%d %H:%M:%S")
| eval date_only = strftime(_time, "%Y-%m-%d")
| eval time_only = strftime(_time, "%H:%M:%S")
| eval day_of_week = strftime(_time, "%A")        # Monday, Tuesday, etc.
| eval week_number = strftime(_time, "%W")        # Week of year

# strptime - Parse string to time (for calculated fields)
| eval event_epoch = strptime(event_date, "%Y-%m-%d %H:%M:%S")

# Common format codes:
# %Y = 4-digit year (2024)
# %m = month (01-12)
# %d = day (01-31)
# %H = hour 24h (00-23)
# %M = minute (00-59)
# %S = second (00-59)
# %A = weekday name (Monday)
# %B = month name (January)


# TIME CALCULATIONS
# ════════════════════════════════════════════════════════════════════════════

# Calculate time differences
| eval time_diff_seconds = end_time - start_time
| eval time_diff_minutes = round((end_time - start_time) / 60, 2)
| eval time_diff_hours = round((end_time - start_time) / 3600, 2)

# Age of event
| eval age_hours = round((now() - _time) / 3600, 1)
| eval age_days = round((now() - _time) / 86400, 1)

# Time since last event (Sobeys example: time since last transaction)
index=pos_transactions store_id="STR-001"
| sort _time
| streamstats current=f last(_time) as previous_time
| eval gap_minutes = round((_time - previous_time) / 60, 2)
| where gap_minutes > 30  # Alert if no transaction for 30+ minutes


# TIMEZONE HANDLING
# ════════════════════════════════════════════════════════════════════════════

# Sobeys operates across multiple Canadian timezones:
# - Atlantic (AST/ADT): Nova Scotia, New Brunswick, PEI
# - Eastern (EST/EDT): Ontario, Quebec
# - Central (CST/CDT): Manitoba
# - Mountain (MST/MDT): Alberta
# - Pacific (PST/PDT): British Columbia

# Convert UTC to local timezone
| eval local_time = strftime(_time, "%Y-%m-%d %H:%M:%S %Z")

# Force timezone interpretation
| eval atlantic_time = strftime(_time + (4*3600), "%H:%M:%S")  # UTC-4 (ADT)

# Group by business hours (Atlantic timezone)
| eval hour_ast = tonumber(strftime(_time, "%H")) - 4
| eval is_business_hours = if(hour_ast >= 6 AND hour_ast <= 22, "yes", "no")


# TIMECHART - Time-series Analysis
# ════════════════════════════════════════════════════════════════════════════

# Basic timechart (auto-selects span based on time range)
index=pos_transactions
| timechart count by status

# Specified span
| timechart span=1h count by status    # Hourly
| timechart span=15m count by status   # 15-minute intervals
| timechart span=1d count by status    # Daily

# Aggregate functions in timechart
| timechart avg(response_time) as avg_response,
            max(response_time) as max_response,
            sum(amount) as total_revenue
            by region

# Compare periods
| timechart span=1d count
| appendcols [search index=pos_transactions earliest=-14d latest=-7d
              | timechart span=1d count | rename count as count_last_week]
| eval variance = round((count - count_last_week) / count_last_week * 100, 1)</code></pre>
                    </div>

                    <div class="info-box info-box-info">
                        <h4><i class="fas fa-lightbulb"></i> Production Tip - Time Zones</h4>
                        <p>For a multi-region retailer like Sobeys, always store timestamps in UTC and convert for display. This prevents confusion when correlating events across stores in different provinces. Configure props.conf with <code>TZ = UTC</code> for all sources.</p>
                    </div>
                </div>

                <!-- Domain 5: Statistical Commands -->
                <h2><i class="fas fa-chart-bar"></i> Domain 5: Statistical Commands (15%)</h2>
                
                <div class="config-section">
                    <h3>Statistical Analysis for Production</h3>
                    
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Stats, Chart, Timechart Mastery</span>
                        </div>
                        <pre><code># STATS COMMAND - Foundation of SPL Analysis
# ════════════════════════════════════════════════════════════════════════════

# Basic aggregations
| stats count                           # Total events
| stats count by user                   # Count per user
| stats count as total by user          # Named result
| stats dc(user) as unique_users        # Distinct count

# Multiple aggregations
| stats count as events,
        dc(user) as unique_users,
        dc(src_ip) as unique_sources,
        sum(bytes) as total_bytes,
        avg(response_time) as avg_response,
        min(response_time) as min_response,
        max(response_time) as max_response,
        stdev(response_time) as stdev_response
by host

# Multiple BY clauses (creates nested grouping)
| stats count by region, store_id, status
# Results: region=Atlantic, store_id=STR-001, status=success, count=1234

# Values and list functions
| stats values(status) as all_statuses,   # Unique values (MV field)
        list(status) as status_list,       # All values including duplicates
        first(status) as first_status,     # First chronologically
        last(status) as last_status        # Last chronologically
by user


# STATISTICAL FUNCTIONS REFERENCE
# ════════════════════════════════════════════════════════════════════════════

# Counting
count(field)          # Count of events where field exists
dc(field)             # Distinct count (cardinality)
count                 # Total events

# Numeric
sum(field)            # Sum
avg(field)            # Average (mean)
median(field)         # Median (50th percentile)
mode(field)           # Most common value
min(field)            # Minimum
max(field)            # Maximum
range(field)          # max - min
stdev(field)          # Standard deviation
var(field)            # Variance
perc95(field)         # 95th percentile
exactperc95(field)    # Exact 95th percentile (more accurate, slower)

# Time
earliest(field)       # Earliest value by _time
latest(field)         # Latest value by _time
first(field)          # First occurrence
last(field)           # Last occurrence

# Multi-value
values(field)         # Unique values
list(field)           # All values


# CHART COMMAND - Aggregation with 2 dimensions
# ════════════════════════════════════════════════════════════════════════════

# Chart creates X-axis (first BY field) and series (second BY field)
| chart count OVER status BY region
# Creates: status (rows), Atlantic/Eastern/Western (columns)

# With aggregation function
| chart avg(response_time) OVER store_id BY hour
# Shows average response time per store, broken down by hour

# Span option for time-based X-axis
| chart count OVER _time span=1h BY status


# EVENTSTATS - Add aggregations without collapsing rows
# ════════════════════════════════════════════════════════════════════════════

# Problem: I want to see each event AND the average for comparison
# Stats would collapse to one row per group - eventstats keeps all rows

index=pos_transactions
| eventstats avg(response_time) as avg_by_store by store_id
| eval deviation_from_avg = response_time - avg_by_store
| where deviation_from_avg > 100  # Transactions 100ms+ above store average

# Sobeys example: Find stores performing below regional average
index=pos_transactions earliest=-7d
| stats sum(amount) as store_revenue by region, store_id
| eventstats avg(store_revenue) as regional_avg by region
| eval pct_of_avg = round(store_revenue / regional_avg * 100, 1)
| where pct_of_avg < 80  # Stores at less than 80% of regional average


# STREAMSTATS - Running calculations
# ════════════════════════════════════════════════════════════════════════════

# Running total (cumulative sum)
| sort _time
| streamstats sum(amount) as running_total

# Moving average (last N events)
| sort _time
| streamstats avg(response_time) as moving_avg window=10

# Count events per user session
| sort user, _time
| streamstats count as event_in_session by user reset_after="secs > 1800"

# Time since previous event
| sort _time
| streamstats current=f last(_time) as prev_time
| eval gap_seconds = _time - prev_time


# COMPLEX PRODUCTION EXAMPLES
# ════════════════════════════════════════════════════════════════════════════

# Example 1: Sobeys Daily Store Performance Report
index=pos_transactions earliest=-24h
| stats count as transactions,
        sum(amount) as revenue,
        avg(amount) as avg_transaction,
        dc(customer_id) as unique_customers,
        sum(eval(if(status="failed",1,0))) as failed_transactions
by region, store_id, store_name
| eval success_rate = round((transactions - failed_transactions) / transactions * 100, 1)
| eval revenue = "$" . tostring(round(revenue, 2), "commas")
| sort region, -revenue
| table region, store_id, store_name, transactions, revenue, avg_transaction, unique_customers, success_rate

# Example 2: Security Anomaly Detection - Failed Logins
index=security sourcetype=wineventlog EventCode=4625 earliest=-24h
| bin _time span=1h
| stats count as failures by _time, src_ip
| eventstats avg(failures) as avg_failures, stdev(failures) as stdev_failures by src_ip
| eval zscore = (failures - avg_failures) / stdev_failures
| where zscore > 3  # More than 3 standard deviations above normal

# Example 3: Inventory Alert - Low Stock Detection
index=inventory earliest=-1h
| stats latest(quantity) as current_qty,
        latest(reorder_point) as reorder_level
by product_id, product_name, store_id
| where current_qty < reorder_level
| eval urgency = case(
    current_qty <= 0, "OUT_OF_STOCK",
    current_qty <= reorder_level * 0.25, "CRITICAL",
    current_qty <= reorder_level * 0.5, "LOW",
    true(), "REORDER"
)
| sort urgency, current_qty</code></pre>
                    </div>

                    <div class="info-box info-box-warning">
                        <h4><i class="fas fa-exclamation-triangle"></i> Exam Tip - Stats</h4>
                        <ul>
                            <li><strong>stats vs eventstats:</strong> stats collapses rows, eventstats adds columns</li>
                            <li><strong>dc() vs count():</strong> dc gives unique values, count gives total including duplicates</li>
                            <li><strong>BY clause order matters:</strong> First field = primary grouping</li>
                            <li><strong>chart OVER vs BY:</strong> OVER = X-axis, BY = series (stacked/split)</li>
                        </ul>
                    </div>
                </div>

                <!-- Domain 6: Comparing Values -->
                <h2><i class="fas fa-balance-scale"></i> Domain 6: Comparing Values (10%)</h2>
                
                <div class="config-section">
                    <h3>Eval Command & Functions</h3>
                    
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Eval Mastery for Production</span>
                        </div>
                        <pre><code># EVAL BASICS - Creating Calculated Fields
# ════════════════════════════════════════════════════════════════════════════

# Simple calculations
| eval total_bytes = bytes_in + bytes_out
| eval response_seconds = response_time / 1000
| eval tax_amount = subtotal * 0.15  # 15% HST for Nova Scotia

# String concatenation
| eval full_name = first_name . " " . last_name
| eval store_label = store_id . " - " . store_name

# Multiple evals in one command
| eval bytes_kb = bytes / 1024,
       bytes_mb = bytes / 1024 / 1024,
       size_category = case(bytes < 1024, "small", bytes < 1048576, "medium", true(), "large")


# CONDITIONAL LOGIC
# ════════════════════════════════════════════════════════════════════════════

# if(condition, true_value, false_value)
| eval status_label = if(status="200", "success", "failure")
| eval is_local = if(cidrmatch("10.0.0.0/8", src_ip), "internal", "external")

# case(condition1, value1, condition2, value2, ..., default)
| eval severity = case(
    status >= 500, "critical",
    status >= 400, "error",
    status >= 300, "warning",
    status >= 200, "success",
    true(), "unknown"
)

# Sobeys example: Categorize transaction amounts
| eval transaction_tier = case(
    amount >= 500, "high_value",
    amount >= 100, "medium",
    amount >= 20, "standard",
    true(), "small"
)

# coalesce - First non-null value
| eval user = coalesce(user, username, src_user, "unknown")

# nullif - Return null if condition met
| eval display_name = nullif(user, "SYSTEM")  # Shows null for SYSTEM accounts


# STRING FUNCTIONS
# ════════════════════════════════════════════════════════════════════════════

# Case manipulation
| eval user_lower = lower(user)
| eval user_upper = upper(user)

# Substring and length
| eval first_three = substr(store_id, 1, 3)  # "STR" from "STR-001"
| eval name_length = len(user)

# Replace and substitution
| eval clean_phone = replace(phone, "[^0-9]", "")  # Remove non-digits
| eval masked_card = replace(card_number, "(\d{4})(\d{8})(\d{4})", "xxxx-xxxx-xxxx-\3")

# Split (creates multivalue field)
| eval path_parts = split(url_path, "/")
| eval first_segment = mvindex(path_parts, 1)

# Trim whitespace
| eval clean_name = trim(name)
| eval clean_name = ltrim(rtrim(name))


# NUMERIC FUNCTIONS
# ════════════════════════════════════════════════════════════════════════════

# Rounding
| eval rounded = round(value, 2)     # 2 decimal places
| eval integer = floor(value)         # Round down
| eval integer = ceiling(value)       # Round up
| eval absolute = abs(value)          # Absolute value

# Math
| eval result = pow(base, exponent)   # Power
| eval result = sqrt(value)           # Square root
| eval result = log(value, 10)        # Logarithm

# Random (for sampling)
| eval random = random()              # 0 to 2147483647
| where random() % 100 < 10           # 10% sample


# COMPARISON OPERATORS
# ════════════════════════════════════════════════════════════════════════════

# Numeric comparisons
| where response_time > 1000
| where count >= 100 AND count <= 500
| where amount != 0

# String comparisons (case-sensitive!)
| where status = "success"
| where user != "SYSTEM"

# LIKE with wildcards
| where user LIKE "admin%"            # Starts with admin
| where email LIKE "%@sobeys.com"     # Ends with domain
| where path LIKE "%/api/%"           # Contains /api/

# IN for multiple values
| where status IN ("success", "completed", "ok")
| where EventCode IN (4624, 4625, 4634)

# Regular expressions
| where match(user, "^[A-Z]{2}\d{4}$")  # Matches pattern like "AB1234"
| rex field=url "\/(?<api_version>v\d+)\/"


# PRODUCTION PATTERNS
# ════════════════════════════════════════════════════════════════════════════

# Pattern 1: Flag anomalies
| eval is_anomaly = if(response_time > avg_response * 3, 1, 0)

# Pattern 2: Calculate percentages
| eval success_pct = round(success_count / total_count * 100, 1)

# Pattern 3: Bucket values
| eval time_bucket = case(
    hour >= 0 AND hour < 6, "overnight",
    hour >= 6 AND hour < 12, "morning",
    hour >= 12 AND hour < 18, "afternoon",
    true(), "evening"
)

# Pattern 4: Clean and normalize
| eval normalized_status = lower(trim(status))
| eval normalized_user = if(user="", null(), lower(user))

# Pattern 5: Risk scoring (Sobeys fraud detection)
| eval risk_score = 0
| eval risk_score = risk_score + if(amount > 1000, 30, 0)
| eval risk_score = risk_score + if(is_refund="yes", 20, 0)
| eval risk_score = risk_score + if(time_bucket="overnight", 25, 0)
| eval risk_score = risk_score + if(is_new_employee="yes", 15, 0)
| eval risk_level = case(risk_score >= 70, "high", risk_score >= 40, "medium", true(), "low")</code></pre>
                    </div>
                </div>

                <!-- Domain 8: Using Lookups -->
                <h2><i class="fas fa-search-plus"></i> Domain 8: Using Lookups (10%)</h2>
                
                <div class="config-section">
                    <h3>Lookup Tables for Enrichment</h3>
                    
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Lookup Configuration & Usage</span>
                        </div>
                        <pre><code># LOOKUP TYPES
# ════════════════════════════════════════════════════════════════════════════

# 1. CSV Lookup - Most common, static data
# File: lookups/store_info.csv
# store_id,store_name,region,province,manager,address
# STR-001,Halifax Downtown,Atlantic,NS,John Smith,123 Main St
# STR-002,Dartmouth Crossing,Atlantic,NS,Jane Doe,456 Oak Ave

# 2. KV Store Lookup - Dynamic, large datasets
# Collection: asset_inventory

# 3. External Lookup - Script-based (Python/shell)
# Script queries database or API in real-time


# LOOKUP COMMAND - Ad-hoc enrichment
# ════════════════════════════════════════════════════════════════════════════

# Basic lookup
index=pos_transactions
| lookup store_info store_id OUTPUT store_name, region, province, manager

# Lookup with field renaming
index=security
| lookup user_info username AS user OUTPUT department, title, manager

# Lookup with multiple match fields
| lookup store_info store_id, region OUTPUT manager

# Sobeys example: Enrich POS transactions with store details
index=pos_transactions earliest=-24h
| lookup store_info.csv store_id OUTPUT store_name, region, province, manager, store_type
| stats sum(amount) as revenue, count as transactions by region, store_name, store_type
| sort -revenue


# INPUTLOOKUP - Query lookup directly
# ════════════════════════════════════════════════════════════════════════════

# List all stores
| inputlookup store_info.csv

# Filter lookup
| inputlookup store_info.csv WHERE region="Atlantic"

# Join lookup with search results
index=pos_transactions earliest=-24h
| stats sum(amount) as revenue by store_id
| join store_id [| inputlookup store_info.csv]


# OUTPUTLOOKUP - Write to lookup
# ════════════════════════════════════════════════════════════════════════════

# Create/replace lookup
index=assets sourcetype=asset_inventory earliest=-24h
| stats latest(hostname) as hostname, latest(ip) as ip, latest(owner) as owner by asset_id
| outputlookup asset_cache.csv

# Append to existing lookup
| outputlookup append=true threat_intel.csv


# AUTOMATIC LOOKUPS - Configure in transforms.conf
# ════════════════════════════════════════════════════════════════════════════

# transforms.conf
[store_info_lookup]
filename = store_info.csv
match_type = EXACT
case_sensitive_match = false

# props.conf
[pos:transactions]
LOOKUP-store_enrichment = store_info_lookup store_id OUTPUT store_name region province manager

# Now every pos:transactions event automatically gets store details!


# SUBSEARCH WITH LOOKUP
# ════════════════════════════════════════════════════════════════════════════

# Find all events from high-revenue stores
index=pos_transactions earliest=-1h
    [| inputlookup store_info.csv 
     | where revenue_tier="high"
     | fields store_id
     | format]

# Find security events for VIP users
index=security 
    [| inputlookup vip_users.csv
     | fields user
     | format]


# PRODUCTION LOOKUP PATTERNS
# ════════════════════════════════════════════════════════════════════════════

# Pattern 1: Threat Intelligence Enrichment
index=firewall
| lookup threat_intel.csv src_ip AS src_ip OUTPUT threat_category, threat_score, source
| where isnotnull(threat_category)
| table _time, src_ip, dest_ip, threat_category, threat_score

# Pattern 2: Asset Context
index=security sourcetype=wineventlog
| lookup asset_inventory.csv hostname AS host OUTPUT asset_criticality, owner, department
| where asset_criticality="critical"

# Pattern 3: User Risk Scoring
index=security 
| lookup user_risk_scores.csv user OUTPUT risk_score, risk_factors
| eval combined_risk = risk_score + if(action="failure", 10, 0)

# Pattern 4: GeoIP Enrichment
index=web_logs
| iplocation src_ip  # Built-in GeoIP lookup
| stats count by Country, Region, City</code></pre>
                    </div>
                </div>

                <!-- Domain 9: Knowledge Objects -->
                <h2><i class="fas fa-brain"></i> Domain 9: Knowledge Objects (10%)</h2>
                
                <div class="config-section">
                    <h3>Event Types, Tags, and Macros</h3>
                    
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Knowledge Object Reference</span>
                        </div>
                        <pre><code># EVENT TYPES - Named searches for categorization
# ════════════════════════════════════════════════════════════════════════════

# eventtypes.conf
[successful_login]
search = sourcetype=wineventlog EventCode=4624

[failed_login]
search = sourcetype=wineventlog EventCode=4625

[sobeys_pos_transaction]
search = index=pos_transactions sourcetype=pos:transactions

[sobeys_high_value_transaction]
search = index=pos_transactions amount>500

# Using event types in searches
eventtype=failed_login
| stats count by user, src_ip

eventtype=sobeys_pos_transaction status=failed
| stats count by store_id


# TAGS - Labels for classification
# ════════════════════════════════════════════════════════════════════════════

# tags.conf
[eventtype=successful_login]
authentication = enabled
success = enabled

[eventtype=failed_login]
authentication = enabled
failure = enabled

[host=pos*]
point_of_sale = enabled
retail = enabled

# Using tags in searches
tag=authentication tag=failure
| stats count by user

tag=point_of_sale
| timechart count by status


# MACROS - Reusable search snippets
# ════════════════════════════════════════════════════════════════════════════

# macros.conf
[sobeys_pos_index]
definition = index=pos_transactions sourcetype=pos:transactions

[last_24h]
definition = earliest=-24h latest=now

[sobeys_stores(1)]
args = region
definition = [| inputlookup store_info.csv | where region="$region$" | fields store_id | format]

[calculate_success_rate]
definition = eval success_rate = round(success_count / total_count * 100, 2)

[risk_score_calculator]
definition = eval risk_score = case(\
    amount > 1000 AND is_refund="yes", 90,\
    amount > 1000, 60,\
    is_refund="yes" AND hour < 6, 70,\
    true(), 10)

# Using macros in searches
`sobeys_pos_index` `last_24h`
| stats count by status
| `calculate_success_rate`

`sobeys_pos_index` `sobeys_stores(Atlantic)`
| stats sum(amount) as revenue by store_id


# WORKFLOW ACTIONS - Context menu options
# ════════════════════════════════════════════════════════════════════════════

# workflow_actions.conf
[investigate_user]
display_location = field_menu
fields = user, src_user
label = Investigate User Activity
link.uri = /app/search/search?q=index=* user="$user$" earliest=-7d

[lookup_ip_reputation]
display_location = field_menu
fields = src_ip, dest_ip
label = Check IP Reputation
link.uri = https://virustotal.com/gui/ip-address/$src_ip$

[create_servicenow_incident]
display_location = event_menu
label = Create ServiceNow Incident
type = link
link.uri = https://instance.service-now.com/api/now/table/incident?description=$_raw$


# DATA MODELS - Structured schemas
# ════════════════════════════════════════════════════════════════════════════

# Data models provide:
# • Consistent field names across sources
# • Accelerated searches (summary indexing)
# • CIM compliance
# • Pivot interface support

# Key CIM Data Models:
# • Authentication - Login/logoff events
# • Change - Configuration/object changes
# • Endpoint - Process, registry, filesystem
# • Network Traffic - Firewall, proxy, IDS
# • Alerts - Security alerts
# • Web - HTTP traffic

# Using data models in searches
| datamodel Authentication Authentication_Attempt search
| where action="failure"
| stats count by user, src

# Tstats for accelerated data models (FAST!)
| tstats count FROM datamodel=Authentication WHERE nodename=Authentication.Failed_Authentication by Authentication.user, Authentication.src
| rename Authentication.* AS *


# KNOWLEDGE OBJECT PERMISSIONS
# ════════════════════════════════════════════════════════════════════════════

# Permission levels:
# • Private - Only creator can see/use
# • App - All users of the app
# • Global - All users across all apps

# Best practices:
# • Production objects should be App or Global scope
# • Use role-based permissions for sensitive objects
# • Document all knowledge objects
# • Version control with app export</code></pre>
                    </div>
                </div>

                <!-- Quick Reference Cards -->
                <h2><i class="fas fa-bookmark"></i> Quick Reference Cards</h2>
                
                <div class="config-section">
                    <h3>Exam Day Cheat Sheet</h3>
                    <div class="arch-diagram">
SPLUNK POWER USER QUICK REFERENCE
════════════════════════════════════════════════════════════════════════════════

TIME MODIFIERS
──────────────────────────────────────────────────────────────────────────────
-1h         Last hour               @d          Start of today
-24h        Last 24 hours           @w          Start of week (Sunday)
-7d         Last 7 days             @w1         Start of week (Monday)
-1mon       Last month              @mon        Start of month
-1y         Last year               @y          Start of year

STATISTICAL FUNCTIONS
──────────────────────────────────────────────────────────────────────────────
count(field)    Count non-null      dc(field)       Distinct count
sum(field)      Sum values          avg(field)      Average
min(field)      Minimum             max(field)      Maximum
values(field)   Unique values       list(field)     All values
first(field)    First value         last(field)     Last value
perc95(field)   95th percentile     stdev(field)    Standard deviation

EVAL FUNCTIONS
──────────────────────────────────────────────────────────────────────────────
if(X, Y, Z)         Conditional     case(X,Y,...)   Multi-conditional
coalesce(X,Y,...)   First non-null  round(X, Y)     Round to Y decimals
lower(X)/upper(X)   Case convert    substr(X,Y,Z)   Substring
len(X)              String length   replace(X,Y,Z)  Replace Y with Z
split(X,Y)          Split string    mvindex(X,Y)    MV element at index
tonumber(X)         To number       tostring(X)     To string
strftime(X,Y)       Format time     strptime(X,Y)   Parse time

COMPARISON OPERATORS
──────────────────────────────────────────────────────────────────────────────
=   Equal               !=  Not equal         >   Greater than
<   Less than           >=  Greater or equal  <=  Less or equal
AND Both conditions     OR  Either condition  NOT Negation
IN  In list            LIKE Wildcard match   match() Regex

SEARCH COMMANDS PIPELINE ORDER
──────────────────────────────────────────────────────────────────────────────
search → eval → where → stats → sort → head/tail → table/fields

LOOKUP COMMANDS
──────────────────────────────────────────────────────────────────────────────
| lookup file.csv key OUTPUT field1, field2
| inputlookup file.csv WHERE condition
| outputlookup file.csv [append=true]

STRFTIME FORMAT CODES
──────────────────────────────────────────────────────────────────────────────
%Y  4-digit year    %m  Month (01-12)   %d  Day (01-31)
%H  Hour (00-23)    %M  Minute          %S  Second
%A  Weekday name    %B  Month name      %Z  Timezone

KNOWLEDGE OBJECT TYPES
──────────────────────────────────────────────────────────────────────────────
Event Types     Named searches for categorization
Tags            Labels for classification (attached to event types)
Macros          Reusable search snippets with arguments
Lookups         Enrichment data from CSV/KV Store
Workflow Actions Context menu actions for fields/events
Data Models     Structured schemas for CIM compliance
                    </div>
                </div>

                <!-- Practice Questions -->
                <h2><i class="fas fa-question-circle"></i> Practice Questions</h2>
                
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q1: What's the difference between stats and eventstats?</button>
                        <div class="qa-answer">
                            <p><strong>stats:</strong> Aggregates and collapses results into summary rows. If you have 1000 events and run <code>| stats count by user</code>, you get one row per unique user.</p>
                            <p><strong>eventstats:</strong> Adds aggregation results as new fields to EVERY event without collapsing. Same 1000 events remain, but each now has a <code>count</code> field showing total for their user group.</p>
                            <p><strong>Use case:</strong> Use eventstats when you need to compare individual events to group aggregates (e.g., "show me events where response_time > average for that user").</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q2: How do you search for events from yesterday (full day)?</button>
                        <div class="qa-answer">
                            <p><code>earliest=-1d@d latest=@d</code></p>
                            <ul>
                                <li><code>-1d@d</code> = Go back 1 day, snap to start of that day (midnight yesterday)</li>
                                <li><code>@d</code> = Snap to start of today (midnight today)</li>
                            </ul>
                            <p>This gives you exactly 24 hours of yesterday's data.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q3: What's the correct order for these commands: stats, where, eval, sort?</button>
                        <div class="qa-answer">
                            <p><strong>Typical order:</strong> eval → where → stats → sort</p>
                            <ol>
                                <li><strong>eval</strong> - Create calculated fields first (you may need them for filtering)</li>
                                <li><strong>where</strong> - Filter events before aggregating (more efficient)</li>
                                <li><strong>stats</strong> - Aggregate the filtered results</li>
                                <li><strong>sort</strong> - Order the aggregated results</li>
                            </ol>
                            <p>However, you can have multiple evals/wheres throughout - this is the general pattern.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q4: How do you create a field alias vs a calculated field?</button>
                        <div class="qa-answer">
                            <p><strong>Field Alias (props.conf):</strong> Creates alternative name for existing field</p>
                            <pre><code>FIELDALIAS-user = username AS user</code></pre>
                            
                            <p><strong>Calculated Field (props.conf):</strong> Creates new field from eval expression</p>
                            <pre><code>EVAL-response_ms = response_time * 1000</code></pre>
                            
                            <p><strong>Key difference:</strong> Alias just renames; calculated field runs eval expression for every event.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q5: What's the difference between timechart and chart?</button>
                        <div class="qa-answer">
                            <p><strong>timechart:</strong> X-axis is ALWAYS _time. Automatically bins by time.</p>
                            <pre><code>| timechart span=1h count by status</code></pre>
                            
                            <p><strong>chart:</strong> X-axis can be any field (use OVER). More flexible.</p>
                            <pre><code>| chart count OVER status BY region</code></pre>
                            
                            <p><strong>When to use which:</strong></p>
                            <ul>
                                <li>Time-series analysis → timechart</li>
                                <li>Categorical comparison → chart</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Related Resources -->
                <h2><i class="fas fa-link"></i> Related Resources</h2>
                <ul>
                    <li><a href="spl-fundamentals.html">SPL Fundamentals - Deep Dive</a></li>
                    <li><a href="spl-intermediate.html">SPL Intermediate Techniques</a></li>
                    <li><a href="spl-advanced.html">SPL Advanced Patterns</a></li>
                    <li><a href="knowledge-objects.html">Knowledge Objects Reference</a></li>
                    <li><a href="data-models.html">Data Models & CIM Guide</a></li>
                </ul>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>
