<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troubleshooting | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">


</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo"><i class="fas fa-terminal"></i><span>Splunk Reference</span></a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certifications</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-user-graduate" style="color:#7ce38b"></i>Power User<span class="sidebar-badge" style="color:#7ce38b">SPLK-1002</span></a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog" style="color:#f0883e"></i>Admin<span class="sidebar-badge" style="color:#f0883e">SPLK-1003</span></a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt" style="color:#8957e5"></i>ES Admin<span class="sidebar-badge" style="color:#8957e5">SPLK-3001</span></a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud" style="color:#39c5cf"></i>Cloud Admin<span class="sidebar-badge" style="color:#39c5cf">SPLK-1004</span></a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL & Searching</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-code"></i>SPL Fundamentals</a></li>
                        <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-layer-group"></i>SPL Intermediate</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i>SPL Advanced</a></li>
                        <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-lightbulb"></i>Knowledge Objects</a></li>
                        <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i>Data Models</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Practice</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-practice-questions.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i>SPL MCQs (60Q)</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced-mcqs.html" class="sidebar-nav-link"><i class="fas fa-brain"></i>Advanced MCQs (30Q)</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Administration</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i>Architecture</a></li>
                        <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i>Data Ingestion</a></li>
                        <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-share-alt"></i>Forwarders</a></li>
                        <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i>Parsing & Flows</a></li>
                        <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i>Clustering & HA</a></li>
                        <li class="sidebar-nav-item"><a href="security-rbac.html" class="sidebar-nav-link"><i class="fas fa-user-lock"></i>Security & RBAC</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Enterprise Security</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i>ES Overview</a></li>
                        <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search-plus"></i>Correlation Searches</a></li>
                        <li class="sidebar-nav-item"><a href="notable-events.html" class="sidebar-nav-link"><i class="fas fa-exclamation-triangle"></i>Notable Events</a></li>
                        <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i>Risk-Based Alerting</a></li>
                        <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i>Threat Intelligence</a></li>
                        <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-binoculars"></i>Threat Hunting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Cloud & Automation</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i>Splunk Cloud</a></li>
                        <li class="sidebar-nav-item"><a href="soar.html" class="sidebar-nav-link"><i class="fas fa-robot"></i>SOAR</a></li>
                        <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-pie"></i>Dashboards</a></li>
                        <li class="sidebar-nav-item"><a href="alerting-actions.html" class="sidebar-nav-link"><i class="fas fa-bell"></i>Alerting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Resources</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="lab-exercises.html" class="sidebar-nav-link"><i class="fas fa-flask"></i>Lab Exercises</a></li>
                        <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i>Enterprise Scenarios</a></li>
                        <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link active"><i class="fas fa-wrench"></i>Troubleshooting</a></li>
                    </ul>
                </div>
            </div>
        </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Troubleshooting</span>
                </div>

                <h1><i class="fas fa-wrench"></i> Troubleshooting</h1>
                <p class="lead">Common Splunk issues and how to diagnose and resolve them. Covers forwarder problems, search issues, performance tuning, and health monitoring.</p>

                <!-- Internal Indexes -->
                <h2><i class="fas fa-database"></i> Internal Indexes for Troubleshooting</h2>
                <div class="config-section">
                    <table class="styled-table">
                        <thead>
                            <tr><th>Index</th><th>Contains</th><th>Use For</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>_internal</td><td>Splunk internal logs</td><td>Errors, warnings, component status</td></tr>
                            <tr><td>_audit</td><td>Audit events</td><td>User activity, search history</td></tr>
                            <tr><td>_introspection</td><td>Performance metrics</td><td>Resource usage, queue depths</td></tr>
                            <tr><td>_metrics</td><td>Indexer metrics</td><td>Throughput, parsing stats</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Data Not Appearing -->
                <h2><i class="fas fa-eye-slash"></i> Data Not Appearing</h2>
                <div class="issue-card">
                    <h4>Issue: No data from forwarder</h4>
                    <div class="arch-diagram"># Check if forwarder is connected
index=_internal source=*metrics.log group=tcpin_connections
| stats latest(connectionType) latest(status) by hostname

# Check forwarder queue status
index=_internal source=*metrics.log group=queue
| eval fill_perc = round(current_size_kb/max_size_kb*100, 2)
| stats latest(fill_perc) by name, hostname

# Check for data reaching indexer
index=_internal source=*splunkd.log component=TcpInputProc
| stats count by host, action</div>
                </div>

                <div class="issue-card">
                    <h4>Issue: Wrong sourcetype or index</h4>
                    <div class="arch-diagram"># Check what sourcetypes are being received
| metadata type=sourcetypes index=* | table sourcetype, totalCount, lastTime

# Check props.conf processing
$SPLUNK_HOME/bin/splunk btool props list --debug | grep -i "sourcetype"

# Verify inputs.conf
$SPLUNK_HOME/bin/splunk btool inputs list --debug</div>
                </div>

                <div class="config-section">
                    <h4>Forwarder Checklist</h4>
                    <ul style="color: #8b949e;">
                        <li>âœ… Forwarder service running: <code>splunk status</code></li>
                        <li>âœ… outputs.conf points to correct indexers</li>
                        <li>âœ… inputs.conf has correct monitors enabled</li>
                        <li>âœ… File permissions allow Splunk to read source files</li>
                        <li>âœ… Network connectivity to indexer port (usually 9997)</li>
                        <li>âœ… SSL certificates valid (if using encryption)</li>
                    </ul>
                </div>

                <!-- Search Performance -->
                <h2><i class="fas fa-tachometer-alt"></i> Search Performance</h2>
                <div class="issue-card">
                    <h4>Issue: Slow searches</h4>
                    <div class="arch-diagram"># Check search job inspector
# In Splunk UI: Job â†’ Inspect Job â†’ Execution Costs

# Review search.log for a specific search
index=_audit action=search info=completed
| where search_id="xxx"
| table user, search, total_run_time, scan_count

# Find expensive searches
index=_audit action=search info=completed
| stats avg(total_run_time) as avg_runtime, count by user, savedsearch_name
| where avg_runtime > 60
| sort - avg_runtime</div>
                </div>

                <div class="config-section">
                    <h4>Search Optimization Tips</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Specify index:</strong> Always include <code>index=</code></li>
                        <li><strong>Narrow time:</strong> Use shortest time range possible</li>
                        <li><strong>Filter early:</strong> Put most restrictive filters first</li>
                        <li><strong>Use tstats:</strong> For data model searches (10-100x faster)</li>
                        <li><strong>Avoid wildcards:</strong> <code>*error</code> is slow, <code>error</code> is fast</li>
                        <li><strong>Limit fields:</strong> Use <code>fields</code> command early</li>
                    </ul>
                </div>

                <!-- Indexer Issues -->
                <h2><i class="fas fa-server"></i> Indexer Issues</h2>
                <div class="issue-card">
                    <h4>Issue: Indexer queue blocking</h4>
                    <div class="arch-diagram"># Check queue fill levels
index=_internal source=*metrics.log group=queue
| eval fill_perc = round(current_size_kb/max_size_kb*100, 2)
| where fill_perc > 80
| stats latest(fill_perc) by name, host

# Critical queues to monitor:
# - parsingQueue: Input parsing
# - aggQueue: Aggregation
# - typingQueue: Event typing
# - indexQueue: Writing to disk</div>
                </div>

                <div class="issue-card">
                    <h4>Issue: Disk space low</h4>
                    <div class="arch-diagram"># Check index sizes
| rest /services/data/indexes
| table title, currentDBSizeMB, maxTotalDataSizeMB, frozenTimePeriodInSecs

# Find large buckets
| dbinspect index=* | stats sum(sizeOnDiskMB) as sizeMB by index | sort - sizeMB

# Check disk usage
index=_introspection component=Disk
| stats latest(data.available) as available_gb by host</div>
                </div>

                <!-- License Issues -->
                <h2><i class="fas fa-key"></i> License Issues</h2>
                <div class="issue-card">
                    <h4>Issue: License violation warning</h4>
                    <div class="arch-diagram"># Check daily license usage
index=_internal source=*license_usage.log type=Usage
| timechart span=1d sum(b) as bytes
| eval GB = round(bytes/1024/1024/1024, 2)

# Usage by index
index=_internal source=*license_usage.log type=Usage
| stats sum(b) as bytes by idx
| eval GB = round(bytes/1024/1024/1024, 2)
| sort - GB

# Check license pool status
| rest /services/licenser/pools
| table title, used_bytes, effective_quota</div>
                </div>

                <!-- CLI Commands -->
                <h2><i class="fas fa-terminal"></i> Essential CLI Commands</h2>
                <div class="config-section">
                    <div class="arch-diagram"># Service control
$SPLUNK_HOME/bin/splunk start
$SPLUNK_HOME/bin/splunk stop
$SPLUNK_HOME/bin/splunk restart

# Check status
$SPLUNK_HOME/bin/splunk status
$SPLUNK_HOME/bin/splunk list forward-server
$SPLUNK_HOME/bin/splunk list deploy-poll

# Configuration troubleshooting
$SPLUNK_HOME/bin/splunk btool inputs list --debug
$SPLUNK_HOME/bin/splunk btool props list --debug
$SPLUNK_HOME/bin/splunk btool outputs list --debug
$SPLUNK_HOME/bin/splunk btool check

# Cluster status
$SPLUNK_HOME/bin/splunk show cluster-status
$SPLUNK_HOME/bin/splunk show shcluster-status

# Reload configurations
$SPLUNK_HOME/bin/splunk reload deploy-server</div>
                </div>

                <!-- Log Files -->
                <h2><i class="fas fa-file-alt"></i> Key Log Files</h2>
                <div class="config-section">
                    <table class="styled-table">
                        <thead>
                            <tr><th>Log</th><th>Location</th><th>Contains</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>splunkd.log</td><td>$SPLUNK_HOME/var/log/splunk/</td><td>Main daemon log, errors, warnings</td></tr>
                            <tr><td>metrics.log</td><td>$SPLUNK_HOME/var/log/splunk/</td><td>Performance metrics, queues</td></tr>
                            <tr><td>scheduler.log</td><td>$SPLUNK_HOME/var/log/splunk/</td><td>Scheduled search execution</td></tr>
                            <tr><td>web_access.log</td><td>$SPLUNK_HOME/var/log/splunk/</td><td>UI access logs</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Health Check -->
                <h2><i class="fas fa-heartbeat"></i> Health Monitoring</h2>
                <div class="config-section">
                    <div class="console-path">Settings â†’ Monitoring Console</div>
                    
                    <h4>Key Dashboards</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Indexing Performance:</strong> Throughput, queue sizes</li>
                        <li><strong>Search Activity:</strong> Concurrent searches, completion times</li>
                        <li><strong>Forwarder Monitoring:</strong> Connection status, data rates</li>
                        <li><strong>License Usage:</strong> Daily usage vs limit</li>
                        <li><strong>Resource Usage:</strong> CPU, memory, disk I/O</li>
                    </ul>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Troubleshooting Decision Trees</h2>
                <div class="config-section">
                    <h3>Decision Tree: Data Not Appearing in Splunk</h3>
                    <div class="arch-diagram">DATA NOT APPEARING IN SPLUNK
â”‚
â”œâ”€ Step 1: IS DATA BEING COLLECTED?
â”‚   â”‚
â”‚   â”œâ”€ Check forwarder status:
â”‚   â”‚   splunk status (or services.msc on Windows)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ NOT RUNNING â†’ Start service, check startup logs
â”‚   â”‚   â””â”€ RUNNING â†’ Continue to Step 2
â”‚   â”‚
â”‚   â””â”€ Check input configuration:
â”‚       splunk btool inputs list --debug
â”‚       â”‚
â”‚       â”œâ”€ Input NOT listed â†’ Check inputs.conf syntax
â”‚       â””â”€ Input listed â†’ Verify monitor path exists
â”‚
â”œâ”€ Step 2: IS DATA BEING SENT?
â”‚   â”‚
â”‚   â”œâ”€ Check outputs configuration:
â”‚       splunk list forward-server
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ No active connections â†’ Network/firewall issue
â”‚   â”‚   â””â”€ Active connections â†’ Continue to Step 3
â”‚   â”‚
â”‚   â””â”€ Check _internal for send errors:
â”‚       index=_internal host=forwarder TcpOutputProc ERROR
â”‚       â”‚
â”‚       â”œâ”€ SSL errors â†’ Certificate mismatch
â”‚       â”œâ”€ Connection refused â†’ Port blocked or indexer down
â”‚       â””â”€ No errors â†’ Data is being sent
â”‚
â”œâ”€ Step 3: IS DATA BEING RECEIVED?
â”‚   â”‚
â”‚   â”œâ”€ On indexer, check receiving:
â”‚       index=_internal source=*metrics.log group=tcpin_connections
â”‚       â”‚
â”‚       â”œâ”€ Forwarder NOT listed â†’ Network issue, forwarder config
â”‚       â””â”€ Forwarder listed â†’ Continue to Step 4
â”‚   â”‚
â”‚   â””â”€ Check indexer queues:
â”‚       index=_internal source=*metrics.log group=queue
â”‚       â”‚
â”‚       â””â”€ Queue backed up â†’ Indexer performance issue
â”‚
â””â”€ Step 4: IS DATA BEING INDEXED?
    â”‚
    â”œâ”€ Check if arriving but wrong index:
    â”‚   index=* host=expected_host earliest=-1h
    â”‚   â”‚
    â”‚   â”œâ”€ Data in wrong index â†’ Check props.conf routing
    â”‚   â””â”€ No data anywhere â†’ Parsing issue
    â”‚
    â””â”€ Check parsing:
        index=_internal sourcetype=splunkd component=LineBreaker
        â”‚
        â”œâ”€ Linebreaking errors â†’ Check SHOULD_LINEMERGE, LINE_BREAKER
        â””â”€ Timestamp errors â†’ Check TIME_FORMAT, TIME_PREFIX</div>

                    <h3>Decision Tree: Search Performance Issues</h3>
                    <div class="arch-diagram">SEARCH IS SLOW OR TIMING OUT
â”‚
â”œâ”€ Step 1: IDENTIFY the bottleneck
â”‚   â”‚
â”‚   â”œâ”€ Check search.log (Job Inspector):
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ High "command.X" time â†’ SPL inefficiency
â”‚   â”‚   â”‚   â”œâ”€ stats vs transaction
â”‚   â”‚   â”‚   â”œâ”€ subsearch limits
â”‚   â”‚   â”‚   â””â”€ join performance
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ High "search" time â†’ Too much data scanned
â”‚   â”‚   â”‚   â”œâ”€ Add time bounds
â”‚   â”‚   â”‚   â”œâ”€ Specify index and sourcetype
â”‚   â”‚   â”‚   â””â”€ Filter earlier in pipeline
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ High "dispatch" time â†’ Resource contention
â”‚   â”‚       â”œâ”€ Concurrent search limits
â”‚   â”‚       â””â”€ Memory pressure
â”‚   â”‚
â”‚   â””â”€ Check Monitoring Console:
â”‚       â†’ Search Activity dashboard
â”‚       â”‚
â”‚       â”œâ”€ Many concurrent searches â†’ Queue forming
â”‚       â””â”€ High scan count â†’ Search optimization needed
â”‚
â”œâ”€ Step 2: SPL OPTIMIZATION
â”‚   â”‚
â”‚   â”œâ”€ Add time bounds: earliest=-24h latest=now
â”‚   â”œâ”€ Specify index: index=security (not index=*)
â”‚   â”œâ”€ Use tstats when possible
â”‚   â”œâ”€ Filter early: | where AFTER stats, not before
â”‚   â””â”€ Avoid: Leading wildcards, transaction on large data
â”‚
â””â”€ Step 3: INFRASTRUCTURE
    â”‚
    â”œâ”€ Check search head resources:
    â”‚   top, htop, free -m
    â”‚
    â”œâ”€ Check indexer cluster health:
    â”‚   | rest /services/cluster/master/peers
    â”‚
    â””â”€ Consider: Summary indexing for repeated searches</div>

                    <h3>Decision Tree: License Violation Troubleshooting</h3>
                    <div class="arch-diagram">LICENSE WARNING OR VIOLATION
â”‚
â”œâ”€ Step 1: IDENTIFY source of overage
â”‚   â”‚
â”‚   â”œâ”€ By index:
â”‚   â”‚   index=_internal source=*license_usage.log type=Usage
â”‚   â”‚   | stats sum(b) as bytes by idx
â”‚   â”‚   | eval GB = round(bytes/1024/1024/1024, 2)
â”‚   â”‚   | sort -GB
â”‚   â”‚
â”‚   â””â”€ By sourcetype:
â”‚       index=_internal source=*license_usage.log type=Usage
â”‚       | stats sum(b) as bytes by st
â”‚       | eval GB = round(bytes/1024/1024/1024, 2)
â”‚       | sort -GB
â”‚
â”œâ”€ Step 2: UNDERSTAND the spike
â”‚   â”‚
â”‚   â”œâ”€ New data source added? â†’ Expected increase
â”‚   â”œâ”€ Misconfigured input? â†’ Collecting too much data
â”‚   â”œâ”€ One-time burst? â†’ Large log file, historical backfill
â”‚   â””â”€ Debug logging enabled? â†’ Disable and filter
â”‚
â”œâ”€ Step 3: REMEDIATION options
â”‚   â”‚
â”‚   â”œâ”€ IMMEDIATE (reduce today's usage):
â”‚   â”‚   â”œâ”€ Disable verbose/debug sources
â”‚   â”‚   â”œâ”€ Apply blacklist filters at inputs
â”‚   â”‚   â””â”€ Temporarily disable non-critical sources
â”‚   â”‚
â”‚   â””â”€ LONG-TERM:
â”‚       â”œâ”€ Optimize filtering in inputs.conf
â”‚       â”œâ”€ Use nullQueue for unwanted events
â”‚       â”œâ”€ Negotiate license increase
â”‚       â””â”€ Move to summary indexing for reports
â”‚
â””â”€ VIOLATION IMPACT:
    â”‚
    â”œâ”€ Warning 1-4 â†’ No impact, resolve quickly
    â””â”€ Warning 5+ within 30 days â†’ Search disabled until resolved</div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                <div class="enterprise-gaps">
                    <div class="gap-grid">
                        <div class="gap-category critical">
                            <h4>ğŸ”´ Critical Gaps</h4>
                            <ul>
                                <li><strong>No proactive monitoring:</strong> Problems discovered by users, not monitoring</li>
                                <li><strong>No runbooks:</strong> Ad-hoc troubleshooting, inconsistent approaches</li>
                                <li><strong>Missing _internal access:</strong> Security team can't troubleshoot their own data</li>
                                <li><strong>No baseline metrics:</strong> Can't tell normal from abnormal performance</li>
                                <li><strong>Ignored warnings:</strong> splunkd.log warnings accumulate without investigation</li>
                            </ul>
                        </div>
                        <div class="gap-category warning">
                            <h4><i class="fas fa-exclamation-triangle"></i> Operational Gaps</h4>
                            <ul>
                                <li><strong>No monitoring console setup:</strong> DMC not configured for distributed environment</li>
                                <li><strong>Incomplete forwarder tracking:</strong> No inventory of expected forwarders</li>
                                <li><strong>No search quotas:</strong> Heavy searches impact all users</li>
                                <li><strong>Log rotation issues:</strong> splunkd.log fills disk</li>
                                <li><strong>No escalation path:</strong> Unclear who handles infrastructure issues</li>
                            </ul>
                        </div>
                        <div class="gap-category info">
                            <h4><i class="fas fa-info-circle"></i> Troubleshooting Skill Gaps</h4>
                            <ul>
                                <li><strong>btool underused:</strong> Configuration errors could be caught earlier</li>
                                <li><strong>Job Inspector ignored:</strong> Search optimization opportunities missed</li>
                                <li><strong>_internal underutilized:</strong> Rich troubleshooting data not leveraged</li>
                                <li><strong>No REST API knowledge:</strong> Powerful diagnostics unavailable</li>
                                <li><strong>Parsing pipeline misunderstood:</strong> Props/transforms issues take too long to resolve</li>
                            </ul>
                        </div>
                        <div class="gap-category best-practice">
                            <h4><i class="fas fa-check-circle"></i> Best Practices Often Ignored</h4>
                            <ul>
                                <li><strong>Daily health checks:</strong> Quick review of key metrics</li>
                                <li><strong>Saved troubleshooting searches:</strong> Pre-built diagnostics ready to run</li>
                                <li><strong>Documented known issues:</strong> Common problems and solutions captured</li>
                                <li><strong>Test environment:</strong> Reproduce issues without impacting production</li>
                                <li><strong>Splunk Support engagement:</strong> Know when to escalate vs self-solve</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- SOBEYS-SPECIFIC TROUBLESHOOTING RUNBOOKS -->
                <h2><i class="fas fa-store"></i> Sobeys Enterprise Troubleshooting Runbooks</h2>
                <div class="config-section">
                    <p>Production troubleshooting scenarios for Sobeys' 1,500+ store retail environment.</p>

                    <h3>Runbook 1: POS Data Not Appearing from Store</h3>
                    <div class="arch-diagram">
SCENARIO: Store manager reports POS data missing from dashboards
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: IDENTIFY SCOPE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check if data was ever received from this store `
| metadata type=sourcetypes index=pos_transactions 
| where sourcetype="sobeys:pos:transaction"
| search source="*STR-0001*"

` Check last event time for the store `
index=pos_transactions store_id="STR-0001" 
| stats latest(_time) as last_event, count as events_last_24h
| eval hours_since_data = round((now() - last_event) / 3600, 1)

` Compare to peer stores in same region `
index=pos_transactions earliest=-4h
| stats count by store_id
| eventstats avg(count) as region_avg
| eval deviation = round((count - region_avg) / region_avg * 100, 1)
| sort deviation

STEP 2: CHECK FORWARDER CONNECTIVITY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` On indexer: Check for incoming connections from store `
index=_internal sourcetype=splunkd component=TcpInputProc 
  host="*STR-0001*" OR host="pos-str0001*"
| stats count by host, sourceIp
| sort -count

` Check for connection errors `
index=_internal sourcetype=splunkd component=TcpInputProc 
  "connection" ("refused" OR "reset" OR "timeout")
  host="*STR-0001*"
| table _time, host, message

` On UF (if accessible): Check forwarding status `
./splunk list forward-server
./splunk btool outputs list --debug

STEP 3: CHECK PARSING AT HEAVY FORWARDER (if used)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check HF parsing metrics `
index=_internal host="hf-*" sourcetype=splunkd 
  group=per_sourcetype_thruput series="sobeys:pos:transaction"
| timechart span=1h sum(kb) as kb_ingested by host

` Look for parsing errors `
index=_internal host="hf-*" sourcetype=splunkd 
  component=LineBreakingProcessor OR component=DateParser
  (ERROR OR WARN)
  source="*STR-0001*"
| table _time, host, component, message

STEP 4: CHECK HEC (if POS uses HEC)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check HEC events `
index=_internal sourcetype=splunkd component=HttpInputDataHandler
| stats count by status
| sort -count

` Check for HEC errors `
index=_internal sourcetype=splunkd component=HttpInputDataHandler
  status!=200
| stats count by status, message
| sort -count

` Check HEC token validity `
index=_internal sourcetype=splunkd component=HttpInputDataHandler
  "authentication failed" OR "invalid token"
| table _time, sourceIp, message

STEP 5: NETWORK ISSUES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Common network issues at retail stores:
â–¡ Store network outage (check with NOC)
â–¡ Firewall blocking outbound 9997/8088 (HEC)
â–¡ MPLS/VPN tunnel down
â–¡ DNS resolution failure
â–¡ MTU issues causing packet fragmentation

Test connectivity:
telnet indexer.sobeys.com 9997
curl -k https://hec.sobeys.com:8088/services/collector/health

RESOLUTION OPTIONS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. If forwarder issue â†’ Restart UF service on store POS controller
2. If network issue â†’ Escalate to Network team with store ID
3. If parsing issue â†’ Check props.conf/transforms.conf on HF
4. If HEC issue â†’ Verify token, check HEC health
5. If still missing â†’ Historical backfill may be needed
                    </div>

                    <h3>Runbook 2: Splunk Search Performance Degradation</h3>
                    <div class="arch-diagram">
SCENARIO: Analysts report searches taking 10x longer than normal
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: IDENTIFY IMPACT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check search queue status `
index=_internal sourcetype=scheduler status=*
| stats count by status

` Check current running searches `
| rest /services/search/jobs
| where dispatchState="RUNNING"
| eval runtime_min = round(runDuration/60, 1)
| table label, search, user, runtime_min
| sort -runtime_min

` Check resource utilization on search heads `
index=_introspection sourcetype=splunk_resource_usage component=Hostwide
| stats latest(data.cpu_user_pct) as cpu, latest(data.mem_used) as mem_gb by host
| eval mem_gb = round(mem_gb/1024/1024/1024, 1)

STEP 2: IDENTIFY HEAVY SEARCHES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Find searches consuming most resources `
index=_audit action=search info=completed
| stats 
    avg(total_run_time) as avg_runtime,
    max(total_run_time) as max_runtime,
    sum(scan_count) as total_events_scanned,
    count as executions
    by savedsearch_name, user
| where avg_runtime > 60
| sort -avg_runtime

` Find searches with bad patterns `
index=_audit action=search info=completed search="*"
| rex field=search "index=(?<searched_index>\S+)"
| where searched_index="*" OR isnull(searched_index)
| stats count by user, search
| sort -count

` Check scheduled search load `
index=_internal sourcetype=scheduler savedsearch_name=* status=*
| stats count by savedsearch_name, status
| sort -count

STEP 3: CHECK INDEXER CLUSTER HEALTH
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check indexer peer status `
| rest /services/cluster/master/peers splunk_server=cluster_master
| table title, status, site, is_searchable, search_state_counter

` Check for bucket replication issues `
index=_internal sourcetype=splunkd component=CMPeer
| stats count by action, status
| sort -count

` Check for hot bucket roll issues `
index=_internal sourcetype=splunkd component=HotDBManager
| where log_level="ERROR" OR log_level="WARN"
| stats count by message
| sort -count

STEP 4: WORKLOAD MANAGEMENT CHECK
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check workload pool utilization `
| rest /services/workloads/pools
| table title, cpu_weight, mem_weight, default_category, ingest_pool

` Check if searches are being queued `
index=_internal sourcetype=scheduler status="deferred"
| stats count by savedsearch_name
| sort -count

REMEDIATION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
IMMEDIATE:
â–¡ Kill long-running ad-hoc searches (| rest /services/search/jobs | ... | kill)
â–¡ Disable heavy correlation searches temporarily
â–¡ Contact users running bad searches

SHORT-TERM:
â–¡ Add search quotas to limit concurrent searches
â–¡ Optimize top offending searches
â–¡ Enable workload management if not already
â–¡ Consider search head clustering if single SH

LONG-TERM:
â–¡ Mandatory search training for analysts
â–¡ Search review process for saved searches
â–¡ Performance SLAs for scheduled searches
â–¡ Summary indexing for repeated queries
                    </div>

                    <h3>Runbook 3: License Warning/Violation</h3>
                    <div class="arch-diagram">
SCENARIO: License warning email received, 85% daily capacity used
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: IDENTIFY SOURCE OF INCREASE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Daily license usage trend `
index=_internal source=*license_usage.log type=Usage
| timechart span=1d sum(b) as bytes
| eval GB = round(bytes/1024/1024/1024, 2)
| table _time, GB

` Usage by index (find the culprit) `
index=_internal source=*license_usage.log type=Usage earliest=-24h
| stats sum(b) as bytes by idx
| eval GB = round(bytes/1024/1024/1024, 2)
| sort -GB

` Usage by sourcetype within index `
index=_internal source=*license_usage.log type=Usage earliest=-24h
| stats sum(b) as bytes by idx, st
| eval GB = round(bytes/1024/1024/1024, 2)
| sort -GB
| head 20

` Usage by host (find specific source) `
index=_internal source=*license_usage.log type=Usage earliest=-24h idx="pos_transactions"
| stats sum(b) as bytes by h
| eval GB = round(bytes/1024/1024/1024, 2)
| sort -GB
| head 20

STEP 2: IDENTIFY ROOT CAUSE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Common causes at Sobeys:
â–¡ New store rollout (legitimate increase)
â–¡ Debug logging enabled on POS systems
â–¡ Historical data backfill
â–¡ Verbose error logging from application issue
â–¡ Duplicate data collection paths
â–¡ Firewall log verbosity increased

` Check for recent changes `
index=_audit action=edit (object_type="props" OR object_type="inputs")
| table _time, user, object_type, object_name, action

` Check for new data sources `
| metadata type=sourcetypes index=* 
| eval first_seen = strftime(firstTime, "%Y-%m-%d")
| where firstTime > relative_time(now(), "-7d")
| table sourcetype, totalCount, first_seen

STEP 3: IMMEDIATE REMEDIATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
OPTION A: Filter at Forwarder
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# inputs.conf - reduce verbose logging
[monitor:///var/log/pos/debug.log]
blacklist = (DEBUG|TRACE)

# props.conf - drop events at parse time  
[sobeys:pos:transaction]
TRANSFORMS-drop = drop_debug_events

# transforms.conf
[drop_debug_events]
REGEX = ^DEBUG|^TRACE
DEST_KEY = queue
FORMAT = nullQueue

OPTION B: Index-Time Filtering (ingest actions for Cloud)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ingest Actions â†’ Create Rule:
- Filter: sourcetype=sobeys:pos:debug
- Action: Drop events
- Or: Route to lower-retention index

OPTION C: Temporary Disable
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Temporarily disable verbose source
[monitor:///var/log/pos/debug.log]
disabled = true

SOBEYS LICENSE ALLOCATION (example):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total License: 500 GB/day
â€¢ POS Transactions: 200 GB (40%)
â€¢ Network/Firewall: 100 GB (20%)
â€¢ Windows Events: 80 GB (16%)
â€¢ Cloud (O365/AWS): 50 GB (10%)
â€¢ SAP: 30 GB (6%)
â€¢ Misc: 40 GB (8%)
                    </div>

                    <h3>Runbook 4: Forwarder Deployment Issue</h3>
                    <div class="arch-diagram">
SCENARIO: 50 new UFs deployed but not checking in
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: VERIFY DEPLOYMENT SERVER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check deployment server status `
| rest /services/deployment/server/clients
| stats count as total_clients, 
        count(eval(match(hostname, "POS.*"))) as pos_clients

` Check server class membership `
| rest /services/deployment/server/serverclasses
| table title, filterType, whitelist, blacklist

` Check client check-in status `
| rest /services/deployment/server/clients
| eval last_checkin = strftime(strptime(lastPhoneHomeTime, "%a %b %d %H:%M:%S %Y"), "%Y-%m-%d %H:%M")
| eval hours_since = round((now() - strptime(lastPhoneHomeTime, "%a %b %d %H:%M:%S %Y")) / 3600, 1)
| where hours_since > 1
| table hostname, ip, hours_since, applications
| sort -hours_since

STEP 2: CHECK FOR COMMON DEPLOYMENT ISSUES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
On new forwarders (via SSH/remote):

# Check splunk is running
systemctl status SplunkForwarder

# Check deployment client config
./splunk show deploy-poll

# Check for deployment errors
cat $SPLUNK_HOME/var/log/splunk/splunkd.log | grep -i "deploy"

# Verify DNS resolution
nslookup deployment-server.sobeys.com

# Test connectivity
telnet deployment-server.sobeys.com 8089

STEP 3: SERVERCLASS CONFIGURATION ISSUES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# serverclass.conf example for Sobeys
[global]
repositoryLocation = $SPLUNK_HOME/etc/deployment-apps

[serverClass:Sobeys_POS_Stores]
whitelist.0 = pos-*
whitelist.1 = POS-*

[serverClass:Sobeys_POS_Stores:app:Splunk_TA_POS]
restartSplunkd = true

[serverClass:Sobeys_POS_Stores:app:Sobeys_POS_Inputs]
restartSplunkd = true

COMMON ISSUES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Hostname doesn't match whitelist pattern
â–¡ deploymentclient.conf has wrong server URI
â–¡ Firewall blocking 8089 outbound
â–¡ DNS not resolving deployment server
â–¡ Certificate mismatch (if using SSL)
â–¡ Deployment server overloaded (check resource usage)

REMEDIATION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Fix hostname pattern matching in serverclass.conf
2. Push correct deploymentclient.conf via imaging/provisioning
3. Whitelist 8089 in store firewall rules
4. Add deployment server to store DNS
5. Restart splunkd on affected forwarders:
   systemctl restart SplunkForwarder
                    </div>

                    <h3>Runbook 5: Data Model Acceleration Failure</h3>
                    <div class="arch-diagram">
SCENARIO: ES dashboards showing "No Results" - DMA not completing
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: CHECK DMA STATUS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check all data model acceleration status `
| rest /services/admin/summarization splunk_server=local
| where eai:acl.app="*security*" OR title="*Authentication*" OR title="*Network*"
| table title, summary.is_inprogress, summary.complete, summary.access_count, 
        summary.last_build_time, summary.last_error

` Check for DMA errors `
index=_internal sourcetype=splunkd component=DataModelAccelerator 
| where log_level="ERROR"
| stats count by message
| sort -count

` Check DMA build times `
index=_introspection sourcetype=splunk_acceleration component=datamodel
| timechart span=1h avg(run_time) by datamodel_name

STEP 2: IDENTIFY ROOT CAUSE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Common DMA issues:
â–¡ Bucket rebuild in progress
â–¡ Disk space exhaustion
â–¡ Search head cluster captain election
â–¡ Heavy search load competing for resources
â–¡ Data model definition changed
â–¡ Source data format changed (CIM mapping broken)

` Check disk space `
| rest /services/server/status/resource-usage/diskspace
| table mount_point, available, pct_usage
| where pct_usage > 80

` Check for CIM compliance issues `
| tstats count FROM datamodel=Authentication BY nodename
| where count < 100

STEP 3: REMEDIATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
OPTION A: Rebuild Acceleration
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Settings â†’ Data Models â†’ [Model Name] â†’ Edit Acceleration
â–¡ Disable acceleration
â–¡ Wait for completion
â–¡ Re-enable acceleration
â–¡ Set appropriate time range (start small, expand)

OPTION B: Fix CIM Mapping
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# If data isn't mapping to CIM, check TA configuration
# Example: Authentication data model needs these fields:
- user
- src
- dest
- action (success/failure)
- app

# props.conf fix
[sobeys:pos:auth]
FIELDALIAS-user = cashier_id AS user
FIELDALIAS-action = auth_result AS action
EVAL-src = if(isnull(src_ip), register_id, src_ip)

OPTION C: Resource Issues
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Reduce DMA scope
[Authentication]
acceleration.earliest_time = -30d  # Was -1y, reduce

# Or disable less critical models
[Network_Traffic]
acceleration = false  # If not using network dashboards
                    </div>

                    <h3>Runbook 6: HEC Token Issues</h3>
                    <div class="arch-diagram">
SCENARIO: POS middleware team reports HEC 403 errors
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: DIAGNOSE HEC ISSUE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
` Check HEC health endpoint `
curl -k https://hec.sobeys.com:8088/services/collector/health

` Check HEC events by status `
index=_internal sourcetype=splunkd component=HttpInputDataHandler
| stats count by status
| sort -count

` Find failing tokens `
index=_internal sourcetype=splunkd component=HttpInputDataHandler
  status IN (400, 401, 403)
| rex field=message "token=(?<token_id>\w+)"
| stats count by token_id, status
| sort -count

` Check token configuration `
| rest /services/data/inputs/http
| table name, disabled, index, indexes, sourcetype, useACK

STEP 2: COMMON HEC ERROR CODES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
401 Unauthorized:
  â†’ Token disabled or invalid
  â†’ Check: | rest /services/data/inputs/http | search disabled=1
  â†’ Fix: Re-enable token or generate new one

403 Forbidden:
  â†’ Token doesn't have permission for index
  â†’ Check: indexes field on token configuration
  â†’ Fix: Add required index to token's allowed indexes

400 Bad Request:
  â†’ Malformed JSON payload
  â†’ Check: Application sending data
  â†’ Fix: Validate JSON format before sending

503 Service Unavailable:
  â†’ HEC queue full or indexer overloaded
  â†’ Check: index=_internal component=HttpInputDataHandler "queue"
  â†’ Fix: Add indexer capacity or reduce ingest rate

STEP 3: TEST AND FIX
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Test HEC token
curl -k https://hec.sobeys.com:8088/services/collector \
  -H "Authorization: Splunk YOUR_TOKEN" \
  -d '{"event": "test event", "sourcetype": "test"}'

# Expected response: {"text":"Success","code":0}

# If token invalid, create new one
Settings â†’ Data Inputs â†’ HTTP Event Collector â†’ New Token:
- Name: POS_Middleware_Token
- Indexes: pos_transactions
- Sourcetype: sobeys:pos:transaction
- Enable indexer acknowledgment: Yes (for reliability)

# Update middleware configuration with new token
                    </div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Data isn't appearing in Splunk - how do you troubleshoot?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Check forwarder:</strong> Is service running? <code>splunk status</code></li>
                                <li><strong>Check connectivity:</strong> Can forwarder reach indexer? <code>splunk list forward-server</code></li>
                                <li><strong>Check inputs:</strong> Is input enabled? <code>btool inputs list</code></li>
                                <li><strong>Check permissions:</strong> Can Splunk read the source files?</li>
                                <li><strong>Check internal logs:</strong> <code>index=_internal</code> for errors</li>
                                <li><strong>Check metadata:</strong> <code>| metadata type=sourcetypes</code> to see if data arrived</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you optimize a slow Splunk search?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Use Job Inspector:</strong> Find where time is spent</li>
                                <li><strong>Specify index:</strong> Never search <code>index=*</code></li>
                                <li><strong>Narrow time:</strong> Shortest range possible</li>
                                <li><strong>Filter early:</strong> Most restrictive conditions first</li>
                                <li><strong>Use tstats:</strong> For data model searches</li>
                                <li><strong>Avoid wildcards:</strong> At start of strings</li>
                                <li><strong>Add fields command:</strong> Early to reduce data</li>
                            </ol>
                        </div>
                    </div>
                </div>
                <!-- Extended Interview Questions -->
                <h2><i class="fas fa-question-circle"></i> Additional Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you approach troubleshooting in this area?</button>
                        <div class="qa-answer">
                            <p><strong>Systematic troubleshooting approach:</strong></p>
                            <ol>
                                <li><strong>Identify the symptom:</strong> What exactly is not working as expected?</li>
                                <li><strong>Check connectivity:</strong> Verify network paths and authentication</li>
                                <li><strong>Review logs:</strong> Check internal/audit logs for errors</li>
                                <li><strong>Validate configuration:</strong> Compare against documented standards</li>
                                <li><strong>Test incrementally:</strong> Isolate the problem component</li>
                                <li><strong>Document findings:</strong> Record what worked and what didn't</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What metrics would you track for this area?</button>
                        <div class="qa-answer">
                            <p><strong>Key performance indicators:</strong></p>
                            <ul>
                                <li><strong>Availability:</strong> Uptime percentage, service availability</li>
                                <li><strong>Performance:</strong> Query response time, processing latency</li>
                                <li><strong>Volume:</strong> Events per second, data ingestion rate</li>
                                <li><strong>Quality:</strong> Parse success rate, enrichment coverage</li>
                                <li><strong>Efficiency:</strong> Resource utilization, cost per GB</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you ensure high availability?</button>
                        <div class="qa-answer">
                            <p><strong>High availability strategies:</strong></p>
                            <ul>
                                <li><strong>Redundancy:</strong> Multiple instances of critical components</li>
                                <li><strong>Load balancing:</strong> Distribute traffic across instances</li>
                                <li><strong>Failover:</strong> Automatic switchover on failure</li>
                                <li><strong>Monitoring:</strong> Health checks and alerting</li>
                                <li><strong>DR Planning:</strong> Documented recovery procedures</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Best Practices -->
                <h2><i class="fas fa-star"></i> Best Practices</h2>
                <div class="config-section">
                    <!-- Troubleshooting Guide -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting Guide</h2>
                <div class="config-section">
                    <h4>Common Issues and Solutions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Issue</th><th>Possible Cause</th><th>Solution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Data not appearing</td>
                                <td>Collection or parsing issue</td>
                                <td>Check collector status, verify parser configuration</td>
                            </tr>
                            <tr>
                                <td>Slow performance</td>
                                <td>Resource constraints or inefficient queries</td>
                                <td>Review resource utilization, optimize queries</td>
                            </tr>
                            <tr>
                                <td>Authentication failures</td>
                                <td>Credential or permission issues</td>
                                <td>Verify credentials, check RBAC configuration</td>
                            </tr>
                            <tr>
                                <td>Missing fields</td>
                                <td>Parser not extracting fields</td>
                                <td>Review parsing rules, update field extraction</td>
                            </tr>
                            <tr>
                                <td>Duplicate events</td>
                                <td>Multiple collection paths</td>
                                <td>Audit data sources, implement deduplication</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Diagnostic Steps</h4>
                    <ol style="color: #8b949e;">
                        <li><strong>Check Status:</strong> Verify component health in console</li>
                        <li><strong>Review Logs:</strong> Examine internal logs for errors</li>
                        <li><strong>Test Connectivity:</strong> Verify network paths and authentication</li>
                        <li><strong>Validate Config:</strong> Compare configuration against documentation</li>
                        <li><strong>Isolate Issue:</strong> Narrow down to specific component</li>
                        <li><strong>Escalate:</strong> Contact support if needed with diagnostics</li>
                    </ol>
                </div>

                <!-- Use Cases -->
                <h2><i class="fas fa-briefcase"></i> Real-World Use Cases</h2>
                <div class="config-section">
                    <h4>Use Case 1: Enterprise SOC</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Large enterprise with 20,000 endpoints, multiple cloud environments</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Centralized collection from all security data sources</li>
                            <li>Custom detection rules aligned to threat model</li>
                            <li>Automated response playbooks for common scenarios</li>
                            <li>Integration with ticketing and CMDB systems</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> 60% reduction in MTTR, improved threat visibility</p>
                    </div>

                    <h4>Use Case 2: MSSP Operations</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Managed security provider serving 50 customers</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Multi-tenant architecture with customer isolation</li>
                            <li>Standardized detection content across customers</li>
                            <li>Centralized analyst workflow and reporting</li>
                            <li>SLA-driven prioritization and escalation</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> Efficient operations at scale, consistent service delivery</p>
                    </div>

                    <h4>Use Case 3: Compliance-Focused</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <p><strong>Scenario:</strong> Healthcare organization with HIPAA requirements</p>
                        <p style="color: #8b949e;"><strong>Implementation:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Comprehensive audit logging for PHI access</li>
                            <li>Long-term retention for compliance evidence</li>
                            <li>Pre-built compliance dashboards and reports</li>
                            <li>Automated compliance violation detection</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Outcome:</strong> Audit-ready documentation, reduced compliance risk</p>
                    </div>
                </div>

                <!-- Quick Reference -->
                <h2><i class="fas fa-bookmark"></i> Quick Reference</h2>
                <div class="config-section">
                    <h4>Common Commands/Queries</h4>
                    <div class="arch-diagram"># Basic health check query
# Adjust syntax for your platform (XQL/SPL/KQL)

# Check data ingestion rate
| stats count by _time span=1h

# Find recent errors
| filter severity = "error" 
| sort _time desc 
| limit 100

# Top sources by volume
| stats sum(bytes) as total_bytes by source
| sort total_bytes desc
| limit 10

# Detection rule effectiveness
| filter alert_type = "detection"
| stats count by rule_name, disposition
| sort count desc</div>

                    <h4>Key Configuration Files/Paths</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Purpose</th><th>Location/Path</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Main Configuration</td><td>Settings â†’ Configuration</td></tr>
                            <tr><td>Data Sources</td><td>Settings â†’ Data Sources</td></tr>
                            <tr><td>Detection Rules</td><td>Detection â†’ Rules</td></tr>
                            <tr><td>User Management</td><td>Settings â†’ Access Management</td></tr>
                            <tr><td>Audit Logs</td><td>Settings â†’ Audit Trail</td></tr>
                        </tbody>
                    </table>

                    <h4>Important Thresholds</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Metric</th><th>Warning</th><th>Critical</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Query Response Time</td><td>> 30 seconds</td><td>> 120 seconds</td></tr>
                            <tr><td>Ingestion Latency</td><td>> 5 minutes</td><td>> 15 minutes</td></tr>
                            <tr><td>Storage Utilization</td><td>> 70%</td><td>> 85%</td></tr>
                            <tr><td>Error Rate</td><td>> 1%</td><td>> 5%</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Related Topics -->
                <h2><i class="fas fa-link"></i> Related Topics</h2>
                <div class="config-section">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-book" style="color: #58a6ff;"></i> Documentation</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>Official vendor documentation</li>
                                <li>API reference guides</li>
                                <li>Release notes</li>
                            </ul>
                        </div>
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-users" style="color: #58a6ff;"></i> Community</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>User forums</li>
                                <li>Community Slack/Discord</li>
                                <li>Blog posts and articles</li>
                            </ul>
                        </div>
                        <div style="background: #21262d; padding: 16px; border-radius: 8px;">
                            <h4 style="margin-top: 0;"><i class="fas fa-graduation-cap" style="color: #58a6ff;"></i> Training</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem; padding-left: 20px;">
                                <li>Vendor certifications</li>
                                <li>Online courses</li>
                                <li>Hands-on labs</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Real-World Use Cases -->
                </div>
</main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>