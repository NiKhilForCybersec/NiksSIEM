<!DOCTYPE html>
<html lang="en" data-theme="dark" data-platform="splunk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troubleshooting - Splunk Diagnostics | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
                        <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Pipeline</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="forwarders.html" class="nav-link"><i class="fas fa-share"></i> Forwarders Deep Dive</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                    <a href="data-models.html" class="nav-link"><i class="fas fa-cubes"></i> Data Models & CIM</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention & Buckets</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SPL Query Language</div>
                    <a href="spl-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> SPL Fundamentals</a>
                    <a href="spl-intermediate.html" class="nav-link"><i class="fas fa-layer-group"></i> SPL Intermediate</a>
                    <a href="spl-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced SPL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Enterprise Security</div>
                    <a href="es-overview.html" class="nav-link"><i class="fas fa-shield-alt"></i> ES Overview</a>
                    <a href="correlation-searches.html" class="nav-link"><i class="fas fa-search-plus"></i> Correlation Searches</a>
                    <a href="notable-events.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Notable Events</a>
                    <a href="risk-based-alerting.html" class="nav-link"><i class="fas fa-chart-line"></i> Risk-Based Alerting</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">TI & Automation</div>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intelligence</a>
                    <a href="soar.html" class="nav-link"><i class="fas fa-robot"></i> Splunk SOAR</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="enterprise-scenarios.html" class="nav-link"><i class="fas fa-building"></i> Enterprise Scenarios</a>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="apps-tas.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> Apps & TAs</a>
                    <a href="troubleshooting.html" class="nav-link active"><i class="fas fa-wrench"></i> Troubleshooting</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-wrench"></i> Troubleshooting</h1>
                    <p class="lead">Common issues, diagnostic queries, and resolution steps</p>
                </div>

                <section class="content-section">
                    <h2><i class="fas fa-search"></i> Diagnostic Queries</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">SPL</span>
                            <span class="code-title">Health Check Queries</span>
                        </div>
                        <pre><code>// License usage
index=_internal source=*license_usage.log type=Usage
| stats sum(b) as bytes by pool
| eval GB = round(bytes/1024/1024/1024, 2)

// Indexing queue health
index=_internal source=*metrics.log group=queue
| stats avg(current_size_kb) by name, host
| where avg(current_size_kb) > 500

// Forwarder connectivity
index=_internal source=*metrics.log group=tcpin_connections
| stats latest(connectionType) as type, sum(kb) as KB by hostname
| sort -KB

// Search performance
index=_audit action=search info=completed
| stats avg(total_run_time) as avg_runtime, count by user, search
| sort -avg_runtime

// Parsing errors
index=_internal source=*splunkd.log log_level=ERROR
| stats count by component, message
| sort -count</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-exclamation-triangle"></i> Common Issues</h2>
                    
                    <h3>1. No data from forwarder</h3>
                    <ul>
                        <li>Check: <code>splunk list forward-server</code></li>
                        <li>Verify: Firewall allows 9997</li>
                        <li>Test: <code>telnet indexer 9997</code></li>
                        <li>Review: splunkd.log for connection errors</li>
                    </ul>

                    <h3>2. Slow searches</h3>
                    <ul>
                        <li>Use tstats instead of raw search</li>
                        <li>Enable data model acceleration</li>
                        <li>Add time bounds to searches</li>
                        <li>Avoid leading wildcards</li>
                    </ul>

                    <h3>3. License exceeded</h3>
                    <ul>
                        <li>Check: index=_internal source=*license_usage.log</li>
                        <li>Identify high-volume sourcetypes</li>
                        <li>Filter unnecessary data at forwarder</li>
                        <li>Route to summary indexes</li>
                    </ul>
                </section>

                <section class="content-section">
                    <h2><i class="fas fa-terminal"></i> CLI Commands</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">Bash</span>
                            <span class="code-title">Splunk CLI</span>
                        </div>
                        <pre><code># Status
splunk status
splunk show splunkd-port

# Restart
splunk restart

# Check config
splunk btool inputs list --debug
splunk btool props list --debug

# Cluster status
splunk show cluster-status
splunk show cluster-bundle-status

# Diag bundle
splunk diag</code></pre>
                    </div>
                </section>
            </main>
        </div>
    </div>
</body>
</html>
