<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture & Enterprise Deployments | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">


</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo"><i class="fas fa-terminal"></i><span>Splunk Reference</span></a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certifications</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-user-graduate" style="color:#7ce38b"></i>Power User<span class="sidebar-badge" style="color:#7ce38b">SPLK-1002</span></a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog" style="color:#f0883e"></i>Admin<span class="sidebar-badge" style="color:#f0883e">SPLK-1003</span></a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt" style="color:#8957e5"></i>ES Admin<span class="sidebar-badge" style="color:#8957e5">SPLK-3001</span></a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud" style="color:#39c5cf"></i>Cloud Admin<span class="sidebar-badge" style="color:#39c5cf">SPLK-1004</span></a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL & Searching</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-code"></i>SPL Fundamentals</a></li>
                        <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-layer-group"></i>SPL Intermediate</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i>SPL Advanced</a></li>
                        <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-lightbulb"></i>Knowledge Objects</a></li>
                        <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i>Data Models</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Practice</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-practice-questions.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i>SPL MCQs (60Q)</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced-mcqs.html" class="sidebar-nav-link"><i class="fas fa-brain"></i>Advanced MCQs (30Q)</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Administration</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link active"><i class="fas fa-sitemap"></i>Architecture</a></li>
                        <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i>Data Ingestion</a></li>
                        <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-share-alt"></i>Forwarders</a></li>
                        <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i>Parsing & Flows</a></li>
                        <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i>Clustering & HA</a></li>
                        <li class="sidebar-nav-item"><a href="security-rbac.html" class="sidebar-nav-link"><i class="fas fa-user-lock"></i>Security & RBAC</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Enterprise Security</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i>ES Overview</a></li>
                        <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search-plus"></i>Correlation Searches</a></li>
                        <li class="sidebar-nav-item"><a href="notable-events.html" class="sidebar-nav-link"><i class="fas fa-exclamation-triangle"></i>Notable Events</a></li>
                        <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i>Risk-Based Alerting</a></li>
                        <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i>Threat Intelligence</a></li>
                        <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-binoculars"></i>Threat Hunting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Cloud & Automation</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i>Splunk Cloud</a></li>
                        <li class="sidebar-nav-item"><a href="soar.html" class="sidebar-nav-link"><i class="fas fa-robot"></i>SOAR</a></li>
                        <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-pie"></i>Dashboards</a></li>
                        <li class="sidebar-nav-item"><a href="alerting-actions.html" class="sidebar-nav-link"><i class="fas fa-bell"></i>Alerting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Resources</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="lab-exercises.html" class="sidebar-nav-link"><i class="fas fa-flask"></i>Lab Exercises</a></li>
                        <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i>Enterprise Scenarios</a></li>
                        <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i>Troubleshooting</a></li>
                    </ul>
                </div>
            </div>
        </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Architecture</span>
                </div>

                <h1><i class="fas fa-sitemap"></i> Splunk Architecture & Enterprise Deployments</h1>
            <p class="lead">Complete technical architecture of Splunk Enterprise and Splunk Cloud with real-world enterprise deployment examples. Understand component roles, data flows, clustering, and deployment patterns.</p>

            <!-- Architecture Overview -->
            <h2><i class="fas fa-layer-group"></i> Core Architecture Overview</h2>
            
            <div class="config-section">
                <h3>Splunk Component Architecture</h3>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                         SPLUNK ENTERPRISE ARCHITECTURE                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   DATA SOURCES                FORWARDERS                 INDEXER CLUSTER            │
│   ════════════                ══════════                 ═══════════════            │
│                                                                                      │
│   ┌────────────┐            ┌──────────────────┐       ┌────────────────────────┐   │
│   │ SERVERS    │            │                  │       │    INDEXER CLUSTER     │   │
│   │ ────────   │            │  UNIVERSAL       │       │    ════════════════    │   │
│   │ • Windows  │───────────▶│  FORWARDER (UF)  │       │                        │   │
│   │ • Linux    │   Logs     │                  │       │  ┌─────────────────┐   │   │
│   │ • Apps     │            │  • Lightweight   │       │  │ Cluster Master  │   │   │
│   └────────────┘            │  • No parsing    │       │  │ (Manager Node)  │   │   │
│                             │  • TLS transport │       │  │ • Replication   │   │   │
│   ┌────────────┐            │  • Load balance  │       │  │ • Search factor │   │   │
│   │ NETWORK    │            │                  │       │  └────────┬────────┘   │   │
│   │ ────────   │            └────────┬─────────┘       │           │            │   │
│   │ • Firewalls│                     │                 │  ┌────────▼────────┐   │   │
│   │ • Routers  │                     │                 │  │                 │   │   │
│   │ • Switches │                     │                 │  │   PEER NODES    │   │   │
│   │ • Proxies  │──┐                  │                 │  │   ══════════    │   │   │
│   └────────────┘  │                  │                 │  │                 │   │   │
│                   │                  │                 │  │ ┌─────┐ ┌─────┐ │   │   │
│   ┌────────────┐  │  ┌───────────────▼───────────┐    │  │ │IDX-1│ │IDX-2│ │   │   │
│   │ CLOUD      │  │  │                           │    │  │ └──┬──┘ └──┬──┘ │   │   │
│   │ ────────   │  │  │  HEAVY FORWARDER (HF)     │───▶│  │    │       │    │   │   │
│   │ • AWS      │  │  │                           │    │  │ ┌──▼──┐ ┌──▼──┐ │   │   │
│   │ • Azure    │  └─▶│  • Full Splunk instance   │    │  │ │IDX-3│ │IDX-4│ │   │   │
│   │ • GCP      │     │  • Parsing/transforms     │    │  │ └─────┘ └─────┘ │   │   │
│   │ • O365     │     │  • Routing decisions      │    │  │                 │   │   │
│   └────────────┘     │  • Data masking           │    │  │ Replication     │   │   │
│                      │  • API collection         │    │  │ Factor: 2       │   │   │
│   ┌────────────┐     │                           │    │  │ Search          │   │   │
│   │ CUSTOM     │     └───────────────────────────┘    │  │ Factor: 2       │   │   │
│   │ ────────   │                                      │  │                 │   │   │
│   │ • HEC      │──────────────────────────────────────│  └─────────────────┘   │   │
│   │ • REST API │                                      │           │            │   │
│   │ • Scripted │     HTTP Event Collector (HEC)       │           │            │   │
│   └────────────┘     ══════════════════════════       │           ▼            │   │
│                      • Port 8088 (HTTPS)              │  ┌─────────────────┐   │   │
│                      • Token-based auth               │  │   HOT/WARM/     │   │   │
│                      • Direct to indexers             │  │   COLD STORAGE  │   │   │
│                      • JSON/raw formats               │  │   ════════════  │   │   │
│                                                       │  │ • Hot: SSD      │   │   │
│                                                       │  │ • Warm: HDD     │   │   │
│                                                       │  │ • Cold: Archive │   │   │
│                                                       │  └─────────────────┘   │   │
│                                                       └────────────────────────┘   │
│                                                                    │               │
│                                                                    ▼               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                SEARCH TIER                                          │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   SEARCH HEAD CLUSTER (SHC)                    DEPLOYER                     │   │
│   │   ═════════════════════════                    ════════                     │   │
│   │                                                                             │   │
│   │   ┌─────────┐ ┌─────────┐ ┌─────────┐         ┌─────────────────┐          │   │
│   │   │  SH-1   │ │  SH-2   │ │  SH-3   │         │    DEPLOYER     │          │   │
│   │   │(Captain)│ │         │ │         │◀────────│                 │          │   │
│   │   └────┬────┘ └────┬────┘ └────┬────┘  Push   │  • Push apps    │          │   │
│   │        │           │           │       Apps   │  • Manage SHC   │          │   │
│   │        └───────────┼───────────┘              │  • Configs      │          │   │
│   │                    │                          └─────────────────┘          │   │
│   │              Load Balancer                                                  │   │
│   │                    │                                                        │   │
│   │   ┌────────────────▼────────────────┐                                       │   │
│   │   │        SEARCH FUNCTIONS         │                                       │   │
│   │   │        ════════════════         │                                       │   │
│   │   │  • Ad-hoc searches              │                                       │   │
│   │   │  • Scheduled searches           │                                       │   │
│   │   │  • Dashboard rendering          │                                       │   │
│   │   │  • Report generation            │                                       │   │
│   │   │  • Alert processing             │                                       │   │
│   │   └─────────────────────────────────┘                                       │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                           ENTERPRISE SECURITY (ES)                                  │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐    │   │
│   │   │ NOTABLE   │ │CORRELATION│ │   RISK    │ │  THREAT   │ │  ASSET    │    │   │
│   │   │  EVENTS   │ │  SEARCHES │ │  SCORING  │ │   INTEL   │ │ INVENTORY │    │   │
│   │   │ ───────── │ │ ───────── │ │ ───────── │ │ ───────── │ │ ───────── │    │   │
│   │   │ • Triage  │ │ • 700+    │ │ • Risk    │ │ • STIX    │ │ • Asset   │    │   │
│   │   │ • Assign  │ │   OOTB    │ │   Rules   │ │ • TAXII   │ │   lookup  │    │   │
│   │   │ • Status  │ │ • Custom  │ │ • Entity  │ │ • IOC     │ │ • Owner   │    │   │
│   │   │ • Comment │ │ • Sched.  │ │   risk    │ │   match   │ │ • Priority│    │   │
│   │   └───────────┘ └───────────┘ └───────────┘ └───────────┘ └───────────┘    │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                            MANAGEMENT & DEPLOYMENT                                  │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │   │
│   │   │  DEPLOYMENT     │    │   LICENSE       │    │   MONITORING    │        │   │
│   │   │  SERVER         │    │   MANAGER       │    │   CONSOLE       │        │   │
│   │   │  ═══════════    │    │   ═══════════   │    │   ═══════════   │        │   │
│   │   │                 │    │                 │    │                 │        │   │
│   │   │  • Push apps    │    │  • License      │    │  • Health       │        │   │
│   │   │    to UFs       │    │    pooling      │    │    monitoring   │        │   │
│   │   │  • Manage       │    │  • Usage        │    │  • Platform     │        │   │
│   │   │    configs      │    │    tracking     │    │    alerts       │        │   │
│   │   │  • Server       │    │  • Violations   │    │  • Forwarder    │        │   │
│   │   │    classes      │    │    alerts       │    │    management   │        │   │
│   │   │                 │    │                 │    │                 │        │   │
│   │   └─────────────────┘    └─────────────────┘    └─────────────────┘        │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- Component Deep Dive -->
            <h2><i class="fas fa-cogs"></i> Component Deep Dive</h2>

            <div class="config-section">
                <h3>Forwarder Types</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Purpose</th>
                            <th>Resources</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Universal Forwarder (UF)</strong></td>
                            <td>Lightweight log collection</td>
                            <td>~20MB RAM, minimal CPU</td>
                            <td>Endpoints, servers, standard collection</td>
                        </tr>
                        <tr>
                            <td><strong>Heavy Forwarder (HF)</strong></td>
                            <td>Parsing, routing, enrichment</td>
                            <td>8-16GB RAM, 4+ cores</td>
                            <td>Syslog aggregation, data masking, API collection</td>
                        </tr>
                        <tr>
                            <td><strong>HTTP Event Collector</strong></td>
                            <td>Direct HTTP/S ingestion</td>
                            <td>Part of indexer</td>
                            <td>Applications, containers, cloud services</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="config-section">
                <h3>Indexer Cluster Concepts</h3>
                
                <div class="arch-diagram">
INDEXER CLUSTER TERMINOLOGY:

┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   REPLICATION FACTOR (RF) = 2                                   │
│   ─────────────────────────                                     │
│   Each bucket is replicated to 2 indexers                       │
│   Protects against single indexer failure                       │
│                                                                 │
│   ┌─────────┐              ┌─────────┐                          │
│   │  IDX-1  │   Replicate  │  IDX-2  │                          │
│   │ ┌─────┐ │─────────────▶│ ┌─────┐ │                          │
│   │ │Bkt-A│ │              │ │Bkt-A│ │  (Copy)                   │
│   │ └─────┘ │              │ └─────┘ │                          │
│   └─────────┘              └─────────┘                          │
│                                                                 │
│   SEARCH FACTOR (SF) = 2                                        │
│   ──────────────────────                                        │
│   Each bucket is searchable from 2 indexers                     │
│   Allows searches to continue if one indexer down               │
│                                                                 │
│   SITE REPLICATION (Multisite Cluster)                          │
│   ─────────────────────────────────────                         │
│   site_replication_factor = origin:1, total:2                   │
│   site_search_factor = origin:1, total:2                        │
│                                                                 │
│   ┌─────────────────┐         ┌─────────────────┐               │
│   │    SITE 1       │         │    SITE 2       │               │
│   │    (Primary)    │         │    (DR)         │               │
│   │  ┌─────┐┌─────┐ │ Sync    │  ┌─────┐┌─────┐ │               │
│   │  │IDX-1││IDX-2│ │────────▶│  │IDX-3││IDX-4│ │               │
│   │  └─────┘└─────┘ │         │  └─────┘└─────┘ │               │
│   └─────────────────┘         └─────────────────┘               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- Enterprise Deployment Examples -->
            <h2><i class="fas fa-building"></i> Enterprise Deployment Examples</h2>

            <!-- Example 1: Retail -->
            <div class="config-section">
                <h3>🛒 Case Study: RetailMax Corporation (25,000 Employees)</h3>
                
                <div class="info-box">
                    <h4>Company Profile</h4>
                    <p><strong>Industry:</strong> Retail | <strong>Employees:</strong> 25,000 | <strong>Locations:</strong> 500 stores + 3 DCs | <strong>Compliance:</strong> PCI-DSS</p>
                </div>

                <h4>Multi-Site Architecture</h4>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                    RETAILMAX - SPLUNK ENTERPRISE DEPLOYMENT                         │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   RETAIL STORES (500 locations)                                                      │
│   ═════════════════════════════                                                      │
│                                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   STORE TYPE A (Large - 200 stores)      STORE TYPE B (Small - 300 stores)  │   │
│   │   ════════════════════════════════       ═════════════════════════════════  │   │
│   │                                                                             │   │
│   │   ┌─────────────────────────┐           ┌─────────────────────────┐        │   │
│   │   │   POS Systems (10)      │           │   POS Systems (4)       │        │   │
│   │   │   ┌─────────────────┐   │           │   ┌─────────────────┐   │        │   │
│   │   │   │ Universal Fwdr  │   │           │   │ Universal Fwdr  │   │        │   │
│   │   │   │ on each POS     │   │           │   │ on each POS     │   │        │   │
│   │   │   └────────┬────────┘   │           │   └────────┬────────┘   │        │   │
│   │   │            │            │           │            │            │        │   │
│   │   │   ┌────────▼────────┐   │           │            │            │        │   │
│   │   │   │ Store Server    │   │           │            │            │        │   │
│   │   │   │ (Heavy Fwdr)    │   │           │            │            │        │   │
│   │   │   │ • Local buffer  │   │           │            │            │        │   │
│   │   │   │ • PCI masking   │   │           │            │ Direct     │        │   │
│   │   │   └────────┬────────┘   │           │            │ to HQ      │        │   │
│   │   │            │            │           │            │            │        │   │
│   │   │   ┌────────▼────────┐   │           │            │            │        │   │
│   │   │   │ Store Firewall  │   │           │   ┌────────▼────────┐   │        │   │
│   │   │   │ (Palo Alto)     │───┼───────────┼───│ Store Firewall  │   │        │   │
│   │   │   └─────────────────┘   │           │   └─────────────────┘   │        │   │
│   │   │                         │           │                         │        │   │
│   │   └─────────────────────────┘           └─────────────────────────┘        │   │
│   │                                                                             │   │
│   │   Total from stores: ~2,000 UFs + 200 HFs                                   │   │
│   │   Daily volume: ~500 GB (POS transactions, firewall, endpoint)              │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                       │
│                                              │ MPLS/Internet                         │
│                                              ▼                                       │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                         HEADQUARTERS DATA CENTER                             │   │
│   │                         ════════════════════════                             │   │
│   │                                                                             │   │
│   │   RECEIVING TIER                                                             │   │
│   │   ══════════════                                                             │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────────────────┐        ┌─────────────────────┐           │   │   │
│   │   │   │  HEAVY FORWARDER    │        │  HEAVY FORWARDER    │           │   │   │
│   │   │   │  CLUSTER (HF-1/2)   │        │  (SYSLOG)           │           │   │   │
│   │   │   │  ─────────────────  │        │  ─────────────────  │           │   │   │
│   │   │   │  • Store data recv  │        │  • Network devices  │           │   │   │
│   │   │   │  • PCI-DSS masking  │        │  • Security tools   │           │   │   │
│   │   │   │  • Index routing    │        │  • Linux/Unix       │           │   │   │
│   │   │   │                     │        │                     │           │   │   │
│   │   │   │  Specs: 16 vCPU     │        │  Specs: 8 vCPU      │           │   │   │
│   │   │   │        64 GB RAM    │        │        32 GB RAM    │           │   │   │
│   │   │   └──────────┬──────────┘        └──────────┬──────────┘           │   │   │
│   │   │              │                              │                      │   │   │
│   │   └──────────────┼──────────────────────────────┼──────────────────────┘   │   │
│   │                  │                              │                          │   │
│   │                  ▼                              ▼                          │   │
│   │   INDEXER CLUSTER (Multisite)                                              │   │
│   │   ═══════════════════════════                                              │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   SITE 1 (PRIMARY - HQ)              SITE 2 (DR - Remote DC)        │   │   │
│   │   │   ═════════════════════              ════════════════════════       │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌──────────────────┐               ┌──────────────────┐           │   │   │
│   │   │   │ CLUSTER MANAGER  │               │ (Standby CM)     │           │   │   │
│   │   │   │ (cm1.retail.com) │◀─────────────▶│                  │           │   │   │
│   │   │   └──────────────────┘               └──────────────────┘           │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────┐ ┌─────┐ ┌─────┐            ┌─────┐ ┌─────┐ ┌─────┐       │   │   │
│   │   │   │IDX-1│ │IDX-2│ │IDX-3│◀──────────▶│IDX-4│ │IDX-5│ │IDX-6│       │   │   │
│   │   │   └─────┘ └─────┘ └─────┘  Replicate └─────┘ └─────┘ └─────┘       │   │   │
│   │   │                                                                     │   │   │
│   │   │   Each indexer:                      Each indexer:                  │   │   │
│   │   │   • 16 vCPU, 64 GB RAM               • 16 vCPU, 64 GB RAM          │   │   │
│   │   │   • 20 TB storage (NVMe)             • 20 TB storage               │   │   │
│   │   │                                                                     │   │   │
│   │   │   RF=2 (origin:1, total:2)                                          │   │   │
│   │   │   SF=2 (origin:1, total:2)                                          │   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                  │                                                          │   │
│   │                  ▼                                                          │   │
│   │   SEARCH HEAD CLUSTER                                                       │   │
│   │   ═══════════════════                                                       │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────┐   ┌─────────┐   ┌─────────┐                          │   │   │
│   │   │   │  SH-1   │   │  SH-2   │   │  SH-3   │     ┌──────────────┐     │   │   │
│   │   │   │(Captain)│   │         │   │         │     │   DEPLOYER   │     │   │   │
│   │   │   └────┬────┘   └────┬────┘   └────┬────┘◀────│              │     │   │   │
│   │   │        │             │             │          │  • ES App    │     │   │   │
│   │   │        └─────────────┼─────────────┘          │  • TAs       │     │   │   │
│   │   │                      │                        │  • Lookups   │     │   │   │
│   │   │           ┌──────────▼──────────┐             └──────────────┘     │   │   │
│   │   │           │    LOAD BALANCER    │                                  │   │   │
│   │   │           │    (F5 BigIP)       │                                  │   │   │
│   │   │           └─────────────────────┘                                  │   │   │
│   │   │                      │                                              │   │   │
│   │   │        ┌─────────────┼─────────────┐                               │   │   │
│   │   │        ▼             ▼             ▼                               │   │   │
│   │   │   ┌─────────┐   ┌─────────┐   ┌─────────┐                          │   │   │
│   │   │   │ SOC     │   │ Fraud   │   │ IT Ops  │                          │   │   │
│   │   │   │ Analyst │   │ Team    │   │ Team    │                          │   │   │
│   │   │   └─────────┘   └─────────┘   └─────────┘                          │   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   │   MANAGEMENT                                                                │   │
│   │   ══════════                                                                │   │
│   │   ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐          │   │
│   │   │ DEPLOYMENT SVR  │   │ LICENSE MASTER  │   │ MONITORING      │          │   │
│   │   │ • 3,500 UFs     │   │ • 5 TB/day      │   │ CONSOLE         │          │   │
│   │   │ • Server classes│   │   license       │   │ • Platform      │          │   │
│   │   │ • App deploy    │   │ • Usage reports │   │   health        │          │   │
│   │   └─────────────────┘   └─────────────────┘   └─────────────────┘          │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
│   DAILY INGESTION: ~5 TB/day                                                         │
│   ══════════════════════════                                                         │
│   • POS transactions:      2.0 TB (500 stores × 4 GB avg)                            │
│   • Endpoint (UF):         1.0 TB (3,500 servers/workstations)                       │
│   • Network/firewall:      1.0 TB (500 store FWs + DC)                               │
│   • E-commerce platform:   0.5 TB (web logs, API, CDN)                               │
│   • Identity/Access:       0.3 TB (AD, PAM, badge systems)                           │
│   • Security tools:        0.2 TB (EDR, DLP, email security)                         │
│                                                                                      │
│   STORAGE: 120 TB total (6 indexers × 20 TB)                                         │
│   RETENTION: 90 days hot/warm, 1 year frozen (PCI compliance)                        │
│                                                                                      │
│   ESTIMATED ANNUAL COST: ~$2.5M                                                      │
│   (5 TB/day license + infrastructure + support)                                      │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>

                <h4>Key Design Decisions</h4>
                <ul>
                    <li><strong>PCI-DSS data masking:</strong> Heavy Forwarders mask credit card data (SEDCMD) before indexing</li>
                    <li><strong>Multisite cluster:</strong> Automatic DR failover, data replicated to secondary site</li>
                    <li><strong>Store HF buffering:</strong> Large stores have local HF to handle WAN outages</li>
                    <li><strong>Index segregation:</strong> Separate indexes for POS, network, security (RBAC + retention)</li>
                    <li><strong>SmartStore:</strong> Enabled for cold data tier to reduce storage costs</li>
                </ul>

                <h4>PCI-DSS Correlation Searches</h4>
                <div class="arch-diagram">
Enterprise Security Correlation Searches (Custom):
├── PCI-001: Credit card data in clear text (regex in non-PCI index)
├── PCI-002: POS system accessed from non-POS network segment
├── PCI-003: After-hours POS refund transactions
├── PCI-004: POS malware indicators (RAM scraper signatures)
├── PCI-005: Unauthorized POS software installation
├── PCI-006: PCI segment firewall rule change
├── PCI-007: Excessive card declines (card testing attack)
└── PCI-008: Admin access to POS systems outside change window

Risk-Based Alerting:
├── High-value transaction anomaly (+10 risk per event)
├── Employee discount abuse pattern (+25 risk per day)
├── Gift card fraud indicators (+30 risk per event)
└── Return fraud pattern detection (+20 risk per event)
                </div>
            </div>

            <!-- Example 2: Manufacturing -->
            <div class="config-section">
                <h3>🏭 Case Study: IndustrialTech Manufacturing (12,000 Employees)</h3>
                
                <div class="info-box">
                    <h4>Company Profile</h4>
                    <p><strong>Industry:</strong> Manufacturing | <strong>Employees:</strong> 12,000 | <strong>Sites:</strong> 8 factories + HQ | <strong>OT/ICS:</strong> Yes | <strong>Compliance:</strong> NIST CSF</p>
                </div>

                <h4>IT/OT Converged Architecture</h4>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                 INDUSTRIALTECH - SPLUNK IT/OT DEPLOYMENT                            │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   FACTORY FLOOR (OT Network - Air-Gapped)                                            │
│   ═══════════════════════════════════════                                            │
│                                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │   LEVEL 0-2: INDUSTRIAL CONTROL SYSTEMS                                     │   │
│   │   ═════════════════════════════════════                                     │   │
│   │                                                                             │   │
│   │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐   │   │
│   │   │     PLCs     │  │    HMIs      │  │    SCADA     │  │  Historians  │   │   │
│   │   │  ──────────  │  │  ──────────  │  │  ──────────  │  │  ──────────  │   │   │
│   │   │ • Rockwell   │  │ • Operator   │  │ • Ignition   │  │ • OSIsoft PI │   │   │
│   │   │ • Siemens    │  │   stations   │  │ • Wonderware │  │ • AspenTech  │   │   │
│   │   │ • ABB        │  │ • No agents! │  │              │  │              │   │   │
│   │   └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘   │   │
│   │          │                 │                 │                 │            │   │
│   │          └─────────────────┼─────────────────┼─────────────────┘            │   │
│   │                            │                 │                              │   │
│   │                            ▼                 ▼                              │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                     OT SECURITY STACK                               │   │
│   │   │                     ════════════════════                            │   │
│   │   │                                                                     │   │
│   │   │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐    │   │
│   │   │   │ Claroty/Nozomi  │  │  OT Firewall    │  │  Network TAP    │    │   │
│   │   │   │ (OT NDR)        │  │  (Palo Alto)    │  │  (Gigamon)      │    │   │
│   │   │   │ • Asset disco-  │  │  • IT/OT segmen-│  │  • Full packet  │    │   │
│   │   │   │   very          │  │    tation       │  │    capture      │    │   │
│   │   │   │ • Anomaly det.  │  │  • Allow-list   │  │  • ICS protocol │    │   │
│   │   │   │ • ICS protocols │  │    rules only   │  │    decode       │    │   │
│   │   │   └────────┬────────┘  └────────┬────────┘  └────────┬────────┘    │   │
│   │   │            │                    │                    │             │   │
│   │   └────────────┼────────────────────┼────────────────────┼─────────────┘   │   │
│   │                │                    │                    │                  │   │
│   │                ▼                    ▼                    ▼                  │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                     OT DMZ (Level 3.5)                              │   │   │
│   │   │                     ══════════════════                              │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────────────────────────────────────────────────────────┐   │   │
│   │   │   │              SPLUNK HEAVY FORWARDER                         │   │   │
│   │   │   │              ══════════════════════                         │   │   │
│   │   │   │                                                             │   │   │
│   │   │   │   • Air-gapped from corporate                               │   │   │
│   │   │   │   • Receives: Claroty alerts, OT FW logs, historian data    │   │   │
│   │   │   │   • Forwards via DATA DIODE (one-way) to corporate Splunk   │   │   │
│   │   │   │   • NO return traffic to OT network                         │   │   │
│   │   │   │                                                             │   │   │
│   │   │   │   Specs: 8 vCPU, 32 GB RAM, 500 GB local buffer             │   │   │
│   │   │   │                                                             │   │   │
│   │   │   └─────────────────────────────────────────────────────────────┘   │   │
│   │   │                              │                                      │   │
│   │   │                              │ DATA DIODE                           │   │
│   │   │                              │ (Waterfall, Owl)                     │   │
│   │   │                              │ One-way only ↓                       │   │
│   │   │                              ▼                                      │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                       │
│                                              ▼                                       │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                         CORPORATE IT NETWORK                                │   │
│   │                         ════════════════════                                │   │
│   │                                                                             │   │
│   │   STANDARD IT SOURCES              SPLUNK INFRASTRUCTURE                    │   │
│   │   ════════════════════             ══════════════════════                   │   │
│   │                                                                             │   │
│   │   ┌─────────────────┐             ┌─────────────────────────────────────┐   │   │
│   │   │ Endpoints       │             │         INDEXER CLUSTER             │   │   │
│   │   │ • 10,000 Windows│             │         ════════════════            │   │   │
│   │   │ • 2,000 Linux   │             │                                     │   │   │
│   │   └────────┬────────┘             │   ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐  │   │   │
│   │            │                      │   │IDX-1│ │IDX-2│ │IDX-3│ │IDX-4│  │   │   │
│   │   ┌────────▼────────┐             │   └─────┘ └─────┘ └─────┘ └─────┘  │   │   │
│   │   │ Universal Fwdrs │─────────────│                                     │   │   │
│   │   └─────────────────┘             │   INDEX STRUCTURE:                  │   │   │
│   │                                   │   • idx_ot_scada (OT logs)          │   │   │
│   │   ┌─────────────────┐             │   • idx_ot_network (OT firewall)    │   │   │
│   │   │ Network/Security│             │   • idx_security (IT security)      │   │   │
│   │   │ • Firewalls     │             │   • idx_network (IT network)        │   │   │
│   │   │ • IDS/IPS       │             │   • idx_endpoint (IT endpoints)     │   │   │
│   │   │ • Email gateway │             │                                     │   │   │
│   │   └────────┬────────┘             └─────────────────────────────────────┘   │   │
│   │            │                                     │                          │   │
│   │   ┌────────▼────────┐             ┌──────────────▼──────────────┐          │   │
│   │   │ Heavy Forwarders│─────────────│     SEARCH HEAD CLUSTER     │          │   │
│   │   │ (Syslog recv)   │             │     ════════════════════    │          │   │
│   │   └─────────────────┘             │                             │          │   │
│   │                                   │   ┌─────┐ ┌─────┐ ┌─────┐   │          │   │
│   │   ┌─────────────────┐             │   │SH-1 │ │SH-2 │ │SH-3 │   │          │   │
│   │   │ Cloud Services  │             │   └─────┘ └─────┘ └─────┘   │          │   │
│   │   │ • Azure AD      │             │                             │          │   │
│   │   │ • O365          │─────────────│   APPS INSTALLED:           │          │   │
│   │   │ • AWS (limited) │             │   • Enterprise Security     │          │   │
│   │   └─────────────────┘             │   • Splunk OT Security      │          │   │
│   │                                   │   • MITRE ATT&CK for ICS    │          │   │
│   │                                   │                             │          │   │
│   │                                   └─────────────────────────────┘          │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
│   DAILY INGESTION: ~2 TB/day                                                         │
│   ══════════════════════════                                                         │
│   • IT Endpoints:          600 GB                                                    │
│   • IT Network/Security:   500 GB                                                    │
│   • OT SCADA/Historian:    300 GB (via data diode)                                   │
│   • OT Network (Claroty):  400 GB                                                    │
│   • Cloud/SaaS:            200 GB                                                    │
│                                                                                      │
│   OT-SPECIFIC DETECTIONS:                                                            │
│   • ICS protocol anomaly (Modbus, DNP3, EtherNet/IP)                                │
│   • PLC program change outside change window                                         │
│   • HMI login from unexpected source                                                 │
│   • Safety system modification                                                       │
│   • Historian query from non-engineering workstation                                 │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>

                <h4>OT Security Considerations</h4>
                <ul>
                    <li><strong>Data diode:</strong> One-way data flow from OT to IT, no return path</li>
                    <li><strong>No agents on ICS:</strong> OT devices monitored via network traffic analysis only</li>
                    <li><strong>OT-specific TAs:</strong> Splunk Add-on for OT Security, Claroty TA, Nozomi TA</li>
                    <li><strong>MITRE ATT&CK for ICS:</strong> Detection rules mapped to ICS-specific techniques</li>
                    <li><strong>Separate indexes:</strong> OT data in dedicated indexes with restricted access</li>
                </ul>
            </div>

            <!-- Sizing and Cost -->
            <h2><i class="fas fa-calculator"></i> Sizing Guidelines</h2>

            <div class="config-section">
                <h3>Component Sizing Reference</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Daily Volume</th>
                            <th>Indexers</th>
                            <th>Search Heads</th>
                            <th>Heavy Fwdrs</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt;100 GB</td>
                            <td>1-2 (single)</td>
                            <td>1</td>
                            <td>1-2</td>
                        </tr>
                        <tr>
                            <td>100-500 GB</td>
                            <td>3-4 (cluster)</td>
                            <td>2-3 (SHC)</td>
                            <td>2-4</td>
                        </tr>
                        <tr>
                            <td>500 GB - 2 TB</td>
                            <td>4-8 (cluster)</td>
                            <td>3 (SHC)</td>
                            <td>4-8</td>
                        </tr>
                        <tr>
                            <td>2-5 TB</td>
                            <td>6-12 (multisite)</td>
                            <td>3-5 (SHC)</td>
                            <td>8-16</td>
                        </tr>
                        <tr>
                            <td>&gt;5 TB</td>
                            <td>12+ (multisite)</td>
                            <td>5+ (SHC)</td>
                            <td>16+</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Decision Trees -->
            <h2><i class="fas fa-project-diagram"></i> Architecture Decision Trees</h2>

            <div class="config-section">
                <h3>Decision Tree 1: Deployment Architecture Selection</h3>
                <div class="decision-tree">
                    <div class="decision-node" style="border-color: #58a6ff;">
                        <h4>What is your daily ingestion volume?</h4>
                        <small>This determines your base architecture</small>
                    </div>
                    <div class="decision-arrow">▼</div>
                    <div class="decision-branches">
                        <div class="decision-branch" style="border-color: #238636;">
                            <span class="branch-label">< 50 GB/day</span>
                            <div class="decision-node">
                                <h4>Production environment?</h4>
                            </div>
                            <div class="decision-branches" style="flex-direction: column; gap: 10px;">
                                <div class="decision-outcome" style="background: linear-gradient(135deg, #238636 0%, #2ea043 100%);">
                                    <i class="fas fa-server"></i>
                                    <strong>NO → Single Instance</strong>
                                    <small>All-in-one deployment</small>
                                </div>
                                <div class="decision-outcome" style="background: linear-gradient(135deg, #1f6feb 0%, #58a6ff 100%);">
                                    <i class="fas fa-project-diagram"></i>
                                    <strong>YES → Small Cluster</strong>
                                    <small>3 indexers, RF=2, SF=2</small>
                                </div>
                            </div>
                        </div>
                        <div class="decision-branch" style="border-color: #d29922;">
                            <span class="branch-label">50-500 GB/day</span>
                            <div class="decision-node">
                                <h4>DR requirements?</h4>
                            </div>
                            <div class="decision-branches" style="flex-direction: column; gap: 10px;">
                                <div class="decision-outcome" style="background: linear-gradient(135deg, #238636 0%, #2ea043 100%);">
                                    <i class="fas fa-layer-group"></i>
                                    <strong>NO → Single-site Cluster</strong>
                                    <small>3-6 nodes, RF=3, SF=2</small>
                                </div>
                                <div class="decision-outcome" style="background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);">
                                    <i class="fas fa-globe"></i>
                                    <strong>YES → Multisite Cluster</strong>
                                    <small>2 sites, origin:1,total:2</small>
                                </div>
                            </div>
                        </div>
                        <div class="decision-branch" style="border-color: #f0883e;">
                            <span class="branch-label">500 GB - 2 TB/day</span>
                            <div class="decision-outcome" style="background: linear-gradient(135deg, #f0883e 0%, #d29922 100%);">
                                <i class="fas fa-building"></i>
                                <strong>Clustered Architecture</strong>
                                <small>6-10 indexers, multisite with DR</small>
                            </div>
                        </div>
                        <div class="decision-branch" style="border-color: #f85149;">
                            <span class="branch-label">> 2 TB/day</span>
                            <div class="decision-outcome" style="background: linear-gradient(135deg, #da3633 0%, #f85149 100%);">
                                <i class="fas fa-city"></i>
                                <strong>Enterprise Architecture</strong>
                                <small>SmartStore, SHC 5+, dedicated mgmt</small>
                            </div>
                        </div>
                    </div>
                </div>

                <h3>Decision Tree 2: Forwarder Selection</h3>
                <div class="flow-diagram">
                    <div class="flow-step" style="border-left-color: #58a6ff;">
                        <div class="flow-icon"><i class="fas fa-desktop"></i></div>
                        <div class="flow-content">
                            <h4>Windows/Linux Endpoint Logs</h4>
                            <ul>
                                <li><strong>No transformation needed:</strong> Universal Forwarder (UF) - 20MB RAM, minimal footprint</li>
                                <li><strong>Transformation needed, &lt;100 GB/day:</strong> Heavy Forwarder on central server</li>
                                <li><strong>Transformation needed, &gt;100 GB/day:</strong> Multiple HFs with load balancer</li>
                            </ul>
                        </div>
                    </div>
                    <div class="flow-arrow">▼</div>
                    <div class="flow-step" style="border-left-color: #8b5cf6;">
                        <div class="flow-icon"><i class="fas fa-network-wired"></i></div>
                        <div class="flow-content">
                            <h4>Syslog Sources (Network Devices, Firewalls)</h4>
                            <ul>
                                <li><strong>Heavy Forwarder</strong> with Syslog-ng or rsyslog</li>
                                <li><strong>No real-time parsing:</strong> Forward raw, parse at indexer</li>
                                <li><strong>Real-time parsing needed:</strong> Parse at HF with props.conf/transforms.conf</li>
                                <li>Use for: Data masking, routing, enrichment</li>
                            </ul>
                        </div>
                    </div>
                    <div class="flow-arrow">▼</div>
                    <div class="flow-step" style="border-left-color: #238636;">
                        <div class="flow-icon"><i class="fas fa-cloud"></i></div>
                        <div class="flow-content">
                            <h4>Cloud Data (AWS, Azure, GCP)</h4>
                            <ul>
                                <li><strong>AWS:</strong> Splunk Add-on via SQS/S3</li>
                                <li><strong>Azure:</strong> Event Hub with Heavy Forwarder</li>
                                <li><strong>GCP:</strong> Pub/Sub with Heavy Forwarder</li>
                            </ul>
                        </div>
                    </div>
                    <div class="flow-arrow">▼</div>
                    <div class="flow-step" style="border-left-color: #f0883e;">
                        <div class="flow-icon"><i class="fas fa-shield-alt"></i></div>
                        <div class="flow-content">
                            <h4>High-Security Zone (DMZ, OT)</h4>
                            <ul>
                                <li><strong>Cannot install agents:</strong> Network TAP + HF for traffic analysis</li>
                                <li><strong>Can install agents:</strong> UF with persistent queue (buffer=true, maxSize=1GB)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <h3>Decision Tree 3: Search Head Architecture</h3>
                <div class="decision-tree">
                    <div class="decision-node" style="border-color: #58a6ff;">
                        <h4>How many concurrent users?</h4>
                        <small>Determines search head scaling</small>
                    </div>
                    <div class="decision-arrow">▼</div>
                    <div class="decision-branches">
                        <div class="decision-branch" style="border-color: #238636;">
                            <span class="branch-label">< 10 users</span>
                            <div class="decision-outcome" style="background: linear-gradient(135deg, #238636 0%, #2ea043 100%);">
                                <i class="fas fa-server"></i>
                                <strong>Single Search Head</strong>
                                <small>Add report acceleration & summary indexing</small>
                            </div>
                        </div>
                        <div class="decision-branch" style="border-color: #1f6feb;">
                            <span class="branch-label">10-50 users</span>
                            <div class="decision-node">
                                <h4>Enterprise Security or heavy dashboards?</h4>
                            </div>
                            <div class="decision-branches" style="flex-direction: column; gap: 10px; margin-top: 10px;">
                                <div class="decision-outcome" style="background: linear-gradient(135deg, #238636 0%, #2ea043 100%);">
                                    <i class="fas fa-server"></i>
                                    <strong>NO → Single SH</strong>
                                    <small>16 cores, 64GB RAM, SSD</small>
                                </div>
                                <div class="decision-outcome" style="background: linear-gradient(135deg, #1f6feb 0%, #58a6ff 100%);">
                                    <i class="fas fa-layer-group"></i>
                                    <strong>YES → SHC (3 members)</strong>
                                    <small>Load balancer in front</small>
                                </div>
                            </div>
                        </div>
                        <div class="decision-branch" style="border-color: #f0883e;">
                            <span class="branch-label">50-200 users</span>
                            <div class="decision-node">
                                <h4>Multiple use cases?</h4>
                            </div>
                            <div class="decision-branches" style="flex-direction: column; gap: 10px; margin-top: 10px;">
                                <div class="decision-outcome" style="background: linear-gradient(135deg, #f0883e 0%, #d29922 100%);">
                                    <i class="fas fa-layer-group"></i>
                                    <strong>NO → Single SHC (3-5)</strong>
                                    <small>Shared cluster for all users</small>
                                </div>
                                <div class="decision-outcome" style="background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);">
                                    <i class="fas fa-sitemap"></i>
                                    <strong>YES → Dedicated SHCs</strong>
                                    <small>ES SHC, ITSI SHC, General SHC</small>
                                </div>
                            </div>
                        </div>
                        <div class="decision-branch" style="border-color: #f85149;">
                            <span class="branch-label">> 200 users</span>
                            <div class="decision-outcome" style="background: linear-gradient(135deg, #da3633 0%, #f85149 100%);">
                                <i class="fas fa-city"></i>
                                <strong>Multiple SHCs Required</strong>
                                <small>ES cluster + General SHC + SH pool for reports</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- What Enterprises Usually Miss -->
            <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>

            <div class="enterprise-gap-grid">
                <div class="gap-card gap-critical">
                    <h4>🔴 Critical Gaps</h4>
                    <ul>
                        <li><strong>Undersized indexers:</strong> Sizing based on storage only, ignoring CPU/RAM for search performance</li>
                        <li><strong>No clustering:</strong> Running production on single indexer with no redundancy</li>
                        <li><strong>RF=SF=1:</strong> Data loss when any indexer fails, zero search resilience</li>
                        <li><strong>No forwarder management:</strong> No deployment server, manual config on 1000+ forwarders</li>
                        <li><strong>Everything on search head:</strong> Apps, dashboards, reports, scheduled searches on single SH</li>
                    </ul>
                </div>

                <div class="gap-card gap-warning">
                    <h4>🟡 Common Warnings</h4>
                    <ul>
                        <li><strong>No capacity planning:</strong> License purchased without infrastructure sizing</li>
                        <li><strong>Single-site deployment:</strong> No DR plan, complete outage on site failure</li>
                        <li><strong>UF everywhere:</strong> Using UF where HF needed for parsing, causing indexer overload</li>
                        <li><strong>Network bottlenecks:</strong> Forwarders saturating WAN links, no QoS or scheduling</li>
                        <li><strong>No monitoring:</strong> Splunk itself not monitored (DMC not configured)</li>
                    </ul>
                </div>

                <div class="gap-card gap-info">
                    <h4>🔵 Often Overlooked</h4>
                    <ul>
                        <li><strong>Certificate expiration:</strong> No monitoring of Splunk SSL certificates</li>
                        <li><strong>No bundle replication monitoring:</strong> Knowledge bundles failing silently</li>
                        <li><strong>Time sync issues:</strong> Forwarders with clock drift causing timestamp problems</li>
                        <li><strong>Storage tiering:</strong> All data on expensive SSD, no SmartStore consideration</li>
                        <li><strong>License pool misconfig:</strong> Test and prod sharing license pool</li>
                    </ul>
                </div>

                <div class="gap-card gap-best-practice">
                    <h4>🟢 Best Practices Often Skipped</h4>
                    <ul>
                        <li><strong>Capacity alerts:</strong> Alert at 70% disk, 80% license, 90% CPU</li>
                        <li><strong>DMC configured:</strong> Distributed Management Console for cluster health</li>
                        <li><strong>Deployment server:</strong> All forwarder configs managed centrally</li>
                        <li><strong>Index segregation:</strong> Separate indexes by data type and retention</li>
                        <li><strong>Documentation:</strong> Architecture diagrams, runbooks, DR procedures</li>
                    </ul>
                </div>
            </div>

            <!-- Interview Q&A -->
            <h2><i class="fas fa-comments"></i> Interview Questions</h2>

            <div class="qa-section">
                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Explain the difference between Universal Forwarder and Heavy Forwarder.</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Universal Forwarder is lightweight (~20MB RAM) and does minimal processing - it just collects logs and forwards them. It cannot parse, transform, or route data. Heavy Forwarder is a full Splunk instance that can parse logs (props.conf/transforms.conf), route to different destinations, mask sensitive data, and run searches. I use UF for standard collection from endpoints and servers, HF for syslog aggregation, data masking requirements (like PCI-DSS), and when I need to pre-process data before indexing."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What are Search Factor and Replication Factor?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Replication Factor (RF) is how many copies of raw data exist across the cluster - RF=2 means every bucket exists on 2 indexers. Search Factor (SF) is how many searchable copies exist - SF=2 means you can search data even if one indexer is down. SF must always be less than or equal to RF. For production, I typically recommend RF=3, SF=2 for single-site, and for multisite clusters: site_replication_factor=origin:1,total:2 meaning 1 copy at primary, 2 total copies across sites."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you design Splunk for a company with 500 retail stores?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "I'd design a hub-and-spoke model: Universal Forwarders on POS systems at each store forwarding to either a local Heavy Forwarder (for large stores needing buffering during WAN outages and PCI data masking) or directly to HQ (small stores). At HQ, I'd have Heavy Forwarder pairs for receiving and processing, then an indexer cluster with multisite replication to a DR site. Critical for retail: PCI-DSS compliance means masking card data at the Heavy Forwarder before indexing using SEDCMD in transforms.conf. I'd separate indexes by data type for different retention requirements and RBAC."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between search-time and index-time knowledge?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Index-time operations happen once when data is ingested - timestamps, line breaking, source/sourcetype assignment, and field extractions configured with INDEXED_EXTRACTIONS. These can't be changed after ingestion. Search-time operations happen during each search - field extractions, lookups, calculated fields, event types, tags. The tradeoff: index-time is faster for searches but inflexible and increases storage. I use index-time only for: timestamp extraction (mandatory), line breaking (mandatory), and high-cardinality fields I'll filter on constantly. Everything else is search-time for flexibility."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle a Splunk cluster where one indexer is consistently slow?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "I'd follow a systematic approach:</p>
                        <p><strong>1. Identify the bottleneck:</strong> Check DMC for that indexer - is it CPU, memory, disk I/O, or network?</p>
                        <p><strong>2. Check bucket distribution:</strong> Look at 'splunk list cluster-buckets' - is this indexer holding disproportionate hot buckets?</p>
                        <p><strong>3. Review scheduled searches:</strong> Check if expensive searches are pinned to this indexer via search affinity.</p>
                        <p><strong>4. Storage check:</strong> Run 'iostat' and check if disk is saturated. Verify all indexers have same storage class.</p>
                        <p><strong>5. Network:</strong> Check forwarder connections - is this indexer receiving more data due to load balancer misconfiguration?</p>
                        <p><strong>Remediation:</strong> If hardware issue, rebalance buckets to other peers. If it's a hot bucket imbalance, adjust maxHotBuckets. If network overload, check outputs.conf autoLB settings on forwarders."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: You need to migrate 2 TB/day Splunk to a new data center with zero downtime. Walk me through your approach.</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "This is a major undertaking. Here's my phased approach:</p>
                        <p><strong>Phase 1 - Parallel Build (2-4 weeks):</strong> Build new cluster in target DC. Don't migrate - rebuild clean. Replicate all configurations using deployment apps, not manual copy.</p>
                        <p><strong>Phase 2 - Dual-Write (1-2 weeks):</strong> Configure forwarders with indexer discovery or outputs.conf pointing to BOTH clusters. Data flows to both during transition. Validate data parity.</p>
                        <p><strong>Phase 3 - Search Migration:</strong> Point search heads to new indexers first. Users search new environment while old still receives data as backup.</p>
                        <p><strong>Phase 4 - Cutover:</strong> Update forwarders to point only to new cluster. Use deployment server for controlled rollout - 10% of forwarders first, monitor, then expand.</p>
                        <p><strong>Phase 5 - Historical Data:</strong> If needed, use 'splunk offline' to export buckets from old cluster and import to new. Or keep old cluster read-only for historical searches.</p>
                        <p><strong>Key safeguard:</strong> Persistent queues on forwarders during transition prevent data loss if either cluster has issues."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's your approach to monitoring Splunk itself?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "I use a layered monitoring strategy:</p>
                        <p><strong>Layer 1 - Splunk Internal Logs:</strong> _internal, _audit, _introspection indexes. Key searches: indexer queue fill ratio > 90%, search head memory pressure, license warnings.</p>
                        <p><strong>Layer 2 - Distributed Management Console (DMC):</strong> Configure for all cluster components. I set up alerts for: indexer cluster health (not all peers up), search head cluster captain changes, forwarder connection drops > 5%.</p>
                        <p><strong>Layer 3 - External Monitoring:</strong> This is critical - you can't rely only on Splunk to tell you Splunk is down. I use Prometheus/Grafana or Nagios for: TCP port checks (9997, 8089, 8000), disk space on all nodes, process monitoring, SSL certificate expiration.</p>
                        <p><strong>Layer 4 - Synthetic Monitoring:</strong> Scheduled search that writes to summary index and alerts if it doesn't run. This catches 'search head looks fine but nothing actually works' scenarios."</p>
                        <div class="arch-diagram">
# Critical DMC Alert Examples
index=_internal sourcetype=splunkd log_level=ERROR
| stats count by host component
| where count > 10

index=_internal source=*metrics.log group=queue
| stats avg(current_size_kb) as avg_queue by name host
| where avg_queue > 500

index=_internal sourcetype=splunkd component=LicenseUsage
| stats sum(b) as bytes by _time host
| timechart span=1h sum(bytes) as daily_usage
                        </div>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you size a Splunk deployment for 1 TB/day ingestion?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "For 1 TB/day, here's my sizing calculation:</p>
                        <p><strong>Indexers:</strong> Rule of thumb is 100-300 GB/day per indexer depending on search load. For 1 TB with moderate searching, I'd plan 5-6 indexers to allow headroom.</p>
                        <p><strong>Storage:</strong> 1 TB/day × 90 days retention × 0.5 (compression) = 45 TB raw storage. With RF=2, that's 90 TB across the cluster. Each indexer: 15-18 TB. I'd use NVMe for hot/warm, consider SmartStore for cost optimization.</p>
                        <p><strong>Search Heads:</strong> 3-node SHC minimum. If running ES, dedicated ES SHC with 3 members.</p>
                        <p><strong>Heavy Forwarders:</strong> Depends on sources, but typically 4-6 HFs for syslog aggregation and parsing.</p>
                        <p><strong>Hardware per indexer:</strong> 16-24 cores, 64-128 GB RAM, 15 TB NVMe storage.</p>
                        <p><strong>License:</strong> 1 TB/day license, but I'd negotiate 1.2 TB to handle spikes without violations.</p>
                        <p><strong>Network:</strong> 10 Gbps between all components. At 1 TB/day, you're pushing ~100 Mbps sustained, but bursts can hit 1 Gbps."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's your strategy for a multisite cluster with strict data residency requirements?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Data residency adds significant complexity. Here's my approach:</p>
                        <p><strong>Option 1 - Single Multisite Cluster with Constraints:</strong> If data can replicate between sites but searches must respect residency: use site_search_factor to ensure searchable copies exist only in compliant sites. Configure search heads with site affinity.</p>
                        <p><strong>Option 2 - Federated Clusters (Preferred for strict compliance):</strong> Separate clusters per region, each fully independent. Search heads can connect to multiple clusters for cross-region queries, but data never leaves its cluster.</p>
                        <div class="arch-diagram">
# Multisite with residency constraints (server.conf)
[clustering]
mode = manager
multisite = true
site_replication_factor = origin:2,site1:1,site2:1,total:3
site_search_factor = origin:1,site1:1,site2:1,total:2

# For EU data only in EU site:
# Route EU sources to EU-specific indexes
# Configure EU indexes with site_replication_factor = origin:2,site1:2,total:2
# (site1 = EU, this keeps all copies in EU)
                        </div>
                        <p><strong>Key considerations:</strong> Document data flows for auditors, implement RBAC so non-compliant users can't access restricted indexes, and use data classification tags to track sensitive data through the pipeline."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you troubleshoot 'search taking too long' complaints from users?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "This is one of the most common issues. My troubleshooting framework:</p>
                        <p><strong>1. Identify the specific search:</strong> Get the search string, time range, and user. Check Job Inspector for that search.</p>
                        <p><strong>2. Job Inspector analysis:</strong> Look at: events scanned vs returned (if ratio > 1000:1, inefficient filtering), time per component (is it command execution or disk I/O?), search peers participating.</p>
                        <p><strong>3. Common culprits:</strong></p>
                        <ul>
                            <li><strong>All-time searches:</strong> Restrict to 24h or 7d</li>
                            <li><strong>Leading wildcard:</strong> *password instead of password* forces full scan</li>
                            <li><strong>No index specified:</strong> Searching all indexes instead of index=specific</li>
                            <li><strong>Expensive commands early:</strong> Move stats/eval after filtering</li>
                            <li><strong>Non-accelerated data models:</strong> If using tstats, verify acceleration is current</li>
                        </ul>
                        <p><strong>4. Infrastructure check:</strong> If multiple users complain, check DMC for cluster health. Look for: indexer with high CPU, search head memory pressure, network saturation.</p>
                        <div class="arch-diagram">
# Find expensive searches in last hour
index=_audit action=search info=completed
| stats avg(total_run_time) as avg_time max(total_run_time) as max_time by user search
| where max_time > 300
| sort -max_time
                        </div>
                    </div>
                </div>
            </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>