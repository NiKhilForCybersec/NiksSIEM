<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture & Enterprise Deployments | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>
            <div class="sidebar-divider"></div>
            <div class="sidebar-section">
                <div class="sidebar-section-title">Splunk Pages</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Clustering & HA</span></a></li>
                    <li class="sidebar-nav-item"><a href="security-rbac.html" class="sidebar-nav-link"><i class="fas fa-user-lock"></i><span>Security & RBAC</span></a></li>
                    <li class="sidebar-nav-item"><a href="apps-tas.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Apps & TAs</span></a></li>
                    <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-paper-plane"></i><span>Forwarders</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-file-import"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-filter"></i><span>Parsing & Props/Transforms</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Index & Retention</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i><span>Data Models & CIM</span></a></li>
                    <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>Knowledge Objects</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>SPL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>SPL Intermediate</span></a></li>
                    <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>SPL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>Enterprise Security</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Correlation Searches</span></a></li>
                    <li class="sidebar-nav-item"><a href="notable-events.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Notable Events</span></a></li>
                    <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-exclamation-triangle"></i><span>Risk-Based Alerting</span></a></li>
                    <li class="sidebar-nav-item"><a href="alerting-actions.html" class="sidebar-nav-link"><i class="fas fa-bolt"></i><span>Alerting & Actions</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intelligence</span></a></li>
                    <li class="sidebar-nav-item"><a href="soar.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>SOAR</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="security-usecases.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Security Use Cases</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-binoculars"></i><span>Threat Hunting</span></a></li>
                    <li class="sidebar-nav-item"><a href="administration.html" class="sidebar-nav-link"><i class="fas fa-cog"></i><span>Administration</span></a></li>
                    <li class="sidebar-nav-item"><a href="performance-tuning.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>Performance Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="monitoring-console.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Monitoring Console</span></a></li>
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-tools"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="splunk-cloud.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Splunk Cloud</span></a></li>
                    <li class="sidebar-nav-item"><a href="enterprise-scenarios.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise Scenarios</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Architecture</span>
                </div>

                <h1><i class="fas fa-sitemap"></i> Splunk Architecture & Enterprise Deployments</h1>
            <p class="lead">Complete technical architecture of Splunk Enterprise and Splunk Cloud with real-world enterprise deployment examples. Understand component roles, data flows, clustering, and deployment patterns.</p>

            <!-- Architecture Overview -->
            <h2><i class="fas fa-layer-group"></i> Core Architecture Overview</h2>
            
            <div class="config-section">
                <h3>Splunk Component Architecture</h3>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                         SPLUNK ENTERPRISE ARCHITECTURE                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   DATA SOURCES                FORWARDERS                 INDEXER CLUSTER            │
│   ════════════                ══════════                 ═══════════════            │
│                                                                                      │
│   ┌────────────┐            ┌──────────────────┐       ┌────────────────────────┐   │
│   │ SERVERS    │            │                  │       │    INDEXER CLUSTER     │   │
│   │ ────────   │            │  UNIVERSAL       │       │    ════════════════    │   │
│   │ • Windows  │───────────▶│  FORWARDER (UF)  │       │                        │   │
│   │ • Linux    │   Logs     │                  │       │  ┌─────────────────┐   │   │
│   │ • Apps     │            │  • Lightweight   │       │  │ Cluster Master  │   │   │
│   └────────────┘            │  • No parsing    │       │  │ (Manager Node)  │   │   │
│                             │  • TLS transport │       │  │ • Replication   │   │   │
│   ┌────────────┐            │  • Load balance  │       │  │ • Search factor │   │   │
│   │ NETWORK    │            │                  │       │  └────────┬────────┘   │   │
│   │ ────────   │            └────────┬─────────┘       │           │            │   │
│   │ • Firewalls│                     │                 │  ┌────────▼────────┐   │   │
│   │ • Routers  │                     │                 │  │                 │   │   │
│   │ • Switches │                     │                 │  │   PEER NODES    │   │   │
│   │ • Proxies  │──┐                  │                 │  │   ══════════    │   │   │
│   └────────────┘  │                  │                 │  │                 │   │   │
│                   │                  │                 │  │ ┌─────┐ ┌─────┐ │   │   │
│   ┌────────────┐  │  ┌───────────────▼───────────┐    │  │ │IDX-1│ │IDX-2│ │   │   │
│   │ CLOUD      │  │  │                           │    │  │ └──┬──┘ └──┬──┘ │   │   │
│   │ ────────   │  │  │  HEAVY FORWARDER (HF)     │───▶│  │    │       │    │   │   │
│   │ • AWS      │  │  │                           │    │  │ ┌──▼──┐ ┌──▼──┐ │   │   │
│   │ • Azure    │  └─▶│  • Full Splunk instance   │    │  │ │IDX-3│ │IDX-4│ │   │   │
│   │ • GCP      │     │  • Parsing/transforms     │    │  │ └─────┘ └─────┘ │   │   │
│   │ • O365     │     │  • Routing decisions      │    │  │                 │   │   │
│   └────────────┘     │  • Data masking           │    │  │ Replication     │   │   │
│                      │  • API collection         │    │  │ Factor: 2       │   │   │
│   ┌────────────┐     │                           │    │  │ Search          │   │   │
│   │ CUSTOM     │     └───────────────────────────┘    │  │ Factor: 2       │   │   │
│   │ ────────   │                                      │  │                 │   │   │
│   │ • HEC      │──────────────────────────────────────│  └─────────────────┘   │   │
│   │ • REST API │                                      │           │            │   │
│   │ • Scripted │     HTTP Event Collector (HEC)       │           │            │   │
│   └────────────┘     ══════════════════════════       │           ▼            │   │
│                      • Port 8088 (HTTPS)              │  ┌─────────────────┐   │   │
│                      • Token-based auth               │  │   HOT/WARM/     │   │   │
│                      • Direct to indexers             │  │   COLD STORAGE  │   │   │
│                      • JSON/raw formats               │  │   ════════════  │   │   │
│                                                       │  │ • Hot: SSD      │   │   │
│                                                       │  │ • Warm: HDD     │   │   │
│                                                       │  │ • Cold: Archive │   │   │
│                                                       │  └─────────────────┘   │   │
│                                                       └────────────────────────┘   │
│                                                                    │               │
│                                                                    ▼               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                SEARCH TIER                                          │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   SEARCH HEAD CLUSTER (SHC)                    DEPLOYER                     │   │
│   │   ═════════════════════════                    ════════                     │   │
│   │                                                                             │   │
│   │   ┌─────────┐ ┌─────────┐ ┌─────────┐         ┌─────────────────┐          │   │
│   │   │  SH-1   │ │  SH-2   │ │  SH-3   │         │    DEPLOYER     │          │   │
│   │   │(Captain)│ │         │ │         │◀────────│                 │          │   │
│   │   └────┬────┘ └────┬────┘ └────┬────┘  Push   │  • Push apps    │          │   │
│   │        │           │           │       Apps   │  • Manage SHC   │          │   │
│   │        └───────────┼───────────┘              │  • Configs      │          │   │
│   │                    │                          └─────────────────┘          │   │
│   │              Load Balancer                                                  │   │
│   │                    │                                                        │   │
│   │   ┌────────────────▼────────────────┐                                       │   │
│   │   │        SEARCH FUNCTIONS         │                                       │   │
│   │   │        ════════════════         │                                       │   │
│   │   │  • Ad-hoc searches              │                                       │   │
│   │   │  • Scheduled searches           │                                       │   │
│   │   │  • Dashboard rendering          │                                       │   │
│   │   │  • Report generation            │                                       │   │
│   │   │  • Alert processing             │                                       │   │
│   │   └─────────────────────────────────┘                                       │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                           ENTERPRISE SECURITY (ES)                                  │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐    │   │
│   │   │ NOTABLE   │ │CORRELATION│ │   RISK    │ │  THREAT   │ │  ASSET    │    │   │
│   │   │  EVENTS   │ │  SEARCHES │ │  SCORING  │ │   INTEL   │ │ INVENTORY │    │   │
│   │   │ ───────── │ │ ───────── │ │ ───────── │ │ ───────── │ │ ───────── │    │   │
│   │   │ • Triage  │ │ • 700+    │ │ • Risk    │ │ • STIX    │ │ • Asset   │    │   │
│   │   │ • Assign  │ │   OOTB    │ │   Rules   │ │ • TAXII   │ │   lookup  │    │   │
│   │   │ • Status  │ │ • Custom  │ │ • Entity  │ │ • IOC     │ │ • Owner   │    │   │
│   │   │ • Comment │ │ • Sched.  │ │   risk    │ │   match   │ │ • Priority│    │   │
│   │   └───────────┘ └───────────┘ └───────────┘ └───────────┘ └───────────┘    │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                            MANAGEMENT & DEPLOYMENT                                  │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │   │
│   │   │  DEPLOYMENT     │    │   LICENSE       │    │   MONITORING    │        │   │
│   │   │  SERVER         │    │   MANAGER       │    │   CONSOLE       │        │   │
│   │   │  ═══════════    │    │   ═══════════   │    │   ═══════════   │        │   │
│   │   │                 │    │                 │    │                 │        │   │
│   │   │  • Push apps    │    │  • License      │    │  • Health       │        │   │
│   │   │    to UFs       │    │    pooling      │    │    monitoring   │        │   │
│   │   │  • Manage       │    │  • Usage        │    │  • Platform     │        │   │
│   │   │    configs      │    │    tracking     │    │    alerts       │        │   │
│   │   │  • Server       │    │  • Violations   │    │  • Forwarder    │        │   │
│   │   │    classes      │    │    alerts       │    │    management   │        │   │
│   │   │                 │    │                 │    │                 │        │   │
│   │   └─────────────────┘    └─────────────────┘    └─────────────────┘        │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- Component Deep Dive -->
            <h2><i class="fas fa-cogs"></i> Component Deep Dive</h2>

            <div class="config-section">
                <h3>Forwarder Types</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Purpose</th>
                            <th>Resources</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Universal Forwarder (UF)</strong></td>
                            <td>Lightweight log collection</td>
                            <td>~20MB RAM, minimal CPU</td>
                            <td>Endpoints, servers, standard collection</td>
                        </tr>
                        <tr>
                            <td><strong>Heavy Forwarder (HF)</strong></td>
                            <td>Parsing, routing, enrichment</td>
                            <td>8-16GB RAM, 4+ cores</td>
                            <td>Syslog aggregation, data masking, API collection</td>
                        </tr>
                        <tr>
                            <td><strong>HTTP Event Collector</strong></td>
                            <td>Direct HTTP/S ingestion</td>
                            <td>Part of indexer</td>
                            <td>Applications, containers, cloud services</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="config-section">
                <h3>Indexer Cluster Concepts</h3>
                
                <div class="arch-diagram">
INDEXER CLUSTER TERMINOLOGY:

┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   REPLICATION FACTOR (RF) = 2                                   │
│   ─────────────────────────                                     │
│   Each bucket is replicated to 2 indexers                       │
│   Protects against single indexer failure                       │
│                                                                 │
│   ┌─────────┐              ┌─────────┐                          │
│   │  IDX-1  │   Replicate  │  IDX-2  │                          │
│   │ ┌─────┐ │─────────────▶│ ┌─────┐ │                          │
│   │ │Bkt-A│ │              │ │Bkt-A│ │  (Copy)                   │
│   │ └─────┘ │              │ └─────┘ │                          │
│   └─────────┘              └─────────┘                          │
│                                                                 │
│   SEARCH FACTOR (SF) = 2                                        │
│   ──────────────────────                                        │
│   Each bucket is searchable from 2 indexers                     │
│   Allows searches to continue if one indexer down               │
│                                                                 │
│   SITE REPLICATION (Multisite Cluster)                          │
│   ─────────────────────────────────────                         │
│   site_replication_factor = origin:1, total:2                   │
│   site_search_factor = origin:1, total:2                        │
│                                                                 │
│   ┌─────────────────┐         ┌─────────────────┐               │
│   │    SITE 1       │         │    SITE 2       │               │
│   │    (Primary)    │         │    (DR)         │               │
│   │  ┌─────┐┌─────┐ │ Sync    │  ┌─────┐┌─────┐ │               │
│   │  │IDX-1││IDX-2│ │────────▶│  │IDX-3││IDX-4│ │               │
│   │  └─────┘└─────┘ │         │  └─────┘└─────┘ │               │
│   └─────────────────┘         └─────────────────┘               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- Enterprise Deployment Examples -->
            <h2><i class="fas fa-building"></i> Enterprise Deployment Examples</h2>

            <!-- Example 1: Retail -->
            <div class="config-section">
                <h3>🛒 Case Study: RetailMax Corporation (25,000 Employees)</h3>
                
                <div class="info-box">
                    <h4>Company Profile</h4>
                    <p><strong>Industry:</strong> Retail | <strong>Employees:</strong> 25,000 | <strong>Locations:</strong> 500 stores + 3 DCs | <strong>Compliance:</strong> PCI-DSS</p>
                </div>

                <h4>Multi-Site Architecture</h4>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                    RETAILMAX - SPLUNK ENTERPRISE DEPLOYMENT                         │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   RETAIL STORES (500 locations)                                                      │
│   ═════════════════════════════                                                      │
│                                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   STORE TYPE A (Large - 200 stores)      STORE TYPE B (Small - 300 stores)  │   │
│   │   ════════════════════════════════       ═════════════════════════════════  │   │
│   │                                                                             │   │
│   │   ┌─────────────────────────┐           ┌─────────────────────────┐        │   │
│   │   │   POS Systems (10)      │           │   POS Systems (4)       │        │   │
│   │   │   ┌─────────────────┐   │           │   ┌─────────────────┐   │        │   │
│   │   │   │ Universal Fwdr  │   │           │   │ Universal Fwdr  │   │        │   │
│   │   │   │ on each POS     │   │           │   │ on each POS     │   │        │   │
│   │   │   └────────┬────────┘   │           │   └────────┬────────┘   │        │   │
│   │   │            │            │           │            │            │        │   │
│   │   │   ┌────────▼────────┐   │           │            │            │        │   │
│   │   │   │ Store Server    │   │           │            │            │        │   │
│   │   │   │ (Heavy Fwdr)    │   │           │            │            │        │   │
│   │   │   │ • Local buffer  │   │           │            │            │        │   │
│   │   │   │ • PCI masking   │   │           │            │ Direct     │        │   │
│   │   │   └────────┬────────┘   │           │            │ to HQ      │        │   │
│   │   │            │            │           │            │            │        │   │
│   │   │   ┌────────▼────────┐   │           │            │            │        │   │
│   │   │   │ Store Firewall  │   │           │   ┌────────▼────────┐   │        │   │
│   │   │   │ (Palo Alto)     │───┼───────────┼───│ Store Firewall  │   │        │   │
│   │   │   └─────────────────┘   │           │   └─────────────────┘   │        │   │
│   │   │                         │           │                         │        │   │
│   │   └─────────────────────────┘           └─────────────────────────┘        │   │
│   │                                                                             │   │
│   │   Total from stores: ~2,000 UFs + 200 HFs                                   │   │
│   │   Daily volume: ~500 GB (POS transactions, firewall, endpoint)              │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                       │
│                                              │ MPLS/Internet                         │
│                                              ▼                                       │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                         HEADQUARTERS DATA CENTER                             │   │
│   │                         ════════════════════════                             │   │
│   │                                                                             │   │
│   │   RECEIVING TIER                                                             │   │
│   │   ══════════════                                                             │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────────────────┐        ┌─────────────────────┐           │   │   │
│   │   │   │  HEAVY FORWARDER    │        │  HEAVY FORWARDER    │           │   │   │
│   │   │   │  CLUSTER (HF-1/2)   │        │  (SYSLOG)           │           │   │   │
│   │   │   │  ─────────────────  │        │  ─────────────────  │           │   │   │
│   │   │   │  • Store data recv  │        │  • Network devices  │           │   │   │
│   │   │   │  • PCI-DSS masking  │        │  • Security tools   │           │   │   │
│   │   │   │  • Index routing    │        │  • Linux/Unix       │           │   │   │
│   │   │   │                     │        │                     │           │   │   │
│   │   │   │  Specs: 16 vCPU     │        │  Specs: 8 vCPU      │           │   │   │
│   │   │   │        64 GB RAM    │        │        32 GB RAM    │           │   │   │
│   │   │   └──────────┬──────────┘        └──────────┬──────────┘           │   │   │
│   │   │              │                              │                      │   │   │
│   │   └──────────────┼──────────────────────────────┼──────────────────────┘   │   │
│   │                  │                              │                          │   │
│   │                  ▼                              ▼                          │   │
│   │   INDEXER CLUSTER (Multisite)                                              │   │
│   │   ═══════════════════════════                                              │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   SITE 1 (PRIMARY - HQ)              SITE 2 (DR - Remote DC)        │   │   │
│   │   │   ═════════════════════              ════════════════════════       │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌──────────────────┐               ┌──────────────────┐           │   │   │
│   │   │   │ CLUSTER MANAGER  │               │ (Standby CM)     │           │   │   │
│   │   │   │ (cm1.retail.com) │◀─────────────▶│                  │           │   │   │
│   │   │   └──────────────────┘               └──────────────────┘           │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────┐ ┌─────┐ ┌─────┐            ┌─────┐ ┌─────┐ ┌─────┐       │   │   │
│   │   │   │IDX-1│ │IDX-2│ │IDX-3│◀──────────▶│IDX-4│ │IDX-5│ │IDX-6│       │   │   │
│   │   │   └─────┘ └─────┘ └─────┘  Replicate └─────┘ └─────┘ └─────┘       │   │   │
│   │   │                                                                     │   │   │
│   │   │   Each indexer:                      Each indexer:                  │   │   │
│   │   │   • 16 vCPU, 64 GB RAM               • 16 vCPU, 64 GB RAM          │   │   │
│   │   │   • 20 TB storage (NVMe)             • 20 TB storage               │   │   │
│   │   │                                                                     │   │   │
│   │   │   RF=2 (origin:1, total:2)                                          │   │   │
│   │   │   SF=2 (origin:1, total:2)                                          │   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                  │                                                          │   │
│   │                  ▼                                                          │   │
│   │   SEARCH HEAD CLUSTER                                                       │   │
│   │   ═══════════════════                                                       │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────┐   ┌─────────┐   ┌─────────┐                          │   │   │
│   │   │   │  SH-1   │   │  SH-2   │   │  SH-3   │     ┌──────────────┐     │   │   │
│   │   │   │(Captain)│   │         │   │         │     │   DEPLOYER   │     │   │   │
│   │   │   └────┬────┘   └────┬────┘   └────┬────┘◀────│              │     │   │   │
│   │   │        │             │             │          │  • ES App    │     │   │   │
│   │   │        └─────────────┼─────────────┘          │  • TAs       │     │   │   │
│   │   │                      │                        │  • Lookups   │     │   │   │
│   │   │           ┌──────────▼──────────┐             └──────────────┘     │   │   │
│   │   │           │    LOAD BALANCER    │                                  │   │   │
│   │   │           │    (F5 BigIP)       │                                  │   │   │
│   │   │           └─────────────────────┘                                  │   │   │
│   │   │                      │                                              │   │   │
│   │   │        ┌─────────────┼─────────────┐                               │   │   │
│   │   │        ▼             ▼             ▼                               │   │   │
│   │   │   ┌─────────┐   ┌─────────┐   ┌─────────┐                          │   │   │
│   │   │   │ SOC     │   │ Fraud   │   │ IT Ops  │                          │   │   │
│   │   │   │ Analyst │   │ Team    │   │ Team    │                          │   │   │
│   │   │   └─────────┘   └─────────┘   └─────────┘                          │   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   │   MANAGEMENT                                                                │   │
│   │   ══════════                                                                │   │
│   │   ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐          │   │
│   │   │ DEPLOYMENT SVR  │   │ LICENSE MASTER  │   │ MONITORING      │          │   │
│   │   │ • 3,500 UFs     │   │ • 5 TB/day      │   │ CONSOLE         │          │   │
│   │   │ • Server classes│   │   license       │   │ • Platform      │          │   │
│   │   │ • App deploy    │   │ • Usage reports │   │   health        │          │   │
│   │   └─────────────────┘   └─────────────────┘   └─────────────────┘          │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
│   DAILY INGESTION: ~5 TB/day                                                         │
│   ══════════════════════════                                                         │
│   • POS transactions:      2.0 TB (500 stores × 4 GB avg)                            │
│   • Endpoint (UF):         1.0 TB (3,500 servers/workstations)                       │
│   • Network/firewall:      1.0 TB (500 store FWs + DC)                               │
│   • E-commerce platform:   0.5 TB (web logs, API, CDN)                               │
│   • Identity/Access:       0.3 TB (AD, PAM, badge systems)                           │
│   • Security tools:        0.2 TB (EDR, DLP, email security)                         │
│                                                                                      │
│   STORAGE: 120 TB total (6 indexers × 20 TB)                                         │
│   RETENTION: 90 days hot/warm, 1 year frozen (PCI compliance)                        │
│                                                                                      │
│   ESTIMATED ANNUAL COST: ~$2.5M                                                      │
│   (5 TB/day license + infrastructure + support)                                      │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>

                <h4>Key Design Decisions</h4>
                <ul>
                    <li><strong>PCI-DSS data masking:</strong> Heavy Forwarders mask credit card data (SEDCMD) before indexing</li>
                    <li><strong>Multisite cluster:</strong> Automatic DR failover, data replicated to secondary site</li>
                    <li><strong>Store HF buffering:</strong> Large stores have local HF to handle WAN outages</li>
                    <li><strong>Index segregation:</strong> Separate indexes for POS, network, security (RBAC + retention)</li>
                    <li><strong>SmartStore:</strong> Enabled for cold data tier to reduce storage costs</li>
                </ul>

                <h4>PCI-DSS Correlation Searches</h4>
                <div class="arch-diagram">
Enterprise Security Correlation Searches (Custom):
├── PCI-001: Credit card data in clear text (regex in non-PCI index)
├── PCI-002: POS system accessed from non-POS network segment
├── PCI-003: After-hours POS refund transactions
├── PCI-004: POS malware indicators (RAM scraper signatures)
├── PCI-005: Unauthorized POS software installation
├── PCI-006: PCI segment firewall rule change
├── PCI-007: Excessive card declines (card testing attack)
└── PCI-008: Admin access to POS systems outside change window

Risk-Based Alerting:
├── High-value transaction anomaly (+10 risk per event)
├── Employee discount abuse pattern (+25 risk per day)
├── Gift card fraud indicators (+30 risk per event)
└── Return fraud pattern detection (+20 risk per event)
                </div>
            </div>

            <!-- Example 2: Manufacturing -->
            <div class="config-section">
                <h3>🏭 Case Study: IndustrialTech Manufacturing (12,000 Employees)</h3>
                
                <div class="info-box">
                    <h4>Company Profile</h4>
                    <p><strong>Industry:</strong> Manufacturing | <strong>Employees:</strong> 12,000 | <strong>Sites:</strong> 8 factories + HQ | <strong>OT/ICS:</strong> Yes | <strong>Compliance:</strong> NIST CSF</p>
                </div>

                <h4>IT/OT Converged Architecture</h4>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                 INDUSTRIALTECH - SPLUNK IT/OT DEPLOYMENT                            │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   FACTORY FLOOR (OT Network - Air-Gapped)                                            │
│   ═══════════════════════════════════════                                            │
│                                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │   LEVEL 0-2: INDUSTRIAL CONTROL SYSTEMS                                     │   │
│   │   ═════════════════════════════════════                                     │   │
│   │                                                                             │   │
│   │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐   │   │
│   │   │     PLCs     │  │    HMIs      │  │    SCADA     │  │  Historians  │   │   │
│   │   │  ──────────  │  │  ──────────  │  │  ──────────  │  │  ──────────  │   │   │
│   │   │ • Rockwell   │  │ • Operator   │  │ • Ignition   │  │ • OSIsoft PI │   │   │
│   │   │ • Siemens    │  │   stations   │  │ • Wonderware │  │ • AspenTech  │   │   │
│   │   │ • ABB        │  │ • No agents! │  │              │  │              │   │   │
│   │   └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘   │   │
│   │          │                 │                 │                 │            │   │
│   │          └─────────────────┼─────────────────┼─────────────────┘            │   │
│   │                            │                 │                              │   │
│   │                            ▼                 ▼                              │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                     OT SECURITY STACK                               │   │
│   │   │                     ════════════════════                            │   │
│   │   │                                                                     │   │
│   │   │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐    │   │
│   │   │   │ Claroty/Nozomi  │  │  OT Firewall    │  │  Network TAP    │    │   │
│   │   │   │ (OT NDR)        │  │  (Palo Alto)    │  │  (Gigamon)      │    │   │
│   │   │   │ • Asset disco-  │  │  • IT/OT segmen-│  │  • Full packet  │    │   │
│   │   │   │   very          │  │    tation       │  │    capture      │    │   │
│   │   │   │ • Anomaly det.  │  │  • Allow-list   │  │  • ICS protocol │    │   │
│   │   │   │ • ICS protocols │  │    rules only   │  │    decode       │    │   │
│   │   │   └────────┬────────┘  └────────┬────────┘  └────────┬────────┘    │   │
│   │   │            │                    │                    │             │   │
│   │   └────────────┼────────────────────┼────────────────────┼─────────────┘   │   │
│   │                │                    │                    │                  │   │
│   │                ▼                    ▼                    ▼                  │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                     OT DMZ (Level 3.5)                              │   │   │
│   │   │                     ══════════════════                              │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────────────────────────────────────────────────────────┐   │   │
│   │   │   │              SPLUNK HEAVY FORWARDER                         │   │   │
│   │   │   │              ══════════════════════                         │   │   │
│   │   │   │                                                             │   │   │
│   │   │   │   • Air-gapped from corporate                               │   │   │
│   │   │   │   • Receives: Claroty alerts, OT FW logs, historian data    │   │   │
│   │   │   │   • Forwards via DATA DIODE (one-way) to corporate Splunk   │   │   │
│   │   │   │   • NO return traffic to OT network                         │   │   │
│   │   │   │                                                             │   │   │
│   │   │   │   Specs: 8 vCPU, 32 GB RAM, 500 GB local buffer             │   │   │
│   │   │   │                                                             │   │   │
│   │   │   └─────────────────────────────────────────────────────────────┘   │   │
│   │   │                              │                                      │   │
│   │   │                              │ DATA DIODE                           │   │
│   │   │                              │ (Waterfall, Owl)                     │   │
│   │   │                              │ One-way only ↓                       │   │
│   │   │                              ▼                                      │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                       │
│                                              ▼                                       │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                         CORPORATE IT NETWORK                                │   │
│   │                         ════════════════════                                │   │
│   │                                                                             │   │
│   │   STANDARD IT SOURCES              SPLUNK INFRASTRUCTURE                    │   │
│   │   ════════════════════             ══════════════════════                   │   │
│   │                                                                             │   │
│   │   ┌─────────────────┐             ┌─────────────────────────────────────┐   │   │
│   │   │ Endpoints       │             │         INDEXER CLUSTER             │   │   │
│   │   │ • 10,000 Windows│             │         ════════════════            │   │   │
│   │   │ • 2,000 Linux   │             │                                     │   │   │
│   │   └────────┬────────┘             │   ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐  │   │   │
│   │            │                      │   │IDX-1│ │IDX-2│ │IDX-3│ │IDX-4│  │   │   │
│   │   ┌────────▼────────┐             │   └─────┘ └─────┘ └─────┘ └─────┘  │   │   │
│   │   │ Universal Fwdrs │─────────────│                                     │   │   │
│   │   └─────────────────┘             │   INDEX STRUCTURE:                  │   │   │
│   │                                   │   • idx_ot_scada (OT logs)          │   │   │
│   │   ┌─────────────────┐             │   • idx_ot_network (OT firewall)    │   │   │
│   │   │ Network/Security│             │   • idx_security (IT security)      │   │   │
│   │   │ • Firewalls     │             │   • idx_network (IT network)        │   │   │
│   │   │ • IDS/IPS       │             │   • idx_endpoint (IT endpoints)     │   │   │
│   │   │ • Email gateway │             │                                     │   │   │
│   │   └────────┬────────┘             └─────────────────────────────────────┘   │   │
│   │            │                                     │                          │   │
│   │   ┌────────▼────────┐             ┌──────────────▼──────────────┐          │   │
│   │   │ Heavy Forwarders│─────────────│     SEARCH HEAD CLUSTER     │          │   │
│   │   │ (Syslog recv)   │             │     ════════════════════    │          │   │
│   │   └─────────────────┘             │                             │          │   │
│   │                                   │   ┌─────┐ ┌─────┐ ┌─────┐   │          │   │
│   │   ┌─────────────────┐             │   │SH-1 │ │SH-2 │ │SH-3 │   │          │   │
│   │   │ Cloud Services  │             │   └─────┘ └─────┘ └─────┘   │          │   │
│   │   │ • Azure AD      │             │                             │          │   │
│   │   │ • O365          │─────────────│   APPS INSTALLED:           │          │   │
│   │   │ • AWS (limited) │             │   • Enterprise Security     │          │   │
│   │   └─────────────────┘             │   • Splunk OT Security      │          │   │
│   │                                   │   • MITRE ATT&CK for ICS    │          │   │
│   │                                   │                             │          │   │
│   │                                   └─────────────────────────────┘          │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
│   DAILY INGESTION: ~2 TB/day                                                         │
│   ══════════════════════════                                                         │
│   • IT Endpoints:          600 GB                                                    │
│   • IT Network/Security:   500 GB                                                    │
│   • OT SCADA/Historian:    300 GB (via data diode)                                   │
│   • OT Network (Claroty):  400 GB                                                    │
│   • Cloud/SaaS:            200 GB                                                    │
│                                                                                      │
│   OT-SPECIFIC DETECTIONS:                                                            │
│   • ICS protocol anomaly (Modbus, DNP3, EtherNet/IP)                                │
│   • PLC program change outside change window                                         │
│   • HMI login from unexpected source                                                 │
│   • Safety system modification                                                       │
│   • Historian query from non-engineering workstation                                 │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>

                <h4>OT Security Considerations</h4>
                <ul>
                    <li><strong>Data diode:</strong> One-way data flow from OT to IT, no return path</li>
                    <li><strong>No agents on ICS:</strong> OT devices monitored via network traffic analysis only</li>
                    <li><strong>OT-specific TAs:</strong> Splunk Add-on for OT Security, Claroty TA, Nozomi TA</li>
                    <li><strong>MITRE ATT&CK for ICS:</strong> Detection rules mapped to ICS-specific techniques</li>
                    <li><strong>Separate indexes:</strong> OT data in dedicated indexes with restricted access</li>
                </ul>
            </div>

            <!-- Sizing and Cost -->
            <h2><i class="fas fa-calculator"></i> Sizing Guidelines</h2>

            <div class="config-section">
                <h3>Component Sizing Reference</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Daily Volume</th>
                            <th>Indexers</th>
                            <th>Search Heads</th>
                            <th>Heavy Fwdrs</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt;100 GB</td>
                            <td>1-2 (single)</td>
                            <td>1</td>
                            <td>1-2</td>
                        </tr>
                        <tr>
                            <td>100-500 GB</td>
                            <td>3-4 (cluster)</td>
                            <td>2-3 (SHC)</td>
                            <td>2-4</td>
                        </tr>
                        <tr>
                            <td>500 GB - 2 TB</td>
                            <td>4-8 (cluster)</td>
                            <td>3 (SHC)</td>
                            <td>4-8</td>
                        </tr>
                        <tr>
                            <td>2-5 TB</td>
                            <td>6-12 (multisite)</td>
                            <td>3-5 (SHC)</td>
                            <td>8-16</td>
                        </tr>
                        <tr>
                            <td>&gt;5 TB</td>
                            <td>12+ (multisite)</td>
                            <td>5+ (SHC)</td>
                            <td>16+</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Decision Trees -->
            <h2><i class="fas fa-project-diagram"></i> Architecture Decision Trees</h2>

            <div class="config-section">
                <h3>Decision Tree 1: Deployment Architecture Selection</h3>
                <div class="arch-diagram">
WHAT IS YOUR DAILY INGESTION VOLUME?
│
├─► Less than 50 GB/day
│   └─► Is this a production environment?
│       ├─► NO → Single instance (all-in-one)
│       └─► YES → Do you need HA?
│           ├─► NO → Single indexer + separate search head
│           └─► YES → Consider small cluster (3 indexers, RF=2, SF=2)
│
├─► 50-500 GB/day
│   └─► Do you have DR requirements?
│       ├─► NO → Single-site indexer cluster (3-6 nodes)
│       │   └─► RF=3, SF=2 for data protection
│       └─► YES → Multisite cluster (2 sites)
│           └─► origin:1,total:2 replication strategy
│
├─► 500 GB - 2 TB/day
│   └─► Mandatory: Clustered architecture
│       └─► Are there data residency requirements?
│           ├─► NO → Multisite with DR (6-10 indexers)
│           └─► YES → Multi-cluster federation
│               └─► Separate clusters per region, search head connecting to both
│
└─► Greater than 2 TB/day
    └─► Enterprise architecture required
        ├─► Consider SmartStore for cost optimization
        ├─► Multisite clustering mandatory
        ├─► SHC with 5+ members
        └─► Dedicated management cluster
                </div>

                <h3>Decision Tree 2: Forwarder Selection</h3>
                <div class="arch-diagram">
WHAT TYPE OF DATA SOURCE?
│
├─► Windows/Linux endpoint logs
│   └─► Any transformation needed before indexing?
│       ├─► NO → Universal Forwarder (UF)
│       │   └─► Minimal footprint, 20MB RAM, no parsing
│       └─► YES → Is it volume > 100 GB/day from this source?
│           ├─► NO → Heavy Forwarder (HF) on central server
│           └─► YES → Multiple HFs with load balancer
│
├─► Syslog sources (network devices, firewalls)
│   └─► Heavy Forwarder with Syslog-ng or rsyslog
│       └─► Do you need real-time parsing decisions?
│           ├─► NO → Forward raw, parse at indexer
│           └─► YES → Parse at HF with props.conf/transforms.conf
│               └─► Use for: Data masking, routing, enrichment
│
├─► Cloud data (AWS, Azure, GCP)
│   └─► Use cloud-native inputs
│       ├─► AWS: Splunk Add-on via SQS/S3
│       ├─► Azure: Event Hub with HF
│       └─► GCP: Pub/Sub with HF
│
└─► High-security zone (DMZ, OT)
    └─► Can you install agents?
        ├─► NO → Network TAP + HF for traffic analysis
        └─► YES → UF with persistent queue enabled
            └─► buffer="true" maxSize=1GB for network outages
                </div>

                <h3>Decision Tree 3: Search Head Architecture</h3>
                <div class="arch-diagram">
HOW MANY CONCURRENT USERS?
│
├─► Less than 10 users
│   └─► Single search head sufficient
│       └─► Consider: Report acceleration, summary indexing
│
├─► 10-50 users
│   └─► Is this Enterprise Security or heavy dashboard use?
│       ├─► NO → Single search head with good hardware
│       │   └─► 16 cores, 64GB RAM, SSD
│       └─► YES → Search Head Cluster (3 members minimum)
│           └─► Load balancer in front
│
├─► 50-200 users
│   └─► Search Head Cluster mandatory
│       └─► Do you have multiple use cases (ES, IT, DevOps)?
│           ├─► NO → Single SHC (3-5 members)
│           └─► YES → Consider dedicated SHCs per use case
│               └─► ES SHC, ITSI SHC, General SHC
│
└─► Greater than 200 users
    └─► Multiple SHCs required
        ├─► Dedicated ES cluster for security team
        ├─► General-purpose SHC for other users
        └─► Consider: Search head pooling for scheduled searches
            └─► Separate SH pool for heavy scheduled reports
                </div>
            </div>

            <!-- What Enterprises Usually Miss -->
            <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>

            <div class="grid-2col">
                <div class="info-card critical">
                    <h4><i class="fas fa-times-circle"></i> Critical Gaps</h4>
                    <ul>
                        <li><strong>Undersized indexers:</strong> Sizing based on storage only, ignoring CPU/RAM for search performance</li>
                        <li><strong>No clustering:</strong> Running production on single indexer with no redundancy</li>
                        <li><strong>RF=SF=1:</strong> Data loss when any indexer fails, zero search resilience</li>
                        <li><strong>No forwarder management:</strong> No deployment server, manual config on 1000+ forwarders</li>
                        <li><strong>Everything on search head:</strong> Apps, dashboards, reports, scheduled searches on single SH</li>
                    </ul>
                </div>

                <div class="info-card warning">
                    <h4><i class="fas fa-exclamation-triangle"></i> Common Warnings</h4>
                    <ul>
                        <li><strong>No capacity planning:</strong> License purchased without infrastructure sizing</li>
                        <li><strong>Single-site deployment:</strong> No DR plan, complete outage on site failure</li>
                        <li><strong>UF everywhere:</strong> Using UF where HF needed for parsing, causing indexer overload</li>
                        <li><strong>Network bottlenecks:</strong> Forwarders saturating WAN links, no QoS or scheduling</li>
                        <li><strong>No monitoring:</strong> Splunk itself not monitored (DMC not configured)</li>
                    </ul>
                </div>

                <div class="info-card info">
                    <h4><i class="fas fa-info-circle"></i> Often Overlooked</h4>
                    <ul>
                        <li><strong>Certificate expiration:</strong> No monitoring of Splunk SSL certificates</li>
                        <li><strong>No bundle replication monitoring:</strong> Knowledge bundles failing silently</li>
                        <li><strong>Time sync issues:</strong> Forwarders with clock drift causing timestamp problems</li>
                        <li><strong>Storage tiering:</strong> All data on expensive SSD, no SmartStore consideration</li>
                        <li><strong>License pool misconfig:</strong> Test and prod sharing license pool</li>
                    </ul>
                </div>

                <div class="info-card success">
                    <h4><i class="fas fa-check-circle"></i> Best Practices</h4>
                    <ul>
                        <li><strong>Capacity alerts:</strong> Alert at 70% disk, 80% license, 90% CPU</li>
                        <li><strong>DMC configured:</strong> Distributed Management Console for cluster health</li>
                        <li><strong>Deployment server:</strong> All forwarder configs managed centrally</li>
                        <li><strong>Index segregation:</strong> Separate indexes by data type and retention</li>
                        <li><strong>Documentation:</strong> Architecture diagrams, runbooks, DR procedures</li>
                    </ul>
                </div>
            </div>

            <!-- Interview Q&A -->
            <h2><i class="fas fa-comments"></i> Interview Questions</h2>

            <div class="qa-section">
                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Explain the difference between Universal Forwarder and Heavy Forwarder.</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Universal Forwarder is lightweight (~20MB RAM) and does minimal processing - it just collects logs and forwards them. It cannot parse, transform, or route data. Heavy Forwarder is a full Splunk instance that can parse logs (props.conf/transforms.conf), route to different destinations, mask sensitive data, and run searches. I use UF for standard collection from endpoints and servers, HF for syslog aggregation, data masking requirements (like PCI-DSS), and when I need to pre-process data before indexing."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What are Search Factor and Replication Factor?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Replication Factor (RF) is how many copies of raw data exist across the cluster - RF=2 means every bucket exists on 2 indexers. Search Factor (SF) is how many searchable copies exist - SF=2 means you can search data even if one indexer is down. SF must always be less than or equal to RF. For production, I typically recommend RF=3, SF=2 for single-site, and for multisite clusters: site_replication_factor=origin:1,total:2 meaning 1 copy at primary, 2 total copies across sites."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How would you design Splunk for a company with 500 retail stores?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "I'd design a hub-and-spoke model: Universal Forwarders on POS systems at each store forwarding to either a local Heavy Forwarder (for large stores needing buffering during WAN outages and PCI data masking) or directly to HQ (small stores). At HQ, I'd have Heavy Forwarder pairs for receiving and processing, then an indexer cluster with multisite replication to a DR site. Critical for retail: PCI-DSS compliance means masking card data at the Heavy Forwarder before indexing using SEDCMD in transforms.conf. I'd separate indexes by data type for different retention requirements and RBAC."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What's the difference between search-time and index-time knowledge?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Index-time operations happen once when data is ingested - timestamps, line breaking, source/sourcetype assignment, and field extractions configured with INDEXED_EXTRACTIONS. These can't be changed after ingestion. Search-time operations happen during each search - field extractions, lookups, calculated fields, event types, tags. The tradeoff: index-time is faster for searches but inflexible and increases storage. I use index-time only for: timestamp extraction (mandatory), line breaking (mandatory), and high-cardinality fields I'll filter on constantly. Everything else is search-time for flexibility."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you handle a Splunk cluster where one indexer is consistently slow?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "I'd follow a systematic approach:</p>
                        <p><strong>1. Identify the bottleneck:</strong> Check DMC for that indexer - is it CPU, memory, disk I/O, or network?</p>
                        <p><strong>2. Check bucket distribution:</strong> Look at 'splunk list cluster-buckets' - is this indexer holding disproportionate hot buckets?</p>
                        <p><strong>3. Review scheduled searches:</strong> Check if expensive searches are pinned to this indexer via search affinity.</p>
                        <p><strong>4. Storage check:</strong> Run 'iostat' and check if disk is saturated. Verify all indexers have same storage class.</p>
                        <p><strong>5. Network:</strong> Check forwarder connections - is this indexer receiving more data due to load balancer misconfiguration?</p>
                        <p><strong>Remediation:</strong> If hardware issue, rebalance buckets to other peers. If it's a hot bucket imbalance, adjust maxHotBuckets. If network overload, check outputs.conf autoLB settings on forwarders."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: You need to migrate 2 TB/day Splunk to a new data center with zero downtime. Walk me through your approach.</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "This is a major undertaking. Here's my phased approach:</p>
                        <p><strong>Phase 1 - Parallel Build (2-4 weeks):</strong> Build new cluster in target DC. Don't migrate - rebuild clean. Replicate all configurations using deployment apps, not manual copy.</p>
                        <p><strong>Phase 2 - Dual-Write (1-2 weeks):</strong> Configure forwarders with indexer discovery or outputs.conf pointing to BOTH clusters. Data flows to both during transition. Validate data parity.</p>
                        <p><strong>Phase 3 - Search Migration:</strong> Point search heads to new indexers first. Users search new environment while old still receives data as backup.</p>
                        <p><strong>Phase 4 - Cutover:</strong> Update forwarders to point only to new cluster. Use deployment server for controlled rollout - 10% of forwarders first, monitor, then expand.</p>
                        <p><strong>Phase 5 - Historical Data:</strong> If needed, use 'splunk offline' to export buckets from old cluster and import to new. Or keep old cluster read-only for historical searches.</p>
                        <p><strong>Key safeguard:</strong> Persistent queues on forwarders during transition prevent data loss if either cluster has issues."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What's your approach to monitoring Splunk itself?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "I use a layered monitoring strategy:</p>
                        <p><strong>Layer 1 - Splunk Internal Logs:</strong> _internal, _audit, _introspection indexes. Key searches: indexer queue fill ratio > 90%, search head memory pressure, license warnings.</p>
                        <p><strong>Layer 2 - Distributed Management Console (DMC):</strong> Configure for all cluster components. I set up alerts for: indexer cluster health (not all peers up), search head cluster captain changes, forwarder connection drops > 5%.</p>
                        <p><strong>Layer 3 - External Monitoring:</strong> This is critical - you can't rely only on Splunk to tell you Splunk is down. I use Prometheus/Grafana or Nagios for: TCP port checks (9997, 8089, 8000), disk space on all nodes, process monitoring, SSL certificate expiration.</p>
                        <p><strong>Layer 4 - Synthetic Monitoring:</strong> Scheduled search that writes to summary index and alerts if it doesn't run. This catches 'search head looks fine but nothing actually works' scenarios."</p>
                        <div class="arch-diagram">
# Critical DMC Alert Examples
index=_internal sourcetype=splunkd log_level=ERROR
| stats count by host component
| where count > 10

index=_internal source=*metrics.log group=queue
| stats avg(current_size_kb) as avg_queue by name host
| where avg_queue > 500

index=_internal sourcetype=splunkd component=LicenseUsage
| stats sum(b) as bytes by _time host
| timechart span=1h sum(bytes) as daily_usage
                        </div>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you size a Splunk deployment for 1 TB/day ingestion?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "For 1 TB/day, here's my sizing calculation:</p>
                        <p><strong>Indexers:</strong> Rule of thumb is 100-300 GB/day per indexer depending on search load. For 1 TB with moderate searching, I'd plan 5-6 indexers to allow headroom.</p>
                        <p><strong>Storage:</strong> 1 TB/day × 90 days retention × 0.5 (compression) = 45 TB raw storage. With RF=2, that's 90 TB across the cluster. Each indexer: 15-18 TB. I'd use NVMe for hot/warm, consider SmartStore for cost optimization.</p>
                        <p><strong>Search Heads:</strong> 3-node SHC minimum. If running ES, dedicated ES SHC with 3 members.</p>
                        <p><strong>Heavy Forwarders:</strong> Depends on sources, but typically 4-6 HFs for syslog aggregation and parsing.</p>
                        <p><strong>Hardware per indexer:</strong> 16-24 cores, 64-128 GB RAM, 15 TB NVMe storage.</p>
                        <p><strong>License:</strong> 1 TB/day license, but I'd negotiate 1.2 TB to handle spikes without violations.</p>
                        <p><strong>Network:</strong> 10 Gbps between all components. At 1 TB/day, you're pushing ~100 Mbps sustained, but bursts can hit 1 Gbps."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What's your strategy for a multisite cluster with strict data residency requirements?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Data residency adds significant complexity. Here's my approach:</p>
                        <p><strong>Option 1 - Single Multisite Cluster with Constraints:</strong> If data can replicate between sites but searches must respect residency: use site_search_factor to ensure searchable copies exist only in compliant sites. Configure search heads with site affinity.</p>
                        <p><strong>Option 2 - Federated Clusters (Preferred for strict compliance):</strong> Separate clusters per region, each fully independent. Search heads can connect to multiple clusters for cross-region queries, but data never leaves its cluster.</p>
                        <div class="arch-diagram">
# Multisite with residency constraints (server.conf)
[clustering]
mode = manager
multisite = true
site_replication_factor = origin:2,site1:1,site2:1,total:3
site_search_factor = origin:1,site1:1,site2:1,total:2

# For EU data only in EU site:
# Route EU sources to EU-specific indexes
# Configure EU indexes with site_replication_factor = origin:2,site1:2,total:2
# (site1 = EU, this keeps all copies in EU)
                        </div>
                        <p><strong>Key considerations:</strong> Document data flows for auditors, implement RBAC so non-compliant users can't access restricted indexes, and use data classification tags to track sensitive data through the pipeline."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How would you troubleshoot 'search taking too long' complaints from users?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "This is one of the most common issues. My troubleshooting framework:</p>
                        <p><strong>1. Identify the specific search:</strong> Get the search string, time range, and user. Check Job Inspector for that search.</p>
                        <p><strong>2. Job Inspector analysis:</strong> Look at: events scanned vs returned (if ratio > 1000:1, inefficient filtering), time per component (is it command execution or disk I/O?), search peers participating.</p>
                        <p><strong>3. Common culprits:</strong></p>
                        <ul>
                            <li><strong>All-time searches:</strong> Restrict to 24h or 7d</li>
                            <li><strong>Leading wildcard:</strong> *password instead of password* forces full scan</li>
                            <li><strong>No index specified:</strong> Searching all indexes instead of index=specific</li>
                            <li><strong>Expensive commands early:</strong> Move stats/eval after filtering</li>
                            <li><strong>Non-accelerated data models:</strong> If using tstats, verify acceleration is current</li>
                        </ul>
                        <p><strong>4. Infrastructure check:</strong> If multiple users complain, check DMC for cluster health. Look for: indexer with high CPU, search head memory pressure, network saturation.</p>
                        <div class="arch-diagram">
# Find expensive searches in last hour
index=_audit action=search info=completed
| stats avg(total_run_time) as avg_time max(total_run_time) as max_time by user search
| where max_time > 300
| sort -max_time
                        </div>
                    </div>
                </div>
            </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>