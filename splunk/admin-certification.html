<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Splunk Enterprise Admin Certification | Complete Prep Guide</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .cert-domain { background: linear-gradient(135deg, #1a1f35 0%, #2d3555 100%); border: 1px solid #404968; border-radius: 12px; padding: 24px; margin: 20px 0; }
        .cert-domain h3 { color: #58a6ff; margin-top: 0; border-bottom: 2px solid #58a6ff; padding-bottom: 10px; }
        .domain-weight { background: #238636; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85em; float: right; }
        .objective-list { list-style: none; padding: 0; }
        .objective-list li { padding: 12px 16px; margin: 8px 0; background: #0d1117; border-radius: 6px; border-left: 4px solid #30363d; }
        .objective-list li:hover { border-left-color: #58a6ff; }
        .objective-list li.covered { border-left-color: #238636; }
        .objective-list li.partial { border-left-color: #d29922; }
        .objective-list li.gap { border-left-color: #f85149; }
        .status-icon { margin-right: 10px; }
        .config-ref { font-family: monospace; background: #161b22; padding: 2px 6px; border-radius: 4px; color: #79c0ff; }
        .exam-tip { background: linear-gradient(135deg, #1a472a 0%, #2d5a3d 100%); border: 1px solid #3d8b5a; border-radius: 8px; padding: 16px; margin: 16px 0; }
        .exam-tip h4 { color: #7ce38b; margin-top: 0; }
        .practice-q { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 12px 0; }
        .practice-q .question { color: #c9d1d9; font-weight: 600; margin-bottom: 12px; }
        .practice-q .options { padding-left: 20px; }
        .practice-q .options label { display: block; padding: 8px; margin: 4px 0; border-radius: 4px; cursor: pointer; }
        .practice-q .options label:hover { background: #21262d; }
        .cli-table { width: 100%; border-collapse: collapse; margin: 16px 0; }
        .cli-table th, .cli-table td { padding: 12px; text-align: left; border-bottom: 1px solid #30363d; }
        .cli-table th { background: #161b22; color: #58a6ff; }
        .cli-table code { background: #0d1117; padding: 2px 6px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <i class="fas fa-shield-alt"></i>
                    <span>Nik's SIEM</span>
                </a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Platforms</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link active"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certification Prep</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-certificate"></i><span>Power User Cert</span></a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link active"><i class="fas fa-user-cog"></i><span>Admin Cert</span></a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i><span>ES Admin Cert</span></a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud Admin Cert</span></a></li>
                    </ul>
                </div>
            </div>
        </aside>
        
        <div class="main-wrapper" id="mainWrapper">
            <main class="main-content">
                <h1><i class="fas fa-user-cog"></i> Splunk Enterprise Certified Admin</h1>
                <p class="lead">Complete preparation guide for SPLK-1003 certification exam. Master Splunk administration from installation to distributed deployments.</p>

                <!-- Exam Overview -->
                <div class="info-box info-box-info">
                    <h4>Exam Details - SPLK-1003</h4>
                    <table class="compact-table">
                        <tr><td><strong>Duration:</strong></td><td>57 minutes</td></tr>
                        <tr><td><strong>Questions:</strong></td><td>57 multiple choice</td></tr>
                        <tr><td><strong>Passing Score:</strong></td><td>70%</td></tr>
                        <tr><td><strong>Prerequisites:</strong></td><td>Splunk Core Certified Power User</td></tr>
                        <tr><td><strong>Recommended Experience:</strong></td><td>6-12 months administering Splunk</td></tr>
                        <tr><td><strong>Cost:</strong></td><td>$130 USD</td></tr>
                    </table>
                </div>

                <!-- Domain 1: Splunk Admin Basics -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">5%</span>Domain 1: Splunk Admin Basics</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>1.1</strong> Identify Splunk components (Indexer, Search Head, Forwarder, Deployment Server)</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>1.2</strong> Understand Splunk installation types and requirements</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>1.3</strong> Navigate Splunk Web interface and Settings</li>
                    </ul>

                    <h4>Key Concepts</h4>
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Splunk Components</span>
                        </div>
                        <pre><code>SPLUNK ENTERPRISE COMPONENTS
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────┬────────────────────────────────────────────────────────────┐
│ Component       │ Function                                                   │
├─────────────────┼────────────────────────────────────────────────────────────┤
│ Indexer         │ Stores and indexes data, responds to search requests       │
│ Search Head     │ Handles search requests, serves Splunk Web UI              │
│ Forwarder       │ Collects and forwards data to indexers                     │
│ - Universal     │ Lightweight, forwards raw/parsed data (recommended)        │
│ - Heavy         │ Full Splunk, can parse/filter before forwarding            │
│ Deployment Srv  │ Manages configurations for forwarder fleet                 │
│ Cluster Master  │ Manages indexer cluster (now called Manager Node)          │
│ License Master  │ Manages license pool for all Splunk instances              │
│ Monitoring Con. │ Provides visibility into Splunk deployment health          │
└─────────────────┴────────────────────────────────────────────────────────────┘

INSTALLATION REQUIREMENTS (Linux - Production)
─────────────────────────────────────────────────────────────────────────────
• OS: RHEL/CentOS 7-8, Ubuntu 18.04+, Amazon Linux 2
• CPU: 12+ cores (indexer), 16+ cores (search head)
• RAM: 12GB minimum, 32GB+ recommended for production
• Disk: SSD recommended, RAID 10 for indexers
• File System: ext4 or XFS (NOT NFS for $SPLUNK_DB)
• User: Non-root user (e.g., splunk) with ulimit configured

# Check ulimits
ulimit -n    # Open files (need 64000+)
ulimit -u    # User processes (need 16000+)

# /etc/security/limits.conf
splunk  soft  nofile  64000
splunk  hard  nofile  64000
splunk  soft  nproc   16000
splunk  hard  nproc   16000</code></pre>
                    </div>

                    <div class="practice-q">
                        <div class="question">Q: Which Splunk component is responsible for parsing data at index time?</div>
                        <div class="options">
                            <label><input type="radio" name="q1"> A) Search Head</label>
                            <label><input type="radio" name="q1"> B) Universal Forwarder</label>
                            <label><input type="radio" name="q1" checked> C) Indexer</label>
                            <label><input type="radio" name="q1"> D) Deployment Server</label>
                        </div>
                        <details style="margin-top: 12px; color: #8b949e;">
                            <summary>Show Answer</summary>
                            <p><strong>C) Indexer</strong> - The indexer performs index-time parsing using props.conf and transforms.conf. Universal Forwarders do NOT parse data (Heavy Forwarders can).</p>
                        </details>
                    </div>
                </div>

                <!-- Domain 2: License Management -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">5%</span>Domain 2: License Management</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>2.1</strong> Identify license types (Enterprise, Free, Dev/Test)</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>2.2</strong> Understand license pools and stacking</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>2.3</strong> Monitor license usage and violations</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>2.4</strong> Configure license master/slave relationships</li>
                    </ul>

                    <h4>Key Concepts</h4>
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">License Management</span>
                        </div>
                        <pre><code>LICENSE TYPES
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────┬──────────┬─────────────────────────────────────────────────┐
│ License Type    │ Volume   │ Features                                        │
├─────────────────┼──────────┼─────────────────────────────────────────────────┤
│ Enterprise      │ Varies   │ Full features, alerting, authentication         │
│ Free            │ 500MB/day│ No alerting, no auth, no distributed search     │
│ Dev/Test        │ Varies   │ Full features, not for production               │
│ Forwarder       │ N/A      │ Built into UF, no indexing capability           │
└─────────────────┴──────────┴─────────────────────────────────────────────────┘

LICENSE VIOLATION RULES
─────────────────────────────────────────────────────────────────────────────
• Daily license quota resets at midnight (configurable)
• WARNING: Exceeding quota on 1-4 days in 30-day window
• VIOLATION: Exceeding quota on 5+ days in 30-day window
• VIOLATION IMPACT: Search disabled until violation clears

LICENSE POOLS
─────────────────────────────────────────────────────────────────────────────
• Stack multiple licenses into a single pool
• Assign indexers to specific pools for chargeback
• Monitor: Settings → Licensing → License Usage Report

# Check license usage via REST
curl -k -u admin:password https://localhost:8089/services/licenser/usage

# License master configuration (on license master)
# server.conf
[license]
master_uri = self

# License slave configuration (on indexers)
# server.conf  
[license]
master_uri = https://license-master:8089</code></pre>
                    </div>

                    <div class="exam-tip">
                        <h4><i class="fas fa-lightbulb"></i> Exam Tip</h4>
                        <p>Know the 5-violation rule! If you exceed your daily license quota on <strong>5 or more days</strong> within a rolling 30-day window, searching is disabled. This is a common exam question.</p>
                    </div>
                </div>

                <!-- Domain 3: Splunk Configuration Files -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">15%</span>Domain 3: Splunk Configuration Files</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>3.1</strong> Understand configuration file precedence</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>3.2</strong> Configure inputs.conf for data collection</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>3.3</strong> Configure outputs.conf for forwarding</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>3.4</strong> Configure props.conf for parsing</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>3.5</strong> Configure transforms.conf for field extractions</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>3.6</strong> Configure indexes.conf for index settings</li>
                        <li class="partial"><span class="status-icon">⚠️</span><strong>3.7</strong> Configure server.conf for server settings</li>
                        <li class="partial"><span class="status-icon">⚠️</span><strong>3.8</strong> Configure limits.conf for resource limits</li>
                        <li class="partial"><span class="status-icon">⚠️</span><strong>3.9</strong> Use btool to troubleshoot configurations</li>
                    </ul>

                    <h4>Configuration File Precedence (CRITICAL!)</h4>
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Configuration Precedence Order</span>
                        </div>
                        <pre><code>CONFIGURATION FILE LOCATIONS (Highest to Lowest Priority)
═══════════════════════════════════════════════════════════════════════════════

1. $SPLUNK_HOME/etc/system/local/          ← HIGHEST (User customizations)
2. $SPLUNK_HOME/etc/apps/<app>/local/      ← App-specific customizations
3. $SPLUNK_HOME/etc/apps/<app>/default/    ← App defaults
4. $SPLUNK_HOME/etc/system/default/        ← LOWEST (Splunk defaults - NEVER EDIT)

WITHIN SAME DIRECTORY - Alphabetical by app name (Z wins over A)

STANZA MERGING RULES
─────────────────────────────────────────────────────────────────────────────
• Settings MERGE across files (not replace entire stanza)
• Later files override earlier files for same setting
• To "unset" a value, use empty value or delete in local

EXAMPLE: props.conf Precedence
─────────────────────────────────────────────────────────────────────────────
# /etc/system/default/props.conf (Splunk default)
[syslog]
TIME_FORMAT = %b %d %H:%M:%S

# /etc/apps/Splunk_TA_nix/default/props.conf (App default)
[syslog]
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 32

# /etc/system/local/props.conf (Your customization)
[syslog]
TIME_FORMAT = %Y-%m-%d %H:%M:%S    ← THIS WINS for TIME_FORMAT

# FINAL MERGED RESULT:
[syslog]
TIME_FORMAT = %Y-%m-%d %H:%M:%S    ← From system/local
MAX_TIMESTAMP_LOOKAHEAD = 32        ← From TA (not overridden)</code></pre>
                    </div>

                    <h4>Essential Configuration Files</h4>
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">inputs.conf - Data Collection</span>
                        </div>
                        <pre><code># Monitor a file/directory
[monitor:///var/log/messages]
disabled = false
index = os
sourcetype = syslog
whitelist = \.log$
blacklist = \.gz$

# Monitor Windows Event Logs
[WinEventLog://Security]
disabled = 0
index = wineventlog
evt_resolve_ad_obj = 1

# TCP Input (receive syslog)
[tcp://514]
index = network
sourcetype = syslog
connection_host = dns

# UDP Input
[udp://514]
index = network
sourcetype = syslog

# HTTP Event Collector (HEC)
[http://mytoken]
disabled = 0
index = main
token = your-token-guid</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">outputs.conf - Data Forwarding</span>
                        </div>
                        <pre><code># Forward to indexer cluster (load balanced)
[tcpout]
defaultGroup = indexers

[tcpout:indexers]
server = idx1.company.com:9997, idx2.company.com:9997, idx3.company.com:9997
autoLBFrequency = 30
useACK = true           # Indexer acknowledgment (prevents data loss)
compressed = true

# Forward to specific indexers by sourcetype
[tcpout:security_indexers]
server = secidx1:9997, secidx2:9997

# Routing rules (send security logs to security indexers)
[indexAndForward]
index = false           # Don't index locally (forwarder only)

# Syslog output (forward to external SIEM)
[syslog:external_siem]
server = siem.company.com:514
type = udp</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">props.conf - Parsing Configuration</span>
                        </div>
                        <pre><code># Timestamp extraction
[my_custom_log]
TIME_PREFIX = timestamp=
TIME_FORMAT = %Y-%m-%d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 25
TZ = America/Toronto

# Line breaking
LINE_BREAKER = ([\r\n]+)
SHOULD_LINEMERGE = false
TRUNCATE = 10000

# Character encoding
CHARSET = UTF-8

# Field extraction at index time
TRANSFORMS-extract = extract_fields_mylog

# Rename sourcetype
TRANSFORMS-setsourcetype = set_sourcetype_mylog

# Event truncation
TRUNCATE = 100000</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">transforms.conf - Field Extractions</span>
                        </div>
                        <pre><code># Field extraction
[extract_fields_mylog]
REGEX = user=(\w+)\s+action=(\w+)\s+status=(\w+)
FORMAT = user::$1 action::$2 status::$3

# Index routing based on sourcetype
[route_to_security]
REGEX = .
DEST_KEY = _MetaData:Index
FORMAT = security

# Sourcetype override
[set_sourcetype_mylog]
REGEX = ^ERROR
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::mylog_errors

# Field aliasing
[alias_src_to_source]
REGEX = src_ip=(\S+)
FORMAT = src::$1

# Null queue (drop events)
[drop_debug_events]
REGEX = DEBUG
DEST_KEY = queue
FORMAT = nullQueue</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">indexes.conf - Index Configuration</span>
                        </div>
                        <pre><code># Custom index
[security]
homePath = $SPLUNK_DB/security/db
coldPath = $SPLUNK_DB/security/colddb
thawedPath = $SPLUNK_DB/security/thaweddb
maxDataSize = auto_high_volume    # 10GB buckets for high-volume
maxHotBuckets = 10
maxWarmDBCount = 300

# Retention settings
frozenTimePeriodInSecs = 31536000  # 1 year (365 days)
maxTotalDataSizeMB = 500000        # 500GB total

# Cold to frozen (archive vs delete)
coldToFrozenDir = /archive/splunk/security   # Archive
# OR
coldToFrozenScript = /opt/splunk/bin/archive.sh

# SmartStore (Splunk Cloud / S3)
remotePath = volume:s3_remote/security</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">server.conf - Server Configuration</span>
                        </div>
                        <pre><code># General settings
[general]
serverName = idx01.company.com
pass4SymmKey = your_encryption_key    # Must match across cluster

# SSL configuration
[sslConfig]
sslVersions = tls1.2
sslPassword = password
enableSplunkdSSL = true

# Clustering (indexer cluster member)
[clustering]
mode = slave                          # peer in newer versions
master_uri = https://cm:8089
pass4SymmKey = cluster_secret

# Clustering (cluster master/manager)
[clustering]
mode = master
replication_factor = 3
search_factor = 2
pass4SymmKey = cluster_secret

# Search head clustering
[shclustering]
disabled = false
mgmt_uri = https://sh01:8089
replication_factor = 3
conf_deploy_fetch_url = https://deployer:8089

# License slave
[license]
master_uri = https://license-master:8089

# Deployment client
[deployment]
pass4SymmKey = deployment_secret</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">limits.conf - Resource Limits</span>
                        </div>
                        <pre><code># Search limits
[searchresults]
maxresultrows = 50000           # Max rows returned
max_matches_by_default = 100000 # Default match limit

[search]
max_searches_per_cpu = 4        # Concurrent searches per CPU
base_max_searches = 6           # Base concurrent searches
max_rt_search_multiplier = 1    # Real-time search multiplier

# KV Store limits
[kvstore]
max_documents_per_batch_save = 1000
max_queries_per_batch = 1000

# Lookup limits
[lookup]
max_memtable_bytes = 10000000   # 10MB lookup in memory

# Export limits
[export]
maxresultrows = 10000000        # Max export rows

# Subsearch limits  
[subsearch]
maxout = 10000                  # Max results from subsearch
maxtime = 60                    # Max subsearch runtime (seconds)
ttl = 300                       # Subsearch cache TTL</code></pre>
                    </div>

                    <h4>btool - Configuration Troubleshooting</h4>
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">btool Commands</span>
                        </div>
                        <pre><code># Check effective configuration for a file
./splunk btool props list --debug
./splunk btool inputs list --debug
./splunk btool outputs list --debug

# Check specific stanza
./splunk btool props list syslog --debug

# Check for syntax errors
./splunk btool check

# List all apps
./splunk btool server list --debug | grep -i app

# Common btool flags
--debug     # Show which file each setting comes from
--app=      # Filter by specific app
--user=     # Check user-level configs

# Example output interpretation
# /opt/splunk/etc/apps/search/local/props.conf  [syslog]
# /opt/splunk/etc/system/local/props.conf       TIME_FORMAT = %b %d %H:%M:%S
                         ↑
         This shows the file providing the setting</code></pre>
                    </div>

                    <div class="practice-q">
                        <div class="question">Q: An admin creates props.conf in both /etc/system/local/ and /etc/apps/myapp/local/. Which takes precedence?</div>
                        <div class="options">
                            <label><input type="radio" name="q3"> A) /etc/system/local/ always wins</label>
                            <label><input type="radio" name="q3"> B) /etc/apps/myapp/local/ always wins</label>
                            <label><input type="radio" name="q3" checked> C) /etc/system/local/ wins (system/local has highest precedence)</label>
                            <label><input type="radio" name="q3"> D) They merge completely with no precedence</label>
                        </div>
                        <details style="margin-top: 12px; color: #8b949e;">
                            <summary>Show Answer</summary>
                            <p><strong>C) /etc/system/local/ wins</strong> - system/local has the highest precedence. The order is: system/local > apps/*/local > apps/*/default > system/default</p>
                        </details>
                    </div>
                </div>

                <!-- Domain 4: Indexes -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">10%</span>Domain 4: Indexes</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>4.1</strong> Create and configure indexes</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>4.2</strong> Understand bucket lifecycle (hot → warm → cold → frozen)</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>4.3</strong> Configure data retention policies</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>4.4</strong> Manage frozen data (archive/delete)</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Bucket Lifecycle</span>
                        </div>
                        <pre><code>INDEX BUCKET LIFECYCLE
═══════════════════════════════════════════════════════════════════════════════

┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────────────┐
│   HOT   │───▶│  WARM   │───▶│  COLD   │───▶│ FROZEN/DELETED  │
└─────────┘    └─────────┘    └─────────┘    └─────────────────┘
 Actively      Rolled from     Oldest         Archived or
 written       hot, still      searchable     deleted
               searchable      data

BUCKET STATES
─────────────────────────────────────────────────────────────────────────────
• HOT: Currently being written to (1 per index by default)
  - Location: homePath
  - Rolls when: maxDataSize reached OR time threshold

• WARM: No longer written to, still searchable
  - Location: homePath
  - Rolls to cold when: maxWarmDBCount exceeded

• COLD: Oldest searchable data
  - Location: coldPath (can be slower/cheaper storage)
  - Rolls to frozen when: frozenTimePeriodInSecs exceeded
                     OR maxTotalDataSizeMB exceeded

• FROZEN: No longer searchable
  - Default: DELETED
  - Optional: Archive with coldToFrozenDir or coldToFrozenScript

KEY SETTINGS
─────────────────────────────────────────────────────────────────────────────
[myindex]
# Bucket sizing
maxDataSize = auto_high_volume  # auto (750MB), auto_high_volume (10GB)
maxHotBuckets = 3               # Max concurrent hot buckets

# Retention by time
frozenTimePeriodInSecs = 31536000   # 365 days

# Retention by size
maxTotalDataSizeMB = 500000    # 500GB, oldest data rolls first
homePath.maxDataSizeMB = 200000  # Hot/warm limit
coldPath.maxDataSizeMB = 300000  # Cold limit

# Archive instead of delete
coldToFrozenDir = /archive/$_index_name

# Thawed data location (for restoring frozen)
thawedPath = $SPLUNK_DB/myindex/thaweddb</code></pre>
                    </div>

                    <div class="exam-tip">
                        <h4><i class="fas fa-lightbulb"></i> Exam Tip</h4>
                        <p>Remember: <code>frozenTimePeriodInSecs</code> is measured from the <strong>newest event in the bucket</strong>, not the oldest. A bucket freezes when its newest event is older than the frozen time period.</p>
                    </div>
                </div>

                <!-- Domain 5: Users, Roles, and Authentication -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">10%</span>Domain 5: Users, Roles, and Authentication</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>5.1</strong> Create and manage users</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>5.2</strong> Create and configure roles</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>5.3</strong> Understand role inheritance</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>5.4</strong> Configure index access and capabilities</li>
                        <li class="partial"><span class="status-icon">⚠️</span><strong>5.5</strong> Configure LDAP/SAML authentication</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">authorize.conf - Roles Configuration</span>
                        </div>
                        <pre><code># Custom role example
[soc_analyst]
# Inherit from user role
importRoles = user

# Index access
srchIndexesAllowed = main;security;network;wineventlog
srchIndexesDefault = security

# Search restrictions
srchFilter = index=security OR index=network
srchTimeWin = 7776000      # 90 days max search window

# Capabilities
capabilities = edit_own_objects;list_inputs;search;schedule_search

# Resource limits  
srchJobsQuota = 10         # Concurrent searches
rtSrchJobsQuota = 3        # Real-time searches
srchDiskQuota = 1000       # MB of disk for search artifacts

# Search head cluster (SHC) role
[soc_manager]
importRoles = soc_analyst
capabilities = edit_search_head_clustering;edit_roles
srchIndexesAllowed = *

BUILT-IN ROLES
─────────────────────────────────────────────────────────────────────────────
• admin: Full access, all capabilities
• power: Schedule searches, create alerts, share objects
• user: Basic search, personal objects only
• can_delete: Delete data by search (dangerous!)

KEY CAPABILITIES
─────────────────────────────────────────────────────────────────────────────
• admin_all_objects: Edit all objects regardless of owner
• change_authentication: Modify auth settings
• delete_by_keyword: Use | delete command
• edit_roles: Create/modify roles
• edit_user: Create/modify users
• list_forwarders: View forwarder management
• rest_apps_management: Install apps via REST
• schedule_search: Create scheduled searches/alerts</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">authentication.conf - LDAP Configuration</span>
                        </div>
                        <pre><code># Enable LDAP authentication
[authentication]
authType = LDAP
authSettings = company_ldap

[company_ldap]
SSLEnabled = 1
host = ldap.company.com
port = 636
bindDN = CN=splunk_svc,OU=Service Accounts,DC=company,DC=com
bindDNpassword = $encrypted_password$
userBaseDN = OU=Users,DC=company,DC=com
userBaseFilter = (objectClass=user)
userNameAttribute = sAMAccountName
realNameAttribute = cn
emailAttribute = mail
groupMappingAttribute = dn
groupBaseDN = OU=Groups,DC=company,DC=com
groupBaseFilter = (objectClass=group)
groupNameAttribute = cn
groupMemberAttribute = member
nestedGroups = true

[roleMap_company_ldap]
admin = Splunk_Admins
power = Splunk_Power_Users
soc_analyst = SOC_Analysts
user = Domain Users</code></pre>
                    </div>
                </div>

                <!-- Domain 6: Forwarders -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">15%</span>Domain 6: Forwarder Management</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>6.1</strong> Differentiate UF vs HF</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>6.2</strong> Install and configure forwarders</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>6.3</strong> Configure deployment server</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>6.4</strong> Create server classes and deployment apps</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>6.5</strong> Configure load balancing</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Universal vs Heavy Forwarder</span>
                        </div>
                        <pre><code>FORWARDER COMPARISON
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────┬─────────────────────┬─────────────────────────────────┐
│ Feature             │ Universal Forwarder │ Heavy Forwarder                 │
├─────────────────────┼─────────────────────┼─────────────────────────────────┤
│ Size                │ ~70MB               │ Full Splunk (~1GB)              │
│ Memory              │ ~100MB              │ 1-4GB                           │
│ Parsing             │ NO (raw forwarding) │ YES (index-time parsing)        │
│ Routing             │ Basic (by output)   │ Advanced (by content)           │
│ Splunk Web          │ NO                  │ YES                             │
│ Apps                │ Limited (TAs only)  │ Full app support                │
│ Python              │ NO                  │ YES                             │
│ Best For            │ Endpoint collection │ Syslog aggregation, filtering   │
└─────────────────────┴─────────────────────┴─────────────────────────────────┘

WHEN TO USE HEAVY FORWARDER
─────────────────────────────────────────────────────────────────────────────
• Parse/filter data before forwarding (reduce volume)
• Route data to different indexers based on content
• Aggregate syslog from multiple sources
• Anonymize/mask sensitive data
• Run modular inputs requiring Python</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">serverclass.conf - Deployment Server</span>
                        </div>
                        <pre><code># Server class for Windows servers
[serverClass:Windows_Servers]
whitelist.0 = *.company.com
filterType = whitelist
machineTypesFilter = windows-*

[serverClass:Windows_Servers:app:Splunk_TA_windows]
restartSplunkWeb = false
restartSplunkd = true
stateOnClient = enabled

[serverClass:Windows_Servers:app:org_all_outputs]
restartSplunkd = true
stateOnClient = enabled

# Server class for Linux servers
[serverClass:Linux_Servers]
whitelist.0 = lin*.company.com
machineTypesFilter = linux-*

[serverClass:Linux_Servers:app:Splunk_TA_nix]
restartSplunkd = true

# Server class by IP range
[serverClass:DMZ_Servers]
whitelist.0 = 10.10.10.*

# Exclude specific hosts
[serverClass:All_Except_DC]
whitelist.0 = *
blacklist.0 = dc*.company.com

DEPLOYMENT APP STRUCTURE
─────────────────────────────────────────────────────────────────────────────
$SPLUNK_HOME/etc/deployment-apps/
├── org_all_outputs/
│   └── local/
│       └── outputs.conf      # Indexer targets
├── org_all_deploymentclient/
│   └── local/
│       └── deploymentclient.conf
├── Splunk_TA_windows/
│   └── local/
│       └── inputs.conf       # Windows inputs
└── Splunk_TA_nix/
    └── local/
        └── inputs.conf       # Linux inputs</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">deploymentclient.conf - Forwarder Side</span>
                        </div>
                        <pre><code># On each forwarder
[deployment-client]
phoneHomeIntervalInSecs = 60        # Check for updates every 60 seconds
disabled = false

[target-broker:deploymentServer]
targetUri = https://deployment-server:8089</code></pre>
                    </div>
                </div>

                <!-- Domain 7: Distributed Search -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">10%</span>Domain 7: Distributed Search</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>7.1</strong> Configure search peers</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>7.2</strong> Understand knowledge bundle replication</li>
                        <li class="partial"><span class="status-icon">⚠️</span><strong>7.3</strong> Configure distsearch.conf</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">distsearch.conf - Distributed Search</span>
                        </div>
                        <pre><code># On Search Head - add search peers
[distributedSearch]
servers = https://idx1:8089, https://idx2:8089, https://idx3:8089

# Authentication to peers
[distributedSearch:idx1]
remoteUsername = admin
remotePassword = $encrypted$

# Knowledge bundle settings
[replicationSettings]
replicationPolicy = local           # Don't replicate user knowledge
connectionTimeout = 10
sendTimeout = 30
receiveTimeout = 60

# Blacklist files from bundle (reduce size)
[replicationBlacklist]
*.pyc = true
*.pyo = true
lookups/*.csv = true               # Don't replicate large lookups

# Allowlist specific lookups
[replicationWhitelist]
critical_lookup.csv = true

KNOWLEDGE BUNDLE
─────────────────────────────────────────────────────────────────────────────
• Bundle contains: props.conf, transforms.conf, lookups, etc.
• Pushed from Search Head to Search Peers (indexers)
• Location on indexer: $SPLUNK_HOME/var/run/searchpeers/
• Replicates when bundle changes (or force via CLI)

# Force bundle replication
./splunk reload deploy-server -class <serverclass></code></pre>
                    </div>
                </div>

                <!-- Domain 8: Clustering -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">15%</span>Domain 8: Clustering</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>8.1</strong> Understand indexer clustering concepts</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>8.2</strong> Configure cluster manager (master)</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>8.3</strong> Configure cluster peers (indexers)</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>8.4</strong> Understand search head clustering</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>8.5</strong> Understand replication and search factors</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Indexer Cluster Configuration</span>
                        </div>
                        <pre><code>INDEXER CLUSTER CONCEPTS
═══════════════════════════════════════════════════════════════════════════════

REPLICATION FACTOR (RF) = Number of copies of raw data
SEARCH FACTOR (SF) = Number of searchable copies

Example: RF=3, SF=2
• 3 copies of every bucket exist across cluster
• 2 of those copies are searchable at any time

CLUSTER ROLES
─────────────────────────────────────────────────────────────────────────────
• Cluster Manager (Master): Coordinates cluster, no data
• Peer Nodes: Store and index data
• Search Heads: Connect to cluster for searches

# Cluster Manager - server.conf
[clustering]
mode = manager                      # or "master" in older versions
replication_factor = 3
search_factor = 2
pass4SymmKey = your_secret_key
cluster_label = production_cluster

# Peer Node - server.conf
[clustering]
mode = peer                         # or "slave" in older versions
manager_uri = https://cm:8089       # or master_uri
pass4SymmKey = your_secret_key

[replication_port://9887]
# Peer-to-peer replication port

# Search Head connecting to cluster - server.conf
[clustering]
mode = searchhead
manager_uri = https://cm:8089
pass4SymmKey = your_secret_key

CLUSTER STATES
─────────────────────────────────────────────────────────────────────────────
• Valid: All data meets RF and SF requirements
• Invalid: Some data doesn't meet requirements (auto-remediation)
• Detention: Peer isolated from cluster (maintenance)

# Check cluster status
./splunk show cluster-status
./splunk list cluster-peers</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Search Head Cluster Configuration</span>
                        </div>
                        <pre><code>SEARCH HEAD CLUSTER (SHC) CONCEPTS
═══════════════════════════════════════════════════════════════════════════════

• Deployer: Pushes apps/configs to SHC members (NOT for user knowledge)
• Captain: Elected leader, coordinates job scheduling
• Members: All SH instances in cluster

# Member configuration - server.conf
[shclustering]
disabled = false
mgmt_uri = https://sh01:8089
replication_factor = 3
replication_port = 9000
conf_deploy_fetch_url = https://deployer:8089
pass4SymmKey = shc_secret
shcluster_label = shc_production

# Initialize SHC (run on each member)
./splunk init shcluster-config -auth admin:password \
  -mgmt_uri https://sh01:8089 \
  -replication_port 9000 \
  -replication_factor 3 \
  -conf_deploy_fetch_url https://deployer:8089 \
  -secret shc_secret \
  -shcluster_label shc_production

# Bootstrap captain (run once, on any member)
./splunk bootstrap shcluster-captain -servers_list \
  "https://sh01:8089,https://sh02:8089,https://sh03:8089" \
  -auth admin:password

# Deployer - push apps to SHC
./splunk apply shcluster-bundle -target https://sh01:8089 \
  -auth admin:password</code></pre>
                    </div>

                    <div class="exam-tip">
                        <h4><i class="fas fa-lightbulb"></i> Exam Tip</h4>
                        <p><strong>Deployer vs Deployment Server:</strong><br>
                        • <strong>Deployer</strong> = Pushes apps to Search Head Cluster members<br>
                        • <strong>Deployment Server</strong> = Pushes apps to Forwarders<br>
                        These are different roles! Don't confuse them.</p>
                    </div>
                </div>

                <!-- Domain 9: CLI Commands -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">10%</span>Domain 9: Splunk CLI</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>9.1</strong> Start, stop, restart Splunk</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>9.2</strong> Use btool for troubleshooting</li>
                        <li class="partial"><span class="status-icon">⚠️</span><strong>9.3</strong> Use diag for support</li>
                        <li class="partial"><span class="status-icon">⚠️</span><strong>9.4</strong> Clean and maintain indexes</li>
                    </ul>

                    <table class="cli-table">
                        <thead>
                            <tr>
                                <th>Command</th>
                                <th>Description</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>splunk start</code></td>
                                <td>Start Splunk services</td>
                                <td><code>./splunk start --accept-license</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk stop</code></td>
                                <td>Stop Splunk services</td>
                                <td><code>./splunk stop</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk restart</code></td>
                                <td>Restart Splunk services</td>
                                <td><code>./splunk restart</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk status</code></td>
                                <td>Check if Splunk is running</td>
                                <td><code>./splunk status</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk btool</code></td>
                                <td>Check effective config</td>
                                <td><code>./splunk btool props list --debug</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk diag</code></td>
                                <td>Generate diagnostic bundle</td>
                                <td><code>./splunk diag --collect=log,conf</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk clean</code></td>
                                <td>Remove data from indexes</td>
                                <td><code>./splunk clean eventdata -index main</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk list</code></td>
                                <td>List various components</td>
                                <td><code>./splunk list forward-server</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk add</code></td>
                                <td>Add inputs, users, etc.</td>
                                <td><code>./splunk add monitor /var/log</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk reload</code></td>
                                <td>Reload configs without restart</td>
                                <td><code>./splunk reload deploy-server</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk enable</code></td>
                                <td>Enable boot-start</td>
                                <td><code>./splunk enable boot-start -user splunk</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk show</code></td>
                                <td>Show cluster status</td>
                                <td><code>./splunk show cluster-status</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk offline</code></td>
                                <td>Take peer offline (cluster)</td>
                                <td><code>./splunk offline</code></td>
                            </tr>
                            <tr>
                                <td><code>splunk validate</code></td>
                                <td>Validate index integrity</td>
                                <td><code>./splunk validate index --index main</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">diag Command - Support Diagnostics</span>
                        </div>
                        <pre><code># Generate full diagnostic bundle
./splunk diag

# Selective collection
./splunk diag --collect=log,conf,etc    # Logs and configs only
./splunk diag --collect=kvstore         # KV Store data
./splunk diag --collect=rest            # REST API output

# Exclude sensitive data
./splunk diag --exclude=passwd,.*password.*

# Time range for logs
./splunk diag --time-range=-7d

# Output location
./splunk diag --output=/tmp/splunk_diag.tar.gz

# Common components to collect
--collect=log           # Log files
--collect=conf          # Configuration files
--collect=etc           # etc directory
--collect=pool          # License pool info
--collect=kvstore       # KV Store data
--collect=rest          # REST endpoint output
--collect=searchpeers   # Distributed search info</code></pre>
                    </div>
                </div>

                <!-- Study Resources -->
                <h2><i class="fas fa-book-reader"></i> Study Resources</h2>
                <div class="info-box info-box-tip">
                    <h4>Recommended Study Path</h4>
                    <ol>
                        <li><strong>Week 1-2:</strong> Configuration files (props, transforms, inputs, outputs)</li>
                        <li><strong>Week 3:</strong> Index management and retention</li>
                        <li><strong>Week 4:</strong> Forwarder deployment and management</li>
                        <li><strong>Week 5:</strong> Users, roles, and authentication</li>
                        <li><strong>Week 6:</strong> Clustering (indexer and search head)</li>
                        <li><strong>Week 7:</strong> CLI commands and troubleshooting</li>
                        <li><strong>Week 8:</strong> Practice exams and review</li>
                    </ol>
                </div>

                <!-- Related Pages -->
                <h2><i class="fas fa-link"></i> Related Topics</h2>
                <ul>
                    <li><a href="architecture.html">Splunk Architecture Deep Dive</a></li>
                    <li><a href="forwarders.html">Forwarder Configuration</a></li>
                    <li><a href="clustering-ha.html">Clustering & High Availability</a></li>
                    <li><a href="parsing-flows.html">Props & Transforms Configuration</a></li>
                    <li><a href="troubleshooting.html">Troubleshooting Guide</a></li>
                </ul>

            </main>
        </div>
    </div>

    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
