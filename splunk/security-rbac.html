<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security & RBAC | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="shared-styles.css">
    <link rel="stylesheet" href="../assets/css/main.css">


</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo"><i class="fas fa-terminal"></i><span>Splunk Reference</span></a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certifications</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-user-graduate" style="color:#7ce38b"></i>Power User</a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog" style="color:#f0883e"></i>Admin</a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt" style="color:#8957e5"></i>ES Admin</a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud" style="color:#39c5cf"></i>Cloud Admin</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Learning</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="when-to-use-what.html" class="sidebar-nav-link"><i class="fas fa-map-signs" style="color:#f0883e"></i>When to Use What</a></li>
                        <li class="sidebar-nav-item"><a href="spl-practice-questions.html" class="sidebar-nav-link"><i class="fas fa-tasks" style="color:#58a6ff"></i>Practice MCQs</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced-mcqs.html" class="sidebar-nav-link"><i class="fas fa-brain" style="color:#a371f7"></i>Advanced MCQs</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Reference</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-code"></i>SPL Fundamentals</a></li>
                        <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-layer-group"></i>SPL Intermediate</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i>SPL Advanced</a></li>
                        <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-lightbulb"></i>Knowledge Objects</a></li>
                        <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i>Data Models</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Administration</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i>Architecture</a></li>
                        <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i>Data Ingestion</a></li>
                        <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-share-alt"></i>Forwarders</a></li>
                        <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i>Clustering & HA</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Enterprise Security</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i>ES Overview</a></li>
                        <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search-plus"></i>Correlation Searches</a></li>
                        <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i>Risk-Based Alerting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Resources</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="lab-exercises.html" class="sidebar-nav-link"><i class="fas fa-flask"></i>Lab Exercises</a></li>
                        <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i>Troubleshooting</a></li>
                    </ul>
                </div>
            </div>
        </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Security & RBAC</span>
                </div>

                <div class="hero-section">
                    <span class="version-badge">Splunk 9.x / Enterprise Security</span>
                    <h1 class="hero-title"><i class="fas fa-user-lock" style="color: #3fb950;"></i> Security & RBAC</h1>
                    <p class="hero-subtitle">Comprehensive guide to Splunk security hardening, role-based access control, authentication integration, and audit logging.</p>
                </div>

                <!-- RBAC Overview -->
                <h2><i class="fas fa-users-cog"></i> Role-Based Access Control (RBAC)</h2>
                <div class="config-section">
                    <p>Splunk's RBAC model controls what users can see and do through roles, capabilities, and index access.</p>
                    
                    <div class="arch-diagram">
SPLUNK RBAC HIERARCHY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    USER                    ROLE(S)                 CAPABILITIES
    â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  John   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  analyst  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ search          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚           â”‚         â”‚ list_inputs     â”‚
                        â”‚           â”‚         â”‚ rtsearch        â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ inherits
                                  â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   user    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ schedule_search â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ write_props     â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚  INDEX ACCESS   â”‚
                                              â”‚  srch: main,sec â”‚
                                              â”‚  default: main  â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

KEY COMPONENTS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Users: Individual accounts (local or external auth)
â€¢ Roles: Groups of capabilities + index access
â€¢ Capabilities: Granular permissions (200+ available)
â€¢ Inheritance: Roles can inherit from other roles
â€¢ Index Access: Which indexes role can search/write to
                    </div>

                    <h3>Built-in Roles</h3>
                    <div class="arch-diagram">
DEFAULT ROLES HIERARCHY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     admin     â”‚  Full access to everything
                    â”‚  (240+ caps)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ inherits
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  power_user   â”‚  Can create/share objects
                    â”‚   (35 caps)   â”‚  Schedule searches
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ inherits
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     user      â”‚  Search, create personal objects
                    â”‚   (15 caps)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  can_delete   â”‚  Special role for deletion
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ENTERPRISE SECURITY ROLES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ ess_admin    - Full ES administration
â€¢ ess_analyst  - Investigation and notable management
â€¢ ess_user     - Read-only ES access
                    </div>
                </div>

                <!-- Creating Custom Roles -->
                <h2><i class="fas fa-user-plus"></i> Creating Custom Roles</h2>
                <div class="config-section">
                    <h3>Via authorize.conf</h3>
                    <div class="arch-diagram">
# /opt/splunk/etc/system/local/authorize.conf

[role_soc_analyst]
# Index access
srchIndexesAllowed = main, security, network, endpoint
srchIndexesDefault = security
importRoles = user

# Key capabilities
srchDiskQuota = 500
srchJobsQuota = 10
rtSrchJobsQuota = 5
cumulativeSrchJobsQuota = 20
cumulativeRTSrchJobsQuota = 10

# Capabilities
schedule_search = enabled
rtsearch = enabled
list_inputs = disabled
edit_user = disabled
change_own_password = enabled

[role_soc_senior]
importRoles = soc_analyst
srchIndexesAllowed = main, security, network, endpoint, _internal, _audit
srchDiskQuota = 1000
schedule_search = enabled
accelerate_datamodel = enabled

[role_soc_manager]
importRoles = soc_senior
srchIndexesAllowed = *
admin_all_objects = enabled
edit_roles = disabled  # Can't edit roles
                    </div>

                    <h3>Key Capabilities Reference</h3>
                    <div class="arch-diagram">
COMMONLY USED CAPABILITIES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SEARCH CAPABILITIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
search                  - Basic searching
rtsearch               - Real-time searches
schedule_search        - Schedule saved searches
accelerate_datamodel   - Accelerate data models
accelerate_search      - Use report acceleration
list_inputs            - View data inputs
rest_properties_get    - Access REST API for reading

KNOWLEDGE OBJECT CAPABILITIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
edit_search_head_clustering - Manage SHC
edit_sourcetypes           - Create/edit sourcetypes
edit_forwarders            - Manage forwarder configs
write_props               - Edit props.conf
write_transforms          - Edit transforms.conf

ADMINISTRATIVE CAPABILITIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
edit_user              - Create/modify users
edit_roles             - Modify roles
edit_tokens            - Manage HEC tokens
admin_all_objects      - Access all objects regardless of sharing
change_authentication  - Configure authentication
restart_splunkd        - Restart Splunk services
indexes_edit           - Create/modify indexes

ENTERPRISE SECURITY CAPABILITIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
edit_notable_events    - Change notable event status
edit_correlationsearches - Modify correlation searches
edit_identities        - Manage identity lookup
edit_threat_intel      - Manage threat intelligence
                    </div>
                </div>

                <!-- Authentication Methods -->
                <h2><i class="fas fa-key"></i> Authentication Methods</h2>
                <div class="config-section">
                    <h3>SAML Authentication (SSO)</h3>
                    <div class="arch-diagram">
SAML AUTHENTICATION FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    User                    Splunk                  Identity Provider
    â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â”‚                        â”‚                          â”‚
      â”‚â”€â”€â”€â”€ Login Request â”€â”€â”€â”€â–ºâ”‚                          â”‚
      â”‚                        â”‚                          â”‚
      â”‚                        â”‚â”€â”€â”€â”€ SAML AuthnRequest â”€â”€â–ºâ”‚
      â”‚                        â”‚                          â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Redirect to IdP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
      â”‚                        â”‚                          â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ User Authenticates â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
      â”‚                        â”‚                          â”‚
      â”‚                        â”‚â—„â”€â”€â”€ SAML Response â”€â”€â”€â”€â”€â”€â”€â”‚
      â”‚                        â”‚     (Assertion + Groups) â”‚
      â”‚                        â”‚                          â”‚
      â”‚â—„â”€â”€â”€â”€ Session Created â”€â”€â”‚                          â”‚
      â”‚      (Role Mapping)    â”‚                          â”‚


# /opt/splunk/etc/system/local/authentication.conf

[authentication]
authType = SAML
authSettings = my_saml_config

[my_saml_config]
entityId = https://splunk.company.com
idpSSOUrl = https://idp.company.com/sso
idpCertPath = /opt/splunk/etc/auth/idp-cert.pem
signAuthnRequest = true
signedAssertion = true
attributeQueryTTL = 3600

# Role mapping
[roleMap_my_saml_config]
admin = Splunk-Admins;IT-Security-Leads
power_user = Splunk-PowerUsers;SOC-Seniors
user = Splunk-Users;SOC-Analysts
                    </div>

                    <h3>LDAP Authentication</h3>
                    <div class="arch-diagram">
# /opt/splunk/etc/system/local/authentication.conf

[authentication]
authType = LDAP
authSettings = my_ldap

[my_ldap]
host = ldap.company.com
port = 636
SSLEnabled = 1
bindDN = CN=splunk-service,OU=ServiceAccounts,DC=company,DC=com
bindDNpassword = $7$encrypted_password
userBaseDN = OU=Users,DC=company,DC=com
userBaseFilter = (objectClass=user)
userNameAttribute = sAMAccountName
realNameAttribute = cn
emailAttribute = mail
groupBaseDN = OU=Groups,DC=company,DC=com
groupBaseFilter = (objectClass=group)
groupMappingAttribute = dn
groupMemberAttribute = member
groupNameAttribute = cn
timelimit = 30
network_timeout = 20

# Role mapping from LDAP groups
[roleMap_my_ldap]
admin = CN=Splunk-Admins,OU=Groups,DC=company,DC=com
power_user = CN=Splunk-PowerUsers,OU=Groups,DC=company,DC=com
soc_analyst = CN=SOC-Team,OU=Groups,DC=company,DC=com

# Multi-factor authentication (MFA via Duo)
[authentication]
authType = LDAP
authSettings = my_ldap
externalTwoFactorAuthVendor = duo
externalTwoFactorAuthSettings = duo_config

[duo_config]
apiHostname = api-xxxxx.duosecurity.com
integrationKey = XXXXXXXXXXXXXXXXXX
secretKey = $7$encrypted_key
                    </div>
                </div>

                <!-- TLS/SSL Configuration -->
                <h2><i class="fas fa-lock"></i> TLS/SSL Encryption</h2>
                <div class="config-section">
                    <h3>Enabling HTTPS for Web UI</h3>
                    <div class="arch-diagram">
# /opt/splunk/etc/system/local/web.conf

[settings]
enableSplunkWebSSL = true
privKeyPath = /opt/splunk/etc/auth/mycerts/server.key
serverCert = /opt/splunk/etc/auth/mycerts/server.pem
sslPassword = $7$encrypted_password
cipherSuite = ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384
sslVersions = tls1.2
httpport = 443

# Force HTTPS redirect
[settings]
enableSplunkWebSSL = true
SSOMode = strict
                    </div>

                    <h3>Encrypting Splunk-to-Splunk Communication</h3>
                    <div class="arch-diagram">
# /opt/splunk/etc/system/local/server.conf (Management/REST API)

[sslConfig]
enableSplunkdSSL = true
serverCert = /opt/splunk/etc/auth/mycerts/server.pem
sslRootCAPath = /opt/splunk/etc/auth/mycerts/ca.pem
sslPassword = $7$encrypted
requireClientCert = true
cipherSuite = ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384
sslVersions = tls1.2

# /opt/splunk/etc/system/local/outputs.conf (Forwarder to Indexer)

[tcpout]
defaultGroup = secure_indexers
clientCert = /opt/splunk/etc/auth/mycerts/forwarder.pem
sslPassword = $7$encrypted
sslVerifyServerCert = true
sslCommonNameToCheck = idx*.company.com
sslRootCAPath = /opt/splunk/etc/auth/mycerts/ca.pem

[tcpout:secure_indexers]
server = idx1.company.com:9997, idx2.company.com:9997
sslCertPath = /opt/splunk/etc/auth/mycerts/forwarder.pem
useClientSSLCompression = true

# /opt/splunk/etc/system/local/inputs.conf (Indexer receiving)

[splunktcp-ssl:9997]
disabled = 0
connection_host = dns

[SSL]
serverCert = /opt/splunk/etc/auth/mycerts/indexer.pem
sslPassword = $7$encrypted
requireClientCert = true
sslVersions = tls1.2
                    </div>
                </div>

                <!-- Audit Logging -->
                <h2><i class="fas fa-clipboard-list"></i> Audit Logging</h2>
                <div class="config-section">
                    <h3>Splunk Audit Logs</h3>
                    <div class="arch-diagram">
AUDIT LOG SOURCES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INDEX: _audit
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Contains:
â€¢ User logins/logouts
â€¢ Search activities
â€¢ Configuration changes
â€¢ Knowledge object modifications
â€¢ Admin actions

# Search for login activity
index=_audit action=login*
| stats count by user, action, info
| sort -count

# Search for configuration changes
index=_audit action=edit*
| stats count by user, object, action
| table _time user action object

INDEX: _internal
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Contains:
â€¢ Splunk system logs
â€¢ Search performance metrics
â€¢ Scheduler logs
â€¢ License usage

# Track searches by user
index=_internal sourcetype=splunk_web_access
| stats count by user, status
| sort -count

ENABLING DETAILED AUDIT LOGGING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# /opt/splunk/etc/system/local/audit.conf

[auditTrail]
privateKey = /opt/splunk/etc/auth/audit/private.pem
publicKey = /opt/splunk/etc/auth/audit/public.pem

# Enable all audit categories
[eventHash]
# Signs audit events cryptographically

# /opt/splunk/etc/system/local/authorize.conf
# Track capability usage
[capability::admin_all_objects]
audit = true
                    </div>

                    <h3>Critical Audit Searches</h3>
                    <div class="arch-diagram">
# Failed login attempts (brute force detection)
index=_audit action="login attempt" info=failed
| stats count by user, src
| where count > 5
| table user, src, count

# Admin actions
index=_audit user=admin OR info=granted
| stats count by user, action, object
| sort -count

# Role changes
index=_audit action="edit_role*"
| table _time, user, action, object, info

# Knowledge object changes
index=_audit (action="save*" OR action="delete*") 
  (savedsearch OR dashboard OR report)
| table _time, user, action, object

# Search activity by user
index=_audit action=search info=completed
| stats count, sum(total_run_time) as total_time by user
| eval avg_time = total_time/count
| sort -count
| table user, count, total_time, avg_time

# Configuration changes
index=_audit action="edit*" object=server.conf
| table _time, user, action, object, info
                    </div>
                </div>

                <!-- Hardening Guide -->
                <h2><i class="fas fa-shield-alt"></i> Security Hardening Checklist</h2>
                <div class="config-section">
                    <div class="arch-diagram">
SPLUNK SECURITY HARDENING CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AUTHENTICATION & ACCESS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Change default admin password immediately
â–¡ Implement SSO (SAML/LDAP) - no local accounts
â–¡ Enable MFA for all users
â–¡ Configure session timeout (default 1 hour)
  # web.conf: tools.sessions.timeout = 60
â–¡ Disable unused authentication methods
â–¡ Implement IP allowlisting for admin access

NETWORK SECURITY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Enable TLS 1.2+ for all communication
â–¡ Use valid CA-signed certificates
â–¡ Disable SSLv3, TLS 1.0, TLS 1.1
â–¡ Enable certificate verification
â–¡ Restrict management port (8089) access
â–¡ Use firewall rules to limit forwarder connections
â–¡ Enable HEC token authentication
â–¡ Disable unnecessary network services

DATA PROTECTION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Encrypt data at rest (volume encryption)
â–¡ Encrypt sensitive fields using hash/encryption
â–¡ Implement data masking for PII/PCI
  # transforms.conf SEDCMD for masking
â–¡ Configure index-level access controls
â–¡ Enable audit logging
â–¡ Sign audit events cryptographically

OPERATIONAL SECURITY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Remove default/sample apps
â–¡ Disable Splunk web on indexers/forwarders
â–¡ Run Splunk as non-root user
â–¡ Implement least privilege for service accounts
â–¡ Regular security updates/patches
â–¡ Enable health monitoring and alerting
â–¡ Backup configurations and certificates

COMPLIANCE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¡ Enable comprehensive audit logging
â–¡ Retain audit logs per compliance requirements
â–¡ Document all roles and access
â–¡ Regular access reviews
â–¡ Implement separation of duties
                    </div>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Security Decision Trees</h2>
                
                <div class="config-section">
                    <h3>Decision Tree: Authentication Method Selection</h3>
                    <div class="arch-diagram">
Decision Tree: Choosing Authentication Method
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

START: What's your organization's identity infrastructure?
â”‚
â”œâ”€â–º [Enterprise with SSO/IdP (Okta, Azure AD, Ping)]
â”‚   â”‚
â”‚   â””â”€â–º Use SAML authentication
â”‚       â€¢ Best for: Centralized identity management
â”‚       â€¢ Benefits: SSO, MFA integration, group sync
â”‚       â€¢ Configure: authentication.conf authType = SAML
â”‚
â”œâ”€â–º [Active Directory environment]
â”‚   â”‚
â”‚   â””â”€â–º Does organization mandate SSO?
â”‚       â”‚
â”‚       â”œâ”€â–º YES â†’ Use SAML with AD FS or Azure AD
â”‚       â”‚
â”‚       â””â”€â–º NO â†’ Use LDAP authentication
â”‚                 â€¢ Direct AD integration
â”‚                 â€¢ Group-based role mapping
â”‚                 â€¢ Consider LDAPS (port 636)
â”‚
â”œâ”€â–º [Small deployment / POC / Lab]
â”‚   â”‚
â”‚   â””â”€â–º Native Splunk authentication acceptable
â”‚       â€¢ Local users in passwd file
â”‚       â€¢ Still change default passwords
â”‚       â€¢ Consider migrating to SSO later
â”‚
â””â”€â–º [Cloud-only / No on-prem infrastructure]
    â”‚
    â””â”€â–º Splunk Cloud with SAML
        â€¢ Integrate with cloud IdP
        â€¢ Azure AD, Okta, OneLogin supported
        â€¢ No direct LDAP (use SCIM provisioning)
                    </div>
                </div>

                <div class="config-section">
                    <h3>Decision Tree: Role Design</h3>
                    <div class="arch-diagram">
Decision Tree: Designing RBAC Roles
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

START: What job functions need Splunk access?
â”‚
â”œâ”€â–º [SOC Analysts - Tier 1]
â”‚   â”‚
â”‚   â””â”€â–º Create: soc_analyst_t1
â”‚       Capabilities:
â”‚       â€¢ search, rtsearch
â”‚       â€¢ edit_notable_events (ES)
â”‚       Indexes: security, network, endpoint
â”‚       NO: schedule_search, admin capabilities
â”‚
â”œâ”€â–º [SOC Analysts - Tier 2/3]
â”‚   â”‚
â”‚   â””â”€â–º Create: soc_analyst_senior
â”‚       Inherits: soc_analyst_t1
â”‚       Additional:
â”‚       â€¢ schedule_search
â”‚       â€¢ accelerate_datamodel
â”‚       â€¢ write_props (limited)
â”‚       Indexes: + _internal for troubleshooting
â”‚
â”œâ”€â–º [Detection Engineers]
â”‚   â”‚
â”‚   â””â”€â–º Create: detection_engineer
â”‚       Capabilities:
â”‚       â€¢ edit_correlationsearches
â”‚       â€¢ edit_sourcetypes
â”‚       â€¢ accelerate_datamodel
â”‚       â€¢ schedule_search
â”‚       Indexes: All security-related
â”‚
â”œâ”€â–º [IT Operations]
â”‚   â”‚
â”‚   â””â”€â–º Create: it_ops
â”‚       Capabilities:
â”‚       â€¢ search (limited indexes)
â”‚       â€¢ schedule_search
â”‚       Indexes: infrastructure, windows, linux
â”‚       NO: security indexes
â”‚
â”œâ”€â–º [Splunk Administrators]
â”‚   â”‚
â”‚   â””â”€â–º Create: splunk_admin
â”‚       Inherits: admin (carefully)
â”‚       REMOVE: change_authentication (requires approval)
â”‚       Add: All administrative tasks
â”‚
â””â”€â–º [Executives / Read-Only]
    â”‚
    â””â”€â–º Create: executive_dashboard
        Capabilities:
        â€¢ search
        â€¢ schedule_search (for email reports)
        Indexes: summary, metrics
        Apps: Executive dashboards only
                    </div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                
                <div class="enterprise-gap-grid">
                    <div class="gap-card gap-critical">
                        <h4>ğŸ”´ Critical Gaps</h4>
                        <ul>
                            <li><strong>Default admin password unchanged:</strong> Production systems with admin/changeme</li>
                            <li><strong>No MFA:</strong> SAML/LDAP configured but no multi-factor authentication</li>
                            <li><strong>Overprivileged roles:</strong> Everyone gets power_user or admin "to make it work"</li>
                            <li><strong>Unencrypted forwarder traffic:</strong> Credentials and data in plaintext over network</li>
                            <li><strong>Service account with admin:</strong> Integration accounts given admin role unnecessarily</li>
                        </ul>
                    </div>
                    
                    <div class="gap-card gap-warning">
                        <h4>ğŸŸ¡ Common Oversights</h4>
                        <ul>
                            <li><strong>Certificate expiration:</strong> No monitoring for SSL cert expiry, causes outages</li>
                            <li><strong>No audit log monitoring:</strong> Audit logs exist but no one reviews or alerts on them</li>
                            <li><strong>Index access too broad:</strong> Roles have access to srchIndexesAllowed = *</li>
                            <li><strong>Shared accounts:</strong> Team shares one analyst account for convenience</li>
                            <li><strong>No session timeout:</strong> Users remain logged in indefinitely</li>
                        </ul>
                    </div>
                    
                    <div class="gap-card gap-info">
                        <h4>ğŸ”µ Often Overlooked</h4>
                        <ul>
                            <li><strong>REST API unprotected:</strong> Port 8089 accessible without IP restrictions</li>
                            <li><strong>HEC tokens never rotated:</strong> Same tokens used since deployment</li>
                            <li><strong>No capability auditing:</strong> Don't know which capabilities are actually used</li>
                            <li><strong>Role inheritance complexity:</strong> Deep inheritance chains, unclear effective permissions</li>
                            <li><strong>Local accounts alongside SSO:</strong> Backdoor local accounts persist after SSO migration</li>
                        </ul>
                    </div>
                    
                    <div class="gap-card gap-best-practice">
                        <h4>ğŸŸ¢ Best Practices Often Skipped</h4>
                        <ul>
                            <li><strong>Regular access reviews:</strong> No quarterly review of who has what access</li>
                            <li><strong>Documented role matrix:</strong> No documentation of roles, capabilities, justification</li>
                            <li><strong>Separation of duties:</strong> Same person manages Splunk and reviews Splunk logs</li>
                            <li><strong>Break-glass procedures:</strong> No documented emergency access procedures</li>
                            <li><strong>Security testing:</strong> No penetration testing of Splunk infrastructure</li>
                        </ul>
                    </div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions & Answers</h2>
                
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: Design an RBAC model for a SOC team with 50 analysts, 10 senior analysts, and 5 managers.</button>
                        <div class="qa-answer">
                            <p><strong>Role Hierarchy Design:</strong></p>
                            <div class="arch-diagram">
ROLE HIERARCHY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    soc_manager      â”‚  (5 users)
                    â”‚  â€¢ admin_all_objectsâ”‚
                    â”‚  â€¢ edit_user        â”‚
                    â”‚  â€¢ All indexes      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ inherits
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   soc_senior        â”‚  (10 users)
                    â”‚  â€¢ schedule_search  â”‚
                    â”‚  â€¢ accelerate_*     â”‚
                    â”‚  â€¢ + _internal      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ inherits
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   soc_analyst       â”‚  (50 users)
                    â”‚  â€¢ search, rtsearch â”‚
                    â”‚  â€¢ edit_notables    â”‚
                    â”‚  â€¢ sec indexes only â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AUTHORIZE.CONF IMPLEMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[role_soc_analyst]
importRoles = user
srchIndexesAllowed = main, security, network, endpoint, proxy, dns
srchIndexesDefault = security
srchDiskQuota = 500
srchJobsQuota = 10
rtSrchJobsQuota = 3

# ES-specific capabilities
edit_notable_events = enabled
list_correlationsearches = enabled

# Explicitly disabled
schedule_search = disabled
admin_all_objects = disabled
edit_user = disabled

[role_soc_senior]
importRoles = soc_analyst
srchIndexesAllowed = main, security, network, endpoint, proxy, dns, _internal
srchDiskQuota = 1000
srchJobsQuota = 20
rtSrchJobsQuota = 5

schedule_search = enabled
accelerate_datamodel = enabled
accelerate_search = enabled
edit_correlationsearches = enabled

[role_soc_manager]
importRoles = soc_senior
srchIndexesAllowed = *
srchDiskQuota = 2000

admin_all_objects = enabled
edit_user = enabled
edit_roles = disabled          # Requires Splunk admin
change_authentication = disabled
restart_splunkd = disabled

APP PERMISSIONS (ES)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â€¢ soc_analyst: SplunkEnterpriseSecuritySuite (read)
â€¢ soc_senior: SplunkEnterpriseSecuritySuite (write)
â€¢ soc_manager: SplunkEnterpriseSecuritySuite (admin)
                            </div>
                            <p><strong>Additional Considerations:</strong></p>
                            <ul>
                                <li>Map roles to AD groups for automated provisioning</li>
                                <li>Create separate read-only roles for executives</li>
                                <li>Document justification for each capability</li>
                                <li>Implement quarterly access reviews</li>
                            </ul>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q: How do you implement SAML authentication with Azure AD for Splunk?</button>
                        <div class="qa-answer">
                            <p><strong>Step-by-Step Implementation:</strong></p>
                            <div class="arch-diagram">
PHASE 1: AZURE AD CONFIGURATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Create Enterprise Application
   Azure Portal â†’ Enterprise Applications â†’ New Application
   â†’ Create your own application â†’ "Splunk Enterprise"

2. Configure Single Sign-On
   Select SAML â†’ Configure:
   
   Basic SAML Configuration:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Identifier (Entity ID): https://splunk.company.com
   Reply URL: https://splunk.company.com/saml/acs
   Sign-on URL: https://splunk.company.com
   Logout URL: https://splunk.company.com/saml/logout

3. Configure Attributes & Claims
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Required claims:
   â€¢ name â†’ user.displayname
   â€¢ emailaddress â†’ user.mail
   â€¢ groups â†’ user.groups (for role mapping)
   
   Add group claim:
   â€¢ Groups assigned to application
   â€¢ Source: Group ID or sAMAccountName

4. Download Federation Metadata XML
   Or download Certificate (Base64)

PHASE 2: SPLUNK CONFIGURATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# /opt/splunk/etc/system/local/authentication.conf

[authentication]
authType = SAML
authSettings = azure_saml

[azure_saml]
fqdn = splunk.company.com
entityId = https://splunk.company.com
idpSSOUrl = https://login.microsoftonline.com/<tenant-id>/saml2
idpSLOUrl = https://login.microsoftonline.com/<tenant-id>/saml2
idpCertPath = /opt/splunk/etc/auth/azure-ad.pem
signAuthnRequest = true
signedAssertion = true
inboundSignatureAlgorithm = RSA-SHA256
attributeQueryTTL = 3600
nameIdFormat = urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress
role = groups
realName = name
mail = emailaddress

# Role mapping from Azure AD groups
[roleMap_azure_saml]
admin = <object-id-of-Splunk-Admins-group>
soc_senior = <object-id-of-SOC-Senior-group>
soc_analyst = <object-id-of-SOC-Analyst-group>

PHASE 3: TESTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Restart Splunk: splunk restart

2. Test login via: https://splunk.company.com

3. Check SAML debug logs:
   index=_internal sourcetype=splunkd component=SAML

4. Verify role mapping:
   Settings â†’ Access Controls â†’ Users
   Check user's roles match expected
                            </div>
                            <p><strong>Common Issues:</strong></p>
                            <ul>
                                <li>Certificate format wrong - must be PEM format</li>
                                <li>Clock skew - ensure NTP sync between Splunk and Azure</li>
                                <li>Group claims not coming through - check Azure claim configuration</li>
                                <li>Role mapping fails - verify group object IDs match exactly</li>
                            </ul>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q: How would you audit and detect suspicious admin activity in Splunk?</button>
                        <div class="qa-answer">
                            <p><strong>Admin Activity Monitoring Strategy:</strong></p>
                            <div class="arch-diagram">
SUSPICIOUS ADMIN ACTIVITY DETECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. AUTHENTICATION ANOMALIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Admin logins from unusual locations
index=_audit action="login attempt" info=succeeded user=admin
| iplocation src
| where NOT (City="Expected City")
| table _time, user, src, City, Country

# After-hours admin activity
index=_audit user=admin OR role=admin
| eval hour=strftime(_time, "%H")
| where hour < 6 OR hour > 20
| stats count by user, action, hour

# Failed admin logins (brute force)
index=_audit action="login attempt" info=failed (user=admin OR user=*admin*)
| stats count by user, src
| where count > 3

2. CONFIGURATION CHANGES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Role modifications
index=_audit action="edit_role*" OR action="create_role*"
| table _time, user, action, object

# User privilege escalation
index=_audit action="edit_user" info=*admin*
| table _time, user, object, info

# Authentication configuration changes
index=_audit object=authentication.conf
| table _time, user, action, info

3. DATA ACCESS PATTERNS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Admin searching sensitive indexes
index=_audit action=search user=admin info=completed
| rex field=search "index=(?<searched_index>\w+)"
| search searched_index IN (pci, phi, pii, hr, legal)
| table _time, user, searched_index, search

# Bulk data export
index=_audit action=search info=completed
| where result_count > 100000
| table _time, user, search, result_count

4. ALERTING RULES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Alert: New admin user created
index=_audit action="create_user" info=*admin*
| sendalert email to="security@company.com"

# Alert: Role with admin capabilities modified
index=_audit action="edit_role*" 
  (info=*admin_all_objects* OR info=*edit_user* OR info=*edit_roles*)
| sendalert slack channel="#security-alerts"

# Alert: Multiple failed admin logins
index=_audit action="login attempt" info=failed 
  (user=admin OR role=admin)
| stats count by user, src
| where count > 5
| sendalert pagerduty
                            </div>
                            <p><strong>Dashboard Components:</strong></p>
                            <ul>
                                <li>Admin login heatmap by hour/day</li>
                                <li>Configuration change timeline</li>
                                <li>Top admin users by action count</li>
                                <li>Geographic map of admin logins</li>
                            </ul>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q: Explain how to implement data masking for PCI compliance in Splunk.</button>
                        <div class="qa-answer">
                            <p><strong>PCI Data Masking Implementation:</strong></p>
                            <div class="arch-diagram">
PCI DATA MASKING STRATEGY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

APPROACH 1: INDEX-TIME MASKING (Recommended)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Mask data before it's written to index - irreversible

# /opt/splunk/etc/apps/TA-pci-masking/local/props.conf

[source::/var/log/payment/*.log]
# Mask credit card numbers (keep last 4)
SEDCMD-mask_cc = s/\b(\d{4})[\s-]?(\d{4})[\s-]?(\d{4})[\s-]?(\d{4})\b/XXXX-XXXX-XXXX-\4/g

# Mask CVV
SEDCMD-mask_cvv = s/\b(cvv|cvc|cvv2)[:\s]*\d{3,4}\b/\1:XXX/gi

# Mask SSN
SEDCMD-mask_ssn = s/\b\d{3}-\d{2}-\d{4}\b/XXX-XX-XXXX/g

# Mask expiration dates
SEDCMD-mask_exp = s/\b(exp|expir)[:\s]*(\d{2})[\/\-]?(\d{2,4})\b/\1:XX\/XXXX/gi

APPROACH 2: SEARCH-TIME MASKING (For authorized users)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Original data stored, masked at display time

# Custom search command or eval
index=payments
| eval masked_cc = if(match(user_role, "pci_authorized"), 
    card_number, 
    replace(card_number, "(\d{4})(\d{4})(\d{4})(\d{4})", "XXXX-XXXX-XXXX-\4"))

APPROACH 3: FIELD-LEVEL ENCRYPTION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Use Splunk's hash function for one-way masking
[source::/var/log/payment/*.log]
TRANSFORMS-hash_pan = hash_card_number

# transforms.conf
[hash_card_number]
REGEX = card_number=(\d{16})
FORMAT = card_number_hash::$1
WRITE_META = true

# In props.conf, create hashed field
EVAL-card_hash = sha256(card_number)

ROLE-BASED DATA ACCESS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Create separate indexes
pci_masked    - Contains masked data (accessible to most users)
pci_raw       - Contains original data (restricted access)

# authorize.conf
[role_pci_authorized]
importRoles = analyst
srchIndexesAllowed = main, security, pci_raw
# Requires: PCI-DSS training, background check, audit logging

[role_standard_analyst]
importRoles = user
srchIndexesAllowed = main, security, pci_masked
# No access to raw PCI data

VALIDATION SEARCHES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Verify no unmasked credit cards in index
index=* 
| regex _raw="\b\d{4}[\s-]?\d{4}[\s-]?\d{4}[\s-]?\d{4}\b"
| where NOT match(_raw, "XXXX-XXXX-XXXX-\d{4}")
| table _time, source, sourcetype, _raw

# Should return 0 results if masking is working
                            </div>
                            <p><strong>PCI-DSS Requirements Addressed:</strong></p>
                            <ul>
                                <li>Req 3.4: Render PAN unreadable anywhere stored</li>
                                <li>Req 7.1: Limit access to system components</li>
                                <li>Req 10.5: Secure audit trails</li>
                            </ul>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question">Q: How do you secure Splunk forwarder to indexer communication?</button>
                        <div class="qa-answer">
                            <p><strong>End-to-End Forwarder Security:</strong></p>
                            <div class="arch-diagram">
SECURE FORWARDER ARCHITECTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                      TLS 1.2+
    Forwarder â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Indexer
              â”‚                     â”‚
              â”‚ Client Cert         â”‚ Server Cert
              â”‚ (forwarder.pem)     â”‚ (indexer.pem)
              â”‚                     â”‚
              â””â”€â”€â–º CA validates â—„â”€â”€â”€â”˜
                   both sides

STEP 1: GENERATE CERTIFICATES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Create CA (or use enterprise PKI)
openssl genrsa -out ca.key 4096
openssl req -x509 -new -nodes -key ca.key -sha256 -days 3650 \
  -out ca.pem -subj "/CN=Splunk-CA/O=Company"

# Create indexer certificate
openssl genrsa -out indexer.key 2048
openssl req -new -key indexer.key -out indexer.csr \
  -subj "/CN=idx*.company.com/O=Company"
openssl x509 -req -in indexer.csr -CA ca.pem -CAkey ca.key \
  -CAcreateserial -out indexer.crt -days 365 -sha256

# Create forwarder certificate
openssl genrsa -out forwarder.key 2048
openssl req -new -key forwarder.key -out forwarder.csr \
  -subj "/CN=forwarder/O=Company"
openssl x509 -req -in forwarder.csr -CA ca.pem -CAkey ca.key \
  -CAcreateserial -out forwarder.crt -days 365 -sha256

# Combine into PEM files
cat indexer.crt indexer.key > indexer.pem
cat forwarder.crt forwarder.key > forwarder.pem

STEP 2: CONFIGURE INDEXER (inputs.conf)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# /opt/splunk/etc/system/local/inputs.conf

[splunktcp-ssl:9997]
disabled = 0
connection_host = dns

[SSL]
serverCert = /opt/splunk/etc/auth/certs/indexer.pem
sslPassword = $7$<encrypted>
requireClientCert = true
sslVersions = tls1.2
sslCommonNameToCheck = forwarder
sslAltNameToCheck = forwarder.company.com
cipherSuite = ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256
rootCA = /opt/splunk/etc/auth/certs/ca.pem

STEP 3: CONFIGURE FORWARDER (outputs.conf)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# /opt/splunkforwarder/etc/system/local/outputs.conf

[tcpout]
defaultGroup = secure_indexers

[tcpout:secure_indexers]
server = idx1.company.com:9997, idx2.company.com:9997
clientCert = /opt/splunkforwarder/etc/auth/certs/forwarder.pem
sslPassword = $7$<encrypted>
sslVerifyServerCert = true
sslRootCAPath = /opt/splunkforwarder/etc/auth/certs/ca.pem
sslCommonNameToCheck = idx*.company.com
sslVersions = tls1.2
useClientSSLCompression = true

STEP 4: DEPLOY VIA DEPLOYMENT SERVER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Create deployment app
/opt/splunk/etc/deployment-apps/
â””â”€â”€ TA-secure-outputs/
    â””â”€â”€ local/
        â”œâ”€â”€ outputs.conf
        â””â”€â”€ auth/
            â””â”€â”€ certs/
                â”œâ”€â”€ forwarder.pem
                â””â”€â”€ ca.pem

# serverclass.conf
[serverClass:all_forwarders]
whitelist.0 = *
[serverClass:all_forwarders:app:TA-secure-outputs]
restartSplunkd = true
                            </div>
                            <p><strong>Verification:</strong></p>
                            <div class="arch-diagram">
# On indexer - verify TLS connections
index=_internal source=*splunkd.log component=TcpInputProc
| search "connection from"
| table _time, message

# Check for certificate errors
index=_internal source=*splunkd.log "SSL" OR "certificate"
| search error OR failed
| table _time, message
                            </div>
                        </div>
                    </div>
                </div>

                <h2><i class="fas fa-link"></i> Related Resources</h2>
                <ul>
                    <li><a href="administration.html">Administration</a></li>
                    <li><a href="clustering-ha.html">Clustering & HA</a></li>
                    <li><a href="troubleshooting.html">Troubleshooting</a></li>
                    <li><a href="monitoring-console.html">Monitoring Console</a></li>
                </ul>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
