<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Splunk ES Admin Certification | Complete Prep Guide</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .cert-domain { background: linear-gradient(135deg, #1a1f35 0%, #2d3555 100%); border: 1px solid #404968; border-radius: 12px; padding: 24px; margin: 20px 0; }
        .cert-domain h3 { color: #58a6ff; margin-top: 0; border-bottom: 2px solid #58a6ff; padding-bottom: 10px; }
        .domain-weight { background: #238636; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85em; float: right; }
        .objective-list { list-style: none; padding: 0; }
        .objective-list li { padding: 12px 16px; margin: 8px 0; background: #0d1117; border-radius: 6px; border-left: 4px solid #30363d; }
        .objective-list li.covered { border-left-color: #238636; }
        .objective-list li.partial { border-left-color: #d29922; }
        .status-icon { margin-right: 10px; }
        .exam-tip { background: linear-gradient(135deg, #1a472a 0%, #2d5a3d 100%); border: 1px solid #3d8b5a; border-radius: 8px; padding: 16px; margin: 16px 0; }
        .exam-tip h4 { color: #7ce38b; margin-top: 0; }
        .practice-q { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 12px 0; }
        .practice-q .question { color: #c9d1d9; font-weight: 600; margin-bottom: 12px; }
        .practice-q .options label { display: block; padding: 8px; margin: 4px 0; border-radius: 4px; cursor: pointer; }
        .practice-q .options label:hover { background: #21262d; }
        .dashboard-card { background: #0d1117; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 8px 0; }
        .dashboard-card h5 { color: #58a6ff; margin-top: 0; }
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <i class="fas fa-shield-alt"></i>
                    <span>Nik's SIEM</span>
                </a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certification Prep</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-certificate"></i><span>Power User Cert</span></a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog"></i><span>Admin Cert</span></a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link active"><i class="fas fa-shield-alt"></i><span>ES Admin Cert</span></a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud Admin Cert</span></a></li>
                    </ul>
                </div>
            </div>
        </aside>
        
        <div class="main-wrapper" id="mainWrapper">
            <main class="main-content">
                <h1><i class="fas fa-shield-alt"></i> Splunk Enterprise Security Certified Admin</h1>
                <p class="lead">Complete preparation guide for SPLK-3003 certification exam. Master Splunk Enterprise Security administration, correlation searches, and security operations.</p>

                <!-- Exam Overview -->
                <div class="info-box info-box-info">
                    <h4>Exam Details - SPLK-3003</h4>
                    <table class="compact-table">
                        <tr><td><strong>Duration:</strong></td><td>60 minutes</td></tr>
                        <tr><td><strong>Questions:</strong></td><td>62 multiple choice</td></tr>
                        <tr><td><strong>Passing Score:</strong></td><td>70%</td></tr>
                        <tr><td><strong>Prerequisites:</strong></td><td>Splunk Enterprise Certified Admin</td></tr>
                        <tr><td><strong>Recommended Experience:</strong></td><td>12+ months ES administration</td></tr>
                        <tr><td><strong>Cost:</strong></td><td>$130 USD</td></tr>
                    </table>
                </div>

                <!-- Domain 1: ES Installation -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">8%</span>Domain 1: ES Installation & Configuration</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>1.1</strong> Plan ES deployment (sizing, prerequisites)</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>1.2</strong> Install and configure ES</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>1.3</strong> Configure post-installation settings</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>1.4</strong> Integrate ES with CIM</li>
                    </ul>

                    <h4>ES Installation Requirements</h4>
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Prerequisites & Sizing</span>
                        </div>
                        <pre><code>ES PREREQUISITES
═══════════════════════════════════════════════════════════════════════════════

SPLUNK ENTERPRISE REQUIREMENTS:
• Splunk Enterprise 8.2+ (check ES version compatibility)
• Valid ES license (separate from Splunk Enterprise license)
• Splunk Common Information Model (CIM) Add-on
• Splunk Security Essentials (recommended)

SIZING GUIDELINES:
─────────────────────────────────────────────────────────────────────────────
┌────────────────┬─────────────────┬────────────────┬────────────────────────┐
│ Deployment     │ Daily Ingestion │ Search Heads   │ Indexers               │
├────────────────┼─────────────────┼────────────────┼────────────────────────┤
│ Small          │ < 100 GB/day    │ 1 (16 cores)   │ 1-3                    │
│ Medium         │ 100-500 GB/day  │ 3 SHC          │ 3-6 cluster            │
│ Large          │ 500+ GB/day     │ 5+ SHC         │ 6+ cluster             │
└────────────────┴─────────────────┴────────────────┴────────────────────────┘

SEARCH HEAD REQUIREMENTS FOR ES:
• 16+ CPU cores
• 32+ GB RAM (64GB recommended)
• SSD storage for kvstore
• Dedicated ES search head (or search head cluster)

INSTALLATION STEPS:
─────────────────────────────────────────────────────────────────────────────
1. Install Splunk Common Information Model (CIM) Add-on on Search Head(s)
2. Install Splunk ES app on Search Head(s)
3. Run ES setup wizard (Configure → General → General Settings)
4. Enable required data models
5. Configure asset and identity lookups
6. Enable correlation searches

# Post-install configuration
index=_internal sourcetype=splunkd component=ESSetup
| table _time, message</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">ES Configuration Files</span>
                        </div>
                        <pre><code># Key ES configuration files
$SPLUNK_HOME/etc/apps/SplunkEnterpriseSecuritySuite/

├── default/
│   ├── savedsearches.conf      # Correlation searches
│   ├── correlationsearches.conf # Correlation search settings
│   ├── inputs.conf              # Modular inputs
│   ├── eventtypes.conf          # Event classifications
│   └── transforms.conf          # Notable field extractions
│
├── local/                       # Your customizations go here
│   ├── savedsearches.conf      # Custom/modified searches
│   └── correlationsearches.conf
│
└── lookups/
    ├── asset_lookup_by_str.csv  # Asset lookup
    ├── identity_lookup_expanded.csv # Identity lookup
    ├── cim_actions.csv          # Adaptive response actions
    └── threat_intelligence_*.csv # TI lookups

ES INDEXES (auto-created):
─────────────────────────────────────────────────────────────────────────────
• notable         - Notable events
• risk            - Risk events
• cim_modactions  - Adaptive response actions
• threat_activity - Threat intelligence matches
• ioc             - Indicators of Compromise</code></pre>
                    </div>
                </div>

                <!-- Domain 2: Data Sources -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">12%</span>Domain 2: Data Sources & CIM</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>2.1</strong> Map data to CIM data models</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>2.2</strong> Configure data model acceleration</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>2.3</strong> Validate CIM compliance</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>2.4</strong> Troubleshoot data model issues</li>
                    </ul>

                    <h4>Critical ES Data Models</h4>
                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">ES Data Models</span>
                        </div>
                        <pre><code>ES DATA MODELS (Must Know for Exam!)
═══════════════════════════════════════════════════════════════════════════════

AUTHENTICATION DATA MODEL
─────────────────────────────────────────────────────────────────────────────
• Purpose: Track login success/failure across all systems
• Key Fields: user, src, dest, action, app
• Sources: Windows Security (4624/4625), Linux auth, VPN, SSO, Cloud

| tstats count FROM datamodel=Authentication 
  WHERE Authentication.action=failure 
  BY Authentication.user, Authentication.src
| sort -count

NETWORK TRAFFIC DATA MODEL
─────────────────────────────────────────────────────────────────────────────
• Purpose: Network flow and connection data
• Key Fields: src_ip, dest_ip, dest_port, bytes, action
• Sources: Firewall, IDS/IPS, Netflow, Proxy

| tstats sum(All_Traffic.bytes) FROM datamodel=Network_Traffic 
  BY All_Traffic.dest_ip, All_Traffic.dest_port
| sort -sum(All_Traffic.bytes)

ENDPOINT DATA MODEL
─────────────────────────────────────────────────────────────────────────────
• Purpose: Endpoint processes, services, filesystem
• Key Fields: dest, process, process_path, user, action
• Sources: Sysmon, CrowdStrike, Carbon Black, EDR

| tstats count FROM datamodel=Endpoint.Processes 
  WHERE Processes.process_name="powershell.exe" 
  BY Processes.dest, Processes.user, Processes.parent_process

MALWARE DATA MODEL
─────────────────────────────────────────────────────────────────────────────
• Purpose: Malware/AV detection events
• Key Fields: signature, file_name, file_path, action, dest
• Sources: AV, EDR, sandbox

INTRUSION DETECTION DATA MODEL
─────────────────────────────────────────────────────────────────────────────
• Purpose: IDS/IPS alerts
• Key Fields: signature, category, severity, src, dest
• Sources: Snort, Suricata, Palo Alto Threat, Cisco IPS

DATA MODEL ACCELERATION
─────────────────────────────────────────────────────────────────────────────
Location: Settings → Data Models → [Model] → Edit Acceleration

# Check acceleration status
| rest /services/datamodel/acceleration
| table title, acceleration.enabled, acceleration.earliest_time

# Verify accelerated data
| tstats count FROM datamodel=Authentication WHERE * BY _time span=1d
| timechart span=1d count

# Acceleration settings in datamodels.conf
[Authentication]
acceleration = true
acceleration.earliest_time = -1y
acceleration.backfill_time = -30d
acceleration.cron_schedule = */5 * * * *</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">CIM Compliance Validation</span>
                        </div>
                        <pre><code># Check if sourcetype is CIM compliant for Authentication
index=* sourcetype=WinEventLog:Security EventCode=4625 earliest=-1h
| table _time, user, src, dest, action, app, signature

` Expected CIM fields for Authentication: `
` - user: Username attempting authentication `
` - src: Source IP/hostname `
` - dest: Destination system `
` - action: success/failure `
` - app: Application/service `

# Verify fields are being extracted
index=* sourcetype=your_sourcetype earliest=-1h
| fieldsummary
| search field IN (user, src, dest, action, app)
| table field, count, distinct_count

# CIM Validator App
` Install "SA-CIM-Validator" from Splunkbase `
` Provides automated compliance checking `

COMMON CIM MAPPING ISSUES:
─────────────────────────────────────────────────────────────────────────────
1. Field not extracted → Add extraction in props.conf
2. Wrong field name → Create alias in props.conf
3. Missing eventtypes → Add eventtype for sourcetype
4. Not accelerating → Check data model constraints match your data</code></pre>
                    </div>

                    <div class="exam-tip">
                        <h4><i class="fas fa-lightbulb"></i> Exam Tip</h4>
                        <p>Know that ES correlation searches use <code>| tstats</code> against accelerated data models. If a correlation search isn't finding data, check: 1) Is the data model accelerated? 2) Does the data match the data model constraints (tags/eventtypes)?</p>
                    </div>
                </div>

                <!-- Domain 3: Asset & Identity -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">15%</span>Domain 3: Asset & Identity Framework</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>3.1</strong> Configure asset lookup</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>3.2</strong> Configure identity lookup</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>3.3</strong> Set up asset/identity correlation</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>3.4</strong> Configure priority and categorization</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Asset Lookup Configuration</span>
                        </div>
                        <pre><code>ASSET LOOKUP FIELDS
═══════════════════════════════════════════════════════════════════════════════

REQUIRED FIELDS:
─────────────────────────────────────────────────────────────────────────────
• ip          - IP address (primary key for matching)
• mac         - MAC address (optional key)
• nt_host     - Windows hostname
• dns         - Fully qualified domain name
• owner       - Asset owner/responsible party

RECOMMENDED FIELDS:
─────────────────────────────────────────────────────────────────────────────
• priority    - critical, high, medium, low, informational
• lat/long    - Geolocation (for maps)
• city        - City location
• country     - Country
• bunit       - Business unit
• category    - server, workstation, network, iot, etc.
• pci_domain  - cardholder, trust, untrust
• is_expected - true/false (expected on network)
• should_timesync - true/false
• should_update    - true/false
• requires_av      - true/false

SAMPLE ASSET LOOKUP (assets.csv):
─────────────────────────────────────────────────────────────────────────────
ip,mac,nt_host,dns,owner,priority,lat,long,city,country,bunit,category,pci_domain,is_expected
10.1.1.10,00:11:22:33:44:55,DC01,dc01.company.com,IT,critical,43.65,-79.38,Toronto,Canada,IT,server,trust,true
10.1.1.20,00:11:22:33:44:56,SQL01,sql01.company.com,DBA,critical,43.65,-79.38,Toronto,Canada,IT,server,cardholder,true
10.2.1.100,AA:BB:CC:DD:EE:FF,WKS001,wks001.company.com,jsmith,medium,43.65,-79.38,Toronto,Canada,Sales,workstation,untrust,true

# Upload/configure assets
Location: Configure → Data Enrichment → Asset Lookups
- Upload CSV or configure automated lookup

# Merge logic (when multiple matches)
` IP match takes precedence over MAC match `
` More specific match wins over wildcard `

# Test asset lookup
| inputlookup asset_lookup_by_str
| search ip=10.1.1.*
| table ip, nt_host, owner, priority, category</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Identity Lookup Configuration</span>
                        </div>
                        <pre><code>IDENTITY LOOKUP FIELDS
═══════════════════════════════════════════════════════════════════════════════

REQUIRED FIELDS:
─────────────────────────────────────────────────────────────────────────────
• identity    - Primary identifier (username)
• email       - Email address

RECOMMENDED FIELDS:
─────────────────────────────────────────────────────────────────────────────
• prefix      - Mr, Ms, Dr
• nick        - Nickname
• first       - First name
• last        - Last name
• suffix      - Jr, Sr, III
• phone       - Phone number
• managedBy   - Manager's identity
• priority    - critical, high, medium, low
• bunit       - Business unit
• category    - employee, contractor, service_account, privileged
• watchlist   - true/false (extra scrutiny)
• startDate   - Employment start
• endDate     - Employment end (for termination detection)

SAMPLE IDENTITY LOOKUP (identities.csv):
─────────────────────────────────────────────────────────────────────────────
identity,first,last,email,phone,managedBy,priority,bunit,category,watchlist
jsmith,John,Smith,jsmith@company.com,555-1234,mwilson,medium,Sales,employee,false
mwilson,Mary,Wilson,mwilson@company.com,555-5678,,high,Sales,manager,false
admin_sql,SQL,Admin,dba@company.com,,,critical,IT,service_account,true
contractor1,Bob,External,bob@vendor.com,,,medium,IT,contractor,true

# Identity correlation
` ES automatically correlates events by username to identity `
` Enables: "Show all events for this user across all systems" `

# Priority Impact
` Critical user events get higher notable urgency `
` Watchlist users trigger additional scrutiny `

# Test identity lookup  
| inputlookup identity_lookup_expanded
| search bunit=IT
| table identity, first, last, category, priority, watchlist</code></pre>
                    </div>

                    <div class="practice-q">
                        <div class="question">Q: A notable event involves user "jsmith" who has priority "high" in the identity lookup. How does ES use this?</div>
                        <div class="options">
                            <label><input type="radio" name="q1"> A) No effect on notable events</label>
                            <label><input type="radio" name="q1" checked> B) Notable urgency may be elevated based on user priority</label>
                            <label><input type="radio" name="q1"> C) User is automatically blocked</label>
                            <label><input type="radio" name="q1"> D) Alert is suppressed</label>
                        </div>
                        <details style="margin-top: 12px; color: #8b949e;">
                            <summary>Show Answer</summary>
                            <p><strong>B) Notable urgency may be elevated based on user priority</strong> - ES uses asset/identity priority to influence the urgency of notable events. A high-priority user involved in an incident increases the urgency.</p>
                        </details>
                    </div>
                </div>

                <!-- Domain 4: Correlation Searches -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">20%</span>Domain 4: Correlation Searches</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>4.1</strong> Understand correlation search architecture</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>4.2</strong> Create custom correlation searches</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>4.3</strong> Configure notable event creation</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>4.4</strong> Configure risk modifiers</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>4.5</strong> Tune and manage correlation searches</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Correlation Search Anatomy</span>
                        </div>
                        <pre><code>CORRELATION SEARCH STRUCTURE
═══════════════════════════════════════════════════════════════════════════════

# savedsearches.conf
[My Custom Detection Rule]
# Basic settings
search = | tstats count FROM datamodel=Authentication.Failed_Authentication \
         WHERE * BY Authentication.user, Authentication.src \
         | where count > 10
cron_schedule = */5 * * * *    # Run every 5 minutes
enableSched = 1
disabled = 0

# Correlation search specific
action.correlationsearch.enabled = 1
action.correlationsearch.label = Brute Force Detection

# Notable event settings
action.notable = 1
action.notable.param.rule_title = Brute Force Attack Detected
action.notable.param.rule_description = User $Authentication.user$ had $count$ failed logins from $Authentication.src$
action.notable.param.severity = high
action.notable.param.security_domain = access
action.notable.param.drilldown_name = View failed logins
action.notable.param.drilldown_search = index=* user="$Authentication.user$" action=failure

# Risk modifier (alternative to notable)
action.risk = 1
action.risk.param.risk_object = user
action.risk.param.risk_object_type = user
action.risk.param.risk_score = 40
action.risk.param.risk_message = User $user$ had $count$ failed logins

CORRELATION SEARCH BEST PRACTICES:
─────────────────────────────────────────────────────────────────────────────
1. Use | tstats against accelerated data models (fastest)
2. Include time bounds in search (earliest=-5m@m latest=now)
3. Filter early in search (WHERE clause vs later | where)
4. Use specific data model constraints
5. Include descriptive drilldown search for analysts
6. Map to MITRE ATT&CK technique</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Creating Custom Correlation Searches</span>
                        </div>
                        <pre><code># Step-by-step correlation search creation
Location: Configure → Content → Content Management → Create New Content

EXAMPLE: Detect Excessive Failed Logins
─────────────────────────────────────────────────────────────────────────────

# 1. Write and test the search
| tstats summariesonly=true count 
  FROM datamodel=Authentication.Failed_Authentication 
  WHERE * 
  BY Authentication.user, Authentication.src, Authentication.dest, _time span=5m
| where count > 5
| `drop_dm_object_name("Authentication")`

# 2. Add notable fields
| eval rule_name="Excessive Failed Logins"
| eval severity=case(
    count > 20, "critical",
    count > 10, "high",
    count > 5, "medium",
    1=1, "low")
| eval security_domain="access"

# 3. Configure throttling (prevent alert storms)
Throttle: 1 notable per user per hour
` In UI: Adaptive Response Actions → Notable → Throttle `

# 4. Configure drilldown
drilldown_search = index=* sourcetype=WinEventLog:Security EventCode=4625 user="$user$"

EXAMPLE: Detect Data Exfiltration
─────────────────────────────────────────────────────────────────────────────
| tstats summariesonly=true sum(All_Traffic.bytes_out) as bytes_out 
  FROM datamodel=Network_Traffic 
  WHERE All_Traffic.dest_category="external" 
  BY All_Traffic.src, _time span=1h
| where bytes_out > 1073741824    ` 1GB in 1 hour `
| eval bytes_out_GB = round(bytes_out/1024/1024/1024, 2)
| eval rule_name="Potential Data Exfiltration"
| eval severity="high"</code></pre>
                    </div>

                    <div class="exam-tip">
                        <h4><i class="fas fa-lightbulb"></i> Exam Tip</h4>
                        <p>Remember the <code>summariesonly=true</code> parameter in tstats! This ensures the search ONLY uses accelerated data, which is faster but won't return data that hasn't been accelerated yet. Remove it to search both accelerated and raw data (slower).</p>
                    </div>
                </div>

                <!-- Domain 5: Notable Events -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">15%</span>Domain 5: Notable Events & Investigation</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>5.1</strong> Understand notable event workflow</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>5.2</strong> Configure Incident Review dashboard</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>5.3</strong> Manage notable event statuses</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>5.4</strong> Use Investigation Workbench</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>5.5</strong> Configure Swim Lanes and Sequence Templates</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Notable Event Lifecycle</span>
                        </div>
                        <pre><code>NOTABLE EVENT WORKFLOW
═══════════════════════════════════════════════════════════════════════════════

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│    NEW      │───▶│ IN PROGRESS │───▶│   PENDING   │───▶│  RESOLVED   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
      │                  │                   │                   │
      │                  │                   │                   │
      ▼                  ▼                   ▼                   ▼
   Unassigned        Analyst             Waiting for        Threat
   No action         investigating       external input     contained
                                        (e.g., user)

NOTABLE URGENCY CALCULATION
─────────────────────────────────────────────────────────────────────────────
Urgency = f(Severity, Asset Priority, Identity Priority)

┌─────────────┬──────────────────────────────────────────────────────────────┐
│ Severity    │ Base urgency from correlation search                        │
│ Priority    │ From asset/identity lookup (critical, high, medium, low)    │
│ RESULT      │ Combined to determine final urgency                         │
└─────────────┴──────────────────────────────────────────────────────────────┘

Example:
• Severity: Medium + Asset Priority: Critical = Urgency: High
• Severity: High + Asset Priority: Low = Urgency: Medium

DISPOSITION CATEGORIES (on close):
─────────────────────────────────────────────────────────────────────────────
• True Positive: Confirmed security incident
• Benign Positive: Expected behavior, correctly detected
• False Positive: Detection error, no threat
• Undetermined: Insufficient data to determine</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Swim Lanes (Visual Timeline)</span>
                        </div>
                        <pre><code>SWIM LANES - Visual investigation timeline
═══════════════════════════════════════════════════════════════════════════════

Purpose: Show related events across multiple data sources on a timeline

Location: Investigate → Investigation Workbench → Swim Lanes

DEFAULT SWIM LANES:
─────────────────────────────────────────────────────────────────────────────
• Authentication - Login/logout events
• Endpoint - Process/file events  
• Network - Traffic/connection events
• Notable - Related notables

CUSTOM SWIM LANE CONFIGURATION:
─────────────────────────────────────────────────────────────────────────────
# swimlane_config.conf
[authentication_swimlane]
label = Authentication Events
search = | tstats count FROM datamodel=Authentication BY _time, Authentication.action
color = blue

[endpoint_swimlane]  
label = Endpoint Activity
search = | tstats count FROM datamodel=Endpoint.Processes BY _time
color = green

USING SWIM LANES IN INVESTIGATION:
1. Start from notable event
2. Set time range around incident
3. Add entity to investigate (user, host)
4. View correlated events across lanes
5. Click events for details
6. Add findings to investigation</code></pre>
                    </div>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Sequence Templates</span>
                        </div>
                        <pre><code>SEQUENCE TEMPLATES - Attack chain detection
═══════════════════════════════════════════════════════════════════════════════

Purpose: Detect multi-stage attacks by matching event sequences

Location: Configure → Content → Sequence Templates

EXAMPLE: Lateral Movement Detection
─────────────────────────────────────────────────────────────────────────────
Sequence:
1. Failed login attempts (reconnaissance)
2. Successful login (initial access)  
3. Process execution (execution)
4. Network connection to new host (lateral movement)

# Sequence template configuration
[Lateral_Movement_Sequence]
description = Detects potential lateral movement pattern
sequence_constraint = Authentication.user
time_window = 3600    # 1 hour

step.0.search = tag=authentication action=failure | stats count
step.0.constraint = count > 3

step.1.search = tag=authentication action=success
step.1.time_after_previous = 0-300    # Within 5 min of step 0

step.2.search = tag=process process_name IN (psexec.exe, wmic.exe, powershell.exe)
step.2.time_after_previous = 0-600    # Within 10 min

step.3.search = tag=network dest!=src_in_step_1
step.3.time_after_previous = 0-1800   # Within 30 min</code></pre>
                    </div>
                </div>

                <!-- Domain 6: Risk-Based Alerting -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">15%</span>Domain 6: Risk-Based Alerting</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>6.1</strong> Understand RBA concepts</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>6.2</strong> Configure risk modifiers</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>6.3</strong> Configure risk aggregation rules</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>6.4</strong> Tune risk thresholds</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Risk-Based Alerting Architecture</span>
                        </div>
                        <pre><code>RBA FLOW
═══════════════════════════════════════════════════════════════════════════════

[Low-Fidelity Detection]  ──▶  [Risk Event]  ──▶  [Risk Index]
         │                          │                   │
         │                          │                   │
         ▼                          ▼                   ▼
   "Suspicious but         Assigns risk_score    Accumulated per
    not actionable         to risk_object        entity (user/host)
    alone"                 (user or host)
                                                        │
                                                        ▼
                                              [Risk Aggregation Search]
                                                        │
                                                        ▼
                                              [Risk Notable Event]
                                              (When threshold exceeded)

RISK EVENT FIELDS:
─────────────────────────────────────────────────────────────────────────────
• risk_object: Entity receiving risk (username, hostname)
• risk_object_type: user, system, other
• risk_score: Numeric score (1-100 typical)
• risk_message: Description of why risk assigned
• source: Detection rule that generated risk

RISK MODIFIER CONFIGURATION:
─────────────────────────────────────────────────────────────────────────────
# In correlation search
action.risk = 1
action.risk.param._risk = [
  {"risk_object_field":"user","risk_object_type":"user","risk_score":40},
  {"risk_object_field":"dest","risk_object_type":"system","risk_score":30}
]
action.risk.param._risk_message = Suspicious activity: $signature$

# Multiple risk objects from single event
` One event can assign risk to BOTH user AND host `

RISK AGGREGATION SEARCH (OOTB):
─────────────────────────────────────────────────────────────────────────────
# "Risk Threshold Exceeded For User" - Default ES rule
| tstats summariesonly=true sum(All_Risk.calculated_risk_score) as risk_score
  FROM datamodel=Risk.All_Risk 
  WHERE All_Risk.risk_object_type="user" earliest=-24h
  BY All_Risk.risk_object
| where risk_score > 100    ← THRESHOLD
| `risk_notable`

TUNING RISK THRESHOLDS:
─────────────────────────────────────────────────────────────────────────────
• Start with default threshold (100)
• Monitor risk score distribution
• Adjust based on alert volume and true positive rate
• Consider different thresholds for users vs systems
• Consider time window (24h default)</code></pre>
                    </div>

                    <div class="practice-q">
                        <div class="question">Q: What is the main benefit of Risk-Based Alerting over traditional alerting?</div>
                        <div class="options">
                            <label><input type="radio" name="q6"> A) Faster search performance</label>
                            <label><input type="radio" name="q6" checked> B) Reduces alert fatigue by correlating multiple low-fidelity signals</label>
                            <label><input type="radio" name="q6"> C) Requires less disk space</label>
                            <label><input type="radio" name="q6"> D) Eliminates false positives entirely</label>
                        </div>
                        <details style="margin-top: 12px; color: #8b949e;">
                            <summary>Show Answer</summary>
                            <p><strong>B) Reduces alert fatigue by correlating multiple low-fidelity signals</strong> - RBA allows you to keep low-fidelity detections that would be too noisy as individual alerts. Multiple signals combine to create high-confidence alerts only when an entity exceeds the risk threshold.</p>
                        </details>
                    </div>
                </div>

                <!-- Domain 7: Threat Intelligence -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">10%</span>Domain 7: Threat Intelligence</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>7.1</strong> Configure threat intelligence sources</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>7.2</strong> Manage threat intelligence lookups</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>7.3</strong> Create threat intelligence correlation</li>
                    </ul>

                    <div class="config-block">
                        <div class="config-block-header">
                            <span class="config-title">Threat Intelligence Framework</span>
                        </div>
                        <pre><code>THREAT INTELLIGENCE IN ES
═══════════════════════════════════════════════════════════════════════════════

TI SOURCES:
─────────────────────────────────────────────────────────────────────────────
• STIX/TAXII feeds (automated)
• CSV uploads (manual)
• Splunkbase TI apps (community)
• Commercial feeds (Recorded Future, etc.)

TI LOOKUP TYPES:
─────────────────────────────────────────────────────────────────────────────
• ip_intel: Malicious IP addresses
• domain_intel: Malicious domains
• file_intel: Malicious file hashes (MD5, SHA1, SHA256)
• email_intel: Malicious email addresses
• http_intel: Malicious URLs
• certificate_intel: Malicious SSL certificates

CONFIGURATION:
─────────────────────────────────────────────────────────────────────────────
Location: Configure → Data Enrichment → Threat Intelligence Downloads

# Manual CSV upload format (ip_intel)
ip,description,threat_group,weight
192.168.100.50,C2 Server,APT29,100
10.10.10.10,Scanner,Unknown,50

# STIX/TAXII configuration
[taxii_feed]
type = taxii
url = https://feeds.example.com/taxii
collection = IP-Watchlist
username = api_user
password = api_key
interval = 3600

THREAT MATCH CORRELATION:
─────────────────────────────────────────────────────────────────────────────
# ES automatically correlates events against TI lookups
# Results stored in: index=threat_activity

# Search for TI matches
index=threat_activity
| table _time, threat_match_field, threat_match_value, 
        threat_collection, weight, description</code></pre>
                    </div>
                </div>

                <!-- Domain 8: Dashboards -->
                <div class="cert-domain">
                    <h3><span class="domain-weight">5%</span>Domain 8: ES Dashboards</h3>
                    <ul class="objective-list">
                        <li class="covered"><span class="status-icon">✅</span><strong>8.1</strong> Navigate ES dashboards</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>8.2</strong> Configure Glass Tables</li>
                        <li class="covered"><span class="status-icon">✅</span><strong>8.3</strong> Customize dashboard panels</li>
                    </ul>

                    <h4>Key ES Dashboards</h4>
                    <div class="dashboard-card">
                        <h5>Security Posture</h5>
                        <p>Executive overview of security health. Shows notable trends, key indicators, compliance status.</p>
                        <p><strong>Key Metrics:</strong> Notable count, MTTR, risk scores, compliance %</p>
                    </div>
                    <div class="dashboard-card">
                        <h5>Incident Review</h5>
                        <p>Primary analyst workspace. Triage and investigate notable events.</p>
                        <p><strong>Key Actions:</strong> Filter, assign, investigate, disposition</p>
                    </div>
                    <div class="dashboard-card">
                        <h5>Risk Analysis</h5>
                        <p>View entities with elevated risk scores.</p>
                        <p><strong>Key Metrics:</strong> Top risky users, top risky hosts, risk trends</p>
                    </div>
                    <div class="dashboard-card">
                        <h5>Access Center</h5>
                        <p>Authentication and access monitoring.</p>
                        <p><strong>Key Metrics:</strong> Failed logins, account changes, privileged access</p>
                    </div>
                    <div class="dashboard-card">
                        <h5>Endpoint Center</h5>
                        <p>Endpoint activity and malware visibility.</p>
                        <p><strong>Key Metrics:</strong> Malware detections, suspicious processes, changes</p>
                    </div>
                    <div class="dashboard-card">
                        <h5>Network Center</h5>
                        <p>Network traffic analysis.</p>
                        <p><strong>Key Metrics:</strong> Traffic volume, top talkers, IDS alerts</p>
                    </div>
                    <div class="dashboard-card">
                        <h5>Protocol Intelligence</h5>
                        <p>Deep protocol analysis (DNS, HTTP, SSL, etc.).</p>
                        <p><strong>Key Metrics:</strong> DNS queries, HTTP traffic, certificate issues</p>
                    </div>
                    <div class="dashboard-card">
                        <h5>User Intelligence</h5>
                        <p>User behavior analytics.</p>
                        <p><strong>Key Metrics:</strong> User activity patterns, anomalies, watchlist</p>
                    </div>
                </div>

                <!-- Study Plan -->
                <h2><i class="fas fa-book-reader"></i> Study Plan</h2>
                <div class="info-box info-box-tip">
                    <h4>8-Week ES Admin Certification Study Plan</h4>
                    <ol>
                        <li><strong>Week 1:</strong> ES Architecture & Installation</li>
                        <li><strong>Week 2:</strong> CIM Data Models & Acceleration</li>
                        <li><strong>Week 3:</strong> Asset & Identity Framework</li>
                        <li><strong>Week 4:</strong> Correlation Searches (Part 1 - Understanding)</li>
                        <li><strong>Week 5:</strong> Correlation Searches (Part 2 - Building)</li>
                        <li><strong>Week 6:</strong> Risk-Based Alerting</li>
                        <li><strong>Week 7:</strong> Notable Events, Investigation, Threat Intel</li>
                        <li><strong>Week 8:</strong> Practice Exams & Review</li>
                    </ol>
                </div>

                <!-- Related Pages -->
                <h2><i class="fas fa-link"></i> Related Topics</h2>
                <ul>
                    <li><a href="es-overview.html">Enterprise Security Overview</a></li>
                    <li><a href="correlation-searches.html">Correlation Searches Deep Dive</a></li>
                    <li><a href="risk-based-alerting.html">Risk-Based Alerting Guide</a></li>
                    <li><a href="notable-events.html">Notable Events Management</a></li>
                    <li><a href="data-models.html">Data Models & CIM</a></li>
                    <li><a href="threat-intel.html">Threat Intelligence</a></li>
                </ul>

            </main>
        </div>
    </div>
</body>
</html>
