<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>Dashboards - Splunk Enterprise Security</title>
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <nav class="sidebar">
        <div class="sidebar-header"><h2>SOC Compendium</h2></div>
        <ul class="nav-links">
            <li><a href="../index.html">üè† Home</a></li>
            <li><a href="../cortex/index.html">üü† Cortex XDR</a></li>
            <li><a href="../crowdstrike/index.html">üî¥ CrowdStrike</a></li>
            <li><a href="../mde/index.html">üîµ Microsoft Defender</a></li>
            <li><a href="../xsiam/index.html">üü£ XSIAM</a></li>
            <li><a href="../sentinel/index.html">üî∑ Sentinel</a></li>
            <li><a href="index.html" class="active">üü¢ Splunk</a></li>
            <li><a href="../operations/index.html">‚öôÔ∏è Operations</a></li>
        </ul>
    </nav>

    <main class="main-content">
        <div class="content-header">
            <h1>üü¢ Security Dashboards</h1>
            <p>Build effective SOC dashboards for security monitoring, investigation, and reporting</p>
        </div>

        <!-- Dashboard Overview -->
        <section class="content-section">
            <h2>Dashboard Overview</h2>
            <p>Dashboards are the primary interface for SOC analysts to monitor security posture, investigate incidents, and track operational metrics. Effective dashboards balance information density with usability.</p>
            
            <div class="grid-container">
                <div class="grid-item highlight-card">
                    <h3>üìä Dashboard Types</h3>
                    <ul>
                        <li><strong>Operational</strong> - Real-time SOC monitoring</li>
                        <li><strong>Investigative</strong> - Deep-dive analysis</li>
                        <li><strong>Executive</strong> - High-level metrics</li>
                        <li><strong>Compliance</strong> - Regulatory reporting</li>
                    </ul>
                </div>
                <div class="grid-item highlight-card">
                    <h3>üéØ Design Principles</h3>
                    <ul>
                        <li><strong>Actionable</strong> - Drive decision-making</li>
                        <li><strong>Contextual</strong> - Provide relevant detail</li>
                        <li><strong>Performant</strong> - Fast load times</li>
                        <li><strong>Drilldown</strong> - Enable investigation</li>
                    </ul>
                </div>
            </div>

            <h3>Splunk Dashboard Framework</h3>
            <table class="comparison-table">
                <thead>
                    <tr><th>Framework</th><th>Use Case</th><th>Complexity</th><th>Features</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Classic Dashboards</strong></td>
                        <td>Simple visualizations</td>
                        <td>Low</td>
                        <td>SimpleXML, form inputs, basic drilldown</td>
                    </tr>
                    <tr>
                        <td><strong>Dashboard Studio</strong></td>
                        <td>Modern dashboards</td>
                        <td>Medium</td>
                        <td>Drag-drop, advanced visuals, JSON definition</td>
                    </tr>
                    <tr>
                        <td><strong>ES Security Posture</strong></td>
                        <td>Security operations</td>
                        <td>Built-in</td>
                        <td>Notable events, risk scores, KPIs</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- SOC Operations Dashboard -->
        <section class="content-section">
            <h2>SOC Operations Dashboard</h2>
            <p>The primary dashboard for real-time security monitoring and alert triage.</p>

            <h3>Essential Panels</h3>
            <table class="comparison-table">
                <thead>
                    <tr><th>Panel</th><th>Purpose</th><th>Visualization</th><th>Refresh</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Active Notable Events</strong></td>
                        <td>Current open alerts</td>
                        <td>Table with severity colors</td>
                        <td>1-5 minutes</td>
                    </tr>
                    <tr>
                        <td><strong>Notable Event Trend</strong></td>
                        <td>Alert volume over time</td>
                        <td>Area chart by severity</td>
                        <td>5 minutes</td>
                    </tr>
                    <tr>
                        <td><strong>Top Alert Sources</strong></td>
                        <td>Systems generating alerts</td>
                        <td>Bar chart</td>
                        <td>5 minutes</td>
                    </tr>
                    <tr>
                        <td><strong>Risk Score Leaders</strong></td>
                        <td>Highest risk entities</td>
                        <td>Table with sparklines</td>
                        <td>5 minutes</td>
                    </tr>
                    <tr>
                        <td><strong>Data Source Health</strong></td>
                        <td>Ingestion status</td>
                        <td>Status indicators</td>
                        <td>1 minute</td>
                    </tr>
                    <tr>
                        <td><strong>Analyst Workload</strong></td>
                        <td>Queue distribution</td>
                        <td>Pie/donut chart</td>
                        <td>5 minutes</td>
                    </tr>
                </tbody>
            </table>

            <h3>Notable Events Summary Panel</h3>
            <div class="code-block">
                <pre><code>| `notable`
| where status!="5"  <!-- Exclude closed -->
| eval urgency_num=case(
    urgency="critical", 5,
    urgency="high", 4,
    urgency="medium", 3,
    urgency="low", 2,
    urgency="informational", 1,
    true(), 0)
| stats count as "Count" by urgency, status
| eval Status=case(
    status="0", "Unassigned",
    status="1", "New",
    status="2", "In Progress",
    status="3", "Pending",
    status="4", "Resolved",
    true(), "Unknown")
| sort -urgency_num</code></pre>
            </div>

            <h3>Alert Volume Trend</h3>
            <div class="code-block">
                <pre><code>| `notable`
| timechart span=1h count by urgency
| eval Critical=coalesce(critical,0), 
       High=coalesce(high,0), 
       Medium=coalesce(medium,0),
       Low=coalesce(low,0),
       Info=coalesce(informational,0)
| fields _time, Critical, High, Medium, Low, Info

<!-- Alternative: Stacked area chart query -->
| `notable`
| bucket _time span=1h
| stats count by _time, urgency
| xyseries _time urgency count
| fillnull value=0</code></pre>
            </div>

            <h3>Data Source Health Monitoring</h3>
            <div class="code-block">
                <pre><code><!-- Data source last seen times -->
| tstats latest(_time) as last_event 
    WHERE index=* BY sourcetype
| eval hours_ago=round((now()-last_event)/3600,2)
| eval status=case(
    hours_ago < 0.5, "‚úÖ Healthy",
    hours_ago < 2, "‚ö†Ô∏è Warning", 
    hours_ago < 24, "üî¥ Critical",
    true(), "‚ùå Dead")
| table sourcetype, last_event, hours_ago, status
| sort -hours_ago

<!-- EPS by sourcetype -->
| tstats count as events 
    WHERE index=* BY sourcetype _time span=1h
| timechart span=1h sum(events) as EPS by sourcetype
| eval EPS=EPS/3600</code></pre>
            </div>
        </section>

        <!-- Investigation Dashboard -->
        <section class="content-section">
            <h2>Investigation Dashboard</h2>
            <p>Dashboards designed for deep-dive analysis during incident response.</p>

            <h3>Entity Investigation Dashboard</h3>
            <div class="code-block">
                <pre><code><!-- Dashboard Form Inputs -->
<form>
  <label>Entity Investigation</label>
  <fieldset submitButton="true">
    <input type="text" token="entity">
      <label>IP/Host/User:</label>
    </input>
    <input type="time" token="time">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
</form>

<!-- Entity Summary Panel -->
index=* (src="$entity$" OR dest="$entity$" OR user="$entity$" OR host="$entity$")
| stats count as Events, 
        dc(index) as "Data Sources",
        dc(sourcetype) as "Log Types",
        earliest(_time) as "First Seen",
        latest(_time) as "Last Seen"
| eval "First Seen"=strftime('First Seen', "%Y-%m-%d %H:%M:%S")
| eval "Last Seen"=strftime('Last Seen', "%Y-%m-%d %H:%M:%S")

<!-- Related Notable Events -->
| `notable`
| search src="$entity$" OR dest="$entity$" OR user="$entity$"
| table _time, rule_name, urgency, src, dest, user, status
| sort -_time

<!-- Network Activity -->
index=firewall OR index=proxy src="$entity$" OR dest="$entity$"
| stats count by dest_ip, dest_port, action
| sort -count

<!-- Authentication Events -->
index=windows sourcetype="WinEventLog:Security" 
    (EventCode=4624 OR EventCode=4625) user="$entity$"
| stats count by EventCode, src_ip, Logon_Type
| eval Event=case(EventCode=4624, "Success", EventCode=4625, "Failure")
| sort -count</code></pre>
            </div>

            <h3>Process Investigation Panel</h3>
            <div class="code-block">
                <pre><code><!-- Process tree visualization -->
index=sysmon OR index=edr 
    (process_name="$process$" OR parent_process_name="$process$")
| stats values(process_name) as "Process", 
        values(parent_process_name) as "Parent",
        values(command_line) as "Command Line",
        dc(host) as "Host Count",
        count as "Events"
    by process_guid
| sort -count

<!-- Process command line analysis -->
index=sysmon EventCode=1 process_name="$process$"
| rex field=command_line "(?<encoded>-[eE]nc[oO]?[dD]?[eE]?[dD]?[cC]?[oO]?[mM]?[mM]?[aA]?[nN]?[dD]? (?<base64>[A-Za-z0-9+/=]+))"
| eval decoded=if(isnotnull(base64), base64decode(base64), null())
| table _time, host, user, parent_process_name, command_line, decoded</code></pre>
            </div>

            <h3>Timeline Analysis</h3>
            <div class="code-block">
                <pre><code><!-- Multi-source timeline for entity -->
index=* (src="$entity$" OR dest="$entity$" OR user="$entity$" OR host="$entity$")
| eval event_type=case(
    sourcetype="WinEventLog:Security", "Auth",
    sourcetype="firewall", "Network",
    sourcetype="proxy", "Web",
    sourcetype="sysmon", "Process",
    sourcetype="dns", "DNS",
    true(), "Other")
| eval summary=case(
    sourcetype="WinEventLog:Security", EventCode." - ".user,
    sourcetype="firewall", action." ".src." -> ".dest.":".dest_port,
    sourcetype="proxy", http_method." ".url,
    sourcetype="sysmon" AND EventCode=1, "Process: ".process_name,
    sourcetype="dns", query,
    true(), substr(_raw, 0, 100))
| table _time, event_type, sourcetype, summary
| sort _time</code></pre>
            </div>
        </section>

        <!-- Executive Dashboard -->
        <section class="content-section">
            <h2>Executive Dashboard</h2>
            <p>High-level metrics for security leadership and stakeholders.</p>

            <h3>Key Performance Indicators</h3>
            <div class="code-block">
                <pre><code><!-- Mean Time to Detect (MTTD) -->
| `notable`
| where isnotnull(first_time) AND isnotnull(create_time)
| eval mttd = create_time - first_time
| stats avg(mttd) as avg_mttd, 
        median(mttd) as median_mttd,
        perc90(mttd) as p90_mttd
| eval avg_mttd_hours = round(avg_mttd/3600, 2)
| eval median_mttd_hours = round(median_mttd/3600, 2)
| eval p90_mttd_hours = round(p90_mttd/3600, 2)

<!-- Mean Time to Respond (MTTR) -->
| `notable`
| where status="5"  <!-- Closed -->
| eval mttr = status_end_time - create_time
| stats avg(mttr) as avg_mttr, 
        median(mttr) as median_mttr
| eval avg_mttr_hours = round(avg_mttr/3600, 2)

<!-- Alert Closure Rate -->
| `notable`
| stats count as total,
        count(eval(status="5")) as closed,
        count(eval(status="4")) as resolved
| eval closure_rate = round((closed + resolved) / total * 100, 1)."%"

<!-- False Positive Rate -->
| `notable` 
| where status="5"
| stats count as total,
        count(eval(disposition="False Positive" OR disposition="Benign")) as false_positives
| eval fp_rate = round(false_positives / total * 100, 1)."%"</code></pre>
            </div>

            <h3>Security Posture Trends</h3>
            <div class="code-block">
                <pre><code><!-- Weekly Alert Trend -->
| `notable`
| bucket _time span=1w
| stats count by _time, urgency
| xyseries _time urgency count
| fillnull value=0

<!-- Risk Score Trend by Category -->
| `risk_index`
| bucket _time span=1d
| stats sum(risk_score) as total_risk by _time, risk_object_type
| xyseries _time risk_object_type total_risk

<!-- Top Threat Categories -->
| `notable`
| stats count by security_domain
| sort -count
| head 10

<!-- Detection Coverage -->
| inputlookup mitre_attack_lookup
| join type=left technique_id [
    | `notable`
    | stats count by annotations.mitre_attack.mitre_technique_id
    | rename annotations.mitre_attack.mitre_technique_id as technique_id
]
| eval coverage=if(isnotnull(count), "Covered", "Gap")
| stats count by tactic_name, coverage
| xyseries tactic_name coverage count</code></pre>
            </div>

            <h3>Single Value Visualizations</h3>
            <div class="code-block">
                <pre><code><!-- Critical Alerts Open (with trend) -->
| `notable`
| where urgency="critical" AND status!="5"
| stats count as critical_open
| appendcols [
    | `notable`
    | where urgency="critical" AND status!="5"
    | where _time > relative_time(now(), "-1d@d")
    | stats count as yesterday
]
| eval trend=critical_open - yesterday
| eval trend_indicator=if(trend > 0, "‚ñ≤ +".trend, if(trend < 0, "‚ñº ".trend, "‚Üí 0"))

<!-- Total Events Processed (last 24h) -->
| tstats count WHERE index=* BY index
| stats sum(count) as total_events
| eval display=tostring(total_events, "commas")

<!-- Active Incidents -->
| `notable`
| where status IN ("1", "2", "3")  <!-- New, In Progress, Pending -->
| stats count as active_incidents</code></pre>
            </div>
        </section>

        <!-- Dashboard Development -->
        <section class="content-section">
            <h2>Dashboard Development</h2>
            <p>Best practices for building performant and maintainable dashboards.</p>

            <h3>SimpleXML Structure</h3>
            <div class="code-block">
                <pre><code>&lt;dashboard version="1.1" theme="dark"&gt;
  &lt;label&gt;SOC Operations Dashboard&lt;/label&gt;
  &lt;description&gt;Real-time security operations monitoring&lt;/description&gt;
  
  &lt;!-- Global time picker --&gt;
  &lt;fieldset submitButton="false" autoRun="true"&gt;
    &lt;input type="time" token="time_range" searchWhenChanged="true"&gt;
      &lt;label&gt;Time Range&lt;/label&gt;
      &lt;default&gt;
        &lt;earliest&gt;-24h@h&lt;/earliest&gt;
        &lt;latest&gt;now&lt;/latest&gt;
      &lt;/default&gt;
    &lt;/input&gt;
  &lt;/fieldset&gt;

  &lt;!-- Row 1: KPI Single Values --&gt;
  &lt;row&gt;
    &lt;panel&gt;
      &lt;title&gt;Critical Alerts&lt;/title&gt;
      &lt;single&gt;
        &lt;search&gt;
          &lt;query&gt;| `notable` | where urgency="critical" | stats count&lt;/query&gt;
          &lt;earliest&gt;$time_range.earliest$&lt;/earliest&gt;
          &lt;latest&gt;$time_range.latest$&lt;/latest&gt;
          &lt;refresh&gt;60s&lt;/refresh&gt;
        &lt;/search&gt;
        &lt;option name="colorBy"&gt;value&lt;/option&gt;
        &lt;option name="rangeColors"&gt;["0x53a051","0xf8be34","0xdc4e41"]&lt;/option&gt;
        &lt;option name="rangeValues"&gt;[0,5]&lt;/option&gt;
        &lt;option name="useColors"&gt;1&lt;/option&gt;
        &lt;drilldown&gt;
          &lt;link target="_blank"&gt;/app/SplunkEnterpriseSecuritySuite/incident_review?urgency=critical&lt;/link&gt;
        &lt;/drilldown&gt;
      &lt;/single&gt;
    &lt;/panel&gt;
  &lt;/row&gt;

  &lt;!-- Row 2: Charts --&gt;
  &lt;row&gt;
    &lt;panel&gt;
      &lt;title&gt;Alert Trend&lt;/title&gt;
      &lt;chart&gt;
        &lt;search&gt;
          &lt;query&gt;| `notable` | timechart span=1h count by urgency&lt;/query&gt;
          &lt;earliest&gt;$time_range.earliest$&lt;/earliest&gt;
          &lt;latest&gt;$time_range.latest$&lt;/latest&gt;
        &lt;/search&gt;
        &lt;option name="charting.chart"&gt;area&lt;/option&gt;
        &lt;option name="charting.chart.stackMode"&gt;stacked&lt;/option&gt;
        &lt;option name="charting.legend.placement"&gt;bottom&lt;/option&gt;
      &lt;/chart&gt;
    &lt;/panel&gt;
  &lt;/row&gt;
&lt;/dashboard&gt;</code></pre>
            </div>

            <h3>Performance Optimization</h3>
            <div class="grid-container">
                <div class="grid-item highlight-card">
                    <h3>‚úÖ Do</h3>
                    <ul>
                        <li>Use <code>tstats</code> with accelerated data models</li>
                        <li>Set appropriate refresh intervals</li>
                        <li>Use <code>earliest</code> and <code>latest</code> time bounds</li>
                        <li>Limit results with <code>head</code> or <code>limit</code></li>
                        <li>Use summary indexes for historical data</li>
                        <li>Pre-calculate metrics with scheduled searches</li>
                    </ul>
                </div>
                <div class="grid-item highlight-card">
                    <h3>‚ùå Don't</h3>
                    <ul>
                        <li>Use <code>search *</code> without time bounds</li>
                        <li>Set refresh < 60s for complex searches</li>
                        <li>Use transforming commands before filtering</li>
                        <li>Load unnecessary fields</li>
                        <li>Run expensive searches on every page load</li>
                        <li>Use real-time searches without necessity</li>
                    </ul>
                </div>
            </div>

            <h3>Using Accelerated Data Models</h3>
            <div class="code-block">
                <pre><code><!-- SLOW: Raw search -->
index=firewall action=blocked
| stats count by src_ip, dest_ip

<!-- FAST: tstats with data model -->
| tstats count FROM datamodel=Network_Traffic 
    WHERE nodename=All_Traffic.Traffic_By_Action.Blocked_Traffic 
    BY All_Traffic.src, All_Traffic.dest

<!-- Check data model acceleration status -->
| rest /services/admin/summarization by_tstats=t 
| search datamodel_acceleration.datamodel=* 
| table title, eai:acl.app, datamodel_acceleration.complete_status

<!-- Pre-populating dashboards with saved searches -->
| savedsearch "Alert_Volume_Daily"
<!-- Runs pre-calculated results instead of raw search --></code></pre>
            </div>
        </section>

        <!-- Drilldown Configuration -->
        <section class="content-section">
            <h2>Drilldown & Interactivity</h2>
            <p>Make dashboards actionable with drilldown capabilities.</p>

            <h3>Drilldown Types</h3>
            <div class="code-block">
                <pre><code><!-- Link to another dashboard with tokens -->
&lt;drilldown&gt;
  &lt;link target="_blank"&gt;
    /app/SplunkEnterpriseSecuritySuite/entity_investigation?entity=$row.src_ip$
  &lt;/link&gt;
&lt;/drilldown&gt;

<!-- Set token for in-dashboard filtering -->
&lt;drilldown&gt;
  &lt;set token="selected_host"&gt;$click.value$&lt;/set&gt;
  &lt;set token="selected_time"&gt;$click.value2$&lt;/set&gt;
&lt;/drilldown&gt;

<!-- Open search in new window -->
&lt;drilldown&gt;
  &lt;link target="_blank"&gt;
    search?q=index=firewall src=$row.src_ip$ dest=$row.dest_ip$&amp;earliest=-24h&amp;latest=now
  &lt;/link&gt;
&lt;/drilldown&gt;

<!-- Conditional drilldown -->
&lt;drilldown&gt;
  &lt;condition field="severity"&gt;
    &lt;link&gt;/app/search/entity_investigation?severity=$click.value$&lt;/link&gt;
  &lt;/condition&gt;
  &lt;condition field="*"&gt;
    &lt;set token="filter"&gt;$click.value$&lt;/set&gt;
  &lt;/condition&gt;
&lt;/drilldown&gt;</code></pre>
            </div>

            <h3>Dynamic Form Inputs</h3>
            <div class="code-block">
                <pre><code><!-- Dropdown populated from search -->
&lt;input type="dropdown" token="sourcetype_filter"&gt;
  &lt;label&gt;Source Type&lt;/label&gt;
  &lt;choice value="*"&gt;All&lt;/choice&gt;
  &lt;search&gt;
    &lt;query&gt;| metadata type=sourcetypes index=main | table sourcetype&lt;/query&gt;
  &lt;/search&gt;
  &lt;fieldForLabel&gt;sourcetype&lt;/fieldForLabel&gt;
  &lt;fieldForValue&gt;sourcetype&lt;/fieldForValue&gt;
  &lt;default&gt;*&lt;/default&gt;
&lt;/input&gt;

<!-- Multiselect with token formatting -->
&lt;input type="multiselect" token="severity_filter"&gt;
  &lt;label&gt;Severity&lt;/label&gt;
  &lt;choice value="critical"&gt;Critical&lt;/choice&gt;
  &lt;choice value="high"&gt;High&lt;/choice&gt;
  &lt;choice value="medium"&gt;Medium&lt;/choice&gt;
  &lt;choice value="low"&gt;Low&lt;/choice&gt;
  &lt;default&gt;critical,high&lt;/default&gt;
  &lt;prefix&gt;(&lt;/prefix&gt;
  &lt;suffix&gt;)&lt;/suffix&gt;
  &lt;valuePrefix&gt;urgency="&lt;/valuePrefix&gt;
  &lt;valueSuffix&gt;"&lt;/valueSuffix&gt;
  &lt;delimiter&gt; OR &lt;/delimiter&gt;
&lt;/input&gt;
<!-- Result: (urgency="critical" OR urgency="high") -->

<!-- Cascading inputs (dependent dropdowns) -->
&lt;input type="dropdown" token="category" searchWhenChanged="true"&gt;
  &lt;label&gt;Category&lt;/label&gt;
  &lt;search&gt;&lt;query&gt;| inputlookup categories.csv | dedup category&lt;/query&gt;&lt;/search&gt;
  &lt;fieldForLabel&gt;category&lt;/fieldForLabel&gt;
  &lt;fieldForValue&gt;category&lt;/fieldForValue&gt;
&lt;/input&gt;

&lt;input type="dropdown" token="subcategory"&gt;
  &lt;label&gt;Subcategory&lt;/label&gt;
  &lt;search&gt;
    &lt;query&gt;| inputlookup categories.csv | where category="$category$"&lt;/query&gt;
  &lt;/search&gt;
  &lt;fieldForLabel&gt;subcategory&lt;/fieldForLabel&gt;
  &lt;fieldForValue&gt;subcategory&lt;/fieldForValue&gt;
&lt;/input&gt;</code></pre>
            </div>
        </section>

        <!-- Dashboard Examples -->
        <section class="content-section">
            <h2>Complete Dashboard Examples</h2>

            <h3>Threat Detection Dashboard</h3>
            <div class="code-block">
                <pre><code>&lt;dashboard version="1.1"&gt;
  &lt;label&gt;Threat Detection Overview&lt;/label&gt;
  
  &lt;row&gt;
    &lt;panel&gt;
      &lt;title&gt;Detection by MITRE Tactic&lt;/title&gt;
      &lt;chart&gt;
        &lt;search&gt;
          &lt;query&gt;
| `notable`
| spath output=tactic path="annotations.mitre_attack{}.mitre_tactic"
| mvexpand tactic
| stats count by tactic
| sort -count
          &lt;/query&gt;
          &lt;earliest&gt;-7d@d&lt;/earliest&gt;
          &lt;latest&gt;now&lt;/latest&gt;
        &lt;/search&gt;
        &lt;option name="charting.chart"&gt;bar&lt;/option&gt;
        &lt;option name="charting.chart.showDataLabels"&gt;all&lt;/option&gt;
      &lt;/chart&gt;
    &lt;/panel&gt;
    
    &lt;panel&gt;
      &lt;title&gt;Top Detection Rules&lt;/title&gt;
      &lt;table&gt;
        &lt;search&gt;
          &lt;query&gt;
| `notable`
| stats count, dc(src) as "Unique Sources", 
        dc(dest) as "Unique Targets" by rule_name
| sort -count
| head 10
| rename rule_name as "Detection Rule", count as "Alerts"
          &lt;/query&gt;
          &lt;earliest&gt;-7d@d&lt;/earliest&gt;
          &lt;latest&gt;now&lt;/latest&gt;
        &lt;/search&gt;
        &lt;drilldown&gt;
          &lt;link target="_blank"&gt;
            /app/SplunkEnterpriseSecuritySuite/incident_review?rule_name=$row.Detection Rule$
          &lt;/link&gt;
        &lt;/drilldown&gt;
      &lt;/table&gt;
    &lt;/panel&gt;
  &lt;/row&gt;
  
  &lt;row&gt;
    &lt;panel&gt;
      &lt;title&gt;Threat Activity Heatmap&lt;/title&gt;
      &lt;chart&gt;
        &lt;search&gt;
          &lt;query&gt;
| `notable`
| eval hour=strftime(_time, "%H")
| eval day=strftime(_time, "%A")
| stats count by day, hour
| xyseries day hour count
          &lt;/query&gt;
          &lt;earliest&gt;-7d@d&lt;/earliest&gt;
          &lt;latest&gt;now&lt;/latest&gt;
        &lt;/search&gt;
        &lt;option name="charting.chart"&gt;markerGauge&lt;/option&gt;
      &lt;/chart&gt;
    &lt;/panel&gt;
  &lt;/row&gt;
&lt;/dashboard&gt;</code></pre>
            </div>

            <h3>Network Security Dashboard</h3>
            <div class="code-block">
                <pre><code><!-- Network traffic analysis panels -->

<!-- Top Talkers -->
| tstats sum(All_Traffic.bytes) as bytes 
    FROM datamodel=Network_Traffic BY All_Traffic.src
| sort -bytes
| head 10
| eval bytes_mb=round(bytes/1024/1024, 2)
| rename All_Traffic.src as "Source", bytes_mb as "MB Transferred"

<!-- Denied Connections by Destination Port -->
| tstats count FROM datamodel=Network_Traffic 
    WHERE nodename=All_Traffic.Traffic_By_Action.Blocked_Traffic 
    BY All_Traffic.dest_port
| sort -count
| head 20
| rename All_Traffic.dest_port as "Port", count as "Blocked Attempts"

<!-- Geographic Traffic Distribution -->
| tstats count FROM datamodel=Network_Traffic BY All_Traffic.dest_ip
| iplocation All_Traffic.dest_ip
| stats sum(count) as connections by Country
| geom geo_countries featureIdField=Country

<!-- Suspicious Port Activity -->
| tstats count FROM datamodel=Network_Traffic 
    WHERE All_Traffic.dest_port IN (4444, 5555, 6666, 31337, 12345) 
    BY All_Traffic.src, All_Traffic.dest, All_Traffic.dest_port
| table All_Traffic.src, All_Traffic.dest, All_Traffic.dest_port, count
| sort -count</code></pre>
            </div>
        </section>

        <!-- Interview Questions -->
        <section class="interview-section">
            <h2>üíº Interview Questions</h2>
            
            <div class="interview-qa">
                <h4>Q: How do you design an effective SOC operations dashboard?</h4>
                <p><strong>A:</strong> I follow several principles. First, identify the key questions analysts need answered - what's the current alert queue, what's trending, what needs immediate attention. Design around workflows, not just data. Place critical information above the fold - high-severity alerts, key metrics. Use appropriate visualizations - single values for KPIs, timecharts for trends, tables for details. Enable drilldown so analysts can investigate directly from the dashboard. Optimize for performance with accelerated data models and appropriate refresh intervals. Include data source health monitoring so analysts trust what they see. Test with actual analysts and iterate based on feedback.</p>
            </div>

            <div class="interview-qa">
                <h4>Q: How do you optimize dashboard performance in Splunk?</h4>
                <p><strong>A:</strong> Performance optimization starts with search efficiency. Use tstats with accelerated data models instead of raw searches - they're orders of magnitude faster. Apply time bounds early and filter before transforming. For historical trends, use summary indexes or scheduled searches that pre-calculate metrics. Set appropriate refresh intervals - not everything needs real-time updates. Use base searches with post-process to share a single search across multiple panels. Limit result sets with head or limit commands. Monitor search performance using the Job Inspector and search.log. For frequently accessed dashboards serving many users, consider scheduled PDF delivery instead of live dashboards.</p>
            </div>

            <div class="interview-qa">
                <h4>Q: What metrics would you include on an executive security dashboard?</h4>
                <p><strong>A:</strong> Executive dashboards should focus on outcomes and trends, not operational details. Key metrics include: Mean Time to Detect (MTTD) and Mean Time to Respond (MTTR) with trends. Alert closure rate and false positive rate to show SOC efficiency. Risk posture trends - overall risk score over time, high-risk entities. Detection coverage mapped to MITRE ATT&CK showing gaps and improvements. Incident metrics - count by severity, SLA compliance. Compliance status for relevant frameworks. I'd use single-value visualizations with trend indicators, weekly/monthly comparisons, and avoid technical jargon. Include context - are metrics improving or declining, and what's driving the change.</p>
            </div>

            <div class="interview-qa">
                <h4>Q: How do you implement drilldown capabilities effectively?</h4>
                <p><strong>A:</strong> Effective drilldown follows the analyst workflow. From high-level views, enable drilldown to increasingly detailed data. For example, clicking an alert count opens the filtered incident review queue. Clicking a source IP opens an entity investigation dashboard pre-populated with that IP. Use tokens to pass context between dashboards - time range, entity values, filter criteria. Implement conditional drilldown so different fields link to appropriate destinations. Open detailed views in new tabs to preserve the analyst's place in the dashboard. Pre-build investigation dashboards that accept tokens as inputs. The goal is reducing clicks between identifying an issue and investigating it.</p>
            </div>

            <div class="interview-qa">
                <h4>Q: How do you handle dashboards for multiple audiences?</h4>
                <p><strong>A:</strong> Different audiences need different views. SOC analysts need operational detail - individual alerts, entity investigation, real-time data. Security managers need team metrics - workload distribution, SLA compliance, detection effectiveness. Executives need strategic view - risk posture, trend comparisons, ROI metrics. I create separate dashboards for each audience rather than trying to serve everyone with one. Use role-based access to control who sees what. For shared dashboards, use form inputs to let users adjust detail level. Executive dashboards should have clean design, minimal interactivity, and focus on "so what" insights. Consider scheduled PDF delivery for executives who won't log into Splunk.</p>
            </div>
        </section>

        <div class="navigation-links">
            <a href="data-models.html">‚Üê Data Models</a>
            <a href="notable-events.html">Notable Events ‚Üí</a>
        </div>
    </main>
    <script src="../assets/js/main.js"></script>
</body>
</html>
