<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPL Query Library | Splunk</title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-logo">
                    <i class="fas fa-shield-alt"></i>
                    <span>SOC Compendium</span>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Platforms</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item">
                            <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                                <span class="platform-dot"></span>
                                <span>XSIAM</span>
                            </a>
                        </li>
                        <li class="sidebar-nav-item">
                            <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                                <span class="platform-dot"></span>
                                <span>Splunk</span>
                            </a>
                        </li>
                        <li class="sidebar-nav-item">
                            <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                                <span class="platform-dot"></span>
                                <span>Sentinel</span>
                            </a>
                        </li>
                        <li class="sidebar-nav-item">
                            <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                                <span class="platform-dot"></span>
                                <span>CrowdStrike</span>
                            </a>
                        </li>
                        <li class="sidebar-nav-item">
                            <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                                <span class="platform-dot"></span>
                                <span>Cortex XDR</span>
                            </a>
                        </li>
                        <li class="sidebar-nav-item">
                            <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                                <span class="platform-dot"></span>
                                <span>Defender for Endpoint</span>
                            </a>
                        </li>
                        <li class="sidebar-nav-item">
                            <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                                <span class="platform-dot"></span>
                                <span>SOC Operations</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>
        
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">SPL Query Library</span>
                </div>

                <h1><i class="fas fa-file-alt"></i> SPL Query Library</h1>
                <p class="lead">Ready-to-use SPL queries for common security use cases.</p>
                
            <h2><i class="fas fa-key"></i> Authentication Queries</h2>
            <div class="config-section">
                
            <div class="code-block">
                <div class="code-header"><span class="code-lang">SPL</span></div>
                <pre><code>| Failed logins by user
index=windows sourcetype=WinEventLog:Security EventCode=4625
| stats count by user, src_ip
| sort -count

| Successful logins after failures
index=windows sourcetype=WinEventLog:Security EventCode IN (4625, 4624)
| transaction user maxspan=5m
| where eventcount>1 AND match(EventCode, "4624")
| table _time user src_ip</code></pre>
            </div>
        
            </div>

            <h2><i class="fas fa-network-wired"></i> Network Queries</h2>
            <div class="config-section">
                
            <div class="code-block">
                <div class="code-header"><span class="code-lang">SPL</span></div>
                <pre><code>| Top talkers by bytes
index=network
| stats sum(bytes) as total_bytes by src_ip
| sort -total_bytes
| head 20

| Connections to rare destinations
index=network
| rare dest_ip
| where count<5</code></pre>
            </div>
        
            </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
    </script>
</body>
</html>