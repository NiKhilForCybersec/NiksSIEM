<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forwarders | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="shared-styles.css">
    <link rel="stylesheet" href="../assets/css/main.css">


</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
        <!-- Sidebar -->
        <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo"><i class="fas fa-terminal"></i><span>Splunk Reference</span></a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Certifications</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="power-user-certification.html" class="sidebar-nav-link"><i class="fas fa-user-graduate" style="color:#7ce38b"></i>Power User</a></li>
                        <li class="sidebar-nav-item"><a href="admin-certification.html" class="sidebar-nav-link"><i class="fas fa-user-cog" style="color:#f0883e"></i>Admin</a></li>
                        <li class="sidebar-nav-item"><a href="es-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-shield-alt" style="color:#8957e5"></i>ES Admin</a></li>
                        <li class="sidebar-nav-item"><a href="cloud-admin-certification.html" class="sidebar-nav-link"><i class="fas fa-cloud" style="color:#39c5cf"></i>Cloud Admin</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Learning</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="when-to-use-what.html" class="sidebar-nav-link"><i class="fas fa-map-signs" style="color:#f0883e"></i>When to Use What</a></li>
                        <li class="sidebar-nav-item"><a href="spl-practice-questions.html" class="sidebar-nav-link"><i class="fas fa-tasks" style="color:#58a6ff"></i>Practice MCQs</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced-mcqs.html" class="sidebar-nav-link"><i class="fas fa-brain" style="color:#a371f7"></i>Advanced MCQs</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">SPL Reference</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="spl-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-code"></i>SPL Fundamentals</a></li>
                        <li class="sidebar-nav-item"><a href="spl-intermediate.html" class="sidebar-nav-link"><i class="fas fa-layer-group"></i>SPL Intermediate</a></li>
                        <li class="sidebar-nav-item"><a href="spl-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i>SPL Advanced</a></li>
                        <li class="sidebar-nav-item"><a href="knowledge-objects.html" class="sidebar-nav-link"><i class="fas fa-lightbulb"></i>Knowledge Objects</a></li>
                        <li class="sidebar-nav-item"><a href="data-models.html" class="sidebar-nav-link"><i class="fas fa-cubes"></i>Data Models</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Administration</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i>Architecture</a></li>
                        <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i>Data Ingestion</a></li>
                        <li class="sidebar-nav-item"><a href="forwarders.html" class="sidebar-nav-link"><i class="fas fa-share-alt"></i>Forwarders</a></li>
                        <li class="sidebar-nav-item"><a href="clustering-ha.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i>Clustering & HA</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Enterprise Security</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="es-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-alt"></i>ES Overview</a></li>
                        <li class="sidebar-nav-item"><a href="correlation-searches.html" class="sidebar-nav-link"><i class="fas fa-search-plus"></i>Correlation Searches</a></li>
                        <li class="sidebar-nav-item"><a href="risk-based-alerting.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i>Risk-Based Alerting</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Resources</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="lab-exercises.html" class="sidebar-nav-link"><i class="fas fa-flask"></i>Lab Exercises</a></li>
                        <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i>Troubleshooting</a></li>
                    </ul>
                </div>
            </div>
        </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Forwarders</span>
                </div>

                <h1><i class="fas fa-share"></i> Splunk Forwarders</h1>
                <p class="lead">Complete guide to Splunk forwarders. Learn Universal Forwarder vs Heavy Forwarder, deployment strategies, configuration management, and troubleshooting for enterprise data collection.</p>

                <!-- Forwarder Overview -->
                <h2><i class="fas fa-info-circle"></i> Forwarder Overview</h2>
                <div class="config-section">
                    <h4>Forwarder Types Comparison</h4>
                    <div class="arch-diagram">Splunk Forwarder Types:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FORWARDER COMPARISON                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚ Universal Forwarder â”‚ Heavy Forwarder                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Resource Usage      â”‚ Minimal (~40MB RAM) â”‚ Higher (~1GB+ RAM)              â”‚
â”‚ Parsing             â”‚ No (raw forwarding) â”‚ Yes (full parsing)              â”‚
â”‚ Indexing            â”‚ No                  â”‚ Optional (interim indexing)     â”‚
â”‚ Search              â”‚ No                  â”‚ Yes (local search capability)   â”‚
â”‚ Data Routing        â”‚ Basic               â”‚ Advanced (conditional routing)  â”‚
â”‚ Field Extraction    â”‚ No                  â”‚ Yes (at ingest time)            â”‚
â”‚ Data Filtering      â”‚ Limited             â”‚ Full (drop, filter, modify)     â”‚
â”‚ Scripted Inputs     â”‚ Yes                 â”‚ Yes                             â”‚
â”‚ Deployment          â”‚ Mass deployment     â”‚ Strategic placement             â”‚
â”‚ License             â”‚ Free                â”‚ Consumes license                â”‚
â”‚ Best For            â”‚ Endpoints, servers  â”‚ Aggregation, parsing, filtering â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

                    <h4>Forwarder Decision Tree</h4>
                    <div class="arch-diagram">FORWARDER SELECTION DECISION TREE:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DO YOU NEED DATA COLLECTION?                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ YES
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         DO YOU NEED PARSING/FILTERING AT SOURCE?            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          NO            â”‚              YES                   â”‚
â”‚           â”‚            â”‚               â”‚                    â”‚
â”‚           â–¼            â”‚               â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   UNIVERSAL    â”‚    â”‚    â”‚ Is it aggregating from     â”‚ â”‚
â”‚  â”‚   FORWARDER    â”‚    â”‚    â”‚ multiple sources?          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚                        â”‚    â”‚    YES    â”‚      NO        â”‚ â”‚
â”‚                        â”‚    â”‚     â”‚     â”‚       â”‚        â”‚ â”‚
â”‚                        â”‚    â”‚     â–¼     â”‚       â–¼        â”‚ â”‚
â”‚                        â”‚    â”‚  HEAVY    â”‚   HEAVY        â”‚ â”‚
â”‚                        â”‚    â”‚  FORWARDERâ”‚   FORWARDER    â”‚ â”‚
â”‚                        â”‚    â”‚  (Central)â”‚   (Local)      â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”˜

USE CASE MAPPING:
â”œâ”€â”€ Endpoints (workstations): Universal Forwarder
â”œâ”€â”€ Servers (Windows/Linux): Universal Forwarder
â”œâ”€â”€ Syslog aggregation: Heavy Forwarder
â”œâ”€â”€ Network devices: Heavy Forwarder (syslog receiver)
â”œâ”€â”€ Database logs: Universal Forwarder with DB Connect
â”œâ”€â”€ Cloud sources: Universal Forwarder or HTTP Event Collector
â””â”€â”€ Data transformation: Heavy Forwarder</div>
                </div>

                <!-- Universal Forwarder Deployment -->
                <h2><i class="fas fa-download"></i> Universal Forwarder Deployment</h2>
                <div class="config-section">
                    <h4>End-to-End Deployment Workflow</h4>
                    <div class="arch-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               UNIVERSAL FORWARDER DEPLOYMENT WORKFLOW                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  PHASE 1           PHASE 2           PHASE 3           PHASE 4             â”‚
â”‚  PREPARATION       INSTALLATION      CONFIGURATION     VALIDATION          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Download â”‚     â”‚ Deploy   â”‚     â”‚ Configureâ”‚     â”‚ Verify   â”‚          â”‚
â”‚  â”‚ Package  â”‚â”€â”€â”€â”€â–¶â”‚ to Host  â”‚â”€â”€â”€â”€â–¶â”‚ Inputs   â”‚â”€â”€â”€â”€â–¶â”‚ Data     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ Flow     â”‚          â”‚
â”‚       â”‚                â”‚                â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚       â–¼                â–¼                â–¼                â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â–¼                 â”‚
â”‚  â”‚ Prep     â”‚     â”‚ Configureâ”‚     â”‚ Configureâ”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Deploymentâ”‚â”€â”€â”€â”€â–¶â”‚ Output   â”‚â”€â”€â”€â”€â–¶â”‚ via      â”‚â”€â”€â”€â”€â–¶â”‚ Monitor  â”‚          â”‚
â”‚  â”‚ Server   â”‚     â”‚ (Indexer)â”‚     â”‚ DS       â”‚     â”‚ Health   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

                    <h4>Step 1: Download and Prepare</h4>
                    <div class="arch-diagram">PREPARATION STEPS:

DOWNLOAD FORWARDER:
â”œâ”€â”€ URL: https://www.splunk.com/en_us/download/universal-forwarder.html
â”œâ”€â”€ Version: Match your Splunk Enterprise version
â”œâ”€â”€ Packages available:
â”‚   â”œâ”€â”€ Windows: .msi installer
â”‚   â”œâ”€â”€ Linux: .rpm, .deb, .tgz
â”‚   â”œâ”€â”€ macOS: .dmg, .tgz
â”‚   â””â”€â”€ Solaris/AIX: .pkg

PREPARE DEPLOYMENT SERVER (Recommended):
# Create deployment server apps structure
$SPLUNK_HOME/etc/deployment-apps/
â”œâ”€â”€ Org_all_forwarder_outputs/
â”‚   â””â”€â”€ local/
â”‚       â””â”€â”€ outputs.conf
â”œâ”€â”€ Org_all_forwarder_base/
â”‚   â””â”€â”€ local/
â”‚       â””â”€â”€ deploymentclient.conf
â””â”€â”€ Org_Windows_inputs/
    â””â”€â”€ local/
        â””â”€â”€ inputs.conf

# Basic outputs.conf for all forwarders
[tcpout]
defaultGroup = primary_indexers

[tcpout:primary_indexers]
server = idx1.company.com:9997, idx2.company.com:9997
useACK = true
autoLBFrequency = 30</div>

                    <h4>Step 2: Installation Methods</h4>
                    <div class="arch-diagram">WINDOWS INSTALLATION:

# Silent MSI install with configuration
msiexec.exe /i splunkforwarder-9.1.0-x64.msi ^
  AGREETOLICENSE=Yes ^
  RECEIVING_INDEXER="idx1.company.com:9997" ^
  DEPLOYMENT_SERVER="ds.company.com:8089" ^
  LAUNCHSPLUNK=1 ^
  SERVICESTARTTYPE=auto ^
  /quiet

# Alternative: GPO deployment
# Create MSI transform with pre-configured settings
# Deploy via Software Installation policy

# PowerShell remote installation
$servers = Get-Content C:\servers.txt
foreach ($server in $servers) {
    Invoke-Command -ComputerName $server -ScriptBlock {
        Start-Process msiexec.exe -ArgumentList '/i \\share\splunk\splunkforwarder.msi AGREETOLICENSE=Yes /quiet' -Wait
    }
}

LINUX INSTALLATION:

# RPM-based (RHEL/CentOS)
rpm -i splunkforwarder-9.1.0-linux-x86_64.rpm
/opt/splunkforwarder/bin/splunk start --accept-license
/opt/splunkforwarder/bin/splunk enable boot-start

# Debian-based (Ubuntu)
dpkg -i splunkforwarder-9.1.0-linux-amd64.deb
/opt/splunkforwarder/bin/splunk start --accept-license
/opt/splunkforwarder/bin/splunk enable boot-start

# Configure outputs
cat > /opt/splunkforwarder/etc/system/local/outputs.conf << 'EOF'
[tcpout]
defaultGroup = primary_indexers

[tcpout:primary_indexers]
server = idx1.company.com:9997,idx2.company.com:9997
EOF

# Configure deployment client
cat > /opt/splunkforwarder/etc/system/local/deploymentclient.conf << 'EOF'
[deployment-client]

[target-broker:deploymentServer]
targetUri = ds.company.com:8089
EOF

# Restart to apply
/opt/splunkforwarder/bin/splunk restart</div>

                    <h4>Step 3: Configure Inputs</h4>
                    <div class="arch-diagram">COMMON INPUT CONFIGURATIONS:

# Windows Security Events
# inputs.conf
[WinEventLog://Security]
disabled = 0
index = wineventlog
sourcetype = WinEventLog:Security
evt_resolve_ad_obj = 1
checkpointInterval = 5

[WinEventLog://System]
disabled = 0
index = wineventlog
sourcetype = WinEventLog:System

[WinEventLog://Application]
disabled = 0
index = wineventlog
sourcetype = WinEventLog:Application

# Sysmon logs
[WinEventLog://Microsoft-Windows-Sysmon/Operational]
disabled = 0
index = wineventlog
sourcetype = XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
renderXml = true

# Linux auth logs
[monitor:///var/log/auth.log]
disabled = 0
index = linux
sourcetype = linux_secure

[monitor:///var/log/secure]
disabled = 0
index = linux
sourcetype = linux_secure

# Custom application logs
[monitor:///var/log/myapp/*.log]
disabled = 0
index = application
sourcetype = myapp:log
crcSalt = <SOURCE></div>
                </div>

                <!-- Heavy Forwarder Deployment -->
                <h2><i class="fas fa-server"></i> Heavy Forwarder Deployment</h2>
                <div class="config-section">
                    <h4>Heavy Forwarder Use Cases</h4>
                    <div class="arch-diagram">HEAVY FORWARDER SCENARIOS:

1. SYSLOG AGGREGATION POINT
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                         â”‚
   â”‚  Firewalls â”€â”€â”                                         â”‚
   â”‚  Routers â”€â”€â”€â”€â”¼â”€â”€â–¶ Heavy Forwarder â”€â”€â–¶ Indexers        â”‚
   â”‚  Switches â”€â”€â”€â”˜    (Syslog receiver)                    â”‚
   â”‚                   (Parse & route)                      â”‚
   â”‚                                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. DATA FILTERING/TRANSFORMATION
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                         â”‚
   â”‚  High Volume â”€â”€â–¶ Heavy Forwarder â”€â”€â–¶ Indexers          â”‚
   â”‚  Source          (Filter 90%)        (10% valuable)    â”‚
   â”‚                                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. INTERMEDIATE FORWARDER (DMZ)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                         â”‚
   â”‚  DMZ â”€â”€â–¶ Heavy Forwarder â”€â”€â–¶ Firewall â”€â”€â–¶ Indexers    â”‚
   â”‚  Hosts   (Single egress)     (Port 9997)               â”‚
   â”‚                                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. DATA ENRICHMENT
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                         â”‚
   â”‚  Raw Data â”€â”€â–¶ Heavy Forwarder â”€â”€â–¶ Indexers             â”‚
   â”‚               (Add GeoIP, DNS)   (Enriched data)       â”‚
   â”‚               (Lookup tables)                          â”‚
   â”‚                                                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

                    <h4>Heavy Forwarder Configuration</h4>
                    <div class="arch-diagram"># Heavy Forwarder as Syslog Receiver
# inputs.conf
[udp://514]
connection_host = dns
sourcetype = syslog
index = network

[tcp://514]
connection_host = dns
sourcetype = syslog
index = network

# Syslog-ng/rsyslog forwarding to HF
# On syslog server: forward to HF on 514

# outputs.conf - forward to indexers
[tcpout]
defaultGroup = primary_indexers

[tcpout:primary_indexers]
server = idx1.company.com:9997,idx2.company.com:9997
useACK = true

# props.conf - parse syslog
[syslog]
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 32
SHOULD_LINEMERGE = false
TRANSFORMS-routing = route_by_sourcetype

# transforms.conf - routing rules
[route_by_sourcetype]
REGEX = ^(?<host>\S+)\s+(?<sourcetype>\w+)
DEST_KEY = _MetaData:Index
FORMAT = $1</div>
                </div>

                <!-- Deployment Server Management -->
                <h2><i class="fas fa-cogs"></i> Deployment Server Management</h2>
                <div class="config-section">
                    <h4>Deployment Server Architecture</h4>
                    <div class="arch-diagram">DEPLOYMENT SERVER WORKFLOW:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DEPLOYMENT SERVER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  $SPLUNK_HOME/etc/deployment-apps/                             â”‚
â”‚  â”œâ”€â”€ Org_all_outputs/          (All forwarders)                â”‚
â”‚  â”œâ”€â”€ Org_all_base/             (Base config)                   â”‚
â”‚  â”œâ”€â”€ Org_Windows_WinEventLog/  (Windows servers)               â”‚
â”‚  â”œâ”€â”€ Org_Linux_auth/           (Linux servers)                 â”‚
â”‚  â”œâ”€â”€ Org_DMZ_inputs/           (DMZ hosts)                     â”‚
â”‚  â””â”€â”€ TA-xxx/                   (Technology add-ons)            â”‚
â”‚                                                                 â”‚
â”‚  serverclass.conf                                               â”‚
â”‚  â”œâ”€â”€ Server classes (groups of forwarders)                     â”‚
â”‚  â”œâ”€â”€ App assignments                                           â”‚
â”‚  â””â”€â”€ Whitelist/blacklist rules                                 â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Phone home (every 30 sec default)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Forwarders receive apps based on server class membership       â”‚
â”‚  â”œâ”€â”€ Deploy apps to $SPLUNK_HOME/etc/apps/                     â”‚
â”‚  â””â”€â”€ Restart if required (restartSplunkd = true)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

                    <h4>serverclass.conf Configuration</h4>
                    <div class="arch-diagram"># $SPLUNK_HOME/etc/system/local/serverclass.conf

# Define server classes based on criteria
[serverClass:All_Forwarders]
whitelist.0 = *
# Assign base apps to all

[serverClass:All_Forwarders:app:Org_all_outputs]
restartSplunkd = true

[serverClass:All_Forwarders:app:Org_all_base]

# Windows servers
[serverClass:Windows_Servers]
whitelist.0 = *.company.com
machineTypesFilter = windows-x64

[serverClass:Windows_Servers:app:Org_Windows_WinEventLog]
restartSplunkd = true

[serverClass:Windows_Servers:app:TA-microsoft-sysmon]
restartSplunkd = true

# Linux servers
[serverClass:Linux_Servers]
whitelist.0 = *.company.com
machineTypesFilter = linux-x86_64

[serverClass:Linux_Servers:app:Org_Linux_auth]
restartSplunkd = true

# DMZ hosts (specific list)
[serverClass:DMZ_Hosts]
whitelist.0 = dmz-web01.company.com
whitelist.1 = dmz-web02.company.com
whitelist.2 = dmz-app01.company.com

[serverClass:DMZ_Hosts:app:Org_DMZ_inputs]
restartSplunkd = true

# Reload deployment server
# $SPLUNK_HOME/bin/splunk reload deploy-server</div>
                </div>

                <!-- Troubleshooting -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting Guide</h2>
                <div class="config-section">
                    <h4>Troubleshooting Decision Tree</h4>
                    <div class="arch-diagram">FORWARDER TROUBLESHOOTING DECISION TREE:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                IS DATA REACHING INDEXER?                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          YES            â”‚              NO                   â”‚
â”‚           â”‚             â”‚               â”‚                   â”‚
â”‚           â–¼             â”‚               â–¼                   â”‚
â”‚   Check sourcetype      â”‚    Is forwarder service running?  â”‚
â”‚   and index mapping     â”‚    â”œâ”€â”€ YES â†’ Check network        â”‚
â”‚                         â”‚    â””â”€â”€ NO â†’ Start service         â”‚
â”‚                         â”‚                  â”‚                â”‚
â”‚                         â”‚                  â–¼                â”‚
â”‚                         â”‚         Network connectivity?     â”‚
â”‚                         â”‚         â”œâ”€â”€ YES â†’ Check outputs   â”‚
â”‚                         â”‚         â””â”€â”€ NO â†’ Fix firewall     â”‚
â”‚                         â”‚                      â”‚            â”‚
â”‚                         â”‚                      â–¼            â”‚
â”‚                         â”‚         Outputs.conf correct?     â”‚
â”‚                         â”‚         â”œâ”€â”€ YES â†’ Check indexer   â”‚
â”‚                         â”‚         â””â”€â”€ NO â†’ Fix config       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COMMON ISSUES AND SOLUTIONS:

1. SERVICE NOT RUNNING
   # Windows
   sc query SplunkForwarder
   sc start SplunkForwarder
   
   # Linux
   /opt/splunkforwarder/bin/splunk status
   /opt/splunkforwarder/bin/splunk start

2. NETWORK CONNECTIVITY
   # Test port connectivity
   telnet idx1.company.com 9997
   nc -zv idx1.company.com 9997
   
   # Check firewall rules
   netstat -an | grep 9997

3. CONFIGURATION ERRORS
   # Validate configuration
   /opt/splunkforwarder/bin/splunk btool inputs list --debug
   /opt/splunkforwarder/bin/splunk btool outputs list --debug
   
   # Check for syntax errors
   /opt/splunkforwarder/bin/splunk cmd btprobe -d $SPLUNK_HOME/etc/apps

4. DATA NOT INDEXED
   # Check internal logs
   index=_internal host=forwarder_host source=*splunkd.log
   | search error OR warning
   
   # Check for blocked queue
   index=_internal source=*metrics.log group=queue
   | stats avg(current_size) by name</div>

                    <h4>Health Monitoring Commands</h4>
                    <div class="arch-diagram"># Forwarder health checks

# Check forwarder status
/opt/splunkforwarder/bin/splunk list forward-server

# Check connection status
/opt/splunkforwarder/bin/splunk list monitor

# Check indexer acknowledgment
index=_internal source=*metrics.log group=tcpout_connections
| stats latest(destPort) latest(status) by destHost

# Check forwarder queues
index=_internal source=*metrics.log group=queue
| where current_size > 0
| stats latest(current_size) by host name

# Deployment server client status
/opt/splunkforwarder/bin/splunk show deploy-poll

# List deployed apps
/opt/splunkforwarder/bin/splunk display deploy-poll</div>
                </div>

                <!-- Decision Trees -->
                <h2><i class="fas fa-project-diagram"></i> Forwarder Decision Trees</h2>
                <div class="config-section">
                    <h3>Decision Tree: Forwarder Type Selection</h3>
                    <div class="arch-diagram">NEED TO COLLECT DATA FROM A SOURCE?
â”‚
â”œâ”€ Is it an ENDPOINT (server, workstation)?
â”‚   â”‚
â”‚   â”œâ”€ Standard log collection only?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Use UNIVERSAL FORWARDER (UF)
â”‚   â”‚       â”œâ”€ Lightweight (~40MB RAM)
â”‚   â”‚       â”œâ”€ Free (no license consumption)
â”‚   â”‚       â””â”€ Configure via deployment server
â”‚   â”‚
â”‚   â””â”€ Need Python/modular inputs on endpoint?
â”‚       â”‚
â”‚       â””â”€ Use HEAVY FORWARDER (HF) 
â”‚           â””â”€ (Rare - consider architecture change)
â”‚
â”œâ”€ Is it an AGGREGATION POINT (syslog server, collector)?
â”‚   â”‚
â”‚   â”œâ”€ Simple forwarding only?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Use UNIVERSAL FORWARDER
â”‚   â”‚       â””â”€ Syslog â†’ UF â†’ Indexers
â”‚   â”‚
â”‚   â””â”€ Need parsing, filtering, or routing?
â”‚       â”‚
â”‚       â””â”€ Use HEAVY FORWARDER
â”‚           â”œâ”€ Parse at edge (reduce indexer load)
â”‚           â”œâ”€ Filter/drop unwanted events
â”‚           â”œâ”€ Route to different indexes
â”‚           â””â”€ Transform/mask sensitive data
â”‚
â”œâ”€ Is it a CLOUD/API data source?
â”‚   â”‚
â”‚   â”œâ”€ API requires Python/OAuth?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ Use HEAVY FORWARDER
â”‚   â”‚       â”œâ”€ CrowdStrike, AWS, O365
â”‚   â”‚       â””â”€ Modular inputs need Python
â”‚   â”‚
â”‚   â””â”€ Simple HTTP/Webhook?
â”‚       â”‚
â”‚       â””â”€ Use HTTP EVENT COLLECTOR (HEC)
â”‚           â””â”€ Direct to indexers, no forwarder needed
â”‚
â””â”€ SCALE CONSIDERATIONS:
    â”‚
    â”œâ”€ &lt;100 forwarders â†’ Single deployment server
    â”œâ”€ 100-1000 forwarders â†’ Multiple deployment servers by region
    â””â”€ &gt;1000 forwarders â†’ Consider intermediate forwarders</div>

                    <h3>Decision Tree: Forwarder Troubleshooting</h3>
                    <div class="arch-diagram">FORWARDER NOT SENDING DATA?
â”‚
â”œâ”€ Check 1: Is forwarder running?
â”‚   â”‚
â”‚   â”œâ”€ /opt/splunkforwarder/bin/splunk status
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ NOT RUNNING â†’ Check startup scripts, permissions
â”‚   â”‚   â””â”€ RUNNING â†’ Continue to Check 2
â”‚   â”‚
â”‚   â””â”€ Windows: services.msc â†’ SplunkForwarder
â”‚
â”œâ”€ Check 2: Is data being monitored?
â”‚   â”‚
â”‚   â”œâ”€ /opt/splunkforwarder/bin/splunk list monitor
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ File not listed â†’ inputs.conf issue
â”‚   â”‚   â””â”€ File listed â†’ Continue to Check 3
â”‚   â”‚
â”‚   â””â”€ Verify inputs.conf:
â”‚       $SPLUNK_HOME/etc/system/local/inputs.conf
â”‚       $SPLUNK_HOME/etc/apps/*/local/inputs.conf
â”‚
â”œâ”€ Check 3: Is data reaching outputs?
â”‚   â”‚
â”‚   â”œâ”€ Check internal logs:
â”‚   â”‚   index=_internal host=forwarder_name sourcetype=splunkd
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ Connection errors â†’ Network/firewall issue
â”‚   â”‚   â”œâ”€ SSL errors â†’ Certificate mismatch
â”‚   â”‚   â””â”€ No errors â†’ Continue to Check 4
â”‚   â”‚
â”‚   â””â”€ Check outputs.conf:
â”‚       [tcpout:primary]
â”‚       server = indexer1:9997, indexer2:9997
â”‚
â”œâ”€ Check 4: Is data arriving at indexers?
â”‚   â”‚
â”‚   â”œâ”€ On indexer:
â”‚   â”‚   index=_internal source=*metrics.log group=tcpin_connections
â”‚   â”‚   | stats values(hostname) by connectionType
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ Forwarder listed â†’ Data arriving but not indexed
â”‚   â”‚   â””â”€ Forwarder missing â†’ Network/port issue
â”‚   â”‚
â”‚   â””â”€ Check port 9997 open: telnet indexer 9997
â”‚
â””â”€ Check 5: Is data being indexed?
    â”‚
    â””â”€ index=* host=forwarder_source_host earliest=-1h
        â”‚
        â”œâ”€ Data appears â†’ Issue resolved
        â””â”€ No data â†’ Check index routing, props.conf</div>

                    <h3>Decision Tree: Deployment Server Configuration</h3>
                    <div class="arch-diagram">MANAGING FORWARDER CONFIGURATIONS?
â”‚
â”œâ”€ How many forwarders?
â”‚   â”‚
â”‚   â”œâ”€ &lt;10 forwarders?
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€ MANUAL configuration acceptable
â”‚   â”‚       â””â”€ Direct inputs.conf/outputs.conf editing
â”‚   â”‚
â”‚   â””â”€ &gt;10 forwarders?
â”‚       â”‚
â”‚       â””â”€ Use DEPLOYMENT SERVER
â”‚           â”‚
â”‚           â”œâ”€ Create SERVER CLASSES by role:
â”‚           â”‚   â”œâ”€ Windows_Domain_Controllers
â”‚           â”‚   â”œâ”€ Linux_Web_Servers
â”‚           â”‚   â”œâ”€ Network_Devices
â”‚           â”‚   â””â”€ Security_Appliances
â”‚           â”‚
â”‚           â”œâ”€ Create DEPLOYMENT APPS:
â”‚           â”‚   â”œâ”€ outputs_production (outputs.conf)
â”‚           â”‚   â”œâ”€ TA-windows (Windows inputs)
â”‚           â”‚   â”œâ”€ TA-nix (Linux inputs)
â”‚           â”‚   â””â”€ org_custom_inputs (custom configs)
â”‚           â”‚
â”‚           â””â”€ Map apps to server classes in serverclass.conf:
â”‚               [serverClass:Windows_Domain_Controllers:app:TA-windows]
â”‚               [serverClass:Windows_Domain_Controllers:app:outputs_production]
â”‚
â””â”€ MULTI-SITE deployment?
    â”‚
    â”œâ”€ Single deployment server with regional server classes
    â””â”€ OR regional deployment servers with replication</div>
                </div>

                <!-- What Enterprises Usually Miss -->
                <h2><i class="fas fa-exclamation-circle"></i> What Enterprises Usually Miss</h2>
                <div class="enterprise-gaps">
                    <div class="gap-grid">
                        <div class="gap-category critical">
                            <h4>ğŸ”´ Critical Gaps</h4>
                            <ul>
                                <li><strong>No forwarder monitoring:</strong> No alerts when forwarders stop sending data</li>
                                <li><strong>Stale certificates:</strong> SSL certs expire, all forwarders disconnect</li>
                                <li><strong>Single deployment server:</strong> DS failure = no config management</li>
                                <li><strong>No queue monitoring:</strong> Forwarder queues fill, data lost</li>
                                <li><strong>outputs.conf on wrong tier:</strong> Outputs in deployment app without reload triggers</li>
                            </ul>
                        </div>
                        <div class="gap-category warning">
                            <h4><i class="fas fa-exclamation-triangle"></i> Operational Gaps</h4>
                            <ul>
                                <li><strong>No forwarder inventory:</strong> Unknown number of forwarders or their versions</li>
                                <li><strong>Mixed forwarder versions:</strong> UFs ranging from 7.x to 9.x causing inconsistencies</li>
                                <li><strong>Manual deployments:</strong> Forwarders configured individually, not via deployment server</li>
                                <li><strong>No restart policy:</strong> Config changes require manual restarts</li>
                                <li><strong>Orphaned forwarders:</strong> Forwarders from decommissioned servers still reporting</li>
                            </ul>
                        </div>
                        <div class="gap-category info">
                            <h4><i class="fas fa-info-circle"></i> Performance Issues</h4>
                            <ul>
                                <li><strong>Unbalanced load:</strong> All forwarders sending to same indexer</li>
                                <li><strong>No intermediate forwarders:</strong> 1000+ UFs all connecting to indexers directly</li>
                                <li><strong>Oversized inputs:</strong> Monitoring entire /var/log instead of specific files</li>
                                <li><strong>No blacklists:</strong> Collecting debug logs, verbose output unnecessarily</li>
                                <li><strong>Throttling misconfigured:</strong> Default maxKBps causing data lag</li>
                            </ul>
                        </div>
                        <div class="gap-category best-practice">
                            <h4><i class="fas fa-check-circle"></i> Best Practices Often Ignored</h4>
                            <ul>
                                <li><strong>Phone home monitoring:</strong> Alert when forwarders haven't checked in for 24+ hours</li>
                                <li><strong>Staged rollouts:</strong> Test deployment app changes on pilot group first</li>
                                <li><strong>Version standardization:</strong> Keep all forwarders on same major version</li>
                                <li><strong>Certificate rotation plan:</strong> Process for annual cert renewal</li>
                                <li><strong>Backup DS configs:</strong> serverclass.conf and deployment apps in version control</li>
                            </ul>
                        </div>
                    </div>

                    <h3><i class="fas fa-clipboard-check"></i> Forwarder Health Checklist</h3>
                    <div class="checklist-grid">
                        <div class="checklist-section">
                            <h4>Daily Checks</h4>
                            <ul>
                                <li><input type="checkbox"> Forwarder count matches expected inventory</li>
                                <li><input type="checkbox"> No forwarder queue alerts fired</li>
                                <li><input type="checkbox"> All critical sources have recent events</li>
                                <li><input type="checkbox"> Deployment server accessible</li>
                            </ul>
                        </div>
                        <div class="checklist-section">
                            <h4>Weekly Checks</h4>
                            <ul>
                                <li><input type="checkbox"> Review forwarders not seen in 7+ days</li>
                                <li><input type="checkbox"> Check forwarder version distribution</li>
                                <li><input type="checkbox"> Validate deployment app consistency</li>
                                <li><input type="checkbox"> Review splunkd.log for recurring errors</li>
                            </ul>
                        </div>
                        <div class="checklist-section">
                            <h4>Monthly Checks</h4>
                            <ul>
                                <li><input type="checkbox"> Certificate expiration review</li>
                                <li><input type="checkbox"> Forwarder performance metrics trending</li>
                                <li><input type="checkbox"> Orphaned forwarder cleanup</li>
                                <li><input type="checkbox"> Deployment server capacity planning</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between Universal and Heavy Forwarder?</button>
                        <div class="qa-answer">
                            <table class="styled-table">
                                <tr><th>Universal Forwarder</th><th>Heavy Forwarder</th></tr>
                                <tr><td>Minimal resources (~40MB)</td><td>Full Splunk instance (~1GB+)</td></tr>
                                <tr><td>No parsing capability</td><td>Full parsing at ingest</td></tr>
                                <tr><td>Free license</td><td>Consumes license</td></tr>
                                <tr><td>For endpoints/servers</td><td>For aggregation/transformation</td></tr>
                            </table>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you manage forwarder configuration at scale?</button>
                        <div class="qa-answer">
                            <p>Use <strong>Deployment Server</strong>:</p>
                            <ol>
                                <li>Create apps in <code>$SPLUNK_HOME/etc/deployment-apps/</code></li>
                                <li>Define server classes in <code>serverclass.conf</code></li>
                                <li>Forwarders phone home and receive assigned apps</li>
                                <li>Changes propagate automatically to all forwarders</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: A forwarder isn't sending data. How do you troubleshoot?</button>
                        <div class="qa-answer">
                            <ol>
                                <li>Check service: <code>splunk status</code></li>
                                <li>Test network: <code>telnet indexer 9997</code></li>
                                <li>Validate config: <code>splunk btool outputs list --debug</code></li>
                                <li>Check logs: <code>$SPLUNK_HOME/var/log/splunk/splunkd.log</code></li>
                                <li>Monitor queue: Check <code>_internal</code> for blocked queues</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: When would you use a Heavy Forwarder?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Syslog aggregation:</strong> Receive from network devices</li>
                                <li><strong>Data filtering:</strong> Reduce volume before indexing</li>
                                <li><strong>Data transformation:</strong> Parse, enrich, route</li>
                                <li><strong>DMZ aggregation:</strong> Single egress point</li>
                                <li><strong>Compliance:</strong> Interim storage for data integrity</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you detect forwarders that have stopped sending data?</button>
                        <div class="qa-answer">
                            <p><strong>Three-layer monitoring approach:</strong></p>
                            <div class="arch-diagram">// Layer 1: Phone home monitoring (fastest detection)
index=_internal sourcetype=splunkd component=Metrics group=tcpin_connections
| stats latest(_time) as last_seen by hostname
| eval hours_since = round((now() - last_seen)/3600, 1)
| where hours_since > 2
| table hostname last_seen hours_since

// Layer 2: Expected hosts inventory comparison
| inputlookup expected_forwarders.csv
| join type=left host 
    [search index=_internal earliest=-4h | stats count by host]
| where isnull(count)
| table host expected_sourcetypes business_owner

// Layer 3: Source-specific data freshness
index=windows OR index=linux earliest=-4h
| stats latest(_time) as last_event by host sourcetype
| eval lag_minutes = round((now() - last_event)/60)
| where lag_minutes > 60
| table host sourcetype last_event lag_minutes</div>
                            <p><strong>Alert recommendation:</strong> Create scheduled alerts at 2-hour, 8-hour, and 24-hour thresholds with escalating severity.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Explain the forwarder data path from source to indexer</button>
                        <div class="qa-answer">
                            <p><strong>Complete data flow:</strong></p>
                            <div class="arch-diagram">1. INPUT PHASE (inputs.conf)
   â”œâ”€ Monitor reads file â†’ /var/log/secure
   â”œâ”€ Creates raw event with metadata (host, source, sourcetype)
   â””â”€ Places in input queue

2. PARSING PHASE (UF: minimal, HF: full)
   â”œâ”€ UF: Only line breaking, timestamp recognition
   â””â”€ HF: props.conf transforms, field extraction, routing

3. OUTPUT PHASE (outputs.conf)
   â”œâ”€ Events placed in output queue
   â”œâ”€ Load balancing across indexer targets
   â”‚   â”œâ”€ autoLB (default): Balance by volume
   â”‚   â””â”€ autoLBFrequency: How often to switch targets
   â””â”€ TCP connection to indexer port 9997

4. INDEXER RECEIVE
   â”œâ”€ tcpin queue receives events
   â”œâ”€ Parsing pipeline processes (if not parsed at HF)
   â””â”€ Events written to index</div>
                            <p><strong>Key config files:</strong> inputs.conf (what to collect), outputs.conf (where to send), props.conf (how to parse)</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle forwarder certificate management at scale?</button>
                        <div class="qa-answer">
                            <p><strong>Certificate architecture:</strong></p>
                            <ol>
                                <li><strong>Root CA:</strong> Internal PKI or dedicated Splunk CA</li>
                                <li><strong>Server certs:</strong> On indexers (server.pem, serverkey.pem)</li>
                                <li><strong>Client certs:</strong> On forwarders (or use server cert for auth)</li>
                            </ol>
                            <p><strong>Deployment strategy:</strong></p>
                            <div class="arch-diagram">// outputs.conf on forwarders
[tcpout]
sslRootCAPath = $SPLUNK_HOME/etc/auth/cacert.pem
sslCertPath = $SPLUNK_HOME/etc/auth/server.pem
sslPassword = [encrypted]
sslVerifyServerCert = true
sslCommonNameToCheck = idx-*.company.com

// Certificate deployment via deployment server
$SPLUNK_HOME/etc/deployment-apps/org_ssl_certs/
â”œâ”€â”€ default/outputs.conf
â””â”€â”€ default/auth/
    â”œâ”€â”€ cacert.pem
    â”œâ”€â”€ server.pem
    â””â”€â”€ server.key</div>
                            <p><strong>Rotation process:</strong> Generate new certs 30 days before expiry, deploy to test group, validate, then production rollout with staged restarts.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you troubleshoot a forwarder queue backup?</button>
                        <div class="qa-answer">
                            <p><strong>Diagnostic steps:</strong></p>
                            <div class="arch-diagram">// Step 1: Identify which queue is backing up
index=_internal host=forwarder_name source=*metrics.log group=queue
| timechart span=5m max(current_size) by name

// Common queue issues:
parsingQueue â†’ Parsing too slow, complex props.conf
aggQueue â†’ Aggregation issues  
typingQueue â†’ Event typing bottleneck
indexQueue â†’ Indexer connection issue
tcpout_queue â†’ Output blocked, network issue

// Step 2: Check output connectivity
index=_internal host=forwarder_name sourcetype=splunkd component=TcpOutputProc
| stats count by log_level message

// Step 3: Check for throttling
index=_internal host=forwarder_name "thruput" OR "blocked"
| timechart count by component</div>
                            <p><strong>Resolution options:</strong></p>
                            <ul>
                                <li><strong>Network issue:</strong> Check firewall, port 9997 connectivity</li>
                                <li><strong>Indexer overload:</strong> Add indexers, check indexer queues</li>
                                <li><strong>Parsing bottleneck:</strong> Simplify props.conf, move parsing to indexer</li>
                                <li><strong>Volume spike:</strong> Increase maxQueueSize, add filtering</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Describe intermediate forwarder architecture and when to use it</button>
                        <div class="qa-answer">
                            <p><strong>Architecture pattern:</strong></p>
                            <div class="arch-diagram">[1000+ Endpoints]           [Intermediate HFs]         [Indexer Cluster]
      â”‚                           â”‚                           â”‚
   [UF]â”€â”€â”€â”€â”€â”€â”€â”€â”               [HF-1]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     [IDX-1]
   [UF]â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[HF-2]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€[IDX-2]
   [UF]â”€â”€â”€â”€â”€â”€â”€â”€â”¤               [HF-3]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     [IDX-3]
   [UF]â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                     â””â”€â”€â”€â”€â”€[IDX-4]
                                 â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                          â”‚ Functions:  â”‚
                          â”‚ - Aggregate â”‚
                          â”‚ - Parse     â”‚
                          â”‚ - Filter    â”‚
                          â”‚ - Route     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
                            <p><strong>When to use intermediate forwarders:</strong></p>
                            <ul>
                                <li><strong>&gt;500 UFs:</strong> Reduces indexer connection overhead</li>
                                <li><strong>WAN/DMZ:</strong> Single egress point from remote sites or DMZ</li>
                                <li><strong>Parsing at edge:</strong> Reduce indexer CPU load</li>
                                <li><strong>Data sovereignty:</strong> Keep data in region before forwarding</li>
                            </ul>
                            <p><strong>Sizing:</strong> Each HF can typically handle 100-200 UFs depending on data volume and parsing complexity.</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>