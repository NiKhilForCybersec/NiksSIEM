<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forwarders | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Splunk Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="es-overview.html" class="nav-link"><i class="fas fa-shield-alt"></i> Enterprise Security</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="forwarders.html" class="nav-link active"><i class="fas fa-share"></i> Forwarders</a>
                    <a href="custom-log-onboarding.html" class="nav-link"><i class="fas fa-file-import"></i> Custom Onboarding</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & Fields</a>
                    <a href="data-models.html" class="nav-link"><i class="fas fa-cubes"></i> Data Models & CIM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SPL Query Language</div>
                    <a href="spl-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> SPL Fundamentals</a>
                    <a href="spl-intermediate.html" class="nav-link"><i class="fas fa-code"></i> SPL Intermediate</a>
                    <a href="spl-advanced.html" class="nav-link"><i class="fas fa-rocket"></i> SPL Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Operations</div>
                    <a href="correlation-searches.html" class="nav-link"><i class="fas fa-project-diagram"></i> Correlation Searches</a>
                    <a href="notable-events.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Notable Events</a>
                    <a href="risk-based-alerting.html" class="nav-link"><i class="fas fa-chart-line"></i> Risk-Based Alerting</a>
                    <a href="threat-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Hunting</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intelligence</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Administration</div>
                    <a href="administration.html" class="nav-link"><i class="fas fa-cog"></i> Administration</a>
                    <a href="apps-tas.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> Apps & Add-ons</a>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Storage Tiers</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Splunk</a><span class="separator">/</span>
                    <span class="current">Forwarders</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-share"></i> Splunk Forwarders</h1>
                <p class="lead">Master Splunk's data collection agents. Learn Universal Forwarder deployment, Heavy Forwarder use cases, and configuration management at scale.</p>

                <!-- Forwarder Types -->
                <h2><i class="fas fa-layer-group"></i> Forwarder Types</h2>
                <div class="config-section">
                    <h4>Comparison</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Feature</th><th>Universal Forwarder</th><th>Heavy Forwarder</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Size</strong></td><td>~100 MB</td><td>Full Splunk (~1 GB)</td></tr>
                            <tr><td><strong>Memory</strong></td><td>~100 MB</td><td>1-4 GB+</td></tr>
                            <tr><td><strong>Parsing</strong></td><td>No (raw data)</td><td>Yes (full parsing)</td></tr>
                            <tr><td><strong>Filtering</strong></td><td>Basic</td><td>Full SPL transforms</td></tr>
                            <tr><td><strong>Routing</strong></td><td>Simple</td><td>Complex routing logic</td></tr>
                            <tr><td><strong>UI</strong></td><td>CLI only</td><td>Full web UI</td></tr>
                            <tr><td><strong>Use Case</strong></td><td>Endpoint collection</td><td>Aggregation, transformation</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Universal Forwarder -->
                <h2><i class="fas fa-desktop"></i> Universal Forwarder</h2>
                <div class="config-section">
                    <h4>Installation - Windows</h4>
                    <div class="code-block"># Download from splunk.com/download/universalforwarder

# Silent install
msiexec.exe /i splunkforwarder-9.x.x-xxxxxxxx-x64-release.msi ^
  AGREETOLICENSE=Yes ^
  RECEIVING_INDEXER="indexer1.domain.com:9997" ^
  DEPLOYMENT_SERVER="ds.domain.com:8089" ^
  SPLUNKUSERNAME=admin ^
  SPLUNKPASSWORD=changeme ^
  /quiet

# Or with deployment server only
msiexec.exe /i splunkforwarder-9.x.x-xxxxxxxx-x64-release.msi ^
  AGREETOLICENSE=Yes ^
  DEPLOYMENT_SERVER="ds.domain.com:8089" ^
  /quiet</div>

                    <h4>Installation - Linux</h4>
                    <div class="code-block"># Download and extract
wget -O splunkforwarder.tgz "https://download.splunk.com/products/universalforwarder/releases/9.x.x/linux/splunkforwarder-9.x.x-xxxxxxxx-Linux-x86_64.tgz"
tar -xvzf splunkforwarder.tgz -C /opt

# Start and accept license
/opt/splunkforwarder/bin/splunk start --accept-license

# Enable boot start
/opt/splunkforwarder/bin/splunk enable boot-start -user splunk

# Configure deployment server
/opt/splunkforwarder/bin/splunk set deploy-poll ds.domain.com:8089</div>

                    <h4>Key Configuration Files</h4>
                    <div class="code-block">$SPLUNK_HOME/etc/system/local/

outputs.conf - Where to send data
├── [tcpout]
├── [tcpout:primary_indexers]
└── [tcpout-server://indexer:9997]

inputs.conf - What to collect
├── [monitor:///var/log/secure]
├── [WinEventLog://Security]
└── [script://./bin/script.sh]

deploymentclient.conf - Deployment server
├── [deployment-client]
└── targetUri = ds.domain.com:8089

server.conf - Server settings
└── [general]
    └── serverName = hostname</div>
                </div>

                <!-- Heavy Forwarder -->
                <h2><i class="fas fa-server"></i> Heavy Forwarder</h2>
                <div class="config-section">
                    <h4>Use Cases</h4>
                    <div class="code-block">Heavy Forwarder Use Cases:

1. SYSLOG AGGREGATION
   └── Receive syslog from network devices
   └── Parse and transform before forwarding
   └── UDP/TCP/TLS syslog inputs

2. DATA TRANSFORMATION
   └── Filter unwanted events
   └── Mask sensitive data (PII, credentials)
   └── Add/modify fields before indexing

3. ROUTING
   └── Route data to different indexes
   └── Send to multiple destinations
   └── Load balancing across indexers

4. PROTOCOL CONVERSION
   └── Receive HEC, forward via TCP
   └── Convert syslog to structured data
   └── API polling scripts</div>

                    <h4>Syslog Input Configuration</h4>
                    <div class="code-block"># inputs.conf - Syslog receiver
[udp://514]
connection_host = dns
sourcetype = syslog

[tcp://514]
connection_host = dns
sourcetype = syslog

# TLS syslog (secure)
[tcp-ssl://6514]
connection_host = dns
sourcetype = syslog

# server.conf - SSL settings
[sslConfig]
serverCert = $SPLUNK_HOME/etc/auth/server.pem
sslRootCAPath = $SPLUNK_HOME/etc/auth/ca.pem
requireClientCert = false</div>

                    <h4>Data Routing</h4>
                    <div class="code-block"># outputs.conf - Routing to multiple destinations
[tcpout]
defaultGroup = primary_indexers

[tcpout:primary_indexers]
server = idx1.domain.com:9997, idx2.domain.com:9997
autoLB = true

[tcpout:security_indexers]
server = sec-idx1.domain.com:9997, sec-idx2.domain.com:9997

# props.conf - Route by sourcetype
[source::...security...]
TRANSFORMS-routing = route_to_security

# transforms.conf
[route_to_security]
REGEX = .
DEST_KEY = _TCP_ROUTING
FORMAT = security_indexers</div>
                </div>

                <!-- Deployment Server -->
                <h2><i class="fas fa-cloud-upload-alt"></i> Deployment Server</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Forwarder Management</span></p>

                    <h4>Deployment Architecture</h4>
                    <div class="code-block">Deployment Server Workflow:

                    ┌─────────────────┐
                    │ Deployment      │
                    │ Server          │
                    │ (Apps/Configs)  │
                    └────────┬────────┘
                             │
            ┌────────────────┼────────────────┐
            │                │                │
            ▼                ▼                ▼
    ┌───────────┐    ┌───────────┐    ┌───────────┐
    │ Server    │    │ Server    │    │ Server    │
    │ Class:    │    │ Class:    │    │ Class:    │
    │ Windows   │    │ Linux     │    │ Network   │
    └───────────┘    └───────────┘    └───────────┘
         │                │                │
         ▼                ▼                ▼
    [UF agents]     [UF agents]     [HF agents]</div>

                    <h4>Server Classes</h4>
                    <div class="code-block"># serverclass.conf
[serverClass:Windows_Servers]
whitelist.0 = WIN-*
whitelist.1 = *.domain.com

[serverClass:Windows_Servers:app:TA-windows]
restartSplunkWeb = false
restartSplunkd = true
stateOnClient = enabled

[serverClass:Linux_Servers]
whitelist.0 = linux-*
blacklist.0 = linux-dev-*

[serverClass:Linux_Servers:app:TA-nix]
restartSplunkd = true
stateOnClient = enabled

# Matching criteria options:
# whitelist.N = hostname pattern
# blacklist.N = exclude pattern
# machineTypesFilter = linux-x86_64, windows-x64
# filterType = whitelist (default) or blacklist</div>
                </div>

                <!-- outputs.conf Deep Dive -->
                <h2><i class="fas fa-cog"></i> outputs.conf Configuration</h2>
                <div class="config-section">
                    <div class="code-block"># outputs.conf - Complete example

[tcpout]
defaultGroup = primary_indexers
maxQueueSize = 500KB
useACK = true

[tcpout:primary_indexers]
server = idx1.domain.com:9997, idx2.domain.com:9997
autoLB = true
autoLBFrequency = 30
forceTimebasedAutoLB = true
useACK = true

# SSL/TLS encryption
[tcpout:secure_indexers]
server = idx1.domain.com:9998
sslCertPath = $SPLUNK_HOME/etc/auth/server.pem
sslRootCAPath = $SPLUNK_HOME/etc/auth/ca.pem
sslPassword = password
sslVerifyServerCert = true

# Indexer Discovery (for clustered indexers)
[indexer_discovery:cluster_master]
manager_uri = https://cm.domain.com:8089
pass4SymmKey = your_key

[tcpout:discovered_indexers]
indexerDiscovery = cluster_master
autoLB = true

KEY PARAMETERS:
├── useACK         - Wait for indexer acknowledgment (reliability)
├── autoLB         - Auto load balancing
├── maxQueueSize   - Buffer size before blocking
├── compressed     - Enable compression (default: true)
└── sslVerifyServerCert - Verify indexer certificate</div>
                </div>

                <!-- inputs.conf Deep Dive -->
                <h2><i class="fas fa-file-import"></i> inputs.conf Configuration</h2>
                <div class="config-section">
                    <div class="code-block"># inputs.conf - File monitoring

# Monitor directory
[monitor:///var/log]
whitelist = \.(log|txt)$
blacklist = \.(gz|zip)$
recursive = true
followTail = 0
sourcetype = syslog

# Monitor specific file
[monitor:///var/log/secure]
disabled = false
sourcetype = linux_secure
index = os

# Windows Event Logs
[WinEventLog://Security]
disabled = 0
start_from = oldest
current_only = 0
evt_resolve_ad_obj = 1
checkpointInterval = 5
renderXml = true

[WinEventLog://System]
disabled = 0

[WinEventLog://Application]
disabled = 0

# Windows Event with filtering (faster)
[WinEventLog://Security]
whitelist = 4624,4625,4648,4672,4688,4720,4722,4732

# Script input
[script://./bin/collect_metrics.sh]
disabled = 0
interval = 300
sourcetype = custom_metrics

# HTTP Event Collector (HEC)
[http]
disabled = 0
port = 8088
enableSSL = 1</div>
                </div>

                <!-- Troubleshooting -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting</h2>
                <div class="config-section">
                    <div class="code-block"># Check forwarder status
/opt/splunkforwarder/bin/splunk status

# Check connectivity to indexer
/opt/splunkforwarder/bin/splunk list forward-server

# Test outputs
/opt/splunkforwarder/bin/splunk btool outputs list --debug

# Check inputs
/opt/splunkforwarder/bin/splunk btool inputs list --debug

# View logs
tail -f /opt/splunkforwarder/var/log/splunk/splunkd.log

# Common issues:

1. NOT FORWARDING
   □ Check outputs.conf syntax
   □ Verify indexer port 9997 open
   □ Check firewall rules
   □ Review splunkd.log for errors

2. DEPLOYMENT CLIENT NOT RECEIVING
   □ Verify deploymentclient.conf
   □ Check deployment server connectivity
   □ Review serverclass.conf patterns
   □ Check clientName matches whitelist

3. MISSING DATA
   □ Verify inputs.conf paths exist
   □ Check file permissions
   □ Review blacklist/whitelist patterns
   □ Check index exists on indexer

4. HIGH MEMORY USAGE
   □ Reduce maxQueueSize
   □ Check for parsing at forwarder
   □ Review props.conf complexity</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: When would you use a Heavy Forwarder vs Universal Forwarder?</button>
                        <div class="qa-answer">
                            <p><strong>Universal Forwarder:</strong> Most endpoints - lightweight, just collects and forwards raw data.</p>
                            <p><strong>Heavy Forwarder:</strong> When you need:</p>
                            <ul>
                                <li>Syslog aggregation from network devices</li>
                                <li>Data transformation, filtering, or masking</li>
                                <li>Complex routing logic</li>
                                <li>Parse data before forwarding</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How does deployment server work?</button>
                        <div class="qa-answer">
                            <ol>
                                <li>Forwarders phone home to deployment server (poll interval)</li>
                                <li>Deployment server matches forwarder to server classes (by hostname pattern)</li>
                                <li>Apps assigned to server class are pushed to matching forwarders</li>
                                <li>Forwarder restarts if required, applies new configs</li>
                            </ol>
                            <p>This enables centralized configuration management for thousands of forwarders.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What is useACK in outputs.conf?</button>
                        <div class="qa-answer">
                            <p><strong>useACK = true</strong> enables indexer acknowledgment:</p>
                            <ul>
                                <li>Forwarder waits for indexer to confirm data receipt</li>
                                <li>Prevents data loss if indexer goes down</li>
                                <li>Data queued in forwarder until acknowledged</li>
                                <li>Recommended for critical data sources</li>
                            </ul>
                            <p>Trade-off: Slightly higher latency for guaranteed delivery.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>