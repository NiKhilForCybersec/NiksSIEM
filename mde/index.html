<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Defender for Endpoint - Complete Reference | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Compendium</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Deployment</div>
                    <a href="onboarding-windows.html" class="nav-link"><i class="fab fa-windows"></i> Windows Onboarding</a>
                    <a href="onboarding-linux.html" class="nav-link"><i class="fab fa-linux"></i> Linux Onboarding</a>
                    <a href="onboarding-macos.html" class="nav-link"><i class="fab fa-apple"></i> macOS Onboarding</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="kql-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> KQL Hunting</a>
                    <a href="alert-tuning.html" class="nav-link"><i class="fas fa-sliders-h"></i> Alert Tuning</a>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-hand-paper"></i> Response Actions</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-wrench"></i> Troubleshooting</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fab fa-microsoft"></i> Microsoft Defender for Endpoint</h1>
                    <p class="lead">Enterprise endpoint detection and response with native Microsoft 365 integration, advanced hunting, and automated investigation</p>
                </div>

                <!-- Architecture Overview -->
                <section class="content-section">
                    <h2><i class="fas fa-sitemap"></i> Platform Architecture</h2>
                    <div class="workflow-diagram">
<pre>
╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                         MICROSOFT DEFENDER FOR ENDPOINT ARCHITECTURE                                                  ║
╠══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                                                       ║
║    ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐   ║
║    │                                              ENDPOINTS                                                                       │   ║
║    │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │   ║
║    │   │  Windows    │  │   macOS     │  │   Linux     │  │   iOS       │  │  Android    │  │  IoT/OT     │  │  Servers    │     │   ║
║    │   │  10/11/Svr  │  │             │  │             │  │             │  │             │  │             │  │  (Azure)    │     │   ║
║    │   │             │  │  Native     │  │  Native     │  │  MDM/MAM    │  │  MDM/MAM    │  │  Limited    │  │  Arc/Direct │     │   ║
║    │   │  MsSense    │  │  Agent      │  │  Agent      │  │  Integration│  │  Integration│  │  Agent      │  │             │     │   ║
║    │   └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘     │   ║
║    │          └──────────────────────────────────┴──────────────────────────────────┴──────────────────────────────────┘           │   ║
║    └───────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────┘   ║
║                                                                            │                                                         ║
║                                                                            ▼                                                         ║
║    ┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐  ║
║    │                                        MICROSOFT DEFENDER XDR                                                                │  ║
║    │                                                                                                                              │  ║
║    │  ┌────────────────────┐  ┌────────────────────┐  ┌────────────────────┐  ┌────────────────────┐  ┌────────────────────┐     │  ║
║    │  │  DEFENDER FOR      │  │  DEFENDER FOR      │  │  DEFENDER FOR      │  │  DEFENDER FOR      │  │  DEFENDER FOR      │     │  ║
║    │  │  ENDPOINT          │  │  IDENTITY          │  │  OFFICE 365        │  │  CLOUD APPS        │  │  CLOUD             │     │  ║
║    │  │                    │  │                    │  │                    │  │                    │  │                    │     │  ║
║    │  │  • EDR             │  │  • AD Protection   │  │  • Email Security  │  │  • CASB            │  │  • Azure/AWS/GCP   │     │  ║
║    │  │  • Next-Gen AV     │  │  • Lateral Move    │  │  • Safe Links      │  │  • App Discovery   │  │  • Workload        │     │  ║
║    │  │  • Alert Tuning       │  │  • Credential      │  │  • Safe Attach     │  │  • DLP             │  │    Protection      │     │  ║
║    │  │  • Device Control  │  │    Protection      │  │  • Anti-Phishing   │  │  • Session Control │  │  • Container       │     │  ║
║    │  └────────────────────┘  └────────────────────┘  └────────────────────┘  └────────────────────┘  └────────────────────┘     │  ║
║    │                                                           │                                                                  │  ║
║    │  ┌────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────┐ │  ║
║    │  │                                     UNIFIED SECURITY OPERATIONS                                                        │ │  ║
║    │  │                                                                                                                        │ │  ║
║    │  │  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐                    │ │  ║
║    │  │  │  ADVANCED HUNTING   │  │  INCIDENT &         │  │  AUTOMATED          │  │  THREAT             │                    │ │  ║
║    │  │  │  (KQL)              │  │  ALERT QUEUE        │  │  INVESTIGATION      │  │  INTELLIGENCE       │                    │ │  ║
║    │  │  │                     │  │                     │  │                     │  │                     │                    │ │  ║
║    │  │  │  Cross-product      │  │  Unified view       │  │  AIR - Automated    │  │  Microsoft TI       │                    │ │  ║
║    │  │  │  threat hunting     │  │  of all alerts      │  │  Investigation &    │  │  Defender TI        │                    │ │  ║
║    │  │  │  with 30-day data   │  │  and incidents      │  │  Remediation        │  │  integration        │                    │ │  ║
║    │  │  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘                    │ │  ║
║    │  └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │  ║
║    │                                                           │                                                                  │  ║
║    │                                                           ▼                                                                  │  ║
║    │  ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │  ║
║    │  │                                         MICROSOFT SENTINEL (SIEM)                                                      │ │  ║
║    │  │                                                                                                                        │ │  ║
║    │  │  Native integration • All MDE data available • Unified KQL hunting • Cross-platform correlation                        │ │  ║
║    │  └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │  ║
║    └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  ║
║                                                                                                                                       ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
</pre>
                    </div>
                </section>

                <!-- Key Capabilities -->
                <section class="content-section">
                    <h2><i class="fas fa-star"></i> Key Capabilities</h2>
                    <div class="card-grid">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon blue"><i class="fas fa-crosshairs"></i></div>
                                <div>
                                    <div class="card-title">Advanced Hunting</div>
                                    <div class="card-subtitle">KQL-Based Threat Hunting</div>
                                </div>
                            </div>
                            <div class="card-body">
                                Query 30 days of endpoint telemetry using Kusto Query Language (KQL). Hunt across device, file, network, identity, and email events with full cross-product visibility.
                            </div>
                            <a href="kql-hunting.html" class="card-link">KQL Hunting Guide <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon purple"><i class="fas fa-shield-virus"></i></div>
                                <div>
                                    <div class="card-title">KQL Hunting</div>
                                    <div class="card-subtitle">Scheduled Query Rules</div>
                                </div>
                            </div>
                            <div class="card-body">
                                Create scheduled KQL queries that generate alerts when threats are found. Automatic response actions, custom severity mapping, and MITRE ATT&CK tagging.
                            </div>
                            <a href="kql-hunting.html" class="card-link">KQL Hunting <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon cyan"><i class="fas fa-terminal"></i></div>
                                <div>
                                    <div class="card-title">Response Actions</div>
                                    <div class="card-subtitle">Remote Investigation</div>
                                </div>
                            </div>
                            <div class="card-body">
                                Interactive remote shell for forensic investigation. Collect files, run scripts, analyze processes, and perform remediation directly on endpoints.
                            </div>
                            <a href="response-actions.html" class="card-link">Response Actions <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon green"><i class="fas fa-shield-alt"></i></div>
                                <div>
                                    <div class="card-title">Attack Surface Reduction</div>
                                    <div class="card-subtitle">Proactive Protection Rules</div>
                                </div>
                            </div>
                            <div class="card-body">
                                16+ configurable rules blocking common attack techniques like Office macro execution, credential stealing, ransomware behavior, and script-based attacks.
                            </div>
                            <a href="alert-tuning.html" class="card-link">Alert Tuning <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                </section>

                <!-- KQL Quick Reference -->
                <section class="content-section">
                    <h2><i class="fas fa-code"></i> KQL Quick Reference</h2>
                    
                    <h3>Essential Tables</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Table</th>
                                    <th>Description</th>
                                    <th>Key Fields</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>DeviceProcessEvents</code></td>
                                    <td>Process execution events</td>
                                    <td>ProcessCommandLine, FileName, InitiatingProcessFileName</td>
                                </tr>
                                <tr>
                                    <td><code>DeviceNetworkEvents</code></td>
                                    <td>Network connections</td>
                                    <td>RemoteIP, RemotePort, RemoteUrl, InitiatingProcessFileName</td>
                                </tr>
                                <tr>
                                    <td><code>DeviceFileEvents</code></td>
                                    <td>File operations</td>
                                    <td>FileName, FolderPath, SHA256, ActionType</td>
                                </tr>
                                <tr>
                                    <td><code>DeviceRegistryEvents</code></td>
                                    <td>Registry modifications</td>
                                    <td>RegistryKey, RegistryValueName, RegistryValueData</td>
                                </tr>
                                <tr>
                                    <td><code>DeviceLogonEvents</code></td>
                                    <td>Authentication events</td>
                                    <td>AccountName, LogonType, RemoteIP</td>
                                </tr>
                                <tr>
                                    <td><code>DeviceImageLoadEvents</code></td>
                                    <td>DLL loading events</td>
                                    <td>FileName, FolderPath, SHA256, InitiatingProcessFileName</td>
                                </tr>
                                <tr>
                                    <td><code>AlertEvidence</code></td>
                                    <td>Evidence from alerts</td>
                                    <td>EntityType, EvidenceRole, SHA256</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Essential Hunting Queries</h3>
                    <pre><code>// Encoded PowerShell Commands
DeviceProcessEvents
| where Timestamp > ago(7d)
| where FileName =~ "powershell.exe"
| where ProcessCommandLine has_any ("-enc", "-encodedcommand", "FromBase64String")
| project Timestamp, DeviceName, AccountName, ProcessCommandLine, InitiatingProcessFileName

// LSASS Access Detection
DeviceProcessEvents
| where Timestamp > ago(24h)
| where FileName =~ "lsass.exe" 
| where InitiatingProcessFileName !in~ ("svchost.exe", "wininit.exe", "services.exe")
| project Timestamp, DeviceName, InitiatingProcessFileName, InitiatingProcessCommandLine

// Suspicious Parent-Child Process
DeviceProcessEvents
| where Timestamp > ago(7d)
| where InitiatingProcessFileName in~ ("winword.exe", "excel.exe", "outlook.exe", "powerpnt.exe")
| where FileName in~ ("cmd.exe", "powershell.exe", "wscript.exe", "cscript.exe", "mshta.exe")
| project Timestamp, DeviceName, InitiatingProcessFileName, FileName, ProcessCommandLine

// Lateral Movement Detection
DeviceProcessEvents
| where Timestamp > ago(7d)
| where FileName in~ ("psexec.exe", "psexesvc.exe", "wmic.exe", "winrs.exe")
| project Timestamp, DeviceName, AccountName, FileName, ProcessCommandLine

// Persistence - Scheduled Tasks
DeviceProcessEvents
| where Timestamp > ago(7d)
| where FileName =~ "schtasks.exe"
| where ProcessCommandLine has "/create"
| project Timestamp, DeviceName, AccountName, ProcessCommandLine</code></pre>
                </section>

                <!-- Response Actions -->
                <section class="content-section">
                    <h2><i class="fas fa-bolt"></i> Response Actions</h2>
                    <div class="card-grid">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon red"><i class="fas fa-network-wired"></i></div>
                                <div><div class="card-title">Isolate Device</div></div>
                            </div>
                            <div class="card-body">
                                Fully isolate device from network while maintaining MDE communication. Use for active threats to prevent lateral movement. Can select Full or Selective isolation.
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon orange"><i class="fas fa-user-lock"></i></div>
                                <div><div class="card-title">Restrict App Execution</div></div>
                            </div>
                            <div class="card-body">
                                Prevent non-Microsoft-signed applications from running. Useful when investigating potentially compromised devices to prevent further malware execution.
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon purple"><i class="fas fa-search"></i></div>
                                <div><div class="card-title">Run AV Scan</div></div>
                            </div>
                            <div class="card-body">
                                Initiate full or quick Defender Antivirus scan remotely. Useful after containment to ensure no remaining malware before releasing device.
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon cyan"><i class="fas fa-file-archive"></i></div>
                                <div><div class="card-title">Collect Investigation Package</div></div>
                            </div>
                            <div class="card-body">
                                Collect forensic data including running processes, scheduled tasks, network config, drivers, services, event logs, and Defender data.
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Alert Tuning Quick Reference -->
                <section class="content-section">
                    <h2><i class="fas fa-shield-alt"></i> Attack Surface Reduction Rules</h2>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Rule</th>
                                    <th>Protection</th>
                                    <th>Recommendation</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Block Office apps from creating child processes</strong></td>
                                    <td>Prevents macro malware execution</td>
                                    <td><span class="badge badge-critical">Enable</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Block credential stealing from LSASS</strong></td>
                                    <td>Protects against Mimikatz-style attacks</td>
                                    <td><span class="badge badge-critical">Enable</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Block executable content from email</strong></td>
                                    <td>Prevents email-based malware delivery</td>
                                    <td><span class="badge badge-critical">Enable</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Block JavaScript/VBScript launching downloads</strong></td>
                                    <td>Stops script-based downloaders</td>
                                    <td><span class="badge badge-high">Enable</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Block Office apps from creating executable content</strong></td>
                                    <td>Prevents macro dropper activity</td>
                                    <td><span class="badge badge-high">Enable</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Use advanced protection against ransomware</strong></td>
                                    <td>Behavioral ransomware protection</td>
                                    <td><span class="badge badge-critical">Enable</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Block process creations from WMI/PSExec</strong></td>
                                    <td>Prevents lateral movement tools</td>
                                    <td><span class="badge badge-high">Enable</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p class="mt-2"><strong>Tip:</strong> Start with Audit mode for 2 weeks to identify potential business impact before enabling Block mode.</p>
                </section>

                <!-- Documentation Navigation -->
                <section class="content-section">
                    <h2><i class="fas fa-book"></i> Documentation Sections</h2>
                    <div class="card-grid">
                        <div class="platform-card">
                            <div class="platform-card-header mde">
                                <h3>KQL Hunting</h3>
                                <span>Advanced Threat Hunting</span>
                            </div>
                            <div class="platform-card-body">
                                <ul>
                                    <li>Query syntax reference</li>
                                    <li>Table schemas</li>
                                    <li>Production hunting queries</li>
                                    <li>Cross-product hunting</li>
                                </ul>
                                <a href="kql-hunting.html" class="btn btn-primary"><i class="fas fa-arrow-right"></i> KQL Guide</a>
                            </div>
                        </div>

                        <div class="platform-card">
                            <div class="platform-card-header mde">
                                <h3>KQL Hunting</h3>
                                <span>Detection Engineering</span>
                            </div>
                            <div class="platform-card-body">
                                <ul>
                                    <li>Rule creation workflow</li>
                                    <li>Alert configuration</li>
                                    <li>Response actions</li>
                                    <li>MITRE ATT&CK mapping</li>
                                </ul>
                                <a href="kql-hunting.html" class="btn btn-primary"><i class="fas fa-arrow-right"></i> KQL Hunting</a>
                            </div>
                        </div>

                        <div class="platform-card">
                            <div class="platform-card-header mde">
                                <h3>Response Actions</h3>
                                <span>Remote Forensics</span>
                            </div>
                            <div class="platform-card-body">
                                <ul>
                                    <li>Command reference</li>
                                    <li>Evidence collection</li>
                                    <li>Remediation scripts</li>
                                    <li>Advanced operations</li>
                                </ul>
                                <a href="response-actions.html" class="btn btn-primary"><i class="fas fa-arrow-right"></i> Response Actions</a>
                            </div>
                        </div>
                    </div>
                </section>

            </main>
        </div>
    </div>
</body>
</html>
