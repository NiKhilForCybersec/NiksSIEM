<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Defender for Endpoint | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Microsoft Defender</div>
                    <a href="index.html" class="nav-link active"><i class="fas fa-home"></i> Overview</a>
                    <a href="onboarding-windows.html" class="nav-link"><i class="fab fa-windows"></i> Windows Onboarding</a>
                    <a href="onboarding-linux.html" class="nav-link"><i class="fab fa-linux"></i> Linux Onboarding</a>
                    <a href="onboarding-macos.html" class="nav-link"><i class="fab fa-apple"></i> macOS Onboarding</a>
                    <a href="kql-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> KQL Hunting</a>
                    <a href="alert-tuning.html" class="nav-link"><i class="fas fa-sliders-h"></i> Alert Tuning</a>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-bolt"></i> Response Actions</a>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-bug"></i> Troubleshooting</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Related Platforms</div>
                    <a href="../sentinel/index.html" class="nav-link"><i class="fab fa-microsoft"></i> Microsoft Sentinel</a>
                    <a href="../cortex/index.html" class="nav-link"><i class="fas fa-crosshairs"></i> Cortex XDR</a>
                    <a href="../crowdstrike/index.html" class="nav-link"><i class="fas fa-crow"></i> CrowdStrike</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <span class="current">Microsoft Defender for Endpoint</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fab fa-microsoft"></i> Microsoft Defender for Endpoint (MDE)</h1>
                <p class="lead">Microsoft Defender for Endpoint is Microsoft's enterprise EDR solution. This guide explains what MDE does, how it fits into the Microsoft security stack, and key operational concepts for SOC analysts.</p>

                <!-- What is MDE - CLEAR EXPLANATION -->
                <h2><i class="fas fa-question-circle"></i> What is MDE?</h2>
                
                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-lightbulb"></i> MDE in One Sentence</h4>
                    <p><strong>Microsoft Defender for Endpoint (MDE)</strong> is Microsoft's cloud-powered EDR that provides endpoint protection, detection, investigation, and response - all managed from the Microsoft 365 Defender portal.</p>
                </div>

                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-sitemap"></i> Where MDE Fits in Microsoft Security Stack</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 16px;">
                        <div style="background: #1c3a5e; padding: 16px; border-radius: 8px; text-align: center;">
                            <div style="color: #58a6ff; font-weight: 600;"><i class="fas fa-desktop"></i> MDE</div>
                            <div style="color: #8b949e; font-size: 0.8rem;">Endpoints</div>
                        </div>
                        <div style="background: #1c3a5e; padding: 16px; border-radius: 8px; text-align: center;">
                            <div style="color: #58a6ff; font-weight: 600;"><i class="fas fa-user-shield"></i> MDI</div>
                            <div style="color: #8b949e; font-size: 0.8rem;">Identity (AD)</div>
                        </div>
                        <div style="background: #1c3a5e; padding: 16px; border-radius: 8px; text-align: center;">
                            <div style="color: #58a6ff; font-weight: 600;"><i class="fas fa-envelope"></i> MDO</div>
                            <div style="color: #8b949e; font-size: 0.8rem;">Email/Office</div>
                        </div>
                        <div style="background: #1c3a5e; padding: 16px; border-radius: 8px; text-align: center;">
                            <div style="color: #58a6ff; font-weight: 600;"><i class="fas fa-cloud"></i> MDA</div>
                            <div style="color: #8b949e; font-size: 0.8rem;">Cloud Apps</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 12px 0; color: #8b949e;">↓ All feed into ↓</div>
                    <div style="background: #1a4d2e; padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="color: #3fb950; font-weight: 600;"><i class="fas fa-shield-alt"></i> Microsoft 365 Defender (XDR)</div>
                        <div style="color: #8b949e; font-size: 0.85rem;">Unified incident view across all Defender products</div>
                    </div>
                    <div style="text-align: center; margin: 12px 0; color: #8b949e;">↓ Optionally sends to ↓</div>
                    <div style="background: #3d2a5e; padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="color: #a371f7; font-weight: 600;"><i class="fas fa-database"></i> Microsoft Sentinel (SIEM)</div>
                        <div style="color: #8b949e; font-size: 0.85rem;">Long-term retention, correlation with non-Microsoft data</div>
                    </div>
                </div>

                <!-- Core Capabilities with CLEAR explanations -->
                <h2><i class="fas fa-cubes"></i> Core Capabilities</h2>

                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Capability</th>
                                <th>What It Does</th>
                                <th>Real-World Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Attack Surface Reduction (ASR)</strong></td>
                                <td>Rules that block risky behaviors before they execute</td>
                                <td>Block Office apps from creating child processes (stops macro malware)</td>
                            </tr>
                            <tr>
                                <td><strong>Next-Gen Antivirus</strong></td>
                                <td>Cloud-powered AV with behavioral analysis</td>
                                <td>Blocks known malware + suspicious behaviors even for unknown files</td>
                            </tr>
                            <tr>
                                <td><strong>EDR (Endpoint Detection & Response)</strong></td>
                                <td>Records endpoint activity for detection and investigation</td>
                                <td>See process tree showing how ransomware spread from initial email</td>
                            </tr>
                            <tr>
                                <td><strong>Automated Investigation</strong></td>
                                <td>AI-driven investigation and remediation of alerts</td>
                                <td>Automatically quarantines malicious file and checks for spread</td>
                            </tr>
                            <tr>
                                <td><strong>Live Response</strong></td>
                                <td>Remote shell access to endpoints for investigation</td>
                                <td>Run commands, collect files, analyze running processes remotely</td>
                            </tr>
                            <tr>
                                <td><strong>Threat & Vulnerability Management</strong></td>
                                <td>Identifies software vulnerabilities and misconfigurations</td>
                                <td>Shows "Chrome is 3 versions behind, CVE-2024-XXXX affects 500 devices"</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- How MDE Works -->
                <h2><i class="fas fa-cogs"></i> How MDE Works (Data Flow)</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title">MDE Data Flow - From Endpoint to Alert</div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-top: 16px; text-align: center;">
                        <div style="background: #1c3a5e; padding: 12px; border-radius: 6px;">
                            <div style="color: #58a6ff; font-weight: 600; font-size: 0.9rem;">1. Sensor</div>
                            <div style="color: #8b949e; font-size: 0.75rem;">Built into Windows, deployed on Mac/Linux</div>
                        </div>
                        <div style="background: #1a4d2e; padding: 12px; border-radius: 6px;">
                            <div style="color: #3fb950; font-weight: 600; font-size: 0.9rem;">2. Collect</div>
                            <div style="color: #8b949e; font-size: 0.75rem;">Process, file, network, registry events</div>
                        </div>
                        <div style="background: #4d3a0d; padding: 12px; border-radius: 6px;">
                            <div style="color: #d29922; font-weight: 600; font-size: 0.9rem;">3. Cloud</div>
                            <div style="color: #8b949e; font-size: 0.75rem;">Data sent to Microsoft cloud</div>
                        </div>
                        <div style="background: #3d2a5e; padding: 12px; border-radius: 6px;">
                            <div style="color: #a371f7; font-weight: 600; font-size: 0.9rem;">4. Analyze</div>
                            <div style="color: #8b949e; font-size: 0.75rem;">ML models + threat intel</div>
                        </div>
                        <div style="background: #4d1a1a; padding: 12px; border-radius: 6px;">
                            <div style="color: #f85149; font-weight: 600; font-size: 0.9rem;">5. Alert</div>
                            <div style="color: #8b949e; font-size: 0.75rem;">Incidents in M365 Defender portal</div>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> Key Point: MDE Sensor on Windows</h4>
                    <p>On Windows 10/11 and Server 2019+, the MDE sensor is <strong>built into the operating system</strong>. You don't install a separate agent - you "onboard" the device by configuring it to communicate with your tenant.</p>
                    <p>On older Windows (Server 2016, 2012 R2), macOS, and Linux, you install the MDE agent package.</p>
                </div>

                <!-- MDE vs Other EDRs -->
                <h2><i class="fas fa-balance-scale"></i> MDE vs Other EDR Products</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Aspect</th>
                                <th>MDE</th>
                                <th>CrowdStrike</th>
                                <th>Cortex XDR</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Deployment</strong></td>
                                <td>Built into Windows; agent for Mac/Linux</td>
                                <td>Lightweight agent on all platforms</td>
                                <td>Cortex agent on all platforms</td>
                            </tr>
                            <tr>
                                <td><strong>Query Language</strong></td>
                                <td>KQL (Kusto Query Language)</td>
                                <td>Falcon Query Language (SQL-like)</td>
                                <td>XQL</td>
                            </tr>
                            <tr>
                                <td><strong>Best Integration</strong></td>
                                <td>Microsoft 365, Sentinel, Entra ID</td>
                                <td>Vendor-agnostic, SIEM integrations</td>
                                <td>Palo Alto NGFW, XSIAM</td>
                            </tr>
                            <tr>
                                <td><strong>Ideal For</strong></td>
                                <td>Microsoft-centric environments</td>
                                <td>Multi-vendor, any environment</td>
                                <td>Palo Alto ecosystem shops</td>
                            </tr>
                            <tr>
                                <td><strong>Pricing</strong></td>
                                <td>Per user (often bundled in M365 E5)</td>
                                <td>Per endpoint</td>
                                <td>Per endpoint</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Licensing -->
                <h2><i class="fas fa-key"></i> Licensing - What Gets You What</h2>
                
                <div class="comparison-grid">
                    <div class="comparison-item" style="border-top: 4px solid #58a6ff;">
                        <div class="comparison-item-header">
                            <div class="comparison-item-title">MDE Plan 1</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> Next-Gen Antivirus</li>
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> Attack Surface Reduction</li>
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> Device Control</li>
                            <li><i class="fas fa-times" style="color: #f85149;"></i> EDR capabilities</li>
                            <li><i class="fas fa-times" style="color: #f85149;"></i> Advanced Hunting</li>
                            <li><i class="fas fa-times" style="color: #f85149;"></i> Automated Investigation</li>
                        </ul>
                        <p style="color: #8b949e; padding: 0 16px; font-size: 0.85rem;">Included in: M365 E3, Business Premium</p>
                    </div>
                    <div class="comparison-item" style="border-top: 4px solid #3fb950;">
                        <div class="comparison-item-header">
                            <div class="comparison-item-title">MDE Plan 2 (Full EDR)</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> Everything in Plan 1</li>
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> EDR (detection, investigation)</li>
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> Advanced Hunting (KQL)</li>
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> Automated Investigation</li>
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> Live Response</li>
                            <li><i class="fas fa-check" style="color: #3fb950;"></i> Threat & Vulnerability Mgmt</li>
                        </ul>
                        <p style="color: #8b949e; padding: 0 16px; font-size: 0.85rem;">Included in: M365 E5, E5 Security</p>
                    </div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: What is Microsoft Defender for Endpoint and how does it differ from Windows Defender?</button>
                        <div class="qa-answer">
                            <p><strong>Clear distinction:</strong></p>
                            <ul>
                                <li><strong>Windows Defender Antivirus:</strong> The free, built-in antivirus in Windows. Basic signature-based + some behavioral protection. No central management, no EDR.</li>
                                <li><strong>Microsoft Defender for Endpoint (MDE):</strong> Enterprise EDR platform. Uses the same underlying antivirus engine BUT adds cloud-powered detection, EDR telemetry, advanced hunting, automated investigation, central management, and integration with the Microsoft security ecosystem.</li>
                            </ul>
                            <p><strong>Analogy:</strong> Windows Defender Antivirus is like having a security guard at your door. MDE is like having that guard plus security cameras, a central monitoring station, incident response team, and forensic investigators - all connected to a global threat intelligence network.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How do you onboard devices to MDE?</button>
                        <div class="qa-answer">
                            <p><strong>Onboarding methods by platform:</strong></p>
                            <p><strong>Windows 10/11/Server 2019+:</strong></p>
                            <ul>
                                <li>Intune (MDM) - Preferred for managed devices</li>
                                <li>Group Policy - For domain-joined devices</li>
                                <li>SCCM/ConfigMgr - For existing SCCM environments</li>
                                <li>Local script - For testing/small deployments</li>
                            </ul>
                            <p><strong>Windows Server 2016/2012 R2:</strong></p>
                            <ul>
                                <li>Requires installing the MDE agent (MMA-based or unified agent)</li>
                            </ul>
                            <p><strong>Linux/macOS:</strong></p>
                            <ul>
                                <li>Install the MDE agent package + run onboarding script</li>
                            </ul>
                            <p><strong>What onboarding actually does:</strong> Configures the device to send telemetry to your specific tenant. The device gets your tenant ID, the data channel URL, and starts sending events to your MDE instance.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: What is Advanced Hunting in MDE?</button>
                        <div class="qa-answer">
                            <p><strong>Advanced Hunting</strong> is MDE's threat hunting interface where you write KQL queries against 30 days of endpoint telemetry.</p>
                            <p><strong>What data is available:</strong></p>
                            <ul>
                                <li><strong>DeviceProcessEvents:</strong> Process executions (command lines, parent process, user)</li>
                                <li><strong>DeviceNetworkEvents:</strong> Network connections (IPs, ports, URLs)</li>
                                <li><strong>DeviceFileEvents:</strong> File operations (create, modify, delete)</li>
                                <li><strong>DeviceRegistryEvents:</strong> Registry changes</li>
                                <li><strong>DeviceLogonEvents:</strong> User logins</li>
                                <li><strong>DeviceImageLoadEvents:</strong> DLL loading</li>
                            </ul>
                            <p><strong>Example query - Find encoded PowerShell:</strong></p>
                            <pre style="background: #161b22; padding: 12px; border-radius: 6px; overflow-x: auto;">DeviceProcessEvents
| where FileName == "powershell.exe"
| where ProcessCommandLine has_any ("-enc", "-encodedcommand", "FromBase64")
| project Timestamp, DeviceName, AccountName, ProcessCommandLine</pre>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How does MDE integrate with Microsoft Sentinel?</button>
                        <div class="qa-answer">
                            <p><strong>Integration path:</strong></p>
                            <ol>
                                <li><strong>M365 Defender Connector:</strong> In Sentinel, enable the Microsoft 365 Defender connector</li>
                                <li><strong>Data flows:</strong> MDE alerts and raw events can be sent to Sentinel</li>
                                <li><strong>Tables created:</strong> DeviceProcessEvents, DeviceNetworkEvents, SecurityAlert, etc.</li>
                            </ol>
                            <p><strong>Why integrate with Sentinel:</strong></p>
                            <ul>
                                <li><strong>Longer retention:</strong> MDE keeps 30 days; Sentinel can keep years</li>
                                <li><strong>Correlation:</strong> Combine endpoint data with firewall, cloud, custom logs</li>
                                <li><strong>Single pane:</strong> See MDE alerts alongside all other security alerts</li>
                                <li><strong>Automation:</strong> Trigger Logic Apps playbooks from MDE alerts</li>
                            </ul>
                            <p><strong>Important:</strong> Raw data ingestion to Sentinel costs money (per GB). Many orgs only send alerts + incidents, not raw telemetry.</p>
                        </div>
                    </div>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
