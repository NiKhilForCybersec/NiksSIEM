<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDE Fundamentals | Microsoft Defender for Endpoint</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .config-section { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .code-block { background: #0d1117; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 12px 0; font-family: 'Fira Code', monospace; font-size: 0.85rem; overflow-x: auto; white-space: pre; }
        .console-path { background: #0d1117; padding: 8px 12px; border-radius: 4px; font-family: monospace; font-size: 0.85rem; color: #0078d4; margin: 8px 0; display: inline-block; }
    </style>
</head>
<body>
    <div class="app-container">
                                        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">MDE Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Deployment</div>
                    <a href="onboarding-windows.html" class="nav-link"><i class="fab fa-windows"></i> Windows Onboarding</a>
                    <a href="onboarding-macos.html" class="nav-link"><i class="fab fa-apple"></i> macOS Onboarding</a>
                    <a href="onboarding-linux.html" class="nav-link"><i class="fab fa-linux"></i> Linux Onboarding</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Hunting</div>
                    <a href="kql-hunting.html" class="nav-link"><i class="fas fa-search"></i> KQL Hunting Queries</a>
                    <a href="alert-tuning.html" class="nav-link"><i class="fas fa-sliders-h"></i> Alert Tuning</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Response</div>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-hand-paper"></i> Response Actions</a>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-wrench"></i> Troubleshooting</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">MDE</a><span class="separator">/</span>
                    <span class="current">Fundamentals</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-shield-alt"></i> MDE Fundamentals</h1>
                <p class="lead">Microsoft Defender for Endpoint (MDE) provides enterprise endpoint security with threat detection, investigation, and response capabilities. Master the fundamentals for effective security operations.</p>

                <!-- MDE Overview -->
                <h2><i class="fas fa-info-circle"></i> What is MDE?</h2>
                <div class="config-section">
                    <p>Microsoft Defender for Endpoint is a comprehensive endpoint security platform that includes:</p>
                    <ul style="color: #8b949e;">
                        <li><strong>Endpoint Detection and Response (EDR):</strong> Detect and investigate threats</li>
                        <li><strong>Next-Generation Protection:</strong> AI-powered antimalware</li>
                        <li><strong>Attack Surface Reduction:</strong> Proactive hardening</li>
                        <li><strong>Automated Investigation:</strong> AI-assisted incident response</li>
                        <li><strong>Threat and Vulnerability Management:</strong> Risk-based vulnerability prioritization</li>
                    </ul>

                    <p><span class="console-path">Portal: security.microsoft.com</span></p>
                </div>

                <!-- Portal Navigation -->
                <h2><i class="fas fa-compass"></i> Portal Navigation</h2>
                <div class="config-section">
                    <div class="code-block">Microsoft 365 Defender Portal Structure:

Home
├── Incidents & Alerts
│   ├── Incidents
│   ├── Alerts
│   └── Alert queue
│
├── Hunting
│   ├── Advanced hunting
│   └── Custom detection rules
│
├── Actions & submissions
│   ├── Action center
│   └── Submissions
│
├── Assets
│   ├── Devices
│   └── Identities
│
├── Threat intelligence
│   └── Threat analytics
│
├── Reports
│   ├── Security report
│   └── Device health
│
└── Settings
    └── Endpoints</div>
                </div>

                <!-- Device Inventory -->
                <h2><i class="fas fa-desktop"></i> Device Inventory</h2>
                <div class="config-section">
                    <p><span class="console-path">Assets → Devices</span></p>

                    <h4>Device Information</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Field</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Device name</strong></td><td>Hostname of the device</td></tr>
                            <tr><td><strong>Risk level</strong></td><td>None, Low, Medium, High</td></tr>
                            <tr><td><strong>Exposure level</strong></td><td>Vulnerability exposure score</td></tr>
                            <tr><td><strong>Health state</strong></td><td>Active, Inactive, Misconfigured</td></tr>
                            <tr><td><strong>OS Platform</strong></td><td>Windows, macOS, Linux, iOS, Android</td></tr>
                            <tr><td><strong>Sensor health</strong></td><td>Sensor communication status</td></tr>
                            <tr><td><strong>Last seen</strong></td><td>Last communication with cloud</td></tr>
                        </tbody>
                    </table>

                    <h4>Device Page Tabs</h4>
                    <div class="code-block">Device Detail Tabs:

Overview:
- Device details, risk score
- Active alerts and incidents
- Logged on users

Alerts:
- All alerts for this device
- Timeline of security events

Timeline:
- Chronological activity events
- Process, file, network, registry activity

Security recommendations:
- Vulnerability findings
- Configuration recommendations

Software inventory:
- Installed applications
- Known vulnerabilities per app

Discovered vulnerabilities:
- CVEs affecting this device
- Severity and remediation</div>
                </div>

                <!-- Alert Queue -->
                <h2><i class="fas fa-bell"></i> Alert Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Incidents & Alerts → Alerts</span></p>

                    <h4>Alert Severity Levels</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Severity</th><th>Description</th><th>Response Time</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>High</strong></td>
                                <td>Active threat, immediate risk</td>
                                <td>Immediate</td>
                            </tr>
                            <tr>
                                <td><strong>Medium</strong></td>
                                <td>Suspicious activity, potential threat</td>
                                <td>Within hours</td>
                            </tr>
                            <tr>
                                <td><strong>Low</strong></td>
                                <td>Minor security issue</td>
                                <td>Within 24 hours</td>
                            </tr>
                            <tr>
                                <td><strong>Informational</strong></td>
                                <td>Security-relevant but benign</td>
                                <td>As time permits</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Alert Status</h4>
                    <div class="code-block">Alert Status Options:

New → Alert has not been triaged
In Progress → Analyst is investigating
Resolved → Investigation complete
  ├── True Positive - Alert
  ├── True Positive - Malicious
  ├── False Positive
  ├── Benign
  └── Other</div>

                    <h4>Alert Classification</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>True Positive - Alert:</strong> Real security event, appropriate alert</li>
                        <li><strong>True Positive - Malicious:</strong> Confirmed malicious activity</li>
                        <li><strong>False Positive:</strong> Alert was incorrect</li>
                        <li><strong>Benign:</strong> Activity is legitimate but triggered alert</li>
                    </ul>
                </div>

                <!-- Incidents -->
                <h2><i class="fas fa-folder-open"></i> Incidents</h2>
                <div class="config-section">
                    <p><span class="console-path">Incidents & Alerts → Incidents</span></p>
                    <p>Incidents automatically correlate related alerts across devices and time.</p>

                    <h4>Incident Components</h4>
                    <div class="code-block">Incident Structure:

Incident
├── Summary
│   - Attack story
│   - Affected entities
│   - Investigation status
│
├── Alerts (grouped)
│   - Related alerts
│   - Alert timeline
│
├── Assets
│   - Affected devices
│   - Affected users
│   - Affected mailboxes
│
├── Investigations
│   - Automated investigations
│   - Investigation actions
│
└── Evidence
    - Processes
    - Files
    - Network connections
    - Registry entries</div>

                    <h4>Attack Story</h4>
                    <p style="color: #8b949e;">The Attack Story tab provides a visual timeline of the attack with:</p>
                    <ul style="color: #8b949e;">
                        <li>Chronological view of alerts</li>
                        <li>Process tree visualization</li>
                        <li>Affected entities highlighted</li>
                        <li>MITRE ATT&CK mapping</li>
                    </ul>
                </div>

                <!-- Advanced Hunting -->
                <h2><i class="fas fa-search"></i> Advanced Hunting</h2>
                <div class="config-section">
                    <p><span class="console-path">Hunting → Advanced hunting</span></p>
                    <p>Query raw telemetry data using Kusto Query Language (KQL).</p>

                    <h4>Key Tables</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Table</th><th>Data</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>DeviceProcessEvents</strong></td>
                                <td>Process creation</td>
                                <td>Track executions</td>
                            </tr>
                            <tr>
                                <td><strong>DeviceNetworkEvents</strong></td>
                                <td>Network connections</td>
                                <td>C2, lateral movement</td>
                            </tr>
                            <tr>
                                <td><strong>DeviceFileEvents</strong></td>
                                <td>File operations</td>
                                <td>Malware, exfil</td>
                            </tr>
                            <tr>
                                <td><strong>DeviceRegistryEvents</strong></td>
                                <td>Registry changes</td>
                                <td>Persistence</td>
                            </tr>
                            <tr>
                                <td><strong>DeviceLogonEvents</strong></td>
                                <td>Logon activity</td>
                                <td>Authentication</td>
                            </tr>
                            <tr>
                                <td><strong>DeviceImageLoadEvents</strong></td>
                                <td>DLL loads</td>
                                <td>DLL hijacking</td>
                            </tr>
                            <tr>
                                <td><strong>AlertEvidence</strong></td>
                                <td>Alert artifacts</td>
                                <td>Alert investigation</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Basic Hunting Queries</h4>
                    <div class="code-block">// Find PowerShell executions
DeviceProcessEvents
| where FileName in~ ("powershell.exe", "pwsh.exe")
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| take 100

// Find network connections to external IPs
DeviceNetworkEvents
| where RemoteIPType == "Public"
| summarize ConnectionCount = count() by DeviceName, RemoteIP
| top 10 by ConnectionCount

// Find file creations in temp folders
DeviceFileEvents
| where ActionType == "FileCreated"
| where FolderPath contains "\\Temp\\"
| project Timestamp, DeviceName, FileName, FolderPath</div>
                </div>

                <!-- Response Actions -->
                <h2><i class="fas fa-shield-alt"></i> Response Actions</h2>
                <div class="config-section">
                    <h4>Device Actions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Action</th><th>Description</th><th>Permissions</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Isolate device</strong></td>
                                <td>Block network except MDE</td>
                                <td>Active remediation</td>
                            </tr>
                            <tr>
                                <td><strong>Run antivirus scan</strong></td>
                                <td>Full or quick scan</td>
                                <td>Active remediation</td>
                            </tr>
                            <tr>
                                <td><strong>Collect investigation package</strong></td>
                                <td>Gather forensic data</td>
                                <td>Active remediation</td>
                            </tr>
                            <tr>
                                <td><strong>Initiate Live Response</strong></td>
                                <td>Remote shell access</td>
                                <td>Live response</td>
                            </tr>
                            <tr>
                                <td><strong>Restrict app execution</strong></td>
                                <td>Block non-Microsoft apps</td>
                                <td>Active remediation</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>File Actions</h4>
                    <div class="code-block">From alert or hunting results:

Stop and Quarantine File:
- Terminates process if running
- Quarantines file on device
- Blocks hash globally (optional)

Add Indicator:
- Block: Prevent execution
- Alert: Generate alert on execution
- Allow: Whitelist file

Download File:
- Download for analysis
- Available from File page</div>

                    <h4>Live Response</h4>
                    <div class="code-block">Live Response Commands:

Basic Commands:
- dir, cd, cls - Navigation
- fileinfo - File details
- processes - Running processes
- connections - Network connections
- scheduledtasks - Scheduled tasks

Advanced Commands (require additional permission):
- run - Execute scripts
- getfile - Download file from device
- putfile - Upload file to device
- remediate - Remove file
- library - Manage response scripts</div>
                </div>

                <!-- Custom Detection Rules -->
                <h2><i class="fas fa-cog"></i> Custom Detection Rules</h2>
                <div class="config-section">
                    <p><span class="console-path">Hunting → Custom detection rules</span></p>

                    <h4>Creating Custom Detections</h4>
                    <div class="code-block">Steps to Create Custom Detection:

1. Write KQL Query
   - Test in Advanced Hunting
   - Ensure it returns expected results
   - Optimize for performance

2. Create Detection Rule
   - Name and description
   - Severity level
   - MITRE ATT&CK mapping
   - Impacted entities (device, user, etc.)

3. Configure Alert Settings
   - Alert title format
   - Recommended actions
   - Category

4. Set Schedule
   - Frequency: Every 1, 3, 12, or 24 hours
   - Lookback period</div>

                    <h4>Example Custom Detection</h4>
                    <div class="code-block">// Custom Detection: PowerShell Encoded Command
DeviceProcessEvents
| where Timestamp > ago(1h)
| where FileName in~ ("powershell.exe", "pwsh.exe")
| where ProcessCommandLine has_any ("-enc", "-EncodedCommand")
| project 
    Timestamp,
    DeviceName,
    AccountName,
    ProcessCommandLine,
    InitiatingProcessFileName

Rule Settings:
- Name: PowerShell Encoded Command Execution
- Severity: Medium
- MITRE: T1059.001
- Frequency: Every 1 hour
- Entity: DeviceName, AccountName</div>
                </div>

                <!-- Indicators -->
                <h2><i class="fas fa-database"></i> Indicators of Compromise</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Endpoints → Indicators</span></p>

                    <h4>Indicator Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Actions</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>File hash</strong></td>
                                <td>Allow, Alert, Block</td>
                                <td>Known malware/good files</td>
                            </tr>
                            <tr>
                                <td><strong>IP address</strong></td>
                                <td>Allow, Alert, Block</td>
                                <td>C2 servers, safe IPs</td>
                            </tr>
                            <tr>
                                <td><strong>URL/Domain</strong></td>
                                <td>Allow, Alert, Block</td>
                                <td>Malicious sites</td>
                            </tr>
                            <tr>
                                <td><strong>Certificate</strong></td>
                                <td>Allow, Alert, Block</td>
                                <td>Code signing certs</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between alerts and incidents in MDE?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Alerts:</strong> Individual security detections, single events</li>
                                <li><strong>Incidents:</strong> Correlated groups of related alerts across devices/time</li>
                            </ul>
                            <p style="margin-top: 12px;">MDE automatically groups alerts into incidents using AI correlation. This helps analysts see the full attack picture rather than isolated events.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does device isolation work in MDE?</button>
                        <div class="qa-answer">
                            <ul>
                                <li>Blocks all network traffic except MDE cloud communication</li>
                                <li>Device can still send telemetry and receive commands</li>
                                <li>Prevents lateral movement and C2 communication</li>
                                <li>Can be released from portal once threat is contained</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What data is available in Advanced Hunting?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Process events:</strong> Execution, command lines, parent-child</li>
                                <li><strong>Network events:</strong> Connections, DNS queries</li>
                                <li><strong>File events:</strong> Create, modify, delete, rename</li>
                                <li><strong>Registry events:</strong> Key and value changes</li>
                                <li><strong>Logon events:</strong> Authentication activity</li>
                                <li><strong>Alert data:</strong> Alert evidence and status</li>
                            </ul>
                            <p style="margin-top: 12px;">Data retention: 30 days by default</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>

                <!-- Attack Surface Reduction -->
                <h2><i class="fas fa-lock"></i> Attack Surface Reduction</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Endpoints → Attack surface reduction</span></p>

                    <h4>ASR Rules</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Rule</th><th>Protection</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Block Office apps from creating child processes</td>
                                <td>Macro attacks</td>
                            </tr>
                            <tr>
                                <td>Block Office apps from creating executable content</td>
                                <td>Malware droppers</td>
                            </tr>
                            <tr>
                                <td>Block credential stealing from LSASS</td>
                                <td>Credential dumping</td>
                            </tr>
                            <tr>
                                <td>Block executable content from email client</td>
                                <td>Email-based attacks</td>
                            </tr>
                            <tr>
                                <td>Block JavaScript/VBScript from launching downloads</td>
                                <td>Script-based downloads</td>
                            </tr>
                            <tr>
                                <td>Block persistence through WMI event subscription</td>
                                <td>WMI persistence</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>ASR Rule Modes</h4>
                    <div class="code-block">Modes:
- Not configured: Rule disabled
- Block: Rule enforced, activity blocked
- Audit: Rule logs but doesn't block
- Warn: User prompted, can proceed

Recommended Approach:
1. Start in Audit mode
2. Monitor for false positives
3. Add exclusions if needed
4. Enable Block mode</div>
                </div>

                <!-- Automated Investigation -->
                <h2><i class="fas fa-robot"></i> Automated Investigation and Response</h2>
                <div class="config-section">
                    <p>MDE can automatically investigate and remediate threats.</p>
                    <p><span class="console-path">Settings → Endpoints → Automation</span></p>

                    <h4>Automation Levels</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Level</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Full</strong></td>
                                <td>Automated remediation without approval</td>
                            </tr>
                            <tr>
                                <td><strong>Semi - require approval for core folders</strong></td>
                                <td>Auto-remediate except for core Windows folders</td>
                            </tr>
                            <tr>
                                <td><strong>Semi - require approval for any remediation</strong></td>
                                <td>All remediation requires approval</td>
                            </tr>
                            <tr>
                                <td><strong>No automated response</strong></td>
                                <td>Investigation only, no remediation</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Automated Investigation Flow</h4>
                    <div class="code-block">Investigation Flow:

1. Alert Triggers Investigation
   └─ High/medium alerts can trigger auto-investigation

2. Evidence Collection
   └─ Gather related processes, files, network activity

3. Analysis
   └─ Determine if threat is confirmed
   └─ Identify affected entities

4. Remediation Decision
   └─ Based on automation level
   └─ May require approval

5. Actions Taken
   └─ Stop and quarantine files
   └─ Kill processes
   └─ Remove persistence

6. Results
   └─ Investigation summary
   └─ Actions taken
   └─ Remaining items</div>
                </div>

                <!-- Threat Analytics -->
                <h2><i class="fas fa-chart-line"></i> Threat Analytics</h2>
                <div class="config-section">
                    <p><span class="console-path">Threat intelligence → Threat analytics</span></p>
                    <p>Stay informed about active threats and your exposure.</p>

                    <h4>Threat Analytics Components</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Analyst report:</strong> Threat description and analysis</li>
                        <li><strong>Exposure:</strong> Your organization's vulnerability</li>
                        <li><strong>Mitigations:</strong> Recommended actions</li>
                        <li><strong>Detection status:</strong> Alerts related to this threat</li>
                    </ul>

                    <h4>Using Threat Analytics</h4>
                    <div class="code-block">For each threat report:

1. Review Summary
   - What is the threat?
   - Who is targeted?
   - What techniques are used?

2. Check Exposure
   - Are vulnerable devices in your environment?
   - What's the severity?

3. Review Mitigations
   - What patches are needed?
   - What ASR rules help?
   - Configuration recommendations

4. Hunt for Indicators
   - Use provided KQL queries
   - Search for related IOCs
   - Check for unreported activity</div>
                </div>

                <!-- Device Groups -->
                <h2><i class="fas fa-sitemap"></i> Device Groups</h2>
                <div class="config-section">
                    <p><span class="console-path">Settings → Endpoints → Device groups</span></p>

                    <h4>Device Group Configuration</h4>
                    <div class="code-block">Device Group Settings:

Matching Criteria:
- Device name contains/starts with
- Domain
- Tag
- OS
- Device value (High, Normal, Low)

Automation Level:
- Set per group
- Different automation for servers vs workstations

RBAC:
- Assign user groups
- Control access to specific device groups

Example Groups:
├─ Servers - Production
│   Criteria: Name starts with "SRV"
│   Automation: Semi
│
├─ Workstations - Standard
│   Criteria: OS = Windows 10/11
│   Automation: Full
│
├─ High Value Assets
│   Tag: HVA
│   Automation: Semi
│
└─ Development
    Criteria: Domain = dev.company.com
    Automation: No auto response</div>
                </div>

                <!-- MDE Tables Reference -->
                <h2><i class="fas fa-table"></i> Advanced Hunting Tables Reference</h2>
                <div class="config-section">
                    <h4>DeviceProcessEvents Schema</h4>
                    <div class="code-block">Key Columns:
- Timestamp: Event time
- DeviceId: Unique device identifier
- DeviceName: Device hostname
- ActionType: ProcessCreated, ProcessTerminated
- FileName: Process executable name
- FolderPath: Process executable path
- SHA256: File hash
- ProcessId: Process ID
- ProcessCommandLine: Full command line
- InitiatingProcessFileName: Parent process name
- InitiatingProcessCommandLine: Parent command line
- AccountName: User who ran process
- AccountDomain: User domain</div>

                    <h4>DeviceNetworkEvents Schema</h4>
                    <div class="code-block">Key Columns:
- Timestamp: Event time
- DeviceName: Device hostname
- ActionType: ConnectionSuccess, ConnectionFailed, etc.
- RemoteIP: Destination IP
- RemotePort: Destination port
- RemoteUrl: Full URL if applicable
- LocalIP: Source IP
- LocalPort: Source port
- Protocol: TCP, UDP
- InitiatingProcessFileName: Process making connection
- InitiatingProcessCommandLine: Process command line</div>

                    <h4>DeviceFileEvents Schema</h4>
                    <div class="code-block">Key Columns:
- Timestamp: Event time
- DeviceName: Device hostname
- ActionType: FileCreated, FileModified, FileDeleted, FileRenamed
- FileName: File name
- FolderPath: File path
- SHA256: File hash (for created files)
- FileSize: Size in bytes
- InitiatingProcessFileName: Process that performed action
- InitiatingProcessAccountName: User context</div>
                </div>

                <!-- Common Investigation Queries -->
                <h2><i class="fas fa-search"></i> Common Investigation Queries</h2>
                <div class="config-section">
                    <h4>User Activity Investigation</h4>
                    <div class="code-block">// All activity for a user
let TargetUser = "john.doe";
union DeviceProcessEvents, DeviceNetworkEvents, DeviceFileEvents, DeviceLogonEvents
| where AccountName =~ TargetUser
| project Timestamp, DeviceName, ActionType, 
          FileName, ProcessCommandLine, RemoteIP
| order by Timestamp desc
| take 500</div>

                    <h4>Device Investigation</h4>
                    <div class="code-block">// Recent activity on device
let TargetDevice = "WORKSTATION01";
DeviceProcessEvents
| where DeviceName =~ TargetDevice
| where Timestamp > ago(24h)
| project Timestamp, FileName, ProcessCommandLine, AccountName
| order by Timestamp desc</div>

                    <h4>Hash Search</h4>
                    <div class="code-block">// Find all executions of a file hash
let TargetHash = "abc123...";
DeviceProcessEvents
| where SHA256 == TargetHash
| project Timestamp, DeviceName, FileName, ProcessCommandLine, AccountName</div>
                </div>

                <!-- Additional Interview Questions -->
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does MDE integrate with Microsoft Sentinel?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Data connector:</strong> Stream MDE alerts and events to Sentinel</li>
                                <li><strong>Unified hunting:</strong> Query MDE data alongside other sources</li>
                                <li><strong>Automated response:</strong> Sentinel playbooks can trigger MDE actions</li>
                                <li><strong>Incident correlation:</strong> Combine MDE alerts with other security data</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is Secure Score in MDE?</button>
                        <div class="qa-answer">
                            <p>Microsoft Secure Score measures your security posture based on:</p>
                            <ul>
                                <li>Configured security controls</li>
                                <li>Enabled protection features</li>
                                <li>Vulnerability remediation status</li>
                                <li>Recommendations implemented</li>
                            </ul>
                            <p style="margin-top: 12px;">Higher score = better security posture. Use improvement actions to increase score.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>
