<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Management | Microsoft Defender for Endpoint</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">MDE Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="fundamentals.html" class="nav-link"><i class="fas fa-book"></i> Fundamentals</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Deployment</div>
                    <a href="onboarding-windows.html" class="nav-link"><i class="fab fa-windows"></i> Windows Onboarding</a>
                    <a href="onboarding-macos.html" class="nav-link"><i class="fab fa-apple"></i> macOS Onboarding</a>
                    <a href="onboarding-linux.html" class="nav-link"><i class="fab fa-linux"></i> Linux Onboarding</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Hunting</div>
                    <a href="kql-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> KQL Hunting</a>
                    <a href="advanced-hunting.html" class="nav-link"><i class="fas fa-code"></i> Advanced Hunting</a>
                    <a href="alert-tuning.html" class="nav-link"><i class="fas fa-sliders-h"></i> Alert Tuning</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Response</div>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-bolt"></i> Response Actions</a>
                    <a href="incident-management.html" class="nav-link active"><i class="fas fa-clipboard-list"></i> Incident Management</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Administration</div>
                    <a href="troubleshooting.html" class="nav-link"><i class="fas fa-wrench"></i> Troubleshooting</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">MDE</a><span class="separator">/</span>
                    <span class="current">Incident Management</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-clipboard-list"></i> Incident Management</h1>
                <p class="lead">Master incident management in Microsoft Defender for Endpoint. Learn to triage alerts, investigate incidents, use the attack story, and manage the complete incident lifecycle.</p>

                <!-- Incident Overview -->
                <h2><i class="fas fa-info-circle"></i> Incident Overview</h2>
                <div class="config-section">
                    <p><span class="console-path">Microsoft 365 Defender → Incidents & alerts → Incidents</span></p>

                    <h4>Incident vs Alert</h4>
                    <div class="code-block">Microsoft Defender Hierarchy:

INCIDENT:
- Collection of related alerts
- Unified investigation view
- Attack story visualization
- Affects one or more entities

ALERT:
- Single detection event
- Part of an incident
- Mapped to MITRE ATT&CK
- Specific severity

AUTOMATIC CORRELATION:
- Same device
- Same user
- Same file hash
- Related processes
- Time proximity
- Attack chain relationship</div>

                    <h4>Severity Levels</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Severity</th><th>Description</th><th>Response Time</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>High</strong></td><td>APT, ransomware, credential theft</td><td>Immediate</td></tr>
                            <tr><td><strong>Medium</strong></td><td>Suspicious behavior, anomalies</td><td>Same day</td></tr>
                            <tr><td><strong>Low</strong></td><td>Minor threats, PUPs</td><td>24-48 hours</td></tr>
                            <tr><td><strong>Informational</strong></td><td>Low risk, awareness</td><td>As time permits</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Incident Queue -->
                <h2><i class="fas fa-list"></i> Incident Queue</h2>
                <div class="config-section">
                    <h4>Queue Columns</h4>
                    <div class="code-block">Incident Queue Fields:

IDENTIFICATION:
- Incident ID: Unique identifier
- Incident name: Auto-generated or custom
- Tags: Custom labels

CLASSIFICATION:
- Severity: High/Medium/Low/Info
- Status: New/In progress/Resolved
- Classification: True/False positive
- Determination: Specific classification

SCOPE:
- Alerts: Number of alerts
- Devices: Affected endpoints
- Users: Affected users
- Mailboxes: Affected mailboxes

ASSIGNMENT:
- Assigned to: Owner
- Investigation state: Automated state</div>

                    <h4>Filtering the Queue</h4>
                    <div class="code-block">Effective Filters:

PRIORITY TRIAGE:
- Severity = High
- Status = New
- Automated investigation state = Failed

BY SCOPE:
- Service source (MDE, MDI, MDO, MDA)
- Device groups
- User tags
- Alert categories

BY TIME:
- Last 24 hours
- Last 7 days
- Custom range

SORT OPTIONS:
- Severity (high first)
- Last updated
- Alert count
- Start time</div>
                </div>

                <!-- Attack Story -->
                <h2><i class="fas fa-book-open"></i> Attack Story</h2>
                <div class="config-section">
                    <p><span class="console-path">Incident → Attack story</span></p>

                    <h4>Understanding Attack Story</h4>
                    <div class="code-block">Attack Story Components:

TIMELINE VIEW:
- Chronological event sequence
- All related alerts and events
- Process tree per alert
- Evidence artifacts

GRAPH VIEW:
- Visual entity relationships
- Devices, users, files, processes
- Attack path visualization

EVIDENCE:
- Files (hashes, paths)
- Processes (command lines)
- Network connections
- Registry modifications
- User activities

MITRE ATT&CK MAPPING:
- Tactics identified
- Techniques detected
- Attack progression</div>

                    <h4>Investigation Using Attack Story</h4>
                    <div class="code-block">Attack Story Investigation:

1. REVIEW SUMMARY
   - What devices/users affected?
   - What's the highest severity alert?
   - What tactics are involved?

2. ANALYZE TIMELINE
   - What happened first? (Initial access)
   - What happened next? (Execution, persistence)
   - Current state? (Contained, active?)

3. EXAMINE PROCESS TREE
   - Root cause identification
   - Attack chain mapping
   - IOC extraction

4. CHECK EVIDENCE
   - File verdicts
   - Network destinations
   - Affected entities

5. SCOPE THE INCIDENT
   - Other affected devices?
   - Lateral movement?
   - Data access?</div>
                </div>

                <!-- Alert Investigation -->
                <h2><i class="fas fa-search"></i> Alert Investigation</h2>
                <div class="config-section">
                    <h4>Alert Details</h4>
                    <div class="code-block">Alert Page Information:

OVERVIEW:
- Alert title and description
- Severity and category
- MITRE ATT&CK techniques
- Detection source

PROCESS TREE:
- Visual process hierarchy
- Triggered alerts marked
- Expand for details
- Timeline view

EVIDENCE:
- Files: Name, path, hash, verdict
- Processes: Command line, parent
- Network: Connections, IPs
- Registry: Keys, values

RELATED:
- Related alerts
- Other incidents
- Similar alerts in environment</div>

                    <h4>Investigation Actions</h4>
                    <div class="code-block">From Alert Page:

INVESTIGATE DEVICE:
- Open device page
- View device timeline
- Check vulnerabilities

INVESTIGATE FILE:
- File details
- Prevalence
- Deep analysis
- Submit for analysis

INVESTIGATE USER:
- User page
- Sign-in activity
- Risk score

RESPONSE ACTIONS:
- Isolate device
- Run antivirus scan
- Collect investigation package
- Restrict app execution</div>
                </div>

                <!-- Incident Status -->
                <h2><i class="fas fa-tasks"></i> Status Management</h2>
                <div class="config-section">
                    <h4>Incident Lifecycle</h4>
                    <div class="code-block">Status Options:

ACTIVE:
- New: Unreviewed
- In progress: Under investigation

RESOLVED:
- True positive: Confirmed threat
- False positive: Not a real threat
- Informational: Expected activity
- Benign: Legitimate but flagged

CLASSIFICATION (for True Positive):
- Multi-stage attack (APT)
- Malicious user activity
- Compromised account
- Malware
- Phishing
- Unwanted software
- Other

DETERMINATION:
- Apt, Malware, Security testing
- Unwanted software, Other</div>

                    <h4>Resolution Workflow</h4>
                    <div class="code-block">Closing an Incident:

1. SET STATUS
   - Resolved

2. CHOOSE CLASSIFICATION
   - True positive / False positive
   - Informational / Benign

3. ADD DETERMINATION
   - Specific threat type
   - Detailed classification

4. ADD COMMENT
   - Investigation summary
   - Actions taken
   - Recommendations

5. ASSIGN RESOLUTION
   - Final owner
   - Completion time</div>
                </div>

                <!-- Automated Investigation -->
                <h2><i class="fas fa-robot"></i> Automated Investigation</h2>
                <div class="config-section">
                    <p><span class="console-path">Incident → Investigations tab</span></p>

                    <div class="code-block">Automated Investigation & Response (AIR):

WHAT IT DOES:
- Automatically investigates alerts
- Expands scope
- Collects evidence
- Recommends actions

INVESTIGATION STATES:
- Running: Investigation in progress
- Pending action: Waiting for approval
- No threats found: Benign
- Partially remediated: Some actions taken
- Failed: Investigation couldn't complete
- Remediated: All actions completed

REMEDIATION ACTIONS:
- Quarantine file
- Kill process
- Remove persistence
- Block URL
- Isolate device

REVIEW PENDING ACTIONS:
1. Go to Action Center
2. Review recommended actions
3. Approve or reject
4. Document decision</div>
                </div>

                <!-- KQL from Incidents -->
                <h2><i class="fas fa-code"></i> KQL Investigation</h2>
                <div class="config-section">
                    <div class="code-block">// Get all alerts for an incident
AlertInfo
| where IncidentId == "123456"
| project Timestamp, Title, Severity, Category, AttackTechniques

// Device timeline for incident
DeviceProcessEvents
| where DeviceId == "device-id-here"
| where Timestamp between (datetime(2024-01-01) .. datetime(2024-01-02))
| project Timestamp, FileName, ProcessCommandLine, InitiatingProcessFileName

// User activity during incident
IdentityLogonEvents
| where AccountUpn == "user@domain.com"
| where Timestamp > ago(7d)
| project Timestamp, LogonType, DeviceName, IPAddress, DestinationDeviceName

// Files related to incident
DeviceFileEvents
| where SHA256 == "suspicious-hash"
| project Timestamp, DeviceName, FileName, FolderPath, ActionType

// Network connections investigation
DeviceNetworkEvents
| where DeviceId == "device-id"
| where RemoteIP == "suspicious-ip"
| project Timestamp, InitiatingProcessFileName, RemoteIP, RemotePort</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you triage an incident in MDE?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Review summary:</strong> Severity, scope, affected entities</li>
                                <li><strong>Check attack story:</strong> Timeline, process tree, evidence</li>
                                <li><strong>Identify root cause:</strong> Initial access point</li>
                                <li><strong>Assess impact:</strong> Data accessed, lateral movement</li>
                                <li><strong>Review AIR:</strong> Automated findings and recommendations</li>
                                <li><strong>Respond:</strong> Contain, remediate, close</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between incident classification and determination?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Classification:</strong> Is it a real threat? (True positive, False positive, etc.)</li>
                                <li><strong>Determination:</strong> What type of threat? (Malware, APT, Phishing, etc.)</li>
                            </ul>
                            <p style="margin-top: 12px;">Classification answers "is this real?" while determination answers "what kind?"</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does automated investigation help SOC analysts?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Saves time:</strong> Automatically expands investigation scope</li>
                                <li><strong>Consistency:</strong> Same investigation steps every time</li>
                                <li><strong>Speed:</strong> Works 24/7, immediate response</li>
                                <li><strong>Recommendations:</strong> Suggests remediation actions</li>
                            </ul>
                            <p style="margin-top: 12px;">Analysts review AIR findings and approve/reject recommended actions.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>