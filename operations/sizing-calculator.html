<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sizing Calculator | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link active" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">SOC Operations Pages</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="audit-preparation.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Audit Preparation</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="cloud-security.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Cloud Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="compliance-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Compliance Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="containment-procedures.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Containment Procedures</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-source-priority.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Source Priority</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="detection-engineering.html" class="sidebar-nav-link">
                            <i class="fas fa-search"></i>
                            <span>Detection Engineering</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="escalation-matrix.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Escalation Matrix</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="forensics.html" class="sidebar-nav-link">
                            <i class="fas fa-microscope"></i>
                            <span>Forensics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="identity-security.html" class="sidebar-nav-link">
                            <i class="fas fa-user-shield"></i>
                            <span>Identity Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-classification.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Classification</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-response.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Response</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="ir-integration.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Ir Integration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="log-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Log Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="malware-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-virus"></i>
                            <span>Malware Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="metrics-kpis.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Metrics Kpis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="migration-guide.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Migration Guide</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="mitre-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-chess"></i>
                            <span>Mitre Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="network-security.html" class="sidebar-nav-link">
                            <i class="fas fa-network-wired"></i>
                            <span>Network Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="phishing-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Phishing Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="playbook-library.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Playbook Library</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="rbac-design.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Rbac Design</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="shift-handoff.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Shift Handoff</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="siem-project-planning.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Siem Project Planning</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="sizing-calculator.html" class="sidebar-nav-link active">
                            <i class="fas fa-file-alt"></i>
                            <span>Sizing Calculator</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-metrics.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Soc Metrics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-operations.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Soc Operations</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intelligence.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-handbook.html" class="sidebar-nav-link">
                            <i class="fas fa-filter"></i>
                            <span>Triage Handbook</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-methodology.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Triage Methodology</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="tuning-optimization.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Tuning Optimization</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="use-case-lifecycle.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Use Case Lifecycle</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="windows-events.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Windows Events</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">SOC Operations</a>
                    <span class="separator">/</span>
                    <span class="current">Sizing Calculator</span>
                </div>

                <div class="page-header">
                    <h1><i class="fas fa-calculator"></i> SIEM Sizing Calculator</h1>
                    <p class="lead">Capacity planning reference for SIEM deployments with data volume estimation and cost modeling</p>
                </div>
                <!-- Data Volume Estimation -->
                <section class="content-section">
                    <h2><i class="fas fa-database"></i> Data Volume Estimation</h2>
                    <p>Accurate sizing starts with understanding your log sources and their typical event rates.</p>
                    <h3>Common Data Sources - Volume Reference</h3>
                    <table class="sizing-table">
                        <thead>
                            <tr>
                                <th>Data Source</th>
                                <th>Events/Day (per unit)</th>
                                <th>Avg Size</th>
                                <th>GB/Day (1000 units)</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Windows Endpoint (Security Log)</strong></td>
                                <td>5,000 - 50,000</td>
                                <td>~800 bytes</td>
                                <td>4 - 40 GB</td>
                                <td>Varies heavily with audit policy</td>
                            </tr>
                            <tr>
                                <td><strong>Windows Server</strong></td>
                                <td>50,000 - 500,000</td>
                                <td>~1 KB</td>
                                <td>50 - 500 GB</td>
                                <td>DCs can be 10x higher</td>
                            </tr>
                            <tr>
                                <td><strong>Linux Server (Syslog)</strong></td>
                                <td>10,000 - 100,000</td>
                                <td>~500 bytes</td>
                                <td>5 - 50 GB</td>
                                <td>App servers vary widely</td>
                            </tr>
                            <tr>
                                <td><strong>Firewall (Palo Alto/Cisco)</strong></td>
                                <td>1M - 50M</td>
                                <td>~400 bytes</td>
                                <td>0.4 - 20 GB</td>
                                <td>Per firewall; traffic-dependent</td>
                            </tr>
                            <tr>
                                <td><strong>Web Proxy (Zscaler/Squid)</strong></td>
                                <td>500K - 5M</td>
                                <td>~600 bytes</td>
                                <td>0.3 - 3 GB</td>
                                <td>Per 1000 users</td>
                            </tr>
                            <tr>
                                <td><strong>Azure AD / Entra ID</strong></td>
                                <td>10,000 - 100,000</td>
                                <td>~1.5 KB</td>
                                <td>15 - 150 GB</td>
                                <td>Per 10,000 users</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft 365</strong></td>
                                <td>50,000 - 500,000</td>
                                <td>~1 KB</td>
                                <td>50 - 500 GB</td>
                                <td>Per 10,000 users</td>
                            </tr>
                            <tr>
                                <td><strong>AWS CloudTrail</strong></td>
                                <td>100,000 - 1M</td>
                                <td>~2 KB</td>
                                <td>0.2 - 2 GB</td>
                                <td>Per account; management events</td>
                            </tr>
                            <tr>
                                <td><strong>DNS Logs</strong></td>
                                <td>10M - 100M</td>
                                <td>~200 bytes</td>
                                <td>2 - 20 GB</td>
                                <td>Per 1000 users</td>
                            </tr>
                            <tr>
                                <td><strong>EDR (CrowdStrike/MDE)</strong></td>
                                <td>20,000 - 100,000</td>
                                <td>~1 KB</td>
                                <td>20 - 100 GB</td>
                                <td>Per 1000 endpoints</td>
                            </tr>
                            <tr>
                                <td><strong>VPN (Cisco AnyConnect)</strong></td>
                                <td>5,000 - 50,000</td>
                                <td>~500 bytes</td>
                                <td>2.5 - 25 GB</td>
                                <td>Per 1000 users</td>
                            </tr>
                            <tr>
                                <td><strong>Database Audit (SQL/Oracle)</strong></td>
                                <td>100,000 - 10M</td>
                                <td>~800 bytes</td>
                                <td>80 - 8000 GB</td>
                                <td>Highly variable; tune carefully</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="warning-note">
                        <h4><i class="fas fa-exclamation-triangle"></i> Important Considerations</h4>
                        <ul>
                            <li>Volumes can vary 10x based on audit policy verbosity</li>
                            <li>Peak hours may see 3-5x average volume</li>
                            <li>Security incidents can spike volume temporarily</li>
                            <li>Add 20% buffer for growth and variance</li>
                        </ul>
                    </div>
                </section>
                <!-- Quick Calculator -->
                <section class="content-section">
                    <h2><i class="fas fa-calculator"></i> Quick Volume Calculator</h2>
                    <div class="calc-section">
                        <h3><i class="fas fa-laptop"></i> Enter Your Environment</h3>
                        <div class="calc-grid">
                            <div class="input-group">
                                <label for="endpoints">Windows Endpoints</label>
                                <input type="number" id="endpoints" value="1000" min="0">
                            </div>
                            <div class="input-group">
                                <label for="servers">Windows Servers</label>
                                <input type="number" id="servers" value="100" min="0">
                            </div>
                            <div class="input-group">
                                <label for="linuxservers">Linux Servers</label>
                                <input type="number" id="linuxservers" value="50" min="0">
                            </div>
                            <div class="input-group">
                                <label for="firewalls">Firewalls</label>
                                <input type="number" id="firewalls" value="5" min="0">
                            </div>
                            <div class="input-group">
                                <label for="users">Total Users (for cloud services)</label>
                                <input type="number" id="users" value="5000" min="0">
                            </div>
                            <div class="input-group">
                                <label for="retention">Retention Days</label>
                                <input type="number" id="retention" value="90" min="1">
                            </div>
                        </div>
                        <button class="btn-calculate" onclick="calculateVolume()">Calculate Estimate</button>
                    </div>
                    <div class="result-box" id="results">
                        <h4><i class="fas fa-chart-bar"></i> Estimated Volume</h4>
                        <div class="result-item">
                            <span>Daily Ingestion</span>
                            <span class="result-value" id="dailyGB">-- GB/day</span>
                        </div>
                        <div class="result-item">
                            <span>Monthly Ingestion</span>
                            <span class="result-value" id="monthlyGB">-- GB/month</span>
                        </div>
                        <div class="result-item">
                            <span>Hot Storage Required</span>
                            <span class="result-value" id="storageGB">-- GB</span>
                        </div>
                        <div class="result-item">
                            <span>Estimated Monthly Cost (Sentinel)</span>
                            <span class="result-value" id="sentinelCost">$--</span>
                        </div>
                        <div class="result-item">
                            <span>Estimated Annual Cost (Splunk Cloud)</span>
                            <span class="result-value" id="splunkCost">$--</span>
                        </div>
                    </div>
                </section>
                <!-- Sizing Formulas -->
                <section class="content-section">
                    <h2><i class="fas fa-square-root-alt"></i> Sizing Formulas</h2>
                    <h3>Basic Volume Calculation</h3>
                    <div class="formula-box">
                        Daily GB = Σ (Sources × Events/Day × Avg Event Size) / 1,073,741,824<br><br>
                        Monthly GB = Daily GB × 30<br><br>
                        Storage Required = Daily GB × Retention Days × 1.2 (20% overhead)
                    </div>
                    <h3>Growth Planning</h3>
                    <div class="formula-box">
                        Year 1 Estimate = Current Volume × 1.3 (30% growth buffer)<br><br>
                        3-Year Projection = Current × (1 + Annual Growth Rate)³
                    </div>
                    <h3>Cost Estimation Reference</h3>
                    <div class="calc-grid">
                        <div class="reference-card">
                            <h4>Microsoft Sentinel</h4>
                            <p><strong>Pay-as-you-go:</strong> ~$2.46/GB ingested</p>
                            <p><strong>Commitment Tier:</strong></p>
                            <ul style="font-size: 0.85rem; margin: 0; padding-left: 1rem;">
                                <li>100 GB/day: ~$1.96/GB</li>
                                <li>500 GB/day: ~$1.76/GB</li>
                                <li>1000 GB/day: ~$1.47/GB</li>
                            </ul>
                            <p style="font-size: 0.8rem; color: var(--text-secondary);">*Prices vary by region</p>
                        </div>
                        <div class="reference-card">
                            <h4>Splunk Cloud</h4>
                            <p><strong>Workload Pricing:</strong> ~$1,800/GB/year</p>
                            <p><strong>Ingest Pricing:</strong></p>
                            <ul style="font-size: 0.85rem; margin: 0; padding-left: 1rem;">
                                <li>1-10 GB/day: ~$2,000/GB/year</li>
                                <li>50+ GB/day: ~$1,200/GB/year</li>
                                <li>500+ GB/day: Negotiate</li>
                            </ul>
                            <p style="font-size: 0.8rem; color: var(--text-secondary);">*Enterprise pricing varies</p>
                        </div>
                        <div class="reference-card">
                            <h4>Cortex XSIAM</h4>
                            <p><strong>Per-Endpoint:</strong> ~$50-80/endpoint/year</p>
                            <p><strong>Includes:</strong></p>
                            <ul style="font-size: 0.85rem; margin: 0; padding-left: 1rem;">
                                <li>XDR telemetry</li>
                                <li>Log ingestion allotment</li>
                                <li>XSOAR automation</li>
                            </ul>
                            <p style="font-size: 0.8rem; color: var(--text-secondary);">*Bundle pricing</p>
                        </div>
                    </div>
                </section>
                <!-- Platform-Specific Sizing -->
                <section class="content-section">
                    <h2><i class="fas fa-server"></i> Platform-Specific Sizing</h2>
                    <div class="platform-card sentinel">
                        <h3><i class="fas fa-shield-alt"></i> Microsoft Sentinel Sizing</h3>
                        <h4>Workspace Architecture</h4>
                        <table class="sizing-table">
                            <tr>
                                <th>Volume</th>
                                <th>Architecture</th>
                                <th>Recommendations</th>
                            </tr>
                            <tr>
                                <td>&lt;50 GB/day</td>
                                <td>Single workspace</td>
                                <td>Standard deployment, pay-as-you-go acceptable</td>
                            </tr>
                            <tr>
                                <td>50-500 GB/day</td>
                                <td>Single or regional workspaces</td>
                                <td>100GB commitment tier, consider dedicated cluster</td>
                            </tr>
                            <tr>
                                <td>&gt;500 GB/day</td>
                                <td>Dedicated cluster</td>
                                <td>Required for &gt;500GB, better pricing, CMK support</td>
                            </tr>
                        </table>
                        <h4>Cost Optimization Strategies</h4>
                        <ul>
                            <li><strong>Basic Logs:</strong> Use for high-volume, low-value data (up to 70% cost reduction)</li>
                            <li><strong>Archive Tier:</strong> Move data older than 90 days to archive</li>
                            <li><strong>Data Collection Rules:</strong> Filter at ingestion to reduce volume</li>
                            <li><strong>Free data sources:</strong> Azure Activity, Office 365 audit (with M365 license)</li>
                        </ul>
                        <div class="arch-diagram">
                            <div class="code-header">Query: Current Usage Analysis</div>
                            <pre><code>Usage
| where TimeGenerated > ago(30d)
| summarize TotalGB = sum(Quantity) / 1024 by DataType, IsBillable
| where IsBillable == true
| sort by TotalGB desc
| extend MonthlyCost = TotalGB * 2.46
| project DataType, TotalGB = round(TotalGB, 2), MonthlyCost = round(MonthlyCost, 2)</code></pre>
                        </div>
                    </div>
                    <div class="platform-card splunk">
                        <h3><i class="fas fa-search"></i> Splunk Sizing</h3>
                        <h4>Infrastructure Requirements</h4>
                        <table class="sizing-table">
                            <tr>
                                <th>Component</th>
                                <th>&lt;50 GB/day</th>
                                <th>50-200 GB/day</th>
                                <th>&gt;200 GB/day</th>
                            </tr>
                            <tr>
                                <td>Indexers</td>
                                <td>1-2 (single instance possible)</td>
                                <td>3-6 (clustered)</td>
                                <td>6+ (clustered, replicated)</td>
                            </tr>
                            <tr>
                                <td>Search Heads</td>
                                <td>1 (can combine)</td>
                                <td>2-3 (SHC recommended)</td>
                                <td>3+ (SHC required)</td>
                            </tr>
                            <tr>
                                <td>Indexer Specs</td>
                                <td>8 CPU, 32GB RAM, 500GB SSD</td>
                                <td>16 CPU, 64GB RAM, 2TB SSD</td>
                                <td>32 CPU, 128GB RAM, 4TB NVMe</td>
                            </tr>
                        </table>
                        <h4>Storage Calculation</h4>
                        <div class="formula-box">
                            Raw Storage = Daily Volume × Retention Days<br>
                            Splunk Storage = Raw Storage × 0.5 (compression) × Replication Factor<br><br>
                            Example: 100 GB/day × 90 days × 0.5 × 2 (RF) = 9 TB
                        </div>
                        <div class="arch-diagram">
                            <div class="code-header">Query: License Usage</div>
                            <pre><code>index=_internal source=*license_usage.log type=Usage
| stats sum(b) as bytes by idx, st
| eval GB = round(bytes/1024/1024/1024, 2)
| sort -GB
| head 20</code></pre>
                        </div>
                    </div>
                    <div class="platform-card xsiam">
                        <h3><i class="fas fa-fire"></i> Cortex XSIAM Sizing</h3>
                        <h4>Capacity Considerations</h4>
                        <table class="sizing-table">
                            <tr>
                                <th>Factor</th>
                                <th>Consideration</th>
                            </tr>
                            <tr>
                                <td>Endpoint Count</td>
                                <td>Primary licensing metric; includes XDR telemetry</td>
                            </tr>
                            <tr>
                                <td>Third-Party Logs</td>
                                <td>Additional ingestion beyond XDR is separately metered</td>
                            </tr>
                            <tr>
                                <td>Analytics Storage</td>
                                <td>30-day hot storage for analytics; extended archive available</td>
                            </tr>
                            <tr>
                                <td>Automation</td>
                                <td>XSOAR automation included; consider playbook complexity</td>
                            </tr>
                        </table>
                        <div class="arch-diagram">
                            <div class="code-header">XQL: Data Volume Analysis</div>
                            <pre><code>datamodel dataset = *
| comp count() as events, sum(raw_log_size) as bytes by _vendor, _product
| alter GB = divide(bytes, 1073741824)
| sort desc GB
| fields _vendor, _product, events, GB</code></pre>
                        </div>
                    </div>
                </section>
                <!-- Retention Planning -->
                <section class="content-section">
                    <h2><i class="fas fa-clock"></i> Retention Planning</h2>
                    <h3>Compliance-Driven Retention</h3>
                    <table class="sizing-table">
                        <thead>
                            <tr>
                                <th>Framework</th>
                                <th>Requirement</th>
                                <th>Typical Implementation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>PCI-DSS</td>
                                <td>1 year (90 days immediately available)</td>
                                <td>90 days hot, 275 days archive</td>
                            </tr>
                            <tr>
                                <td>HIPAA</td>
                                <td>6 years</td>
                                <td>90 days hot, 6 years cold storage</td>
                            </tr>
                            <tr>
                                <td>SOX</td>
                                <td>7 years</td>
                                <td>90 days hot, 7 years archive</td>
                            </tr>
                            <tr>
                                <td>GDPR</td>
                                <td>"As long as necessary"</td>
                                <td>90 days default, document justification</td>
                            </tr>
                            <tr>
                                <td>SOC 2</td>
                                <td>No specific requirement</td>
                                <td>90 days recommended minimum</td>
                            </tr>
                        </tbody>
                    </table>
                    <h3>Tiered Storage Strategy</h3>
                    <table class="sizing-table">
                        <thead>
                            <tr>
                                <th>Tier</th>
                                <th>Duration</th>
                                <th>Access Speed</th>
                                <th>Cost</th>
                                <th>Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Hot</strong></td>
                                <td>0-30 days</td>
                                <td>Instant</td>
                                <td>$$$</td>
                                <td>Active investigation, real-time queries</td>
                            </tr>
                            <tr>
                                <td><strong>Warm</strong></td>
                                <td>30-90 days</td>
                                <td>Seconds</td>
                                <td>$$</td>
                                <td>Threat hunting, incident review</td>
                            </tr>
                            <tr>
                                <td><strong>Cold/Archive</strong></td>
                                <td>90+ days</td>
                                <td>Minutes-Hours</td>
                                <td>$</td>
                                <td>Compliance, forensic investigation</td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                <!-- Optimization Strategies -->
                <section class="content-section">
                    <h2><i class="fas fa-compress-arrows-alt"></i> Volume Optimization</h2>
                    <h3>Data Reduction Strategies</h3>
                    <table class="sizing-table">
                        <thead>
                            <tr>
                                <th>Strategy</th>
                                <th>Typical Reduction</th>
                                <th>Risk</th>
                                <th>Implementation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Filter noisy events</strong></td>
                                <td>20-40%</td>
                                <td>Low</td>
                                <td>Drop heartbeat, info-level logs at ingestion</td>
                            </tr>
                            <tr>
                                <td><strong>Reduce verbosity</strong></td>
                                <td>30-50%</td>
                                <td>Medium</td>
                                <td>Tune audit policies, reduce debug logging</td>
                            </tr>
                            <tr>
                                <td><strong>Sampling</strong></td>
                                <td>50-90%</td>
                                <td>High</td>
                                <td>Sample high-volume, low-value sources</td>
                            </tr>
                            <tr>
                                <td><strong>Aggregation</strong></td>
                                <td>40-70%</td>
                                <td>Medium</td>
                                <td>Pre-aggregate metrics before ingestion</td>
                            </tr>
                            <tr>
                                <td><strong>Deduplication</strong></td>
                                <td>10-30%</td>
                                <td>Low</td>
                                <td>Remove duplicate events from multiple paths</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="arch-diagram">
                        <div class="code-header">Sentinel - DCR Filtering Example</div>
                        <pre><code>// Data Collection Rule transformation to filter events
source
| where EventID !in (4688, 4689)  // Filter process start/stop
    or (EventID == 4688 and NewProcessName !contains "svchost")
| where Level != 0  // Drop Informational
| project-away RawData  // Remove raw data field</code></pre>
                    </div>
                </section>
                <!-- Interview Q&A -->
                <div class="interview-qa">
                    <h3><i class="fas fa-user-tie"></i> Interview Q&A: SIEM Sizing</h3>
                    <div class="qa-item">
                        <strong>Q: How do you size a SIEM deployment for a new organization?</strong>
                        <p><strong>A:</strong> I follow a systematic approach. First, inventory data sources: count endpoints, servers, network devices, cloud services, and users. Second, estimate volume using industry benchmarks—Windows endpoints typically generate 5-50K events/day, servers 50-500K, firewalls 1-50M depending on traffic. Third, apply multipliers for your environment's verbosity. Fourth, add 20-30% buffer for growth and variance. Fifth, calculate storage based on retention requirements—typically compliance-driven. For a 1000-endpoint enterprise with standard server and network infrastructure, I'd estimate 50-150 GB/day as starting point, then refine based on pilot data. Always run a 2-week pilot to validate estimates before full deployment.</p>
                    </div>
                    <div class="qa-item">
                        <strong>Q: How do you optimize SIEM costs without sacrificing security coverage?</strong>
                        <p><strong>A:</strong> Tiered approach to data value. First, identify high-value vs. noise—security events, authentication, and process execution are high-value; heartbeat logs and routine info events are noise. Filter noise at ingestion using DCRs or forwarder rules. Second, use appropriate storage tiers—hot storage for recent data needed for active investigation, archive for compliance-only data. Third, leverage platform discounts—Sentinel commitment tiers can reduce cost 40%, Splunk volume discounts are significant. Fourth, tune audit policies at source—overly verbose Windows audit policies can 10x your volume unnecessarily. Fifth, consider sampling for extremely high-volume, low-value sources like DNS queries. Key is documenting decisions so coverage gaps are intentional and understood.</p>
                    </div>
                    <div class="qa-item">
                        <strong>Q: What retention strategy would you recommend for a company with PCI and HIPAA requirements?</strong>
                        <p><strong>A:</strong> The strictest requirement wins: HIPAA needs 6 years, so that's the floor. Implementation: 90-day hot tier for active investigation and analytics—this covers PCI's "immediately available" requirement. Archive tier from 90 days to 6 years for compliance. Not all data needs 6 years—segment by data type: authentication and access logs for HIPAA systems need full retention, general endpoint telemetry might only need 1 year. Use data classification to apply appropriate retention. For cost efficiency, archive storage is typically 90%+ cheaper than hot storage. Key deliverable is a data retention matrix mapping data types to retention periods with compliance justification.</p>
                    </div>
                    <div class="qa-item">
                        <strong>Q: How do you handle a situation where actual SIEM volume significantly exceeds estimates?</strong>
                        <p><strong>A:</strong> First, don't panic—this is common. Immediate action: identify the sources driving overages using platform usage queries. Usually one or two sources are responsible—often overly verbose audit policies, misconfigured debug logging, or unexpected application behavior. Short-term: implement filtering at ingestion for obvious noise while maintaining security coverage. Medium-term: tune audit policies at source—work with system owners to reduce verbosity appropriately. Long-term: review architecture—consider dedicated pipelines for high-volume sources with different retention, or sampling strategies for specific data types. Document everything—explain what you're filtering and why, so there's traceability if questions arise during incidents or audits. Always maintain detection coverage as primary goal; cost is secondary.</p>
                    </div>
                </div>
            
                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>

                <!-- Comprehensive Troubleshooting -->
                <h2><i class="fas fa-tools"></i> Comprehensive Troubleshooting</h2>
                <div class="config-section">
                    <h4>Systematic Troubleshooting Methodology</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <ol style="color: #8b949e;">
                            <li><strong>Define the Problem:</strong> Clearly articulate what is not working as expected. Gather specific error messages, timestamps, and affected components.</li>
                            <li><strong>Gather Information:</strong> Collect relevant logs, metrics, and configuration details. Document recent changes that might be related.</li>
                            <li><strong>Analyze Data:</strong> Review collected information for patterns and anomalies. Compare against baseline behavior and known-good configurations.</li>
                            <li><strong>Develop Hypothesis:</strong> Form theories about potential root causes. Prioritize based on likelihood and impact.</li>
                            <li><strong>Test Solutions:</strong> Implement fixes in a controlled manner. Test one change at a time to isolate the effective solution.</li>
                            <li><strong>Document Resolution:</strong> Record the root cause and solution. Update runbooks and knowledge base for future reference.</li>
                        </ol>
                    </div>

                    <h4>Common Issues and Resolutions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Category</th><th>Issue</th><th>Diagnostic Steps</th><th>Resolution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td rowspan="2"><strong>Connectivity</strong></td>
                                <td>Agent not reporting</td>
                                <td>Check agent service status, network connectivity, firewall rules</td>
                                <td>Restart service, verify network path, update firewall rules</td>
                            </tr>
                            <tr>
                                <td>API timeouts</td>
                                <td>Test API endpoint, check rate limits, verify credentials</td>
                                <td>Retry with backoff, request limit increase, refresh credentials</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Data Quality</strong></td>
                                <td>Missing fields</td>
                                <td>Review parsing rules, check source format, validate schema</td>
                                <td>Update parser, fix source configuration, adjust schema mapping</td>
                            </tr>
                            <tr>
                                <td>Duplicate events</td>
                                <td>Audit data sources, check collection paths, review timestamps</td>
                                <td>Consolidate sources, implement deduplication, fix time sync</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Performance</strong></td>
                                <td>Slow queries</td>
                                <td>Analyze query execution plan, check resource utilization</td>
                                <td>Optimize query, add indexes, scale resources</td>
                            </tr>
                            <tr>
                                <td>High latency</td>
                                <td>Monitor queue depths, check processing bottlenecks</td>
                                <td>Scale processing capacity, optimize data flow</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Authentication</strong></td>
                                <td>Login failures</td>
                                <td>Verify credentials, check account status, review permissions</td>
                                <td>Reset password, unlock account, grant required permissions</td>
                            </tr>
                            <tr>
                                <td>Token expiration</td>
                                <td>Check token validity, review refresh mechanism</td>
                                <td>Refresh token, update token management configuration</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Diagnostic Commands and Queries</h4>
                    <div class="arch-diagram"># Health Check Queries (adjust syntax for your platform)

# Check system health status
| filter log_type = "system_health"
| sort _time desc
| limit 50

# Monitor error rates over time
| filter severity in ("error", "critical")
| timechart count by component span=1h

# Identify slow operations
| filter operation_time > 30000
| stats avg(operation_time), max(operation_time), count by operation_name
| sort avg(operation_time) desc

# Check connectivity status
| filter event_type = "connectivity"
| stats latest(status), latest(_time) by source_name
| where status != "connected"

# Review authentication failures
| filter event_type = "authentication" and result = "failure"
| stats count by user, source_ip, failure_reason
| sort count desc</div>
                </div>

                <!-- Real-World Use Cases -->
                <h2><i class="fas fa-building"></i> Real-World Implementation Scenarios</h2>
                <div class="config-section">
                    <h4>Scenario 1: Enterprise SOC Deployment</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #3fb950;">
                        <p><strong>Organization Profile:</strong> Fortune 500 company with 50,000 employees, hybrid cloud infrastructure</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>High volume of security events (500+ million events/day)</li>
                            <li>Multiple security tools with siloed data</li>
                            <li>Alert fatigue from excessive false positives</li>
                            <li>Compliance requirements (SOX, PCI-DSS, GDPR)</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Phased rollout starting with critical data sources</li>
                            <li>Custom detection rules based on threat model</li>
                            <li>Automated playbooks for common scenarios</li>
                            <li>Integration with ITSM and CMDB systems</li>
                        </ul>
                        <p style="color: #3fb950;"><strong>Results:</strong> 70% reduction in MTTR, 50% reduction in false positives, unified security visibility</p>
                    </div>

                    <h4>Scenario 2: MSSP Multi-Tenant Operations</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #58a6ff;">
                        <p><strong>Organization Profile:</strong> Managed security provider serving 100+ SMB customers</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Need for strict data isolation between customers</li>
                            <li>Scalable operations with limited staff</li>
                            <li>Standardized service delivery across customers</li>
                            <li>Flexible SLA-based prioritization</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Multi-tenant architecture with customer isolation</li>
                            <li>Shared detection content library with customization</li>
                            <li>Centralized analyst console with customer context</li>
                            <li>Automated reporting and SLA tracking</li>
                        </ul>
                        <p style="color: #58a6ff;"><strong>Results:</strong> 3x increase in customers per analyst, consistent service quality, improved customer satisfaction</p>
                    </div>

                    <h4>Scenario 3: Healthcare Compliance Focus</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #d29922;">
                        <p><strong>Organization Profile:</strong> Regional hospital network with 15 facilities</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>HIPAA compliance requirements for PHI protection</li>
                            <li>Legacy medical devices with limited security logging</li>
                            <li>Need for 6-year log retention</li>
                            <li>Limited IT security staff</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Comprehensive EHR and clinical application monitoring</li>
                            <li>PHI access detection rules</li>
                            <li>Long-term archival storage configuration</li>
                            <li>Pre-built compliance dashboards and reports</li>
                        </ul>
                        <p style="color: #d29922;"><strong>Results:</strong> Audit-ready compliance posture, early detection of PHI access violations, reduced audit preparation time by 80%</p>
                    </div>
                </div>

                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>