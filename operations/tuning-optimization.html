<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tuning & Optimization | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-tasks"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Incident Classification</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cogs"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link active"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-shield-alt"></i> Containment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Metrics</div>
                    <a href="soc-metrics.html" class="nav-link"><i class="fas fa-chart-line"></i> SOC Metrics</a>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-bar"></i> KPIs</a>
                    <a href="rbac-design.html" class="nav-link"><i class="fas fa-users-cog"></i> RBAC Design</a>
                    <a href="sizing-calculator.html" class="nav-link"><i class="fas fa-calculator"></i> Sizing Calculator</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Compliance & Migration</div>
                    <a href="audit-preparation.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Audit Preparation</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-balance-scale"></i> Compliance Mapping</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-sitemap"></i> MITRE Mapping</a>
                    <a href="migration-guide.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Migration Guide</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <span class="current">Tuning & Optimization</span>
                </div>
            </header>
            <main class="main-content">
<h1>Tuning & Optimization</h1>
                <p class="subtitle">Systematic approach to reducing noise while maintaining detection coverage</p>
            </header>
            <section class="content-section">
                <h2>Tuning Philosophy</h2>
                <p>Effective tuning balances detection sensitivity with operational efficiency. The goal is to maximize true positives while minimizing false positives without creating detection blind spots.</p>
                <div class="info-box">
                    <h4>Tuning Golden Rules</h4>
                    <ul>
                        <li><strong>Document everything:</strong> Every suppression needs a ticket, justification, and approval</li>
                        <li><strong>Start narrow:</strong> Begin with specific exclusions, broaden only if necessary</li>
                        <li><strong>Validate before suppressing:</strong> Confirm the behavior is genuinely benign</li>
                        <li><strong>Review regularly:</strong> Quarterly review of all suppressions</li>
                        <li><strong>Monitor coverage:</strong> Track MITRE ATT&CK coverage after tuning</li>
                    </ul>
                </div>
            </section>
            <section class="content-section">
                <h2>False Positive Analysis</h2>
                <h3>FP Identification Queries</h3>
                <div class="code-block">
                    <pre><code>// Splunk - Find high-volume alerts
index=notable
| stats count by rule_name, src, user
| where count > 50
| sort -count
// Sentinel - FP candidates by resolution
SecurityAlert
| where TimeGenerated > ago(30d)
| where Status == "Resolved"
| summarize 
    Total = count(),
    FP = countif(AlertSeverity == "Low"),
    Dismissed = countif(ExtendedProperties contains "false_positive")
    by AlertName
| extend FP_Rate = round(todouble(FP + Dismissed) / Total * 100, 2)
| where FP_Rate > 50
| order by Total desc
// XDR - High-volume alert sources
dataset = xdr_data
| filter event_type = ALERT
| comp count() as alert_count by alert_name, endpoint_hostname, user_name
| filter alert_count > 20
| sort desc alert_count</code></pre>
                </div>
                <h3>FP Categories</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Example</th>
                            <th>Tuning Approach</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Legitimate Tool</td>
                            <td>PsExec by admin</td>
                            <td>User/path exclusion</td>
                        </tr>
                        <tr>
                            <td>Security Testing</td>
                            <td>Vulnerability scanner</td>
                            <td>Source IP/user exclusion</td>
                        </tr>
                        <tr>
                            <td>Automation</td>
                            <td>SCCM encoded scripts</td>
                            <td>Process/parent exclusion</td>
                        </tr>
                        <tr>
                            <td>Business Process</td>
                            <td>Large file transfer</td>
                            <td>Destination/time exclusion</td>
                        </tr>
                        <tr>
                            <td>Detection Logic</td>
                            <td>Overly broad rule</td>
                            <td>Refine detection query</td>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section class="content-section">
                <h2>Tuning Workflow</h2>
                <div class="workflow-diagram">
                    <div class="workflow-step">
                        <span class="step-number">1</span>
                        <h4>Identify Pattern</h4>
                        <p>Analyze high-volume alerts, identify repeating FP patterns</p>
                    </div>
                    <div class="workflow-arrow">→</div>
                    <div class="workflow-step">
                        <span class="step-number">2</span>
                        <h4>Validate</h4>
                        <p>Confirm behavior is benign with asset owner</p>
                    </div>
                    <div class="workflow-arrow">→</div>
                    <div class="workflow-step">
                        <span class="step-number">3</span>
                        <h4>Document</h4>
                        <p>Create ticket with justification, risk assessment</p>
                    </div>
                    <div class="workflow-arrow">→</div>
                    <div class="workflow-step">
                        <span class="step-number">4</span>
                        <h4>Implement</h4>
                        <p>Apply narrowest possible exclusion</p>
                    </div>
                    <div class="workflow-arrow">→</div>
                    <div class="workflow-step">
                        <span class="step-number">5</span>
                        <h4>Verify</h4>
                        <p>Confirm alert reduction, no new gaps</p>
                    </div>
                    <div class="workflow-arrow">→</div>
                    <div class="workflow-step">
                        <span class="step-number">6</span>
                        <h4>Review</h4>
                        <p>Quarterly review for continued validity</p>
                    </div>
                </div>
            </section>
            <section class="content-section">
                <h2>Exclusion Best Practices</h2>
                <h3>Exclusion Hierarchy (Most to Least Specific)</h3>
                <ol>
                    <li><strong>Hash + User + Host:</strong> Most specific, lowest risk</li>
                    <li><strong>File path + User:</strong> Specific to known scenario</li>
                    <li><strong>Process + Parent Process:</strong> Behavioral context</li>
                    <li><strong>User or Service Account:</strong> Identity-based</li>
                    <li><strong>File path only:</strong> Use with caution</li>
                    <li><strong>File name only:</strong> High risk, avoid if possible</li>
                </ol>
                <h3>Exclusion Template</h3>
                <div class="code-block">
                    <pre><code># Tuning Request Template
## Alert Information
- Alert Name: Encoded PowerShell Execution
- Rule ID: DET-2024-0042
- Average Daily Volume: 150 alerts
- False Positive Rate: 85%
## Pattern Analysis
- Source: SCCM client deployment scripts
- User: svc_sccm
- Host Pattern: All workstations
- Command Pattern: powershell.exe -enc SQBmACAAKABHAGUA...
## Exclusion Proposed
- Type: Process + Parent + User
- Conditions:
  - ProcessName = powershell.exe
  - ParentProcess contains "ccmexec.exe"
  - User = svc_sccm
## Risk Assessment
- Detection Gap: Minimal - other detections cover PowerShell abuse
- Abuse Potential: Low - requires compromised service account
- Compensating Controls: EDR behavioral detection still active
## Approvals
- SOC Lead: [Name] - [Date]
- Security Engineer: [Name] - [Date]
- Ticket: SEC-2024-1234
- Review Date: 2024-06-15</code></pre>
                </div>
            </section>
            <section class="content-section">
                <h2>Performance Optimization</h2>
                <h3>Query Optimization</h3>
                <div class="code-block">
                    <pre><code>// BAD - Scanning all data
SecurityEvent
| where Process contains "powershell"
// GOOD - Filter early, use efficient operators
SecurityEvent
| where TimeGenerated > ago(1h)
| where EventID == 4688
| where Process endswith "powershell.exe"
// BAD - Multiple regex in OR
SecurityEvent
| where CommandLine matches regex "mimikatz|sekurlsa|logonpasswords"
// GOOD - Use has_any for string matching
SecurityEvent
| where CommandLine has_any ("mimikatz", "sekurlsa", "logonpasswords")
// Splunk - Use indexed fields
index=windows EventCode=4688 process_name="powershell.exe"
| search CommandLine="*-enc*"</code></pre>
                </div>
                <h3>Alert Aggregation</h3>
                <div class="code-block">
                    <pre><code>// Instead of alerting per event, aggregate related events
SecurityEvent
| where TimeGenerated > ago(15m)
| where EventID == 4625  // Failed logon
| summarize 
    FailedAttempts = count(),
    TargetAccounts = make_set(TargetUserName),
    SourceIPs = make_set(IpAddress)
    by Computer, bin(TimeGenerated, 15m)
| where FailedAttempts > 10
// One alert with context vs. many individual alerts</code></pre>
                </div>
            </section>
            <section class="content-section">
                <h2>Tuning Metrics</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Target</th>
                            <th>Measurement</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>False Positive Rate</td>
                            <td>&lt;20%</td>
                            <td>FP alerts / Total alerts</td>
                        </tr>
                        <tr>
                            <td>Alert-to-Incident Ratio</td>
                            <td>&gt;5%</td>
                            <td>Incidents / Alerts investigated</td>
                        </tr>
                        <tr>
                            <td>Coverage Score</td>
                            <td>&gt;60%</td>
                            <td>Detected techniques / Relevant techniques</td>
                        </tr>
                        <tr>
                            <td>Detection Latency</td>
                            <td>&lt;5 min</td>
                            <td>Event time to alert time</td>
                        </tr>
                        <tr>
                            <td>Exclusion Count</td>
                            <td>Track trend</td>
                            <td>Total active exclusions</td>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section class="content-section">
                <h2>Interview Q&A</h2>
                <div class="qa-section">
                    <h3>Q: How do you approach tuning in a new environment?</h3>
                    <div class="answer">
                        <p><strong>A:</strong> My new environment tuning approach:</p>
                        <ol>
                            <li><strong>Baseline (2-4 weeks):</strong> Enable detections in audit/low-severity mode to understand normal patterns</li>
                            <li><strong>Data analysis:</strong> Identify top 10 highest-volume alert sources using queries that group by alert type, source, and user</li>
                            <li><strong>Quick wins:</strong> Address obvious FPs first (security scanners, backup tools, deployment automation)</li>
                            <li><strong>Validation process:</strong> Work with IT/app owners to confirm each pattern is legitimate before suppressing</li>
                            <li><strong>Iterative refinement:</strong> Start with narrow exclusions, monitor effectiveness, broaden only if needed</li>
                            <li><strong>Coverage tracking:</strong> Map exclusions to MITRE ATT&CK to ensure we're not creating blind spots</li>
                        </ol>
                    </div>
                </div>
                <div class="qa-section">
                    <h3>Q: How do you balance detection coverage with alert fatigue?</h3>
                    <div class="answer">
                        <p><strong>A:</strong> The balance comes from several strategies:</p>
                        <ul>
                            <li><strong>Severity tiering:</strong> Not all detections need human review - use risk scoring to prioritize</li>
                            <li><strong>Automation:</strong> Auto-close obvious FPs but log them for trend analysis</li>
                            <li><strong>Correlation:</strong> Combine weak signals into stronger detections rather than alerting on each individually</li>
                            <li><strong>Context enrichment:</strong> Add asset criticality, user risk, and threat intel context to help prioritize</li>
                            <li><strong>Layered detection:</strong> If suppressing one detection, ensure other detections cover the same technique</li>
                            <li><strong>Regular review:</strong> Quarterly audit of suppressions - business processes change, so should exclusions</li>
                        </ul>
                    </div>
                </div>
            </section>
        </article>
    </main>
            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium - Security Operations Reference</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>