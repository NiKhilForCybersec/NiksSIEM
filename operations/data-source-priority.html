<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Source Priority | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link active"><i class="fas fa-home"></i> Overview</a>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-tasks"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Incident Classification</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cogs"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-shield-alt"></i> Containment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Metrics</div>
                    <a href="soc-metrics.html" class="nav-link"><i class="fas fa-chart-line"></i> SOC Metrics</a>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-bar"></i> KPIs</a>
                    <a href="rbac-design.html" class="nav-link"><i class="fas fa-users-cog"></i> RBAC Design</a>
                    <a href="sizing-calculator.html" class="nav-link"><i class="fas fa-calculator"></i> Sizing Calculator</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Compliance & Migration</div>
                    <a href="audit-preparation.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Audit Preparation</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-balance-scale"></i> Compliance Mapping</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-sitemap"></i> MITRE Mapping</a>
                    <a href="migration-guide.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Migration Guide</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <span class="current">Data Source Priority</span>
                </div>
            </header>
            <main class="main-content">
<div class="page-header">
                    <h1><i class="fas fa-sort-amount-down"></i> Data Source Priority Matrix</h1>
                    <p class="lead">Prioritize log sources by security value for phased SIEM onboarding</p>
                </div>
                <section class="content-section">
                    <h2><i class="fas fa-bullseye"></i> Prioritization Framework</h2>
                    <div class="workflow-diagram">
<pre>
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                           DATA SOURCE PRIORITIZATION MATRIX                                              │
├─────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                          │
│                                    DETECTION VALUE                                                       │
│                         LOW              MEDIUM            HIGH                                          │
│                    ┌──────────────┬──────────────┬──────────────┐                                       │
│             HIGH   │   MEDIUM     │    HIGH      │  CRITICAL    │                                       │
│                    │   Priority   │   Priority   │  Priority    │                                       │
│   ATTACK           │              │              │  WAVE 1      │                                       │
│   SURFACE          ├──────────────┼──────────────┼──────────────┤                                       │
│   COVERAGE  MEDIUM │    LOW       │   MEDIUM     │    HIGH      │                                       │
│                    │   Priority   │   Priority   │   Priority   │                                       │
│                    │   WAVE 4     │   WAVE 3     │   WAVE 2     │                                       │
│                    ├──────────────┼──────────────┼──────────────┤                                       │
│             LOW    │   OPTIONAL   │    LOW       │   MEDIUM     │                                       │
│                    │              │   Priority   │   Priority   │                                       │
│                    │   BACKLOG    │   WAVE 4     │   WAVE 3     │                                       │
│                    └──────────────┴──────────────┴──────────────┘                                       │
│                                                                                                          │
│   SCORING CRITERIA:                                                                                      │
│   ─────────────────                                                                                      │
│   Detection Value:                         Attack Surface Coverage:                                      │
│   • Visibility into attack techniques      • % of environment covered                                   │
│   • Forensic value for investigations      • Criticality of systems                                     │
│   • Threat detection capability            • Exposure to threats                                        │
│   • Compliance requirement                 • User/data sensitivity                                      │
│                                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
                    </div>
                </section>
                <section class="content-section">
                    <h2><i class="fas fa-list-ol"></i> Complete Data Source Priority List</h2>
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Priority</th>
                                <th>Data Source</th>
                                <th>Detection Value</th>
                                <th>Key Use Cases</th>
                                <th>Volume Est.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="priority-critical">
                                <td><strong>P1 - CRITICAL</strong></td>
                                <td>Active Directory / Entra ID</td>
                                <td>★★★★★</td>
                                <td>Auth attacks, privilege escalation, persistence</td>
                                <td>5-20 GB/day</td>
                            </tr>
                            <tr class="priority-critical">
                                <td><strong>P1 - CRITICAL</strong></td>
                                <td>EDR (MDE, CrowdStrike, etc.)</td>
                                <td>★★★★★</td>
                                <td>Malware, process injection, lateral movement</td>
                                <td>10-50 GB/day</td>
                            </tr>
                            <tr class="priority-critical">
                                <td><strong>P1 - CRITICAL</strong></td>
                                <td>Firewall (Palo Alto, Fortinet)</td>
                                <td>★★★★★</td>
                                <td>C2 traffic, data exfil, network attacks</td>
                                <td>20-100 GB/day</td>
                            </tr>
                            <tr class="priority-critical">
                                <td><strong>P1 - CRITICAL</strong></td>
                                <td>Email Security (O365, Proofpoint)</td>
                                <td>★★★★★</td>
                                <td>Phishing, BEC, malware delivery</td>
                                <td>5-20 GB/day</td>
                            </tr>
                            <tr class="priority-critical">
                                <td><strong>P1 - CRITICAL</strong></td>
                                <td>VPN / Remote Access</td>
                                <td>★★★★☆</td>
                                <td>Unauthorized access, credential theft</td>
                                <td>1-10 GB/day</td>
                            </tr>
                            <tr class="priority-high">
                                <td><strong>P2 - HIGH</strong></td>
                                <td>DNS Logs</td>
                                <td>★★★★☆</td>
                                <td>C2 beaconing, DNS tunneling, DGA</td>
                                <td>10-50 GB/day</td>
                            </tr>
                            <tr class="priority-high">
                                <td><strong>P2 - HIGH</strong></td>
                                <td>Web Proxy</td>
                                <td>★★★★☆</td>
                                <td>Malicious downloads, data exfil, policy</td>
                                <td>20-100 GB/day</td>
                            </tr>
                            <tr class="priority-high">
                                <td><strong>P2 - HIGH</strong></td>
                                <td>Windows Security Events</td>
                                <td>★★★★☆</td>
                                <td>Logon events, process creation, audit</td>
                                <td>20-100 GB/day</td>
                            </tr>
                            <tr class="priority-high">
                                <td><strong>P2 - HIGH</strong></td>
                                <td>Cloud Audit (Azure/AWS/GCP)</td>
                                <td>★★★★☆</td>
                                <td>Cloud misconfig, privilege escalation</td>
                                <td>5-30 GB/day</td>
                            </tr>
                            <tr class="priority-medium">
                                <td><strong>P3 - MEDIUM</strong></td>
                                <td>Linux Auth/Syslog</td>
                                <td>★★★☆☆</td>
                                <td>SSH brute force, privilege escalation</td>
                                <td>5-20 GB/day</td>
                            </tr>
                            <tr class="priority-medium">
                                <td><strong>P3 - MEDIUM</strong></td>
                                <td>Database Audit</td>
                                <td>★★★☆☆</td>
                                <td>Data access, SQL injection, compliance</td>
                                <td>5-30 GB/day</td>
                            </tr>
                            <tr class="priority-medium">
                                <td><strong>P3 - MEDIUM</strong></td>
                                <td>DHCP</td>
                                <td>★★★☆☆</td>
                                <td>Asset tracking, rogue devices</td>
                                <td>1-5 GB/day</td>
                            </tr>
                            <tr class="priority-low">
                                <td><strong>P4 - LOW</strong></td>
                                <td>Badge/Physical Access</td>
                                <td>★★☆☆☆</td>
                                <td>Insider threat, tailgating</td>
                                <td><1 GB/day</td>
                            </tr>
                            <tr class="priority-low">
                                <td><strong>P4 - LOW</strong></td>
                                <td>Network Flow (NetFlow)</td>
                                <td>★★☆☆☆</td>
                                <td>Traffic analysis, baseline deviation</td>
                                <td>50-200 GB/day</td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                <section class="content-section">
                    <h2><i class="fas fa-wave-square"></i> Onboarding Waves</h2>
                    <div class="workflow-diagram">
<pre>
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                           DATA ONBOARDING WAVE PLAN                                      │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│  WAVE 1: FOUNDATION (Week 1-2)                                                          │
│  ─────────────────────────────                                                           │
│  Goal: Identity, perimeter, email - catch 60% of attacks                                │
│                                                                                          │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐    │
│  │ Active Directory│  │    Firewall     │  │  Email Gateway  │  │    VPN/RAS      │    │
│  │  / Entra ID     │  │                 │  │                 │  │                 │    │
│  │                 │  │ Inbound/Outbound│  │  O365/Google    │  │  Remote Access  │    │
│  │ 4624,4625,4672  │  │ Allow/Deny      │  │  Phishing       │  │  Auth events    │    │
│  │ 4720,4726,4728  │  │ Threat logs     │  │  Attachments    │  │                 │    │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘    │
│                                                                                          │
│  Success Criteria: Authentication monitoring, perimeter visibility, phishing detection  │
│                                                                                          │
│  ═══════════════════════════════════════════════════════════════════════════════════   │
│                                                                                          │
│  WAVE 2: ENDPOINT & NETWORK (Week 3-4)                                                  │
│  ─────────────────────────────────────                                                   │
│  Goal: Deep endpoint visibility, network traffic analysis                               │
│                                                                                          │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐    │
│  │      EDR        │  │ Windows Events  │  │    DNS Logs     │  │   Web Proxy     │    │
│  │                 │  │                 │  │                 │  │                 │    │
│  │ MDE/CrowdStrike │  │ Security (full) │  │  Query logs     │  │  URL filtering  │    │
│  │ Process, File   │  │ Sysmon if avail │  │  Response logs  │  │  SSL inspection │    │
│  │ Network, Alerts │  │ PowerShell      │  │                 │  │                 │    │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘    │
│                                                                                          │
│  Success Criteria: Malware detection, process visibility, C2 detection                  │
│                                                                                          │
│  ═══════════════════════════════════════════════════════════════════════════════════   │
│                                                                                          │
│  WAVE 3: CLOUD & APPLICATIONS (Week 5-6)                                                │
│  ───────────────────────────────────────                                                 │
│  Goal: Cloud visibility, critical application monitoring                                │
│                                                                                          │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐    │
│  │  Cloud Audit    │  │  SaaS Apps      │  │  Database Audit │  │  Critical Apps  │    │
│  │                 │  │                 │  │                 │  │                 │    │
│  │ Azure/AWS/GCP   │  │ Okta, Salesforce│  │ SQL, Oracle     │  │  ERP, CRM       │    │
│  │ Activity logs   │  │ Auth, Admin     │  │ Query audit     │  │  Custom apps    │    │
│  │ Resource changes│  │ Data access     │  │ Schema changes  │  │                 │    │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘    │
│                                                                                          │
│  Success Criteria: Cloud misconfiguration, data access monitoring                       │
│                                                                                          │
│  ═══════════════════════════════════════════════════════════════════════════════════   │
│                                                                                          │
│  WAVE 4: ADDITIONAL SOURCES (Ongoing)                                                   │
│  ────────────────────────────────────                                                    │
│  Goal: Complete coverage, compliance sources                                            │
│                                                                                          │
│  • Network devices (switches, routers)                                                  │
│  • Physical security (badge access)                                                     │
│  • DLP logs                                                                             │
│  • Vulnerability scanner results                                                        │
│  • NetFlow (high volume - careful sizing)                                               │
│  • Printer/MFP logs                                                                     │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
                    </div>
                </section>
                <section class="content-section interview-section" >
                    <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>How do you prioritize which log sources to onboard to a SIEM first?</span>
                        </div>
                        <div class="interview-answer">
                            <p><strong>I prioritize based on two dimensions: Detection Value and Attack Surface Coverage.</strong></p>
                            <p><strong>Wave 1 - Identity & Perimeter (Week 1-2):</strong> Active Directory, Firewall, Email Gateway, VPN. These catch ~60% of attacks - credential theft, phishing, and C2 traffic. Without identity logs, you're blind to most attacks.</p>
                            <p><strong>Wave 2 - Endpoints & Network (Week 3-4):</strong> EDR, Windows Security Events, DNS, Web Proxy. This gives deep visibility into what's happening on hosts and network traffic for malware and lateral movement detection.</p>
                            <p><strong>Wave 3 - Cloud & Apps (Week 5-6):</strong> Cloud audit logs, SaaS applications, database audit. Critical for cloud-native attacks and data access monitoring.</p>
                            <p><strong>Wave 4 - Everything else:</strong> Network devices, physical access, DLP - nice to have but lower detection value.</p>
                            <p><strong>Key principle:</strong> Don't try to boil the ocean. Get high-value sources ingesting first, build initial use cases, demonstrate value, then expand. Better to have 5 sources well-tuned than 50 sources with no detection rules.</p>
                        </div>
                    </div>
                </section>
            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium - Security Operations Reference</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>