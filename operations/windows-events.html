<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows Event Log Analysis | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link active" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">SOC Operations Pages</div>
                <ul class="sidebar-nav">
                                        <li class="sidebar-nav-item">
                        <a href="soc-operations.html" class="sidebar-nav-link">
                            <i class="fas fa-users-cog"></i>
                            <span>SOC Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-handbook.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Triage Handbook</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-classification.html" class="sidebar-nav-link">
                            <i class="fas fa-tags"></i>
                            <span>Incident Classification</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="escalation-matrix.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Escalation Matrix</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="shift-handoff.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Shift Handoff</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="playbook-library.html" class="sidebar-nav-link">
                            <i class="fas fa-book"></i>
                            <span>Playbook Library</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="containment-procedures.html" class="sidebar-nav-link">
                            <i class="fas fa-shield-alt"></i>
                            <span>Containment Procedures</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="ir-integration.html" class="sidebar-nav-link">
                            <i class="fas fa-ambulance"></i>
                            <span>IR Integration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="use-case-lifecycle.html" class="sidebar-nav-link">
                            <i class="fas fa-sync-alt"></i>
                            <span>Use Case Lifecycle</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="tuning-optimization.html" class="sidebar-nav-link">
                            <i class="fas fa-sliders-h"></i>
                            <span>Tuning & Optimization</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-source-priority.html" class="sidebar-nav-link">
                            <i class="fas fa-list-ol"></i>
                            <span>Data Source Priority</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="metrics-kpis.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Metrics & KPIs</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-metrics.html" class="sidebar-nav-link">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>SOC Metrics Dashboard</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="compliance-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-check-square"></i>
                            <span>Compliance Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="audit-preparation.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Audit Preparation</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="sizing-calculator.html" class="sidebar-nav-link">
                            <i class="fas fa-calculator"></i>
                            <span>Sizing Calculator</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="migration-guide.html" class="sidebar-nav-link">
                            <i class="fas fa-route"></i>
                            <span>Migration Guide</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="siem-project-planning.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>SIEM Project Planning</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="rbac-design.html" class="sidebar-nav-link">
                            <i class="fas fa-user-shield"></i>
                            <span>RBAC Design</span>
                        </a>
                    </li>
<li class="sidebar-nav-item">
                        <a href="cloud-security.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Cloud Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="compliance-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Compliance Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="containment-procedures.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Containment Procedures</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-source-priority.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Source Priority</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="detection-engineering.html" class="sidebar-nav-link">
                            <i class="fas fa-search"></i>
                            <span>Detection Engineering</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="escalation-matrix.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Escalation Matrix</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="forensics.html" class="sidebar-nav-link">
                            <i class="fas fa-microscope"></i>
                            <span>Forensics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="identity-security.html" class="sidebar-nav-link">
                            <i class="fas fa-user-shield"></i>
                            <span>Identity Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-classification.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Classification</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-response.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Response</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="ir-integration.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Ir Integration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="log-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Log Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="malware-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-virus"></i>
                            <span>Malware Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="metrics-kpis.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Metrics Kpis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="migration-guide.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Migration Guide</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="mitre-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-chess"></i>
                            <span>Mitre Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="network-security.html" class="sidebar-nav-link">
                            <i class="fas fa-network-wired"></i>
                            <span>Network Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="phishing-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Phishing Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="playbook-library.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Playbook Library</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="rbac-design.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Rbac Design</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="shift-handoff.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Shift Handoff</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="siem-project-planning.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Siem Project Planning</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="sizing-calculator.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Sizing Calculator</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-metrics.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Soc Metrics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-operations.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Soc Operations</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intelligence.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-handbook.html" class="sidebar-nav-link">
                            <i class="fas fa-filter"></i>
                            <span>Triage Handbook</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-methodology.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Triage Methodology</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="tuning-optimization.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Tuning Optimization</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="use-case-lifecycle.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Use Case Lifecycle</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="windows-events.html" class="sidebar-nav-link active">
                            <i class="fas fa-file-alt"></i>
                            <span>Windows Events</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">SOC Operations</a>
                    <span class="separator">/</span>
                    <span class="current">Windows Events</span>
                </div>

                <h1><i class="fab fa-windows"></i> Windows Event Log Analysis</h1>
                <p class="lead">Master Windows event log analysis for security investigations. Learn critical Event IDs, log sources, and analysis techniques for detecting threats.</p>

                <!-- Log Overview -->
                <h2><i class="fas fa-info-circle"></i> Windows Log Overview</h2>
                <div class="config-section">
                    <h4>Key Log Channels</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Log</th><th>Path</th><th>Security Value</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Security</strong></td><td>Security.evtx</td><td>Authentication, authorization, audit</td></tr>
                            <tr><td><strong>System</strong></td><td>System.evtx</td><td>Services, drivers, system changes</td></tr>
                            <tr><td><strong>Application</strong></td><td>Application.evtx</td><td>Application errors, crashes</td></tr>
                            <tr><td><strong>PowerShell</strong></td><td>Microsoft-Windows-PowerShell</td><td>Script execution, commands</td></tr>
                            <tr><td><strong>Sysmon</strong></td><td>Microsoft-Windows-Sysmon</td><td>Enhanced process/network monitoring</td></tr>
                            <tr><td><strong>Windows Defender</strong></td><td>Microsoft-Windows-Windows Defender</td><td>Malware detections</td></tr>
                        </tbody>
                    </table>

                    <h4>Log Locations</h4>
                    <div class="arch-diagram">Default Log Paths:

Windows Logs:
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\System32\winevt\Logs\Application.evtx

PowerShell Logs:
C:\Windows\System32\winevt\Logs\Microsoft-Windows-PowerShell%4Operational.evtx

Sysmon:
C:\Windows\System32\winevt\Logs\Microsoft-Windows-Sysmon%4Operational.evtx

Tools to Read:
- Event Viewer (eventvwr.msc)
- PowerShell Get-WinEvent
- Log Parser
- EvtxECmd (Eric Zimmerman)</div>
                </div>

                <!-- Critical Security Events -->
                <h2><i class="fas fa-shield-alt"></i> Critical Security Event IDs</h2>
                <div class="config-section">
                    <h4>Authentication Events</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th><th>Security Value</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4624</strong></td><td>Successful logon</td><td>Track user access</td></tr>
                            <tr><td><strong>4625</strong></td><td>Failed logon</td><td>Brute force, password spray</td></tr>
                            <tr><td><strong>4634/4647</strong></td><td>Logoff</td><td>Session tracking</td></tr>
                            <tr><td><strong>4648</strong></td><td>Explicit credential logon</td><td>Credential theft, lateral movement</td></tr>
                            <tr><td><strong>4672</strong></td><td>Special privileges assigned</td><td>Admin logons</td></tr>
                            <tr><td><strong>4768</strong></td><td>Kerberos TGT requested</td><td>Initial authentication</td></tr>
                            <tr><td><strong>4769</strong></td><td>Kerberos service ticket</td><td>Kerberoasting</td></tr>
                            <tr><td><strong>4771</strong></td><td>Kerberos pre-auth failed</td><td>Password attacks</td></tr>
                        </tbody>
                    </table>

                    <h4>Logon Types</h4>
                    <div class="arch-diagram">4624 Logon Types:

Type 2:  Interactive (console logon)
Type 3:  Network (file share, etc.)
Type 4:  Batch (scheduled task)
Type 5:  Service (service startup)
Type 7:  Unlock (workstation unlock)
Type 8:  NetworkCleartext (IIS basic auth)
Type 9:  NewCredentials (RunAs /netonly)
Type 10: RemoteInteractive (RDP)
Type 11: CachedInteractive (cached creds)

Key for Detection:
- Type 3 from unusual hosts = lateral movement
- Type 10 from external = RDP exposure
- Type 9 = credential use without logon</div>

                    <h4>Account Management Events</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4720</strong></td><td>User account created</td></tr>
                            <tr><td><strong>4722</strong></td><td>User account enabled</td></tr>
                            <tr><td><strong>4723</strong></td><td>Password change attempted</td></tr>
                            <tr><td><strong>4724</strong></td><td>Password reset attempted</td></tr>
                            <tr><td><strong>4725</strong></td><td>User account disabled</td></tr>
                            <tr><td><strong>4726</strong></td><td>User account deleted</td></tr>
                            <tr><td><strong>4728</strong></td><td>Member added to security group</td></tr>
                            <tr><td><strong>4732</strong></td><td>Member added to local group</td></tr>
                            <tr><td><strong>4756</strong></td><td>Member added to universal group</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Process and Service Events -->
                <h2><i class="fas fa-cogs"></i> Process and Service Events</h2>
                <div class="config-section">
                    <h4>Process Tracking</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th><th>Requires</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4688</strong></td><td>Process created</td><td>Audit Process Creation</td></tr>
                            <tr><td><strong>4689</strong></td><td>Process terminated</td><td>Audit Process Creation</td></tr>
                        </tbody>
                    </table>

                    <div class="arch-diagram">Enable Command Line Logging for 4688:

Group Policy:
Computer Configuration → Administrative Templates → 
System → Audit Process Creation → 
Include command line in process creation events

Registry:
HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit
ProcessCreationIncludeCmdLine_Enabled = 1

Result:
4688 events include full command line - critical for detection!</div>

                    <h4>Service Events (System Log)</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>7034</strong></td><td>Service crashed unexpectedly</td></tr>
                            <tr><td><strong>7035</strong></td><td>Service sent start/stop control</td></tr>
                            <tr><td><strong>7036</strong></td><td>Service started/stopped</td></tr>
                            <tr><td><strong>7040</strong></td><td>Service start type changed</td></tr>
                            <tr><td><strong>7045</strong></td><td>New service installed</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Sysmon Events -->
                <h2><i class="fas fa-eye"></i> Sysmon Events</h2>
                <div class="config-section">
                    <h4>Key Sysmon Event IDs</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th><th>Detection Use</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>1</strong></td><td>Process creation</td><td>Process execution, command lines</td></tr>
                            <tr><td><strong>3</strong></td><td>Network connection</td><td>C2, lateral movement</td></tr>
                            <tr><td><strong>7</strong></td><td>Image loaded (DLL)</td><td>DLL hijacking, injection</td></tr>
                            <tr><td><strong>8</strong></td><td>CreateRemoteThread</td><td>Process injection</td></tr>
                            <tr><td><strong>10</strong></td><td>Process accessed</td><td>Credential dumping (LSASS)</td></tr>
                            <tr><td><strong>11</strong></td><td>File created</td><td>Malware drops, staging</td></tr>
                            <tr><td><strong>12/13/14</strong></td><td>Registry events</td><td>Persistence</td></tr>
                            <tr><td><strong>22</strong></td><td>DNS query</td><td>C2 domains</td></tr>
                            <tr><td><strong>23</strong></td><td>File deleted</td><td>Anti-forensics</td></tr>
                        </tbody>
                    </table>

                    <h4>Sysmon for Detection</h4>
                    <div class="arch-diagram">Sysmon 1 - Process Creation:
- Full command line
- Parent process info
- User and session
- File hashes
- Better than 4688!

Sysmon 10 - Process Access (LSASS):
TargetImage: C:\Windows\System32\lsass.exe
GrantedAccess: 0x1010 or 0x1410 = Suspicious!
Used to detect: mimikatz, credential dumping

Sysmon 3 - Network Connection:
- Source/destination IP
- Process making connection
- User context
- Good for C2 detection</div>
                </div>

                <!-- PowerShell Logging -->
                <h2><i class="fas fa-terminal"></i> PowerShell Logging</h2>
                <div class="config-section">
                    <h4>PowerShell Event IDs</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Log</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4103</strong></td><td>Operational</td><td>Module logging</td></tr>
                            <tr><td><strong>4104</strong></td><td>Operational</td><td>Script block logging</td></tr>
                            <tr><td><strong>4105/4106</strong></td><td>Operational</td><td>Script start/stop</td></tr>
                            <tr><td><strong>400/403</strong></td><td>Windows PowerShell</td><td>Engine start/stop</td></tr>
                        </tbody>
                    </table>

                    <div class="arch-diagram">Enable PowerShell Logging:

Script Block Logging (4104):
- Captures full script content
- Even decoded/deobfuscated
- Critical for investigation

Enable via GPO:
Computer Configuration → Administrative Templates →
Windows Components → Windows PowerShell →
Turn on PowerShell Script Block Logging

Module Logging (4103):
- Pipeline execution details
- Parameter values
- Module usage

Suspicious PowerShell Indicators:
- -EncodedCommand / -enc
- Invoke-Expression / IEX
- DownloadString / DownloadFile
- [System.Reflection.Assembly]
- FromBase64String
- Bypass / Hidden</div>
                </div>

                <!-- Analysis Queries -->
                <h2><i class="fas fa-search"></i> Analysis Queries</h2>
                <div class="config-section">
                    <h4>PowerShell Commands</h4>
                    <div class="arch-diagram"># Failed logons
Get-WinEvent -FilterHashtable @{LogName='Security';ID=4625} -MaxEvents 100 |
Select-Object TimeCreated, @{N='User';E={$_.Properties[5].Value}},
              @{N='Source';E={$_.Properties[19].Value}}

# New services
Get-WinEvent -FilterHashtable @{LogName='System';ID=7045} |
Select-Object TimeCreated, @{N='ServiceName';E={$_.Properties[0].Value}},
              @{N='ImagePath';E={$_.Properties[1].Value}}

# Process creation (4688)
Get-WinEvent -FilterHashtable @{LogName='Security';ID=4688} -MaxEvents 50 |
Select-Object TimeCreated, @{N='Process';E={$_.Properties[5].Value}},
              @{N='CommandLine';E={$_.Properties[8].Value}}

# Sysmon process creation
Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-Sysmon/Operational';ID=1} |
Select-Object TimeCreated, @{N='Image';E={$_.Properties[4].Value}},
              @{N='CommandLine';E={$_.Properties[10].Value}}</div>

                    <h4>SIEM Queries</h4>
                    <div class="arch-diagram">// Splunk - Failed logons
index=windows EventCode=4625
| stats count by Account_Name, Source_Network_Address
| where count > 5

// KQL - Suspicious service installation
Event
| where EventLog == "System" and EventID == 7045
| where RenderedDescription has_any ("cmd", "powershell", "temp")
| project TimeGenerated, Computer, RenderedDescription

// Splunk - PowerShell encoded commands
index=windows EventCode=4104
| search ScriptBlockText="*-enc*" OR ScriptBlockText="*FromBase64*"
| table _time, ComputerName, ScriptBlockText</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What Windows Event IDs indicate lateral movement?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>4624 Type 3:</strong> Network logon to share/resource</li>
                                <li><strong>4624 Type 10:</strong> RDP logon</li>
                                <li><strong>4648:</strong> Explicit credentials used</li>
                                <li><strong>4672:</strong> Admin privileges on new logon</li>
                                <li><strong>7045:</strong> New service (PsExec creates service)</li>
                            </ul>
                            <p style="margin-top: 12px;">Look for these events with unusual source hosts or accounts.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you detect credential dumping?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Sysmon 10:</strong> Process access to LSASS</li>
                                <li><strong>4688:</strong> Process like mimikatz, procdump</li>
                                <li><strong>4103/4104:</strong> PowerShell sekurlsa commands</li>
                                <li><strong>4672:</strong> SeDebugPrivilege assigned</li>
                            </ul>
                            <p style="margin-top: 12px;">Sysmon 10 with TargetImage=lsass.exe is the best detection.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Why is Sysmon better than native logging?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>More detail:</strong> Hashes, parent process, command lines</li>
                                <li><strong>Network logging:</strong> Process-to-network mapping</li>
                                <li><strong>Registry/File:</strong> Detailed change tracking</li>
                                <li><strong>LSASS access:</strong> Critical for credential theft</li>
                                <li><strong>Configurable:</strong> Filter noise, capture what matters</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>