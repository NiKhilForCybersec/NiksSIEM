<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows Event Log Analysis | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Operations</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-bar"></i> Metrics & KPIs</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Alert Management</div>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-filter"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-tags"></i> Classification</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-map"></i> MITRE Mapping</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="incident-response.html" class="nav-link"><i class="fas fa-fire-extinguisher"></i> IR Process</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-lock"></i> Containment</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-plug"></i> IR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Analysis Guides</div>
                    <a href="log-analysis.html" class="nav-link"><i class="fas fa-file-alt"></i> Log Analysis</a>
                    <a href="malware-analysis.html" class="nav-link"><i class="fas fa-bug"></i> Malware Analysis</a>
                    <a href="phishing-analysis.html" class="nav-link"><i class="fas fa-fish"></i> Phishing Analysis</a>
                    <a href="forensics.html" class="nav-link"><i class="fas fa-microscope"></i> Forensics</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Domains</div>
                    <a href="identity-security.html" class="nav-link"><i class="fas fa-user-shield"></i> Identity Security</a>
                    <a href="network-security.html" class="nav-link"><i class="fas fa-network-wired"></i> Network Security</a>
                    <a href="cloud-security.html" class="nav-link"><i class="fas fa-cloud"></i> Cloud Security</a>
                    <a href="threat-intelligence.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Governance</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> SIEM Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Priority</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Compliance</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Operations</a><span class="separator">/</span>
                    <span class="current">Windows Event Logs</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fab fa-windows"></i> Windows Event Log Analysis</h1>
                <p class="lead">Master Windows event log analysis for security investigations. Learn critical Event IDs, log sources, and analysis techniques for detecting threats.</p>

                <!-- Log Overview -->
                <h2><i class="fas fa-info-circle"></i> Windows Log Overview</h2>
                <div class="config-section">
                    <h4>Key Log Channels</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Log</th><th>Path</th><th>Security Value</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Security</strong></td><td>Security.evtx</td><td>Authentication, authorization, audit</td></tr>
                            <tr><td><strong>System</strong></td><td>System.evtx</td><td>Services, drivers, system changes</td></tr>
                            <tr><td><strong>Application</strong></td><td>Application.evtx</td><td>Application errors, crashes</td></tr>
                            <tr><td><strong>PowerShell</strong></td><td>Microsoft-Windows-PowerShell</td><td>Script execution, commands</td></tr>
                            <tr><td><strong>Sysmon</strong></td><td>Microsoft-Windows-Sysmon</td><td>Enhanced process/network monitoring</td></tr>
                            <tr><td><strong>Windows Defender</strong></td><td>Microsoft-Windows-Windows Defender</td><td>Malware detections</td></tr>
                        </tbody>
                    </table>

                    <h4>Log Locations</h4>
                    <div class="code-block">Default Log Paths:

Windows Logs:
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\System32\winevt\Logs\Application.evtx

PowerShell Logs:
C:\Windows\System32\winevt\Logs\Microsoft-Windows-PowerShell%4Operational.evtx

Sysmon:
C:\Windows\System32\winevt\Logs\Microsoft-Windows-Sysmon%4Operational.evtx

Tools to Read:
- Event Viewer (eventvwr.msc)
- PowerShell Get-WinEvent
- Log Parser
- EvtxECmd (Eric Zimmerman)</div>
                </div>

                <!-- Critical Security Events -->
                <h2><i class="fas fa-shield-alt"></i> Critical Security Event IDs</h2>
                <div class="config-section">
                    <h4>Authentication Events</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th><th>Security Value</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4624</strong></td><td>Successful logon</td><td>Track user access</td></tr>
                            <tr><td><strong>4625</strong></td><td>Failed logon</td><td>Brute force, password spray</td></tr>
                            <tr><td><strong>4634/4647</strong></td><td>Logoff</td><td>Session tracking</td></tr>
                            <tr><td><strong>4648</strong></td><td>Explicit credential logon</td><td>Credential theft, lateral movement</td></tr>
                            <tr><td><strong>4672</strong></td><td>Special privileges assigned</td><td>Admin logons</td></tr>
                            <tr><td><strong>4768</strong></td><td>Kerberos TGT requested</td><td>Initial authentication</td></tr>
                            <tr><td><strong>4769</strong></td><td>Kerberos service ticket</td><td>Kerberoasting</td></tr>
                            <tr><td><strong>4771</strong></td><td>Kerberos pre-auth failed</td><td>Password attacks</td></tr>
                        </tbody>
                    </table>

                    <h4>Logon Types</h4>
                    <div class="code-block">4624 Logon Types:

Type 2:  Interactive (console logon)
Type 3:  Network (file share, etc.)
Type 4:  Batch (scheduled task)
Type 5:  Service (service startup)
Type 7:  Unlock (workstation unlock)
Type 8:  NetworkCleartext (IIS basic auth)
Type 9:  NewCredentials (RunAs /netonly)
Type 10: RemoteInteractive (RDP)
Type 11: CachedInteractive (cached creds)

Key for Detection:
- Type 3 from unusual hosts = lateral movement
- Type 10 from external = RDP exposure
- Type 9 = credential use without logon</div>

                    <h4>Account Management Events</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4720</strong></td><td>User account created</td></tr>
                            <tr><td><strong>4722</strong></td><td>User account enabled</td></tr>
                            <tr><td><strong>4723</strong></td><td>Password change attempted</td></tr>
                            <tr><td><strong>4724</strong></td><td>Password reset attempted</td></tr>
                            <tr><td><strong>4725</strong></td><td>User account disabled</td></tr>
                            <tr><td><strong>4726</strong></td><td>User account deleted</td></tr>
                            <tr><td><strong>4728</strong></td><td>Member added to security group</td></tr>
                            <tr><td><strong>4732</strong></td><td>Member added to local group</td></tr>
                            <tr><td><strong>4756</strong></td><td>Member added to universal group</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Process and Service Events -->
                <h2><i class="fas fa-cogs"></i> Process and Service Events</h2>
                <div class="config-section">
                    <h4>Process Tracking</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th><th>Requires</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4688</strong></td><td>Process created</td><td>Audit Process Creation</td></tr>
                            <tr><td><strong>4689</strong></td><td>Process terminated</td><td>Audit Process Creation</td></tr>
                        </tbody>
                    </table>

                    <div class="code-block">Enable Command Line Logging for 4688:

Group Policy:
Computer Configuration → Administrative Templates → 
System → Audit Process Creation → 
Include command line in process creation events

Registry:
HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit
ProcessCreationIncludeCmdLine_Enabled = 1

Result:
4688 events include full command line - critical for detection!</div>

                    <h4>Service Events (System Log)</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>7034</strong></td><td>Service crashed unexpectedly</td></tr>
                            <tr><td><strong>7035</strong></td><td>Service sent start/stop control</td></tr>
                            <tr><td><strong>7036</strong></td><td>Service started/stopped</td></tr>
                            <tr><td><strong>7040</strong></td><td>Service start type changed</td></tr>
                            <tr><td><strong>7045</strong></td><td>New service installed</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Sysmon Events -->
                <h2><i class="fas fa-eye"></i> Sysmon Events</h2>
                <div class="config-section">
                    <h4>Key Sysmon Event IDs</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th><th>Detection Use</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>1</strong></td><td>Process creation</td><td>Process execution, command lines</td></tr>
                            <tr><td><strong>3</strong></td><td>Network connection</td><td>C2, lateral movement</td></tr>
                            <tr><td><strong>7</strong></td><td>Image loaded (DLL)</td><td>DLL hijacking, injection</td></tr>
                            <tr><td><strong>8</strong></td><td>CreateRemoteThread</td><td>Process injection</td></tr>
                            <tr><td><strong>10</strong></td><td>Process accessed</td><td>Credential dumping (LSASS)</td></tr>
                            <tr><td><strong>11</strong></td><td>File created</td><td>Malware drops, staging</td></tr>
                            <tr><td><strong>12/13/14</strong></td><td>Registry events</td><td>Persistence</td></tr>
                            <tr><td><strong>22</strong></td><td>DNS query</td><td>C2 domains</td></tr>
                            <tr><td><strong>23</strong></td><td>File deleted</td><td>Anti-forensics</td></tr>
                        </tbody>
                    </table>

                    <h4>Sysmon for Detection</h4>
                    <div class="code-block">Sysmon 1 - Process Creation:
- Full command line
- Parent process info
- User and session
- File hashes
- Better than 4688!

Sysmon 10 - Process Access (LSASS):
TargetImage: C:\Windows\System32\lsass.exe
GrantedAccess: 0x1010 or 0x1410 = Suspicious!
Used to detect: mimikatz, credential dumping

Sysmon 3 - Network Connection:
- Source/destination IP
- Process making connection
- User context
- Good for C2 detection</div>
                </div>

                <!-- PowerShell Logging -->
                <h2><i class="fas fa-terminal"></i> PowerShell Logging</h2>
                <div class="config-section">
                    <h4>PowerShell Event IDs</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Log</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4103</strong></td><td>Operational</td><td>Module logging</td></tr>
                            <tr><td><strong>4104</strong></td><td>Operational</td><td>Script block logging</td></tr>
                            <tr><td><strong>4105/4106</strong></td><td>Operational</td><td>Script start/stop</td></tr>
                            <tr><td><strong>400/403</strong></td><td>Windows PowerShell</td><td>Engine start/stop</td></tr>
                        </tbody>
                    </table>

                    <div class="code-block">Enable PowerShell Logging:

Script Block Logging (4104):
- Captures full script content
- Even decoded/deobfuscated
- Critical for investigation

Enable via GPO:
Computer Configuration → Administrative Templates →
Windows Components → Windows PowerShell →
Turn on PowerShell Script Block Logging

Module Logging (4103):
- Pipeline execution details
- Parameter values
- Module usage

Suspicious PowerShell Indicators:
- -EncodedCommand / -enc
- Invoke-Expression / IEX
- DownloadString / DownloadFile
- [System.Reflection.Assembly]
- FromBase64String
- Bypass / Hidden</div>
                </div>

                <!-- Analysis Queries -->
                <h2><i class="fas fa-search"></i> Analysis Queries</h2>
                <div class="config-section">
                    <h4>PowerShell Commands</h4>
                    <div class="code-block"># Failed logons
Get-WinEvent -FilterHashtable @{LogName='Security';ID=4625} -MaxEvents 100 |
Select-Object TimeCreated, @{N='User';E={$_.Properties[5].Value}},
              @{N='Source';E={$_.Properties[19].Value}}

# New services
Get-WinEvent -FilterHashtable @{LogName='System';ID=7045} |
Select-Object TimeCreated, @{N='ServiceName';E={$_.Properties[0].Value}},
              @{N='ImagePath';E={$_.Properties[1].Value}}

# Process creation (4688)
Get-WinEvent -FilterHashtable @{LogName='Security';ID=4688} -MaxEvents 50 |
Select-Object TimeCreated, @{N='Process';E={$_.Properties[5].Value}},
              @{N='CommandLine';E={$_.Properties[8].Value}}

# Sysmon process creation
Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-Sysmon/Operational';ID=1} |
Select-Object TimeCreated, @{N='Image';E={$_.Properties[4].Value}},
              @{N='CommandLine';E={$_.Properties[10].Value}}</div>

                    <h4>SIEM Queries</h4>
                    <div class="code-block">// Splunk - Failed logons
index=windows EventCode=4625
| stats count by Account_Name, Source_Network_Address
| where count > 5

// KQL - Suspicious service installation
Event
| where EventLog == "System" and EventID == 7045
| where RenderedDescription has_any ("cmd", "powershell", "temp")
| project TimeGenerated, Computer, RenderedDescription

// Splunk - PowerShell encoded commands
index=windows EventCode=4104
| search ScriptBlockText="*-enc*" OR ScriptBlockText="*FromBase64*"
| table _time, ComputerName, ScriptBlockText</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What Windows Event IDs indicate lateral movement?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>4624 Type 3:</strong> Network logon to share/resource</li>
                                <li><strong>4624 Type 10:</strong> RDP logon</li>
                                <li><strong>4648:</strong> Explicit credentials used</li>
                                <li><strong>4672:</strong> Admin privileges on new logon</li>
                                <li><strong>7045:</strong> New service (PsExec creates service)</li>
                            </ul>
                            <p style="margin-top: 12px;">Look for these events with unusual source hosts or accounts.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you detect credential dumping?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Sysmon 10:</strong> Process access to LSASS</li>
                                <li><strong>4688:</strong> Process like mimikatz, procdump</li>
                                <li><strong>4103/4104:</strong> PowerShell sekurlsa commands</li>
                                <li><strong>4672:</strong> SeDebugPrivilege assigned</li>
                            </ul>
                            <p style="margin-top: 12px;">Sysmon 10 with TargetImage=lsass.exe is the best detection.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Why is Sysmon better than native logging?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>More detail:</strong> Hashes, parent process, command lines</li>
                                <li><strong>Network logging:</strong> Process-to-network mapping</li>
                                <li><strong>Registry/File:</strong> Detailed change tracking</li>
                                <li><strong>LSASS access:</strong> Critical for credential theft</li>
                                <li><strong>Configurable:</strong> Filter noise, capture what matters</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>