<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Security Monitoring | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Operations</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-bar"></i> Metrics & KPIs</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Alert Management</div>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-filter"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-tags"></i> Classification</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-map"></i> MITRE Mapping</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="incident-response.html" class="nav-link"><i class="fas fa-fire-extinguisher"></i> IR Process</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-lock"></i> Containment</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-plug"></i> IR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Analysis Guides</div>
                    <a href="log-analysis.html" class="nav-link"><i class="fas fa-file-alt"></i> Log Analysis</a>
                    <a href="malware-analysis.html" class="nav-link"><i class="fas fa-bug"></i> Malware Analysis</a>
                    <a href="phishing-analysis.html" class="nav-link"><i class="fas fa-fish"></i> Phishing Analysis</a>
                    <a href="forensics.html" class="nav-link"><i class="fas fa-microscope"></i> Forensics</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Domains</div>
                    <a href="identity-security.html" class="nav-link"><i class="fas fa-user-shield"></i> Identity Security</a>
                    <a href="network-security.html" class="nav-link active"><i class="fas fa-network-wired"></i> Network Security</a>
                    <a href="cloud-security.html" class="nav-link"><i class="fas fa-cloud"></i> Cloud Security</a>
                    <a href="threat-intelligence.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Governance</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> SIEM Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Priority</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Compliance</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Operations</a><span class="separator">/</span>
                    <span class="current">Network Security Monitoring</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-network-wired"></i> Network Security Monitoring</h1>
                <p class="lead">Essential network security monitoring techniques for SOC analysts. Learn to analyze firewall logs, IDS/IPS alerts, DNS traffic, and detect network-based threats.</p>

                <!-- NSM Overview -->
                <h2><i class="fas fa-info-circle"></i> Network Security Monitoring Overview</h2>
                <div class="config-section">
                    <h4>Key Data Sources</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Source</th><th>Data Type</th><th>Security Value</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Firewall</strong></td><td>Allow/deny logs</td><td>Perimeter visibility, policy violations</td></tr>
                            <tr><td><strong>IDS/IPS</strong></td><td>Signature alerts</td><td>Known attack detection</td></tr>
                            <tr><td><strong>Proxy</strong></td><td>HTTP/HTTPS logs</td><td>Web activity, malware delivery</td></tr>
                            <tr><td><strong>DNS</strong></td><td>Query/response</td><td>C2 detection, DGA, tunneling</td></tr>
                            <tr><td><strong>NetFlow</strong></td><td>Traffic metadata</td><td>Traffic patterns, anomalies</td></tr>
                            <tr><td><strong>PCAP</strong></td><td>Full packet capture</td><td>Deep inspection, forensics</td></tr>
                        </tbody>
                    </table>

                    <h4>Defense in Depth</h4>
                    <div class="code-block">Network Security Layers:

PERIMETER:
├── Firewall (allow/deny)
├── IPS (block attacks)
├── WAF (web app protection)
└── DDoS mitigation

INTERNAL:
├── Network segmentation
├── Internal firewalls
├── Microsegmentation
└── East-west monitoring

ENDPOINT-TO-NETWORK:
├── Proxy servers
├── DNS security
├── Email gateway
└── VPN/ZTNA</div>
                </div>

                <!-- Firewall Log Analysis -->
                <h2><i class="fas fa-shield-alt"></i> Firewall Log Analysis</h2>
                <div class="config-section">
                    <h4>Key Firewall Fields</h4>
                    <div class="code-block">Common Firewall Log Fields:

FLOW INFORMATION:
- src_ip: Source IP address
- dst_ip: Destination IP address
- src_port: Source port
- dst_port: Destination port
- protocol: TCP/UDP/ICMP

ACTION:
- action: allow/deny/drop/reset
- rule: Rule that matched

METADATA:
- bytes_sent/received: Data volume
- packets: Packet count
- session_duration: Connection time
- application: L7 application identified</div>

                    <h4>Firewall Analysis Queries</h4>
                    <div class="code-block">// Splunk - Denied traffic summary
index=firewall action=denied
| stats count by src_ip, dst_ip, dst_port
| sort -count
| head 20

// Splunk - Outbound to rare destinations
index=firewall action=allowed direction=outbound
| stats dc(src_ip) as sources by dst_ip
| where sources == 1
| sort -count

// KQL - High volume connections
CommonSecurityLog
| where DeviceAction == "allow"
| summarize TotalBytes = sum(SentBytes + ReceivedBytes) by SourceIP, DestinationIP
| where TotalBytes > 1000000000
| order by TotalBytes desc

// Suspicious port usage
index=firewall action=allowed
| where dst_port IN (4444, 5555, 6666, 1337, 31337)
| table _time, src_ip, dst_ip, dst_port, bytes</div>

                    <h4>Suspicious Patterns</h4>
                    <div class="code-block">Firewall Red Flags:

RECONNAISSANCE:
- Port scans (many ports, one target)
- Host scans (many targets, one port)
- ICMP sweeps

LATERAL MOVEMENT:
- Internal to internal on unusual ports
- Server-to-workstation connections
- RDP/SSH from unusual sources

DATA EXFILTRATION:
- Large outbound transfers
- Connections to rare destinations
- Non-standard ports for protocols

C2 INDICATORS:
- Beaconing patterns (regular intervals)
- DNS over non-53 ports
- Encrypted traffic on HTTP ports</div>
                </div>

                <!-- IDS/IPS Analysis -->
                <h2><i class="fas fa-bell"></i> IDS/IPS Alert Analysis</h2>
                <div class="config-section">
                    <h4>Common IDS/IPS Platforms</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Platform</th><th>Type</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Snort</td><td>Open source IDS/IPS</td></tr>
                            <tr><td>Suricata</td><td>Open source IDS/IPS</td></tr>
                            <tr><td>Zeek (Bro)</td><td>Network analysis framework</td></tr>
                            <tr><td>Palo Alto</td><td>NGFW with IPS</td></tr>
                            <tr><td>Cisco Firepower</td><td>NGFW/IPS</td></tr>
                        </tbody>
                    </table>

                    <h4>Alert Triage</h4>
                    <div class="code-block">IDS Alert Triage Process:

1. UNDERSTAND THE ALERT
   - What signature triggered?
   - What attack does it detect?
   - What's the severity?

2. CHECK CONTEXT
   - Source and destination
   - Is target vulnerable?
   - Is traffic expected?

3. VALIDATE
   - Check packet payload if available
   - Review related traffic
   - Check endpoint for compromise

4. DISPOSITION
   - True Positive: Escalate, respond
   - False Positive: Tune rule
   - True Negative: Document
   - False Negative: Improve detection

Common False Positives:
- Vulnerability scanners
- Penetration testing
- Legitimate admin tools
- Misconfigured signatures</div>

                    <h4>Snort/Suricata Rule Analysis</h4>
                    <div class="code-block">Understanding IDS Rules:

alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (
  msg:"EXPLOIT MS17-010 EternalBlue Attempt";
  flow:to_server,established;
  content:"|FF|SMB";
  content:"|23 00 00 00 07 00|";
  classtype:attempted-admin;
  sid:41978;
  rev:1;
)

Rule Components:
- Action: alert (log), drop (block), pass (ignore)
- Protocol: tcp, udp, icmp
- Source/Dest: IP and port ranges
- Direction: -> (one-way), <> (bidirectional)
- Options: content matches, flow conditions

Key Options:
- msg: Alert message
- content: Byte pattern to match
- pcre: Regex matching
- flow: Connection state
- classtype: Attack category
- sid: Signature ID</div>
                </div>

                <!-- DNS Analysis -->
                <h2><i class="fas fa-globe"></i> DNS Traffic Analysis</h2>
                <div class="config-section">
                    <h4>DNS Security Threats</h4>
                    <div class="code-block">DNS-Based Attacks:

C2 COMMUNICATION:
- Malware queries C2 domain
- DGA (Domain Generation Algorithm)
- Fast-flux DNS

DNS TUNNELING:
- Data encoded in DNS queries
- Exfiltration via DNS
- Bypass network controls

DNS HIJACKING:
- Redirecting queries
- Man-in-the-middle
- Cache poisoning

INDICATORS:
- High query volume from single host
- Long subdomain names (tunneling)
- High entropy domain names (DGA)
- Queries to rare TLDs
- TXT record abuse</div>

                    <h4>DNS Analysis Queries</h4>
                    <div class="code-block">// Splunk - DNS query volume by host
index=dns
| stats count by src_ip, query
| sort -count

// High volume DNS (potential tunneling)
index=dns
| stats count as queries by src_ip
| where queries > 10000
| sort -queries

// Long subdomain names (tunneling indicator)
index=dns
| eval subdomain_length = len(mvindex(split(query, "."), 0))
| where subdomain_length > 30
| table _time, src_ip, query, subdomain_length

// KQL - Rare domain queries
DnsEvents
| summarize QueryCount = count(), Hosts = dcount(Computer) by Name
| where Hosts == 1 and QueryCount > 100
| order by QueryCount desc

// Potential DGA detection (high entropy)
index=dns
| eval entropy = /* entropy calculation */
| where entropy > 3.5
| table _time, src_ip, query</div>
                </div>

                <!-- Proxy Log Analysis -->
                <h2><i class="fas fa-server"></i> Proxy Log Analysis</h2>
                <div class="config-section">
                    <h4>Key Proxy Fields</h4>
                    <div class="code-block">Proxy Log Fields:

REQUEST:
- src_ip: Client IP
- user: Authenticated user
- url: Full URL requested
- domain: Destination domain
- method: GET/POST/PUT/etc.
- user_agent: Browser/application

RESPONSE:
- status_code: HTTP response code
- bytes: Response size
- content_type: MIME type
- category: URL category

SECURITY:
- action: allowed/blocked
- threat_name: If malware detected
- ssl_decrypted: If inspected</div>

                    <h4>Proxy Analysis Queries</h4>
                    <div class="code-block">// Blocked requests by category
index=proxy action=blocked
| stats count by category
| sort -count

// Unusual user agents
index=proxy
| stats count by user_agent
| where count < 10
| sort count

// Large downloads
index=proxy method=GET
| where bytes > 100000000
| table _time, src_ip, user, url, bytes

// POST to rare domains
index=proxy method=POST
| stats dc(src_ip) as sources by domain
| where sources == 1

// Uncategorized domains (potential malicious)
index=proxy category="uncategorized"
| stats count by domain, src_ip
| sort -count</div>
                </div>

                <!-- NetFlow Analysis -->
                <h2><i class="fas fa-exchange-alt"></i> NetFlow Analysis</h2>
                <div class="config-section">
                    <h4>NetFlow Fields</h4>
                    <div class="code-block">NetFlow v5/v9 Key Fields:

- src_ip, dst_ip: Source/destination
- src_port, dst_port: Ports
- protocol: IP protocol number
- bytes: Total bytes
- packets: Packet count
- tcp_flags: TCP flags observed
- start_time, end_time: Flow timing
- input_int, output_int: Interfaces

Advantages:
- Lightweight (metadata only)
- Long retention possible
- Good for pattern analysis
- East-west visibility

Limitations:
- No payload inspection
- Encrypted traffic opaque
- May miss short flows</div>

                    <h4>Flow Analysis Use Cases</h4>
                    <div class="code-block">NetFlow Analysis Patterns:

BEACONING:
- Regular time intervals
- Consistent byte sizes
- Same src/dst pair

DATA EXFILTRATION:
- Large outbound flows
- Unusual destination countries
- After-hours transfers

LATERAL MOVEMENT:
- Internal scanning
- Unusual server-to-server
- Cross-segment traffic

QUERY EXAMPLE:
// Splunk - Large internal transfers
index=netflow src_ip=10.* dst_ip=10.*
| where bytes > 1000000000
| stats sum(bytes) as total_bytes by src_ip, dst_ip
| sort -total_bytes</div>
                </div>

                <!-- PCAP Analysis -->
                <h2><i class="fas fa-file-archive"></i> Packet Capture Analysis</h2>
                <div class="config-section">
                    <h4>Wireshark Essentials</h4>
                    <div class="code-block">Wireshark Display Filters:

BASIC:
ip.addr == 192.168.1.100
tcp.port == 443
http
dns

PROTOCOL SPECIFIC:
http.request.method == "POST"
dns.qry.name contains "evil"
tcp.flags.syn == 1 and tcp.flags.ack == 0

CONVERSATIONS:
tcp.stream eq 5
Follow → TCP Stream

SECURITY FOCUSED:
tcp.port == 4444
http.request.uri contains "cmd"
frame contains "password"

Export Objects:
File → Export Objects → HTTP</div>

                    <h4>tcpdump Commands</h4>
                    <div class="code-block"># Capture all traffic on interface
tcpdump -i eth0 -w capture.pcap

# Capture specific host
tcpdump -i eth0 host 192.168.1.100 -w capture.pcap

# Capture specific port
tcpdump -i eth0 port 443 -w capture.pcap

# Read and filter
tcpdump -r capture.pcap 'tcp port 80'

# Show packet contents
tcpdump -r capture.pcap -X

# Capture with rotation
tcpdump -i eth0 -w capture-%H.pcap -G 3600</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you detect DNS tunneling?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Long subdomains:</strong> Encoded data in subdomain</li>
                                <li><strong>High query volume:</strong> Unusual queries per host</li>
                                <li><strong>TXT record abuse:</strong> Large TXT responses</li>
                                <li><strong>High entropy:</strong> Random-looking domain names</li>
                                <li><strong>Unusual timing:</strong> Queries at regular intervals</li>
                            </ul>
                            <p style="margin-top: 12px;">DNS tunneling encodes data in DNS queries/responses to bypass network controls.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between IDS and IPS?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>IDS (Detection):</strong> Monitors and alerts, passive</li>
                                <li><strong>IPS (Prevention):</strong> Monitors, alerts, AND blocks</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>IDS:</strong> Out-of-band, copies traffic, no impact on flow. <strong>IPS:</strong> Inline, can drop malicious packets, may cause latency or false positive blocks.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you investigate a potential C2 communication?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Check firewall:</strong> Destination IP reputation, frequency</li>
                                <li><strong>Analyze timing:</strong> Look for beaconing patterns</li>
                                <li><strong>Check DNS:</strong> Domain registration, DGA characteristics</li>
                                <li><strong>Inspect proxy:</strong> User agent, URL patterns</li>
                                <li><strong>Review PCAP:</strong> Protocol analysis, payload inspection</li>
                                <li><strong>Check endpoint:</strong> What process is making connections?</li>
                            </ol>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>