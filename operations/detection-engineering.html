<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detection Engineering | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link active" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">SOC Operations Pages</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="audit-preparation.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Audit Preparation</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="cloud-security.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Cloud Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="compliance-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Compliance Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="containment-procedures.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Containment Procedures</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-source-priority.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Source Priority</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="detection-engineering.html" class="sidebar-nav-link active">
                            <i class="fas fa-search"></i>
                            <span>Detection Engineering</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="escalation-matrix.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Escalation Matrix</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="forensics.html" class="sidebar-nav-link">
                            <i class="fas fa-microscope"></i>
                            <span>Forensics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="identity-security.html" class="sidebar-nav-link">
                            <i class="fas fa-user-shield"></i>
                            <span>Identity Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-classification.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Classification</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-response.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Response</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="ir-integration.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Ir Integration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="log-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Log Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="malware-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-virus"></i>
                            <span>Malware Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="metrics-kpis.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Metrics Kpis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="migration-guide.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Migration Guide</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="mitre-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-chess"></i>
                            <span>Mitre Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="network-security.html" class="sidebar-nav-link">
                            <i class="fas fa-network-wired"></i>
                            <span>Network Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="phishing-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Phishing Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="playbook-library.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Playbook Library</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="rbac-design.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Rbac Design</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="shift-handoff.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Shift Handoff</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="siem-project-planning.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Siem Project Planning</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="sizing-calculator.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Sizing Calculator</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-metrics.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Soc Metrics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-operations.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Soc Operations</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intelligence.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-handbook.html" class="sidebar-nav-link">
                            <i class="fas fa-filter"></i>
                            <span>Triage Handbook</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-methodology.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Triage Methodology</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="tuning-optimization.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Tuning Optimization</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="use-case-lifecycle.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Use Case Lifecycle</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="windows-events.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Windows Events</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">SOC Operations</a>
                    <span class="separator">/</span>
                    <span class="current">Detection Engineering</span>
                </div>

                <h1><i class="fas fa-cog"></i> Detection Engineering</h1>
                <p class="lead">Master the art and science of building security detections. Learn methodologies, detection patterns, testing frameworks, and how to operationalize threat intelligence into actionable alerts.</p>

                <!-- Detection Engineering Overview -->
                <h2><i class="fas fa-info-circle"></i> Detection Engineering Overview</h2>
                <div class="config-section">
                    <h4>What is Detection Engineering?</h4>
                    <div class="arch-diagram">Detection Engineering Definition:

The systematic practice of designing, building, testing, and 
maintaining security detections to identify threats, attacks, 
and policy violations in enterprise environments.

KEY RESPONSIBILITIES:
├── Design detection strategies
├── Write detection rules (queries, signatures)
├── Test and validate detections
├── Tune for accuracy (reduce FP/FN)
├── Map to threat frameworks (MITRE ATT&CK)
├── Maintain detection inventory
├── Collaborate with threat intel and IR
└── Measure detection effectiveness

DETECTION ENGINEER SKILLS:
├── Strong query language skills (KQL, SPL, XQL)
├── Understanding of attack techniques
├── Knowledge of data sources and logging
├── Statistical analysis for anomaly detection
├── Programming/scripting (Python, etc.)
├── Threat intelligence integration
└── Security domain expertise

DETECTION TYPES:
├── Signature-based: Known patterns, IOCs
├── Behavioral: Anomalies, deviations from baseline
├── Correlation: Multiple events combined
├── Threshold: Volume/frequency based
└── ML/Statistical: Probabilistic detection</div>

                    <h4>Detection Engineering Maturity</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Level</th><th>Characteristics</th><th>Capabilities</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Level 1</strong></td><td>Ad-hoc</td><td>Vendor defaults, reactive rule creation</td></tr>
                            <tr><td><strong>Level 2</strong></td><td>Defined</td><td>Documented process, some custom rules</td></tr>
                            <tr><td><strong>Level 3</strong></td><td>Repeatable</td><td>Systematic development, testing framework</td></tr>
                            <tr><td><strong>Level 4</strong></td><td>Managed</td><td>Metrics-driven, continuous improvement</td></tr>
                            <tr><td><strong>Level 5</strong></td><td>Optimizing</td><td>Automated testing, ML-enhanced, threat-aligned</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Detection Development Lifecycle -->
                <h2><i class="fas fa-recycle"></i> Detection Development Lifecycle</h2>
                <div class="config-section">
                    <h4>Lifecycle Phases</h4>
                    <div class="arch-diagram">Detection Development Lifecycle:

┌──────────────────────────────────────────────────────────────┐
│                                                              │
│    ┌─────────┐    ┌─────────┐    ┌─────────┐               │
│    │RESEARCH │───▶│ DESIGN  │───▶│  BUILD  │               │
│    │         │    │         │    │         │               │
│    └─────────┘    └─────────┘    └─────────┘               │
│         │                              │                    │
│         │    ┌─────────────────────────┘                    │
│         │    │                                              │
│         │    ▼                                              │
│    ┌─────────┐    ┌─────────┐    ┌─────────┐               │
│    │MAINTAIN │◀───│ DEPLOY  │◀───│  TEST   │               │
│    │         │    │         │    │         │               │
│    └─────────┘    └─────────┘    └─────────┘               │
│         │                                                   │
│         └──────────────────────────────────────────────────┐│
│                                                            ││
│    ┌─────────┐                                             ││
│    │ RETIRE  │◀────────────────────────────────────────────┘│
│    │         │                                              │
│    └─────────┘                                              │
│                                                              │
└──────────────────────────────────────────────────────────────┘

1. RESEARCH
   ├── Threat intelligence analysis
   ├── Attack technique understanding
   ├── Data source identification
   └── Prior art review

2. DESIGN
   ├── Detection logic planning
   ├── Data requirements mapping
   ├── Expected output definition
   └── False positive estimation

3. BUILD
   ├── Write detection query/rule
   ├── Entity mapping
   ├── Severity assignment
   └── Documentation

4. TEST
   ├── Validation with test data
   ├── Attack simulation (red team)
   ├── False positive analysis
   └── Performance testing

5. DEPLOY
   ├── Enable in production
   ├── Configure alerting
   ├── Create response playbook
   └── Analyst training

6. MAINTAIN
   ├── Monitor effectiveness
   ├── Tune for accuracy
   ├── Update for new threats
   └── Document changes

7. RETIRE
   ├── Superseded by better detection
   ├── Threat no longer relevant
   └── Archive documentation</div>
                </div>

                <!-- Detection Patterns -->
                <h2><i class="fas fa-puzzle-piece"></i> Detection Patterns</h2>
                <div class="config-section">
                    <h4>Common Detection Patterns</h4>
                    <div class="arch-diagram">Detection Pattern Categories:

1. THRESHOLD-BASED
   // Alert when count exceeds threshold
   | summarize count() by User
   | where count_ > threshold
   
   Use: Brute force, scanning, anomalous volume

2. BLACKLIST/BLOCKLIST
   // Match against known bad indicators
   | where Hash in (known_malware_hashes)
   | where Domain in (known_c2_domains)
   
   Use: IOC matching, threat intel integration

3. WHITELIST DEVIATION
   // Alert when NOT in approved list
   | where Process !in (approved_processes)
   | where User !in (authorized_users)
   
   Use: Application whitelisting, access control

4. SEQUENCE/CHAIN
   // Multiple events in specific order
   Event A → Event B → Event C within timeframe
   
   Use: Multi-stage attacks, kill chain detection

5. STATISTICAL ANOMALY
   // Deviation from baseline
   | where count_ > avg + (3 * stdev)
   
   Use: UEBA, behavioral detection

6. RARE/FIRST-SEEN
   // New or rarely observed activity
   | where dcount(hosts_seen) < 3
   | join kind=leftanti historical_data
   
   Use: Zero-day, novel malware

7. TIME-BASED
   // Activity outside normal hours
   | where hour !between (8 .. 18)
   | where dayofweek in (0, 6)
   
   Use: Off-hours activity, insider threat

8. CORRELATION
   // Combine multiple data sources
   auth_failures join successful_login on IP
   within 5 minutes
   
   Use: Attack progression, context enrichment</div>

                    <h4>Pattern Implementation Examples</h4>
                    <div class="arch-diagram">// THRESHOLD PATTERN: Password Spray
SigninLogs
| where TimeGenerated > ago(1h)
| where ResultType != 0
| summarize 
    FailedAttempts = count(),
    DistinctUsers = dcount(UserPrincipalName)
  by IPAddress, bin(TimeGenerated, 10m)
| where DistinctUsers > 10 and FailedAttempts > 20

// SEQUENCE PATTERN: Reconnaissance -> Execution
let Recon = SecurityEvent 
    | where EventID in (4688) 
    | where CommandLine has_any ("whoami", "net user", "ipconfig")
    | project ReconTime = TimeGenerated, Computer, User = TargetUserName;
let Execution = SecurityEvent
    | where EventID == 4688
    | where CommandLine has_any ("powershell -enc", "certutil -decode")
    | project ExecTime = TimeGenerated, Computer, User = TargetUserName;
Recon
| join kind=inner Execution on Computer, User
| where ExecTime between (ReconTime .. (ReconTime + 30m))
| project ReconTime, ExecTime, Computer, User

// RARE PATTERN: First-Time Process
let Historical = DeviceProcessEvents
    | where TimeGenerated between (ago(30d) .. ago(1d))
    | distinct FileName, DeviceName;
DeviceProcessEvents
| where TimeGenerated > ago(1d)
| join kind=leftanti Historical on FileName, DeviceName
| summarize FirstSeen = min(TimeGenerated), Count = count() by FileName, DeviceName
| where Count < 5

// CORRELATION PATTERN: Auth Failure then Success
let Failures = SigninLogs
    | where ResultType != 0
    | project FailTime = TimeGenerated, IP = IPAddress, User = UserPrincipalName;
let Successes = SigninLogs
    | where ResultType == 0
    | project SuccessTime = TimeGenerated, IP = IPAddress, User = UserPrincipalName;
Failures
| join kind=inner Successes on IP, User
| where SuccessTime between (FailTime .. (FailTime + 5m))
| summarize 
    FailureCount = count(),
    SuccessTime = max(SuccessTime)
  by IP, User
| where FailureCount > 5</div>
                </div>

                <!-- Data Sources -->
                <h2><i class="fas fa-database"></i> Data Source Requirements</h2>
                <div class="config-section">
                    <h4>Data Source Mapping</h4>
                    <div class="arch-diagram">Detection Data Source Matrix:

AUTHENTICATION DETECTION:
├── Data Sources:
│   ├── Windows Security Event Log (4624, 4625, 4648)
│   ├── Azure AD Sign-in Logs
│   ├── VPN Logs
│   └── Application auth logs
├── Key Fields:
│   ├── Username, Domain
│   ├── Source IP, Destination
│   ├── Authentication method
│   ├── Success/Failure
│   └── Timestamp
└── Detections:
    ├── Brute force / Password spray
    ├── Impossible travel
    ├── Pass-the-hash
    └── Credential stuffing

PROCESS EXECUTION:
├── Data Sources:
│   ├── Sysmon Event ID 1
│   ├── Windows 4688 (with command line)
│   ├── EDR telemetry
│   └── Linux auditd
├── Key Fields:
│   ├── Process name, path
│   ├── Command line (CRITICAL)
│   ├── Parent process
│   ├── User context
│   └── Hash (SHA256)
└── Detections:
    ├── Malware execution
    ├── LOLBins abuse
    ├── Script-based attacks
    └── Persistence mechanisms

NETWORK:
├── Data Sources:
│   ├── Firewall logs
│   ├── Proxy logs
│   ├── DNS logs
│   ├── Netflow/IPFIX
│   └── IDS/IPS
├── Key Fields:
│   ├── Source/Dest IP and port
│   ├── Protocol, bytes
│   ├── Domain, URL
│   └── Action (allow/block)
└── Detections:
    ├── C2 communication
    ├── Data exfiltration
    ├── Lateral movement
    └── Scanning/reconnaissance</div>

                    <h4>Data Quality Requirements</h4>
                    <div class="arch-diagram">Data Quality Checklist:

COMPLETENESS:
□ All required fields present
□ No truncated values (command lines!)
□ Consistent collection across environment
□ Historical data for baseline

ACCURACY:
□ Timestamps synchronized (NTP)
□ Correct field parsing
□ No duplicate events
□ Proper encoding

TIMELINESS:
□ Acceptable ingestion latency
□ Near-real-time for critical sources
□ Consistent delivery

COVERAGE:
□ All hosts sending logs
□ All network segments covered
□ Cloud assets included
□ No blind spots

ENRICHMENT:
□ Asset inventory correlation
□ User identity resolution
□ Geolocation data
□ Threat intelligence tags</div>
                </div>

                <!-- Testing Framework -->
                <h2><i class="fas fa-vial"></i> Detection Testing</h2>
                <div class="config-section">
                    <h4>Testing Methodologies</h4>
                    <div class="arch-diagram">Detection Testing Framework:

1. UNIT TESTING
   ├── Test detection logic in isolation
   ├── Use sample/synthetic data
   ├── Verify expected fields extracted
   └── Confirm threshold behavior

2. INTEGRATION TESTING
   ├── Test with real data sources
   ├── Verify end-to-end flow
   ├── Check alert generation
   └── Validate entity mapping

3. VALIDATION TESTING
   ├── Atomic Red Team tests
   ├── MITRE ATT&CK emulation
   ├── Purple team exercises
   └── Known attack replay

4. PERFORMANCE TESTING
   ├── Query execution time
   ├── Resource consumption
   ├── Scale behavior
   └── Concurrent query impact

5. FALSE POSITIVE TESTING
   ├── Run against historical data
   ├── Identify legitimate triggers
   ├── Document exclusions needed
   └── Calculate FP rate

ATOMIC RED TEAM EXAMPLE:
# Test T1059.001 - PowerShell
Invoke-AtomicTest T1059.001

# Verify detection fired
Check SIEM for alert within 5 minutes

TESTING METRICS:
├── True Positive Rate (TPR): TP / (TP + FN)
├── False Positive Rate (FPR): FP / (FP + TN)
├── Precision: TP / (TP + FP)
├── Detection Latency: Time to alert
└── Coverage: % of technique variants detected</div>

                    <h4>Atomic Red Team Integration</h4>
                    <div class="arch-diagram"># Install Atomic Red Team
IEX (IWR 'https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/install-atomicredteam.ps1' -UseBasicParsing)
Install-AtomicRedTeam -getAtomics

# List tests for technique
Invoke-AtomicTest T1059.001 -ShowDetailsBrief

# Run specific test
Invoke-AtomicTest T1059.001 -TestNumbers 1

# Run all tests for technique
Invoke-AtomicTest T1059.001

# Cleanup after test
Invoke-AtomicTest T1059.001 -Cleanup

TESTING WORKFLOW:
1. Identify technique to test
2. Review Atomic test prerequisites
3. Run test in isolated environment
4. Verify detection fires
5. Capture evidence (alert, timeline)
6. Document results
7. Cleanup test artifacts

COMMON TECHNIQUES TO TEST:
├── T1059.001 - PowerShell
├── T1059.003 - Windows Command Shell
├── T1003.001 - LSASS Memory
├── T1547.001 - Registry Run Keys
├── T1021.001 - Remote Desktop
└── T1078 - Valid Accounts</div>
                </div>

                <!-- MITRE ATT&CK Coverage -->
                <h2><i class="fas fa-map"></i> MITRE ATT&CK Coverage</h2>
                <div class="config-section">
                    <div class="arch-diagram">MITRE ATT&CK Coverage Analysis:

COVERAGE METRICS:
├── Techniques covered: X / 200+
├── Sub-techniques covered: X / 400+
├── Tactics coverage (per tactic):
│   ├── Initial Access: X%
│   ├── Execution: X%
│   ├── Persistence: X%
│   ├── Privilege Escalation: X%
│   ├── Defense Evasion: X%
│   ├── Credential Access: X%
│   ├── Discovery: X%
│   ├── Lateral Movement: X%
│   ├── Collection: X%
│   ├── Exfiltration: X%
│   └── Impact: X%

PRIORITIZATION FRAMEWORK:
1. HIGH PRIORITY:
   ├── Techniques used by adversaries targeting your industry
   ├── Techniques in recent threat intel
   ├── Techniques with high prevalence
   └── Critical attack stages (Execution, Credential Access)

2. MEDIUM PRIORITY:
   ├── Common techniques across adversaries
   ├── Techniques with available data sources
   └── Fill gaps in kill chain

3. LOWER PRIORITY:
   ├── Rare techniques
   ├── Techniques requiring unavailable data
   └── Techniques already mitigated by controls

COVERAGE GAP ANALYSIS:
1. Export current detection rules
2. Map each rule to ATT&CK technique(s)
3. Identify techniques without detection
4. Prioritize gaps by risk
5. Develop detection roadmap
6. Track coverage over time</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Walk through your detection development process.</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Research:</strong> Understand threat, review intel, identify data sources</li>
                                <li><strong>Design:</strong> Plan detection logic, define expected output</li>
                                <li><strong>Build:</strong> Write query, map entities, set severity</li>
                                <li><strong>Test:</strong> Validate with test data, run attack simulation</li>
                                <li><strong>Deploy:</strong> Enable in production, create playbook</li>
                                <li><strong>Maintain:</strong> Monitor effectiveness, tune as needed</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you test a detection before deploying?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Unit test:</strong> Sample data to verify logic</li>
                                <li><strong>Historical test:</strong> Run against past data for FP analysis</li>
                                <li><strong>Attack simulation:</strong> Atomic Red Team or manual testing</li>
                                <li><strong>Performance test:</strong> Query execution time, resource usage</li>
                            </ul>
                            <p>Document expected true positives and known false positives.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What's the difference between IOC-based and behavioral detection?</button>
                        <div class="qa-answer">
                            <p><strong>IOC-based:</strong> Matches specific indicators (hashes, IPs, domains). Easy to create, but attackers easily change IOCs.</p>
                            <p><strong>Behavioral:</strong> Detects patterns of activity (process chains, anomalies). Harder to evade, catches variants, but higher false positive risk.</p>
                            <p><strong>Best practice:</strong> Layer both approaches. IOCs for known threats, behavioral for unknown.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you prioritize which detections to build?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Threat intelligence:</strong> What's targeting your industry?</li>
                                <li><strong>MITRE ATT&CK gaps:</strong> What techniques lack coverage?</li>
                                <li><strong>Incident learnings:</strong> What did we miss before?</li>
                                <li><strong>Data availability:</strong> Do we have the required logs?</li>
                                <li><strong>Business risk:</strong> What assets are most critical?</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>