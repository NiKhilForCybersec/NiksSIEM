<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Containment Procedures | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link active" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">SOC Operations Pages</div>
                <ul class="sidebar-nav">
                                        <li class="sidebar-nav-item">
                        <a href="soc-operations.html" class="sidebar-nav-link">
                            <i class="fas fa-users-cog"></i>
                            <span>SOC Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-handbook.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Triage Handbook</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-classification.html" class="sidebar-nav-link">
                            <i class="fas fa-tags"></i>
                            <span>Incident Classification</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="escalation-matrix.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Escalation Matrix</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="shift-handoff.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Shift Handoff</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="playbook-library.html" class="sidebar-nav-link">
                            <i class="fas fa-book"></i>
                            <span>Playbook Library</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="containment-procedures.html" class="sidebar-nav-link active">
                            <i class="fas fa-shield-alt"></i>
                            <span>Containment Procedures</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="ir-integration.html" class="sidebar-nav-link">
                            <i class="fas fa-ambulance"></i>
                            <span>IR Integration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="use-case-lifecycle.html" class="sidebar-nav-link">
                            <i class="fas fa-sync-alt"></i>
                            <span>Use Case Lifecycle</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="tuning-optimization.html" class="sidebar-nav-link">
                            <i class="fas fa-sliders-h"></i>
                            <span>Tuning & Optimization</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-source-priority.html" class="sidebar-nav-link">
                            <i class="fas fa-list-ol"></i>
                            <span>Data Source Priority</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="metrics-kpis.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Metrics & KPIs</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-metrics.html" class="sidebar-nav-link">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>SOC Metrics Dashboard</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="compliance-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-check-square"></i>
                            <span>Compliance Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="audit-preparation.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Audit Preparation</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="sizing-calculator.html" class="sidebar-nav-link">
                            <i class="fas fa-calculator"></i>
                            <span>Sizing Calculator</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="migration-guide.html" class="sidebar-nav-link">
                            <i class="fas fa-route"></i>
                            <span>Migration Guide</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="siem-project-planning.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>SIEM Project Planning</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="rbac-design.html" class="sidebar-nav-link">
                            <i class="fas fa-user-shield"></i>
                            <span>RBAC Design</span>
                        </a>
                    </li>
<li class="sidebar-nav-item">
                        <a href="cloud-security.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Cloud Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="compliance-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Compliance Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="containment-procedures.html" class="sidebar-nav-link active">
                            <i class="fas fa-file-alt"></i>
                            <span>Containment Procedures</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-source-priority.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Source Priority</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="detection-engineering.html" class="sidebar-nav-link">
                            <i class="fas fa-search"></i>
                            <span>Detection Engineering</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="escalation-matrix.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Escalation Matrix</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="forensics.html" class="sidebar-nav-link">
                            <i class="fas fa-microscope"></i>
                            <span>Forensics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="identity-security.html" class="sidebar-nav-link">
                            <i class="fas fa-user-shield"></i>
                            <span>Identity Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-classification.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Classification</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-response.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Response</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="ir-integration.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Ir Integration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="log-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Log Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="malware-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-virus"></i>
                            <span>Malware Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="metrics-kpis.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Metrics Kpis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="migration-guide.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Migration Guide</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="mitre-mapping.html" class="sidebar-nav-link">
                            <i class="fas fa-chess"></i>
                            <span>Mitre Mapping</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="network-security.html" class="sidebar-nav-link">
                            <i class="fas fa-network-wired"></i>
                            <span>Network Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="phishing-analysis.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Phishing Analysis</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="playbook-library.html" class="sidebar-nav-link">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Playbook Library</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="rbac-design.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Rbac Design</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="shift-handoff.html" class="sidebar-nav-link">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Shift Handoff</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="siem-project-planning.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Siem Project Planning</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="sizing-calculator.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Sizing Calculator</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-metrics.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Soc Metrics</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soc-operations.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Soc Operations</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intelligence.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-handbook.html" class="sidebar-nav-link">
                            <i class="fas fa-filter"></i>
                            <span>Triage Handbook</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="triage-methodology.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Triage Methodology</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="tuning-optimization.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Tuning Optimization</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="use-case-lifecycle.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Use Case Lifecycle</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="windows-events.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Windows Events</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">SOC Operations</a>
                    <span class="separator">/</span>
                    <span class="current">Containment Procedures</span>
                </div>

                <h1>Containment Procedures</h1>
                <p class="subtitle">Rapid containment strategies to limit threat spread and impact</p>
            </header>
            <section class="content-section">
                <h2>Containment Decision Framework</h2>
                <p>Containment actions must balance the need to stop threat propagation with business continuity requirements. The severity and type of threat determines the appropriate containment level.</p>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Threat Type</th>
                            <th>Severity</th>
                            <th>Primary Action</th>
                            <th>Decision Authority</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Active Ransomware</td>
                            <td class="status-critical">Critical</td>
                            <td>Immediate network isolation</td>
                            <td>SOC L1 (pre-authorized)</td>
                        </tr>
                        <tr>
                            <td>Data Exfiltration</td>
                            <td class="status-critical">Critical</td>
                            <td>Network isolation + block external IPs</td>
                            <td>SOC L2</td>
                        </tr>
                        <tr>
                            <td>Active C2 Communication</td>
                            <td class="status-warning">High</td>
                            <td>Block C2 domain/IP + endpoint isolation</td>
                            <td>SOC L2</td>
                        </tr>
                        <tr>
                            <td>Lateral Movement</td>
                            <td class="status-warning">High</td>
                            <td>Segment affected systems + disable accounts</td>
                            <td>SOC L2 + IT</td>
                        </tr>
                        <tr>
                            <td>Credential Compromise</td>
                            <td class="status-warning">High</td>
                            <td>Disable/reset accounts + force reauthentication</td>
                            <td>SOC L2 + IAM</td>
                        </tr>
                        <tr>
                            <td>Malware (Non-Spreading)</td>
                            <td>Medium</td>
                            <td>Quarantine file + endpoint isolation if spreading</td>
                            <td>SOC L1</td>
                        </tr>
                        <tr>
                            <td>Phishing Success</td>
                            <td>Medium</td>
                            <td>Reset credentials + review mail rules</td>
                            <td>SOC L1</td>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section class="content-section">
                <h2>Endpoint Containment</h2>
                <h3>Network Isolation</h3>
                <p>Completely disconnect endpoint from network while maintaining EDR connectivity.</p>
                <div class="arch-diagram">
                    <pre><code># Microsoft Defender for Endpoint
POST https://api.securitycenter.microsoft.com/api/machines/{id}/isolate
{ "Comment": "Incident #12345 - Active ransomware", "IsolationType": "Full" }
# CrowdStrike Falcon
POST /devices/entities/devices-actions/v2?action_name=contain
{ "ids": ["device_id"] }
# Cortex XDR
POST /public_api/v1/endpoints/isolate
{ "request_data": { "endpoint_id_list": ["endpoint_id"] } }
# Manual (if EDR unavailable)
# Windows Firewall - Block all except EDR
netsh advfirewall set allprofiles firewallpolicy blockinbound,blockoutbound
netsh advfirewall firewall add rule name="Allow EDR" dir=out action=allow program="C:\Program Files\EDR\agent.exe"</code></pre>
                </div>
                <h3>Process Termination</h3>
                <div class="arch-diagram">
                    <pre><code># Kill malicious process by name
taskkill /F /IM malware.exe /T
# Kill by PID
taskkill /F /PID 1234
# Via PowerShell with logging
$proc = Get-Process -Name "suspicious" -ErrorAction SilentlyContinue
if ($proc) {
    $proc | Stop-Process -Force
    Write-EventLog -LogName Application -Source "SOC" -EventId 1001 -Message "Terminated process: $($proc.Name) PID: $($proc.Id)"
}</code></pre>
                </div>
                <h3>File Quarantine</h3>
                <div class="arch-diagram">
                    <pre><code># MDE - Stop and Quarantine
POST /api/machines/{id}/StopAndQuarantineFile
{ "Comment": "Quarantine ransomware", "Sha1": "abc123..." }
# Manual quarantine with hash preservation
$file = "C:\temp\malware.exe"
$hash = (Get-FileHash $file -Algorithm SHA256).Hash
$quarantine = "C:\Quarantine\$hash"
Move-Item $file $quarantine
Set-ItemProperty $quarantine -Name Attributes -Value ([System.IO.FileAttributes]::Hidden)
Write-Output "Quarantined: $file -> $quarantine (SHA256: $hash)"</code></pre>
                </div>
            </section>
            <section class="content-section">
                <h2>Network Containment</h2>
                <h3>Block External IOCs</h3>
                <div class="arch-diagram">
                    <pre><code># Firewall - Block IP
# Palo Alto
set address C2-Server ip-netmask 192.0.2.100/32
set security policies rules Block-C2 from any to untrust destination C2-Server action deny
# Cisco ASA
access-list BLOCK_C2 extended deny ip any host 192.0.2.100
access-group BLOCK_C2 in interface outside
# Windows Firewall (endpoint level)
netsh advfirewall firewall add rule name="Block C2" dir=out action=block remoteip=192.0.2.100
# DNS Sinkhole (Infoblox/AD DNS)
# Add malicious domain to sinkhole zone
dnscmd /RecordAdd sinkhole.local malicious-domain.com A 0.0.0.0</code></pre>
                </div>
                <h3>Segment Affected Systems</h3>
                <div class="arch-diagram">
                    <pre><code># VLAN Quarantine (Cisco)
interface GigabitEthernet0/1
 description Quarantined-Host
 switchport access vlan 999
 switchport mode access
# SDN/NSX Micro-segmentation
# Apply emergency quarantine policy to VM
# Block all east-west traffic, allow management
# NAC (ISE) Quarantine
# Apply quarantine authorization policy
# Move to restricted VLAN with only AV/patch access</code></pre>
                </div>
                <h3>Network Flow Blocking</h3>
                <div class="arch-diagram">
                    <pre><code># Block lateral movement protocols from infected segment
# SMB (445), RPC (135), WinRM (5985/5986), RDP (3389)
# Palo Alto - Inter-zone blocking
set security policies rules Block-Lateral from infected-zone to any application smb action deny
set security policies rules Block-Lateral application ms-rpc action deny
set security policies rules Block-Lateral application ms-rdp action deny
# Segment isolation ACL
access-list QUARANTINE deny tcp 10.10.10.0 0.0.0.255 any eq 445
access-list QUARANTINE deny tcp 10.10.10.0 0.0.0.255 any eq 135
access-list QUARANTINE deny tcp 10.10.10.0 0.0.0.255 any eq 3389
access-list QUARANTINE permit ip 10.10.10.0 0.0.0.255 host 10.0.0.5  # Allow to SIEM
access-list QUARANTINE deny ip 10.10.10.0 0.0.0.255 any</code></pre>
                </div>
            </section>
            <section class="content-section">
                <h2>Identity Containment</h2>
                <h3>Account Disable/Lockout</h3>
                <div class="arch-diagram">
                    <pre><code># Active Directory - Disable Account
Disable-ADAccount -Identity "compromised_user"
# Force password change at next logon
Set-ADUser -Identity "compromised_user" -ChangePasswordAtLogon $true
# Azure AD - Block Sign-in
Set-AzureADUser -ObjectId user@domain.com -AccountEnabled $false
# Revoke all sessions (Azure AD)
Revoke-AzureADUserAllRefreshToken -ObjectId user@domain.com
# Microsoft 365 - Sign out all sessions
Connect-MgGraph -Scopes "User.ReadWrite.All"
Revoke-MgUserSignInSession -UserId user@domain.com</code></pre>
                </div>
                <h3>Service Account Containment</h3>
                <div class="arch-diagram">
                    <pre><code># Identify services using the account
Get-WmiObject Win32_Service | Where-Object { $_.StartName -like "*svc_compromised*" }
# Stop dependent services first, then disable account
Stop-Service -Name "DependentService" -Force
Disable-ADAccount -Identity "svc_compromised"
# Rotate service account credentials
$newPassword = [System.Web.Security.Membership]::GeneratePassword(24,4)
Set-ADAccountPassword -Identity "svc_compromised" -Reset -NewPassword (ConvertTo-SecureString $newPassword -AsPlainText -Force)
# Update service credentials (after incident)
sc.exe config "ServiceName" obj= "domain\svc_new" password= "newpassword"</code></pre>
                </div>
                <h3>MFA Reset / Conditional Access</h3>
                <div class="arch-diagram">
                    <pre><code># Reset MFA registration
Remove-MsolUser -UserPrincipalName user@domain.com -RemoveFromRecycleBin
# Force MFA re-registration via Azure AD
Set-MsolUser -UserPrincipalName user@domain.com -StrongAuthenticationMethods @()
# Apply Conditional Access - Require compliant device
# Azure Portal: Azure AD → Security → Conditional Access
# Create policy requiring device compliance for compromised user</code></pre>
                </div>
            </section>
            <section class="content-section">
                <h2>Email Containment</h2>
                <h3>Purge Malicious Emails</h3>
                <div class="arch-diagram">
                    <pre><code># Microsoft 365 - Content Search and Purge
New-ComplianceSearch -Name "Malicious Campaign" -ExchangeLocation All `
    -ContentMatchQuery 'subject:"Invoice" AND from:attacker@evil.com AND received>=2024-01-01'
Start-ComplianceSearch -Identity "Malicious Campaign"
# Soft Delete (recoverable)
New-ComplianceSearchAction -SearchName "Malicious Campaign" -Purge -PurgeType SoftDelete
# Hard Delete (permanent)
New-ComplianceSearchAction -SearchName "Malicious Campaign" -Purge -PurgeType HardDelete
# Check purge status
Get-ComplianceSearchAction -Identity "Malicious Campaign_Purge" | FL</code></pre>
                </div>
                <h3>Block Sender/Domain</h3>
                <div class="arch-diagram">
                    <pre><code># Exchange Online - Block Sender
Set-HostedContentFilterPolicy -Identity Default -BlockedSenders @{Add="attacker@evil.com"}
# Block Domain
Set-HostedContentFilterPolicy -Identity Default -BlockedSenderDomains @{Add="evil.com"}
# Transport Rule - Block with notification
New-TransportRule -Name "Block Evil Campaign" `
    -FromAddressMatchesPatterns ".*@evil\.com" `
    -DeleteMessage $true `
    -GenerateIncidentReport "security@company.com" `
    -IncidentReportContent Sender,Subject,Recipients</code></pre>
                </div>
                <h3>Review Mail Rules</h3>
                <div class="arch-diagram">
                    <pre><code># Check for suspicious forwarding rules
Get-InboxRule -Mailbox user@domain.com | Where-Object { 
    $_.ForwardTo -or $_.ForwardAsAttachmentTo -or $_.RedirectTo 
} | Format-List Name, ForwardTo, RedirectTo, Enabled
# Remove malicious rules
Remove-InboxRule -Mailbox user@domain.com -Identity "Suspicious Rule"
# Check all mailboxes for suspicious rules (large orgs)
$mailboxes = Get-Mailbox -ResultSize Unlimited
foreach ($mbx in $mailboxes) {
    Get-InboxRule -Mailbox $mbx.UserPrincipalName | Where-Object { 
        $_.ForwardTo -or $_.RedirectTo 
    }
}</code></pre>
                </div>
            </section>
            <section class="content-section">
                <h2>Cloud Containment</h2>
                <h3>AWS</h3>
                <div class="arch-diagram">
                    <pre><code># Isolate EC2 Instance - Apply restrictive security group
aws ec2 modify-instance-attribute \
    --instance-id i-1234567890abcdef0 \
    --groups sg-quarantine
# Create quarantine security group (if not exists)
aws ec2 create-security-group \
    --group-name quarantine-sg \
    --description "Incident quarantine - no inbound/outbound"
# Revoke IAM User Access
aws iam delete-login-profile --user-name compromised-user
aws iam list-access-keys --user-name compromised-user | \
    jq -r '.AccessKeyMetadata[].AccessKeyId' | \
    xargs -I {} aws iam delete-access-key --user-name compromised-user --access-key-id {}
# Snapshot for forensics
aws ec2 create-snapshot --volume-id vol-1234567890abcdef0 --description "Incident snapshot"</code></pre>
                </div>
                <h3>Azure</h3>
                <div class="arch-diagram">
                    <pre><code># Isolate VM - Apply NSG blocking all traffic
$nsg = New-AzNetworkSecurityGroup -ResourceGroupName "RG" -Name "Quarantine-NSG" -Location "eastus"
$nsg | Add-AzNetworkSecurityRuleConfig -Name "DenyAll" -Priority 100 -Direction Inbound `
    -Access Deny -Protocol * -SourcePortRange * -DestinationPortRange * `
    -SourceAddressPrefix * -DestinationAddressPrefix *
$nic = Get-AzNetworkInterface -Name "vm-nic"
$nic.NetworkSecurityGroup = $nsg
$nic | Set-AzNetworkInterface
# Snapshot disk for forensics
$vm = Get-AzVM -Name "compromised-vm"
$disk = Get-AzDisk -ResourceGroupName $vm.ResourceGroupName -DiskName $vm.StorageProfile.OsDisk.Name
$snapshotConfig = New-AzSnapshotConfig -SourceUri $disk.Id -Location $disk.Location -CreateOption Copy
New-AzSnapshot -Snapshot $snapshotConfig -SnapshotName "forensic-snapshot" -ResourceGroupName $vm.ResourceGroupName</code></pre>
                </div>
            </section>
            <section class="content-section">
                <h2>Containment Checklist</h2>
                <div class="arch-diagram">
                    <pre><code>## Immediate Actions (First 15 minutes)
[ ] Assess threat type and severity
[ ] Determine containment level required
[ ] Obtain authorization if needed
[ ] Execute primary containment action
[ ] Document time and action taken
## Secondary Actions (15-60 minutes)
[ ] Identify all affected systems
[ ] Apply containment to additional systems
[ ] Block known IOCs at network level
[ ] Disable compromised accounts
[ ] Preserve evidence before changes
## Validation
[ ] Verify containment is effective
[ ] Confirm no ongoing malicious activity
[ ] Check for spread to other systems
[ ] Document containment scope
## Communication
[ ] Notify incident manager
[ ] Update ticket with containment details
[ ] Inform affected business units
[ ] Schedule containment release review</code></pre>
                </div>
            </section>
            <section class="content-section">
                <h2>Interview Q&A</h2>
                <div class="qa-section">
                    <h3>Q: You detect active ransomware encryption on a server. Walk me through your containment steps.</h3>
                    <div class="answer">
                        <p><strong>A:</strong> My ransomware containment approach:</p>
                        <ol>
                            <li><strong>Immediate isolation (0-2 min):</strong> Network isolate the server via EDR or network switch. Don't wait for approvals - ransomware spreads fast</li>
                            <li><strong>Stop encryption (2-5 min):</strong> If possible, kill the encryption process. Note the process name/PID for forensics</li>
                            <li><strong>Prevent lateral spread:</strong> Block SMB/445 from the affected subnet at the firewall, identify any systems that communicated with the infected server</li>
                            <li><strong>Account containment:</strong> Disable the account that ran the encryption. If it's a service account, identify all systems it has access to</li>
                            <li><strong>Network IOC blocking:</strong> Add any C2 IPs/domains to block lists across firewalls and proxies</li>
                            <li><strong>Scope assessment:</strong> Query SIEM for the ransomware indicators across all endpoints to identify other infections</li>
                            <li><strong>Evidence preservation:</strong> Take memory dump and disk snapshot before any remediation</li>
                        </ol>
                        <p>The key is speed - every minute of delay means more encrypted files.</p>
                    </div>
                </div>
                <div class="qa-section">
                    <h3>Q: How do you handle containment for a critical production server?</h3>
                    <div class="answer">
                        <p><strong>A:</strong> Critical server containment requires balancing security with business impact:</p>
                        <ul>
                            <li><strong>Selective isolation:</strong> Instead of full isolation, apply micro-segmentation to allow only essential traffic (backup agents, monitoring, specific application flows)</li>
                            <li><strong>Rapid escalation:</strong> Immediately engage the server owner and incident manager - they need to know about the threat AND the containment impact</li>
                            <li><strong>Alternative containment:</strong> If the server can't be isolated, focus on blocking the specific threat (C2 IPs, malicious processes) while monitoring closely</li>
                            <li><strong>Failover consideration:</strong> If HA exists, consider failing over to standby before isolating the primary</li>
                            <li><strong>Documentation:</strong> Record the business justification for any deviation from standard containment procedures</li>
                        </ul>
                        <p>The decision ultimately depends on: Is the threat actively spreading? Is data being exfiltrated? Can we contain the threat without full isolation?</p>
                    </div>
                </div>
            </section>
        </article>
    
                

                <!-- Real-World Use Cases -->
                </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>