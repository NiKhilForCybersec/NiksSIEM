<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MITRE ATT&CK Mapping | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .config-section { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .code-block { background: #0d1117; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 12px 0; font-family: 'Fira Code', monospace; font-size: 0.85rem; overflow-x: auto; white-space: pre; }
        .tactic-card { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .tactic-header { color: #58a6ff; font-weight: 700; font-size: 1.1rem; margin-bottom: 12px; }
        .technique-tag { background: #1f6feb; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; color: white; margin: 2px; display: inline-block; }
    </style>
</head>
<body>
    <div class="app-container">
                                                                        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Structure</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-tags"></i> Incident Classification</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-shield-alt"></i> Containment</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-link"></i> IR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cogs"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="mitre-mapping.html" class="nav-link active"><i class="fas fa-map"></i> MITRE Mapping</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Metrics & Compliance</div>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-line"></i> Metrics & KPIs</a>
                    <a href="soc-metrics.html" class="nav-link"><i class="fas fa-tachometer-alt"></i> SOC Metrics</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-check-double"></i> Compliance Mapping</a>
                    <a href="audit-preparation.html" class="nav-link"><i class="fas fa-clipboard-list"></i> Audit Preparation</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Design</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> SIEM Project Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Source Priority</a>
                    <a href="sizing-calculator.html" class="nav-link"><i class="fas fa-calculator"></i> Sizing Calculator</a>
                    <a href="rbac-design.html" class="nav-link"><i class="fas fa-user-lock"></i> RBAC Design</a>
                    <a href="migration-guide.html" class="nav-link"><i class="fas fa-truck-moving"></i> Migration Guide</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Operations</a><span class="separator">/</span>
                    <span class="current">MITRE ATT&CK Mapping</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-bullseye"></i> MITRE ATT&CK Framework</h1>
                <p class="lead">Use MITRE ATT&CK to understand adversary behavior, map detections, and identify coverage gaps. This framework provides a common language for discussing threats and defensive capabilities.</p>

                <!-- What is MITRE ATT&CK -->
                <h2><i class="fas fa-info-circle"></i> What is MITRE ATT&CK?</h2>
                <div class="config-section">
                    <p>MITRE ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge) is a globally-accessible knowledge base of adversary tactics and techniques based on real-world observations.</p>
                    
                    <h4>Key Components</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Component</th><th>Description</th><th>Example</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Tactics</strong></td>
                                <td>The "why" - adversary's tactical goal</td>
                                <td>Execution, Persistence, Exfiltration</td>
                            </tr>
                            <tr>
                                <td><strong>Techniques</strong></td>
                                <td>The "how" - method to achieve goal</td>
                                <td>T1059 - Command and Scripting Interpreter</td>
                            </tr>
                            <tr>
                                <td><strong>Sub-techniques</strong></td>
                                <td>More specific implementation</td>
                                <td>T1059.001 - PowerShell</td>
                            </tr>
                            <tr>
                                <td><strong>Procedures</strong></td>
                                <td>Specific implementation by threat actor</td>
                                <td>APT29 uses encoded PowerShell</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>ATT&CK Matrices</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Enterprise:</strong> Windows, macOS, Linux, Cloud, Network, Containers</li>
                        <li><strong>Mobile:</strong> Android, iOS</li>
                        <li><strong>ICS:</strong> Industrial Control Systems</li>
                    </ul>
                </div>

                <!-- Tactics Overview -->
                <h2><i class="fas fa-chess"></i> Enterprise Tactics (14 Total)</h2>
                <div class="config-section">
                    <div class="tactic-card">
                        <div class="tactic-header">TA0043 - Reconnaissance</div>
                        <p style="color: #8b949e;">Gathering information to plan future operations. Typically occurs before initial access.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1595 Active Scanning</span>
                        <span class="technique-tag">T1592 Gather Victim Host Info</span>
                        <span class="technique-tag">T1589 Gather Victim Identity Info</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0042 - Resource Development</div>
                        <p style="color: #8b949e;">Establishing resources for operations (infrastructure, accounts, capabilities).</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1583 Acquire Infrastructure</span>
                        <span class="technique-tag">T1588 Obtain Capabilities</span>
                        <span class="technique-tag">T1585 Establish Accounts</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0001 - Initial Access</div>
                        <p style="color: #8b949e;">Techniques to gain initial foothold within a network.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1566 Phishing</span>
                        <span class="technique-tag">T1190 Exploit Public-Facing App</span>
                        <span class="technique-tag">T1078 Valid Accounts</span>
                        <span class="technique-tag">T1133 External Remote Services</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0002 - Execution</div>
                        <p style="color: #8b949e;">Running malicious code on a local or remote system.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1059 Command & Scripting Interpreter</span>
                        <span class="technique-tag">T1204 User Execution</span>
                        <span class="technique-tag">T1203 Exploitation for Client Execution</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0003 - Persistence</div>
                        <p style="color: #8b949e;">Maintaining access across restarts, credential changes, etc.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1547 Boot/Logon Autostart</span>
                        <span class="technique-tag">T1053 Scheduled Task/Job</span>
                        <span class="technique-tag">T1543 Create/Modify System Process</span>
                        <span class="technique-tag">T1546 Event Triggered Execution</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0004 - Privilege Escalation</div>
                        <p style="color: #8b949e;">Gaining higher-level permissions on a system or network.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1068 Exploitation for Privilege Escalation</span>
                        <span class="technique-tag">T1055 Process Injection</span>
                        <span class="technique-tag">T1548 Abuse Elevation Control Mechanism</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0005 - Defense Evasion</div>
                        <p style="color: #8b949e;">Avoiding detection throughout the compromise.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1070 Indicator Removal</span>
                        <span class="technique-tag">T1027 Obfuscated Files/Info</span>
                        <span class="technique-tag">T1562 Impair Defenses</span>
                        <span class="technique-tag">T1036 Masquerading</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0006 - Credential Access</div>
                        <p style="color: #8b949e;">Stealing credentials like account names and passwords.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1003 OS Credential Dumping</span>
                        <span class="technique-tag">T1110 Brute Force</span>
                        <span class="technique-tag">T1558 Steal/Forge Kerberos Tickets</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0007 - Discovery</div>
                        <p style="color: #8b949e;">Gaining knowledge about the system and network.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1087 Account Discovery</span>
                        <span class="technique-tag">T1083 File & Directory Discovery</span>
                        <span class="technique-tag">T1057 Process Discovery</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0008 - Lateral Movement</div>
                        <p style="color: #8b949e;">Moving through the environment to access other systems.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1021 Remote Services</span>
                        <span class="technique-tag">T1570 Lateral Tool Transfer</span>
                        <span class="technique-tag">T1550 Use Alternate Authentication Material</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0009 - Collection</div>
                        <p style="color: #8b949e;">Gathering data of interest for exfiltration.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1560 Archive Collected Data</span>
                        <span class="technique-tag">T1074 Data Staged</span>
                        <span class="technique-tag">T1005 Data from Local System</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0011 - Command and Control</div>
                        <p style="color: #8b949e;">Communicating with compromised systems to control them.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1071 Application Layer Protocol</span>
                        <span class="technique-tag">T1573 Encrypted Channel</span>
                        <span class="technique-tag">T1090 Proxy</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0010 - Exfiltration</div>
                        <p style="color: #8b949e;">Stealing data from the network.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1048 Exfiltration Over Alternative Protocol</span>
                        <span class="technique-tag">T1041 Exfiltration Over C2 Channel</span>
                        <span class="technique-tag">T1567 Exfiltration Over Web Service</span>
                    </div>

                    <div class="tactic-card">
                        <div class="tactic-header">TA0040 - Impact</div>
                        <p style="color: #8b949e;">Disrupting availability or compromising integrity.</p>
                        <p><strong>Key Techniques:</strong></p>
                        <span class="technique-tag">T1486 Data Encrypted for Impact</span>
                        <span class="technique-tag">T1489 Service Stop</span>
                        <span class="technique-tag">T1529 System Shutdown/Reboot</span>
                    </div>
                </div>

                <!-- Priority Techniques for Detection -->
                <h2><i class="fas fa-star"></i> Priority Techniques for Detection</h2>
                <div class="config-section">
                    <p>Based on frequency in real-world attacks and detectability:</p>
                    
                    <table class="styled-table">
                        <thead>
                            <tr><th>Technique</th><th>Why It's Priority</th><th>Data Sources</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>T1059 - Command Interpreter</strong></td>
                                <td>Used in nearly every attack</td>
                                <td>Process monitoring, Script logs</td>
                            </tr>
                            <tr>
                                <td><strong>T1566 - Phishing</strong></td>
                                <td>Most common initial access</td>
                                <td>Email gateway, Web proxy</td>
                            </tr>
                            <tr>
                                <td><strong>T1003 - Credential Dumping</strong></td>
                                <td>Enables further compromise</td>
                                <td>Process access, API calls</td>
                            </tr>
                            <tr>
                                <td><strong>T1021 - Remote Services</strong></td>
                                <td>Primary lateral movement</td>
                                <td>Authentication logs, Network</td>
                            </tr>
                            <tr>
                                <td><strong>T1547 - Boot/Logon Autostart</strong></td>
                                <td>Common persistence</td>
                                <td>Registry, File system</td>
                            </tr>
                            <tr>
                                <td><strong>T1486 - Ransomware</strong></td>
                                <td>High business impact</td>
                                <td>File monitoring, Process</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Mapping Detections to ATT&CK -->
                <h2><i class="fas fa-map"></i> Mapping Detections to ATT&CK</h2>
                <div class="config-section">
                    <h4>Detection Mapping Process</h4>
                    <ol style="color: #8b949e;">
                        <li>Identify what behavior the detection finds</li>
                        <li>Match to ATT&CK technique(s)</li>
                        <li>Consider sub-techniques for specificity</li>
                        <li>Document the mapping in detection metadata</li>
                    </ol>

                    <h4>Example Mappings</h4>
                    <div class="code-block">Detection: PowerShell Encoded Command
Behavior: PowerShell with -EncodedCommand parameter
ATT&CK Mapping:
  - T1059.001 (Command and Scripting Interpreter: PowerShell)
  - T1027 (Obfuscated Files or Information) - secondary

Detection: LSASS Memory Access
Behavior: Process accessing LSASS memory
ATT&CK Mapping:
  - T1003.001 (OS Credential Dumping: LSASS Memory)

Detection: Scheduled Task Created via CLI
Behavior: schtasks.exe /create with suspicious parameters
ATT&CK Mapping:
  - T1053.005 (Scheduled Task/Job: Scheduled Task)

Detection: SMB Lateral Movement
Behavior: Admin share access followed by process execution
ATT&CK Mapping:
  - T1021.002 (Remote Services: SMB/Windows Admin Shares)
  - T1570 (Lateral Tool Transfer) - secondary</div>

                    <h4>Mapping Quality Criteria</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Accuracy:</strong> Does the detection actually find this technique?</li>
                        <li><strong>Specificity:</strong> Use sub-techniques when appropriate</li>
                        <li><strong>Coverage:</strong> Does it detect all variants of the technique?</li>
                        <li><strong>False Positives:</strong> High FP rate reduces practical coverage</li>
                    </ul>
                </div>

                <!-- Coverage Analysis -->
                <h2><i class="fas fa-th"></i> Coverage Analysis</h2>
                <div class="config-section">
                    <h4>Using ATT&CK Navigator</h4>
                    <p style="color: #8b949e;">The ATT&CK Navigator (<code>mitre-attack.github.io/attack-navigator</code>) visualizes your coverage:</p>
                    
                    <div class="code-block">Coverage Analysis Steps:
1. Export your detection mappings to Navigator format
2. Create a layer showing detection coverage
3. Identify gaps (techniques with no detection)
4. Prioritize gap closure based on:
   - Frequency in attacks against your industry
   - Data source availability
   - Detection feasibility

Coverage Levels:
- None (Gray): No detection capability
- Low (Yellow): Basic detection, may miss variants
- Medium (Orange): Good detection, some gaps
- High (Green): Comprehensive detection</div>

                    <h4>Navigator Layer Example (JSON)</h4>
                    <div class="code-block">{
  "name": "SOC Detection Coverage",
  "version": "4.5",
  "domain": "enterprise-attack",
  "techniques": [
    {
      "techniqueID": "T1059.001",
      "color": "#00ff00",
      "comment": "PowerShell monitoring via Sysmon + SIEM rules",
      "score": 80
    },
    {
      "techniqueID": "T1003.001",
      "color": "#00ff00",
      "comment": "LSASS access monitoring via EDR",
      "score": 90
    },
    {
      "techniqueID": "T1021.002",
      "color": "#ffff00",
      "comment": "Basic SMB monitoring, gaps in detection",
      "score": 50
    }
  ]
}</div>
                </div>

                <!-- Detection by Data Source -->
                <h2><i class="fas fa-database"></i> Techniques by Data Source</h2>
                <div class="config-section">
                    <table class="styled-table">
                        <thead>
                            <tr><th>Data Source</th><th>Detectable Techniques</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Process Creation</strong></td>
                                <td>T1059 (Command Interpreter), T1218 (Signed Binary Proxy), T1036 (Masquerading)</td>
                            </tr>
                            <tr>
                                <td><strong>Network Traffic</strong></td>
                                <td>T1071 (App Layer Protocol), T1048 (Exfiltration), T1021 (Remote Services)</td>
                            </tr>
                            <tr>
                                <td><strong>File Creation</strong></td>
                                <td>T1105 (Ingress Tool Transfer), T1027 (Obfuscation), T1486 (Ransomware)</td>
                            </tr>
                            <tr>
                                <td><strong>Registry</strong></td>
                                <td>T1547.001 (Registry Run Keys), T1112 (Modify Registry)</td>
                            </tr>
                            <tr>
                                <td><strong>Authentication</strong></td>
                                <td>T1110 (Brute Force), T1078 (Valid Accounts), T1550 (Use Alternate Auth)</td>
                            </tr>
                            <tr>
                                <td><strong>DNS</strong></td>
                                <td>T1071.004 (DNS Protocol), T1568 (Dynamic Resolution)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ATT&CK in Incident Response -->
                <h2><i class="fas fa-ambulance"></i> Using ATT&CK in Incident Response</h2>
                <div class="config-section">
                    <h4>Attack Chain Mapping</h4>
                    <div class="code-block">Incident: Ransomware Attack

Attack Chain Mapped to ATT&CK:
1. Initial Access
   └─ T1566.001 Phishing: Spearphishing Attachment
      Evidence: Malicious Excel file delivered via email

2. Execution  
   └─ T1059.001 PowerShell
      Evidence: Excel spawned PowerShell with encoded command

3. Persistence
   └─ T1053.005 Scheduled Task
      Evidence: Created scheduled task for persistence

4. Defense Evasion
   └─ T1562.001 Disable Security Tools
      Evidence: Attempted to disable Windows Defender

5. Credential Access
   └─ T1003.001 LSASS Memory
      Evidence: Mimikatz execution detected

6. Lateral Movement
   └─ T1021.002 SMB/Windows Admin Shares
      Evidence: Admin share connections to multiple hosts

7. Impact
   └─ T1486 Data Encrypted for Impact
      Evidence: Files encrypted with ransom note</div>

                    <h4>Using ATT&CK for Threat Hunting</h4>
                    <div class="code-block">Hunt Process:
1. Select technique based on threat intel
2. Review technique procedure examples
3. Identify data sources needed
4. Develop hunting queries
5. Execute hunt
6. Analyze results
7. Create detection rule if successful

Example: Hunt for T1003.001 (LSASS Credential Dumping)
Data Sources: Process access, Process creation
Hunt Query:
- Processes accessing lsass.exe with specific access rights
- Known dumping tools: mimikatz, procdump, comsvcs.dll
- PowerShell with sekurlsa references</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Explain the difference between tactics, techniques, and procedures.</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Tactics:</strong> The adversary's goal - WHY they're doing something. Example: "Persistence" - maintaining access.</li>
                                <li><strong>Techniques:</strong> HOW they achieve the goal. Example: "Scheduled Task/Job" - one way to achieve persistence.</li>
                                <li><strong>Sub-techniques:</strong> More specific implementation. Example: "Scheduled Task" (Windows-specific).</li>
                                <li><strong>Procedures:</strong> The exact implementation by a specific threat actor. Example: "APT29 creates scheduled tasks named 'GoogleUpdate' running PowerShell."</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you use ATT&CK to improve detection coverage?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Map existing detections:</strong> Tag all detection rules with ATT&CK techniques</li>
                                <li><strong>Visualize coverage:</strong> Use ATT&CK Navigator to see gaps</li>
                                <li><strong>Prioritize gaps:</strong> Focus on frequently used techniques and those relevant to your threat model</li>
                                <li><strong>Check data sources:</strong> Verify you have the data needed to detect priority techniques</li>
                                <li><strong>Build detections:</strong> Create rules for priority gaps</li>
                                <li><strong>Validate:</strong> Test detections against real technique implementations</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What are the most important techniques to detect?</button>
                        <div class="qa-answer">
                            <p>Priority techniques based on frequency and impact:</p>
                            <ul>
                                <li><strong>T1059 (Command Interpreter):</strong> Used in nearly every attack</li>
                                <li><strong>T1566 (Phishing):</strong> Most common initial access vector</li>
                                <li><strong>T1003 (Credential Dumping):</strong> Enables escalation and lateral movement</li>
                                <li><strong>T1021 (Remote Services):</strong> Primary lateral movement technique</li>
                                <li><strong>T1486 (Ransomware):</strong> High business impact</li>
                                <li><strong>T1078 (Valid Accounts):</strong> Hard to detect, widely used</li>
                            </ul>
                            <p style="margin-top: 12px;">Also consider techniques specific to threat actors targeting your industry.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>

                <!-- Detailed Technique Examples -->
                <h2><i class="fas fa-microscope"></i> Detailed Technique Analysis</h2>
                <div class="config-section">
                    <h4>T1059.001 - PowerShell</h4>
                    <div class="code-block">Technique: Command and Scripting Interpreter: PowerShell
Tactic: Execution
Platform: Windows

Description:
Adversaries may abuse PowerShell for execution. PowerShell is a powerful 
interactive shell and scripting environment included in Windows.

Detection Opportunities:
1. Process Creation
   - powershell.exe or pwsh.exe execution
   - Command line parameters (-enc, -NoP, -W Hidden)
   - Suspicious parent processes

2. Script Block Logging (Event ID 4104)
   - Actual script content
   - Encoded command decoded
   - Suspicious cmdlets (Invoke-Expression, IEX)

3. Module Logging (Event ID 4103)
   - Loaded modules
   - System.Management.Automation

Detection Queries:
// Splunk
index=sysmon EventCode=1 
| where Image="*powershell.exe" OR Image="*pwsh.exe"
| where CommandLine="*-enc*" OR CommandLine="*-NoP*"

// Sentinel KQL
DeviceProcessEvents
| where FileName in~ ("powershell.exe", "pwsh.exe")
| where ProcessCommandLine has_any ("-enc", "-NoP", "-W Hidden")</div>

                    <h4>T1003.001 - LSASS Memory</h4>
                    <div class="code-block">Technique: OS Credential Dumping: LSASS Memory
Tactic: Credential Access
Platform: Windows

Description:
Adversaries may attempt to access LSASS memory to harvest credentials.
LSASS stores credentials for logged-on users.

Common Tools:
- Mimikatz (sekurlsa::logonpasswords)
- ProcDump
- comsvcs.dll MiniDump
- nanodump
- PPLKiller (to bypass PPL)

Detection Opportunities:
1. Process Access
   - Non-system processes accessing lsass.exe
   - Specific access rights (PROCESS_VM_READ)

2. Process Creation
   - Known tools: mimikatz, procdump
   - comsvcs.dll with MiniDump

3. File Creation
   - .dmp files in suspicious locations

Detection Queries:
// Sysmon Event ID 10 (Process Access)
index=sysmon EventCode=10 TargetImage="*lsass.exe"
| where SourceImage!="*csrss.exe" AND SourceImage!="*svchost.exe"

// EDR - Look for known tools
DeviceProcessEvents
| where ProcessCommandLine has_any ("sekurlsa", "mimikatz", "procdump")</div>

                    <h4>T1021.002 - SMB/Windows Admin Shares</h4>
                    <div class="code-block">Technique: Remote Services: SMB/Windows Admin Shares
Tactic: Lateral Movement
Platform: Windows

Description:
Adversaries may use SMB to execute files on remote systems using 
admin shares (C$, ADMIN$, IPC$).

Detection Opportunities:
1. Network Connections
   - Port 445 connections to multiple internal hosts
   - Connection patterns (one source to many destinations)

2. Authentication
   - Network logons (Type 3) followed by file access
   - Admin share access events

3. File Creation
   - Files written to admin shares
   - Execution from admin shares

Detection Queries:
// Network - Multiple SMB destinations
index=firewall dest_port=445
| stats dc(dest_ip) as unique_targets by src_ip
| where unique_targets > 5

// Authentication - Network logons
index=security EventCode=4624 Logon_Type=3
| stats dc(ComputerName) as hosts by Account_Name
| where hosts > 5</div>
                </div>

                <!-- Threat Actor Mapping -->
                <h2><i class="fas fa-user-secret"></i> Threat Actor TTPs</h2>
                <div class="config-section">
                    <h4>Example: APT29 (Cozy Bear) Techniques</h4>
                    <div class="code-block">APT29 Commonly Used Techniques:

Initial Access:
├─ T1566.001 Spearphishing Attachment
└─ T1566.002 Spearphishing Link

Execution:
├─ T1059.001 PowerShell
├─ T1059.005 Visual Basic
└─ T1204.002 Malicious File

Persistence:
├─ T1053.005 Scheduled Task
├─ T1547.001 Registry Run Keys
└─ T1574.001 DLL Search Order Hijacking

Privilege Escalation:
└─ T1055 Process Injection

Defense Evasion:
├─ T1027 Obfuscated Files or Information
├─ T1036 Masquerading
└─ T1070.004 File Deletion

Credential Access:
├─ T1003.001 LSASS Memory
├─ T1003.003 NTDS
└─ T1558.003 Kerberoasting

Command and Control:
├─ T1071.001 Web Protocols
├─ T1573.002 Asymmetric Cryptography
└─ T1090 Proxy</div>

                    <h4>Using Threat Actor TTPs for Defense</h4>
                    <ul style="color: #8b949e;">
                        <li>Review MITRE ATT&CK pages for threat actors targeting your industry</li>
                        <li>Prioritize detection for their commonly used techniques</li>
                        <li>Use their procedures to create specific hunting queries</li>
                        <li>Test defenses against their known tool usage</li>
                    </ul>
                </div>

                <!-- Building Detection from ATT&CK -->
                <h2><i class="fas fa-hammer"></i> Building Detections from ATT&CK</h2>
                <div class="config-section">
                    <h4>Step-by-Step Process</h4>
                    <div class="code-block">1. Select Technique
   └─ T1053.005 - Scheduled Task/Job: Scheduled Task

2. Review ATT&CK Page
   └─ Read description, procedure examples, detection guidance

3. Identify Observables
   └─ Process: schtasks.exe with /create
   └─ Registry: Task registration
   └─ File: Task XML in Tasks folder
   └─ Event Log: Task Scheduler events (4698)

4. Check Data Sources
   └─ Do we have Sysmon? Yes
   └─ Do we have Windows Event Logs? Yes
   └─ Do we have EDR? Yes

5. Write Detection Logic
   └─ Process creation: schtasks.exe /create
   └─ Suspicious: running from temp, encoded commands
   └─ Exclusions: Known admin tools, SCCM

6. Test Detection
   └─ Run Atomic Red Team T1053.005
   └─ Verify alert fires
   └─ Check for false positives

7. Document
   └─ MITRE mapping: T1053.005
   └─ Data sources used
   └─ False positive guidance
   └─ Response procedures</div>

                    <h4>Detection Rule Template with ATT&CK</h4>
                    <div class="code-block">---
name: Scheduled Task Created via Command Line
description: Detects scheduled task creation using schtasks.exe
author: Detection Engineering
date: 2024-01-15

mitre_attack:
  tactic: 
    - TA0003 (Persistence)
    - TA0002 (Execution)
  technique:
    - T1053.005 (Scheduled Task)

data_sources:
  - Process Creation (Sysmon EventID 1)
  - Windows Security Event Log (4698)

detection_logic: |
  process_name = "schtasks.exe"
  AND command_line contains "/create"
  AND (
    command_line contains "cmd" OR
    command_line contains "powershell" OR
    command_line contains ".bat" OR
    command_line contains "http"
  )

false_positives:
  - SCCM deployments
  - Administrative automation
  - Software installers

response:
  - Identify the scheduled task name and action
  - Check if user should be creating scheduled tasks
  - Review what the task executes
  - If malicious, remove task and investigate further
---</div>
                </div>

                <!-- ATT&CK Data Sources -->
                <h2><i class="fas fa-stream"></i> ATT&CK Data Sources</h2>
                <div class="config-section">
                    <p>ATT&CK v10+ includes detailed data source mappings:</p>
                    
                    <table class="styled-table">
                        <thead>
                            <tr><th>Data Source</th><th>Data Components</th><th>Example Techniques</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Process</strong></td>
                                <td>Creation, Termination, Access, Modification</td>
                                <td>T1059, T1055, T1003</td>
                            </tr>
                            <tr>
                                <td><strong>File</strong></td>
                                <td>Creation, Deletion, Modification, Access</td>
                                <td>T1105, T1486, T1070.004</td>
                            </tr>
                            <tr>
                                <td><strong>Network Traffic</strong></td>
                                <td>Flow, Content, Connection</td>
                                <td>T1071, T1048, T1021</td>
                            </tr>
                            <tr>
                                <td><strong>Command</strong></td>
                                <td>Execution</td>
                                <td>T1059, T1218</td>
                            </tr>
                            <tr>
                                <td><strong>Windows Registry</strong></td>
                                <td>Key Creation, Modification, Deletion</td>
                                <td>T1547.001, T1112</td>
                            </tr>
                            <tr>
                                <td><strong>Logon Session</strong></td>
                                <td>Creation, Metadata</td>
                                <td>T1078, T1110</td>
                            </tr>
                            <tr>
                                <td><strong>Script</strong></td>
                                <td>Execution</td>
                                <td>T1059.001, T1059.005</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Gap Analysis Process -->
                <h2><i class="fas fa-search-minus"></i> Coverage Gap Analysis</h2>
                <div class="config-section">
                    <h4>Gap Analysis Workflow</h4>
                    <div class="code-block">1. Inventory Current Detections
   └─ Export all detection rules
   └─ Tag with ATT&CK techniques
   └─ Note data sources used

2. Identify Priority Techniques
   └─ Review threat intel for your industry
   └─ Check MITRE top techniques reports
   └─ Consider your threat model

3. Map Coverage
   └─ Create ATT&CK Navigator layer
   └─ Color-code by coverage level
   └─ Identify gaps (no coverage)

4. Analyze Gaps
   └─ Do we have the required data source?
   └─ Is detection feasible?
   └─ What's the effort to build detection?

5. Prioritize
   └─ Risk = Likelihood × Impact × (1 - Detection)
   └─ Focus on high-likelihood, high-impact gaps
   └─ Consider data source availability

6. Build Detections
   └─ Start with highest priority gaps
   └─ Use ATT&CK for detection guidance
   └─ Test with Atomic Red Team

7. Validate and Maintain
   └─ Regular coverage reviews
   └─ Update as new techniques emerge
   └─ Track detection effectiveness</div>

                    <h4>Coverage Maturity Levels</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Level</th><th>Description</th><th>Criteria</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>0 - None</strong></td>
                                <td>No detection capability</td>
                                <td>No rules, no data source</td>
                            </tr>
                            <tr>
                                <td><strong>1 - Basic</strong></td>
                                <td>Limited detection</td>
                                <td>Single variant detected, high FP</td>
                            </tr>
                            <tr>
                                <td><strong>2 - Partial</strong></td>
                                <td>Moderate detection</td>
                                <td>Common variants detected, some FP</td>
                            </tr>
                            <tr>
                                <td><strong>3 - Good</strong></td>
                                <td>Strong detection</td>
                                <td>Most variants, tuned for low FP</td>
                            </tr>
                            <tr>
                                <td><strong>4 - Comprehensive</strong></td>
                                <td>Excellent detection</td>
                                <td>All known variants, very low FP, tested</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- More Interview Questions -->
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you map an incident to ATT&CK?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Analyze each event/finding:</strong> What behavior does it represent?</li>
                                <li><strong>Match to technique:</strong> Find the ATT&CK technique that describes this behavior</li>
                                <li><strong>Consider context:</strong> What tactic does this serve in the attack?</li>
                                <li><strong>Build the chain:</strong> Map the entire attack timeline</li>
                                <li><strong>Identify gaps:</strong> Where did detection fail?</li>
                            </ol>
                            <p style="margin-top: 12px;">This helps understand the full attack scope and improve future detection.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the relationship between ATT&CK and MITRE D3FEND?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>ATT&CK:</strong> Describes adversary behaviors (offense)</li>
                                <li><strong>D3FEND:</strong> Describes defensive countermeasures (defense)</li>
                                <li><strong>Relationship:</strong> D3FEND maps defensive techniques to ATT&CK techniques they counter</li>
                            </ul>
                            <p style="margin-top: 12px;">Use together: Identify ATT&CK gaps → Look up D3FEND countermeasures → Implement defenses</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>
