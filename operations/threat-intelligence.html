<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Intelligence | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Operations</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-bar"></i> Metrics & KPIs</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Alert Management</div>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-filter"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-tags"></i> Classification</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-map"></i> MITRE Mapping</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="incident-response.html" class="nav-link"><i class="fas fa-fire-extinguisher"></i> IR Process</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-lock"></i> Containment</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-plug"></i> IR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Analysis Guides</div>
                    <a href="log-analysis.html" class="nav-link"><i class="fas fa-file-alt"></i> Log Analysis</a>
                    <a href="malware-analysis.html" class="nav-link"><i class="fas fa-bug"></i> Malware Analysis</a>
                    <a href="phishing-analysis.html" class="nav-link"><i class="fas fa-fish"></i> Phishing Analysis</a>
                    <a href="forensics.html" class="nav-link"><i class="fas fa-microscope"></i> Forensics</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Domains</div>
                    <a href="identity-security.html" class="nav-link"><i class="fas fa-user-shield"></i> Identity Security</a>
                    <a href="network-security.html" class="nav-link"><i class="fas fa-network-wired"></i> Network Security</a>
                    <a href="cloud-security.html" class="nav-link"><i class="fas fa-cloud"></i> Cloud Security</a>
                    <a href="threat-intelligence.html" class="nav-link active"><i class="fas fa-skull-crossbones"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Governance</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> SIEM Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Priority</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Compliance</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Operations</a><span class="separator">/</span>
                    <span class="current">Threat Intelligence</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-brain"></i> Threat Intelligence</h1>
                <p class="lead">Leverage threat intelligence for proactive defense. Learn to consume, analyze, and operationalize intelligence from various sources to improve detection and response.</p>

                <!-- TI Overview -->
                <h2><i class="fas fa-info-circle"></i> Threat Intelligence Overview</h2>
                <div class="config-section">
                    <h4>Types of Threat Intelligence</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Description</th><th>Audience</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Strategic</strong></td>
                                <td>High-level trends, motivations</td>
                                <td>Executives, management</td>
                            </tr>
                            <tr>
                                <td><strong>Tactical</strong></td>
                                <td>TTPs, attack patterns</td>
                                <td>SOC managers, hunt teams</td>
                            </tr>
                            <tr>
                                <td><strong>Operational</strong></td>
                                <td>Specific campaigns, actors</td>
                                <td>IR teams, analysts</td>
                            </tr>
                            <tr>
                                <td><strong>Technical</strong></td>
                                <td>IOCs, signatures</td>
                                <td>SOC analysts, detection engineers</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Intelligence Lifecycle</h4>
                    <div class="code-block">Threat Intelligence Lifecycle:

1. PLANNING & DIRECTION
   - Define intelligence requirements
   - Identify key questions
   - Prioritize threats

2. COLLECTION
   - Gather from sources
   - OSINT, commercial feeds
   - ISACs, government

3. PROCESSING
   - Normalize data
   - Deduplicate
   - Enrich with context

4. ANALYSIS
   - Evaluate relevance
   - Assess reliability
   - Connect to your environment

5. DISSEMINATION
   - Share with stakeholders
   - Integrate into tools
   - Create detections

6. FEEDBACK
   - Evaluate effectiveness
   - Improve collection
   - Update requirements</div>
                </div>

                <!-- Indicator Types -->
                <h2><i class="fas fa-crosshairs"></i> Indicators of Compromise (IOCs)</h2>
                <div class="config-section">
                    <h4>IOC Types and Usage</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>IOC Type</th><th>Examples</th><th>Lifespan</th><th>Detection Value</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>File Hash</strong></td>
                                <td>MD5, SHA256, SHA1</td>
                                <td>Short</td>
                                <td>High specificity</td>
                            </tr>
                            <tr>
                                <td><strong>IP Address</strong></td>
                                <td>C2 servers, scanners</td>
                                <td>Medium</td>
                                <td>May have FPs</td>
                            </tr>
                            <tr>
                                <td><strong>Domain</strong></td>
                                <td>C2, phishing domains</td>
                                <td>Medium</td>
                                <td>Good for detection</td>
                            </tr>
                            <tr>
                                <td><strong>URL</strong></td>
                                <td>Payload delivery, phishing</td>
                                <td>Short</td>
                                <td>Very specific</td>
                            </tr>
                            <tr>
                                <td><strong>Email</strong></td>
                                <td>Sender, subject patterns</td>
                                <td>Short</td>
                                <td>Campaign-specific</td>
                            </tr>
                            <tr>
                                <td><strong>Registry</strong></td>
                                <td>Persistence keys</td>
                                <td>Long</td>
                                <td>Behavioral</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Pyramid of Pain</h4>
                    <div class="code-block">David Bianco's Pyramid of Pain:

        /\
       /  \     TTPs (Hardest to change)
      /----\    
     / Tools \   Tools (Difficult)
    /----------\
   /  Artifacts \   Network/Host Artifacts
  /--------------\
 /   Domain Names \   Domain Names (Moderate)
/------------------\
/    IP Addresses   \   IP Addresses (Easy)
/----------------------\
/      Hash Values      \   Hash Values (Trivial)
--------------------------

Focus detection on TTPs for lasting value.
Hash and IP blocks easily evaded.</div>
                </div>

                <!-- Intelligence Sources -->
                <h2><i class="fas fa-rss"></i> Intelligence Sources</h2>
                <div class="config-section">
                    <h4>Free/Open Sources</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Source</th><th>Type</th><th>Content</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>AlienVault OTX</td><td>IOC Feed</td><td>Community-shared IOCs</td></tr>
                            <tr><td>Abuse.ch</td><td>IOC Feed</td><td>Malware, botnet, SSL blocklists</td></tr>
                            <tr><td>MISP</td><td>Platform</td><td>Threat sharing platform</td></tr>
                            <tr><td>VirusTotal</td><td>Analysis</td><td>File/URL reputation</td></tr>
                            <tr><td>Shodan</td><td>OSINT</td><td>Internet-connected devices</td></tr>
                            <tr><td>CISA</td><td>Advisories</td><td>Government alerts</td></tr>
                            <tr><td>US-CERT</td><td>Advisories</td><td>Vulnerability/threat alerts</td></tr>
                        </tbody>
                    </table>

                    <h4>Commercial Sources</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Provider</th><th>Focus</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>CrowdStrike Falcon Intelligence</td><td>Adversary tracking, IOCs</td></tr>
                            <tr><td>Recorded Future</td><td>Real-time threat intel</td></tr>
                            <tr><td>Mandiant</td><td>APT research, IR intel</td></tr>
                            <tr><td>Palo Alto Unit 42</td><td>Malware analysis, campaigns</td></tr>
                            <tr><td>Microsoft TI</td><td>Nation-state, cybercrime</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Operationalizing TI -->
                <h2><i class="fas fa-cogs"></i> Operationalizing Threat Intelligence</h2>
                <div class="config-section">
                    <h4>Integration Points</h4>
                    <div class="code-block">Where to Use Threat Intel:

SIEM Integration:
- Import IOCs as lookup tables
- Create correlation rules
- Enrich alerts with context

EDR/XDR Integration:
- Blocklist malicious hashes
- Alert on IOC matches
- Hunt for indicators

Firewall/Proxy:
- Block malicious IPs/domains
- Alert on connection attempts

Email Security:
- Block known phishing domains
- Flag malicious sender patterns

Vulnerability Management:
- Prioritize exploited CVEs
- Focus on actively targeted vulns</div>

                    <h4>SIEM IOC Matching Examples</h4>
                    <div class="code-block">// Splunk: Match against threat feed
index=network 
| lookup threat_intel_ips ip as dest_ip OUTPUT threat_category, threat_source
| where isnotnull(threat_category)
| table _time, src_ip, dest_ip, threat_category, threat_source

// KQL (Sentinel): TI indicator matching
ThreatIntelligenceIndicator
| where ExpirationDateTime > now()
| where IndicatorType == "ipv4-addr"
| join kind=inner (
    CommonSecurityLog
    | where TimeGenerated > ago(1d)
) on $left.NetworkIP == $right.DestinationIP
| project TimeGenerated, SourceIP, DestinationIP, ThreatType, Description

// XQL: Check against known bad hashes
dataset = xdr_data
| filter event_type = FILE
| filter action_file_sha256 in ("hash1", "hash2", "hash3")
| fields agent_hostname, action_file_path, action_file_sha256</div>
                </div>

                <!-- Threat Hunting with TI -->
                <h2><i class="fas fa-search"></i> Threat Hunting with Intelligence</h2>
                <div class="config-section">
                    <h4>Hunt Techniques</h4>
                    <div class="code-block">Intelligence-Driven Hunting:

IOC SWEEP:
- Search historical data for known IOCs
- New intel â†’ Hunt for past compromise
- May find previously undetected activity

TTP HUNTING:
- Use TTPs to create behavioral queries
- More durable than IOC hunting
- Maps to MITRE ATT&CK

CAMPAIGN HUNTING:
- Research specific threat actor
- Hunt for their known tools/techniques
- Check for targeting of your industry

VULNERABILITY HUNTING:
- New critical CVE announced
- Hunt for exploitation attempts
- Check for successful compromise</div>

                    <h4>Hunt Query Examples</h4>
                    <div class="code-block">// Hunt for APT tool (Cobalt Strike default)
// Splunk
index=sysmon EventCode=3 dest_port IN (50050, 443, 80)
| where match(process_name, "rundll32|regsvr32")
| stats count by src_ip, dest_ip, dest_port, process_name

// Hunt for Living off the Land (LOLBins)
// KQL
DeviceProcessEvents
| where FileName in~ ("certutil.exe", "mshta.exe", "regsvr32.exe", "rundll32.exe")
| where ProcessCommandLine has_any ("http://", "https://", "-urlcache", "-decode")
| project Timestamp, DeviceName, FileName, ProcessCommandLine

// Hunt for domain fronting
// Splunk
index=proxy 
| where url_domain != ssl_subject_cn
| stats count by src_ip, url_domain, ssl_subject_cn</div>
                </div>

                <!-- TI Analysis -->
                <h2><i class="fas fa-microscope"></i> Intelligence Analysis</h2>
                <div class="config-section">
                    <h4>Evaluating Intelligence</h4>
                    <div class="code-block">Intelligence Evaluation Criteria:

SOURCE RELIABILITY:
A - Completely reliable
B - Usually reliable
C - Fairly reliable
D - Not usually reliable
E - Unreliable
F - Cannot be judged

INFORMATION ACCURACY:
1 - Confirmed by other sources
2 - Probably true
3 - Possibly true
4 - Doubtful
5 - Improbable
6 - Cannot be judged

Example: "B2" = Usually reliable source, probably true</div>

                    <h4>Contextualization</h4>
                    <div class="code-block">Making Intel Relevant:

Questions to Ask:
- Does this threat target our industry?
- Do we have the vulnerable systems?
- Have we seen related activity?
- What's the threat actor's motivation?
- What's the likely impact if exploited?

Prioritization Factors:
- Relevance to your environment
- Active exploitation in the wild
- Severity of potential impact
- Difficulty of exploitation
- Available mitigations</div>
                </div>

                <!-- STIX/TAXII -->
                <h2><i class="fas fa-exchange-alt"></i> STIX/TAXII Standards</h2>
                <div class="config-section">
                    <h4>Standards Overview</h4>
                    <div class="code-block">STIX (Structured Threat Information eXpression):
- Standard format for threat intel
- Describes indicators, TTPs, actors
- JSON-based (STIX 2.x)

TAXII (Trusted Automated eXchange of Indicator Information):
- Transport protocol for sharing
- Collection and channel services
- Pull or push models

STIX Objects:
- Indicator: IOCs with patterns
- Malware: Malware descriptions
- Threat Actor: Adversary profiles
- Attack Pattern: TTPs
- Campaign: Attack campaigns
- Relationship: Links between objects</div>

                    <h4>STIX Pattern Examples</h4>
                    <div class="code-block">// File hash pattern
[file:hashes.'SHA-256' = 'abc123...']

// IP address pattern
[ipv4-addr:value = '192.168.1.1']

// Domain pattern
[domain-name:value = 'malicious.com']

// Combined pattern (file AND network)
[file:hashes.'SHA-256' = 'abc123...'] AND 
[network-traffic:dst_ref.type = 'ipv4-addr' AND 
 network-traffic:dst_ref.value = '192.168.1.1']</div>
                </div>

                <!-- Building TI Program -->
                <h2><i class="fas fa-chart-line"></i> Building a TI Program</h2>
                <div class="config-section">
                    <h4>Program Components</h4>
                    <div class="code-block">TI Program Elements:

PEOPLE:
- TI analyst(s)
- Integration with SOC
- Executive sponsorship

PROCESS:
- Intelligence requirements
- Collection procedures
- Analysis workflows
- Dissemination plan

TECHNOLOGY:
- TI platform (TIP)
- Feed aggregation
- SIEM integration
- Automation

METRICS:
- IOCs ingested/matched
- Detections from TI
- Time to operationalize
- False positive rate</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is the Pyramid of Pain and why is it important?</button>
                        <div class="qa-answer">
                            <p>The Pyramid of Pain shows how difficult it is for adversaries to change different indicator types:</p>
                            <ul>
                                <li><strong>Hash values (easy):</strong> Trivial to change, limited detection value</li>
                                <li><strong>IP addresses (easy):</strong> Easily rotated, infrastructure changes</li>
                                <li><strong>Domain names (moderate):</strong> Some effort to change</li>
                                <li><strong>TTPs (hard):</strong> Requires complete retooling</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Key insight:</strong> Focus detection on TTPs for lasting value. Blocking hashes is easy but provides little lasting protection.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you operationalize threat intelligence?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Ingest into SIEM:</strong> Create lookup tables, correlation rules</li>
                                <li><strong>EDR blocklists:</strong> Block known bad hashes</li>
                                <li><strong>Firewall rules:</strong> Block malicious IPs/domains</li>
                                <li><strong>Create detections:</strong> Build rules from TTPs</li>
                                <li><strong>Hunt campaigns:</strong> Proactively search for indicators</li>
                                <li><strong>Measure effectiveness:</strong> Track matches and detections</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What makes good threat intelligence?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Timely:</strong> Current and actionable</li>
                                <li><strong>Relevant:</strong> Applies to your environment/industry</li>
                                <li><strong>Accurate:</strong> Validated and reliable source</li>
                                <li><strong>Contextual:</strong> Includes TTPs, not just IOCs</li>
                                <li><strong>Actionable:</strong> Can be used to improve defenses</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>