<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triage Handbook | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Operations</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-bar"></i> Metrics & KPIs</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Alert Management</div>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-filter"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link active"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-tags"></i> Classification</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-map"></i> MITRE Mapping</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="incident-response.html" class="nav-link"><i class="fas fa-fire-extinguisher"></i> IR Process</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-lock"></i> Containment</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-plug"></i> IR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Analysis Guides</div>
                    <a href="log-analysis.html" class="nav-link"><i class="fas fa-file-alt"></i> Log Analysis</a>
                    <a href="malware-analysis.html" class="nav-link"><i class="fas fa-bug"></i> Malware Analysis</a>
                    <a href="phishing-analysis.html" class="nav-link"><i class="fas fa-fish"></i> Phishing Analysis</a>
                    <a href="forensics.html" class="nav-link"><i class="fas fa-microscope"></i> Forensics</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Domains</div>
                    <a href="identity-security.html" class="nav-link"><i class="fas fa-user-shield"></i> Identity Security</a>
                    <a href="network-security.html" class="nav-link"><i class="fas fa-network-wired"></i> Network Security</a>
                    <a href="cloud-security.html" class="nav-link"><i class="fas fa-cloud"></i> Cloud Security</a>
                    <a href="threat-intelligence.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Governance</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> SIEM Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Priority</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Compliance</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
<header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <span class="current">Triage Handbook</span>
                </div>
            </header>
            <main class="main-content">
<div class="page-header">
                    <h1><i class="fas fa-clipboard-check"></i> Triage Handbook</h1>
                    <p class="lead">Complete decision trees for every common alert type</p>
                </div>
                <section class="content-section">
                    <h2><i class="fas fa-key"></i> Authentication Alert Decision Tree</h2>
                    <div class="workflow-diagram">
<pre>
╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                         AUTHENTICATION ALERT TRIAGE - COMPLETE DECISION TREE                                                                        ║
╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                                                                                     ║
║  ALERT TYPES: Brute force / Password spray / Impossible travel / Failed logins / Unusual location / MFA bypass                                                     ║
║                                                                                                                                                                     ║
║                                                              ┌─────────────────────────┐                                                                            ║
║                                                              │   AUTHENTICATION        │                                                                            ║
║                                                              │   ALERT RECEIVED        │                                                                            ║
║                                                              └────────────┬────────────┘                                                                            ║
║                                                                           │                                                                                         ║
║                                                                           ▼                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 1: IDENTIFY ALERT SUB-TYPE                                                                                                                             ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║  ┌─────────────┬─────────────┬─────────────┬─────────────┬─────────────┬─────────────┬─────────────┐                                                        ║   ║
║  ║  ▼             ▼             ▼             ▼             ▼             ▼             ▼             ▼                                                        ║   ║
║  ║ ┌───────┐   ┌───────┐   ┌───────┐   ┌───────┐   ┌───────┐   ┌───────┐   ┌───────┐   ┌───────┐                                                             ║   ║
║  ║ │BRUTE  │   │PASSWORD│  │IMPOSSI│   │UNUSUAL│   │FAILED │   │SUCCESS│   │MFA    │   │LEGACY │                                                             ║   ║
║  ║ │FORCE  │   │SPRAY   │   │BLE    │   │LOCATION│  │LOGINS │   │AFTER  │   │BYPASS │   │PROTO- │                                                             ║   ║
║  ║ │       │   │        │   │TRAVEL │   │       │   │(Multi)│   │FAILURES│  │       │   │COL    │                                                             ║   ║
║  ║ └───┬───┘   └───┬───┘   └───┬───┘   └───┬───┘   └───┬───┘   └───┬───┘   └───┬───┘   └───┬───┘                                                             ║   ║
║  ║     │           │           │           │           │           │           │           │                                                                    ║   ║
║  ║     ▼           ▼           ▼           ▼           ▼           ▼           ▼           ▼                                                                    ║   ║
║  ║ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐                                                            ║   ║
║  ║ │Single   │ │Multiple │ │2 logins │ │Login    │ │Multiple │ │Failures │ │MFA not  │ │IMAP/POP│                                                            ║   ║
║  ║ │account  │ │accounts │ │from far │ │from new │ │failures │ │then     │ │triggered│ │SMTP    │                                                            ║   ║
║  ║ │many     │ │few fails│ │locations│ │country/ │ │same     │ │success  │ │or failed│ │used    │                                                            ║   ║
║  ║ │failures │ │each     │ │short    │ │city     │ │account  │ │from     │ │attempt  │ │instead │                                                            ║   ║
║  ║ │same src │ │same src │ │time     │ │         │ │         │ │diff IP  │ │         │ │of      │                                                            ║   ║
║  ║ │         │ │         │ │         │ │         │ │         │ │         │ │         │ │modern  │                                                            ║   ║
║  ║ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘                                                            ║   ║
║  ║                                                                                                                                                             ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                           │                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 2: SOURCE IP ANALYSIS                                                                                                                                  ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║                                              ┌─────────────────────────────────────────────────────┐                                                        ║   ║
║  ║                                              │  Is source IP INTERNAL or EXTERNAL?                 │                                                        ║   ║
║  ║                                              └────────────────────────┬────────────────────────────┘                                                        ║   ║
║  ║                                                                       │                                                                                     ║   ║
║  ║                                    ┌──────────────────────────────────┼──────────────────────────────────┐                                                  ║   ║
║  ║                                    ▼                                  ▼                                  ▼                                                  ║   ║
║  ║                               ┌─────────┐                        ┌─────────┐                        ┌─────────┐                                             ║   ║
║  ║                               │INTERNAL │                        │EXTERNAL │                        │  VPN    │                                             ║   ║
║  ║                               │(Corp IP)│                        │(Internet│                        │ EXIT IP │                                             ║   ║
║  ║                               │         │                        │   IP)   │                        │         │                                             ║   ║
║  ║                               └────┬────┘                        └────┬────┘                        └────┬────┘                                             ║   ║
║  ║                                    │                                  │                                  │                                                  ║   ║
║  ║                                    ▼                                  ▼                                  ▼                                                  ║   ║
║  ║                    ┌───────────────────────────┐      ┌───────────────────────────┐      ┌───────────────────────────┐                                      ║   ║
║  ║                    │ LIKELY SCENARIOS:         │      │ CHECK IP REPUTATION:      │      │ USER MAY BE REMOTE:       │                                      ║   ║
║  ║                    │                           │      │                           │      │                           │                                      ║   ║
║  ║                    │ • Misconfigured service   │      │ ☐ VirusTotal              │      │ • Verify VPN connection   │                                      ║   ║
║  ║                    │ • Expired password        │      │ ☐ AbuseIPDB               │      │ • Check VPN logs for user │                                      ║   ║
║  ║                    │ • Saved wrong credential  │      │ ☐ Internal TI             │      │ • Normal if user working  │                                      ║   ║
║  ║                    │ • Service account issue   │      │ ☐ Geolocation             │      │   remotely                │                                      ║   ║
║  ║                    │ • Actual insider threat   │      │                           │      │                           │                                      ║   ║
║  ║                    │                           │      │ IF KNOWN BAD IP:          │      │ IF VPN BUT WRONG USER:    │                                      ║   ║
║  ║                    │ NEXT: Check what device   │      │ ──► HIGH PRIORITY         │      │ ──► Credential theft      │                                      ║   ║
║  ║                    │       is at that IP       │      │ ──► Block IP              │      │                           │                                      ║   ║
║  ║                    └───────────────────────────┘      │ ──► Check for success     │      └───────────────────────────┘                                      ║   ║
║  ║                                                       └───────────────────────────┘                                                                          ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                           │                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 3: TARGET ACCOUNT ANALYSIS                                                                                                                             ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║                                              ┌─────────────────────────────────────────────────────┐                                                        ║   ║
║  ║                                              │  What TYPE of account is being targeted?            │                                                        ║   ║
║  ║                                              └────────────────────────┬────────────────────────────┘                                                        ║   ║
║  ║                                                                       │                                                                                     ║   ║
║  ║     ┌───────────────┬───────────────┬───────────────┬─────────────────┼─────────────────┬───────────────┬───────────────┐                                   ║   ║
║  ║     ▼               ▼               ▼               ▼                 ▼                 ▼               ▼               ▼                                   ║   ║
║  ║ ┌────────┐     ┌────────┐     ┌────────┐     ┌────────┐         ┌────────┐       ┌────────┐     ┌────────┐     ┌────────┐                                  ║   ║
║  ║ │DOMAIN  │     │LOCAL   │     │SERVICE │     │STANDARD│         │EXEC/VIP│       │IT ADMIN│     │DISABLED│     │NON-    │                                  ║   ║
║  ║ │ADMIN   │     │ADMIN   │     │ACCOUNT │     │USER    │         │USER    │       │        │     │ACCOUNT │     │EXISTENT│                                  ║   ║
║  ║ └───┬────┘     └───┬────┘     └───┬────┘     └───┬────┘         └───┬────┘       └───┬────┘     └───┬────┘     └───┬────┘                                  ║   ║
║  ║     │               │               │               │                 │               │               │               │                                      ║   ║
║  ║     ▼               ▼               ▼               ▼                 ▼               ▼               ▼               ▼                                      ║   ║
║  ║ ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐        ┌─────────┐     ┌─────────┐    ┌─────────┐    ┌─────────┐                                   ║   ║
║  ║ │CRITICAL │    │HIGH     │    │HIGH     │    │MEDIUM   │        │HIGH     │     │HIGH     │    │SUSPICIOUS│   │RECON    │                                   ║   ║
║  ║ │PRIORITY │    │PRIORITY │    │PRIORITY │    │PRIORITY │        │PRIORITY │     │PRIORITY │    │          │    │ACTIVITY │                                   ║   ║
║  ║ │         │    │         │    │         │    │         │        │         │     │         │    │Why target│    │         │                                   ║   ║
║  ║ │Immedi-  │    │Can pwn  │    │Often has│    │Standard │        │High     │     │Privi-   │    │disabled  │    │Attacker │                                   ║   ║
║  ║ │ate      │    │entire   │    │excessive│    │triage   │        │value    │     │leged    │    │account?  │    │guessing │                                   ║   ║
║  ║ │escalate │    │server   │    │privi-   │    │         │        │target   │     │access   │    │          │    │usernames│                                   ║   ║
║  ║ │to IR    │    │         │    │leges    │    │         │        │for BEC  │     │         │    │Terminated│    │         │                                   ║   ║
║  ║ │         │    │         │    │         │    │         │        │         │     │         │    │employee? │    │Low risk │                                   ║   ║
║  ║ └─────────┘    └─────────┘    └─────────┘    └─────────┘        └─────────┘     └─────────┘    └─────────┘    └─────────┘                                   ║   ║
║  ║                                                                                                                                                             ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                           │                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 4: CRITICAL QUESTION - WAS THERE A SUCCESSFUL LOGIN?                                                                                                   ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║                                              ┌─────────────────────────────────────────────────────┐                                                        ║   ║
║  ║                                              │  After the failures, was there a SUCCESSFUL login? │                                                        ║   ║
║  ║                                              │  (Check authentication logs for success event)      │                                                        ║   ║
║  ║                                              └────────────────────────┬────────────────────────────┘                                                        ║   ║
║  ║                                                                       │                                                                                     ║   ║
║  ║                          ┌────────────────────────────────────────────┼────────────────────────────────────────────┐                                        ║   ║
║  ║                          ▼                                            ▼                                            ▼                                        ║   ║
║  ║                     ┌─────────┐                                  ┌─────────┐                                  ┌─────────┐                                   ║   ║
║  ║                     │   YES   │                                  │   NO    │                                  │ UNSURE  │                                   ║   ║
║  ║                     │(Success │                                  │(All     │                                  │         │                                   ║   ║
║  ║                     │ after   │                                  │failures)│                                  │         │                                   ║   ║
║  ║                     │failures)│                                  │         │                                  │         │                                   ║   ║
║  ║                     └────┬────┘                                  └────┬────┘                                  └────┬────┘                                   ║   ║
║  ║                          │                                            │                                            │                                        ║   ║
║  ║                          ▼                                            ▼                                            ▼                                        ║   ║
║  ║     ┌──────────────────────────────────────────┐     ┌──────────────────────────────────────────┐     ┌────────────────────────────────┐                    ║   ║
║  ║     │ ██████████████████████████████████████ │     │ LOWER PRIORITY:                          │     │ INVESTIGATE:                   │                    ║   ║
║  ║     │ ██  ACCOUNT LIKELY COMPROMISED!     ██ │     │                                          │     │                                │                    ║   ║
║  ║     │ ██████████████████████████████████████ │     │ • Attack was unsuccessful               │     │ • Query auth logs for success  │                    ║   ║
║  ║     │                                          │     │ • Account lockout may have triggered   │     │ • Check different auth sources │                    ║   ║
║  ║     │ IMMEDIATE ACTIONS:                       │     │ • Still document and monitor           │     │ • O365, Azure AD, on-prem AD   │                    ║   ║
║  ║     │ ☐ 1. DISABLE ACCOUNT IMMEDIATELY        │     │                                          │     │ • VPN, SSO, etc.               │                    ║   ║
║  ║     │ ☐ 2. Revoke all sessions                │     │ ACTIONS:                                 │     │                                │                    ║   ║
║  ║     │ ☐ 3. Reset password                     │     │ ☐ Block source IP if external          │     │ IF SUCCESS FOUND:              │                    ║   ║
║  ║     │ ☐ 4. Enable/verify MFA                  │     │ ☐ Check if account is lockout-enabled  │     │ ──► Treat as COMPROMISED       │                    ║   ║
║  ║     │ ☐ 5. Check post-success activity        │     │ ☐ Document pattern for tuning          │     │                                │                    ║   ║
║  ║     │ ☐ 6. Check for lateral movement         │     │ ☐ Consider automated block rule        │     │ IF NO SUCCESS:                 │                    ║   ║
║  ║     │ ☐ 7. Check inbox rules                  │     │ ☐ Close as "Attack Blocked"            │     │ ──► Treat as failed attack     │                    ║   ║
║  ║     │                                          │     │                                          │     └────────────────────────────────┘                    ║   ║
║  ║     │ ──► ESCALATE TO TIER 2 / IR             │     └──────────────────────────────────────────┘                                                            ║   ║
║  ║     └──────────────────────────────────────────┘                                                                                                             ║   ║
║  ║                                                                                                                                                             ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                           │                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 5: COMMON FALSE POSITIVE CHECKS                                                                                                                        ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║  ┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐  ║   ║
║  ║  │ COMMON FALSE POSITIVE SCENARIOS - Check these before closing as benign:                                                                               │  ║   ║
║  ║  │                                                                                                                                                       │  ║   ║
║  ║  │ ☐ EXPIRED PASSWORD: User trying with old password. Check: Password last changed date vs. failure time                                                 │  ║   ║
║  ║  │ ☐ LOCKED ACCOUNT: Account already locked, user keeps trying. Check: Account lockout status                                                            │  ║   ║
║  ║  │ ☐ SERVICE ACCOUNT: Misconfigured with wrong password. Check: Is source a server? Is target a service account?                                         │  ║   ║
║  ║  │ ☐ MOBILE DEVICE: Old password cached on phone. Check: User agent, is it mobile?                                                                       │  ║   ║
║  ║  │ ☐ SECURITY SCANNER: Vulnerability scanner testing. Check: Is source IP a known scanner?                                                               │  ║   ║
║  ║  │ ☐ PASSWORD CHANGE: User changed password, old cached. Check: Recent password change?                                                                  │  ║   ║
║  ║  │ ☐ VPN + MFA: VPN client retrying after MFA. Check: VPN logs, MFA logs                                                                                 │  ║   ║
║  ║  │                                                                                                                                                       │  ║   ║
║  ║  │ ⚠️ IMPORTANT: Even if FP, if there's a SUCCESS after failures from DIFFERENT IP ──► Still treat as potential compromise                              │  ║   ║
║  ║  └───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  ║   ║
║  ║                                                                                                                                                             ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                                                                                                                     ║
╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
</pre>
                    </div>
                </section>
                <section class="content-section">
                    <h2><i class="fas fa-terminal"></i> Suspicious PowerShell Decision Tree</h2>
                    <div class="workflow-diagram">
<pre>
╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                         SUSPICIOUS POWERSHELL TRIAGE - COMPLETE DECISION TREE                                                                       ║
╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                                                                                     ║
║                                                              ┌─────────────────────────┐                                                                            ║
║                                                              │ POWERSHELL ALERT        │                                                                            ║
║                                                              │ RECEIVED                │                                                                            ║
║                                                              └────────────┬────────────┘                                                                            ║
║                                                                           │                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 1: IDENTIFY USER CONTEXT                                                                                                                               ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║                                              ┌─────────────────────────────────────────────────────┐                                                        ║   ║
║  ║                                              │  WHO is running the PowerShell command?             │                                                        ║   ║
║  ║                                              └────────────────────────┬────────────────────────────┘                                                        ║   ║
║  ║                                                                       │                                                                                     ║   ║
║  ║            ┌───────────────────┬───────────────────┬──────────────────┼──────────────────┬───────────────────┬───────────────────┐                          ║   ║
║  ║            ▼                   ▼                   ▼                  ▼                  ▼                   ▼                   ▼                          ║   ║
║  ║       ┌─────────┐         ┌─────────┐         ┌─────────┐       ┌─────────┐        ┌─────────┐         ┌─────────┐         ┌─────────┐                      ║   ║
║  ║       │IT ADMIN │         │DEVELOPER│         │STANDARD │       │SERVICE  │        │  SYSTEM │         │HELPDESK │         │UNKNOWN  │                      ║   ║
║  ║       │         │         │         │         │USER     │       │ACCOUNT  │        │(NT AUTH)│         │         │         │         │                      ║   ║
║  ║       └────┬────┘         └────┬────┘         └────┬────┘       └────┬────┘        └────┬────┘         └────┬────┘         └────┬────┘                      ║   ║
║  ║            │                   │                   │                 │                  │                   │                   │                           ║   ║
║  ║            ▼                   ▼                   ▼                 ▼                  ▼                   ▼                   ▼                           ║   ║
║  ║       ┌─────────┐         ┌─────────┐         ┌─────────┐       ┌─────────┐        ┌─────────┐         ┌─────────┐         ┌─────────┐                      ║   ║
║  ║       │MAY be   │         │Could be │         │UNUSUAL! │       │CHECK:   │        │COULD BE:│         │LIMITED  │         │HIGH     │                      ║   ║
║  ║       │legitimate│        │scripting│         │Standard │       │What     │        │ • SCCM  │         │PS usage │         │SUSPICION│                      ║   ║
║  ║       │but verify│        │work     │         │users    │       │service? │        │ • Intune│         │expected │         │         │                      ║   ║
║  ║       │content   │        │         │         │rarely   │       │Expected?│        │ • GPO   │         │         │         │Identify │                      ║   ║
║  ║       │         │         │Still    │         │use PS   │       │         │        │ • WMI   │         │Verify   │         │user     │                      ║   ║
║  ║       │         │         │verify   │         │         │       │         │        │ • Task  │         │content  │         │first    │                      ║   ║
║  ║       └─────────┘         └─────────┘         └─────────┘       └─────────┘        └─────────┘         └─────────┘         └─────────┘                      ║   ║
║  ║                                                                                                                                                             ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                           │                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 2: CHECK PARENT PROCESS                                                                                                                                ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║                                              ┌─────────────────────────────────────────────────────┐                                                        ║   ║
║  ║                                              │  What PARENT PROCESS spawned PowerShell?            │                                                        ║   ║
║  ║                                              └────────────────────────┬────────────────────────────┘                                                        ║   ║
║  ║                                                                       │                                                                                     ║   ║
║  ║     ┌────────────────┬────────────────┬────────────────┬──────────────┼──────────────┬────────────────┬────────────────┬────────────────┐                   ║   ║
║  ║     ▼                ▼                ▼                ▼              ▼              ▼                ▼                ▼                ▼                   ║   ║
║  ║ ┌────────┐      ┌────────┐      ┌────────┐      ┌────────┐      ┌────────┐    ┌────────┐      ┌────────┐      ┌────────┐      ┌────────┐                   ║   ║
║  ║ │EXPLORER│      │ CMD    │      │ WORD/  │      │OUTLOOK │      │SVCHOST │    │WMIPRVSE│      │SCHEDULE│      │WSCRIPT/│      │UNKNOWN │                   ║   ║
║  ║ │.EXE    │      │.EXE    │      │ EXCEL  │      │.EXE    │      │.EXE    │    │.EXE    │      │.EXE    │      │CSCRIPT │      │PROCESS │                   ║   ║
║  ║ └───┬────┘      └───┬────┘      └───┬────┘      └───┬────┘      └───┬────┘    └───┬────┘      └───┬────┘      └───┬────┘      └───┬────┘                   ║   ║
║  ║     │               │               │               │               │             │               │               │               │                        ║   ║
║  ║     ▼               ▼               ▼               ▼               ▼             ▼               ▼               ▼               ▼                        ║   ║
║  ║ ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐                       ║   ║
║  ║ │User     │    │Could be │    │🚨 HIGH  │    │🚨 HIGH  │    │Service  │    │WMI exec │    │Sched    │    │Script   │    │VERY     │                       ║   ║
║  ║ │launched │    │chained  │    │SUSPICION│    │SUSPICION│    │context  │    │ution    │    │task     │    │launched │    │SUSPICIOUS│                      ║   ║
║  ║ │manually │    │or       │    │         │    │         │    │         │    │         │    │         │    │         │    │          │                      ║   ║
║  ║ │         │    │script   │    │MACRO    │    │EMAIL    │    │Check    │    │Often    │    │Check if │    │Often    │    │Investigate│                     ║   ║
║  ║ │Verify   │    │         │    │EXECUT-  │    │ATTACH   │    │what     │    │used by  │    │legit    │    │malicious│    │process   │                      ║   ║
║  ║ │content  │    │Check    │    │ION!     │    │MENT!    │    │service  │    │lateral  │    │task     │    │         │    │name      │                      ║   ║
║  ║ │         │    │original │    │         │    │         │    │         │    │movement │    │         │    │         │    │          │                      ║   ║
║  ║ │NORMAL   │    │parent   │    │ESCALATE │    │ESCALATE │    │VERIFY   │    │SUSPICI- │    │VERIFY   │    │SUSPICI- │    │ESCALATE  │                      ║   ║
║  ║ └─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘                       ║   ║
║  ║                                                                                                                                                             ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                           │                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 3: ANALYZE COMMAND LINE                                                                                                                                ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║  ┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐  ║   ║
║  ║  │ RED FLAG INDICATORS IN COMMAND LINE:                                                                                                                  │  ║   ║
║  ║  │                                                                                                                                                       │  ║   ║
║  ║  │ 🚨 ENCODED COMMAND (-enc, -encodedcommand):                                                                                                           │  ║   ║
║  ║  │    powershell.exe -enc JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8A...                                                                                    │  ║   ║
║  ║  │    ──► DECODE IT: [System.Text.Encoding]::Unicode.GetString([Convert]::FromBase64String("..."))                                                      │  ║   ║
║  ║  │                                                                                                                                                       │  ║   ║
║  ║  │ 🚨 DOWNLOAD CRADLES:                                                                                                                                  │  ║   ║
║  ║  │    • IEX (New-Object Net.WebClient).DownloadString('http://...')                                                                                     │  ║   ║
║  ║  │    • Invoke-Expression                                                                                                                                │  ║   ║
║  ║  │    • Invoke-WebRequest | IEX                                                                                                                          │  ║   ║
║  ║  │    • Start-BitsTransfer                                                                                                                               │  ║   ║
║  ║  │                                                                                                                                                       │  ║   ║
║  ║  │ 🚨 EVASION TECHNIQUES:                                                                                                                                │  ║   ║
║  ║  │    • -ExecutionPolicy Bypass                                                                                                                          │  ║   ║
║  ║  │    • -WindowStyle Hidden                                                                                                                              │  ║   ║
║  ║  │    • -NoProfile -NonInteractive                                                                                                                       │  ║   ║
║  ║  │    • AMSI bypass patterns                                                                                                                             │  ║   ║
║  ║  │                                                                                                                                                       │  ║   ║
║  ║  │ 🚨 CREDENTIAL ACCESS:                                                                                                                                 │  ║   ║
║  ║  │    • Mimikatz patterns                              • Get-Credential                                                                                  │  ║   ║
║  ║  │    • sekurlsa::logonpasswords                       • ConvertTo-SecureString                                                                         │  ║   ║
║  ║  │    • Invoke-Mimikatz                                                                                                                                  │  ║   ║
║  ║  │                                                                                                                                                       │  ║   ║
║  ║  │ 🚨 RECONNAISSANCE:                                                                                                                                    │  ║   ║
║  ║  │    • Get-ADUser, Get-ADComputer, Get-ADGroup                                                                                                          │  ║   ║
║  ║  │    • Net user /domain, net group /domain                                                                                                              │  ║   ║
║  ║  │    • Test-NetConnection (port scanning)                                                                                                               │  ║   ║
║  ║  │                                                                                                                                                       │  ║   ║
║  ║  │ ✅ OFTEN LEGITIMATE:                                                                                                                                  │  ║   ║
║  ║  │    • Get-ChildItem, Get-Content, Get-Process        • Import-Module                                                                                   │  ║   ║
║  ║  │    • Set-ExecutionPolicy (when run by admin)        • Install-Module                                                                                  │  ║   ║
║  ║  │    • Get-Help, Get-Command                          • Update-Help                                                                                     │  ║   ║
║  ║  └───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  ║   ║
║  ║                                                                                                                                                             ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                           │                                                                                         ║
║  ╔════════════════════════════════════════════════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╗   ║
║  ║ STEP 4: CHECK NETWORK ACTIVITY                                                                                                                              ║   ║
║  ╠════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣   ║
║  ║                                                                                                                                                             ║   ║
║  ║                                              ┌─────────────────────────────────────────────────────┐                                                        ║   ║
║  ║                                              │  Did PowerShell make any NETWORK CONNECTIONS?       │                                                        ║   ║
║  ║                                              └────────────────────────┬────────────────────────────┘                                                        ║   ║
║  ║                                                                       │                                                                                     ║   ║
║  ║                          ┌────────────────────────────────────────────┼────────────────────────────────────────────┐                                        ║   ║
║  ║                          ▼                                            ▼                                            ▼                                        ║   ║
║  ║                     ┌─────────┐                                  ┌─────────┐                                  ┌─────────┐                                   ║   ║
║  ║                     │   YES   │                                  │   NO    │                                  │ UNKNOWN │                                   ║   ║
║  ║                     │         │                                  │         │                                  │         │                                   ║   ║
║  ║                     └────┬────┘                                  └────┬────┘                                  └────┬────┘                                   ║   ║
║  ║                          │                                            │                                            │                                        ║   ║
║  ║                          ▼                                            ▼                                            ▼                                        ║   ║
║  ║     ┌──────────────────────────────────────────┐     ┌──────────────────────────────────────────┐     ┌────────────────────────────────┐                    ║   ║
║  ║     │ ANALYZE THE CONNECTION:                  │     │ LOWER RISK:                              │     │ CHECK EDR/SYSMON:              │                    ║   ║
║  ║     │                                          │     │                                          │     │                                │                    ║   ║
║  ║     │ ☐ What IP/domain was contacted?          │     │ • No external communication              │     │ • Network connection events    │                    ║   ║
║  ║     │ ☐ Check domain reputation                │     │ • Local execution only                   │     │ • DNS queries                  │                    ║   ║
║  ║     │ ☐ Check domain age (WHOIS)               │     │ • Still analyze command content          │     │ • Process network activity     │                    ║   ║
║  ║     │ ☐ Was anything downloaded?               │     │                                          │     │                                │                    ║   ║
║  ║     │ ☐ Was data sent out (exfil)?             │     │ COULD STILL BE:                          │     │                                │                    ║   ║
║  ║     │                                          │     │ • Local privilege escalation             │     │                                │                    ║   ║
║  ║     │ IF EXTERNAL + SUSPICIOUS DOMAIN:         │     │ • Credential dumping                     │     │                                │                    ║   ║
║  ║     │ ──► HIGH/CRITICAL PRIORITY               │     │ • Persistence installation               │     │                                │                    ║   ║
║  ║     │ ──► Block domain at proxy                │     │                                          │     │                                │                    ║   ║
║  ║     │ ──► Isolate endpoint                     │     │                                          │     │                                │                    ║   ║
║  ║     └──────────────────────────────────────────┘     └──────────────────────────────────────────┘     └────────────────────────────────┘                    ║   ║
║  ║                                                                                                                                                             ║   ║
║  ╚═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝   ║
║                                                                                                                                                                     ║
╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
</pre>
                    </div>
                </section>
                <section class="content-section interview-section" >
                    <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                    <div class="interview-box">
                        <div class="interview-question">
                            <i class="fas fa-question-circle"></i>
                            <span>How do you analyze a suspicious PowerShell alert?</span>
                        </div>
                        <div class="interview-answer">
                            <p><strong>I follow a 4-step analysis process:</strong></p>
                            <p><strong>1. User Context:</strong> Who ran it? IT admin running scripts is different from finance user. I check AD for their role - standard users rarely need PowerShell.</p>
                            <p><strong>2. Parent Process:</strong> What spawned PowerShell? If Word or Outlook is the parent, that's a macro or email attachment executing - immediate red flag. Explorer is normal (user launched). Svchost or scheduled task needs verification.</p>
                            <p><strong>3. Command Analysis:</strong> I look for red flags: encoded commands (decode them!), download cradles (IEX, Invoke-WebRequest), evasion flags (-ExecutionPolicy Bypass, -WindowStyle Hidden), and credential access patterns (Mimikatz, sekurlsa). If encoded, I always decode it.</p>
                            <p><strong>4. Network Activity:</strong> Did PowerShell make external connections? Check destination reputation and domain age. If it downloaded something or connected to a new domain - high priority.</p>
                            <p>The combination of: standard user + Office parent + encoded command + external connection = almost certainly malicious. Isolate immediately.</p>
                        </div>
                    </div>
                </section>
            
                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>

                <!-- Comprehensive Troubleshooting -->
                <h2><i class="fas fa-tools"></i> Comprehensive Troubleshooting</h2>
                <div class="config-section">
                    <h4>Systematic Troubleshooting Methodology</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <ol style="color: #8b949e;">
                            <li><strong>Define the Problem:</strong> Clearly articulate what is not working as expected. Gather specific error messages, timestamps, and affected components.</li>
                            <li><strong>Gather Information:</strong> Collect relevant logs, metrics, and configuration details. Document recent changes that might be related.</li>
                            <li><strong>Analyze Data:</strong> Review collected information for patterns and anomalies. Compare against baseline behavior and known-good configurations.</li>
                            <li><strong>Develop Hypothesis:</strong> Form theories about potential root causes. Prioritize based on likelihood and impact.</li>
                            <li><strong>Test Solutions:</strong> Implement fixes in a controlled manner. Test one change at a time to isolate the effective solution.</li>
                            <li><strong>Document Resolution:</strong> Record the root cause and solution. Update runbooks and knowledge base for future reference.</li>
                        </ol>
                    </div>

                    <h4>Common Issues and Resolutions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Category</th><th>Issue</th><th>Diagnostic Steps</th><th>Resolution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td rowspan="2"><strong>Connectivity</strong></td>
                                <td>Agent not reporting</td>
                                <td>Check agent service status, network connectivity, firewall rules</td>
                                <td>Restart service, verify network path, update firewall rules</td>
                            </tr>
                            <tr>
                                <td>API timeouts</td>
                                <td>Test API endpoint, check rate limits, verify credentials</td>
                                <td>Retry with backoff, request limit increase, refresh credentials</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Data Quality</strong></td>
                                <td>Missing fields</td>
                                <td>Review parsing rules, check source format, validate schema</td>
                                <td>Update parser, fix source configuration, adjust schema mapping</td>
                            </tr>
                            <tr>
                                <td>Duplicate events</td>
                                <td>Audit data sources, check collection paths, review timestamps</td>
                                <td>Consolidate sources, implement deduplication, fix time sync</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Performance</strong></td>
                                <td>Slow queries</td>
                                <td>Analyze query execution plan, check resource utilization</td>
                                <td>Optimize query, add indexes, scale resources</td>
                            </tr>
                            <tr>
                                <td>High latency</td>
                                <td>Monitor queue depths, check processing bottlenecks</td>
                                <td>Scale processing capacity, optimize data flow</td>
                            </tr>
                            <tr>
                                <td rowspan="2"><strong>Authentication</strong></td>
                                <td>Login failures</td>
                                <td>Verify credentials, check account status, review permissions</td>
                                <td>Reset password, unlock account, grant required permissions</td>
                            </tr>
                            <tr>
                                <td>Token expiration</td>
                                <td>Check token validity, review refresh mechanism</td>
                                <td>Refresh token, update token management configuration</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Diagnostic Commands and Queries</h4>
                    <div class="code-block"># Health Check Queries (adjust syntax for your platform)

# Check system health status
| filter log_type = "system_health"
| sort _time desc
| limit 50

# Monitor error rates over time
| filter severity in ("error", "critical")
| timechart count by component span=1h

# Identify slow operations
| filter operation_time > 30000
| stats avg(operation_time), max(operation_time), count by operation_name
| sort avg(operation_time) desc

# Check connectivity status
| filter event_type = "connectivity"
| stats latest(status), latest(_time) by source_name
| where status != "connected"

# Review authentication failures
| filter event_type = "authentication" and result = "failure"
| stats count by user, source_ip, failure_reason
| sort count desc</div>
                </div>

                <!-- Real-World Use Cases -->
                <h2><i class="fas fa-building"></i> Real-World Implementation Scenarios</h2>
                <div class="config-section">
                    <h4>Scenario 1: Enterprise SOC Deployment</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #3fb950;">
                        <p><strong>Organization Profile:</strong> Fortune 500 company with 50,000 employees, hybrid cloud infrastructure</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>High volume of security events (500+ million events/day)</li>
                            <li>Multiple security tools with siloed data</li>
                            <li>Alert fatigue from excessive false positives</li>
                            <li>Compliance requirements (SOX, PCI-DSS, GDPR)</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Phased rollout starting with critical data sources</li>
                            <li>Custom detection rules based on threat model</li>
                            <li>Automated playbooks for common scenarios</li>
                            <li>Integration with ITSM and CMDB systems</li>
                        </ul>
                        <p style="color: #3fb950;"><strong>Results:</strong> 70% reduction in MTTR, 50% reduction in false positives, unified security visibility</p>
                    </div>

                    <h4>Scenario 2: MSSP Multi-Tenant Operations</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #58a6ff;">
                        <p><strong>Organization Profile:</strong> Managed security provider serving 100+ SMB customers</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Need for strict data isolation between customers</li>
                            <li>Scalable operations with limited staff</li>
                            <li>Standardized service delivery across customers</li>
                            <li>Flexible SLA-based prioritization</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Multi-tenant architecture with customer isolation</li>
                            <li>Shared detection content library with customization</li>
                            <li>Centralized analyst console with customer context</li>
                            <li>Automated reporting and SLA tracking</li>
                        </ul>
                        <p style="color: #58a6ff;"><strong>Results:</strong> 3x increase in customers per analyst, consistent service quality, improved customer satisfaction</p>
                    </div>

                    <h4>Scenario 3: Healthcare Compliance Focus</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0; border-left: 4px solid #d29922;">
                        <p><strong>Organization Profile:</strong> Regional hospital network with 15 facilities</p>
                        <p style="color: #8b949e;"><strong>Challenges:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>HIPAA compliance requirements for PHI protection</li>
                            <li>Legacy medical devices with limited security logging</li>
                            <li>Need for 6-year log retention</li>
                            <li>Limited IT security staff</li>
                        </ul>
                        <p style="color: #8b949e;"><strong>Implementation Approach:</strong></p>
                        <ul style="color: #8b949e;">
                            <li>Comprehensive EHR and clinical application monitoring</li>
                            <li>PHI access detection rules</li>
                            <li>Long-term archival storage configuration</li>
                            <li>Pre-built compliance dashboards and reports</li>
                        </ul>
                        <p style="color: #d29922;"><strong>Results:</strong> Audit-ready compliance posture, early detection of PHI access violations, reduced audit preparation time by 80%</p>
                    </div>
                </div>

                <!-- Interview Preparation -->
                <h2><i class="fas fa-user-tie"></i> Interview Preparation</h2>
                <div class="config-section">
                    <h4>Common Interview Questions</h4>
                    <div class="qa-section">
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you approach implementing a new security monitoring capability?</button>
                            <div class="qa-answer">
                                <p><strong>Structured approach:</strong></p>
                                <ol>
                                    <li><strong>Requirements Gathering:</strong> Understand use case, data sources, detection goals, and compliance needs</li>
                                    <li><strong>Design:</strong> Plan data collection, parsing, storage, and detection logic</li>
                                    <li><strong>Implementation:</strong> Configure data sources, build detection rules, set up dashboards</li>
                                    <li><strong>Testing:</strong> Validate with test data, tune for false positives, verify performance</li>
                                    <li><strong>Deployment:</strong> Roll out in phases, monitor for issues, gather feedback</li>
                                    <li><strong>Optimization:</strong> Continuously tune based on operational experience</li>
                                </ol>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle alert fatigue in a SOC environment?</button>
                            <div class="qa-answer">
                                <p><strong>Multi-pronged approach:</strong></p>
                                <ul>
                                    <li><strong>Tune Detection Rules:</strong> Adjust thresholds, add exclusions for known-good behavior</li>
                                    <li><strong>Implement Alert Aggregation:</strong> Group related alerts into incidents</li>
                                    <li><strong>Prioritization:</strong> Use risk scoring to surface high-priority alerts</li>
                                    <li><strong>Automation:</strong> Auto-close or auto-enrich low-severity alerts</li>
                                    <li><strong>Regular Review:</strong> Weekly review of noisy rules for tuning</li>
                                    <li><strong>Metrics Tracking:</strong> Monitor false positive rates by rule</li>
                                </ul>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Describe your experience with security data analysis and threat hunting.</button>
                            <div class="qa-answer">
                                <p><strong>Key competencies to highlight:</strong></p>
                                <ul>
                                    <li><strong>Query Languages:</strong> Proficiency in SPL, KQL, XQL, or similar</li>
                                    <li><strong>Hypothesis-Driven Hunting:</strong> Developing and testing threat hypotheses</li>
                                    <li><strong>IOC Analysis:</strong> Working with threat intelligence to hunt for indicators</li>
                                    <li><strong>Behavioral Analysis:</strong> Identifying anomalous patterns in user and system behavior</li>
                                    <li><strong>Tool Proficiency:</strong> Experience with SIEM, EDR, and analysis tools</li>
                                    <li><strong>Documentation:</strong> Recording findings and developing new detection rules</li>
                                </ul>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you stay current with security threats and platform updates?</button>
                            <div class="qa-answer">
                                <p><strong>Continuous learning approach:</strong></p>
                                <ul>
                                    <li><strong>Threat Intelligence:</strong> Follow threat reports, security blogs, and advisories</li>
                                    <li><strong>Vendor Resources:</strong> Review release notes, attend webinars, complete training</li>
                                    <li><strong>Community Engagement:</strong> Participate in forums, conferences, and user groups</li>
                                    <li><strong>Hands-On Practice:</strong> Lab environments for testing new features</li>
                                    <li><strong>Certifications:</strong> Pursue relevant certifications and continuing education</li>
                                    <li><strong>Knowledge Sharing:</strong> Present learnings to team, write documentation</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <h4>Technical Scenarios to Prepare</h4>
                    <ul style="color: #8b949e;">
                        <li>Walk through investigating a phishing incident from alert to resolution</li>
                        <li>Explain how you would detect lateral movement in your environment</li>
                        <li>Describe your approach to onboarding a new log source</li>
                        <li>Discuss how you would build a detection rule for a specific attack technique</li>
                        <li>Explain capacity planning for a growing environment</li>
                    </ul>
                </div>

                <!-- Quick Reference Card -->
                <h2><i class="fas fa-bookmark"></i> Quick Reference Card</h2>
                <div class="config-section">
                    <h4>Essential Queries</h4>
                    <div class="code-block"># Data volume by source (last 24h)
| filter _time > now() - 24h
| stats sum(bytes) as total_bytes by log_source
| sort total_bytes desc
| eval GB = round(total_bytes / 1073741824, 2)

# Top alerting rules
| filter event_type = "alert"
| stats count by rule_name
| sort count desc
| limit 10

# User activity summary
| filter event_type = "authentication"
| stats 
    count as total_events,
    countif(result="success") as successes,
    countif(result="failure") as failures
    by user
| eval failure_rate = round(failures * 100 / total_events, 1)

# System health overview
| filter log_type = "health_check"
| stats latest(status), latest(response_time) by component
| sort component</div>

                    <h4>Key Metrics to Monitor</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Metric</th><th>Target</th><th>Alert Threshold</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Ingestion Latency</td><td>&lt; 1 minute</td><td>&gt; 5 minutes</td></tr>
                            <tr><td>Query Response Time</td><td>&lt; 10 seconds</td><td>&gt; 60 seconds</td></tr>
                            <tr><td>Parse Success Rate</td><td>&gt; 99%</td><td>&lt; 95%</td></tr>
                            <tr><td>Alert Volume</td><td>Baseline</td><td>3x baseline</td></tr>
                            <tr><td>Storage Utilization</td><td>&lt; 70%</td><td>&gt; 85%</td></tr>
                            <tr><td>Agent Connectivity</td><td>100%</td><td>&lt; 98%</td></tr>
                        </tbody>
                    </table>

                    <h4>Important Paths and Locations</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Function</th><th>Location</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Data Source Configuration</td><td>Settings → Data Sources</td></tr>
                            <tr><td>Detection Rules</td><td>Detection → Rules / Analytics</td></tr>
                            <tr><td>Incident Management</td><td>Incidents / Cases</td></tr>
                            <tr><td>Query Interface</td><td>Investigation / Hunting / Search</td></tr>
                            <tr><td>Dashboards</td><td>Dashboards / Workbooks</td></tr>
                            <tr><td>User Management</td><td>Settings → Users / Access</td></tr>
                            <tr><td>System Health</td><td>Settings → Health / Status</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>

                <!-- Extended Best Practices -->
                <h2><i class="fas fa-check-double"></i> Extended Best Practices</h2>
                <div class="config-section">
                    <h4>Operational Excellence</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Documentation Standards:</strong> Maintain comprehensive runbooks for all procedures. Include step-by-step instructions, expected outcomes, and rollback procedures.</li>
                        <li><strong>Change Management:</strong> Test all changes in non-production environments first. Document changes and obtain approvals before production deployment.</li>
                        <li><strong>Monitoring Strategy:</strong> Implement proactive monitoring with clear thresholds. Set up alerting for critical metrics before they become problems.</li>
                        <li><strong>Regular Reviews:</strong> Conduct periodic audits of configurations, performance metrics, and security posture. Schedule quarterly reviews at minimum.</li>
                        <li><strong>Continuous Training:</strong> Keep team skills current with platform updates. Allocate time for learning new features and best practices.</li>
                        <li><strong>Knowledge Sharing:</strong> Document lessons learned and share across the team. Build institutional knowledge through wikis and team sessions.</li>
                    </ul>

                    <h4>Security Hardening</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions for each role. Review and revoke unnecessary access regularly.</li>
                        <li><strong>Comprehensive Audit Logging:</strong> Enable detailed audit trails for all administrative actions. Retain logs according to compliance requirements.</li>
                        <li><strong>Data Protection:</strong> Encrypt sensitive data in transit and at rest. Implement data classification and handling policies.</li>
                        <li><strong>Access Reviews:</strong> Conduct regular reviews of user access and permissions. Implement automated access certification workflows.</li>
                        <li><strong>Secrets Management:</strong> Use secure vaults for credential storage. Rotate secrets regularly and avoid hardcoding credentials.</li>
                        <li><strong>Network Security:</strong> Implement network segmentation and firewall rules. Monitor for unauthorized network access attempts.</li>
                    </ul>

                    <h4>Performance Optimization</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Query Optimization:</strong> Review and optimize frequently-used queries. Use indexed fields and appropriate time ranges.</li>
                        <li><strong>Capacity Planning:</strong> Monitor resource utilization trends. Plan for growth and scale proactively.</li>
                        <li><strong>Caching Strategies:</strong> Implement caching for frequently-accessed data. Configure cache TTLs appropriately.</li>
                        <li><strong>Index Management:</strong> Ensure proper indexing for search performance. Review and optimize index configurations.</li>
                        <li><strong>Data Lifecycle:</strong> Implement appropriate retention policies. Archive or delete data according to requirements.</li>
                        <li><strong>Load Distribution:</strong> Distribute workloads across available resources. Implement load balancing for high availability.</li>
                    </ul>
                </div>
</main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>