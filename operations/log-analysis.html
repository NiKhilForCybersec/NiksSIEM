<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log Analysis | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Operations</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-bar"></i> Metrics & KPIs</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Alert Management</div>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-filter"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-tags"></i> Classification</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-map"></i> MITRE Mapping</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="incident-response.html" class="nav-link"><i class="fas fa-fire-extinguisher"></i> IR Process</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-lock"></i> Containment</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-plug"></i> IR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Analysis Guides</div>
                    <a href="log-analysis.html" class="nav-link active"><i class="fas fa-file-alt"></i> Log Analysis</a>
                    <a href="malware-analysis.html" class="nav-link"><i class="fas fa-bug"></i> Malware Analysis</a>
                    <a href="phishing-analysis.html" class="nav-link"><i class="fas fa-fish"></i> Phishing Analysis</a>
                    <a href="forensics.html" class="nav-link"><i class="fas fa-microscope"></i> Forensics</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Domains</div>
                    <a href="identity-security.html" class="nav-link"><i class="fas fa-user-shield"></i> Identity Security</a>
                    <a href="network-security.html" class="nav-link"><i class="fas fa-network-wired"></i> Network Security</a>
                    <a href="cloud-security.html" class="nav-link"><i class="fas fa-cloud"></i> Cloud Security</a>
                    <a href="threat-intelligence.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Governance</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> SIEM Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Priority</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Compliance</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Operations</a><span class="separator">/</span>
                    <span class="current">Log Analysis</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-file-alt"></i> Log Analysis</h1>
                <p class="lead">Master security log analysis techniques for effective threat detection and incident investigation. Learn to read and interpret logs from Windows, Linux, network devices, and applications.</p>

                <!-- Log Analysis Fundamentals -->
                <h2><i class="fas fa-book"></i> Log Analysis Fundamentals</h2>
                <div class="config-section">
                    <h4>Key Log Analysis Skills</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Pattern recognition:</strong> Identify normal vs abnormal</li>
                        <li><strong>Timestamp analysis:</strong> Build event timelines</li>
                        <li><strong>Correlation:</strong> Connect related events across sources</li>
                        <li><strong>Baseline understanding:</strong> Know what's normal for your environment</li>
                        <li><strong>Context awareness:</strong> Consider business and technical context</li>
                    </ul>

                    <h4>Analysis Workflow</h4>
                    <div class="code-block">Log Analysis Steps:

1. IDENTIFY THE QUESTION
   - What are you looking for?
   - What triggered the investigation?

2. SELECT DATA SOURCES
   - Which logs are relevant?
   - What time range to search?

3. FILTER AND SEARCH
   - Narrow to relevant events
   - Use appropriate query language

4. ANALYZE RESULTS
   - Look for patterns and anomalies
   - Build timeline of events

5. CORRELATE
   - Connect events across sources
   - Build complete picture

6. DOCUMENT
   - Record findings
   - Note key evidence</div>
                </div>

                <!-- Windows Event Logs -->
                <h2><i class="fab fa-windows"></i> Windows Event Logs</h2>
                <div class="config-section">
                    <h4>Critical Windows Event IDs</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th><th>Security Relevance</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>4624</strong></td><td>Successful logon</td><td>Access tracking</td></tr>
                            <tr><td><strong>4625</strong></td><td>Failed logon</td><td>Brute force detection</td></tr>
                            <tr><td><strong>4648</strong></td><td>Explicit credential logon</td><td>Pass-the-hash, runas</td></tr>
                            <tr><td><strong>4672</strong></td><td>Special privileges assigned</td><td>Admin logon</td></tr>
                            <tr><td><strong>4688</strong></td><td>Process creation</td><td>Execution tracking</td></tr>
                            <tr><td><strong>4697</strong></td><td>Service installed</td><td>Persistence</td></tr>
                            <tr><td><strong>4698</strong></td><td>Scheduled task created</td><td>Persistence</td></tr>
                            <tr><td><strong>4720</strong></td><td>User account created</td><td>Account manipulation</td></tr>
                            <tr><td><strong>4732</strong></td><td>Member added to group</td><td>Privilege escalation</td></tr>
                            <tr><td><strong>4768</strong></td><td>Kerberos TGT request</td><td>Authentication</td></tr>
                            <tr><td><strong>4769</strong></td><td>Kerberos service ticket</td><td>Kerberoasting</td></tr>
                            <tr><td><strong>4776</strong></td><td>NTLM authentication</td><td>Credential validation</td></tr>
                            <tr><td><strong>1102</strong></td><td>Audit log cleared</td><td>Defense evasion</td></tr>
                        </tbody>
                    </table>

                    <h4>Logon Type Reference</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Description</th><th>Notes</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>2</td><td>Interactive (console)</td><td>Physical login</td></tr>
                            <tr><td>3</td><td>Network</td><td>SMB, network share</td></tr>
                            <tr><td>4</td><td>Batch</td><td>Scheduled tasks</td></tr>
                            <tr><td>5</td><td>Service</td><td>Service startup</td></tr>
                            <tr><td>7</td><td>Unlock</td><td>Workstation unlock</td></tr>
                            <tr><td>8</td><td>NetworkCleartext</td><td>IIS basic auth</td></tr>
                            <tr><td>9</td><td>NewCredentials</td><td>RunAs /netonly</td></tr>
                            <tr><td>10</td><td>RemoteInteractive</td><td>RDP</td></tr>
                            <tr><td>11</td><td>CachedInteractive</td><td>Cached credentials</td></tr>
                        </tbody>
                    </table>

                    <h4>Example Windows Log Analysis</h4>
                    <div class="log-example">Event ID: 4625 (Failed Logon)
Time: 2024-01-15 14:32:15
Account: administrator
Source IP: 192.168.1.100
Logon Type: 3 (Network)
Failure Reason: Unknown user name or bad password
Status: 0xC000006D</div>
                    <div class="code-block">Analysis:
- Multiple 4625 events from same source IP
- Targeting administrator account
- Logon Type 3 = Network (SMB/remote)
- Status 0xC000006D = Bad password
→ Indicates brute force attempt against admin account</div>
                </div>

                <!-- Sysmon Logs -->
                <h2><i class="fas fa-eye"></i> Sysmon Event Analysis</h2>
                <div class="config-section">
                    <h4>Critical Sysmon Event IDs</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event ID</th><th>Description</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>1</strong></td><td>Process Creation</td><td>Command execution tracking</td></tr>
                            <tr><td><strong>3</strong></td><td>Network Connection</td><td>C2, lateral movement</td></tr>
                            <tr><td><strong>7</strong></td><td>Image Loaded</td><td>DLL injection</td></tr>
                            <tr><td><strong>8</strong></td><td>CreateRemoteThread</td><td>Process injection</td></tr>
                            <tr><td><strong>10</strong></td><td>Process Access</td><td>Credential dumping</td></tr>
                            <tr><td><strong>11</strong></td><td>File Create</td><td>Malware drops</td></tr>
                            <tr><td><strong>12/13/14</strong></td><td>Registry Events</td><td>Persistence</td></tr>
                            <tr><td><strong>22</strong></td><td>DNS Query</td><td>C2, DNS tunneling</td></tr>
                            <tr><td><strong>23</strong></td><td>File Delete</td><td>Anti-forensics</td></tr>
                        </tbody>
                    </table>

                    <h4>Sysmon Process Creation Analysis</h4>
                    <div class="log-example">Event ID: 1 (Process Create)
Time: 2024-01-15 14:35:22
Image: C:\Windows\System32\cmd.exe
CommandLine: cmd.exe /c whoami & hostname & ipconfig
ParentImage: C:\Program Files\Microsoft Office\WINWORD.EXE
ParentCommandLine: "WINWORD.EXE" /n "C:\Users\victim\invoice.docm"
User: CORP\john.doe
IntegrityLevel: Medium</div>
                    <div class="code-block">Analysis:
- cmd.exe spawned from WINWORD.EXE (suspicious)
- Parent opened .docm file (macro-enabled)
- Commands: reconnaissance (whoami, hostname, ipconfig)
→ Likely malicious macro execution, initial access</div>
                </div>

                <!-- Linux Logs -->
                <h2><i class="fab fa-linux"></i> Linux Log Analysis</h2>
                <div class="config-section">
                    <h4>Key Linux Log Files</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Log File</th><th>Content</th><th>Security Use</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>/var/log/auth.log</td><td>Authentication events</td><td>Login monitoring</td></tr>
                            <tr><td>/var/log/secure</td><td>Auth (RHEL/CentOS)</td><td>Login monitoring</td></tr>
                            <tr><td>/var/log/syslog</td><td>System messages</td><td>General security</td></tr>
                            <tr><td>/var/log/messages</td><td>System (RHEL)</td><td>General security</td></tr>
                            <tr><td>/var/log/audit/audit.log</td><td>Auditd events</td><td>Detailed audit</td></tr>
                            <tr><td>/var/log/apache2/access.log</td><td>Web access</td><td>Web attacks</td></tr>
                            <tr><td>/var/log/cron</td><td>Cron jobs</td><td>Persistence</td></tr>
                        </tbody>
                    </table>

                    <h4>SSH Authentication Analysis</h4>
                    <div class="log-example">Jan 15 14:40:22 server01 sshd[12345]: Failed password for root from 203.0.113.50 port 54321 ssh2
Jan 15 14:40:24 server01 sshd[12346]: Failed password for root from 203.0.113.50 port 54322 ssh2
Jan 15 14:40:26 server01 sshd[12347]: Failed password for admin from 203.0.113.50 port 54323 ssh2
Jan 15 14:40:28 server01 sshd[12348]: Accepted password for admin from 203.0.113.50 port 54324 ssh2</div>
                    <div class="code-block">Analysis:
- Rapid failed attempts for root and admin
- Same source IP: 203.0.113.50
- Success after failures → Password guessed
→ Brute force attack with successful compromise</div>

                    <h4>Useful Linux Log Commands</h4>
                    <div class="code-block"># Failed SSH logins
grep "Failed password" /var/log/auth.log | tail -20

# Successful logins
grep "Accepted" /var/log/auth.log

# sudo usage
grep "sudo:" /var/log/auth.log

# New user accounts
grep "useradd" /var/log/auth.log

# Cron activity
grep CRON /var/log/syslog

# Real-time monitoring
tail -f /var/log/auth.log | grep -i "failed\|accepted"</div>
                </div>

                <!-- Firewall Logs -->
                <h2><i class="fas fa-fire"></i> Firewall Log Analysis</h2>
                <div class="config-section">
                    <h4>Common Firewall Log Fields</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Field</th><th>Description</th><th>Analysis Use</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>src_ip</td><td>Source IP address</td><td>Attacker identification</td></tr>
                            <tr><td>dst_ip</td><td>Destination IP</td><td>Target identification</td></tr>
                            <tr><td>src_port</td><td>Source port</td><td>Client port</td></tr>
                            <tr><td>dst_port</td><td>Destination port</td><td>Service/protocol</td></tr>
                            <tr><td>action</td><td>Allow/Deny</td><td>Access decision</td></tr>
                            <tr><td>bytes_sent/recv</td><td>Data volume</td><td>Exfiltration detection</td></tr>
                            <tr><td>app</td><td>Application</td><td>App-ID analysis</td></tr>
                            <tr><td>threat</td><td>Threat detected</td><td>IPS/malware alerts</td></tr>
                        </tbody>
                    </table>

                    <h4>Suspicious Patterns to Look For</h4>
                    <div class="code-block">Port Scanning:
- Same source, many destination ports
- Many connections in short time
- Sequential port numbers

C2 Communication:
- Periodic connections (beaconing)
- Unusual destination ports
- High DNS query volume
- Non-standard protocols on standard ports

Data Exfiltration:
- Large outbound transfers
- Unusual destinations
- After-hours activity
- Encrypted traffic to unknown hosts

Lateral Movement:
- Internal-to-internal on admin ports
- SMB (445), RDP (3389), WinRM (5985)
- Service account to multiple hosts</div>
                </div>

                <!-- Web Server Logs -->
                <h2><i class="fas fa-globe"></i> Web Server Log Analysis</h2>
                <div class="config-section">
                    <h4>Apache/Nginx Access Log Format</h4>
                    <div class="log-example">203.0.113.50 - - [15/Jan/2024:14:45:30 +0000] "GET /admin/config.php HTTP/1.1" 404 287 "-" "Mozilla/5.0"
203.0.113.50 - - [15/Jan/2024:14:45:31 +0000] "GET /wp-admin/ HTTP/1.1" 404 287 "-" "Mozilla/5.0"
203.0.113.50 - - [15/Jan/2024:14:45:32 +0000] "GET /phpmyadmin/ HTTP/1.1" 404 287 "-" "Mozilla/5.0"
203.0.113.50 - - [15/Jan/2024:14:45:33 +0000] "GET /../../../etc/passwd HTTP/1.1" 400 287 "-" "Mozilla/5.0"</div>
                    <div class="code-block">Analysis:
- Sequential admin path probing
- Directory traversal attempt (../../../)
- Same source IP, rapid requests
→ Web application scanner or manual reconnaissance</div>

                    <h4>Web Attack Indicators</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Attack</th><th>Log Pattern</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>SQL Injection</td><td>' OR '1'='1, UNION SELECT, --</td></tr>
                            <tr><td>XSS</td><td>&lt;script&gt;, javascript:, onerror=</td></tr>
                            <tr><td>Path Traversal</td><td>../, ..\, /etc/passwd</td></tr>
                            <tr><td>Command Injection</td><td>; whoami, | cat, `id`</td></tr>
                            <tr><td>Scanner Activity</td><td>Many 404s, common paths</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- DNS Logs -->
                <h2><i class="fas fa-network-wired"></i> DNS Log Analysis</h2>
                <div class="config-section">
                    <h4>Suspicious DNS Patterns</h4>
                    <div class="code-block">DNS Tunneling Indicators:
- Very long subdomain queries (>50 chars)
- High volume of unique subdomains
- TXT record queries
- Unusual query patterns

DGA (Domain Generation Algorithm):
- Random-looking domain names
- Many NXDOMAIN responses
- High volume from single host

C2 Communication:
- Regular query intervals
- Consistent destination domains
- Low TTL values
- Queries to recently registered domains</div>

                    <h4>DNS Log Example</h4>
                    <div class="log-example">2024-01-15 14:50:00 client 10.0.1.50: query: aGVsbG8gd29ybGQ.evil-domain.com IN A
2024-01-15 14:50:30 client 10.0.1.50: query: dGhpcyBpcyBkYXRh.evil-domain.com IN A
2024-01-15 14:51:00 client 10.0.1.50: query: ZXhmaWx0cmF0aW9u.evil-domain.com IN A</div>
                    <div class="code-block">Analysis:
- Long, encoded-looking subdomains
- Regular 30-second intervals
- Same client, same base domain
→ Likely DNS tunneling for data exfiltration or C2</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you identify a brute force attack in logs?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>High volume of failed logins:</strong> Many 4625 (Windows) or "Failed password" (Linux)</li>
                                <li><strong>Same source IP:</strong> Single attacker targeting multiple accounts</li>
                                <li><strong>Same target account:</strong> One account being guessed</li>
                                <li><strong>Time pattern:</strong> Rapid, automated attempts</li>
                                <li><strong>Success after failures:</strong> 4624 following 4625s indicates compromise</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What Windows events indicate lateral movement?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>4624 Type 3:</strong> Network logons from unusual sources</li>
                                <li><strong>4648:</strong> Explicit credential use (pass-the-hash)</li>
                                <li><strong>4688:</strong> PsExec, wmic, PowerShell remoting</li>
                                <li><strong>4697:</strong> Remote service installation</li>
                                <li><strong>5140/5145:</strong> Network share access</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you detect credential dumping?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Sysmon 10:</strong> Process accessing LSASS</li>
                                <li><strong>4688:</strong> Known tools (mimikatz, procdump)</li>
                                <li><strong>4688:</strong> reg.exe saving SAM/SECURITY</li>
                                <li><strong>4769:</strong> RC4 Kerberos tickets (Kerberoasting)</li>
                                <li><strong>Sysmon 7:</strong> Suspicious DLLs loaded into LSASS</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>