<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOC Metrics & KPIs | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Structure</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-tags"></i> Incident Classification</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-shield-alt"></i> Containment</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-link"></i> IR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cogs"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-map"></i> MITRE Mapping</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Metrics & Compliance</div>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-line"></i> Metrics & KPIs</a>
                    <a href="soc-metrics.html" class="nav-link active"><i class="fas fa-tachometer-alt"></i> SOC Metrics</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-check-double"></i> Compliance Mapping</a>
                    <a href="audit-preparation.html" class="nav-link"><i class="fas fa-clipboard-list"></i> Audit Preparation</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Design</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> SIEM Project Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Source Priority</a>
                    <a href="sizing-calculator.html" class="nav-link"><i class="fas fa-calculator"></i> Sizing Calculator</a>
                    <a href="rbac-design.html" class="nav-link"><i class="fas fa-user-lock"></i> RBAC Design</a>
                    <a href="migration-guide.html" class="nav-link"><i class="fas fa-truck-moving"></i> Migration Guide</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Operations</a><span class="separator">/</span>
                    <span class="current">SOC Metrics</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-chart-line"></i> SOC Metrics & KPIs</h1>
                <p class="lead">Understanding and measuring SOC performance is critical for continuous improvement. This guide explains the key metrics, what they actually mean, and how to use them effectively.</p>

                <!-- Why Metrics Matter -->
                <h2><i class="fas fa-question-circle"></i> Why SOC Metrics Matter</h2>
                
                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-exclamation-triangle"></i> The Problem with Bad Metrics</h4>
                    <p>Many SOCs track metrics that don't actually measure security effectiveness. Counting "alerts handled" encourages closing alerts quickly without proper investigation. Measuring "incidents detected" without context is meaningless.</p>
                    <p><strong>Good metrics</strong> should answer: "Are we detecting threats? Are we responding fast enough? Are we improving over time?"</p>
                </div>

                <!-- Core Metrics -->
                <h2><i class="fas fa-tachometer-alt"></i> Core SOC Metrics Explained</h2>

                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>What It Measures</th>
                                <th>Good Target</th>
                                <th>Warning Signs</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>MTTD (Mean Time to Detect)</strong></td>
                                <td>Time from threat entry to detection</td>
                                <td>&lt; 24 hours</td>
                                <td>&gt; 7 days means threats are living in your environment</td>
                            </tr>
                            <tr>
                                <td><strong>MTTR (Mean Time to Respond)</strong></td>
                                <td>Time from detection to containment</td>
                                <td>&lt; 4 hours for critical</td>
                                <td>&gt; 24 hours means attacker has time to expand</td>
                            </tr>
                            <tr>
                                <td><strong>MTTA (Mean Time to Acknowledge)</strong></td>
                                <td>Time from alert to analyst assignment</td>
                                <td>&lt; 15 minutes</td>
                                <td>&gt; 1 hour means alerts are sitting unattended</td>
                            </tr>
                            <tr>
                                <td><strong>Alert Volume</strong></td>
                                <td>Number of alerts generated per day</td>
                                <td>Manageable by team size</td>
                                <td>&gt; 50 alerts/analyst/day = alert fatigue risk</td>
                            </tr>
                            <tr>
                                <td><strong>True Positive Rate</strong></td>
                                <td>% of alerts that are real threats</td>
                                <td>&gt; 30%</td>
                                <td>&lt; 10% means rules need tuning</td>
                            </tr>
                            <tr>
                                <td><strong>False Positive Rate</strong></td>
                                <td>% of alerts that are benign</td>
                                <td>&lt; 70%</td>
                                <td>&gt; 90% causes alert fatigue</td>
                            </tr>
                            <tr>
                                <td><strong>Dwell Time</strong></td>
                                <td>How long attacker was in environment before detection</td>
                                <td>&lt; 7 days</td>
                                <td>&gt; 30 days means detection gaps</td>
                            </tr>
                            <tr>
                                <td><strong>Coverage</strong></td>
                                <td>% of MITRE ATT&CK techniques with detection rules</td>
                                <td>&gt; 60% for priority techniques</td>
                                <td>&lt; 30% means major blind spots</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- The MTT Family Explained -->
                <h2><i class="fas fa-clock"></i> Understanding the "Mean Time to..." Metrics</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title">Attack Timeline with MTT Metrics</div>
                    <div style="position: relative; margin-top: 20px; padding: 20px 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="text-align: center; flex: 1;">
                                <div style="background: #4d1a1a; padding: 12px; border-radius: 8px;">
                                    <div style="color: #f85149; font-weight: 600;">Threat Entry</div>
                                    <div style="color: #8b949e; font-size: 0.8rem;">Phishing email opened</div>
                                </div>
                            </div>
                            <div style="flex: 1; text-align: center;">
                                <div style="color: #d29922; font-size: 0.8rem;">← MTTD →</div>
                            </div>
                            <div style="text-align: center; flex: 1;">
                                <div style="background: #4d3a0d; padding: 12px; border-radius: 8px;">
                                    <div style="color: #d29922; font-weight: 600;">Alert Generated</div>
                                    <div style="color: #8b949e; font-size: 0.8rem;">SIEM detects anomaly</div>
                                </div>
                            </div>
                            <div style="flex: 0.5; text-align: center;">
                                <div style="color: #58a6ff; font-size: 0.8rem;">← MTTA →</div>
                            </div>
                            <div style="text-align: center; flex: 1;">
                                <div style="background: #1c3a5e; padding: 12px; border-radius: 8px;">
                                    <div style="color: #58a6ff; font-weight: 600;">Acknowledged</div>
                                    <div style="color: #8b949e; font-size: 0.8rem;">Analyst picks up</div>
                                </div>
                            </div>
                            <div style="flex: 1; text-align: center;">
                                <div style="color: #3fb950; font-size: 0.8rem;">← MTTR →</div>
                            </div>
                            <div style="text-align: center; flex: 1;">
                                <div style="background: #1a4d2e; padding: 12px; border-radius: 8px;">
                                    <div style="color: #3fb950; font-weight: 600;">Contained</div>
                                    <div style="color: #8b949e; font-size: 0.8rem;">Threat neutralized</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <h4><i class="fas fa-calculator"></i> How to Calculate These Metrics</h4>
                    <ul>
                        <li><strong>MTTD:</strong> (Timestamp of first detection alert) - (Timestamp of initial compromise)</li>
                        <li><strong>MTTA:</strong> (Timestamp analyst acknowledged) - (Timestamp alert created)</li>
                        <li><strong>MTTR:</strong> (Timestamp containment action completed) - (Timestamp of detection)</li>
                    </ul>
                    <p style="color: #d29922;"><strong>Challenge:</strong> MTTD is hardest to measure because you often don't know the exact compromise time until after investigation.</p>
                </div>

                <!-- Alert Quality Metrics -->
                <h2><i class="fas fa-bell"></i> Alert Quality Metrics</h2>

                <div class="comparison-grid">
                    <div class="comparison-item" style="border-top: 4px solid #3fb950;">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1a4d2e; color: #3fb950;"><i class="fas fa-check-circle"></i></div>
                            <div class="comparison-item-title">True Positive (TP)</div>
                        </div>
                        <p style="color: #8b949e; padding: 0 16px;">Alert fired AND it was a real threat</p>
                        <p style="padding: 0 16px; font-size: 0.85rem;"><strong>Example:</strong> Alert for "Mimikatz detected" → Investigation confirms credential theft</p>
                    </div>
                    <div class="comparison-item" style="border-top: 4px solid #f85149;">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #4d1a1a; color: #f85149;"><i class="fas fa-times-circle"></i></div>
                            <div class="comparison-item-title">False Positive (FP)</div>
                        </div>
                        <p style="color: #8b949e; padding: 0 16px;">Alert fired BUT it was benign activity</p>
                        <p style="padding: 0 16px; font-size: 0.85rem;"><strong>Example:</strong> Alert for "suspicious PowerShell" → IT admin running legitimate script</p>
                    </div>
                    <div class="comparison-item" style="border-top: 4px solid #d29922;">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #4d3a0d; color: #d29922;"><i class="fas fa-ghost"></i></div>
                            <div class="comparison-item-title">False Negative (FN)</div>
                        </div>
                        <p style="color: #8b949e; padding: 0 16px;">Real threat occurred BUT no alert fired</p>
                        <p style="padding: 0 16px; font-size: 0.85rem;"><strong>Example:</strong> Attacker exfiltrated data → Discovered in breach report, no SIEM alert existed</p>
                    </div>
                </div>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-calculator"></i> Calculating Alert Quality</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px;">
<span style="color: #8b949e;">// True Positive Rate (Precision)</span>
TP Rate = True Positives / (True Positives + False Positives)
<span style="color: #3fb950;">Example: 30 real threats / (30 real + 70 false) = 30% TP rate</span>

<span style="color: #8b949e;">// False Positive Rate</span>
FP Rate = False Positives / Total Alerts
<span style="color: #f85149;">Example: 70 false / 100 total = 70% FP rate</span>

<span style="color: #8b949e;">// Detection Rate (Recall)</span>
Detection Rate = Threats Detected / Total Threats
<span style="color: #d29922;">Harder to measure - requires knowing about missed threats</span>
</pre>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: What SOC metrics do you track and why?</button>
                        <div class="qa-answer">
                            <p><strong>I focus on metrics that answer three questions:</strong></p>
                            <p><strong>1. Are we detecting threats?</strong></p>
                            <ul>
                                <li>MTTD (Mean Time to Detect) - How long until we see a threat</li>
                                <li>Detection coverage - % of MITRE techniques we can detect</li>
                                <li>True positive rate - Are our alerts catching real threats</li>
                            </ul>
                            <p><strong>2. Are we responding effectively?</strong></p>
                            <ul>
                                <li>MTTA - How fast analysts pick up alerts</li>
                                <li>MTTR - How fast we contain confirmed threats</li>
                                <li>Escalation accuracy - Are we escalating the right things</li>
                            </ul>
                            <p><strong>3. Are we improving?</strong></p>
                            <ul>
                                <li>False positive rate trending down over time</li>
                                <li>Alert volume per analyst (workload sustainability)</li>
                                <li>New detection rules created per month</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How do you handle a high false positive rate?</button>
                        <div class="qa-answer">
                            <p><strong>Step-by-step approach:</strong></p>
                            <ol>
                                <li><strong>Identify the worst offenders:</strong> Sort alerts by volume, find which rules generate the most false positives</li>
                                <li><strong>Analyze the pattern:</strong> Why is this rule firing on benign activity? Is it too broad? Missing context?</li>
                                <li><strong>Tune the rule:</strong>
                                    <ul>
                                        <li>Add exclusions for known-good activity (e.g., specific service accounts)</li>
                                        <li>Add more conditions to narrow the scope</li>
                                        <li>Require correlation with other events</li>
                                    </ul>
                                </li>
                                <li><strong>Test before deploying:</strong> Run tuned rule in detection-only mode first</li>
                                <li><strong>Monitor after changes:</strong> Did FP rate drop without missing real threats?</li>
                            </ol>
                            <p><strong>Example:</strong> "PowerShell encoded command" rule had 90% FP rate. Added exclusions for SCCM, Intune, and IT admin accounts. Added condition requiring network connection after execution. FP rate dropped to 40%.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: What's a healthy MTTR and how do you improve it?</button>
                        <div class="qa-answer">
                            <p><strong>Healthy targets (vary by severity):</strong></p>
                            <ul>
                                <li><strong>Critical:</strong> &lt; 1 hour to contain</li>
                                <li><strong>High:</strong> &lt; 4 hours to contain</li>
                                <li><strong>Medium:</strong> &lt; 24 hours to contain</li>
                                <li><strong>Low:</strong> &lt; 72 hours to contain</li>
                            </ul>
                            <p><strong>How to improve MTTR:</strong></p>
                            <ol>
                                <li><strong>Playbooks:</strong> Pre-defined response steps so analysts don't have to figure it out each time</li>
                                <li><strong>Automation:</strong> Auto-contain obvious threats (e.g., auto-isolate endpoint with ransomware behavior)</li>
                                <li><strong>Context enrichment:</strong> Alerts should include IP reputation, user risk score, asset criticality - reduces investigation time</li>
                                <li><strong>Tool access:</strong> Analysts can't respond fast if they need to request EDR access. Pre-provision permissions.</li>
                                <li><strong>Communication templates:</strong> Pre-drafted escalation messages, stakeholder notifications</li>
                            </ol>
                        </div>
                    </div>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
