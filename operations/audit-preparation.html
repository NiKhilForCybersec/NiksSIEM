<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit Preparation - Compliance Audit Readiness | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .audit-type-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin: 2rem 0; }
        .audit-card { background: var(--card-bg); border-radius: 12px; padding: 1.5rem; border-left: 4px solid #9b59b6; }
        .audit-card.soc2 { border-left-color: #3498db; }
        .audit-card.pci { border-left-color: #e74c3c; }
        .audit-card.hipaa { border-left-color: #2ecc71; }
        .audit-card.iso { border-left-color: #f5a623; }
        .audit-card h3 { margin-top: 0; display: flex; align-items: center; gap: 0.5rem; }
        .checklist-section { background: var(--card-bg); border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0; }
        .checklist-section h3 { margin-top: 0; color: #9b59b6; }
        .checklist { list-style: none; padding: 0; margin: 1rem 0; }
        .checklist li { padding: 0.75rem 0; border-bottom: 1px solid var(--border-color); display: flex; align-items: flex-start; gap: 0.75rem; }
        .checklist li:last-child { border-bottom: none; }
        .checklist .check-box { color: #9b59b6; flex-shrink: 0; }
        .timeline-container { background: var(--card-bg); border-radius: 12px; padding: 1.5rem; margin: 2rem 0; }
        .timeline { position: relative; padding-left: 2rem; }
        .timeline::before { content: ''; position: absolute; left: 0.5rem; top: 0; bottom: 0; width: 2px; background: linear-gradient(to bottom, #9b59b6, #3498db); }
        .timeline-item { position: relative; padding: 1rem 0; }
        .timeline-item::before { content: ''; position: absolute; left: -1.65rem; top: 1.25rem; width: 12px; height: 12px; border-radius: 50%; background: #9b59b6; border: 2px solid var(--card-bg); }
        .timeline-item h4 { margin: 0 0 0.5rem 0; color: #9b59b6; }
        .evidence-table { width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 0.9rem; }
        .evidence-table th, .evidence-table td { padding: 0.75rem; text-align: left; border-bottom: 1px solid var(--border-color); }
        .evidence-table th { background: rgba(155, 89, 182, 0.1); color: #9b59b6; }
        .finding-card { background: var(--card-bg); border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #e74c3c; }
        .finding-card.medium { border-left-color: #f5a623; }
        .finding-card.low { border-left-color: #3498db; }
        .finding-card h4 { margin: 0 0 0.5rem 0; display: flex; align-items: center; gap: 0.5rem; }
        .severity-badge { font-size: 0.75rem; padding: 0.25rem 0.5rem; border-radius: 4px; }
        .severity-badge.high { background: rgba(231, 76, 60, 0.2); color: #e74c3c; }
        .severity-badge.medium { background: rgba(245, 166, 35, 0.2); color: #f5a623; }
        .severity-badge.low { background: rgba(52, 152, 219, 0.2); color: #3498db; }
        .query-block { background: #1a1a2e; border-radius: 8px; padding: 1rem; margin: 1rem 0; font-family: 'Consolas', monospace; font-size: 0.85rem; overflow-x: auto; }
        .query-block .platform-label { color: #9b59b6; font-weight: bold; margin-bottom: 0.5rem; }
        .interview-qa { background: var(--card-bg); border-radius: 12px; padding: 1.5rem; margin: 2rem 0; border-left: 4px solid #9b59b6; }
        .interview-qa h3 { margin-top: 0; color: #9b59b6; }
        .qa-item { margin: 1.5rem 0; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color); }
        .qa-item:last-child { border-bottom: none; padding-bottom: 0; margin-bottom: 0; }
        .qa-item .question { font-weight: bold; color: #3498db; margin-bottom: 0.75rem; }
        .qa-item .answer { color: var(--text-secondary); line-height: 1.6; }
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="../splunk/index.html" class="platform-tab splunk"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Operations Home</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users-cog"></i> Operating Procedures</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Triage Handbook</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="soc-metrics.html" class="nav-link"><i class="fas fa-chart-line"></i> SOC Metrics</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-map"></i> MITRE ATT&CK</a>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Compliance</div>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-balance-scale"></i> Compliance Mapping</a>
                    <a href="audit-preparation.html" class="nav-link active"><i class="fas fa-clipboard-list"></i> Audit Preparation</a>
                    <a href="rbac-design.html" class="nav-link"><i class="fas fa-user-shield"></i> RBAC Design</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Project Planning</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> Project Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Source Priority</a>
                    <a href="sizing-calculator.html" class="nav-link"><i class="fas fa-calculator"></i> Sizing Calculator</a>
                    <a href="migration-guide.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Migration Guide</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-ambulance"></i> IR Integration</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book"></i> Playbook Library</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-ban"></i> Containment</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Operations</a>
                    <span class="separator">/</span>
                    <span class="current">Audit Preparation</span>
                </div>
            </header>
            
            <main class="main-content">
                <div class="page-header">
                    <h1><i class="fas fa-clipboard-list"></i> Audit Preparation Guide</h1>
                    <p class="lead">Comprehensive preparation strategies for SOC 2, PCI-DSS, HIPAA, and ISO 27001 compliance audits</p>
                </div>

                <!-- Audit Types Overview -->
                <section class="content-section">
                    <h2><i class="fas fa-shield-alt"></i> Compliance Audit Types</h2>
                    <p>Understanding the scope and focus of each audit type is critical for effective preparation.</p>
                    
                    <div class="audit-type-cards">
                        <div class="audit-card soc2">
                            <h3><i class="fas fa-certificate"></i> SOC 2 Type II</h3>
                            <p><strong>Focus:</strong> Trust Service Criteria - Security, Availability, Processing Integrity, Confidentiality, Privacy</p>
                            <p><strong>Audit Period:</strong> 6-12 months of operational evidence</p>
                            <p><strong>SIEM Relevance:</strong> Security monitoring, access controls, incident response, change management</p>
                            <p><strong>Key Controls:</strong></p>
                            <ul>
                                <li>CC6.1 - Logical access controls</li>
                                <li>CC6.6 - Security event monitoring</li>
                                <li>CC7.2 - System monitoring</li>
                                <li>CC7.3 - Security incident response</li>
                            </ul>
                        </div>
                        
                        <div class="audit-card pci">
                            <h3><i class="fas fa-credit-card"></i> PCI-DSS 4.0</h3>
                            <p><strong>Focus:</strong> Cardholder Data Environment (CDE) protection</p>
                            <p><strong>Audit Period:</strong> Point-in-time + quarterly scans</p>
                            <p><strong>SIEM Relevance:</strong> Log retention, access monitoring, file integrity, network segmentation validation</p>
                            <p><strong>Key Requirements:</strong></p>
                            <ul>
                                <li>Req 10 - Log and monitor all access</li>
                                <li>Req 10.4.1 - Daily log review</li>
                                <li>Req 10.7 - 12-month retention</li>
                                <li>Req 11.5 - File integrity monitoring</li>
                            </ul>
                        </div>
                        
                        <div class="audit-card hipaa">
                            <h3><i class="fas fa-hospital"></i> HIPAA</h3>
                            <p><strong>Focus:</strong> Protected Health Information (PHI) safeguards</p>
                            <p><strong>Audit Period:</strong> OCR audits or Business Associate assessments</p>
                            <p><strong>SIEM Relevance:</strong> PHI access tracking, audit controls, breach detection, workforce monitoring</p>
                            <p><strong>Key Safeguards:</strong></p>
                            <ul>
                                <li>§164.312(b) - Audit controls</li>
                                <li>§164.308(a)(1) - Security management</li>
                                <li>§164.308(a)(5) - Security awareness</li>
                                <li>§164.312(d) - Person/entity authentication</li>
                            </ul>
                        </div>
                        
                        <div class="audit-card iso">
                            <h3><i class="fas fa-globe"></i> ISO 27001:2022</h3>
                            <p><strong>Focus:</strong> Information Security Management System (ISMS)</p>
                            <p><strong>Audit Period:</strong> Stage 1 (documentation) + Stage 2 (implementation)</p>
                            <p><strong>SIEM Relevance:</strong> Risk treatment, monitoring, incident management, continual improvement</p>
                            <p><strong>Key Controls (Annex A):</strong></p>
                            <ul>
                                <li>A.8.15 - Logging</li>
                                <li>A.8.16 - Monitoring activities</li>
                                <li>A.5.24 - Incident management planning</li>
                                <li>A.5.28 - Collection of evidence</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Pre-Audit Timeline -->
                <section class="content-section">
                    <h2><i class="fas fa-calendar-alt"></i> Audit Preparation Timeline</h2>
                    
                    <div class="timeline-container">
                        <div class="timeline">
                            <div class="timeline-item">
                                <h4>T-12 Weeks: Gap Assessment</h4>
                                <ul>
                                    <li>Review previous audit findings and remediation status</li>
                                    <li>Conduct internal control testing against applicable framework</li>
                                    <li>Identify documentation gaps and missing evidence</li>
                                    <li>Assign remediation owners and establish deadlines</li>
                                    <li>Validate SIEM configuration against control requirements</li>
                                </ul>
                            </div>
                            
                            <div class="timeline-item">
                                <h4>T-8 Weeks: Evidence Collection Kickoff</h4>
                                <ul>
                                    <li>Begin systematic evidence collection for audit period</li>
                                    <li>Generate SIEM reports for monitoring controls</li>
                                    <li>Document policies and procedures (update if needed)</li>
                                    <li>Prepare access review evidence packages</li>
                                    <li>Validate log retention meets requirements</li>
                                </ul>
                            </div>
                            
                            <div class="timeline-item">
                                <h4>T-4 Weeks: Documentation Review</h4>
                                <ul>
                                    <li>Complete evidence package assembly</li>
                                    <li>Internal quality review of all documentation</li>
                                    <li>Prepare interview briefings for key personnel</li>
                                    <li>Test evidence extraction queries and reports</li>
                                    <li>Conduct mock audit walkthrough</li>
                                </ul>
                            </div>
                            
                            <div class="timeline-item">
                                <h4>T-2 Weeks: Final Preparation</h4>
                                <ul>
                                    <li>Finalize evidence repository organization</li>
                                    <li>Brief all interviewees on audit scope and process</li>
                                    <li>Confirm auditor access requirements (read-only SIEM access)</li>
                                    <li>Prepare war room with audit documentation</li>
                                    <li>Establish auditor communication protocol</li>
                                </ul>
                            </div>
                            
                            <div class="timeline-item">
                                <h4>During Audit: Execution</h4>
                                <ul>
                                    <li>Daily standup with audit team</li>
                                    <li>Track Information Requests (PBCs) and response deadlines</li>
                                    <li>Address findings immediately where possible</li>
                                    <li>Document any exceptions or deviations</li>
                                    <li>Escalate blockers to management</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Evidence Collection -->
                <section class="content-section">
                    <h2><i class="fas fa-folder-open"></i> Evidence Collection by Control Area</h2>
                    
                    <div class="checklist-section">
                        <h3><i class="fas fa-eye"></i> Security Monitoring Evidence</h3>
                        <table class="evidence-table">
                            <thead>
                                <tr>
                                    <th>Evidence Type</th>
                                    <th>Description</th>
                                    <th>Framework Mapping</th>
                                    <th>Retention</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Alert Summary Report</td>
                                    <td>Monthly summary of alerts by severity, category, resolution status</td>
                                    <td>SOC 2 CC7.2, PCI 10.6, ISO A.8.16</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>Detection Rule Inventory</td>
                                    <td>List of active detection rules with MITRE mapping and last review date</td>
                                    <td>SOC 2 CC6.6, ISO A.8.16</td>
                                    <td>Current + history</td>
                                </tr>
                                <tr>
                                    <td>Daily Log Review Evidence</td>
                                    <td>Screenshots or exports showing daily review completion</td>
                                    <td>PCI 10.4.1</td>
                                    <td>90 days</td>
                                </tr>
                                <tr>
                                    <td>SIEM Health Reports</td>
                                    <td>Data source ingestion status, gaps, latency metrics</td>
                                    <td>SOC 2 CC7.2, ISO A.8.15</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>Threat Intelligence Feed Status</td>
                                    <td>Active feeds, update frequency, indicator counts</td>
                                    <td>SOC 2 CC6.6, ISO A.5.7</td>
                                    <td>Current</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="checklist-section">
                        <h3><i class="fas fa-user-lock"></i> Access Control Evidence</h3>
                        <table class="evidence-table">
                            <thead>
                                <tr>
                                    <th>Evidence Type</th>
                                    <th>Description</th>
                                    <th>Framework Mapping</th>
                                    <th>Retention</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>User Access Review</td>
                                    <td>Quarterly review of SIEM user access with approval signatures</td>
                                    <td>SOC 2 CC6.1, PCI 7.2, ISO A.5.18</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>Privileged Access Logs</td>
                                    <td>Admin activity logs showing all privileged operations</td>
                                    <td>SOC 2 CC6.1, PCI 10.2.2, HIPAA §164.312(d)</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>Role-Based Access Matrix</td>
                                    <td>Current RBAC configuration with permissions per role</td>
                                    <td>SOC 2 CC6.1, ISO A.5.15</td>
                                    <td>Current + history</td>
                                </tr>
                                <tr>
                                    <td>Service Account Inventory</td>
                                    <td>List of service accounts with owners, purpose, permissions</td>
                                    <td>SOC 2 CC6.1, PCI 8.6</td>
                                    <td>Current</td>
                                </tr>
                                <tr>
                                    <td>Authentication Logs</td>
                                    <td>Successful and failed login attempts to SIEM platform</td>
                                    <td>PCI 10.2, HIPAA §164.312(d), ISO A.8.15</td>
                                    <td>12 months</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="checklist-section">
                        <h3><i class="fas fa-exclamation-triangle"></i> Incident Response Evidence</h3>
                        <table class="evidence-table">
                            <thead>
                                <tr>
                                    <th>Evidence Type</th>
                                    <th>Description</th>
                                    <th>Framework Mapping</th>
                                    <th>Retention</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Incident Response Plan</td>
                                    <td>Current IR plan with defined roles, escalation, communication</td>
                                    <td>SOC 2 CC7.3, PCI 12.10, ISO A.5.24</td>
                                    <td>Current</td>
                                </tr>
                                <tr>
                                    <td>Incident Tickets/Reports</td>
                                    <td>Sample of security incidents showing triage through resolution</td>
                                    <td>SOC 2 CC7.3, ISO A.5.25</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>Post-Incident Reviews</td>
                                    <td>PIR documentation for significant incidents</td>
                                    <td>SOC 2 CC7.4, ISO A.5.27</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>IR Tabletop Exercise</td>
                                    <td>Annual tabletop exercise documentation and lessons learned</td>
                                    <td>SOC 2 CC7.3, PCI 12.10.2</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>MTTA/MTTR Metrics</td>
                                    <td>Monthly metrics showing response time performance</td>
                                    <td>SOC 2 CC7.3, ISO A.5.24</td>
                                    <td>12 months</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="checklist-section">
                        <h3><i class="fas fa-cog"></i> Change Management Evidence</h3>
                        <table class="evidence-table">
                            <thead>
                                <tr>
                                    <th>Evidence Type</th>
                                    <th>Description</th>
                                    <th>Framework Mapping</th>
                                    <th>Retention</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Detection Rule Changes</td>
                                    <td>Change tickets for rule modifications with approval</td>
                                    <td>SOC 2 CC8.1, PCI 6.5, ISO A.8.32</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>SIEM Configuration Changes</td>
                                    <td>Platform configuration changes with approval workflow</td>
                                    <td>SOC 2 CC8.1, ISO A.8.32</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>Data Source Onboarding</td>
                                    <td>Documentation of new log source integrations</td>
                                    <td>SOC 2 CC7.2, ISO A.8.15</td>
                                    <td>12 months</td>
                                </tr>
                                <tr>
                                    <td>Version Control History</td>
                                    <td>Git history for detection rules and configurations</td>
                                    <td>SOC 2 CC8.1, ISO A.8.32</td>
                                    <td>12 months</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Platform-Specific Audit Queries -->
                <section class="content-section">
                    <h2><i class="fas fa-database"></i> Platform-Specific Audit Queries</h2>
                    
                    <h3>User Access Review Queries</h3>
                    
                    <div class="query-block">
                        <div class="platform-label">// Microsoft Sentinel - User Access Report</div>
<pre>// List all users with access to Sentinel workspace
let workspaceId = "YOUR_WORKSPACE_ID";
AzureActivity
| where TimeGenerated > ago(90d)
| where ResourceProvider == "MICROSOFT.OPERATIONALINSIGHTS"
| where ResourceId contains workspaceId
| summarize 
    LastActivity = max(TimeGenerated),
    Operations = make_set(OperationName)
    by Caller, CallerIpAddress
| extend UserPrincipalName = tostring(split(Caller, "@")[0])
| project UserPrincipalName, Caller, LastActivity, Operations, CallerIpAddress
| order by LastActivity desc</pre>
                    </div>
                    
                    <div class="query-block">
                        <div class="platform-label">// Splunk - User Access and Activity Report</div>
<pre>| rest /services/authentication/users
| table title realname roles email last_successful_login
| rename title as username
| join type=left username [
    | search index=_audit action=login*
    | stats latest(_time) as last_login_time by user
    | rename user as username
]
| eval last_activity = coalesce(strftime(last_login_time, "%Y-%m-%d %H:%M:%S"), "Never")
| table username realname email roles last_activity
| sort -last_activity</pre>
                    </div>
                    
                    <div class="query-block">
                        <div class="platform-label">// Cortex XSIAM - User Activity Audit</div>
<pre>dataset = xdr_data
| filter _vendor = "PAN" AND _product = "XDR" AND action_type = "LOGIN"
| dedup actor_effective_username
| fields actor_effective_username, _time, action_result, actor_source_ip
| sort desc _time
| limit 1000</pre>
                    </div>
                    
                    <h3>Log Retention Validation</h3>
                    
                    <div class="query-block">
                        <div class="platform-label">// Microsoft Sentinel - Validate 12-Month Retention</div>
<pre>// Check oldest events per table for retention compliance
union withsource=TableName *
| where TimeGenerated > ago(365d)
| summarize 
    OldestEvent = min(TimeGenerated),
    NewestEvent = max(TimeGenerated),
    EventCount = count()
    by TableName
| extend RetentionDays = datetime_diff('day', now(), OldestEvent)
| where RetentionDays < 365
| project TableName, OldestEvent, RetentionDays, Status = "⚠️ Below 365 days"
| order by RetentionDays asc</pre>
                    </div>
                    
                    <div class="query-block">
                        <div class="platform-label">// Splunk - Index Retention Status</div>
<pre>| eventcount summarize=false index=* 
| join type=outer index [
    | rest /services/data/indexes
    | table title frozenTimePeriodInSecs maxTotalDataSizeMB
    | rename title as index
    | eval retention_days = round(frozenTimePeriodInSecs / 86400, 0)
]
| eval compliance_status = if(retention_days >= 365, "✓ Compliant", "⚠️ Review Required")
| table index count retention_days compliance_status
| sort -count</pre>
                    </div>
                    
                    <h3>Security Alert Activity</h3>
                    
                    <div class="query-block">
                        <div class="platform-label">// Microsoft Sentinel - Monthly Alert Summary</div>
<pre>SecurityAlert
| where TimeGenerated > ago(30d)
| summarize 
    TotalAlerts = count(),
    Critical = countif(AlertSeverity == "High"),
    Medium = countif(AlertSeverity == "Medium"),
    Low = countif(AlertSeverity == "Low"),
    Informational = countif(AlertSeverity == "Informational")
    by bin(TimeGenerated, 1d)
| order by TimeGenerated asc
| render timechart</pre>
                    </div>
                    
                    <div class="query-block">
                        <div class="platform-label">// Splunk - Alert Resolution Metrics</div>
<pre>index=notable_events
| eval time_to_resolve = if(isnotnull(disposition_time), disposition_time - _time, null())
| stats 
    count as total_alerts,
    avg(time_to_resolve) as avg_resolution_seconds,
    median(time_to_resolve) as median_resolution_seconds,
    count(eval(status="Resolved")) as resolved_count
    by urgency
| eval avg_resolution_hours = round(avg_resolution_seconds/3600, 2)
| eval resolution_rate = round(resolved_count/total_alerts*100, 1)."%"
| table urgency total_alerts resolved_count resolution_rate avg_resolution_hours</pre>
                    </div>
                    
                    <h3>Privileged Activity Monitoring</h3>
                    
                    <div class="query-block">
                        <div class="platform-label">// Microsoft Sentinel - Admin Activity Audit</div>
<pre>AzureActivity
| where TimeGenerated > ago(90d)
| where CategoryValue == "Administrative"
| where ActivityStatusValue == "Success"
| summarize 
    OperationCount = count(),
    UniqueOperations = dcount(OperationName),
    Operations = make_set(OperationName, 10)
    by Caller, CallerIpAddress
| where OperationCount > 10
| order by OperationCount desc
| project Caller, CallerIpAddress, OperationCount, UniqueOperations, Operations</pre>
                    </div>
                </section>

                <!-- Common Audit Findings -->
                <section class="content-section">
                    <h2><i class="fas fa-exclamation-circle"></i> Common Audit Findings & Remediation</h2>
                    
                    <div class="finding-card">
                        <h4><span class="severity-badge high">HIGH</span> Insufficient Log Retention</h4>
                        <p><strong>Finding:</strong> Security logs are retained for less than the required period (typically 12 months for PCI-DSS, variable for others).</p>
                        <p><strong>Root Cause:</strong> Default retention settings not adjusted; storage cost concerns; lack of tiered storage strategy.</p>
                        <p><strong>Remediation:</strong></p>
                        <ul>
                            <li>Configure hot storage for 90 days, archive tier for 12+ months</li>
                            <li>Implement log lifecycle policies with automated archival</li>
                            <li>Use Sentinel Basic Logs or Splunk SmartStore for cost optimization</li>
                            <li>Document retention settings and validate quarterly</li>
                        </ul>
                    </div>
                    
                    <div class="finding-card">
                        <h4><span class="severity-badge high">HIGH</span> No Evidence of Daily Log Review</h4>
                        <p><strong>Finding:</strong> Cannot demonstrate that security logs are reviewed daily as required by PCI-DSS 10.4.1.</p>
                        <p><strong>Root Cause:</strong> Reviews performed but not documented; no formal sign-off process; reliance on automation without human verification.</p>
                        <p><strong>Remediation:</strong></p>
                        <ul>
                            <li>Implement daily review checklist with completion timestamps</li>
                            <li>Create SOAR playbook that requires analyst acknowledgment</li>
                            <li>Generate daily summary dashboard with sign-off workflow</li>
                            <li>Maintain review logs for audit period duration</li>
                        </ul>
                    </div>
                    
                    <div class="finding-card medium">
                        <h4><span class="severity-badge medium">MEDIUM</span> Incomplete Access Reviews</h4>
                        <p><strong>Finding:</strong> User access reviews do not include all privileged accounts or service accounts.</p>
                        <p><strong>Root Cause:</strong> Service accounts excluded from review scope; no automated discovery of accounts; manual process misses accounts.</p>
                        <p><strong>Remediation:</strong></p>
                        <ul>
                            <li>Implement automated user/account discovery queries</li>
                            <li>Include service accounts in quarterly review scope</li>
                            <li>Document all accounts with business justification</li>
                            <li>Require manager approval for access continuance</li>
                        </ul>
                    </div>
                    
                    <div class="finding-card medium">
                        <h4><span class="severity-badge medium">MEDIUM</span> Detection Rules Not Mapped to Threats</h4>
                        <p><strong>Finding:</strong> Security detections cannot be traced to specific threats or compliance requirements.</p>
                        <p><strong>Root Cause:</strong> Ad-hoc rule creation; no detection library management; missing MITRE ATT&CK mapping.</p>
                        <p><strong>Remediation:</strong></p>
                        <ul>
                            <li>Implement detection rule metadata including MITRE mapping</li>
                            <li>Create detection coverage matrix against ATT&CK framework</li>
                            <li>Document detection rationale and expected behavior</li>
                            <li>Regular coverage gap analysis against threat landscape</li>
                        </ul>
                    </div>
                    
                    <div class="finding-card low">
                        <h4><span class="severity-badge low">LOW</span> Inconsistent Incident Classification</h4>
                        <p><strong>Finding:</strong> Similar incidents classified at different severity levels; no standardized classification criteria.</p>
                        <p><strong>Root Cause:</strong> Subjective analyst judgment; no classification matrix; training gaps.</p>
                        <p><strong>Remediation:</strong></p>
                        <ul>
                            <li>Develop and document severity classification matrix</li>
                            <li>Train all analysts on classification criteria</li>
                            <li>Implement automated severity assignment where possible</li>
                            <li>Regular calibration sessions to ensure consistency</li>
                        </ul>
                    </div>
                    
                    <div class="finding-card low">
                        <h4><span class="severity-badge low">LOW</span> Missing Change Management for Detection Rules</h4>
                        <p><strong>Finding:</strong> Detection rule changes made without documented approval or testing.</p>
                        <p><strong>Root Cause:</strong> Urgency to deploy detections; no formal change process for security content; direct production access.</p>
                        <p><strong>Remediation:</strong></p>
                        <ul>
                            <li>Implement version control for all detection content</li>
                            <li>Require CAB approval for rule changes</li>
                            <li>Create dev/test environment for rule validation</li>
                            <li>Document testing results before production deployment</li>
                        </ul>
                    </div>
                </section>

                <!-- Pre-Audit Checklist -->
                <section class="content-section">
                    <h2><i class="fas fa-tasks"></i> Pre-Audit Checklist</h2>
                    
                    <div class="checklist-section">
                        <h3><i class="fas fa-file-alt"></i> Documentation Readiness</h3>
                        <ul class="checklist">
                            <li><span class="check-box"><i class="far fa-square"></i></span> Security monitoring policy and procedures documented and current</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Incident response plan reviewed and updated within 12 months</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> SIEM architecture diagram with data flows documented</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Detection rule inventory with owner and review dates</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Data source inventory with retention configurations</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> RBAC documentation matching current configuration</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> User access review procedures documented</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Change management procedures for SIEM changes</li>
                        </ul>
                    </div>
                    
                    <div class="checklist-section">
                        <h3><i class="fas fa-cogs"></i> Technical Configuration</h3>
                        <ul class="checklist">
                            <li><span class="check-box"><i class="far fa-square"></i></span> Log retention meets compliance requirements (verify per source)</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> All required log sources actively ingesting</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Time synchronization configured across all sources</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Alerting rules active and generating expected alerts</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Dashboard showing daily review completion status</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Audit logging enabled for SIEM platform itself</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> MFA enforced for all SIEM access</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Read-only auditor account created and tested</li>
                        </ul>
                    </div>
                    
                    <div class="checklist-section">
                        <h3><i class="fas fa-folder"></i> Evidence Package</h3>
                        <ul class="checklist">
                            <li><span class="check-box"><i class="far fa-square"></i></span> Monthly alert summary reports for audit period</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Quarterly user access review documentation with approvals</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Sample of 5-10 incident tickets showing full lifecycle</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Detection rule change tickets with approvals</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Annual IR tabletop exercise documentation</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> SIEM health/availability reports</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Training records for SOC analysts</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Previous audit findings with remediation evidence</li>
                        </ul>
                    </div>
                    
                    <div class="checklist-section">
                        <h3><i class="fas fa-users"></i> Personnel Preparation</h3>
                        <ul class="checklist">
                            <li><span class="check-box"><i class="far fa-square"></i></span> Key personnel identified for auditor interviews</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Interview briefing sessions completed</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Backup personnel identified for each role</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Audit liaison/coordinator assigned</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Escalation path for audit issues defined</li>
                            <li><span class="check-box"><i class="far fa-square"></i></span> Calendar blocked for audit period</li>
                        </ul>
                    </div>
                </section>

                <!-- Auditor Interview Preparation -->
                <section class="content-section">
                    <h2><i class="fas fa-comments"></i> Auditor Interview Preparation</h2>
                    
                    <p>Prepare personnel for common auditor questions about security monitoring and SIEM operations.</p>
                    
                    <h3>SOC Manager / Security Lead Questions</h3>
                    <table class="evidence-table">
                        <thead>
                            <tr>
                                <th>Question</th>
                                <th>Suggested Response Elements</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>"Walk me through your security monitoring process."</td>
                                <td>Describe: Data sources → SIEM ingestion → Detection rules → Alert triage → Investigation → Response → Documentation. Reference specific tools and team structure.</td>
                            </tr>
                            <tr>
                                <td>"How do you ensure logs are reviewed daily?"</td>
                                <td>Explain: Daily review queue/dashboard, analyst sign-off process, coverage during absences, documentation of reviews.</td>
                            </tr>
                            <tr>
                                <td>"What happens when a security incident is detected?"</td>
                                <td>Reference: IR plan, escalation matrix, severity classification, communication procedures, documentation requirements.</td>
                            </tr>
                            <tr>
                                <td>"How do you maintain detection capability?"</td>
                                <td>Discuss: Threat intelligence feeds, detection engineering process, MITRE coverage analysis, rule tuning, false positive management.</td>
                            </tr>
                            <tr>
                                <td>"How do you handle access to the SIEM?"</td>
                                <td>Explain: RBAC model, quarterly access reviews, MFA requirement, privileged access monitoring, service account management.</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h3>SOC Analyst Questions</h3>
                    <table class="evidence-table">
                        <thead>
                            <tr>
                                <th>Question</th>
                                <th>Suggested Response Elements</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>"Show me how you investigate an alert."</td>
                                <td>Walk through: Alert queue → Context enrichment → Initial triage → Investigation steps → Escalation criteria → Documentation.</td>
                            </tr>
                            <tr>
                                <td>"How do you determine alert severity?"</td>
                                <td>Reference: Severity classification matrix, asset criticality, threat context, business impact assessment.</td>
                            </tr>
                            <tr>
                                <td>"What do you do at shift handoff?"</td>
                                <td>Explain: Handoff template, open incidents, pending investigations, notable events, shift briefing process.</td>
                            </tr>
                            <tr>
                                <td>"How do you escalate an incident?"</td>
                                <td>Reference: Escalation matrix, escalation criteria, communication channels, notification procedures.</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h3>Detection Engineer Questions</h3>
                    <table class="evidence-table">
                        <thead>
                            <tr>
                                <th>Question</th>
                                <th>Suggested Response Elements</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>"How do you develop new detection rules?"</td>
                                <td>Explain: Threat research → Use case definition → Rule development → Testing → Peer review → Approval → Deployment → Tuning.</td>
                            </tr>
                            <tr>
                                <td>"How do you test rules before production?"</td>
                                <td>Describe: Dev/test environment, atomic testing, historical data replay, false positive assessment.</td>
                            </tr>
                            <tr>
                                <td>"How do you handle false positives?"</td>
                                <td>Reference: FP tracking process, tuning procedures, threshold adjustments, exclusion management, change tickets.</td>
                            </tr>
                            <tr>
                                <td>"How do you track detection coverage?"</td>
                                <td>Discuss: MITRE ATT&CK mapping, coverage matrix, gap analysis process, prioritization methodology.</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- Interview Q&A Section -->
                <div class="interview-qa">
                    <h3><i class="fas fa-user-tie"></i> Interview Preparation: Audit & Compliance</h3>
                    
                    <div class="qa-item">
                        <div class="question">Q: How do you prepare an organization for a SOC 2 Type II audit from a SIEM perspective?</div>
                        <div class="answer">
                            A: I follow a structured 12-week preparation approach. First, I conduct a gap assessment against the Trust Service Criteria, focusing on CC6.6 (security event monitoring), CC7.2 (system monitoring), and CC7.3 (incident response). I validate that log retention meets the audit period requirements—typically 12 months—and that all critical systems are actively ingesting. I ensure we have evidence of daily log review, which is often missed, by implementing dashboard sign-offs or SOAR playbook acknowledgments. For detection rules, I document the inventory with MITRE ATT&CK mapping and owner assignments. I also prepare sample incident tickets showing the full lifecycle from detection through resolution, including post-incident reviews. Finally, I brief SOC personnel on common auditor questions and create a read-only auditor account for their validation testing.
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <div class="question">Q: What are the most common SIEM-related audit findings you've encountered, and how do you prevent them?</div>
                        <div class="answer">
                            A: The most common finding is insufficient log retention—organizations often leave default settings that don't meet PCI's 12-month requirement. I address this by implementing tiered storage with hot/warm/cold tiers and validating retention quarterly using automated queries. Another frequent finding is lack of evidence for daily log review; I solve this with mandatory dashboard sign-offs or ticketing system integration. Incomplete access reviews are also common—I ensure service accounts and privileged users are included in scope, not just regular users. Detection rules without threat mapping is increasingly flagged; I maintain a detection library with mandatory MITRE ATT&CK classification and periodic coverage gap analysis. Finally, missing change management for detection rules is common—I implement version control with required approval workflows before production deployment.
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <div class="question">Q: How do you demonstrate to auditors that security monitoring is effective?</div>
                        <div class="answer">
                            A: I demonstrate effectiveness through multiple evidence streams. First, metrics: I show MTTA and MTTR trends demonstrating we're meeting SLAs, detection coverage percentage against MITRE ATT&CK, and true positive rates showing detection quality. Second, I provide sample incidents showing the complete workflow from alert through resolution, including decision rationale and documentation quality. Third, I present the detection engineering lifecycle showing how we develop, test, and tune rules in response to emerging threats. Fourth, I show tabletop exercise results demonstrating the team can execute the IR plan. Finally, I provide SIEM health metrics showing data source availability, ingestion latency, and any gaps—auditors appreciate transparency about known limitations alongside evidence of continuous improvement.
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <div class="question">Q: How do you handle a situation where you discover a compliance gap during audit preparation?</div>
                        <div class="answer">
                            A: I prioritize transparency and remediation speed. First, I assess the gap's severity and determine if it's remediable before the audit—many gaps can be fixed within weeks. I document the gap, root cause, and remediation plan with specific timelines. If the gap cannot be fully remediated, I prepare a compensating control narrative showing awareness of the issue and interim mitigations. I communicate early with the audit liaison and potentially the auditors themselves—discovered gaps are viewed more favorably than hidden ones. For example, if I find log retention is only 6 months instead of 12, I immediately adjust retention settings, implement archive tier storage, and document the configuration change. I then prepare evidence of the correction and proactive monitoring to prevent recurrence. Auditors typically appreciate organizations that self-identify and remediate issues rather than waiting for external discovery.
                        </div>
                    </div>
                </div>
            </main>
            
            <footer class="content-footer">
                <div class="footer-content">
                    <p>Nik's SIEM - Audit Preparation Guide</p>
                    <p>Enterprise Compliance Documentation</p>
                </div>
            </footer>
        </div>
    </div>
    
    <script src="../assets/js/main.js"></script>
</body>
</html>
