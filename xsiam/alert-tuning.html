<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alert Tuning Lifecycle | XSIAM Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
            <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link active"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>


        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Alert Tuning</span>
                </div>

                <h1><i class="fas fa-sliders-h"></i> Alert Tuning Lifecycle</h1>
                <p class="lead">Systematic approach to managing alert quality, reducing false positives, and maintaining effective detection coverage. This guide covers the full lifecycle from initial deployment to continuous optimization.</p>

                <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> The Alert Tuning Challenge</h4>
                    <p>SOC teams typically face 30-50% false positive rates on alerts. Effective tuning reduces this to under 15% while maintaining detection coverage. Poor tuning leads to alert fatigue, missed true positives, and analyst burnout.</p>
                </div>

                <!-- Tuning Lifecycle Overview -->
                <h2><i class="fas fa-sync-alt"></i> Alert Tuning Lifecycle</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-project-diagram"></i> Continuous Tuning Cycle</div>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 16px; justify-content: center;">
                        <div class="flow-step" style="background: #1c3a5e; border-color: #58a6ff;">
                            <div class="flow-icon"><i class="fas fa-chart-bar"></i></div>
                            <div class="flow-content">
                                <strong>1. Measure</strong>
                                <div style="font-size: 0.8rem; color: #8b949e;">Track FP rates<br>Volume metrics<br>Response times</div>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #3d2a5e; border-color: #a371f7;">
                            <div class="flow-icon"><i class="fas fa-search"></i></div>
                            <div class="flow-content">
                                <strong>2. Analyze</strong>
                                <div style="font-size: 0.8rem; color: #8b949e;">Identify patterns<br>Root cause FPs<br>Coverage gaps</div>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #4d3a0d; border-color: #d29922;">
                            <div class="flow-icon"><i class="fas fa-edit"></i></div>
                            <div class="flow-content">
                                <strong>3. Tune</strong>
                                <div style="font-size: 0.8rem; color: #8b949e;">Add exclusions<br>Adjust thresholds<br>Refine logic</div>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #1a4d2e; border-color: #3fb950;">
                            <div class="flow-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="flow-content">
                                <strong>4. Validate</strong>
                                <div style="font-size: 0.8rem; color: #8b949e;">Test changes<br>Monitor impact<br>Document</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tuning Decision Tree -->
                <h2><i class="fas fa-code-branch"></i> Tuning Decision Tree</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>Alert reviewed - What is the disposition?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ True Positive</div>
                            <div class="decision-node" style="background: #1a4d2e; border-color: #3fb950;">
                                <strong style="color: #3fb950;">Good Detection</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Process incident normally<br>2. Document detection success<br>3. Consider if response can be automated</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ False Positive</div>
                            <div class="decision-node question">
                                <strong>Is this a recurring FP pattern?</strong>
                            </div>
                            <div class="decision-branch">
                                <div>
                                    <div class="decision-arrow">↓ YES (Seen before)</div>
                                    <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                        <strong style="color: #d29922;">Tune Required</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">1. Document pattern<br>2. Create exclusion/exception<br>3. Test tuning change<br>4. Deploy to production</div>
                                    </div>
                                </div>
                                <div>
                                    <div class="decision-arrow">↓ NO (First time)</div>
                                    <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                        <strong style="color: #58a6ff;">Monitor</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">1. Close as FP with notes<br>2. Tag for tracking<br>3. Review again if recurs</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Benign True Positive</div>
                            <div class="decision-node" style="background: #3d2a5e; border-color: #a371f7;">
                                <strong style="color: #a371f7;">Evaluate Risk</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Technically correct but expected<br>1. Add to known-good list<br>2. Consider risk acceptance<br>3. Document business justification</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FP Analysis Queries -->
                <h2><i class="fas fa-chart-pie"></i> False Positive Analysis</h2>
                
                <div class="config-section">
                    <h4>FP Rate Analysis Queries</h4>
                    <div class="arch-diagram"># Alert Quality Metrics
# ═══════════════════════════════════════════════════════════════

# Overall FP Rate by Rule
dataset = xdr_alerts
| filter _time > now() - 30d
| filter resolution != null  // Only resolved alerts
| comp count() as total_alerts,
        countif(resolution = "false_positive") as fp_count,
        countif(resolution = "true_positive") as tp_count,
        countif(resolution = "benign") as benign_count
  by alert_name
| alter fp_rate = round(fp_count * 100 / total_alerts, 1)
| filter total_alerts > 10  // Statistical significance
| sort fp_rate desc

# ═══════════════════════════════════════════════════════════════

# Weekly FP Trend
dataset = xdr_alerts
| filter _time > now() - 90d
| filter resolution != null
| alter week = format_time("%Y-W%V", _time)
| comp count() as total,
        countif(resolution = "false_positive") as fps
  by week
| alter fp_rate = round(fps * 100 / total, 1)
| sort week asc

# ═══════════════════════════════════════════════════════════════

# Top FP Contributors (Volume)
dataset = xdr_alerts
| filter _time > now() - 30d
| filter resolution = "false_positive"
| comp count() as fp_count by alert_name
| sort fp_count desc
| limit 20

# ═══════════════════════════════════════════════════════════════

# FP by Source/Endpoint
dataset = xdr_alerts
| filter _time > now() - 30d
| filter resolution = "false_positive"
| comp count() as fp_count by endpoint_name, alert_name
| filter fp_count > 5
| sort fp_count desc

# ═══════════════════════════════════════════════════════════════

# Analyst Time Wasted on FPs
dataset = xdr_alerts
| filter _time > now() - 30d
| filter resolution = "false_positive"
| alter handling_time_min = timestamp_diff(resolved_time, created_time, "MINUTE")
| comp sum(handling_time_min) as total_fp_minutes,
        avg(handling_time_min) as avg_fp_minutes,
        count() as fp_count
  by alert_name
| alter hours_wasted = round(total_fp_minutes / 60, 1)
| sort hours_wasted desc</div>
                </div>

                <!-- Common Tuning Patterns -->
                <h2><i class="fas fa-filter"></i> Common Tuning Patterns</h2>
                
                <div class="config-section">
                    <h4>Exclusion Types and When to Use</h4>
                    <div class="arch-diagram"># Exclusion Type Reference
# ═══════════════════════════════════════════════════════════════

## 1. HOST EXCLUSION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
When: Specific system has legitimate reason for flagged behavior
Example: Security scanner triggers reconnaissance alerts
Implementation:
  | filter endpoint_name != "security-scanner-01"
Risk: Medium - entire host excluded from detection

## 2. USER EXCLUSION  
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
When: Specific user's job function causes expected alerts
Example: IT admin triggers privilege escalation alerts
Implementation:
  | filter user_name not in ("svc_admin", "john.admin")
Risk: High - user activity not monitored for this rule

## 3. PROCESS EXCLUSION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
When: Known-good software triggers behavioral detection
Example: Backup software triggers data exfiltration alert
Implementation:
  | filter actor_process_image_name != "backup_agent.exe"
  | filter actor_process_signer != "Veritas Software"
Risk: Low-Medium - specific process excluded

## 4. PATH EXCLUSION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
When: Activity in specific location is expected
Example: Temp folder used by legitimate build process
Implementation:
  | filter action_file_path not contains "C:\\BuildAgent\\temp"
Risk: Low - specific path excluded

## 5. NETWORK EXCLUSION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
When: Communication to specific destination is expected
Example: Cloud backup to specific IP range
Implementation:
  | filter dst_ip not in cidr "10.100.0.0/16"
Risk: Medium - network range excluded

## 6. TIME-BASED EXCLUSION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
When: Activity only legitimate during specific times
Example: Maintenance jobs run at 3 AM
Implementation:
  | filter NOT (hour(_time) >= 2 AND hour(_time) <= 4 AND 
              dayofweek(_time) = 0)  // Sunday 2-4 AM
Risk: Low - specific window excluded

## 7. THRESHOLD ADJUSTMENT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
When: Detection threshold too sensitive
Example: Failed login alert fires at 3 attempts, normal is 5
Implementation:
  | filter failed_logins > 10  // Raise from 5 to 10
Risk: Medium - may miss slower attacks

## 8. COMBINED EXCLUSION (Safest)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
When: Need very specific exclusion
Example: Only exclude backup software on backup servers
Implementation:
  | filter NOT (endpoint_name contains "backup-srv" AND 
               actor_process_image_name = "backup_agent.exe")
Risk: Low - very targeted exclusion

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Tuning Workflow -->
                <h2><i class="fas fa-clipboard-list"></i> Tuning Request Workflow</h2>
                
                <div class="config-section">
                    <h4>Standard Tuning Request Process</h4>
                    <div class="arch-diagram"># Tuning Request Template
# ═══════════════════════════════════════════════════════════════

## REQUEST INFORMATION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Request ID:         [TUN-XXXX]
Requested By:       [Analyst Name]
Date:               [YYYY-MM-DD]
Alert Rule:         [Rule Name / ID]
Current FP Rate:    [X%]

## PROBLEM STATEMENT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Description:        [Why is this alerting incorrectly?]
FP Volume:          [X alerts per day/week]
Sample Alert IDs:   [List 3-5 example alert IDs]
Pattern Identified: [What do all FPs have in common?]

## PROPOSED TUNING
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Tuning Type:        [Exclusion / Threshold / Logic Change]
Proposed Change:    [Specific modification]
Scope Impact:       [What will no longer alert?]
Detection Gap:      [What attacks might be missed?]

## RISK ASSESSMENT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Risk Level:         [Low / Medium / High]
Justification:      [Why is this acceptable?]
Compensating Controls: [What else detects this threat?]

## APPROVAL
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Technical Review:   [Engineer Name] - [Date]
Security Approval:  [Manager Name] - [Date]

## IMPLEMENTATION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Implemented By:     [Engineer Name]
Implementation Date: [YYYY-MM-DD]
Tested:             [Yes/No]
Validation Query:   [XQL to verify tuning works]

## POST-IMPLEMENTATION REVIEW
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Review Date:        [30 days post-implementation]
New FP Rate:        [X%]
Any True Positives Missed: [Yes/No - Details]
Final Status:       [Success / Revert / Further Tune]

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Tuning Schedule -->
                <h2><i class="fas fa-calendar-alt"></i> Tuning Cadence</h2>
                
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Frequency</th>
                            <th>Activity</th>
                            <th>Owner</th>
                            <th>Deliverable</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong style="color: #3fb950;">Daily</strong></td>
                            <td>Review high-volume FP alerts, quick exclusions</td>
                            <td>SOC Analysts</td>
                            <td>Ad-hoc tuning requests</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #58a6ff;">Weekly</strong></td>
                            <td>FP rate review, process pending tuning requests</td>
                            <td>Detection Engineer</td>
                            <td>Weekly tuning report</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #d29922;">Monthly</strong></td>
                            <td>Rule performance review, coverage gap analysis</td>
                            <td>Security Lead</td>
                            <td>Monthly detection metrics</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #a371f7;">Quarterly</strong></td>
                            <td>Full rule audit, retire ineffective rules</td>
                            <td>Security Team</td>
                            <td>Quarterly detection review</td>
                        </tr>
                    </tbody>
                </table>

                <div class="config-section">
                    <h4>Weekly Tuning Review Queries</h4>
                    <div class="arch-diagram"># Weekly Tuning Review Queries
# ═══════════════════════════════════════════════════════════════

# Rules Needing Immediate Attention (>50% FP)
dataset = xdr_alerts
| filter _time > now() - 7d
| filter resolution != null
| comp count() as total,
        countif(resolution = "false_positive") as fps
  by alert_name
| alter fp_rate = round(fps * 100 / total, 1)
| filter total > 5 AND fp_rate > 50
| sort fp_rate desc

# ═══════════════════════════════════════════════════════════════

# Alert Volume by Rule (Capacity Planning)
dataset = xdr_alerts
| filter _time > now() - 7d
| comp count() as weekly_volume by alert_name
| sort weekly_volume desc
| limit 20

# ═══════════════════════════════════════════════════════════════

# Rules with No Activity (May be broken)
// List all enabled rules, compare to those with alerts
dataset = xdr_alerts
| filter _time > now() - 30d
| comp count() as alert_count by alert_name
| filter alert_count = 0
// Cross-reference with rule configuration

# ═══════════════════════════════════════════════════════════════

# New FP Patterns Emerging
dataset = xdr_alerts
| filter _time > now() - 7d
| filter resolution = "false_positive"
| comp count() as fp_count by alert_name, endpoint_name
| filter fp_count > 3
| sort fp_count desc

# ═══════════════════════════════════════════════════════════════

# Analyst Notes on FPs (Find Common Themes)
dataset = xdr_alerts
| filter _time > now() - 7d
| filter resolution = "false_positive"
| filter analyst_notes != null
| fields alert_name, analyst_notes, endpoint_name, user_name
| limit 100</div>
                </div>

                <!-- Rule Testing -->
                <h2><i class="fas fa-vial"></i> Testing Tuning Changes</h2>
                
                <div class="config-section">
                    <h4>Safe Testing Methodology</h4>
                    <div class="arch-diagram"># Tuning Change Testing Process
# ═══════════════════════════════════════════════════════════════

## STEP 1: BASELINE CURRENT STATE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Before any change, document:
- Current rule logic
- Alert volume (last 7 days)
- FP rate (last 7 days)
- TP rate (last 7 days)

## STEP 2: TEST QUERY FIRST
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Run modified query against historical data to see impact:

# Example: Testing host exclusion
dataset = xdr_alerts
| filter _time > now() - 7d
| filter alert_name = "[RULE_NAME]"
| filter endpoint_name != "excluded-host"  // Proposed exclusion
| comp count() as would_remain,
        countif(resolution = "true_positive") as tps_remaining,
        countif(resolution = "false_positive") as fps_remaining

# Verify: Are TPs preserved? Are FPs reduced?

## STEP 3: SHADOW MODE (If Available)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- Deploy modified rule as new rule (disabled alerting)
- Run for 24-48 hours
- Compare output to original rule
- Verify no unexpected gaps

## STEP 4: GRADUAL ROLLOUT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Option A: Time-limited test
- Enable for 24 hours
- Monitor closely
- Be ready to revert

Option B: Scope-limited test
- Apply to subset of environment
- Expand if successful

## STEP 5: POST-CHANGE VALIDATION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
After 7 days, verify:
□ FP rate decreased as expected
□ No true positives missed
□ Alert volume at expected level
□ No analyst complaints

## ROLLBACK PLAN
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Always maintain:
- Original rule backup
- Quick revert procedure
- Clear rollback criteria

Rollback if:
- TP missed within 48 hours
- FP rate not improved after 7 days
- Unexpected side effects

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Avoiding Over-Tuning -->
                <h2><i class="fas fa-exclamation-triangle"></i> Avoiding Over-Tuning</h2>
                
                <div class="warning-box">
                    <h4><i class="fas fa-exclamation-triangle"></i> The Over-Tuning Trap</h4>
                    <p>Over-tuning creates blind spots. Every exclusion is a potential gap. If you tune away all alerts, you've disabled detection, not improved it. Balance FP reduction with maintaining coverage.</p>
                </div>

                <div class="config-section">
                    <h4>Over-Tuning Warning Signs</h4>
                    <div class="arch-diagram"># Warning Signs of Over-Tuning
# ═══════════════════════════════════════════════════════════════

## RED FLAGS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ Rule has more than 10 exclusions
⚠️ FP rate drops to 0% (suspicious - may be broken)
⚠️ Alert volume drops more than 80% after tuning
⚠️ Exclusion list includes generic terms
⚠️ User/host exclusions for privileged accounts
⚠️ Exclusions added without documentation
⚠️ Same entity excluded from multiple rules

## HEALTHY TUNING INDICATORS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✓ FP rate between 10-25%
✓ Exclusions are specific and documented
✓ Regular review of exclusion lists
✓ Compensating controls for each exclusion
✓ True positives still being detected

## EXCLUSION HYGIENE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Quarterly review:
□ Is each exclusion still needed?
□ Has the business justification changed?
□ Are excluded entities still in the environment?
□ Can exclusions be made more specific?
□ Are there compensating detections?

# ═══════════════════════════════════════════════════════════════

# Query: Find Over-Tuned Rules
dataset = xdr_alert_rules
| filter exclusion_count > 10
| fields rule_name, exclusion_count, last_modified, modified_by

# Query: Rules with Zero Alerts (Possibly Broken)
dataset = xdr_alerts
| filter _time > now() - 30d
| comp count() as alerts by alert_name
| right join (dataset = xdr_alert_rules | filter enabled = true) 
  as rules on alert_name = rules.rule_name
| filter alerts = 0 OR alerts = null

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Metrics Dashboard -->
                <h2><i class="fas fa-tachometer-alt"></i> Tuning Metrics Dashboard</h2>
                
                <div class="config-section">
                    <h4>Key Metrics to Track</h4>
                    <div class="arch-diagram"># Alert Quality Dashboard Metrics
# ═══════════════════════════════════════════════════════════════

## PRIMARY METRICS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
┌─────────────────────────────────────────────────────────┐
│ Overall FP Rate        │ Target: < 20%    │ Current: X% │
├─────────────────────────────────────────────────────────┤
│ True Positive Rate     │ Target: > 75%    │ Current: X% │
├─────────────────────────────────────────────────────────┤
│ Alert Volume / Day     │ Target: < 100    │ Current: X  │
├─────────────────────────────────────────────────────────┤
│ Avg Handle Time (min)  │ Target: < 10     │ Current: X  │
├─────────────────────────────────────────────────────────┤
│ Time to Tune (days)    │ Target: < 7      │ Current: X  │
└─────────────────────────────────────────────────────────┘

## SECONDARY METRICS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- Rules above 50% FP rate
- Analyst hours spent on FPs
- Tuning requests pending
- Rules with no alerts (30d)
- Coverage gaps identified

# Dashboard XQL Queries
# ═══════════════════════════════════════════════════════════════

# FP Rate Gauge
dataset = xdr_alerts
| filter _time > now() - 7d
| filter resolution != null
| comp count() as total, countif(resolution = "false_positive") as fps
| alter fp_rate = round(fps * 100 / total, 1)

# Alert Volume Trend
dataset = xdr_alerts
| filter _time > now() - 30d
| alter day = format_time("%Y-%m-%d", _time)
| comp count() as daily_alerts by day
| sort day asc

# Handle Time Distribution
dataset = xdr_alerts
| filter _time > now() - 7d
| filter resolution != null
| alter handle_time = timestamp_diff(resolved_time, created_time, "MINUTE")
| comp avg(handle_time) as avg_time, 
        percentile(handle_time, 50) as median_time,
        percentile(handle_time, 95) as p95_time

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: You inherit a SIEM with 70% false positive rate. How do you approach fixing this?</button>
                        <div class="qa-answer">
                            <p>A 70% FP rate is a crisis - analysts are drowning and likely missing true positives. My approach is triage, prioritize, and systematically improve.</p>
                            
                            <p><strong>First, I quantify the problem:</strong> I query alert data to identify which rules are generating the most FPs. Usually, 20% of rules generate 80% of the noise. I create a prioritized list sorted by FP volume - fixing the top offenders first gives the biggest impact.</p>
                            
                            <p><strong>Quick wins first:</strong> I look for obvious patterns in the worst rules. Are they alerting on known security tools? Specific service accounts? Maintenance windows? These can often be fixed with straightforward exclusions in hours, not days.</p>
                            
                            <p><strong>Evaluate rule necessity:</strong> Some rules may simply not be appropriate for the environment. A detection for an attack vector the organization isn't vulnerable to creates noise without value. I'd rather disable a rule entirely than tune it into irrelevance.</p>
                            
                            <p><strong>Establish a tuning process:</strong> I implement a formal workflow - analysts tag FPs with patterns, weekly review prioritizes tuning requests, and all changes are tested before deployment. This prevents the problem from recurring.</p>
                            
                            <p><strong>Set realistic targets:</strong> Going from 70% to 15% takes time. I'd set a 30-day goal of 40%, 60-day goal of 25%, 90-day goal of 15%. This shows progress while being achievable.</p>
                            
                            <p><strong>Prevent regression:</strong> I track FP rate weekly and set alerts if it starts creeping back up. Each tuning change is documented so we can understand what worked and what didn't.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you balance reducing false positives without creating detection gaps?</button>
                        <div class="qa-answer">
                            <p>This is the fundamental tension in detection engineering. Every exclusion is a potential blind spot. My approach is to be surgical with tuning and always consider compensating controls.</p>
                            
                            <p><strong>Specificity over breadth:</strong> Instead of excluding an entire user, I exclude that user only for that specific behavior on that specific system. Combined conditions are safer than broad exclusions.</p>
                            
                            <p><strong>Compensating controls:</strong> Before adding an exclusion, I verify what else would detect the attack. If I exclude a backup tool from data exfiltration alerts, do I still have network-based detection for unusual data transfers? If I exclude an admin from privilege escalation alerts, do I have audit logging on their actions?</p>
                            
                            <p><strong>Time-bound exclusions:</strong> For temporary situations like migrations or projects, I use exclusions with expiration dates. This prevents permanent gaps for temporary needs.</p>
                            
                            <p><strong>Regular review:</strong> Every quarter, I audit exclusion lists. Are they still needed? Has the business reason changed? Can they be made more specific? This catches exclusions that have become gaps.</p>
                            
                            <p><strong>Accept some FPs:</strong> A 0% FP rate usually means the detection is broken or over-tuned. I target 15-20% FP rate - this means we're catching things at the edge of malicious behavior, which is where attackers operate. Some analyst time on FPs is the cost of good coverage.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) { sidebar.classList.toggle('open'); overlay.classList.toggle('active'); }
            else { sidebar.classList.toggle('collapsed'); mainWrapper.classList.toggle('expanded'); }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
