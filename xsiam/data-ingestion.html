<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Ingestion | XSIAM | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">XSIAM Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> vs Competitors</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link active"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM</a>
                    <a href="agents.html" class="nav-link"><i class="fas fa-desktop"></i> Cortex Agents</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & XDM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="correlation-rules.html" class="nav-link"><i class="fas fa-bell"></i> Correlation Rules</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention Tiers</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Data Ingestion</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-database"></i> XSIAM Data Ingestion</h1>
                <p class="lead">XSIAM supports multiple ingestion methods to collect security data from endpoints, networks, cloud, and third-party sources. Understanding when to use each method is critical for optimal performance and cost efficiency.</p>

                <!-- DECISION TREE: Which Ingestion Method? -->
                <h2><i class="fas fa-route"></i> Choosing the Right Ingestion Method</h2>
                
                <div class="decision-tree">
                    <div class="decision-node">
                        <div class="decision-node-question">What type of data source are you onboarding?</div>
                    </div>
                    
                    <div class="decision-paths">
                        <div class="decision-path">
                            <div class="decision-path-label yes">Endpoint (Windows/Mac/Linux)</div>
                            <div class="decision-path-content">
                                <p style="color: #3fb950; font-weight: 600;">→ Use Cortex Agent</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">Native XDR protection + telemetry. Richest data, lowest latency.</p>
                            </div>
                        </div>
                        <div class="decision-path">
                            <div class="decision-path-label no">Network/Security Device</div>
                            <div class="decision-path-content">
                                <p style="color: #f85149; font-weight: 600;">→ Continue to next decision</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="decision-tree">
                    <div class="decision-node">
                        <div class="decision-node-question">Can the device push logs via Syslog/CEF/LEEF?</div>
                    </div>
                    
                    <div class="decision-paths">
                        <div class="decision-path">
                            <div class="decision-path-label yes">Yes - Supports Syslog</div>
                            <div class="decision-path-content">
                                <p style="color: #3fb950; font-weight: 600;">→ Use Broker VM (Syslog Collector)</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">Deploy on-prem Broker VM. Configure device to send to Broker on UDP 514 or TCP 601.</p>
                            </div>
                        </div>
                        <div class="decision-path">
                            <div class="decision-path-label no">No Syslog Support</div>
                            <div class="decision-path-content">
                                <p style="color: #f85149; font-weight: 600;">→ Check for Cloud API</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="decision-tree">
                    <div class="decision-node">
                        <div class="decision-node-question">Is this a cloud service with API access?</div>
                    </div>
                    
                    <div class="decision-paths">
                        <div class="decision-path">
                            <div class="decision-path-label yes">Yes - Has API</div>
                            <div class="decision-path-content">
                                <p style="color: #3fb950; font-weight: 600;">→ Use Cloud API Collector</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">Native XSIAM collectors for AWS, Azure, GCP, O365, Okta, etc. No on-prem infrastructure needed.</p>
                            </div>
                        </div>
                        <div class="decision-path">
                            <div class="decision-path-label no">Custom/Legacy System</div>
                            <div class="decision-path-content">
                                <p style="color: #d29922; font-weight: 600;">→ Use Custom API or File Collection</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">Build custom collector or use Broker VM file tail for local logs.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- INGESTION METHODS OVERVIEW -->
                <h2><i class="fas fa-layer-group"></i> Ingestion Methods Overview</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-sitemap"></i> All XSIAM Ingestion Paths</div>
                    
                    <!-- Data Sources Row -->
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="color: #8b949e; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">Data Sources</span>
                    </div>
                    <div class="flow-row centered">
                        <div class="flow-box"><div class="flow-box-title">Endpoints</div><div class="flow-box-subtitle">Windows, Mac, Linux</div></div>
                        <div class="flow-box"><div class="flow-box-title">Network</div><div class="flow-box-subtitle">Firewalls, IDS/IPS</div></div>
                        <div class="flow-box"><div class="flow-box-title">Cloud</div><div class="flow-box-subtitle">AWS, Azure, GCP</div></div>
                        <div class="flow-box"><div class="flow-box-title">Identity</div><div class="flow-box-subtitle">AD, Okta, Azure AD</div></div>
                        <div class="flow-box"><div class="flow-box-title">SaaS Apps</div><div class="flow-box-subtitle">O365, Salesforce</div></div>
                        <div class="flow-box"><div class="flow-box-title">Custom</div><div class="flow-box-subtitle">Legacy, Proprietary</div></div>
                    </div>
                    
                    <div class="flow-arrow down">↓ ↓ ↓ ↓ ↓ ↓</div>
                    
                    <!-- Ingestion Methods Row -->
                    <div style="text-align: center; margin: 20px 0;">
                        <span style="color: #8b949e; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">Ingestion Method Selection</span>
                    </div>
                    <div class="flow-row centered">
                        <div class="flow-box primary"><div class="flow-box-title">Method 1</div><div class="flow-box-subtitle">Cortex Agent</div></div>
                        <div class="flow-box success"><div class="flow-box-title">Method 2</div><div class="flow-box-subtitle">Broker VM</div></div>
                        <div class="flow-box warning"><div class="flow-box-title">Method 3</div><div class="flow-box-subtitle">Cloud API</div></div>
                        <div class="flow-box purple"><div class="flow-box-title">Method 4</div><div class="flow-box-subtitle">Direct Syslog</div></div>
                        <div class="flow-box danger"><div class="flow-box-title">Method 5</div><div class="flow-box-subtitle">Custom API</div></div>
                    </div>
                    
                    <div class="flow-arrow down">↓</div>
                    
                    <!-- XSIAM Processing -->
                    <div class="flow-row centered">
                        <div class="flow-box primary" style="min-width: 300px;">
                            <div class="flow-box-title">XSIAM Ingestion Layer</div>
                            <div class="flow-box-subtitle">Parse → Normalize → Enrich → Store</div>
                        </div>
                    </div>
                </div>

                <!-- METHOD 1: CORTEX AGENT -->
                <h2><i class="fas fa-desktop"></i> Method 1: Cortex Agent</h2>
                
                <div class="method-card">
                    <div class="method-card-header">
                        <div class="method-card-icon blue"><i class="fas fa-desktop"></i></div>
                        <div>
                            <div class="method-card-title">Cortex Agent (XDR Agent)</div>
                            <div class="method-card-desc">Deploy on endpoints for native protection and rich telemetry</div>
                        </div>
                    </div>
                    <div class="method-card-content">
                        <div class="method-detail">
                            <div class="method-detail-label">Best For</div>
                            <div class="method-detail-value">Windows, macOS, Linux endpoints and servers</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Data Collected</div>
                            <div class="method-detail-value">Process, file, registry, network, behavior analytics</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Latency</div>
                            <div class="method-detail-value">Near real-time (seconds)</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">License Impact</div>
                            <div class="method-detail-value">Per-endpoint licensing, highest data volume</div>
                        </div>
                    </div>
                </div>

                <div class="enterprise-example">
                    <div class="enterprise-example-header">
                        <i class="fas fa-building"></i>
                        <div class="enterprise-example-title">Enterprise Example: 5,000 Employee Company</div>
                    </div>
                    <div class="enterprise-example-scenario">
                        <strong>Scenario:</strong> Deploy Cortex agents to all corporate endpoints including developer workstations, finance systems, and production servers.
                    </div>
                    <div class="enterprise-example-flow">
                        <div class="flow-box primary"><div class="flow-box-title">5,000 Workstations</div><div class="flow-box-subtitle">Windows 10/11</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box"><div class="flow-box-title">Cortex Agent</div><div class="flow-box-subtitle">v8.x Deployed</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box success"><div class="flow-box-title">XSIAM Cloud</div><div class="flow-box-subtitle">Direct HTTPS</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box warning"><div class="flow-box-title">~50GB/day</div><div class="flow-box-subtitle">Endpoint Telemetry</div></div>
                    </div>
                    <div style="margin-top: 16px; padding: 12px; background: #0d1117; border-radius: 8px;">
                        <p style="color: #8b949e; font-size: 0.85rem; margin: 0;">
                            <strong style="color: #3fb950;">Why this method?</strong> Native XDR provides prevention + detection in one agent. 
                            Rich telemetry enables behavioral detection. No additional infrastructure needed - agents communicate directly with XSIAM cloud.
                        </p>
                    </div>
                </div>

                <!-- METHOD 2: BROKER VM -->
                <h2><i class="fas fa-server"></i> Method 2: Broker VM (Syslog Collector)</h2>
                
                <div class="method-card">
                    <div class="method-card-header">
                        <div class="method-card-icon green"><i class="fas fa-server"></i></div>
                        <div>
                            <div class="method-card-title">Broker VM - Syslog Collection</div>
                            <div class="method-card-desc">On-premises virtual appliance to receive syslog from network devices</div>
                        </div>
                    </div>
                    <div class="method-card-content">
                        <div class="method-detail">
                            <div class="method-detail-label">Best For</div>
                            <div class="method-detail-value">Firewalls, switches, IDS/IPS, proxies, WAF</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Protocols Supported</div>
                            <div class="method-detail-value">Syslog UDP/TCP, CEF, LEEF, BSD, RFC 5424</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Deployment</div>
                            <div class="method-detail-value">VM on ESXi, Hyper-V, KVM, or cloud (AWS/Azure)</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Sizing</div>
                            <div class="method-detail-value">4-16 vCPU, 8-32GB RAM based on EPS</div>
                        </div>
                    </div>
                </div>

                <!-- Broker VM Flow -->
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-project-diagram"></i> Broker VM Data Flow</div>
                    
                    <div class="flow-row">
                        <div class="flow-box"><div class="flow-box-title">Palo Alto NGFW</div><div class="flow-box-subtitle">Traffic Logs</div></div>
                        <div class="flow-box"><div class="flow-box-title">Cisco ASA</div><div class="flow-box-subtitle">VPN Logs</div></div>
                        <div class="flow-box"><div class="flow-box-title">F5 WAF</div><div class="flow-box-subtitle">Web Attacks</div></div>
                        <div class="flow-box"><div class="flow-box-title">Zscaler</div><div class="flow-box-subtitle">Proxy Logs</div></div>
                    </div>
                    
                    <div class="flow-arrow down">↓ Syslog (UDP 514 / TCP 601 / TLS 6514)</div>
                    
                    <div class="flow-row centered">
                        <div class="flow-box success" style="min-width: 250px;">
                            <div class="flow-box-title">Broker VM</div>
                            <div class="flow-box-subtitle">On-Premises Collector</div>
                        </div>
                    </div>
                    
                    <div class="flow-arrow down">↓ HTTPS (Compressed, Encrypted)</div>
                    
                    <div class="flow-row centered">
                        <div class="flow-box primary" style="min-width: 250px;">
                            <div class="flow-box-title">XSIAM Cloud</div>
                            <div class="flow-box-subtitle">Data Lake</div>
                        </div>
                    </div>
                </div>

                <div class="enterprise-example">
                    <div class="enterprise-example-header">
                        <i class="fas fa-building"></i>
                        <div class="enterprise-example-title">Enterprise Example: Multi-Site Network Infrastructure</div>
                    </div>
                    <div class="enterprise-example-scenario">
                        <strong>Scenario:</strong> Global company with 3 data centers needs to collect firewall and proxy logs. Each site has Palo Alto firewalls and Zscaler proxy.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 16px;">
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #58a6ff; margin-top: 0;">Site: US-East</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                Broker VM: 8 vCPU, 16GB RAM<br>
                                Sources: 4x PA-5250, Zscaler<br>
                                Volume: ~15GB/day
                            </p>
                        </div>
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #58a6ff; margin-top: 0;">Site: EU-West</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                Broker VM: 8 vCPU, 16GB RAM<br>
                                Sources: 2x PA-3260, Zscaler<br>
                                Volume: ~10GB/day
                            </p>
                        </div>
                        <div style="background: #0d1117; border-radius: 8px; padding: 16px;">
                            <h4 style="color: #58a6ff; margin-top: 0;">Site: APAC</h4>
                            <p style="color: #8b949e; font-size: 0.85rem;">
                                Broker VM: 4 vCPU, 8GB RAM<br>
                                Sources: 2x PA-850, Proxy<br>
                                Volume: ~5GB/day
                            </p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 16px; padding: 12px; background: #161b22; border-radius: 8px;">
                        <p style="color: #8b949e; font-size: 0.85rem; margin: 0;">
                            <strong style="color: #3fb950;">Why Broker VM?</strong> Network devices can't push directly to cloud - they need local syslog target. 
                            Broker compresses and encrypts data, reducing bandwidth. Each site has local Broker for low-latency collection.
                            <br><br>
                            <strong style="color: #d29922;">Alternative considered:</strong> Direct Syslog to XSIAM cloud (Method 4) - rejected because firewalls are behind NAT and can't establish outbound connections to arbitrary cloud endpoints.
                        </p>
                    </div>
                </div>

                <!-- METHOD 3: CLOUD API -->
                <h2><i class="fas fa-cloud"></i> Method 3: Cloud API Collectors</h2>
                
                <div class="method-card">
                    <div class="method-card-header">
                        <div class="method-card-icon orange"><i class="fas fa-cloud"></i></div>
                        <div>
                            <div class="method-card-title">Cloud API Integration</div>
                            <div class="method-card-desc">XSIAM pulls logs directly from cloud service APIs</div>
                        </div>
                    </div>
                    <div class="method-card-content">
                        <div class="method-detail">
                            <div class="method-detail-label">Best For</div>
                            <div class="method-detail-value">SaaS apps, cloud infrastructure, identity providers</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">No Infrastructure</div>
                            <div class="method-detail-value">XSIAM cloud connects directly - no Broker needed</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Configuration</div>
                            <div class="method-detail-value">API credentials or OAuth app registration</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Latency</div>
                            <div class="method-detail-value">Minutes (depends on API polling interval)</div>
                        </div>
                    </div>
                </div>

                <!-- Supported Cloud Sources -->
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1c3a5e; color: #58a6ff;"><i class="fab fa-aws"></i></div>
                            <div class="comparison-item-title">AWS</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> CloudTrail (API activity)</li>
                            <li><i class="fas fa-check"></i> GuardDuty (threat detection)</li>
                            <li><i class="fas fa-check"></i> VPC Flow Logs</li>
                            <li><i class="fas fa-check"></i> Security Hub findings</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1a4d2e; color: #3fb950;"><i class="fab fa-microsoft"></i></div>
                            <div class="comparison-item-title">Azure / M365</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Azure Activity Logs</li>
                            <li><i class="fas fa-check"></i> Azure AD Sign-ins</li>
                            <li><i class="fas fa-check"></i> Office 365 Audit Logs</li>
                            <li><i class="fas fa-check"></i> Microsoft Defender</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #4d3a0d; color: #d29922;"><i class="fab fa-google"></i></div>
                            <div class="comparison-item-title">Google Cloud</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Cloud Audit Logs</li>
                            <li><i class="fas fa-check"></i> Workspace Activity</li>
                            <li><i class="fas fa-check"></i> Chronicle integration</li>
                            <li><i class="fas fa-check"></i> SCC findings</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #3d2a5e; color: #a371f7;"><i class="fas fa-id-card"></i></div>
                            <div class="comparison-item-title">Identity Providers</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-check"></i> Okta System Logs</li>
                            <li><i class="fas fa-check"></i> Duo Authentication</li>
                            <li><i class="fas fa-check"></i> Ping Identity</li>
                            <li><i class="fas fa-check"></i> OneLogin</li>
                        </ul>
                    </div>
                </div>

                <div class="enterprise-example">
                    <div class="enterprise-example-header">
                        <i class="fas fa-building"></i>
                        <div class="enterprise-example-title">Enterprise Example: Cloud-First Organization</div>
                    </div>
                    <div class="enterprise-example-scenario">
                        <strong>Scenario:</strong> SaaS company with AWS infrastructure, Okta SSO, and Microsoft 365 for productivity.
                    </div>
                    <div class="enterprise-example-flow">
                        <div class="flow-box warning"><div class="flow-box-title">AWS CloudTrail</div><div class="flow-box-subtitle">S3 + SQS</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box purple"><div class="flow-box-title">Okta</div><div class="flow-box-subtitle">System Log API</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box success"><div class="flow-box-title">O365</div><div class="flow-box-subtitle">Management API</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box primary"><div class="flow-box-title">XSIAM Cloud</div><div class="flow-box-subtitle">API Collectors</div></div>
                    </div>
                    <div style="margin-top: 16px; padding: 12px; background: #0d1117; border-radius: 8px;">
                        <p style="color: #8b949e; font-size: 0.85rem; margin: 0;">
                            <strong style="color: #3fb950;">Why Cloud API?</strong> All data sources are already in cloud - no on-prem infrastructure. 
                            API collectors are pre-built, just configure credentials. Lower operational overhead than maintaining Broker VMs.
                            <br><br>
                            <strong style="color: #58a6ff;">Setup steps:</strong><br>
                            1. AWS: Create IAM role with CloudTrail read permissions, configure SQS queue<br>
                            2. Okta: Create API token with read-only scope<br>
                            3. O365: Register Azure AD app with audit log permissions
                        </p>
                    </div>
                </div>

                <!-- INGESTION PIPELINE -->
                <h2><i class="fas fa-stream"></i> XSIAM Ingestion Pipeline</h2>
                <p>Once data arrives at XSIAM (via any method), it goes through a consistent processing pipeline:</p>

                <div class="pipeline">
                    <div class="pipeline-stage" data-step="1">
                        <div class="pipeline-stage-title">Source Identification</div>
                        <div class="pipeline-stage-desc">XSIAM identifies the log type and selects the appropriate parser</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>Match by port (e.g., UDP 514 = syslog)</li>
                                <li>Match by format signature (CEF, JSON, XML)</li>
                                <li>Match by API source (built-in collectors)</li>
                                <li>800+ built-in parsers available</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="2">
                        <div class="pipeline-stage-title">Parsing</div>
                        <div class="pipeline-stage-desc">Extract fields from raw log data using built-in or custom parsers</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>Regex-based field extraction</li>
                                <li>JSON/XML automatic parsing</li>
                                <li>Handle multi-line events</li>
                                <li>Timestamp normalization to UTC</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="3">
                        <div class="pipeline-stage-title">XDM Normalization</div>
                        <div class="pipeline-stage-desc">Map vendor-specific fields to standardized XDM schema</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>xdm.source.ipv4 = src_ip (Palo Alto)</li>
                                <li>xdm.target.user.username = Account_Name (Windows)</li>
                                <li>Enables cross-vendor correlation</li>
                                <li>Standard field names for all queries</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="4">
                        <div class="pipeline-stage-title">Enrichment</div>
                        <div class="pipeline-stage-desc">Add context from threat intelligence, geo-location, and asset data</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>Unit 42 threat intelligence</li>
                                <li>MaxMind geo-location</li>
                                <li>Asset criticality scores</li>
                                <li>User risk scores</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="5">
                        <div class="pipeline-stage-title">Storage (Data Lake)</div>
                        <div class="pipeline-stage-desc">Write to appropriate dataset for fast XQL queries</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>Dataset: panw_ngfw_traffic, okta_okta_raw, etc.</li>
                                <li>Indexed for sub-second queries</li>
                                <li>Compressed storage (typically 10:1)</li>
                                <li>Configurable retention per dataset</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: When would you use Broker VM vs Cloud API collector?</button>
                        <div class="qa-answer">
                            <p><strong>Use Broker VM when:</strong></p>
                            <ul>
                                <li>Data source only supports syslog output (firewalls, network devices)</li>
                                <li>Data source is on-premises and can't reach internet directly</li>
                                <li>You need to collect from file-based logs (local log files)</li>
                                <li>Data source doesn't have a native XSIAM collector</li>
                            </ul>
                            <p><strong>Use Cloud API when:</strong></p>
                            <ul>
                                <li>Data source is a cloud service with API (AWS, Azure, O365, Okta)</li>
                                <li>XSIAM has a built-in collector for that service</li>
                                <li>You want to minimize on-premises infrastructure</li>
                                <li>Data is already in cloud - no need to route through on-prem</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: How do you size a Broker VM for your environment?</button>
                        <div class="qa-answer">
                            <p><strong>Sizing considerations:</strong></p>
                            <ul>
                                <li><strong>Events Per Second (EPS):</strong> Primary sizing factor</li>
                                <li><strong>&lt;5,000 EPS:</strong> 4 vCPU, 8GB RAM</li>
                                <li><strong>5,000-15,000 EPS:</strong> 8 vCPU, 16GB RAM</li>
                                <li><strong>15,000-30,000 EPS:</strong> 16 vCPU, 32GB RAM</li>
                                <li><strong>&gt;30,000 EPS:</strong> Multiple Broker VMs with load balancing</li>
                            </ul>
                            <p><strong>Other factors:</strong></p>
                            <ul>
                                <li>Network bandwidth to XSIAM cloud</li>
                                <li>Number of unique log sources</li>
                                <li>Custom parsing complexity</li>
                                <li>Buffer storage for outage resilience</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: Explain XDM normalization and why it matters.</button>
                        <div class="qa-answer">
                            <p><strong>XDM (Cross Data Model)</strong> is XSIAM's schema normalization layer:</p>
                            <ul>
                                <li>Maps vendor-specific field names to standard fields</li>
                                <li>Example: Palo Alto "src" → xdm.source.ipv4</li>
                                <li>Example: Windows "Account_Name" → xdm.source.user.username</li>
                            </ul>
                            <p><strong>Why it matters:</strong></p>
                            <ul>
                                <li>Write one XQL query that works across all vendors</li>
                                <li>Correlation rules work regardless of data source</li>
                                <li>Dashboards show unified view</li>
                                <li>Reduces query complexity and maintenance</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <div class="footer-links">
                        <a href="../index.html">Home</a>
                        <a href="index.html">XSIAM</a>
                        <a href="parsing-flows.html">Parsing & XDM</a>
                    </div>
                    <p>Nik's SIEM Compendium</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
