<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSIAM Data Ingestion | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam active"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="../splunk/index.html" class="platform-tab splunk"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
<nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Ingestion</div>
                    <a href="data-ingestion.html" class="nav-link active"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention Tiers</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM Setup</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> XQL Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced XQL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="xdr-overview.html" class="nav-link"><i class="fas fa-shield-virus"></i> XDR Detection</a>
                    <a href="correlation-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> Correlation Rules</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Threat Intelligence</div>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intel</a>
                    <a href="recon-asm.html" class="nav-link"><i class="fas fa-globe"></i> Recon & ASM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> Platform Comparison</a>
                    <a href="enterprise-soc.html" class="nav-link"><i class="fas fa-building"></i> Enterprise SOC Ops</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Data Ingestion</span>
                </div>
                <div class="top-actions">
                    <button class="top-btn" onclick="window.print()"><i class="fas fa-print"></i> Print</button>
                </div>
            </header>
            <main class="main-content">
        <h1><i class="fas fa-database" style="color: var(--accent-xsiam);"></i> XSIAM Data Ingestion Complete Guide</h1>
        <p class="lead">100% comprehensive guide to ALL data ingestion methods in XSIAM: Brokers, collectors, APIs, parsing, XDM normalization, custom log ingestion, and detailed comparisons with Sentinel and Splunk.</p>
        <div class="warning-box">
            <strong>⚠️ Critical Differences from Traditional SIEMs</strong>
            <ul style="margin: 0.5rem 0;">
                <li><strong>XSIAM auto-parses 800+ log types</strong> - Unlike Splunk where you configure sourcetypes, parsing is mostly automatic</li>
                <li><strong>No index management</strong> - XSIAM uses "datasets" which are automatically created based on log type</li>
                <li><strong>Cloud-first ingestion</strong> - Direct cloud API collection is preferred over syslog forwarding</li>
                <li><strong>Normalization at ingestion</strong> - XDM fields are populated as data arrives, not at query time</li>
            </ul>
        </div>
        <!-- INGESTION METHODS OVERVIEW -->
        <h2><i class="fas fa-route"></i> Ingestion Methods Overview</h2>
        <div class="diagram-box">
XSIAM DATA INGESTION METHODS - COMPLETE OVERVIEW
═══════════════════════════════════════════════════════════════════════════════
┌─────────────────────────────────────────────────────────────────────────────┐
│                         DATA SOURCES                                         │
└─────────────────────────────────────────────────────────────────────────────┘
     │              │              │              │              │
     ▼              ▼              ▼              ▼              ▼
┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐
│Endpoints│   │ Network │   │  Cloud  │   │Identity │   │ Custom  │
│         │   │ Devices │   │ Services│   │ Sources │   │   Apps  │
└────┬────┘   └────┬────┘   └────┬────┘   └────┬────┘   └────┬────┘
     │              │              │              │              │
     │              │              │              │              │
═════╪══════════════╪══════════════╪══════════════╪══════════════╪═════════════
     │              │              │              │              │
     ▼              ▼              ▼              ▼              ▼
METHOD 1:          METHOD 2:         METHOD 3:         METHOD 4:         METHOD 5:
CORTEX AGENT       BROKER VM         CLOUD API         DIRECT SYSLOG    CUSTOM API
─────────────      ─────────         ─────────         ────────────     ──────────
┌─────────┐      ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────┐
│ Cortex  │      │  Broker VM  │   │ XSIAM Cloud │   │ XSIAM Cloud │   │  Your   │
│ Agent   │      │             │   │  Collector  │   │   Syslog    │   │  Code   │
│         │      │ • Syslog    │   │             │   │   Endpoint  │   │         │
│ Windows │      │ • CEF/LEEF  │   │ Pulls via   │   │             │   │ Push via│
│ Linux   │      │ • WEF       │   │ API from:   │   │ Receive:    │   │ Logs    │
│ macOS   │      │ • File tail │   │             │   │             │   │ Ingestion
│ Mobile  │      │ • DB logs   │   │ • AWS       │   │ • UDP 514   │   │ API     │
│         │      │             │   │ • Azure     │   │ • TCP 514   │   │         │
└────┬────┘      └──────┬──────┘   │ • GCP       │   │ • TLS 6514  │   └────┬────┘
     │                  │          │ • O365      │   │             │        │
     │                  │          │ • Okta      │   │ Cloud-hosted│        │
     │                  │          │ • SaaS      │   │ (no broker) │        │
     │                  │          └──────┬──────┘   └──────┬──────┘        │
     │                  │                 │                 │               │
     ▼                  ▼                 ▼                 ▼               ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         XSIAM INGESTION LAYER                                │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ 1. SOURCE IDENTIFICATION                                               │  │
│  │    • Identify log type by format signature, port, or API source       │  │
│  │    • Select appropriate parser from 800+ built-in parsers             │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                              │                                               │
│                              ▼                                               │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ 2. PARSING                                                             │  │
│  │    • Extract fields using built-in or custom parser                   │  │
│  │    • Handle multi-line events, timestamps, encodings                  │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                              │                                               │
│                              ▼                                               │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ 3. XDM NORMALIZATION                                                   │  │
│  │    • Map vendor-specific fields to XDM schema                         │  │
│  │    • Enable cross-vendor queries with standard field names            │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                              │                                               │
│                              ▼                                               │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ 4. ENRICHMENT                                                          │  │
│  │    • Add threat intel (Unit 42)                                       │  │
│  │    • Add geo-location                                                 │  │
│  │    • Add asset context                                                │  │
│  │    • Calculate risk scores                                            │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                              │                                               │
│                              ▼                                               │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ 5. STORAGE (Data Lake)                                                 │  │
│  │    • Write to appropriate dataset (e.g., panw_ngfw_traffic)           │  │
│  │    • Indexed for fast XQL queries                                     │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
        </div>
        <!-- INGESTION METHOD DETAILS -->
        <h2><i class="fas fa-plug"></i> Ingestion Methods in Detail</h2>
        <h3>Method 1: Cortex XDR Agent (Endpoint Telemetry)</h3>
        <div class="component-card">
            <h4>What It Collects</h4>
            <p>The Cortex agent provides rich endpoint telemetry similar to Sysmon but with built-in prevention.</p>
            <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                <li><strong>Process Events:</strong> Creation, termination, command lines, parent/child relationships</li>
                <li><strong>File Events:</strong> Create, modify, delete, rename with hash values</li>
                <li><strong>Network Events:</strong> Connections, DNS queries, with process context</li>
                <li><strong>Registry Events:</strong> Key/value changes (Windows)</li>
                <li><strong>Authentication Events:</strong> Local and domain logons</li>
                <li><strong>Module Loads:</strong> DLL/SO loading with signatures</li>
            </ul>
        </div>
        <div class="diagram-box">
CORTEX AGENT DATA FLOW
═══════════════════════════════════════════════════════════════════════════════
┌─────────────────────────────────────────────────────────────────────────────┐
│                              ENDPOINT                                        │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        CORTEX XDR AGENT                              │   │
│  │                                                                      │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                  │   │
│  │  │  Endpoint   │  │  Prevention │  │  Response   │                  │   │
│  │  │  Telemetry  │  │   Engine    │  │   Actions   │                  │   │
│  │  │             │  │             │  │             │                  │   │
│  │  │ • Process   │  │ • Malware   │  │ • Isolate   │                  │   │
│  │  │ • File      │  │ • Exploit   │  │ • Quarantine│                  │   │
│  │  │ • Network   │  │ • Ransomware│  │ • Kill proc │                  │   │
│  │  │ • Registry  │  │ • Behavior  │  │ • Remediate │                  │   │
│  │  └──────┬──────┘  └─────────────┘  └─────────────┘                  │   │
│  │         │                                                            │   │
│  │         │  Compressed, encrypted stream                              │   │
│  └─────────┼────────────────────────────────────────────────────────────┘   │
│            │                                                                 │
└────────────┼─────────────────────────────────────────────────────────────────┘
             │
             │  HTTPS (443)
             │  Persistent connection
             │
             ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            XSIAM CLOUD                                       │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                      XDR DATA PROCESSOR                              │   │
│  │                                                                      │   │
│  │  • Decompress and decrypt                                           │   │
│  │  • Apply XDM normalization                                          │   │
│  │  • Run BIOC rules in real-time                                      │   │
│  │  • Store in xdr_data dataset                                        │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  DATASETS CREATED:                                                          │
│  ├── xdr_data                    (all endpoint events)                      │
│  ├── xdr_process_events          (process creation)                         │
│  ├── xdr_file_events             (file operations)                          │
│  ├── xdr_network_events          (network connections)                      │
│  └── xdr_alerts                  (prevention/detection alerts)              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
AGENT DEPLOYMENT OPTIONS:
─────────────────────────────────────────────────────────────────────────────
┌──────────────────────┬──────────────────────────────────────────────────────┐
│ Platform             │ Installation Method                                  │
├──────────────────────┼──────────────────────────────────────────────────────┤
│ Windows              │ MSI installer, SCCM, GPO, Intune                    │
│ Linux                │ RPM/DEB packages, Ansible, Puppet                    │
│ macOS                │ PKG installer, Jamf, Kandji                          │
│ Android              │ MDM deployment, Google Play                          │
│ iOS                  │ MDM deployment, App Store                            │
│ Kubernetes           │ DaemonSet deployment                                 │
└──────────────────────┴──────────────────────────────────────────────────────┘
        </div>
        <h3>Method 2: Broker VM (On-Premises Collection)</h3>
        <div class="component-card">
            <h4>What It Collects</h4>
            <p>Broker VM is an on-premises collector for logs that can't go directly to cloud.</p>
            <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                <li><strong>Syslog (UDP/TCP 514):</strong> Firewalls, switches, routers, Linux servers</li>
                <li><strong>CEF/LEEF:</strong> Security products using Common Event Format</li>
                <li><strong>Windows Event Forwarding:</strong> Windows events via WEF subscription</li>
                <li><strong>File Monitoring:</strong> Tail log files from applications</li>
                <li><strong>Database Logs:</strong> Oracle, SQL Server audit logs</li>
            </ul>
        </div>
        <div class="diagram-box">
BROKER VM CONFIGURATION EXAMPLES
═══════════════════════════════════════════════════════════════════════════════
SCENARIO 1: PALO ALTO FIREWALL → BROKER VM → XSIAM
─────────────────────────────────────────────────────────────────────────────
  Step 1: Configure Firewall to send syslog
  ┌─────────────────────────────────────────────────────────────────────────┐
  │ Firewall CLI:                                                           │
  │                                                                         │
  │ > set deviceconfig system syslog-server-profile xsiam-broker           │
  │   server xsiam-broker server 10.0.0.50                                 │
  │   transport TCP                                                        │
  │   port 514                                                             │
  │   format BSD                                                           │
  │                                                                         │
  │ > set deviceconfig system log-settings <log-type>                      │
  │   send-syslog xsiam-broker                                             │
  └─────────────────────────────────────────────────────────────────────────┘
  Step 2: Broker VM automatically:
  • Receives syslog on TCP 514
  • Identifies as "panw_ngfw" log type
  • Forwards to XSIAM cloud
  • XSIAM parses and stores in panw_ngfw_traffic/panw_ngfw_threat datasets
SCENARIO 2: WINDOWS EVENT FORWARDING → BROKER VM → XSIAM  
─────────────────────────────────────────────────────────────────────────────
  Step 1: Configure Windows Event Collector on Broker VM
  ┌─────────────────────────────────────────────────────────────────────────┐
  │ On Broker VM (Windows):                                                 │
  │                                                                         │
  │ # Enable Windows Remote Management                                      │
  │ winrm quickconfig                                                       │
  │                                                                         │
  │ # Create subscription (via Event Viewer or wecutil)                     │
  │ wecutil cs subscription.xml                                             │
  └─────────────────────────────────────────────────────────────────────────┘
  Step 2: Configure source computers via GPO
  ┌─────────────────────────────────────────────────────────────────────────┐
  │ GPO: Computer Configuration → Administrative Templates →               │
  │      Windows Components → Event Forwarding                             │
  │                                                                         │
  │ Configure target Subscription Manager:                                  │
  │   Server=http://broker-vm.domain.com:5985/wsman/SubscriptionManager    │
  └─────────────────────────────────────────────────────────────────────────┘
  Step 3: Broker VM forwards to XSIAM
  • Events collected via WEF
  • Forwarded to XSIAM cloud
  • Parsed and stored in windows_event_logs dataset
SCENARIO 3: CUSTOM APPLICATION LOGS → BROKER VM → XSIAM
─────────────────────────────────────────────────────────────────────────────
  Step 1: Configure file monitoring on Broker VM
  ┌─────────────────────────────────────────────────────────────────────────┐
  │ Broker configuration (via XSIAM console):                               │
  │                                                                         │
  │ Data Sources → Broker VM → Add Dataset                                 │
  │                                                                         │
  │ • Source Type: File                                                     │
  │ • File Path: /var/log/myapp/application.log                            │
  │ • Dataset Name: custom_myapp                                           │
  │ • Log Format: Custom (provide sample)                                  │
  └─────────────────────────────────────────────────────────────────────────┘
  Step 2: Define custom parser (if needed)
  • If XSIAM can't auto-parse, create custom parsing rules
  • Map fields to XDM schema for normalization
        </div>
        <h3>Method 3: Cloud API Collectors (Native Integrations)</h3>
        <div class="component-card">
            <h4>What It Collects</h4>
            <p>Built-in collectors that pull logs from cloud services via API - no broker needed.</p>
        </div>
        <table>
            <thead>
                <tr><th>Cloud Service</th><th>Dataset Name</th><th>Log Types</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>AWS CloudTrail</strong></td>
                    <td>aws_cloudtrail</td>
                    <td>API calls, management events, S3 data events</td>
                </tr>
                <tr>
                    <td><strong>Azure Activity</strong></td>
                    <td>azure_activity</td>
                    <td>Azure management plane operations</td>
                </tr>
                <tr>
                    <td><strong>Azure AD / Entra ID</strong></td>
                    <td>azure_ad_signin, azure_ad_audit</td>
                    <td>Sign-ins, directory changes, MFA</td>
                </tr>
                <tr>
                    <td><strong>GCP Cloud Audit</strong></td>
                    <td>gcp_audit</td>
                    <td>Admin activity, data access</td>
                </tr>
                <tr>
                    <td><strong>Microsoft 365</strong></td>
                    <td>office365_*</td>
                    <td>Exchange, SharePoint, Teams, DLP</td>
                </tr>
                <tr>
                    <td><strong>Okta</strong></td>
                    <td>okta_*</td>
                    <td>Authentication, admin actions</td>
                </tr>
                <tr>
                    <td><strong>Google Workspace</strong></td>
                    <td>google_workspace_*</td>
                    <td>Login, admin, Drive, Gmail</td>
                </tr>
            </tbody>
        </table>
        <div class="diagram-box">
CLOUD API COLLECTION SETUP EXAMPLE: AWS CLOUDTRAIL
═══════════════════════════════════════════════════════════════════════════════
ARCHITECTURE:
─────────────────────────────────────────────────────────────────────────────
┌─────────────────────────────────────────────────────────────────────────────┐
│                              AWS ACCOUNT                                     │
│                                                                              │
│  ┌───────────────┐      ┌───────────────┐      ┌───────────────┐           │
│  │  CloudTrail   │      │     S3        │      │     IAM       │           │
│  │   (Logging)   │ ───► │    Bucket     │      │     Role      │           │
│  │               │      │               │      │               │           │
│  │ • API calls   │      │ Stores logs   │      │ Trust: XSIAM  │           │
│  │ • Management  │      │ JSON format   │      │ Policy: S3    │           │
│  │ • Data events │      │               │      │   Read access │           │
│  └───────────────┘      └───────┬───────┘      └───────┬───────┘           │
│                                 │                       │                   │
└─────────────────────────────────┼───────────────────────┼───────────────────┘
                                  │                       │
                                  │   AssumeRole          │
                                  │                       │
                                  ▼                       ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            XSIAM CLOUD                                       │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                     AWS CLOUDTRAIL COLLECTOR                          │  │
│  │                                                                       │  │
│  │  1. Assume IAM Role (cross-account)                                  │  │
│  │  2. List S3 bucket for new CloudTrail logs                           │  │
│  │  3. Download and decompress logs                                      │  │
│  │  4. Parse JSON CloudTrail format                                      │  │
│  │  5. Apply XDM normalization                                          │  │
│  │  6. Store in aws_cloudtrail dataset                                  │  │
│  │                                                                       │  │
│  │  Poll interval: 5-15 minutes (configurable)                          │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
SETUP STEPS:
─────────────────────────────────────────────────────────────────────────────
1. In AWS: Create IAM Role with trust policy for XSIAM
   ┌─────────────────────────────────────────────────────────────────────────┐
   │ {                                                                       │
   │   "Version": "2012-10-17",                                             │
   │   "Statement": [{                                                       │
   │     "Effect": "Allow",                                                  │
   │     "Principal": {                                                      │
   │       "AWS": "arn:aws:iam::<XSIAM_ACCOUNT_ID>:root"                    │
   │     },                                                                  │
   │     "Action": "sts:AssumeRole",                                        │
   │     "Condition": {                                                      │
   │       "StringEquals": {                                                 │
   │         "sts:ExternalId": "<YOUR_EXTERNAL_ID>"                         │
   │       }                                                                 │
   │     }                                                                   │
   │   }]                                                                    │
   │ }                                                                       │
   └─────────────────────────────────────────────────────────────────────────┘
2. In AWS: Attach S3 read policy to the role
3. In XSIAM: Configuration → Data Sources → Add Data Source
   • Select "AWS CloudTrail"
   • Enter Role ARN and External ID
   • Enter S3 bucket name
   • Test connection and enable
        </div>
        <!-- COMPARISON: INGESTION METHODS -->
        <h2><i class="fas fa-balance-scale"></i> Ingestion Methods Comparison: XSIAM vs Sentinel vs Splunk</h2>
        <div class="diagram-box">
INGESTION ARCHITECTURE COMPARISON
═══════════════════════════════════════════════════════════════════════════════
                    XSIAM                    SENTINEL                   SPLUNK
                    ─────                    ────────                   ──────
ENDPOINT:           Cortex Agent             MDE + AMA                  UF + TA-windows
                        │                        │                          │
                    Direct to cloud          Direct to Azure            To Indexer
                        │                        │                          │
                        ▼                        ▼                          ▼
                   [XSIAM Cloud]           [Log Analytics]            [Indexer Cluster]
SYSLOG:            Broker VM                Log Forwarder VM          Heavy Forwarder
                   (Palo Alto VM)           (Linux + AMA)             (Full Splunk)
                        │                        │                          │
                   Minimal parsing          DCR transforms             Full parsing
                        │                        │                          │
                        ▼                        ▼                          ▼
                   [XSIAM Cloud]           [Log Analytics]            [Indexer Cluster]
CLOUD LOGS:        Native API              Native API                 Add-ons (TA)
                   Collectors               Connectors                 or HEC
                        │                        │                          │
                   Built-in                 Built-in                   Configure TA
                        │                        │                          │
                        ▼                        ▼                          ▼
                   [Data Lake]             [Log Analytics]            [Indexer Cluster]
CUSTOM LOGS:       Logs Ingestion API      Logs Ingestion API        HEC or 
                   + Custom Parser          + DCR Transform            Custom TA
                        │                        │                          │
                   Define in UI            KQL transforms             props.conf
                        │                        │                          │
                        ▼                        ▼                          ▼
                   [custom_* dataset]      [CustomLog_CL table]       [custom index]
KEY DIFFERENCES:
═══════════════════════════════════════════════════════════════════════════════
┌────────────────────┬───────────────────┬───────────────────┬─────────────────┐
│ Aspect             │ XSIAM             │ Sentinel          │ Splunk          │
├────────────────────┼───────────────────┼───────────────────┼─────────────────┤
│ Parsing Location   │ Cloud (XSIAM)     │ DCR (ingest) or   │ Forwarder or    │
│                    │                   │ Query time        │ Indexer         │
├────────────────────┼───────────────────┼───────────────────┼─────────────────┤
│ Parser Config      │ 800+ built-in     │ Data Connectors   │ TAs + props.conf│
│                    │ Auto-detect       │ + Custom DCRs     │ Manual config   │
├────────────────────┼───────────────────┼───────────────────┼─────────────────┤
│ Normalization      │ XDM (at ingest)   │ ASIM (query time) │ CIM (search time│
│                    │                   │                   │ with data models│
├────────────────────┼───────────────────┼───────────────────┼─────────────────┤
│ On-Prem Component  │ Broker VM         │ Log Forwarder VM  │ UF, HF, Indexer │
├────────────────────┼───────────────────┼───────────────────┼─────────────────┤
│ Custom Log Effort  │ Low-Medium        │ Medium            │ High            │
│                    │ (UI-based parser) │ (DCR + KQL)       │ (props/trans)   │
├────────────────────┼───────────────────┼───────────────────┼─────────────────┤
│ Agent Required     │ Cortex Agent      │ AMA (optional MDE)│ Universal Fwd   │
└────────────────────┴───────────────────┴───────────────────┴─────────────────┘
        </div>
        <div class="comparison-grid">
            <div class="comparison-item xsiam">
                <h4><i class="fas fa-fire"></i> XSIAM Ingestion</h4>
                <ul>
                    <li>Auto-parsing for 800+ log types</li>
                    <li>Minimal on-prem component (Broker VM)</li>
                    <li>XDM normalization at ingestion</li>
                    <li>Single agent for endpoint + prevention</li>
                    <li>Native Palo Alto ecosystem integration</li>
                </ul>
                <p><strong>Best for:</strong> Palo Alto shops wanting simplicity</p>
            </div>
            <div class="comparison-item sentinel">
                <h4><i class="fas fa-shield-alt"></i> Sentinel Ingestion</h4>
                <ul>
                    <li>Data Connectors + Content Hub</li>
                    <li>DCR transforms at ingestion</li>
                    <li>ASIM normalization at query time</li>
                    <li>Azure-native, M365 integration</li>
                    <li>Flexible storage tiers</li>
                </ul>
                <p><strong>Best for:</strong> Microsoft shops, Azure-centric</p>
            </div>
            <div class="comparison-item splunk">
                <h4><i class="fas fa-search"></i> Splunk Ingestion</h4>
                <ul>
                    <li>Technology Add-ons (TAs)</li>
                    <li>Full control via props/transforms</li>
                    <li>CIM normalization at search time</li>
                    <li>On-prem, cloud, or hybrid</li>
                    <li>Massive TA ecosystem</li>
                </ul>
                <p><strong>Best for:</strong> Maximum flexibility, on-prem needs</p>
            </div>
        </div>
        <!-- PARSING DEEP DIVE -->
        <h2><i class="fas fa-code"></i> Parsing Deep Dive</h2>
        <h3>How XSIAM Auto-Parsing Works</h3>
        <div class="diagram-box">
XSIAM AUTO-PARSING DECISION FLOW
═══════════════════════════════════════════════════════════════════════════════
                              ┌────────────────────┐
                              │   Raw Log Arrives  │
                              └─────────┬──────────┘
                                        │
                              ┌─────────▼──────────┐
                              │  Check Ingest      │
                              │  Method/Port       │
                              └─────────┬──────────┘
                                        │
              ┌─────────────────────────┼─────────────────────────┐
              │                         │                         │
              ▼                         ▼                         ▼
     ┌────────────────┐       ┌────────────────┐       ┌────────────────┐
     │  Syslog/CEF    │       │  API Collector │       │  Custom Dataset│
     │  Port 514      │       │  (Known format)│       │  (User-defined)│
     └───────┬────────┘       └───────┬────────┘       └───────┬────────┘
             │                         │                         │
             ▼                         ▼                         ▼
     ┌────────────────┐       ┌────────────────┐       ┌────────────────┐
     │ Pattern Match  │       │ Use pre-built  │       │ Use custom     │
     │ Header/Vendor  │       │ API parser     │       │ parser config  │
     └───────┬────────┘       └───────┬────────┘       └───────┬────────┘
             │                         │                         │
             ▼                         │                         │
     ┌────────────────┐                │                         │
     │ Match found?   │                │                         │
     └───────┬────────┘                │                         │
             │                         │                         │
      ┌──────┴──────┐                  │                         │
      ▼             ▼                  │                         │
  ┌───────┐    ┌───────────┐           │                         │
  │  YES  │    │    NO     │           │                         │
  └───┬───┘    └─────┬─────┘           │                         │
      │              │                 │                         │
      ▼              ▼                 │                         │
┌──────────┐  ┌────────────────┐       │                         │
│ Use      │  │ Store as       │       │                         │
│ matching │  │ "generic" with │       │                         │
│ parser   │  │ raw text only  │       │                         │
└────┬─────┘  └───────┬────────┘       │                         │
     │                │                │                         │
     └────────────────┼────────────────┼─────────────────────────┘
                      │                │
                      ▼                ▼
             ┌─────────────────────────────────┐
             │     PARSING ENGINE              │
             │                                 │
             │  1. Timestamp extraction        │
             │  2. Field extraction (regex)    │
             │  3. Data type conversion        │
             │  4. XDM field mapping           │
             └─────────────────────────────────┘
COMMON PARSER SIGNATURES (How XSIAM identifies log types):
─────────────────────────────────────────────────────────────────────────────
┌────────────────────────┬────────────────────────────────────────────────────┐
│ Log Type               │ Identification Pattern                             │
├────────────────────────┼────────────────────────────────────────────────────┤
│ Palo Alto NGFW         │ CEF:0|PaloAltoNetworks|PAN-OS                     │
│ Cisco ASA              │ %ASA-\d-\d+:                                       │
│ Fortinet FortiGate     │ logid=\d+ type=\w+                                │
│ Windows Event Log      │ <Event xmlns=                                      │
│ Linux Syslog           │ <facility>.<priority> timestamp hostname          │
│ AWS CloudTrail         │ {"eventVersion":"1.*","userIdentity":             │
│ Azure Activity         │ {"time":".*","resourceId":                         │
└────────────────────────┴────────────────────────────────────────────────────┘
        </div>
        <h3>Custom Parser Configuration</h3>
        <p>When XSIAM can't auto-parse your logs, you can create custom parsers:</p>
        <div class="diagram-box">
CUSTOM PARSER EXAMPLE: Application Audit Logs
═══════════════════════════════════════════════════════════════════════════════
SAMPLE LOG FORMAT:
─────────────────────────────────────────────────────────────────────────────
2025-01-15T10:30:45.123Z|INFO|UserService|user=jsmith|action=login|ip=10.0.0.50|result=success|duration=234ms
2025-01-15T10:30:46.456Z|ERROR|AuthService|user=asmith|action=login|ip=10.0.0.51|result=failure|reason=invalid_password
STEP 1: DEFINE DATASET
─────────────────────────────────────────────────────────────────────────────
In XSIAM Console: Configuration → Data Sources → Add Custom Dataset
  Dataset Name: custom_myapp_audit
  Description: MyApp application audit logs
  Collection Method: Broker VM / File monitoring
STEP 2: CREATE PARSING RULES
─────────────────────────────────────────────────────────────────────────────
Parsing Configuration (XSIAM Parser DSL - simplified example):
  # Timestamp extraction
  timestamp_pattern: "^(?P<_time>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)"
  timestamp_format: "ISO8601"
  # Field extraction using regex
  fields:
    - name: log_level
      pattern: "\|(?P<log_level>INFO|WARN|ERROR|DEBUG)\|"
    - name: service
      pattern: "\|(INFO|WARN|ERROR|DEBUG)\|(?P<service>\w+)\|"
    - name: user
      pattern: "user=(?P<user>\w+)"
    - name: action
      pattern: "action=(?P<action>\w+)"
    - name: source_ip
      pattern: "ip=(?P<source_ip>\d+\.\d+\.\d+\.\d+)"
    - name: result
      pattern: "result=(?P<result>\w+)"
    - name: duration_ms
      pattern: "duration=(?P<duration_ms>\d+)ms"
      type: integer
    - name: failure_reason
      pattern: "reason=(?P<failure_reason>\w+)"
STEP 3: XDM MAPPING
─────────────────────────────────────────────────────────────────────────────
Map custom fields to XDM schema for normalization:
  xdm_mapping:
    source_ip     → xdm.source.ipv4
    user          → xdm.source.user.username
    action        → xdm.event.type
    result        → xdm.outcome.result
    log_level     → xdm.alert.severity
    service       → xdm.source.application.name
    _time         → xdm.event.timestamp
STEP 4: VERIFY
─────────────────────────────────────────────────────────────────────────────
Query to verify parsing:
  dataset = custom_myapp_audit
  | fields _time, log_level, service, user, action, source_ip, result
  | limit 10
Expected output:
┌────────────────────────┬───────────┬─────────────┬────────┬────────┬────────────┬─────────┐
│ _time                  │ log_level │ service     │ user   │ action │ source_ip  │ result  │
├────────────────────────┼───────────┼─────────────┼────────┼────────┼────────────┼─────────┤
│ 2025-01-15T10:30:45.123│ INFO      │ UserService │ jsmith │ login  │ 10.0.0.50  │ success │
│ 2025-01-15T10:30:46.456│ ERROR     │ AuthService │ asmith │ login  │ 10.0.0.51  │ failure │
└────────────────────────┴───────────┴─────────────┴────────┴────────┴────────────┴─────────┘
        </div>
        <!-- XDM NORMALIZATION -->
        <h2><i class="fas fa-project-diagram"></i> XDM Normalization Deep Dive</h2>
        <div class="interview-box">
            <h4><i class="fas fa-user-tie"></i> Interview Question: "Explain the difference between XDM, ASIM, and CIM"</h4>
            <p><strong>Answer:</strong> "All three are schema normalization frameworks, but they differ in when and how they apply:</p>
            <ul style="margin: 0.5rem 0 0.5rem 1.5rem;">
                <li><strong>XDM (XSIAM):</strong> Normalizes at ingestion time. Fields are mapped when data arrives, stored alongside raw data. Queries always have normalized fields available without extra processing.</li>
                <li><strong>ASIM (Sentinel):</strong> Normalizes at query time using KQL parser functions. Raw data is stored unchanged. You invoke ASIM parsers in queries like <code>_Im_NetworkSession</code> to get normalized fields.</li>
                <li><strong>CIM (Splunk):</strong> Normalizes at search time using data models and field aliases. TAs define field mappings in props.conf. You use <code>| datamodel</code> or accelerated data models for normalized searches.</li>
            </ul>
            <p>The trade-off: XDM uses slightly more storage but faster queries. ASIM/CIM are more flexible but add query-time overhead."</p>
        </div>
        <div class="diagram-box">
XDM vs ASIM vs CIM: PRACTICAL EXAMPLE
═══════════════════════════════════════════════════════════════════════════════
SCENARIO: Query all network connections to port 22 across multiple firewalls
          (Palo Alto, Cisco ASA, Fortinet)
XSIAM (XDM) - Normalized at ingestion:
─────────────────────────────────────────────────────────────────────────────
  // One query works for ALL firewall vendors
  // XDM fields already populated
  dataset in (panw_ngfw_traffic, cisco_asa_traffic, fortinet_traffic)
  | filter xdm.target.port = 22
  | fields _time, xdm.source.ipv4, xdm.target.ipv4, xdm.outcome.action
SENTINEL (ASIM) - Normalized at query time:
─────────────────────────────────────────────────────────────────────────────
  // Use ASIM parser function to normalize
  // Parser applies transformations at runtime
  _Im_NetworkSession
  | where DstPortNumber == 22
  | project TimeGenerated, SrcIpAddr, DstIpAddr, DvcAction
  // Behind the scenes, _Im_NetworkSession:
  // 1. Unions all network session tables
  // 2. Applies field mappings for each source
  // 3. Returns normalized schema
SPLUNK (CIM) - Normalized at search time:
─────────────────────────────────────────────────────────────────────────────
  // Option 1: Use data model (if accelerated)
  | tstats count from datamodel=Network_Traffic.All_Traffic 
    where All_Traffic.dest_port=22 by All_Traffic.src, All_Traffic.dest
  // Option 2: Search with CIM field names (slower)
  index=firewall (sourcetype=pan:traffic OR sourcetype=cisco:asa OR sourcetype=fortinet)
  | where dest_port=22
  | table _time, src, dest, action
  // CIM fields come from TA configurations:
  // - TA-paloalto: FIELDALIAS-dest_port = dport AS dest_port
  // - TA-cisco-asa: FIELDALIAS-dest_port = destination_port AS dest_port
PERFORMANCE COMPARISON:
─────────────────────────────────────────────────────────────────────────────
┌───────────────┬─────────────┬─────────────┬─────────────────────────────────┐
│ Platform      │ Query Speed │ Storage     │ Notes                           │
├───────────────┼─────────────┼─────────────┼─────────────────────────────────┤
│ XSIAM (XDM)   │ Fastest     │ Higher      │ No runtime transformation       │
│ Sentinel ASIM │ Medium      │ Lower       │ Parser overhead at query time   │
│ Splunk CIM    │ Varies*     │ Lowest**    │ *Fast with accelerated models   │
│               │             │             │ **Without acceleration          │
└───────────────┴─────────────┴─────────────┴─────────────────────────────────┘
        </div>
        <!-- DATASETS REFERENCE -->
        <h2><i class="fas fa-table"></i> Common XSIAM Datasets Reference</h2>
        <table>
            <thead>
                <tr><th>Dataset Name</th><th>Source</th><th>Key XDM Fields</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>xdr_data</code></td>
                    <td>Cortex XDR Agent (all events)</td>
                    <td>xdm.source.process.*, xdm.target.file.*, xdm.source.user.*</td>
                </tr>
                <tr>
                    <td><code>panw_ngfw_traffic</code></td>
                    <td>Palo Alto Firewall - Traffic</td>
                    <td>xdm.source.ipv4, xdm.target.ipv4, xdm.network.application</td>
                </tr>
                <tr>
                    <td><code>panw_ngfw_threat</code></td>
                    <td>Palo Alto Firewall - Threat</td>
                    <td>xdm.alert.name, xdm.alert.severity, xdm.source.ipv4</td>
                </tr>
                <tr>
                    <td><code>azure_ad_signin</code></td>
                    <td>Azure AD / Entra ID Sign-ins</td>
                    <td>xdm.source.user.username, xdm.auth.outcome, xdm.source.ipv4</td>
                </tr>
                <tr>
                    <td><code>aws_cloudtrail</code></td>
                    <td>AWS CloudTrail</td>
                    <td>xdm.source.user.username, xdm.event.type, xdm.target.resource.*</td>
                </tr>
                <tr>
                    <td><code>office365_*</code></td>
                    <td>Microsoft 365 (various)</td>
                    <td>xdm.source.user.username, xdm.event.type, xdm.target.file.*</td>
                </tr>
                <tr>
                    <td><code>okta_*</code></td>
                    <td>Okta Authentication</td>
                    <td>xdm.auth.*, xdm.source.user.*, xdm.source.ipv4</td>
                </tr>
            </tbody>
        </table>
        <!-- TROUBLESHOOTING -->
        <h2><i class="fas fa-bug"></i> Data Ingestion Troubleshooting</h2>
        <div class="diagram-box">
XSIAM INGESTION TROUBLESHOOTING FLOWCHART
═══════════════════════════════════════════════════════════════════════════════
SYMPTOM: Data not appearing in XSIAM
─────────────────────────────────────────────────────────────────────────────
                              ┌─────────────────────┐
                              │  Check Data Source  │
                              │    Configuration    │
                              └──────────┬──────────┘
                                         │
               ┌─────────────────────────┼─────────────────────────┐
               │                         │                         │
               ▼                         ▼                         ▼
        ┌─────────────┐         ┌─────────────────┐       ┌─────────────────┐
        │ Cortex Agent│         │    Broker VM    │       │  Cloud API      │
        │  (Endpoint) │         │   (Syslog/CEF)  │       │   Collector     │
        └──────┬──────┘         └────────┬────────┘       └────────┬────────┘
               │                         │                         │
               ▼                         ▼                         ▼
        ┌─────────────┐         ┌─────────────────┐       ┌─────────────────┐
        │ Agent       │         │ Broker VM       │       │ API connection  │
        │ connected?  │         │ reachable?      │       │ working?        │
        │             │         │                 │       │                 │
        │ Check:      │         │ Check:          │       │ Check:          │
        │ • Agent UI  │         │ • SSH access    │       │ • Test button   │
        │ • Heartbeat │         │ • Port 514 open │       │ • Error logs    │
        │   in console│         │ • Logs arriving │       │ • Credentials   │
        └──────┬──────┘         └────────┬────────┘       └────────┬────────┘
               │                         │                         │
               ▼                         ▼                         ▼
        ┌─────────────────────────────────────────────────────────────────────┐
        │                    COMMON ISSUES & SOLUTIONS                         │
        ├─────────────────────────────────────────────────────────────────────┤
        │                                                                      │
        │ AGENT ISSUES:                                                        │
        │ • "Not connected" → Check firewall rules for *.paloaltonetworks.com │
        │ • "Not sending data" → Verify agent policy allows telemetry         │
        │ • "Wrong tenant" → Check tenant ID in agent config                  │
        │                                                                      │
        │ BROKER VM ISSUES:                                                    │
        │ • "No logs received" → Verify source is sending to correct IP/port  │
        │ • "Logs stuck" → Check Broker VM disk space (full = stuck)          │
        │ • "Cloud connection failed" → Verify HTTPS 443 outbound allowed     │
        │                                                                      │
        │ CLOUD API ISSUES:                                                    │
        │ • "Authentication failed" → Rotate/verify API credentials           │
        │ • "No data" → Check source API has data (e.g., CloudTrail enabled?) │
        │ • "Partial data" → Verify permissions include all log types         │
        │                                                                      │
        │ PARSING ISSUES:                                                      │
        │ • "Data arrives but wrong dataset" → Check log format signature     │
        │ • "Fields not extracted" → May need custom parser                   │
        │ • "Timestamps wrong" → Verify timezone configuration                │
        │                                                                      │
        └─────────────────────────────────────────────────────────────────────┘
DIAGNOSTIC QUERIES:
─────────────────────────────────────────────────────────────────────────────
// Check if ANY data is arriving from a source
dataset = *
| filter _time > now() - 1h
| comp count() by _dataset
| sort desc count
// Check specific dataset
dataset = panw_ngfw_traffic
| filter _time > now() - 1h
| comp count() by _time = 1h
// Check for parsing errors (data in generic dataset)
dataset = generic_logs
| filter _time > now() - 24h
| fields _raw, _time
| limit 100
// Check agent connectivity
dataset = xdr_data
| filter event_type = AGENT_HEARTBEAT
| filter _time > now() - 1h
| comp count() by host_name
        </div>
        <div class="tip-box">
            <strong><i class="fas fa-lightbulb"></i> Pro Tips for Successful Ingestion</strong>
            <ul>
                <li><strong>Start with built-in connectors:</strong> Use native integrations before trying Broker VM</li>
                <li><strong>Test in small batches:</strong> Enable one log source at a time, verify before adding more</li>
                <li><strong>Check the Health Dashboard:</strong> XSIAM has built-in ingestion health monitoring</li>
                <li><strong>Use the correct log format:</strong> If you have options (JSON vs syslog), JSON parses better</li>
                <li><strong>Monitor data volumes:</strong> Unexpected spikes may indicate misconfiguration or attacks</li>
            </ul>
        </div>
        <!-- LINKS -->
        <h2><i class="fas fa-link"></i> Related Topics</h2>
        <ul>
            <li><a href="architecture.html" style="color: var(--accent-primary);">Architecture Overview</a> - Complete architecture explanation</li>
            <li><a href="xql-fundamentals.html" style="color: var(--accent-primary);">XQL Fundamentals</a> - Query the data you've ingested</li>
            <li><a href="comparison.html" style="color: var(--accent-primary);">Platform Comparison</a> - Detailed XSIAM vs Sentinel vs Splunk</li>
        </ul>
            </main>
            <footer class="main-footer">
                <p>Nik's SIEM - Security Operations Knowledge Base</p>
                <p>Created for interview preparation and operational reference</p>
            </footer>
        </div>
    </div>
    <script src="../assets/js/main.js"></script>
</body>
</html>
