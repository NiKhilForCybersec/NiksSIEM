<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Ingestion | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
                <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link active"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>



        
    <div class="main-wrapper" id="mainWrapper">
        <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu"><i class="fas fa-bars"></i></button>
        
        <main class="main-content">
            <div class="breadcrumb">
                <a href="../index.html">Home</a>
                <span class="separator">/</span>
                <a href="index.html">XSIAM</a>
                <span class="separator">/</span>
                <span class="current">Data Ingestion</span>
            </div>

            <h1><i class="fas fa-upload"></i> Data Ingestion</h1>
            <p class="lead">Master the art of collecting security telemetry into Cortex XSIAM. This page focuses on understanding data source categories, collection methods, and choosing the right ingestion approach. For parsing details, see <a href="parsing-flows.html">Parsing & Flows</a>. For Broker VM setup, see <a href="broker-vm.html">Broker VM</a>.</p>

            <!-- Decision Tree: Which Collection Method -->
            <h2><i class="fas fa-code-branch"></i> Decision Tree: Choosing the Right Collection Method</h2>
            
            <div class="decision-tree">
                <div class="decision-node question">
                    <strong>What type of data source are you onboarding?</strong>
                </div>
                <div class="decision-branch">
                    <div>
                        <div class="decision-arrow">↓ Endpoint</div>
                        <div class="decision-node yes">
                            <strong>Cortex XDR Agent</strong>
                            <div style="color: #8b949e; font-size: 0.85rem;">Richest telemetry + response capability</div>
                        </div>
                        <div class="decision-arrow">↓</div>
                        <div class="decision-node question" style="font-size: 0.85rem;">
                            <strong>Can the device run an agent?</strong>
                        </div>
                        <div class="decision-branch">
                            <div>
                                <div class="decision-arrow">↓ YES</div>
                                <div class="decision-node yes" style="background: #1a4d2e;">
                                    <strong style="color: #3fb950;"><i class="fas fa-check"></i> Deploy XDR Agent</strong>
                                    <div style="color: #8b949e; font-size: 0.8rem;">See <a href="agents.html">Agents page</a></div>
                                </div>
                            </div>
                            <div>
                                <div class="decision-arrow">↓ NO (Legacy/IoT)</div>
                                <div class="decision-node no">
                                    <strong>Network-Based Collection</strong>
                                    <div style="color: #8b949e; font-size: 0.8rem;">Syslog from NGFW or proxy</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="decision-arrow">↓ Network Device</div>
                        <div class="decision-node question">
                            <strong>Where is the device?</strong>
                        </div>
                        <div class="decision-branch">
                            <div>
                                <div class="decision-arrow">↓ On-Prem</div>
                                <div class="decision-node yes" style="background: #1a4d2e;">
                                    <strong style="color: #3fb950;"><i class="fas fa-server"></i> Broker VM + Syslog</strong>
                                    <div style="color: #8b949e; font-size: 0.8rem;">See <a href="broker-vm.html">Broker VM</a></div>
                                </div>
                            </div>
                            <div>
                                <div class="decision-arrow">↓ Cloud</div>
                                <div class="decision-node yes" style="background: #1a3d4d;">
                                    <strong style="color: #58a6ff;"><i class="fas fa-cloud"></i> Cloud Collector</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="decision-arrow">↓ Cloud/SaaS</div>
                        <div class="decision-node question">
                            <strong>Native integration available?</strong>
                        </div>
                        <div class="decision-branch">
                            <div>
                                <div class="decision-arrow">↓ YES</div>
                                <div class="decision-node yes" style="background: #3d1a4d;">
                                    <strong style="color: #a371f7;"><i class="fas fa-plug"></i> Use Marketplace</strong>
                                </div>
                            </div>
                            <div>
                                <div class="decision-arrow">↓ NO</div>
                                <div class="decision-node" style="border-color: #d29922;">
                                    <strong>Custom API or HTTP Collector</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Source Categories -->
            <h2><i class="fas fa-database"></i> Data Source Categories</h2>
            <p class="console-path">Settings → Data Sources</p>

            <div class="config-section">
                <table class="styled-table">
                    <thead>
                        <tr><th>Category</th><th>Examples</th><th>Primary Method</th><th>Fallback</th><th>Dataset Prefix</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Endpoint</strong></td>
                            <td>Windows, macOS, Linux</td>
                            <td><span class="badge green">XDR Agent</span></td>
                            <td>WEL via Broker</td>
                            <td><code>xdr_data</code></td>
                        </tr>
                        <tr>
                            <td><strong>Network Security</strong></td>
                            <td>NGFW, IDS/IPS, WAF</td>
                            <td><span class="badge blue">Syslog</span></td>
                            <td>API if available</td>
                            <td><code>panw_ngfw</code>, <code>cisco_*</code></td>
                        </tr>
                        <tr>
                            <td><strong>Cloud Infrastructure</strong></td>
                            <td>AWS, Azure, GCP</td>
                            <td><span class="badge purple">Cloud Collector</span></td>
                            <td>S3/EventHub</td>
                            <td><code>aws_*</code>, <code>azure_*</code></td>
                        </tr>
                        <tr>
                            <td><strong>Identity</strong></td>
                            <td>Okta, Azure AD, Ping</td>
                            <td><span class="badge orange">API</span></td>
                            <td>SAML via syslog</td>
                            <td><code>okta_*</code>, <code>azure_ad_*</code></td>
                        </tr>
                        <tr>
                            <td><strong>Email Security</strong></td>
                            <td>M365, Proofpoint</td>
                            <td><span class="badge orange">API</span></td>
                            <td>SMTP logs</td>
                            <td><code>msft_*</code>, <code>proofpoint_*</code></td>
                        </tr>
                        <tr>
                            <td><strong>Custom/Legacy</strong></td>
                            <td>Mainframe, proprietary</td>
                            <td><span class="badge blue">Syslog/File</span></td>
                            <td>HTTP Collector</td>
                            <td><code>custom_*</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Data Flow Diagram -->
            <h2><i class="fas fa-stream"></i> Data Collection Flow</h2>
            
            <div class="flow-diagram">
                <div class="flow-diagram-title"><i class="fas fa-project-diagram"></i> How Data Flows into XSIAM</div>
                <div class="flow-row centered">
                    <div class="flow-box primary">
                        <div class="flow-box-title">Data Sources</div>
                        <div class="flow-box-subtitle">Endpoints, Network, Cloud, SaaS</div>
                    </div>
                </div>
                <div class="flow-row centered">
                    <span class="flow-arrow"><i class="fas fa-arrow-down"></i></span>
                </div>
                <div class="flow-row centered">
                    <div class="flow-box">
                        <div class="flow-box-title"><i class="fas fa-desktop"></i> XDR Agent</div>
                        <div class="flow-box-subtitle">Direct to cloud</div>
                    </div>
                    <div class="flow-box">
                        <div class="flow-box-title"><i class="fas fa-server"></i> Broker VM</div>
                        <div class="flow-box-subtitle">Syslog/WEL</div>
                    </div>
                    <div class="flow-box">
                        <div class="flow-box-title"><i class="fas fa-cloud"></i> Cloud Collector</div>
                        <div class="flow-box-subtitle">AWS/Azure/GCP</div>
                    </div>
                    <div class="flow-box">
                        <div class="flow-box-title"><i class="fas fa-plug"></i> API</div>
                        <div class="flow-box-subtitle">REST/OAuth</div>
                    </div>
                    <div class="flow-box">
                        <div class="flow-box-title"><i class="fas fa-code"></i> HTTP</div>
                        <div class="flow-box-subtitle">Webhooks</div>
                    </div>
                </div>
                <div class="flow-row centered">
                    <span class="flow-arrow"><i class="fas fa-arrow-down"></i></span>
                </div>
                <div class="flow-row centered">
                    <div class="flow-box success">
                        <div class="flow-box-title">XSIAM Cloud</div>
                        <div class="flow-box-subtitle">Parse → Normalize (XDM) → Store</div>
                    </div>
                </div>
            </div>

            <!-- Common Syslog Sources -->
            <h2><i class="fas fa-server"></i> Common Syslog Sources</h2>
            
            <div class="info-box">
                <h4><i class="fas fa-info-circle"></i> Syslog Collection Requires Broker VM</h4>
                <p>On-premises devices send syslog to a <strong>Broker VM</strong> which forwards to XSIAM cloud. See <a href="broker-vm.html">Broker VM page</a> for deployment details.</p>
            </div>

            <div class="config-section">
                <table class="styled-table">
                    <thead>
                        <tr><th>Device Type</th><th>Vendor</th><th>Protocol</th><th>Dataset</th><th>Typical EPS</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><strong>NGFW</strong></td><td>Palo Alto</td><td>TCP/TLS 514</td><td><code>panw_ngfw</code></td><td>1K-50K</td></tr>
                        <tr><td><strong>Firewall</strong></td><td>Cisco ASA</td><td>UDP 514</td><td><code>cisco_asa</code></td><td>500-10K</td></tr>
                        <tr><td><strong>Firewall</strong></td><td>FortiGate</td><td>UDP/TCP 514</td><td><code>fortinet_fortigate</code></td><td>500-20K</td></tr>
                        <tr><td><strong>Web Proxy</strong></td><td>Zscaler</td><td>NSS→Syslog</td><td><code>zscaler_zia</code></td><td>5K-100K</td></tr>
                        <tr><td><strong>Load Balancer</strong></td><td>F5 BIG-IP</td><td>UDP 514</td><td><code>f5_bigip</code></td><td>100-5K</td></tr>
                        <tr><td><strong>Linux</strong></td><td>rsyslog</td><td>TCP/UDP 514</td><td><code>linux_syslog</code></td><td>10-500/host</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Cloud Sources Overview -->
            <h2><i class="fas fa-cloud"></i> Cloud Data Sources</h2>
            <p class="console-path">Settings → Data Sources → Cloud</p>

            <div class="config-section">
                <h4>AWS Integration</h4>
                <div class="concept-grid">
                    <div class="concept-card">
                        <div class="concept-card-icon blue"><i class="fas fa-file-alt"></i></div>
                        <h4>CloudTrail</h4>
                        <p>API activity - who did what, when. Essential for unauthorized access detection.</p>
                        <div style="margin-top: 8px; font-size: 0.85rem;"><code>aws_cloudtrail</code></div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon orange"><i class="fas fa-exclamation-triangle"></i></div>
                        <h4>GuardDuty</h4>
                        <p>Pre-analyzed threat findings for reconnaissance and compromise.</p>
                        <div style="margin-top: 8px; font-size: 0.85rem;"><code>aws_guardduty</code></div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon green"><i class="fas fa-network-wired"></i></div>
                        <h4>VPC Flow Logs</h4>
                        <p>Network traffic metadata. Critical for lateral movement detection.</p>
                        <div style="margin-top: 8px; font-size: 0.85rem;"><code>aws_vpc_flow</code></div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon purple"><i class="fas fa-shield-alt"></i></div>
                        <h4>Security Hub</h4>
                        <p>Aggregated findings and compliance status from AWS services.</p>
                        <div style="margin-top: 8px; font-size: 0.85rem;"><code>aws_security_hub</code></div>
                    </div>
                </div>

                <h4 style="margin-top: 24px;">Azure Integration</h4>
                <div class="concept-grid">
                    <div class="concept-card">
                        <div class="concept-card-icon blue"><i class="fas fa-sign-in-alt"></i></div>
                        <h4>Azure AD Sign-in</h4>
                        <p>Authentication events, MFA, conditional access, risky sign-ins.</p>
                        <div style="margin-top: 8px; font-size: 0.85rem;"><code>azure_ad_signin</code></div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon orange"><i class="fas fa-history"></i></div>
                        <h4>Azure AD Audit</h4>
                        <p>Directory changes - user/group mods, app registrations, role changes.</p>
                        <div style="margin-top: 8px; font-size: 0.85rem;"><code>azure_ad_audit</code></div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon green"><i class="fas fa-cogs"></i></div>
                        <h4>Activity Logs</h4>
                        <p>Resource operations - VM, network, storage, subscription events.</p>
                        <div style="margin-top: 8px; font-size: 0.85rem;"><code>azure_activity</code></div>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon purple"><i class="fas fa-envelope"></i></div>
                        <h4>M365 Audit</h4>
                        <p>Exchange, SharePoint, OneDrive, Teams activity and file sharing.</p>
                        <div style="margin-top: 8px; font-size: 0.85rem;"><code>msft_o365_audit</code></div>
                    </div>
                </div>
            </div>

            <!-- API vs Syslog Decision Tree -->
            <h2><i class="fas fa-code-branch"></i> Decision Tree: API vs Syslog</h2>
            
            <div class="decision-tree">
                <div class="decision-node question">
                    <strong>Does the source have a native XSIAM Marketplace integration?</strong>
                </div>
                <div class="decision-branch">
                    <div>
                        <div class="decision-arrow">↓ YES</div>
                        <div class="decision-node yes" style="background: #1a4d2e;">
                            <strong style="color: #3fb950;"><i class="fas fa-check"></i> Use Native Integration</strong>
                            <div style="color: #8b949e; font-size: 0.85rem;">Pre-built parser + XDM mapping</div>
                        </div>
                    </div>
                    <div>
                        <div class="decision-arrow">↓ NO</div>
                        <div class="decision-node question">
                            <strong>API available?</strong>
                        </div>
                        <div class="decision-branch">
                            <div>
                                <div class="decision-arrow">↓ YES</div>
                                <div class="decision-node question" style="font-size: 0.85rem;">
                                    <strong>Need real-time?</strong>
                                </div>
                                <div class="decision-branch">
                                    <div>
                                        <div class="decision-arrow">↓ YES</div>
                                        <div class="decision-node" style="border-color: #d29922;">
                                            <strong>HTTP Collector (Webhook)</strong>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="decision-arrow">↓ NO</div>
                                        <div class="decision-node yes">
                                            <strong>Custom API via XSOAR</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="decision-arrow">↓ NO</div>
                                <div class="decision-node yes">
                                    <strong>Broker VM + Syslog</strong>
                                    <div style="color: #8b949e; font-size: 0.8rem;">Custom parser needed</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Volume Planning -->
            <h2><i class="fas fa-calculator"></i> Data Volume Planning</h2>
            
            <div class="config-section">
                <h4>Estimating Daily Ingestion Volume</h4>
                <table class="styled-table">
                    <thead>
                        <tr><th>Data Source</th><th>Typical EPS/Unit</th><th>Avg Event Size</th><th>Daily Volume/Unit</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>XDR Agent (standard)</td><td>5-20</td><td>1-2 KB</td><td>0.5-3 GB</td></tr>
                        <tr><td>XDR Agent (enhanced)</td><td>20-100</td><td>1-2 KB</td><td>2-15 GB</td></tr>
                        <tr><td>Palo Alto NGFW</td><td>1K-5K</td><td>0.5-1 KB</td><td>40-400 GB</td></tr>
                        <tr><td>Azure AD (per 1K users)</td><td>10-50</td><td>1-3 KB</td><td>1-12 GB</td></tr>
                        <tr><td>AWS CloudTrail (per acct)</td><td>50-500</td><td>2-5 KB</td><td>8-200 GB</td></tr>
                        <tr><td>Windows Event Log (per srv)</td><td>10-100</td><td>1-4 KB</td><td>1-30 GB</td></tr>
                    </tbody>
                </table>

                <div class="tip-box" style="margin-top: 16px;">
                    <div class="tip-box-title"><i class="fas fa-lightbulb"></i> Volume Formula</div>
                    <p><code>Daily GB = (EPS × 86,400 × Avg Event KB) ÷ 1,000,000</code></p>
                    <p style="margin-top: 8px;">Example: 1,000 EPS × 86,400 sec × 1 KB = 86.4 GB/day</p>
                </div>
            </div>

            <!-- Monitoring Data Health -->
            <h2><i class="fas fa-heartbeat"></i> Monitoring Data Health</h2>
            <p class="console-path">Settings → Data Sources → Dashboard</p>

            <div class="config-section">
                <h4>Key Health Indicators</h4>
                <div class="concept-grid">
                    <div class="concept-card">
                        <div class="concept-card-icon green"><i class="fas fa-tachometer-alt"></i></div>
                        <h4>Ingestion Rate</h4>
                        <p>EPS trending. Drops = source issues; spikes = attacks or misconfigs.</p>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon blue"><i class="fas fa-clock"></i></div>
                        <h4>Last Seen</h4>
                        <p>Time since last event. Alert if >15 min for critical sources.</p>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon orange"><i class="fas fa-exclamation-circle"></i></div>
                        <h4>Parsing Errors</h4>
                        <p>Events failing to parse. High rates = parser issues.</p>
                    </div>
                    <div class="concept-card">
                        <div class="concept-card-icon red"><i class="fas fa-plug"></i></div>
                        <h4>Connection Status</h4>
                        <p>Broker, API, collector connectivity health.</p>
                    </div>
                </div>

                <h4 style="margin-top: 20px;">XQL Queries for Data Monitoring</h4>
                
                <div class="code-header">
                    <span class="code-title">Check Ingestion by Dataset</span>
                    <span class="code-lang">XQL</span>
                </div>
                <div class="code-content">datamodel
| comp count() as event_count by _dataset
| sort desc event_count
| limit 20</div>

                <div class="code-header" style="margin-top: 16px;">
                    <span class="code-title">Detect Data Gaps (Per Hour)</span>
                    <span class="code-lang">XQL</span>
                </div>
                <div class="code-content">dataset = xdr_data
| comp count() as events by bin(_time, 1h)
| alter expected = 1000
| filter events < expected * 0.5
| sort asc _time</div>

                <div class="code-header" style="margin-top: 16px;">
                    <span class="code-title">Find Silent Hosts (No Data in 4h)</span>
                    <span class="code-lang">XQL</span>
                </div>
                <div class="code-content">dataset = xdr_data
| comp max(_time) as last_seen by agent_hostname
| alter hours_silent = timestamp_diff(current_time(), last_seen, "HOUR")
| filter hours_silent > 4
| sort desc hours_silent</div>
            </div>

            <!-- Interview Questions -->
            <h2><i class="fas fa-comments"></i> Interview Questions & Answers</h2>
            <div class="qa-section">
                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through how you would onboard a new data source in XSIAM.</button>
                    <div class="qa-answer">
                        <p>When I onboard a new data source, I follow a structured process that I've refined across multiple deployments:</p>
                        
                        <p><strong>First, I assess the source requirements.</strong> I start by understanding what security telemetry the source provides and why we need it. For a firewall, I want traffic logs, threat logs, and URL filtering. For an identity provider, I need authentication events and admin changes. I document expected event volume, log format, and any compliance retention requirements.</p>
                        
                        <p><strong>Second, I determine the collection method.</strong> This is where the decision tree comes in. For endpoints, the answer is almost always the Cortex XDR agent because it provides the richest telemetry and response capabilities. For network devices on-premises, I use Broker VM with syslog. For cloud services like AWS or Azure, I use native cloud collectors. For SaaS applications, I check for API integrations.</p>
                        
                        <p><strong>Third, I check for native support.</strong> Before building anything custom, I always check the XSIAM Marketplace. If there's a content pack for my source, it includes the parser, XDM mapping, and often sample correlation rules. This can save hours of work compared to building from scratch.</p>
                        
                        <p><strong>Fourth, I configure the collection.</strong> For syslog sources, I configure the Broker VM with the appropriate port, set up TLS if supported, and configure the data source profile. For API integrations, I create credentials, configure OAuth flows if needed, and set polling intervals based on how real-time I need the data.</p>
                        
                        <p><strong>Fifth, I verify the data flow.</strong> I send test events and use XQL to query the raw dataset. I check that fields are being extracted correctly and mapped to XDM. I look for parsing errors and adjust if needed. Timestamp validation is critical - timezone issues are a common gotcha.</p>
                        
                        <p><strong>Finally, I document and monitor.</strong> I create a runbook entry with source details, expected EPS, and troubleshooting steps. I set up a dashboard widget to track ingestion volume and alert on data gaps.</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What factors do you consider when choosing between API and syslog collection?</button>
                    <div class="qa-answer">
                        <p>This is a decision I make frequently, and there are several factors I weigh:</p>
                        
                        <p><strong>Data richness:</strong> API integrations typically provide better-structured data. Vendors design their APIs with specific fields in mind, while syslog can vary between firmware versions. If I need guaranteed field presence and structure, API wins.</p>
                        
                        <p><strong>Real-time requirements:</strong> Syslog is near real-time - events arrive within seconds. API polling introduces latency based on the interval. For critical sources like firewalls where I need immediate visibility, syslog is better. For audit logs where 5-minute delay is acceptable, API is fine.</p>
                        
                        <p><strong>Reliability and delivery guarantees:</strong> UDP syslog can lose events during congestion. TCP syslog is more reliable but can cause backpressure. APIs usually have better delivery guarantees with checkpointing. For compliance-critical data, I prefer APIs with guaranteed delivery.</p>
                        
                        <p><strong>Operational complexity:</strong> Syslog requires a Broker VM on-premises - another system to maintain and patch. API integrations are cloud-to-cloud with no infrastructure on my side. For resource-constrained teams, APIs reduce operational burden.</p>
                        
                        <p><strong>Security:</strong> APIs use OAuth or API keys that can be scoped and rotated. Traditional syslog has no authentication - you can add TLS, but not all devices support it. For sensitive data, API is more secure.</p>
                        
                        <p><strong>Cost:</strong> Some vendors charge for API access or impose rate limits. Syslog is essentially free but requires Broker VM infrastructure.</p>
                        
                        <p><strong>My general rule:</strong> If a native API integration exists in the Marketplace, use it. If not and the source is on-premises, syslog via Broker VM. If it's cloud/SaaS without native integration, I'll build a custom API collector using XSOAR.</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you troubleshoot missing log data in XSIAM?</button>
                    <div class="qa-answer">
                        <p>I approach missing data troubleshooting systematically, working from source to destination:</p>
                        
                        <p><strong>Step 1: Verify the source is generating logs.</strong> I start at the source itself. If it's a firewall, I log into the device and verify it's generating expected logs. If it's a server, I check local event viewer or syslog files. You'd be surprised how often logging was disabled or the log level was changed.</p>
                        
                        <p><strong>Step 2: Check network connectivity.</strong> For syslog, I use tcpdump on the Broker VM to see if packets are arriving. I verify firewall rules between source and collector. For API integrations, I verify the source can reach XSIAM endpoints - sometimes proxy or firewall updates block connectivity.</p>
                        
                        <p><strong>Step 3: Verify the collector is healthy.</strong> For Broker VM, I check service status, disk space, and memory. A full disk stops collection. I review Broker logs for errors. For API integrations, I check the integration status in the console - it shows last successful poll and error messages.</p>
                        
                        <p><strong>Step 4: Check parsing.</strong> If data is arriving but not queryable, the issue is often parsing. I query the raw log dataset to see if events are there unparsed. High parsing errors indicate the log format changed or the parser needs updating.</p>
                        
                        <p><strong>Step 5: Verify timestamps.</strong> Sometimes data appears missing but has wrong timestamps. If the source clock is off or timezone is misconfigured, events index in the wrong time window. I query a wide time range and check _time values.</p>
                        
                        <p><strong>Step 6: Check for throttling.</strong> API sources might rate-limit requests. High-volume syslog might overwhelm the Broker. I check ingestion metrics for signs of data loss.</p>
                        
                        <p><strong>Key XQL:</strong> <code>dataset = _raw_log | filter vendor = "vendorname" | limit 10</code> is my go-to for checking raw data arrival.</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is XDM and why does it matter for data ingestion?</button>
                    <div class="qa-answer">
                        <p>XDM (XSIAM Data Model) is what I call the "universal translator" for security data. Understanding it is fundamental to effective XSIAM use:</p>
                        
                        <p><strong>What XDM is:</strong> It's a normalized schema that maps fields from different log sources to common field names. Palo Alto calls source IP "src_ip", Cisco calls it "srcAddress", AWS calls it "sourceIPAddress". XDM maps all of these to "xdm.source.ipv4". This normalization happens during parsing, before data is stored.</p>
                        
                        <p><strong>Why it matters for detection:</strong> Without normalization, you'd need separate correlation rules for each log source. Want to detect failed login followed by successful login? Without XDM, you'd need one rule for Okta, another for Azure AD, another for VPN. With XDM, you write one rule using xdm.event.type and xdm.event.outcome, and it works across all sources. This dramatically reduces rule maintenance.</p>
                        
                        <p><strong>Why it matters for hunting:</strong> When investigating, I often pivot across data sources. "Show me all connections from this IP" is simple with XDM: <code>xdm.source.ipv4 = "1.2.3.4"</code>. Without normalization, I'd need complex union queries knowing every vendor's field name.</p>
                        
                        <p><strong>Why it matters for analytics:</strong> XSIAM's ML models are trained on XDM fields. They expect usernames in xdm.source.user.username, IPs in xdm.source.ipv4. If your data isn't properly mapped to XDM, ML models won't see the data they need.</p>
                        
                        <p><strong>Common XDM categories:</strong></p>
                        <ul>
                            <li><strong>Network:</strong> xdm.source.ipv4, xdm.target.ipv4, xdm.source.port, xdm.target.port</li>
                            <li><strong>Identity:</strong> xdm.source.user.username, xdm.source.user.domain</li>
                            <li><strong>Event:</strong> xdm.event.type, xdm.event.outcome, xdm.event.description</li>
                            <li><strong>Host:</strong> xdm.source.host.hostname, xdm.target.host.hostname</li>
                            <li><strong>File:</strong> xdm.target.file.filename, xdm.target.file.sha256</li>
                        </ul>
                        
                        <p><strong>During onboarding:</strong> Validating XDM mapping is a critical step. I query for events and verify key fields populate in expected XDM locations. Missing mappings mean the source won't participate in cross-source correlation or ML - it becomes a silo.</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle data volume management and cost optimization?</button>
                    <div class="qa-answer">
                        <p>Data volume management is increasingly important with cloud SIEMs where you pay for ingestion. Here's my approach:</p>
                        
                        <p><strong>Understanding the cost equation:</strong> In XSIAM, costs are driven by endpoints (XDR agent data, included in endpoint license) and ingestion volume (third-party data, measured in GB/day). XDR agent data has no direct cost, so collect freely. Third-party data requires optimization.</p>
                        
                        <p><strong>Prioritizing high-value data:</strong> I categorize data sources into tiers:</p>
                        <ul>
                            <li><strong>Tier 1 (Always collect fully):</strong> Authentication logs, firewall denies, EDR alerts, cloud audit logs</li>
                            <li><strong>Tier 2 (Important but voluminous):</strong> Firewall allows, DNS queries, proxy logs</li>
                            <li><strong>Tier 3 (Nice to have):</strong> Debug logs, verbose network flows</li>
                        </ul>
                        <p>Tier 1 is always fully collected. For Tier 2, I evaluate volume-to-value ratio.</p>
                        
                        <p><strong>Filtering at source:</strong> The best optimization is filtering before data enters XSIAM. On firewalls, I exclude health checks between known-good internal systems. On Windows servers, I focus on suspicious directories and processes with network connections. Filtering at source reduces Broker load and ingestion costs.</p>
                        
                        <p><strong>Using retention tiers:</strong> XSIAM has Hot (fast, expensive) and Cold (slower, cheaper) storage. I configure high-volume, low-investigation-frequency data for shorter hot retention and longer cold. Alert-generating data stays hot longer.</p>
                        
                        <p><strong>Monitoring and trending:</strong> I track daily ingestion by source. Spikes often indicate misconfigs or attacks. Weekly I review top sources by volume and ask "are we getting security value?"</p>
                        
                        <p><strong>Practical wins achieved:</strong></p>
                        <ul>
                            <li>Filtering inter-zone allows between trusted segments: 40% reduction</li>
                            <li>Reducing Windows Event Log to security-relevant events: 60% reduction</li>
                            <li>Deduplicating repeated DNS queries: 30% reduction</li>
                        </ul>
                        
                        <p>The key is validating that filtering doesn't create detection gaps. Every filter I implement gets documented and periodically reviewed.</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="next-steps-grid" style="margin-top: 32px;">
                <a href="broker-vm.html" class="next-step-card">
                    <h4><i class="fas fa-server"></i> Broker VM Setup</h4>
                    <p>Detailed deployment and configuration guide</p>
                </a>
                <a href="parsing-flows.html" class="next-step-card">
                    <h4><i class="fas fa-stream"></i> Parsing & XDM</h4>
                    <p>Deep dive into parsing rules and field mapping</p>
                </a>
                <a href="custom-log-onboarding.html" class="next-step-card">
                    <h4><i class="fas fa-plus-circle"></i> Custom Log Onboarding</h4>
                    <p>Guide for unsupported data sources</p>
                </a>
            </div>
        </main>
    </div>
</div>

<script>
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        const mainWrapper = document.getElementById('mainWrapper');
        const overlay = document.getElementById('sidebarOverlay');
        if (window.innerWidth <= 768) {
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        } else {
            sidebar.classList.toggle('collapsed');
            mainWrapper.classList.toggle('expanded');
        }
    }
    document.querySelectorAll('.qa-question').forEach(btn => {
        btn.addEventListener('click', () => {
            const answer = btn.nextElementSibling;
            const isOpen = answer.style.display === 'block';
            document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
            if (!isOpen) answer.style.display = 'block';
        });
    });
    window.addEventListener('resize', () => {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebarOverlay');
        if (window.innerWidth > 768) {
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }
    });
</script>
</body>
</html>
