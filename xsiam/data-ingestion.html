<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Ingestion Methods | XSIAM | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .decision-tree { background: #0d1117; border: 1px solid #30363d; border-radius: 12px; padding: 24px; margin: 20px 0; }
        .decision-node { background: #161b22; border: 2px solid #58a6ff; border-radius: 8px; padding: 16px; margin: 12px 0; text-align: center; }
        .decision-node.question { border-color: #d29922; }
        .decision-node.answer { border-color: #3fb950; background: #1a4d2e; }
        .ingestion-card { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .ingestion-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
        .ingestion-icon { width: 48px; height: 48px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .method-comparison { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin: 20px 0; }
        .method-card { background: #161b22; border-radius: 8px; padding: 16px; text-align: center; border-top: 3px solid #58a6ff; }
        .cost-indicator { display: flex; gap: 4px; justify-content: center; margin-top: 8px; }
        .cost-dot { width: 8px; height: 8px; border-radius: 50%; background: #30363d; }
        .cost-dot.filled { background: #3fb950; }
        .enterprise-scenario { background: linear-gradient(135deg, #1a1f35 0%, #0d1117 100%); border: 1px solid #30363d; border-radius: 12px; padding: 24px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link active"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM</a>
                    <a href="agents.html" class="nav-link"><i class="fas fa-desktop"></i> Cortex Agents</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & XDM</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Data Ingestion</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-database"></i> Data Ingestion Methods</h1>
                <p class="lead">Getting data into XSIAM is the foundation of effective security operations. This guide covers all ingestion methods, when to use each, cost implications, and enterprise deployment patterns.</p>

                <!-- The 4 Ingestion Methods -->
                <h2><i class="fas fa-layer-group"></i> The 4 Data Ingestion Methods</h2>
                
                <div class="method-comparison">
                    <div class="method-card" style="border-color: #58a6ff;">
                        <i class="fas fa-desktop" style="font-size: 2rem; color: #58a6ff;"></i>
                        <h4>Cortex XDR Agent</h4>
                        <p style="color: #8b949e; font-size: 0.85rem;">Direct from endpoints</p>
                        <div style="margin-top: 12px; font-size: 0.8rem;">
                            <div style="color: #3fb950;">✓ Richest telemetry</div>
                            <div style="color: #3fb950;">✓ Response capability</div>
                            <div style="color: #d29922;">● Per-endpoint cost</div>
                        </div>
                    </div>
                    <div class="method-card" style="border-color: #3fb950;">
                        <i class="fas fa-server" style="font-size: 2rem; color: #3fb950;"></i>
                        <h4>Broker VM</h4>
                        <p style="color: #8b949e; font-size: 0.85rem;">On-prem syslog/WEF</p>
                        <div style="margin-top: 12px; font-size: 0.8rem;">
                            <div style="color: #3fb950;">✓ Any syslog source</div>
                            <div style="color: #3fb950;">✓ Windows events</div>
                            <div style="color: #d29922;">● VM infrastructure</div>
                        </div>
                    </div>
                    <div class="method-card" style="border-color: #d29922;">
                        <i class="fas fa-cloud" style="font-size: 2rem; color: #d29922;"></i>
                        <h4>Cloud Collectors</h4>
                        <p style="color: #8b949e; font-size: 0.85rem;">SaaS/Cloud via API</p>
                        <div style="margin-top: 12px; font-size: 0.8rem;">
                            <div style="color: #3fb950;">✓ No infrastructure</div>
                            <div style="color: #3fb950;">✓ Native integrations</div>
                            <div style="color: #d29922;">● API rate limits</div>
                        </div>
                    </div>
                    <div class="method-card" style="border-color: #a371f7;">
                        <i class="fas fa-plug" style="font-size: 2rem; color: #a371f7;"></i>
                        <h4>HTTP Collector</h4>
                        <p style="color: #8b949e; font-size: 0.85rem;">Direct HTTPS push</p>
                        <div style="margin-top: 12px; font-size: 0.8rem;">
                            <div style="color: #3fb950;">✓ Custom apps</div>
                            <div style="color: #3fb950;">✓ Webhooks</div>
                            <div style="color: #d29922;">● Requires dev work</div>
                        </div>
                    </div>
                </div>

                <!-- Master Decision Tree -->
                <h2><i class="fas fa-code-branch"></i> Master Decision Tree: Which Ingestion Method?</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What type of data source are you connecting?</strong>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-top: 20px;">
                        <!-- Endpoint Branch -->
                        <div>
                            <div style="text-align: center; color: #58a6ff; font-weight: 600; margin-bottom: 8px;">
                                <i class="fas fa-desktop"></i> Endpoint
                            </div>
                            <div class="decision-node" style="border-color: #58a6ff; font-size: 0.85rem;">
                                Windows, Mac, Linux workstation/server
                            </div>
                            <div style="text-align: center; color: #8b949e; margin: 8px 0;">↓</div>
                            <div class="decision-node question" style="font-size: 0.85rem;">
                                Can install agent?
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px;">
                                <div>
                                    <div style="text-align: center; color: #3fb950; font-size: 0.75rem;">YES</div>
                                    <div class="decision-node answer" style="font-size: 0.8rem; padding: 8px;">
                                        <strong>XDR Agent</strong>
                                    </div>
                                </div>
                                <div>
                                    <div style="text-align: center; color: #f85149; font-size: 0.75rem;">NO</div>
                                    <div class="decision-node" style="font-size: 0.8rem; padding: 8px; border-color: #3fb950;">
                                        <strong>Broker VM</strong>
                                        <div style="color: #8b949e;">(WEF/syslog)</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Network/On-Prem Branch -->
                        <div>
                            <div style="text-align: center; color: #3fb950; font-weight: 600; margin-bottom: 8px;">
                                <i class="fas fa-network-wired"></i> Network/On-Prem
                            </div>
                            <div class="decision-node" style="border-color: #3fb950; font-size: 0.85rem;">
                                Firewall, router, switch, on-prem server
                            </div>
                            <div style="text-align: center; color: #8b949e; margin: 8px 0;">↓</div>
                            <div class="decision-node question" style="font-size: 0.85rem;">
                                Can send to internet directly?
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px;">
                                <div>
                                    <div style="text-align: center; color: #3fb950; font-size: 0.75rem;">YES</div>
                                    <div class="decision-node" style="font-size: 0.8rem; padding: 8px; border-color: #a371f7;">
                                        <strong>HTTP Collector</strong>
                                    </div>
                                </div>
                                <div>
                                    <div style="text-align: center; color: #f85149; font-size: 0.75rem;">NO</div>
                                    <div class="decision-node answer" style="font-size: 0.8rem; padding: 8px;">
                                        <strong>Broker VM</strong>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cloud Branch -->
                        <div>
                            <div style="text-align: center; color: #d29922; font-weight: 600; margin-bottom: 8px;">
                                <i class="fas fa-cloud"></i> Cloud Platform
                            </div>
                            <div class="decision-node" style="border-color: #d29922; font-size: 0.85rem;">
                                AWS, Azure, GCP
                            </div>
                            <div style="text-align: center; color: #8b949e; margin: 8px 0;">↓</div>
                            <div class="decision-node answer" style="font-size: 0.85rem;">
                                <strong>Cloud Collector</strong>
                                <div style="color: #8b949e; font-size: 0.75rem;">Native API integration</div>
                            </div>
                            <div style="margin-top: 12px; background: #21262d; padding: 8px; border-radius: 6px; font-size: 0.75rem; color: #8b949e;">
                                AWS: CloudTrail, GuardDuty, VPC Flow<br>
                                Azure: Activity Log, Entra ID, Sentinel<br>
                                GCP: Cloud Audit, Security Command Center
                            </div>
                        </div>

                        <!-- SaaS Branch -->
                        <div>
                            <div style="text-align: center; color: #a371f7; font-weight: 600; margin-bottom: 8px;">
                                <i class="fas fa-globe"></i> SaaS Application
                            </div>
                            <div class="decision-node" style="border-color: #a371f7; font-size: 0.85rem;">
                                Okta, M365, Salesforce, etc.
                            </div>
                            <div style="text-align: center; color: #8b949e; margin: 8px 0;">↓</div>
                            <div class="decision-node question" style="font-size: 0.85rem;">
                                Native XSIAM integration exists?
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px;">
                                <div>
                                    <div style="text-align: center; color: #3fb950; font-size: 0.75rem;">YES</div>
                                    <div class="decision-node answer" style="font-size: 0.8rem; padding: 8px;">
                                        <strong>Cloud Collector</strong>
                                    </div>
                                </div>
                                <div>
                                    <div style="text-align: center; color: #f85149; font-size: 0.75rem;">NO</div>
                                    <div class="decision-node" style="font-size: 0.8rem; padding: 8px; border-color: #a371f7;">
                                        <strong>HTTP Collector</strong>
                                        <div style="color: #8b949e;">(webhook/API)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Method Explanations -->
                <h2><i class="fas fa-info-circle"></i> Detailed Method Explanations</h2>

                <div class="ingestion-card">
                    <div class="ingestion-header">
                        <div class="ingestion-icon" style="background: #1c3a5e; color: #58a6ff;"><i class="fas fa-desktop"></i></div>
                        <div>
                            <h3 style="margin: 0;">Cortex XDR Agent</h3>
                            <div style="color: #8b949e;">Direct endpoint telemetry with response capability</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="color: #3fb950;">What It Collects</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem;">
                                <li><strong>Process events:</strong> Every process start, command lines, parent-child</li>
                                <li><strong>File events:</strong> Create, modify, delete, hash</li>
                                <li><strong>Network events:</strong> Connections, DNS queries</li>
                                <li><strong>Registry events:</strong> Key changes (Windows)</li>
                                <li><strong>Module loads:</strong> DLLs, shared libraries</li>
                                <li><strong>User activity:</strong> Logins, privilege changes</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: #d29922;">Deployment Considerations</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem;">
                                <li><strong>Windows:</strong> 10/11, Server 2012 R2+</li>
                                <li><strong>macOS:</strong> 10.15+ (Catalina and later)</li>
                                <li><strong>Linux:</strong> RHEL/CentOS 7+, Ubuntu 16.04+</li>
                                <li><strong>Resource usage:</strong> ~100MB RAM, <1% CPU typical</li>
                                <li><strong>Network:</strong> ~5-50 MB/day per endpoint</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="margin-top: 16px; padding: 16px; background: #21262d; border-radius: 8px;">
                        <strong style="color: #58a6ff;">Best Practice:</strong>
                        <span style="color: #8b949e;">Deploy XDR agents to ALL endpoints where possible. The richness of endpoint telemetry is unmatched by network-only collection. Even if you have NGFW visibility, agent data provides process-level context.</span>
                    </div>
                </div>

                <div class="ingestion-card">
                    <div class="ingestion-header">
                        <div class="ingestion-icon" style="background: #1a4d2e; color: #3fb950;"><i class="fas fa-server"></i></div>
                        <div>
                            <h3 style="margin: 0;">Broker VM</h3>
                            <div style="color: #8b949e;">On-premises log collection for syslog and Windows events</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="color: #3fb950;">Supported Protocols</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem;">
                                <li><strong>Syslog:</strong> UDP/TCP 514, TLS 6514</li>
                                <li><strong>Windows Event Forwarding:</strong> WinRM-based</li>
                                <li><strong>File monitoring:</strong> Watch directories for log files</li>
                                <li><strong>Database:</strong> JDBC connectors (limited)</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: #d29922;">When to Use</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem;">
                                <li>Firewalls (Palo Alto, Cisco, Fortinet)</li>
                                <li>Network devices (routers, switches)</li>
                                <li>Legacy servers that can't run agents</li>
                                <li>OT/ICS environments</li>
                                <li>Air-gapped or regulated networks</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="margin-top: 16px; padding: 16px; background: #21262d; border-radius: 8px;">
                        <strong style="color: #3fb950;">Sizing Quick Reference:</strong>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 8px; font-size: 0.85rem;">
                            <div style="text-align: center;">
                                <div style="color: #58a6ff; font-weight: 600;">5K EPS</div>
                                <div style="color: #8b949e;">4 vCPU / 16GB</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="color: #58a6ff; font-weight: 600;">15K EPS</div>
                                <div style="color: #8b949e;">8 vCPU / 32GB</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="color: #58a6ff; font-weight: 600;">40K EPS</div>
                                <div style="color: #8b949e;">16 vCPU / 64GB</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="color: #58a6ff; font-weight: 600;">40K+ EPS</div>
                                <div style="color: #8b949e;">Multiple VMs</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="ingestion-card">
                    <div class="ingestion-header">
                        <div class="ingestion-icon" style="background: #4d3a0d; color: #d29922;"><i class="fas fa-cloud"></i></div>
                        <div>
                            <h3 style="margin: 0;">Cloud Collectors</h3>
                            <div style="color: #8b949e;">API-based collection from cloud platforms and SaaS</div>
                        </div>
                    </div>
                    
                    <h4 style="color: #3fb950;">Available Cloud Collectors</h4>
                    <div class="styled-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Platform</th>
                                    <th>Data Sources</th>
                                    <th>Setup Complexity</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>AWS</strong></td>
                                    <td>CloudTrail, GuardDuty, VPC Flow Logs, Security Hub, S3 access logs</td>
                                    <td>Medium (IAM role setup)</td>
                                </tr>
                                <tr>
                                    <td><strong>Azure</strong></td>
                                    <td>Activity Log, Entra ID (Azure AD), Microsoft 365, Defender alerts</td>
                                    <td>Medium (App registration)</td>
                                </tr>
                                <tr>
                                    <td><strong>GCP</strong></td>
                                    <td>Cloud Audit Logs, VPC Flow Logs, Security Command Center</td>
                                    <td>Medium (Service account)</td>
                                </tr>
                                <tr>
                                    <td><strong>Okta</strong></td>
                                    <td>System logs, authentication events, admin actions</td>
                                    <td>Easy (API token)</td>
                                </tr>
                                <tr>
                                    <td><strong>Microsoft 365</strong></td>
                                    <td>Audit logs, email events, SharePoint, Teams</td>
                                    <td>Medium (Graph API setup)</td>
                                </tr>
                                <tr>
                                    <td><strong>Salesforce</strong></td>
                                    <td>Login history, setup audit trail, event monitoring</td>
                                    <td>Easy (Connected app)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Enterprise Data Strategy -->
                <h2><i class="fas fa-building"></i> Enterprise Data Ingestion Strategy</h2>
                
                <div class="enterprise-scenario">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                        <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #58a6ff, #3fb950); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-hospital" style="font-size: 1.2rem;"></i>
                        </div>
                        <div>
                            <div style="font-size: 1.1rem; font-weight: 600;">Case Study: Healthcare Organization</div>
                            <div style="font-size: 0.8rem; color: #8b949e;">10,000 employees | HIPAA compliance | Hybrid cloud</div>
                        </div>
                    </div>

                    <h4 style="color: #58a6ff;">Data Source Inventory</h4>
<pre style="color: #8b949e; font-size: 0.8rem; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
┌────────────────────────────────────────────────────────────────────────────────────────┐
│                           DATA SOURCE ARCHITECTURE                                      │
├────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                         │
│  ENDPOINTS (8,500 devices)                          CLOUD (AWS + Azure)                │
│  ├── Windows workstations (7,000) ──► XDR Agent    ├── AWS CloudTrail ──► Cloud Collector  │
│  ├── Windows servers (800) ──► XDR Agent           ├── AWS GuardDuty ──► Cloud Collector   │
│  ├── macOS laptops (500) ──► XDR Agent             ├── Azure AD ──► Cloud Collector        │
│  └── Linux servers (200) ──► XDR Agent             └── M365 audit ──► Cloud Collector      │
│                                                                                         │
│  NETWORK (via Broker VM)                           SAAS APPLICATIONS                   │
│  ├── Palo Alto NGFW (4) ──► Syslog TCP             ├── Okta ──► Cloud Collector           │
│  ├── Cisco switches (50) ──► Syslog UDP            ├── Salesforce ──► Cloud Collector     │
│  ├── F5 load balancers (4) ──► Syslog TCP          └── ServiceNow ──► HTTP Collector      │
│  └── DNS servers (4) ──► Syslog TCP                                                    │
│                                                                                         │
│  MEDICAL DEVICES (special handling)                IDENTITY                            │
│  ├── PACS servers ──► Broker VM (file monitoring)  ├── Active Directory ──► Broker VM (WEF)│
│  └── Medical IoT ──► Network monitoring only       └── Ping Identity ──► HTTP Collector   │
│                                                                                         │
└────────────────────────────────────────────────────────────────────────────────────────┘
</pre>

                    <h4 style="color: #d29922;">Estimated Daily Volume</h4>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin: 16px 0;">
                        <div style="background: #21262d; padding: 12px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: #58a6ff;">~50 GB</div>
                            <div style="font-size: 0.75rem; color: #8b949e;">XDR Agent</div>
                        </div>
                        <div style="background: #21262d; padding: 12px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: #3fb950;">~80 GB</div>
                            <div style="font-size: 0.75rem; color: #8b949e;">Firewall Logs</div>
                        </div>
                        <div style="background: #21262d; padding: 12px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: #d29922;">~15 GB</div>
                            <div style="font-size: 0.75rem; color: #8b949e;">Cloud Logs</div>
                        </div>
                        <div style="background: #21262d; padding: 12px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: #a371f7;">~5 GB</div>
                            <div style="font-size: 0.75rem; color: #8b949e;">SaaS/Identity</div>
                        </div>
                        <div style="background: #21262d; padding: 12px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: #f0f6fc;">~150 GB</div>
                            <div style="font-size: 0.75rem; color: #8b949e;">Total/Day</div>
                        </div>
                    </div>

                    <h4 style="color: #3fb950;">Architecture Decisions & Rationale</h4>
                    <div style="background: #161b22; padding: 16px; border-radius: 8px;">
                        <div style="margin-bottom: 12px;">
                            <strong style="color: #f0f6fc;">Why XDR agents on all endpoints?</strong>
                            <p style="color: #8b949e; margin: 4px 0 0 0; font-size: 0.9rem;">HIPAA requires detailed audit trails. Agent telemetry provides process-level visibility for PHI access investigation. Network logs alone can't tell you WHAT was accessed.</p>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <strong style="color: #f0f6fc;">Why Broker VM for medical devices?</strong>
                            <p style="color: #8b949e; margin: 4px 0 0 0; font-size: 0.9rem;">PACS servers can't run agents (FDA-approved software only). Use file-based log collection instead. Medical IoT gets network-only monitoring via NGFW.</p>
                        </div>
                        <div>
                            <strong style="color: #f0f6fc;">Why not Cloud Collector for ServiceNow?</strong>
                            <p style="color: #8b949e; margin: 4px 0 0 0; font-size: 0.9rem;">No native XSIAM integration exists. Built custom webhook integration to HTTP Collector instead. Takes 2 hours to set up vs waiting for vendor support.</p>
                        </div>
                    </div>
                </div>

                <!-- Cost Optimization -->
                <h2><i class="fas fa-dollar-sign"></i> Cost Optimization Strategies</h2>
                
                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-exclamation-triangle"></i> Understanding XSIAM Pricing</h4>
                    <p>XSIAM pricing typically includes:</p>
                    <ul>
                        <li><strong>Per-endpoint licensing:</strong> XDR agent coverage</li>
                        <li><strong>Data ingestion:</strong> GB/day for non-endpoint data</li>
                        <li><strong>Retention:</strong> Additional cost for extended retention</li>
                    </ul>
                    <p style="color: #d29922;"><strong>Key insight:</strong> XDR agent data is usually included in endpoint licensing. SIEM-style log ingestion is where costs add up.</p>
                </div>

                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Strategy</th>
                                <th>How It Works</th>
                                <th>Potential Savings</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Filter at source</strong></td>
                                <td>Only send security-relevant logs. Don't ingest debug/info level.</td>
                                <td>30-50% volume reduction</td>
                            </tr>
                            <tr>
                                <td><strong>Use XDR agents vs syslog</strong></td>
                                <td>Agent data often included in licensing. Syslog costs extra.</td>
                                <td>Varies by contract</td>
                            </tr>
                            <tr>
                                <td><strong>Retention tiering</strong></td>
                                <td>Hot for 30 days, warm for 90, cold for compliance.</td>
                                <td>40-60% on storage</td>
                            </tr>
                            <tr>
                                <td><strong>Aggregate before sending</strong></td>
                                <td>Summarize high-volume sources (e.g., DNS queries by hour)</td>
                                <td>Up to 90% for specific sources</td>
                            </tr>
                            <tr>
                                <td><strong>Exclude non-security logs</strong></td>
                                <td>Don't ingest application performance logs unless needed</td>
                                <td>20-40% typical</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you approach data ingestion planning for a new XSIAM deployment?</button>
                        <div class="qa-answer">
                            <p><strong>My systematic approach:</strong></p>
                            <ol>
                                <li><strong>Inventory data sources:</strong> Create complete list of endpoints, network devices, cloud platforms, SaaS apps</li>
                                <li><strong>Classify by method:</strong> For each source, determine the appropriate ingestion method (agent, Broker VM, cloud collector, HTTP)</li>
                                <li><strong>Estimate volumes:</strong> Calculate expected GB/day per source. This drives sizing and cost.</li>
                                <li><strong>Prioritize for security value:</strong> Not all logs are equal. Prioritize:
                                    <ul>
                                        <li>High: Endpoint telemetry, authentication, firewall</li>
                                        <li>Medium: Cloud audit, email, DNS</li>
                                        <li>Lower: Application logs, infrastructure metrics</li>
                                    </ul>
                                </li>
                                <li><strong>Plan infrastructure:</strong> Size Broker VMs, plan cloud collector credentials, map network flows</li>
                                <li><strong>Phase the rollout:</strong> Start with high-priority sources, validate parsing, then expand</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: When would you use Broker VM vs Cloud Collector?</button>
                        <div class="qa-answer">
                            <p><strong>Use Broker VM when:</strong></p>
                            <ul>
                                <li>Source only supports syslog (most network devices)</li>
                                <li>Source can't reach internet directly (air-gapped, regulated)</li>
                                <li>You need Windows Event Forwarding</li>
                                <li>Local buffering is important (unreliable WAN)</li>
                            </ul>
                            <p><strong>Use Cloud Collector when:</strong></p>
                            <ul>
                                <li>Source is a cloud platform (AWS, Azure, GCP)</li>
                                <li>Source is a SaaS app with XSIAM integration</li>
                                <li>You want zero infrastructure to manage</li>
                                <li>Native API provides richer data than syslog would</li>
                            </ul>
                            <p><strong>Example decision:</strong> Okta → Cloud Collector (native integration, richer data). Cisco ASA firewall → Broker VM (syslog only).</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle high-volume log sources to control costs?</button>
                        <div class="qa-answer">
                            <p><strong>Strategies for high-volume sources:</strong></p>
                            <ol>
                                <li><strong>Filter at source:</strong> Configure device to only send security-relevant events. For firewalls, skip "allow" logs for internal traffic, focus on denies and external connections.</li>
                                <li><strong>Sampling:</strong> For extremely high-volume sources (DNS, netflow), consider statistical sampling if full fidelity isn't needed.</li>
                                <li><strong>Aggregation:</strong> Instead of every DNS query, send hourly summaries of unique queries per host.</li>
                                <li><strong>Tiered retention:</strong> High-volume logs get shorter retention (7-30 days) while critical logs get longer (1 year).</li>
                                <li><strong>Pre-processing:</strong> Use Broker VM parsing to drop noise before it reaches XSIAM.</li>
                            </ol>
                            <p><strong>Real example:</strong> "A client's DNS servers generated 500 GB/day. We filtered to only forward queries to known-bad domains and first-seen domains. Volume dropped to 5 GB/day while maintaining detection capability."</p>
                        </div>
                    </div>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium - Security Operations Reference</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
