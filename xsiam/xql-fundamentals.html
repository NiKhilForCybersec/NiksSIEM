<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XQL Fundamentals | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
                <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link active"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>




        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Xql Fundamentals</span>
                </div>

                <h1><i class="fas fa-terminal"></i> XQL Fundamentals</h1>
                <p class="lead">Master the fundamentals of XQL (XSIAM Query Language). Learn query structure, operators, functions, and build your first hunting queries step by step.</p>

                <!-- XQL Overview -->
                <h2><i class="fas fa-info-circle"></i> XQL Overview</h2>
                <div class="config-section">
                    <h4>What is XQL?</h4>
                    <div class="arch-diagram">XQL (XSIAM Query Language):

PURPOSE:
├── Query data across all XSIAM datasets
├── Threat hunting and investigation
├── Create custom alerts and dashboards
├── Data exploration and analysis
└── Automation and reporting

XQL vs OTHER QUERY LANGUAGES:
┌────────────────────────────────────────────────────────────┐
│  XQL          │  KQL (Microsoft)  │  SPL (Splunk)         │
├───────────────┼───────────────────┼───────────────────────┤
│  dataset =    │  TableName        │  index=               │
│  | filter     │  | where          │  | search / where     │
│  | fields     │  | project        │  | fields / table     │
│  | comp       │  | summarize      │  | stats              │
│  | sort       │  | order by       │  | sort               │
│  | limit      │  | take           │  | head               │
└───────────────┴───────────────────┴───────────────────────┘

QUERY INTERFACE:
Path: Investigation → Query Center
├── Query Editor
├── Dataset Browser
├── Saved Queries
├── Query History
└── Results Visualization</div>

                    <h4>Basic Query Structure</h4>
                    <div class="arch-diagram">XQL QUERY ANATOMY:

┌─────────────────────────────────────────────────────────────┐
│                    XQL QUERY STRUCTURE                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  dataset = xdr_data                    ← DATA SOURCE        │
│  | filter event_type = ENUM.PROCESS    ← FILTERING          │
│  | filter action_process_image_name    ← FILTERING          │
│        contains "powershell"                                │
│  | fields timestamp, agent_hostname,   ← SELECT FIELDS      │
│          action_process_image_name,                         │
│          action_process_command_line                        │
│  | sort desc timestamp                 ← ORDERING           │
│  | limit 100                           ← ROW LIMIT          │
│                                                             │
└─────────────────────────────────────────────────────────────┘

KEY COMPONENTS:
├── dataset: Specifies data source (required)
├── filter: Conditions to match (like WHERE)
├── fields: Columns to return (like SELECT)
├── comp: Aggregations (like GROUP BY)
├── sort: Order results
├── limit: Restrict row count
└── Pipe (|): Chains operations together

EXECUTION ORDER:
1. dataset → Select data source
2. filter → Apply conditions (can be multiple)
3. fields → Select output columns
4. comp → Perform aggregations
5. sort → Order results
6. limit → Restrict output</div>
                </div>

                <!-- Datasets -->
                <h2><i class="fas fa-database"></i> Datasets</h2>
                <div class="config-section">
                    <h4>Core Datasets</h4>
                    <div class="arch-diagram">XSIAM DATASETS:

ENDPOINT DATA:
├── xdr_data: Primary endpoint telemetry
│   ├── Process events
│   ├── Network connections
│   ├── File events
│   ├── Registry events
│   └── Module loads
├── endpoints: Endpoint inventory
└── endpoint_groups: Group membership

ALERT AND INCIDENT DATA:
├── alerts: All alerts
├── incidents: Correlated incidents
└── alert_raw_data: Raw alert details

NETWORK AND CLOUD:
├── cloud_audit_logs: Cloud provider logs
├── network_logs: Firewall/network data
└── identity_logs: Authentication events

THIRD-PARTY:
├── panw_ngfw_traffic: Palo Alto firewall
├── panw_ngfw_threat: Firewall threats
└── [custom datasets]: Your ingested data

EXPLORING DATASETS:
// List available fields in dataset
dataset = xdr_data
| fields *
| limit 1

// Check data freshness
dataset = xdr_data
| comp latest_timestamp = max(timestamp)

// Count records per event type
dataset = xdr_data
| comp count() by event_type</div>

                    <h4>Common Fields in xdr_data</h4>
                    <div class="arch-diagram">XDR_DATA KEY FIELDS:

EVENT IDENTIFICATION:
├── event_id: Unique event identifier
├── event_type: Type (PROCESS, FILE, NETWORK, etc.)
├── event_sub_type: Sub-category
└── timestamp: Event time (Unix epoch)

ENDPOINT INFORMATION:
├── agent_hostname: Device name
├── agent_ip_addresses: Device IP(s)
├── agent_os_type: Windows/Linux/macOS
├── agent_os_sub_type: Version details
└── agent_id: Unique agent identifier

PROCESS FIELDS:
├── action_process_image_name: Process filename
├── action_process_image_path: Full path
├── action_process_command_line: Command line
├── action_process_image_sha256: File hash
├── action_process_signature_status: Signed/Unsigned
├── actor_process_image_name: Parent process
├── actor_process_command_line: Parent command line
└── causality_actor_process_image_name: Root process

NETWORK FIELDS:
├── action_remote_ip: Destination IP
├── action_remote_port: Destination port
├── action_local_ip: Source IP
├── action_local_port: Source port
└── action_external_hostname: DNS name

FILE FIELDS:
├── action_file_name: Filename
├── action_file_path: Full path
├── action_file_sha256: File hash
└── action_file_size: Size in bytes

USER FIELDS:
├── actor_effective_username: User executing
├── actor_primary_username: Primary user
└── auth_domain: Domain name</div>
                </div>

                <!-- Decision Tree: XQL Query Approach -->
                <div class="decision-tree">
                    <h3><i class="fas fa-sitemap"></i> Decision Tree: Choose Your Query Approach</h3>
                    
                    <div class="decision-node">
                        <i class="fas fa-question-circle"></i>
                        <strong>What are you trying to find?</strong>
                        <small>Determine your investigation goal first</small>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background-color: #58a6ff;">Specific Event/Hash/IP</div>
                        <div class="decision-outcome" style="border-left-color: #58a6ff;">
                            <i class="fas fa-search" style="color: #58a6ff;"></i>
                            <strong>Use: filter + fields</strong>
                            <small><code>dataset = xdr_data | filter action_file_sha256 = "abc123..." | fields *</code></small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background-color: #3fb950;">Pattern/Behavior</div>
                        <div class="decision-node">
                            <i class="fas fa-question-circle"></i>
                            <strong>Do you need aggregation (counts, stats)?</strong>
                            <small>Looking for trends vs individual events</small>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow yes">YES</div>
                            <div class="decision-outcome" style="border-left-color: #3fb950;">
                                <i class="fas fa-chart-bar" style="color: #3fb950;"></i>
                                <strong>Use: filter + comp + sort</strong>
                                <small><code>| filter ... | comp count() by hostname | sort desc count()</code></small>
                            </div>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow no">NO</div>
                            <div class="decision-outcome" style="border-left-color: #d29922;">
                                <i class="fas fa-list" style="color: #d29922;"></i>
                                <strong>Use: filter + fields + sort</strong>
                                <small><code>| filter ... | fields timestamp, hostname, ... | sort desc timestamp</code></small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background-color: #a371f7;">Cross-Dataset Correlation</div>
                        <div class="decision-outcome" style="border-left-color: #a371f7;">
                            <i class="fas fa-project-diagram" style="color: #a371f7;"></i>
                            <strong>Use: join or union</strong>
                            <small><code>dataset = xdr_data | join (dataset = alerts) on agent_id</code> | See XQL Advanced</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background-color: #f85149;">Anomaly/Outlier Detection</div>
                        <div class="decision-outcome" style="border-left-color: #f85149;">
                            <i class="fas fa-exclamation-triangle" style="color: #f85149;"></i>
                            <strong>Use: comp + baseline comparison</strong>
                            <small>Aggregate normal behavior, filter for deviations | Consider correlation rules for automation</small>
                        </div>
                    </div>
                </div>

                <!-- XQL Query Building Flow -->
                <h2><i class="fas fa-project-diagram"></i> Query Building Workflow</h2>
                <div class="flow-diagram">
                    <div class="flow-step" style="border-left-color: #58a6ff;">
                        <div class="flow-icon"><i class="fas fa-database"></i></div>
                        <div class="flow-content">
                            <h4>1. Choose Dataset</h4>
                            <ul>
                                <li><code>dataset = xdr_data</code> for endpoint telemetry</li>
                                <li><code>dataset = alerts</code> for security alerts</li>
                                <li><code>dataset = cloud_audit_logs</code> for cloud</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #3fb950;">
                        <div class="flow-icon"><i class="fas fa-clock"></i></div>
                        <div class="flow-content">
                            <h4>2. Set Time Range</h4>
                            <ul>
                                <li>Use preset in UI: 1h, 24h, 7d, 30d</li>
                                <li>Or filter: <code>timestamp > now() - 1d</code></li>
                                <li>Narrow = faster queries</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #d29922;">
                        <div class="flow-icon"><i class="fas fa-filter"></i></div>
                        <div class="flow-content">
                            <h4>3. Apply Filters</h4>
                            <ul>
                                <li>Start broad, then narrow</li>
                                <li>Use ENUMs: <code>event_type = ENUM.PROCESS</code></li>
                                <li>Chain with <code>|</code> pipe operator</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #a371f7;">
                        <div class="flow-icon"><i class="fas fa-columns"></i></div>
                        <div class="flow-content">
                            <h4>4. Select/Transform</h4>
                            <ul>
                                <li><code>fields</code> to select columns</li>
                                <li><code>alter</code> to create new fields</li>
                                <li><code>comp</code> to aggregate</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #f85149;">
                        <div class="flow-icon"><i class="fas fa-sort-amount-down"></i></div>
                        <div class="flow-content">
                            <h4>5. Sort & Limit</h4>
                            <ul>
                                <li><code>sort desc timestamp</code> newest first</li>
                                <li><code>sort desc count()</code> top results</li>
                                <li><code>limit 100</code> cap output</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Filter Operations -->
                <h2><i class="fas fa-filter"></i> Filter Operations</h2>
                <div class="config-section">
                    <h4>Comparison Operators</h4>
                    <div class="arch-diagram">COMPARISON OPERATORS:

EQUALITY:
= or ~=        Equal (case-insensitive with ~=)
!= or ~!=      Not equal

// Example
| filter action_process_image_name = "powershell.exe"
| filter actor_effective_username ~= "admin"  // case-insensitive

NUMERIC COMPARISONS:
< > <= >=      Less/greater than

// Example
| filter action_file_size > 1000000  // Files > 1MB
| filter action_remote_port < 1024   // Privileged ports

STRING MATCHING:
contains       Contains substring (case-sensitive)
~contains      Contains (case-insensitive)
!contains      Does not contain

// Example
| filter action_process_command_line ~contains "download"
| filter action_file_path contains "\\Temp\\"

PATTERN MATCHING:
~= "pattern"   Regex match

// Example
| filter action_process_image_name ~= "^cmd\.exe$"
| filter action_remote_ip ~= "^10\\..*"

NULL CHECKS:
= null         Is null/empty
!= null        Is not null

// Example
| filter action_process_command_line != null</div>

                    <h4>Logical Operators</h4>
                    <div class="arch-diagram">LOGICAL OPERATORS:

AND (implicit when chaining filters):
| filter event_type = ENUM.PROCESS
| filter action_process_image_name = "powershell.exe"
// Both conditions must be true

OR (explicit):
| filter action_process_image_name = "powershell.exe" 
    or action_process_image_name = "cmd.exe"

// Alternative with in()
| filter action_process_image_name in ("powershell.exe", "cmd.exe")

NOT:
| filter action_process_image_name not in ("explorer.exe", "svchost.exe")

COMBINED EXAMPLE:
dataset = xdr_data
| filter event_type = ENUM.PROCESS
| filter (action_process_image_name = "powershell.exe" 
    or action_process_image_name = "cmd.exe")
| filter action_process_command_line ~contains "download"
| filter actor_effective_username not in ("SYSTEM", "LOCAL SERVICE")

ENUM VALUES:
// Use ENUM for typed values
| filter event_type = ENUM.PROCESS
| filter event_type = ENUM.NETWORK
| filter event_type = ENUM.FILE
| filter event_type = ENUM.REGISTRY</div>
                </div>

                <!-- Aggregations -->
                <h2><i class="fas fa-chart-bar"></i> Aggregations with comp</h2>
                <div class="config-section">
                    <h4>Basic Aggregations</h4>
                    <div class="arch-diagram">AGGREGATION FUNCTIONS:

COUNT:
count()        Count all rows
count(field)   Count non-null values

// Example
| comp count() by action_process_image_name
| comp total = count(), unique_hosts = count_distinct(agent_hostname)

DISTINCT COUNT:
count_distinct(field)   Unique values

// Example
| comp unique_ips = count_distinct(action_remote_ip)

NUMERIC AGGREGATIONS:
sum(field)     Sum values
avg(field)     Average
min(field)     Minimum
max(field)     Maximum

// Example
| comp total_bytes = sum(action_file_size),
       avg_bytes = avg(action_file_size)

STRING AGGREGATIONS:
values(field)       Collect unique values (array)
first(field)        First value
last(field)         Last value

// Example
| comp hostnames = values(agent_hostname),
       first_seen = min(timestamp),
       last_seen = max(timestamp)
  by action_remote_ip</div>

                    <h4>Grouping with comp</h4>
                    <div class="arch-diagram">GROUPING EXAMPLES:

// Count by single field
dataset = xdr_data
| filter event_type = ENUM.PROCESS
| comp count() by action_process_image_name
| sort desc count()
| limit 20

// Count by multiple fields
dataset = xdr_data
| filter event_type = ENUM.NETWORK
| comp count() by agent_hostname, action_remote_ip, action_remote_port
| sort desc count()

// Time-based grouping
dataset = xdr_data
| filter event_type = ENUM.PROCESS
| comp count() by bin(timestamp, 1h)
| sort asc _bin_timestamp

// Complex aggregation
dataset = xdr_data
| filter event_type = ENUM.NETWORK
| filter action_remote_port = 443
| comp 
    connection_count = count(),
    unique_hosts = count_distinct(agent_hostname),
    first_seen = min(timestamp),
    last_seen = max(timestamp)
  by action_remote_ip
| filter connection_count > 100
| sort desc connection_count</div>
                </div>

                <!-- Common Query Patterns -->
                <h2><i class="fas fa-code"></i> Common Query Patterns</h2>
                <div class="config-section">
                    <h4>Process Hunting</h4>
                    <div class="arch-diagram">// Find PowerShell execution
dataset = xdr_data
| filter event_type = ENUM.PROCESS
| filter action_process_image_name ~contains "powershell"
| fields timestamp, agent_hostname, actor_effective_username,
        action_process_image_name, action_process_command_line
| sort desc timestamp
| limit 100

// Encoded command detection
dataset = xdr_data
| filter event_type = ENUM.PROCESS
| filter action_process_image_name ~contains "powershell"
| filter action_process_command_line ~contains "-enc"
| fields timestamp, agent_hostname, action_process_command_line
| sort desc timestamp

// Process execution from temp folders
dataset = xdr_data
| filter event_type = ENUM.PROCESS
| filter action_process_image_path ~contains "\\Temp\\"
    or action_process_image_path ~contains "\\tmp\\"
| comp count() by action_process_image_name, action_process_image_path
| sort desc count()</div>

                    <h4>Network Hunting</h4>
                    <div class="arch-diagram">// External connections
dataset = xdr_data
| filter event_type = ENUM.NETWORK
| filter action_remote_ip != null
| filter action_remote_ip not ~= "^(10\\.|172\\.(1[6-9]|2[0-9]|3[01])\\.|192\\.168\\.)"
| comp count() by agent_hostname, action_remote_ip, action_remote_port
| sort desc count()
| limit 100

// Connections on non-standard ports
dataset = xdr_data
| filter event_type = ENUM.NETWORK
| filter action_remote_port not in (80, 443, 53, 22, 25, 587, 993)
| comp count() by action_remote_ip, action_remote_port
| sort desc count()

// Process making network connections
dataset = xdr_data
| filter event_type = ENUM.NETWORK
| filter action_process_image_name = "powershell.exe"
| comp unique_destinations = count_distinct(action_remote_ip),
       total_connections = count()
  by agent_hostname
| filter unique_destinations > 5</div>

                    <h4>File Activity</h4>
                    <div class="arch-diagram">// Files created in suspicious locations
dataset = xdr_data
| filter event_type = ENUM.FILE
| filter event_sub_type = ENUM.FILE_CREATE_NEW
| filter action_file_path ~contains "\\Users\\Public\\"
    or action_file_path ~contains "\\Temp\\"
| fields timestamp, agent_hostname, action_file_name, action_file_path
| sort desc timestamp

// Executable file creation
dataset = xdr_data
| filter event_type = ENUM.FILE
| filter event_sub_type = ENUM.FILE_CREATE_NEW
| filter action_file_name ~= "\\.(exe|dll|bat|ps1|vbs|js)$"
| comp count() by agent_hostname, action_file_path
| sort desc count()</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through how you would build an XQL query to hunt for suspicious PowerShell activity.</button>
                        <div class="qa-answer">
                            <p>I approach PowerShell hunting in layers, starting broad and then narrowing based on what I find. My first query is always to understand the baseline—what PowerShell activity exists in the environment and how much of it there is.</p>
                            <p>I start with <code>dataset = xdr_data | filter event_type = ENUM.PROCESS | filter action_process_image_name ~contains "powershell" | comp count() by agent_hostname | sort desc count()</code>. This tells me which hosts have the most PowerShell activity. If one host has 10x more than others, that's already interesting.</p>
                            <p>Next, I look for known bad indicators—encoded commands, download cradles, bypass flags. The query becomes <code>| filter action_process_command_line ~contains "-enc" or action_process_command_line ~contains "downloadstring" or action_process_command_line ~contains "-ep bypass"</code>. I use the tilde operators for case-insensitive matching because attackers vary their casing.</p>
                            <p>For the results, I select the fields that matter for investigation: <code>| fields timestamp, agent_hostname, actor_effective_username, actor_process_image_name, action_process_command_line</code>. The actor_process_image_name shows me what launched PowerShell—if it's explorer.exe, that's normal; if it's word.exe or wscript.exe, that's suspicious.</p>
                            <p>Finally, I sort by timestamp descending and limit to a manageable set. If I find something, I pivot on the agent_hostname to see all activity from that host, or on the user to track lateral movement.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does XQL compare to SPL (Splunk) and KQL (Microsoft)? What are the key differences?</button>
                        <div class="qa-answer">
                            <p>The three languages share a lot of conceptual overlap since they're all designed for security log analysis, but each has its quirks. If you know one, you can learn the others quickly, but the syntax differences can trip you up.</p>
                            <p>The data source declaration is different: XQL uses <code>dataset = xdr_data</code>, Splunk uses <code>index=main</code>, and KQL just starts with the table name like <code>SecurityEvent</code>. XQL and KQL both use pipe operators to chain operations, which feels natural coming from Unix. Splunk does too, but it also supports implicit piping which can be confusing.</p>
                            <p>Filtering syntax varies: XQL has <code>filter field = value</code>, KQL has <code>where field == value</code>, and Splunk has <code>search field=value</code> or <code>where field="value"</code>. The operators for string matching are different too—XQL uses <code>~contains</code>, KQL uses <code>has</code> or <code>contains</code>, and Splunk uses wildcards or the <code>like</code> function.</p>
                            <p>Aggregation is where I see the most confusion. XQL uses <code>comp count() by field</code>, KQL uses <code>summarize count() by field</code>, and Splunk uses <code>stats count by field</code>. All conceptually identical, but the keywords are different.</p>
                            <p>The biggest practical difference is in the underlying data model. XQL is optimized for XDR telemetry with strongly-typed ENUM fields for event types. KQL works with Log Analytics tables that can have varying schemas. Splunk is the most flexible—it can handle almost any data but requires more configuration. When I switch between platforms, I spend the first few minutes re-learning the syntax, but the hunting methodology stays the same.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What are the key datasets in XSIAM and when would you use each one?</button>
                        <div class="qa-answer">
                            <p>XSIAM organizes data into purpose-specific datasets, and knowing which to query saves a lot of time. The main ones I work with daily are xdr_data, alerts, incidents, and endpoints.</p>
                            <p><code>xdr_data</code> is the workhorse—it contains endpoint telemetry including process execution, network connections, file events, registry changes, and module loads. When I'm threat hunting or investigating how an attack progressed, this is where I start. The event_type field uses ENUMs like ENUM.PROCESS, ENUM.NETWORK, ENUM.FILE to filter down to specific activity types.</p>
                            <p><code>alerts</code> contains all security alerts from detection rules, including both built-in and custom rules. I query this when I want to see alert trends, find alerts associated with a specific host or user, or check if a particular indicator triggered any detections. It's also useful for measuring detection coverage.</p>
                            <p><code>incidents</code> is for correlated incidents that group related alerts. When I'm doing incident response, I query this to understand the full scope—which hosts were involved, what alerts are connected, and the incident timeline. The correlation often reveals connections I wouldn't see by looking at individual alerts.</p>
                            <p><code>endpoints</code> is the asset inventory—I use it to look up endpoint details, check agent versions, or identify endpoints in specific groups. It's essential for scoping investigations: "Show me all the endpoints in the Finance department" becomes a join between endpoints and xdr_data.</p>
                            <p>For network and cloud data, there are datasets like <code>panw_ngfw_traffic</code> for firewall logs and <code>cloud_audit_logs</code> for cloud provider activity. Custom data sources you onboard get their own datasets following the pattern vendor_product_raw.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Explain the difference between filter and comp in XQL. When do you use each?</button>
                        <div class="qa-answer">
                            <p>This is fundamental to XQL query structure. <code>filter</code> reduces rows based on conditions—it's like a WHERE clause in SQL. <code>comp</code> performs aggregation and grouping—it's like GROUP BY with aggregate functions. They serve completely different purposes but work together in most queries.</p>
                            <p><code>filter</code> comes early in the query to narrow down the data before processing. Each filter condition reduces the result set. You can chain multiple filters, and they're evaluated in order. For example, <code>| filter event_type = ENUM.PROCESS | filter action_process_image_name ~contains "powershell"</code> first gets all process events, then filters to just PowerShell.</p>
                            <p><code>comp</code> comes after filtering when you want to aggregate data. It groups rows and calculates statistics. Common functions include count(), count_distinct(), sum(), avg(), min(), max(), and values(). The "by" clause specifies grouping. For example, <code>| comp connection_count = count() by agent_hostname, action_remote_ip</code> gives me connection counts per host per destination.</p>
                            <p>You can also filter after comp to work with aggregated results. The query <code>| comp count() by hostname | filter count() > 100</code> first counts events per host, then shows only hosts with more than 100 events. This is a common pattern for finding outliers.</p>
                            <p>The order matters: filter first to reduce data, then comp to aggregate, then optionally filter again on the aggregated values, then sort and limit for the final output.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you detect processes running from unusual locations using XQL?</button>
                        <div class="qa-answer">
                            <p>This is a classic threat hunting technique because attackers often drop malware in writable directories that aren't typical execution paths. My approach combines path filtering with aggregation to find anomalies.</p>
                            <p>First, I define what "unusual" means. Common suspicious locations include temp directories, user Downloads, ProgramData, Recycle Bin, and anywhere in the user profile that isn't the standard AppData folders. The query starts with: <code>dataset = xdr_data | filter event_type = ENUM.PROCESS | filter action_process_image_path ~contains "\\Temp\\" or action_process_image_path ~contains "\\Downloads\\" or action_process_image_path ~contains "\\ProgramData\\" or action_process_image_path ~contains "\\Users\\Public\\"</code></p>
                            <p>Then I aggregate to see patterns: <code>| comp execution_count = count(), unique_hosts = count_distinct(agent_hostname) by action_process_image_name, action_process_image_path</code>. This tells me which processes from unusual locations are running and how widespread they are. A process on one host might be a targeted attack; the same process on 50 hosts is probably legitimate software installed badly.</p>
                            <p>I also look at the parent process to understand context: <code>| fields timestamp, agent_hostname, actor_process_image_name, action_process_image_name, action_process_image_path, action_process_command_line</code>. If explorer.exe launched something from Downloads, a user probably double-clicked it. If cmd.exe or powershell.exe launched something from Temp, that's more suspicious.</p>
                            <p>For production rules, I'd add exclusions for known-good software that legitimately runs from these paths—installers, updaters, some IT management tools. But for initial hunting, I keep it broad and triage manually.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What are common mistakes you see people make with XQL queries, and how do you avoid them?</button>
                        <div class="qa-answer">
                            <p>I've seen—and made—quite a few XQL mistakes over time. The most common ones are around query efficiency, field selection, and operator misuse.</p>
                            <p>The biggest performance mistake is not filtering early enough. People will run <code>dataset = xdr_data | fields timestamp, hostname | filter event_type = ENUM.PROCESS</code> instead of filtering first. Always put your filters as early as possible—it dramatically reduces the data the query engine has to process. The correct order is dataset, then filter, then everything else.</p>
                            <p>Another common mistake is forgetting that string comparisons are case-sensitive by default. <code>filter action_process_image_name = "PowerShell.exe"</code> won't match "powershell.exe". Use the tilde operators: <code>~=</code> for case-insensitive equals, <code>~contains</code> for case-insensitive contains. This catches attacker attempts at case obfuscation.</p>
                            <p>People often misuse the time range. Running a query over 30 days when you only need 24 hours wastes resources and makes results harder to analyze. Be deliberate about your time window—start narrow and expand if needed.</p>
                            <p>With comp aggregations, a common error is forgetting that comp changes the result structure. After <code>comp count() by hostname</code>, you can't reference original fields like action_process_image_name anymore—only hostname and the count. If you need both raw data and aggregations, you might need two separate queries or use subqueries.</p>
                            <p>Finally, not using ENUM values for event_type is a subtle bug. Writing <code>filter event_type = "PROCESS"</code> (string) instead of <code>filter event_type = ENUM.PROCESS</code> might work in some contexts but fail in others. Always use the proper ENUM syntax for type safety.</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>