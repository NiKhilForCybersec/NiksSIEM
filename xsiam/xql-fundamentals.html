<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XQL Query Language Fundamentals | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam active"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="../splunk/index.html" class="platform-tab splunk"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
<nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">XSIAM Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> vs Competitors</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM</a>
                    <a href="agents.html" class="nav-link"><i class="fas fa-desktop"></i> Cortex Agents</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & XDM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link active"><i class="fas fa-terminal"></i> Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="correlation-rules.html" class="nav-link"><i class="fas fa-bell"></i> Correlation Rules</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention Tiers</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">XQL Fundamentals</span>
                </div>
                <div class="top-actions">
                    <button class="top-btn" onclick="window.print()"><i class="fas fa-print"></i> Print</button>
                </div>
            </header>
            <main class="main-content">
<header class="page-header">
            <h1>XQL Fundamentals</h1>
            <p class="subtitle">Master the XSIAM Query Language - From Basic Syntax to Practical Threat Hunting</p>
        </header>
        <!-- What is XQL -->
        <section class="content-section">
            <h2 class="section-title">What is XQL?</h2>
            <div class="xql-overview">
                <h3>XQL = XSIAM Query Language</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                    XQL is Palo Alto's proprietary query language designed specifically for XSIAM's unified data lake. 
                    It combines the best aspects of KQL (Kusto) and SPL (Splunk) while being optimized for XDM-normalized data.
                </p>
                <p style="color: var(--text-primary);">
                    <strong>Key Characteristics:</strong>
                </p>
                <ul style="color: var(--text-secondary); margin-left: 1.5rem; margin-top: 0.5rem;">
                    <li>Pipe-based syntax similar to Splunk SPL</li>
                    <li>Function-oriented like KQL</li>
                    <li>Designed for XDM-normalized data</li>
                    <li>Used for queries, correlation rules, and BIOC rules</li>
                    <li>Supports aggregations, joins, and subqueries</li>
                </ul>
            </div>
            <div class="memory-trick">
                <div class="memory-trick-header">Memory Trick: XQL Personality</div>
                <p><strong>"XQL = SPL's Pipes + KQL's Functions + XDM's Fields"</strong></p>
                <p>Think of XQL as a hybrid language that took:</p>
                <p>‚Ä¢ The <code>|</code> pipe operator from Splunk</p>
                <p>‚Ä¢ The function-style operations from Kusto</p>
                <p>‚Ä¢ Built-in awareness of XDM normalized field names</p>
            </div>
            <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> Diagram</h4>
                    <p style="color: #8b949e;">See Data Ingestion page for detailed visual diagrams of this architecture.</p>
                </div>
        </section>
        <!-- Basic Syntax -->
        <section class="content-section">
            <h2 class="section-title">Basic XQL Syntax</h2>
            <div class="query-anatomy">
                <div class="query-anatomy-title">üîç Anatomy of an XQL Query</div>
                <div class="anatomy-line">
                    <div class="anatomy-code"><span class="keyword">dataset</span> = <span class="dataset">xdr_data</span></div>
                    <div class="anatomy-desc"><strong>Dataset Declaration</strong> - Always start here. Specifies which normalized dataset to query.</div>
                </div>
                <div class="anatomy-line">
                    <div class="anatomy-code"><span class="operator">|</span> <span class="function">filter</span> <span class="field">event_type</span> = <span class="string">PROCESS</span></div>
                    <div class="anatomy-desc"><strong>Filter Stage</strong> - Narrow down records. Similar to WHERE in SQL or search in SPL.</div>
                </div>
                <div class="anatomy-line">
                    <div class="anatomy-code"><span class="operator">|</span> <span class="function">filter</span> <span class="field">action_process_image_name</span> ~= <span class="string">".*powershell.*"</span></div>
                    <div class="anatomy-desc"><strong>Regex Filter</strong> - Use ~= for regex matching. Case-insensitive by default.</div>
                </div>
                <div class="anatomy-line">
                    <div class="anatomy-code"><span class="operator">|</span> <span class="function">fields</span> <span class="field">agent_hostname</span>, <span class="field">actor_process_command_line</span></div>
                    <div class="anatomy-desc"><strong>Field Selection</strong> - Choose which columns to include in output.</div>
                </div>
                <div class="anatomy-line">
                    <div class="anatomy-code"><span class="operator">|</span> <span class="function">comp</span> <span class="function">count</span>() <span class="keyword">as</span> cnt <span class="keyword">by</span> <span class="field">agent_hostname</span></div>
                    <div class="anatomy-desc"><strong>Compute/Aggregate</strong> - Group and aggregate data. "comp" = compute.</div>
                </div>
                <div class="anatomy-line">
                    <div class="anatomy-code"><span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> cnt</div>
                    <div class="anatomy-desc"><strong>Sort</strong> - Order results. Use desc/asc keywords.</div>
                </div>
                <div class="anatomy-line">
                    <div class="anatomy-code"><span class="operator">|</span> <span class="function">limit</span> <span class="number">100</span></div>
                    <div class="anatomy-desc"><strong>Limit</strong> - Restrict output rows. Always good practice!</div>
                </div>
            </div>
            <div class="memory-trick">
                <div class="memory-trick-header">Memory Trick: XQL Query Order</div>
                <p><strong>"D-F-F-C-S-L" = "Data First, Filter Fast, Compute, Sort, Limit"</strong></p>
                <p>Or remember: <strong>"Don't Forget: Filter First, Count Second, Limit"</strong></p>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">Dataset Declaration</h3>
                <p class="intro-text">Every XQL query MUST start with a dataset. Datasets are auto-created based on log sources and are XDM-normalized.</p>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">XQL</span>
                        <span class="code-title">Common Dataset Declarations</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Endpoint telemetry (XDR agent data)</span>
<span class="keyword">dataset</span> = <span class="dataset">xdr_data</span>
<span class="comment">// Palo Alto NGFW traffic logs</span>
<span class="keyword">dataset</span> = <span class="dataset">panw_ngfw_traffic_raw</span>
<span class="comment">// Palo Alto NGFW threat logs</span>
<span class="keyword">dataset</span> = <span class="dataset">panw_ngfw_threat_raw</span>
<span class="comment">// Azure AD sign-in logs</span>
<span class="keyword">dataset</span> = <span class="dataset">azure_ad_signin_raw</span>
<span class="comment">// AWS CloudTrail</span>
<span class="keyword">dataset</span> = <span class="dataset">aws_cloudtrail_raw</span>
<span class="comment">// Multiple datasets (UNION equivalent)</span>
<span class="keyword">dataset</span> = <span class="dataset">xdr_data</span>, <span class="dataset">panw_ngfw_traffic_raw</span>
<span class="comment">// All datasets matching pattern (wildcard)</span>
<span class="keyword">dataset</span> = <span class="dataset">panw_ngfw_*</span></pre>
                    </div>
                </div>
                <div class="info-box">
                    <div class="info-box-title">‚ÑπÔ∏è Dataset Naming Convention</div>
                    <p>XSIAM datasets follow the pattern: <code>{vendor}_{product}_{logtype}_raw</code></p>
                    <p>Examples: <code>panw_ngfw_traffic_raw</code>, <code>microsoft_365_audit_raw</code>, <code>crowdstrike_falcon_raw</code></p>
                    <p>The <code>xdr_data</code> dataset is special - it contains endpoint telemetry from Cortex XDR agents.</p>
                </div>
            </div>
        </section>
        <!-- Comparison Section -->
        <section class="content-section">
            <h2 class="section-title">XQL vs KQL vs SPL Comparison</h2>
            <p class="intro-text">
                Understanding how XQL compares to KQL (Microsoft Sentinel) and SPL (Splunk) helps you translate queries 
                and understand XSIAM's approach. Here's a comprehensive comparison:
            </p>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Operation</th>
                        <th class="xsiam">XQL (XSIAM)</th>
                        <th class="sentinel">KQL (Sentinel)</th>
                        <th class="splunk">SPL (Splunk)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Start Query</strong></td>
                        <td><code>dataset = xdr_data</code></td>
                        <td><code>DeviceEvents</code></td>
                        <td><code>index=main</code></td>
                    </tr>
                    <tr>
                        <td><strong>Filter</strong></td>
                        <td><code>| filter field = value</code></td>
                        <td><code>| where field == value</code></td>
                        <td><code>| where field=value</code></td>
                    </tr>
                    <tr>
                        <td><strong>Regex Match</strong></td>
                        <td><code>| filter field ~= "regex"</code></td>
                        <td><code>| where field matches regex "regex"</code></td>
                        <td><code>| regex field="regex"</code></td>
                    </tr>
                    <tr>
                        <td><strong>Select Fields</strong></td>
                        <td><code>| fields field1, field2</code></td>
                        <td><code>| project field1, field2</code></td>
                        <td><code>| fields field1 field2</code></td>
                    </tr>
                    <tr>
                        <td><strong>Rename Field</strong></td>
                        <td><code>| alter new_name = old_name</code></td>
                        <td><code>| extend new_name = old_name</code></td>
                        <td><code>| rename old_name as new_name</code></td>
                    </tr>
                    <tr>
                        <td><strong>Count</strong></td>
                        <td><code>| comp count() by field</code></td>
                        <td><code>| summarize count() by field</code></td>
                        <td><code>| stats count by field</code></td>
                    </tr>
                    <tr>
                        <td><strong>Distinct Count</strong></td>
                        <td><code>| comp count_distinct(field)</code></td>
                        <td><code>| summarize dcount(field)</code></td>
                        <td><code>| stats dc(field)</code></td>
                    </tr>
                    <tr>
                        <td><strong>Sort</strong></td>
                        <td><code>| sort desc field</code></td>
                        <td><code>| order by field desc</code></td>
                        <td><code>| sort - field</code></td>
                    </tr>
                    <tr>
                        <td><strong>Limit</strong></td>
                        <td><code>| limit 100</code></td>
                        <td><code>| take 100</code></td>
                        <td><code>| head 100</code></td>
                    </tr>
                    <tr>
                        <td><strong>Time Filter</strong></td>
                        <td><code>| filter _time >= timestamp</code></td>
                        <td><code>| where TimeGenerated >= datetime</code></td>
                        <td><code>earliest=-24h</code></td>
                    </tr>
                    <tr>
                        <td><strong>Contains</strong></td>
                        <td><code>| filter field contains "text"</code></td>
                        <td><code>| where field contains "text"</code></td>
                        <td><code>| where field="*text*"</code></td>
                    </tr>
                    <tr>
                        <td><strong>Not Contains</strong></td>
                        <td><code>| filter field not contains "text"</code></td>
                        <td><code>| where field !contains "text"</code></td>
                        <td><code>| where NOT field="*text*"</code></td>
                    </tr>
                    <tr>
                        <td><strong>In List</strong></td>
                        <td><code>| filter field in ("a","b")</code></td>
                        <td><code>| where field in ("a","b")</code></td>
                        <td><code>| where field IN ("a","b")</code></td>
                    </tr>
                    <tr>
                        <td><strong>Join Tables</strong></td>
                        <td><code>| join type=inner (...) as t</code></td>
                        <td><code>| join kind=inner (...)</code></td>
                        <td><code>| join type=inner [...]</code></td>
                    </tr>
                    <tr>
                        <td><strong>Deduplicate</strong></td>
                        <td><code>| dedup field1, field2</code></td>
                        <td><code>| distinct field1, field2</code></td>
                        <td><code>| dedup field1 field2</code></td>
                    </tr>
                </tbody>
            </table>
            <div class="memory-trick">
                <div class="memory-trick-header">Memory Trick: Language Keywords</div>
                <p><strong>XQL unique keywords to remember:</strong></p>
                <p>‚Ä¢ <code>comp</code> = Compute (not summarize, not stats)</p>
                <p>‚Ä¢ <code>filter</code> = Where clause (not where, not search)</p>
                <p>‚Ä¢ <code>alter</code> = Create/modify fields (not extend, not eval)</p>
                <p>‚Ä¢ <code>~=</code> = Regex operator (not matches, not regex)</p>
            </div>
        </section>
        <!-- Core Operators -->
        <section class="content-section">
            <h2 class="section-title">Core XQL Operators</h2>
            <p class="intro-text">
                XQL has a focused set of operators that cover most use cases. Master these and you'll handle 90% of queries.
            </p>
            <div class="operator-grid">
                <div class="operator-card">
                    <div class="operator-header">
                        <div class="operator-name">filter</div>
                        <div class="operator-purpose">Reduce records based on conditions</div>
                    </div>
                    <div class="operator-body">
                        <div class="operator-syntax">| filter condition [and|or condition]</div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                            The primary way to narrow down data. Supports boolean operators, comparison operators, and regex.
                        </p>
                        <div class="operator-example">
                            <div class="operator-example-title">Examples:</div>
                            <div class="code-block" style="margin: 0;">
                                <div class="code-content">
<pre><span class="comment">// Simple equality</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">event_type</span> = <span class="string">PROCESS</span>
<span class="comment">// Multiple conditions</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">event_type</span> = <span class="string">PROCESS</span> <span class="keyword">and</span> <span class="field">action_process_image_name</span> <span class="function">contains</span> <span class="string">"cmd"</span>
<span class="comment">// Regex matching</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">actor_process_command_line</span> ~= <span class="string">".*-enc.*"</span>
<span class="comment">// IN operator</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">action_country</span> <span class="keyword">in</span> (<span class="string">"RU"</span>, <span class="string">"CN"</span>, <span class="string">"KP"</span>)
<span class="comment">// Null check</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">action_remote_ip</span> != <span class="keyword">null</span></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="operator-card">
                    <div class="operator-header">
                        <div class="operator-name">fields</div>
                        <div class="operator-purpose">Select specific columns for output</div>
                    </div>
                    <div class="operator-body">
                        <div class="operator-syntax">| fields field1, field2, field3</div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                            Reduces output to specified columns. Use early to improve performance.
                        </p>
                        <div class="operator-example">
                            <div class="operator-example-title">Examples:</div>
                            <div class="code-block" style="margin: 0;">
                                <div class="code-content">
<pre><span class="comment">// Basic field selection</span>
<span class="operator">|</span> <span class="function">fields</span> <span class="field">agent_hostname</span>, <span class="field">action_process_image_name</span>
<span class="comment">// Exclude fields with minus</span>
<span class="operator">|</span> <span class="function">fields</span> -<span class="field">_raw_log</span>, -<span class="field">_vendor</span>
<span class="comment">// Select with rename</span>
<span class="operator">|</span> <span class="function">fields</span> <span class="field">host</span> = <span class="field">agent_hostname</span>, <span class="field">process</span> = <span class="field">action_process_image_name</span></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="operator-card">
                    <div class="operator-header">
                        <div class="operator-name">alter</div>
                        <div class="operator-purpose">Create or modify fields</div>
                    </div>
                    <div class="operator-body">
                        <div class="operator-syntax">| alter new_field = expression</div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                            Transforms data by creating new fields or modifying existing ones. Similar to Kusto's extend.
                        </p>
                        <div class="operator-example">
                            <div class="operator-example-title">Examples:</div>
                            <div class="code-block" style="margin: 0;">
                                <div class="code-content">
<pre><span class="comment">// Create calculated field</span>
<span class="operator">|</span> <span class="function">alter</span> <span class="field">bytes_total</span> = <span class="field">bytes_sent</span> + <span class="field">bytes_received</span>
<span class="comment">// String manipulation</span>
<span class="operator">|</span> <span class="function">alter</span> <span class="field">process_lower</span> = <span class="function">lowercase</span>(<span class="field">action_process_image_name</span>)
<span class="comment">// Conditional field (case)</span>
<span class="operator">|</span> <span class="function">alter</span> <span class="field">severity_text</span> = <span class="keyword">if</span>(<span class="field">severity</span> >= <span class="number">7</span>, <span class="string">"HIGH"</span>, <span class="string">"LOW"</span>)
<span class="comment">// Extract with regex</span>
<span class="operator">|</span> <span class="function">alter</span> <span class="field">domain</span> = <span class="function">arrayindex</span>(<span class="function">regextract</span>(<span class="field">url</span>, <span class="string">"https?://([^/]+)"</span>), <span class="number">0</span>)</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="operator-card">
                    <div class="operator-header">
                        <div class="operator-name">comp</div>
                        <div class="operator-purpose">Aggregate and compute statistics</div>
                    </div>
                    <div class="operator-body">
                        <div class="operator-syntax">| comp agg_func() [as alias] [by field]</div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                            The aggregation operator. Short for "compute". Groups data and applies aggregate functions.
                        </p>
                        <div class="operator-example">
                            <div class="operator-example-title">Examples:</div>
                            <div class="code-block" style="margin: 0;">
                                <div class="code-content">
<pre><span class="comment">// Simple count</span>
<span class="operator">|</span> <span class="function">comp</span> <span class="function">count</span>()
<span class="comment">// Count by group</span>
<span class="operator">|</span> <span class="function">comp</span> <span class="function">count</span>() <span class="keyword">as</span> event_count <span class="keyword">by</span> <span class="field">agent_hostname</span>
<span class="comment">// Multiple aggregations</span>
<span class="operator">|</span> <span class="function">comp</span> <span class="function">count</span>() <span class="keyword">as</span> cnt, <span class="function">sum</span>(<span class="field">bytes_sent</span>) <span class="keyword">as</span> total_bytes <span class="keyword">by</span> <span class="field">src_ip</span>
<span class="comment">// Distinct count</span>
<span class="operator">|</span> <span class="function">comp</span> <span class="function">count_distinct</span>(<span class="field">agent_hostname</span>) <span class="keyword">as</span> unique_hosts
<span class="comment">// Values aggregation (list unique values)</span>
<span class="operator">|</span> <span class="function">comp</span> <span class="function">values</span>(<span class="field">action_process_image_name</span>) <span class="keyword">as</span> processes <span class="keyword">by</span> <span class="field">agent_hostname</span></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="operator-card">
                    <div class="operator-header">
                        <div class="operator-name">sort</div>
                        <div class="operator-purpose">Order results</div>
                    </div>
                    <div class="operator-body">
                        <div class="operator-syntax">| sort [asc|desc] field1 [, field2]</div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                            Orders output by one or more fields. Default is ascending.
                        </p>
                        <div class="operator-example">
                            <div class="operator-example-title">Examples:</div>
                            <div class="code-block" style="margin: 0;">
                                <div class="code-content">
<pre><span class="comment">// Descending by count</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">event_count</span>
<span class="comment">// Multiple fields</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">severity</span>, <span class="keyword">asc</span> <span class="field">_time</span>
<span class="comment">// Sort by time (most recent first)</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">_time</span></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="operator-card">
                    <div class="operator-header">
                        <div class="operator-name">dedup</div>
                        <div class="operator-purpose">Remove duplicate records</div>
                    </div>
                    <div class="operator-body">
                        <div class="operator-syntax">| dedup field1 [, field2] [by field3]</div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                            Removes duplicate records based on specified fields. Keeps first occurrence.
                        </p>
                        <div class="operator-example">
                            <div class="operator-example-title">Examples:</div>
                            <div class="code-block" style="margin: 0;">
                                <div class="code-content">
<pre><span class="comment">// Deduplicate by single field</span>
<span class="operator">|</span> <span class="function">dedup</span> <span class="field">agent_hostname</span>
<span class="comment">// Deduplicate by multiple fields</span>
<span class="operator">|</span> <span class="function">dedup</span> <span class="field">agent_hostname</span>, <span class="field">action_process_image_name</span>
<span class="comment">// Keep first per group</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">_time</span>
<span class="operator">|</span> <span class="function">dedup</span> <span class="field">agent_hostname</span></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="quick-ref">
                <h4>Quick Reference: Comparison Operators</h4>
                <div class="quick-ref-grid">
                    <div class="quick-ref-item">
                        <code>=</code>
                        <span>Equals</span>
                    </div>
                    <div class="quick-ref-item">
                        <code>!=</code>
                        <span>Not equals</span>
                    </div>
                    <div class="quick-ref-item">
                        <code>~=</code>
                        <span>Regex match</span>
                    </div>
                    <div class="quick-ref-item">
                        <code>!~=</code>
                        <span>Regex not match</span>
                    </div>
                    <div class="quick-ref-item">
                        <code>contains</code>
                        <span>Substring match</span>
                    </div>
                    <div class="quick-ref-item">
                        <code>not contains</code>
                        <span>Substring not match</span>
                    </div>
                    <div class="quick-ref-item">
                        <code>in</code>
                        <span>In list</span>
                    </div>
                    <div class="quick-ref-item">
                        <code>not in</code>
                        <span>Not in list</span>
                    </div>
                    <div class="quick-ref-item">
                        <code>&gt; &gt;= &lt; &lt;=</code>
                        <span>Numeric comparison</span>
                    </div>
                </div>
            </div>
        </section>
        <!-- Essential Functions -->
        <section class="content-section">
            <h2 class="section-title">Essential XQL Functions</h2>
            <div class="subsection">
                <h3 class="subsection-title">Aggregate Functions (use with comp)</h3>
                <table class="function-table">
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>count()</code></td>
                            <td>Count records</td>
                            <td><code>comp count() as total</code></td>
                        </tr>
                        <tr>
                            <td><code>count_distinct(field)</code></td>
                            <td>Count unique values</td>
                            <td><code>comp count_distinct(src_ip) as unique_ips</code></td>
                        </tr>
                        <tr>
                            <td><code>sum(field)</code></td>
                            <td>Sum numeric values</td>
                            <td><code>comp sum(bytes_sent) as total_bytes</code></td>
                        </tr>
                        <tr>
                            <td><code>avg(field)</code></td>
                            <td>Average numeric values</td>
                            <td><code>comp avg(response_time) as avg_response</code></td>
                        </tr>
                        <tr>
                            <td><code>min(field)</code></td>
                            <td>Minimum value</td>
                            <td><code>comp min(_time) as first_seen</code></td>
                        </tr>
                        <tr>
                            <td><code>max(field)</code></td>
                            <td>Maximum value</td>
                            <td><code>comp max(_time) as last_seen</code></td>
                        </tr>
                        <tr>
                            <td><code>values(field)</code></td>
                            <td>List unique values (array)</td>
                            <td><code>comp values(dst_port) as ports</code></td>
                        </tr>
                        <tr>
                            <td><code>first(field)</code></td>
                            <td>First value in group</td>
                            <td><code>comp first(user_name) as user</code></td>
                        </tr>
                        <tr>
                            <td><code>last(field)</code></td>
                            <td>Last value in group</td>
                            <td><code>comp last(action_status) as status</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">String Functions (use with alter/filter)</h3>
                <table class="function-table">
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>lowercase(str)</code></td>
                            <td>Convert to lowercase</td>
                            <td><code>alter process = lowercase(process_name)</code></td>
                        </tr>
                        <tr>
                            <td><code>uppercase(str)</code></td>
                            <td>Convert to uppercase</td>
                            <td><code>alter domain = uppercase(domain)</code></td>
                        </tr>
                        <tr>
                            <td><code>trim(str)</code></td>
                            <td>Remove leading/trailing whitespace</td>
                            <td><code>alter clean_user = trim(user_name)</code></td>
                        </tr>
                        <tr>
                            <td><code>concat(str1, str2, ...)</code></td>
                            <td>Join strings</td>
                            <td><code>alter full_path = concat(directory, "/", filename)</code></td>
                        </tr>
                        <tr>
                            <td><code>substring(str, start, len)</code></td>
                            <td>Extract substring</td>
                            <td><code>alter short_hash = substring(file_hash, 0, 8)</code></td>
                        </tr>
                        <tr>
                            <td><code>split(str, delimiter)</code></td>
                            <td>Split into array</td>
                            <td><code>alter path_parts = split(file_path, "/")</code></td>
                        </tr>
                        <tr>
                            <td><code>regextract(str, pattern)</code></td>
                            <td>Extract regex groups (returns array)</td>
                            <td><code>alter domain = arrayindex(regextract(url, "://([^/]+)"), 0)</code></td>
                        </tr>
                        <tr>
                            <td><code>replace(str, old, new)</code></td>
                            <td>Replace substring</td>
                            <td><code>alter clean_cmd = replace(cmd, "\\", "/")</code></td>
                        </tr>
                        <tr>
                            <td><code>len(str)</code></td>
                            <td>String length</td>
                            <td><code>filter len(command_line) > 1000</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">Time Functions</h3>
                <table class="function-table">
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>timestamp_diff(t1, t2, unit)</code></td>
                            <td>Difference between timestamps</td>
                            <td><code>alter duration = timestamp_diff(_time, start_time, "SECOND")</code></td>
                        </tr>
                        <tr>
                            <td><code>timestamp_seconds(epoch)</code></td>
                            <td>Convert epoch to timestamp</td>
                            <td><code>alter event_time = timestamp_seconds(unix_time)</code></td>
                        </tr>
                        <tr>
                            <td><code>format_timestamp(ts, format)</code></td>
                            <td>Format timestamp as string</td>
                            <td><code>alter date_str = format_timestamp(_time, "%Y-%m-%d")</code></td>
                        </tr>
                        <tr>
                            <td><code>extract_time(ts, part)</code></td>
                            <td>Extract time component</td>
                            <td><code>alter hour = extract_time(_time, "HOUR")</code></td>
                        </tr>
                        <tr>
                            <td><code>current_time()</code></td>
                            <td>Current timestamp</td>
                            <td><code>filter _time > subtract_time(current_time(), "24h")</code></td>
                        </tr>
                        <tr>
                            <td><code>add_time(ts, duration)</code></td>
                            <td>Add duration to timestamp</td>
                            <td><code>alter expiry = add_time(_time, "7d")</code></td>
                        </tr>
                        <tr>
                            <td><code>subtract_time(ts, duration)</code></td>
                            <td>Subtract duration from timestamp</td>
                            <td><code>filter _time > subtract_time(current_time(), "1h")</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">Array Functions</h3>
                <table class="function-table">
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>arrayindex(arr, idx)</code></td>
                            <td>Get element at index</td>
                            <td><code>alter first_ip = arrayindex(ip_addresses, 0)</code></td>
                        </tr>
                        <tr>
                            <td><code>arraylength(arr)</code></td>
                            <td>Array length</td>
                            <td><code>filter arraylength(dst_ports) > 5</code></td>
                        </tr>
                        <tr>
                            <td><code>arrayconcat(arr1, arr2)</code></td>
                            <td>Combine arrays</td>
                            <td><code>alter all_ips = arrayconcat(src_ips, dst_ips)</code></td>
                        </tr>
                        <tr>
                            <td><code>arraycreate(v1, v2, ...)</code></td>
                            <td>Create array from values</td>
                            <td><code>alter ip_list = arraycreate(src_ip, dst_ip)</code></td>
                        </tr>
                        <tr>
                            <td><code>arrayfilter(arr, condition)</code></td>
                            <td>Filter array elements</td>
                            <td><code>alter high_ports = arrayfilter(ports, "@element > 1024")</code></td>
                        </tr>
                        <tr>
                            <td><code>arraydistinct(arr)</code></td>
                            <td>Remove duplicates from array</td>
                            <td><code>alter unique_users = arraydistinct(user_list)</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="tip-box">
                <div class="tip-box-title">üí° Pro Tip: Chaining Array Operations</div>
                <p>Array operations are powerful for handling multi-value fields like IP addresses or ports:</p>
                <pre >
| alter ports_array = split(destination_ports, ",")
| arrayexpand ports_array as port
| filter to_integer(port) < 1024
| comp count() as low_port_connections by src_ip</pre>
            </div>
        </section>
        <!-- Practical Examples -->
        <section class="content-section">
            <h2 class="section-title">Practical XQL Examples</h2>
            <div class="subsection">
                <h3 class="subsection-title">Threat Hunting Queries</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">XQL</span>
                        <span class="code-title">1. Encoded PowerShell Detection</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Detect Base64-encoded PowerShell commands</span>
<span class="keyword">dataset</span> = <span class="dataset">xdr_data</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">event_type</span> = <span class="string">PROCESS</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">action_process_image_name</span> ~= <span class="string">".*powershell.*"</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">actor_process_command_line</span> ~= <span class="string">".*(-enc|-encodedcommand|-e ).*"</span>
<span class="operator">|</span> <span class="function">fields</span> <span class="field">_time</span>, <span class="field">agent_hostname</span>, <span class="field">actor_effective_username</span>, 
        <span class="field">actor_process_command_line</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">_time</span>
<span class="operator">|</span> <span class="function">limit</span> <span class="number">100</span></pre>
                    </div>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">XQL</span>
                        <span class="code-title">2. Suspicious Network Connections</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Detect connections to suspicious countries</span>
<span class="keyword">dataset</span> = <span class="dataset">xdr_data</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">event_type</span> = <span class="string">NETWORK</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">action_external_hostname</span> != <span class="keyword">null</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">action_country</span> <span class="keyword">in</span> (<span class="string">"RU"</span>, <span class="string">"CN"</span>, <span class="string">"KP"</span>, <span class="string">"IR"</span>)
<span class="operator">|</span> <span class="function">comp</span> <span class="function">count</span>() <span class="keyword">as</span> connection_count, 
      <span class="function">count_distinct</span>(<span class="field">action_external_hostname</span>) <span class="keyword">as</span> unique_hosts 
      <span class="keyword">by</span> <span class="field">agent_hostname</span>, <span class="field">action_country</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">connection_count</span></pre>
                    </div>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">XQL</span>
                        <span class="code-title">3. Lateral Movement Detection (PsExec-like)</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Detect potential lateral movement via remote service creation</span>
<span class="keyword">dataset</span> = <span class="dataset">xdr_data</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">event_type</span> = <span class="string">PROCESS</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">action_process_image_name</span> ~= <span class="string">".*services\.exe.*"</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">causality_actor_process_image_name</span> ~= <span class="string">".*\\\\.*"</span> <span class="comment">// Remote path</span>
<span class="operator">|</span> <span class="function">fields</span> <span class="field">_time</span>, <span class="field">agent_hostname</span>, <span class="field">actor_effective_username</span>,
        <span class="field">action_process_image_name</span>, <span class="field">causality_actor_process_image_path</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">_time</span></pre>
                    </div>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">XQL</span>
                        <span class="code-title">4. Failed Login Analysis</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Analyze failed logins from Azure AD</span>
<span class="keyword">dataset</span> = <span class="dataset">azure_ad_signin_raw</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">status_errorCode</span> != <span class="number">0</span>
<span class="operator">|</span> <span class="function">comp</span> <span class="function">count</span>() <span class="keyword">as</span> failed_attempts,
      <span class="function">count_distinct</span>(<span class="field">ipAddress</span>) <span class="keyword">as</span> unique_ips,
      <span class="function">values</span>(<span class="field">status_failureReason</span>) <span class="keyword">as</span> failure_reasons
      <span class="keyword">by</span> <span class="field">userPrincipalName</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">failed_attempts</span> > <span class="number">10</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">failed_attempts</span></pre>
                    </div>
                </div>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">Operational Queries</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">XQL</span>
                        <span class="code-title">5. Firewall Traffic Summary</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Daily traffic summary by application</span>
<span class="keyword">dataset</span> = <span class="dataset">panw_ngfw_traffic_raw</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">_time</span> > <span class="function">subtract_time</span>(<span class="function">current_time</span>(), <span class="string">"24h"</span>)
<span class="operator">|</span> <span class="function">comp</span> <span class="function">count</span>() <span class="keyword">as</span> sessions,
      <span class="function">sum</span>(<span class="field">bytes</span>) <span class="keyword">as</span> total_bytes,
      <span class="function">count_distinct</span>(<span class="field">src_ip</span>) <span class="keyword">as</span> unique_sources
      <span class="keyword">by</span> <span class="field">app</span>
<span class="operator">|</span> <span class="function">alter</span> <span class="field">total_gb</span> = <span class="function">round</span>(<span class="field">total_bytes</span> / <span class="number">1073741824</span>, <span class="number">2</span>)
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">total_bytes</span>
<span class="operator">|</span> <span class="function">limit</span> <span class="number">20</span></pre>
                    </div>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">XQL</span>
                        <span class="code-title">6. Endpoint Agent Health Check</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Find endpoints that haven't reported recently</span>
<span class="keyword">dataset</span> = <span class="dataset">xdr_data</span>
<span class="operator">|</span> <span class="function">comp</span> <span class="function">max</span>(<span class="field">_time</span>) <span class="keyword">as</span> last_seen <span class="keyword">by</span> <span class="field">agent_hostname</span>, <span class="field">agent_ip_addresses</span>
<span class="operator">|</span> <span class="function">alter</span> <span class="field">hours_since_seen</span> = <span class="function">timestamp_diff</span>(<span class="function">current_time</span>(), <span class="field">last_seen</span>, <span class="string">"HOUR"</span>)
<span class="operator">|</span> <span class="function">filter</span> <span class="field">hours_since_seen</span> > <span class="number">24</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">hours_since_seen</span>
<span class="operator">|</span> <span class="function">fields</span> <span class="field">agent_hostname</span>, <span class="field">agent_ip_addresses</span>, <span class="field">last_seen</span>, <span class="field">hours_since_seen</span></pre>
                    </div>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">XQL</span>
                        <span class="code-title">7. AWS CloudTrail - Root Account Usage</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Monitor AWS root account activity</span>
<span class="keyword">dataset</span> = <span class="dataset">aws_cloudtrail_raw</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">userIdentity_type</span> = <span class="string">"Root"</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">eventName</span> != <span class="string">"ConsoleLogin"</span> <span class="comment">// Exclude normal logins</span>
<span class="operator">|</span> <span class="function">fields</span> <span class="field">_time</span>, <span class="field">eventName</span>, <span class="field">eventSource</span>, <span class="field">sourceIPAddress</span>,
        <span class="field">userAgent</span>, <span class="field">awsRegion</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> <span class="field">_time</span></pre>
                    </div>
                </div>
            </div>
            <div class="interview-box">
                <div class="interview-header">Interview Answer: XQL Query Optimization</div>
                <p><strong>Q: How would you optimize a slow XQL query?</strong></p>
                <p>"I'd apply several optimization strategies:</p>
                <p><strong>1. Filter Early:</strong> Put the most restrictive filters first, especially time-based filters. This reduces the data processed in subsequent stages.</p>
                <p><strong>2. Use Indexed Fields:</strong> Filter on XDM-normalized fields like event_type, action_process_image_name which are indexed.</p>
                <p><strong>3. Avoid Wildcards at Start:</strong> Use <code>contains</code> or <code>ends with</code> instead of <code>~= ".*pattern"</code> when possible.</p>
                <p><strong>4. Limit Field Selection:</strong> Use the <code>fields</code> operator early to reduce data transfer.</p>
                <p><strong>5. Optimize Regex:</strong> Simple string operations (contains, starts with) are faster than complex regex patterns.</p>
                <p><strong>6. Time Window:</strong> Always specify the smallest time range needed for your analysis."</p>
            </div>
        </section>
        <!-- Query Patterns Comparison -->
        <section class="content-section">
            <h2 class="section-title">Same Query in XQL, KQL, and SPL</h2>
            <p class="intro-text">
                Learn by comparing the same threat hunting scenario across all three languages.
            </p>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang" style="color: var(--accent);">XQL</span>
                    <span class="code-title">Find PowerShell with Encoded Commands</span>
                </div>
                <div class="code-content">
<pre><span class="keyword">dataset</span> = <span class="dataset">xdr_data</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">event_type</span> = <span class="string">PROCESS</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">action_process_image_name</span> <span class="function">contains</span> <span class="string">"powershell"</span>
<span class="operator">|</span> <span class="function">filter</span> <span class="field">actor_process_command_line</span> ~= <span class="string">".*(-enc|-e ).*"</span>
<span class="operator">|</span> <span class="function">fields</span> <span class="field">_time</span>, <span class="field">agent_hostname</span>, <span class="field">actor_process_command_line</span>
<span class="operator">|</span> <span class="function">comp</span> <span class="function">count</span>() <span class="keyword">as</span> cnt <span class="keyword">by</span> <span class="field">agent_hostname</span>
<span class="operator">|</span> <span class="function">sort</span> <span class="keyword">desc</span> cnt</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang" style="color: var(--sentinel-blue);">KQL</span>
                    <span class="code-title">Same Query in Microsoft Sentinel</span>
                </div>
                <div class="code-content">
<pre><span class="dataset">DeviceProcessEvents</span>
<span class="operator">|</span> <span class="function">where</span> <span class="field">FileName</span> <span class="function">contains</span> <span class="string">"powershell"</span>
<span class="operator">|</span> <span class="function">where</span> <span class="field">ProcessCommandLine</span> <span class="function">matches regex</span> <span class="string">"(-enc|-e )"</span>
<span class="operator">|</span> <span class="function">project</span> <span class="field">TimeGenerated</span>, <span class="field">DeviceName</span>, <span class="field">ProcessCommandLine</span>
<span class="operator">|</span> <span class="function">summarize</span> cnt = <span class="function">count</span>() <span class="keyword">by</span> <span class="field">DeviceName</span>
<span class="operator">|</span> <span class="function">order by</span> cnt <span class="keyword">desc</span></pre>
                </div>
            </div>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang" style="color: var(--splunk-green);">SPL</span>
                    <span class="code-title">Same Query in Splunk</span>
                </div>
                <div class="code-content">
<pre><span class="keyword">index</span>=<span class="dataset">endpoint</span> <span class="keyword">sourcetype</span>=<span class="string">"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational"</span>
    <span class="field">EventCode</span>=1 
    <span class="field">Image</span>=<span class="string">"*powershell*"</span>
<span class="operator">|</span> <span class="function">regex</span> <span class="field">CommandLine</span>=<span class="string">"(-enc|-e )"</span>
<span class="operator">|</span> <span class="function">table</span> <span class="field">_time</span> <span class="field">ComputerName</span> <span class="field">CommandLine</span>
<span class="operator">|</span> <span class="function">stats</span> <span class="function">count</span> <span class="keyword">as</span> cnt <span class="keyword">by</span> <span class="field">ComputerName</span>
<span class="operator">|</span> <span class="function">sort</span> - cnt</pre>
                </div>
            </div>
            <div class="memory-trick">
                <div class="memory-trick-header">Memory Trick: Translation Cheat Sheet</div>
                <p>When translating between platforms, remember these keyword swaps:</p>
                <table style="width: 100%; margin-top: 1rem; color: #c8b0e0;">
                    <tr>
                        <td><strong>Concept</strong></td>
                        <td style="color: var(--accent);">XQL</td>
                        <td style="color: var(--sentinel-blue);">KQL</td>
                        <td style="color: var(--splunk-green);">SPL</td>
                    </tr>
                    <tr>
                        <td>Where clause</td>
                        <td><code>filter</code></td>
                        <td><code>where</code></td>
                        <td><code>where</code> or search</td>
                    </tr>
                    <tr>
                        <td>Aggregate</td>
                        <td><code>comp</code></td>
                        <td><code>summarize</code></td>
                        <td><code>stats</code></td>
                    </tr>
                    <tr>
                        <td>Create field</td>
                        <td><code>alter</code></td>
                        <td><code>extend</code></td>
                        <td><code>eval</code></td>
                    </tr>
                    <tr>
                        <td>Select columns</td>
                        <td><code>fields</code></td>
                        <td><code>project</code></td>
                        <td><code>table</code> or <code>fields</code></td>
                    </tr>
                </table>
            </div>
        </section>
        <!-- Common Mistakes -->
        <section class="content-section">
            <h2 class="section-title">Common XQL Mistakes & Fixes</h2>
            <div class="warning-box">
                <div class="warning-box-title">‚ö†Ô∏è Mistake #1: Missing Dataset Declaration</div>
                <p><strong>Wrong:</strong></p>
                <pre >| filter event_type = PROCESS</pre>
                <p><strong>Right:</strong></p>
                <pre >dataset = xdr_data
| filter event_type = PROCESS</pre>
                <p>Every XQL query MUST start with <code>dataset = </code></p>
            </div>
            <div class="warning-box">
                <div class="warning-box-title">‚ö†Ô∏è Mistake #2: Wrong Comparison Operator</div>
                <p><strong>Wrong:</strong></p>
                <pre >| filter event_type == "PROCESS"  // Double equals doesn't work!</pre>
                <p><strong>Right:</strong></p>
                <pre >| filter event_type = PROCESS  // Single equals, no quotes for enums</pre>
                <p>XQL uses single <code>=</code> for comparison. Event types don't need quotes.</p>
            </div>
            <div class="warning-box">
                <div class="warning-box-title">‚ö†Ô∏è Mistake #3: Using WHERE instead of FILTER</div>
                <p><strong>Wrong:</strong></p>
                <pre >| where agent_hostname = "server01"  // WHERE doesn't exist in XQL!</pre>
                <p><strong>Right:</strong></p>
                <pre >| filter agent_hostname = "server01"</pre>
                <p>Coming from KQL? Remember: <code>where</code> ‚Üí <code>filter</code></p>
            </div>
            <div class="warning-box">
                <div class="warning-box-title">‚ö†Ô∏è Mistake #4: STATS instead of COMP</div>
                <p><strong>Wrong:</strong></p>
                <pre >| stats count() by agent_hostname  // SPL syntax!</pre>
                <p><strong>Right:</strong></p>
                <pre >| comp count() as cnt by agent_hostname</pre>
                <p>Coming from Splunk? Remember: <code>stats</code> ‚Üí <code>comp</code></p>
            </div>
            <div class="warning-box">
                <div class="warning-box-title">‚ö†Ô∏è Mistake #5: Forgetting Alias in COMP</div>
                <p><strong>Risky:</strong></p>
                <pre >| comp count() by agent_hostname  // Works but unnamed column</pre>
                <p><strong>Better:</strong></p>
                <pre >| comp count() as event_count by agent_hostname</pre>
                <p>Always use <code>as alias</code> for clarity and to reference in later stages.</p>
            </div>
        </section>
        <!-- Navigation -->
        <section class="content-section">
            <h2 class="section-title">Continue Learning</h2>
            <div class="nav-cards">
                <a href="xql-advanced.html" class="nav-card">
                    <div class="nav-card-title">Advanced XQL ‚Üí</div>
                    <div class="nav-card-desc">Joins, subqueries, correlation rules, and complex analytics</div>
                </a>
                <a href="xdr-overview.html" class="nav-card">
                    <div class="nav-card-title">XDR & Detection ‚Üí</div>
                    <div class="nav-card-desc">BIOC rules, analytics, and threat detection with XQL</div>
                </a>
                <a href="data-ingestion.html" class="nav-card">
                    <div class="nav-card-title">‚Üê Data Ingestion</div>
                    <div class="nav-card-desc">Understand how data gets into XSIAM datasets</div>
                </a>
                <a href="index.html" class="nav-card">
                    <div class="nav-card-title">‚Üê XSIAM Home</div>
                    <div class="nav-card-desc">Return to the main guide</div>
                </a>
            </div>
        </section>
            </main>
            <footer class="main-footer">
                <p>Nik's SIEM - Security Operations Knowledge Base</p>
                <p>Created for interview preparation and operational reference</p>
            </footer>
        </div>
    </div>
    <script src="../assets/js/main.js"></script>
</body>
</html>
