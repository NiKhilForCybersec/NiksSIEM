<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Log Source Onboarding - Complete Guide | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
                <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link active"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>




        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Custom Log Onboarding</span>
                </div>

                <h1><i class="fas fa-file-import"></i> Custom Log Source Onboarding - Complete Guide</h1>
                <p class="lead">The definitive guide to onboarding any custom log source into XSIAM. Covers every step from initial planning through verification, with real examples, console paths, and troubleshooting.</p>

                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-bookmark"></i> What This Guide Covers</h4>
                    <p>This guide walks through onboarding a <strong>custom application log</strong> that isn't natively supported by XSIAM. By the end, you'll have:</p>
                    <ul style="color: #8b949e; margin-top: 8px;">
                        <li>Log data flowing into XSIAM</li>
                        <li>Custom parsing rules extracting fields</li>
                        <li>XDM normalization for correlation</li>
                        <li>Verification queries confirming data</li>
                        <li>Detection rules on the new source</li>
                    </ul>
                </div>

                <!-- End-to-End Onboarding Workflow -->
                <h2><i class="fas fa-project-diagram"></i> Complete Onboarding Workflow</h2>
                <div class="flow-diagram">
                    <div class="flow-step" style="border-left-color: #58a6ff;">
                        <div class="flow-icon"><i class="fas fa-clipboard-list"></i></div>
                        <div class="flow-content">
                            <h4>Phase 1: Planning</h4>
                            <ul>
                                <li>Gather sample logs (10-20 events)</li>
                                <li>Document log format (JSON/syslog/custom)</li>
                                <li>Identify security-relevant fields</li>
                                <li>Estimate daily volume (EPS × 86,400)</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #d29922;">
                        <div class="flow-icon"><i class="fas fa-route"></i></div>
                        <div class="flow-content">
                            <h4>Phase 2: Choose Method</h4>
                            <ul>
                                <li><strong>Syslog:</strong> On-prem → Broker VM</li>
                                <li><strong>HTTP:</strong> Cloud/API → HTTP Collector</li>
                                <li><strong>Cloud:</strong> AWS/Azure → Cloud Collector</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #3fb950;">
                        <div class="flow-icon"><i class="fas fa-plug"></i></div>
                        <div class="flow-content">
                            <h4>Phase 3: Configure Source</h4>
                            <ul>
                                <li>Create data source in XSIAM</li>
                                <li>Set Vendor and Product names</li>
                                <li>Configure source device to send logs</li>
                                <li>Verify connectivity</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #a371f7;">
                        <div class="flow-icon"><i class="fas fa-code"></i></div>
                        <div class="flow-content">
                            <h4>Phase 4: Create Parser</h4>
                            <ul>
                                <li>Build extraction logic (JSON/regex/split)</li>
                                <li>Test with sample logs</li>
                                <li>Extract all relevant fields</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #f0883e;">
                        <div class="flow-icon"><i class="fas fa-exchange-alt"></i></div>
                        <div class="flow-content">
                            <h4>Phase 5: XDM Mapping</h4>
                            <ul>
                                <li>Map custom fields to xdm.* schema</li>
                                <li>Enable cross-source correlation</li>
                                <li>Use standard field names</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #3fb950;">
                        <div class="flow-icon"><i class="fas fa-check-double"></i></div>
                        <div class="flow-content">
                            <h4>Phase 6: Verify</h4>
                            <ul>
                                <li>Query dataset to confirm data</li>
                                <li>Check field extraction</li>
                                <li>Validate XDM mapping</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #f85149;">
                        <div class="flow-icon"><i class="fas fa-shield-alt"></i></div>
                        <div class="flow-content">
                            <h4>Phase 7: Detection Rules</h4>
                            <ul>
                                <li>Create correlation rules on dataset</li>
                                <li>Build dashboards for visibility</li>
                                <li>Set up alerts and response actions</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- TABLE OF CONTENTS -->
                <div class="config-section">
                    <h3><i class="fas fa-list"></i> Table of Contents</h3>
                    <ol style="color: #8b949e; line-height: 2;">
                        <li><a href="#phase1" style="color: #58a6ff;">Phase 1: Planning & Prerequisites</a></li>
                        <li><a href="#phase2" style="color: #58a6ff;">Phase 2: Choose Ingestion Method</a></li>
                        <li><a href="#phase3" style="color: #58a6ff;">Phase 3: Configure Data Source</a></li>
                        <li><a href="#phase4" style="color: #58a6ff;">Phase 4: Create Custom Parsing Rules</a></li>
                        <li><a href="#phase5" style="color: #58a6ff;">Phase 5: XDM Field Mapping</a></li>
                        <li><a href="#phase6" style="color: #58a6ff;">Phase 6: Verify Data Ingestion</a></li>
                        <li><a href="#phase7" style="color: #58a6ff;">Phase 7: Create Detection Rules</a></li>
                        <li><a href="#phase8" style="color: #58a6ff;">Phase 8: Troubleshooting</a></li>
                        <li><a href="#examples" style="color: #58a6ff;">Complete Examples</a></li>
                    </ol>
                </div>

                <!-- PHASE 1: PLANNING -->
                <div class="phase-header" id="phase1">
                    <span class="phase-num">PHASE 1</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Planning & Prerequisites</span>
                </div>

                <h3>1.1 Gather Log Source Information</h3>
                <p>Before starting configuration, collect this information:</p>

                <table class="field-table">
                    <thead>
                        <tr>
                            <th>Information Needed</th>
                            <th>Why It's Needed</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Log format</strong></td>
                            <td>Determines parsing approach</td>
                            <td>Syslog, JSON, CSV, CEF, custom</td>
                        </tr>
                        <tr>
                            <td><strong>Transport protocol</strong></td>
                            <td>Determines ingestion method</td>
                            <td>Syslog TCP/UDP, HTTP/API, file-based</td>
                        </tr>
                        <tr>
                            <td><strong>Expected volume</strong></td>
                            <td>Sizing and licensing</td>
                            <td>~5,000 events/hour = ~120K/day</td>
                        </tr>
                        <tr>
                            <td><strong>Sample logs (10-20)</strong></td>
                            <td>Build and test parsing rules</td>
                            <td>Copy from source system</td>
                        </tr>
                        <tr>
                            <td><strong>Field documentation</strong></td>
                            <td>Understand what each field means</td>
                            <td>Vendor documentation or schema</td>
                        </tr>
                        <tr>
                            <td><strong>Source IP/hostname</strong></td>
                            <td>Configure sender, troubleshoot</td>
                            <td>10.0.1.100, app-server-01</td>
                        </tr>
                        <tr>
                            <td><strong>Security relevance</strong></td>
                            <td>Prioritize which fields to extract</td>
                            <td>Auth events, errors, user actions</td>
                        </tr>
                    </tbody>
                </table>

                <h3>1.2 Get Sample Logs</h3>
                <div class="config-section">
                    <p>You need real sample logs to build parsing rules. Methods to get them:</p>
                    
                    <h4>Option A: From the Application</h4>
                    <div class="arch-diagram">
# SSH to application server
ssh admin@app-server-01

# View recent logs
tail -100 /var/log/myapp/application.log

# Copy samples to your machine
scp admin@app-server-01:/var/log/myapp/application.log ./samples/
                    </div>

                    <h4>Option B: From Existing SIEM</h4>
                    <div class="arch-diagram">
# If logs are already going to another SIEM, export samples
# Splunk example:
index=myapp earliest=-1h | head 100 | table _raw
                    </div>

                    <h4>Option C: Packet Capture</h4>
                    <div class="arch-diagram">
# Capture syslog traffic on Broker VM or network tap
tcpdump -i eth0 port 514 -w syslog_capture.pcap -c 1000

# View captured packets
tcpdump -r syslog_capture.pcap -A | head -200
                    </div>
                </div>

                <h3>1.3 Analyze Log Format</h3>
                <div class="config-section">
                    <p>Identify the log format to determine parsing approach:</p>

                    <h4>Example: JSON Format</h4>
                    <div class="example-log">
{"timestamp":"2024-02-15T14:30:00Z","level":"INFO","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success","session_id":"abc123"}
{"timestamp":"2024-02-15T14:30:05Z","level":"WARN","user":"jsmith","action":"access_denied","resource":"/admin/config","src_ip":"10.0.1.50"}
                    </div>
                    <p style="color: #3fb950;">✓ JSON is easiest to parse - use json_extract() functions</p>

                    <h4>Example: Syslog with Key-Value Pairs</h4>
                    <div class="example-log">
Feb 15 14:30:00 app-server-01 myapp[1234]: USER=jsmith ACTION=login SRC=10.0.1.50 RESULT=success
Feb 15 14:30:05 app-server-01 myapp[1234]: USER=jsmith ACTION=access_denied RESOURCE=/admin/config SRC=10.0.1.50
                    </div>
                    <p style="color: #d29922;">△ Key-value pairs need regex extraction</p>

                    <h4>Example: Delimited Format</h4>
                    <div class="example-log">
2024-02-15T14:30:00|INFO|jsmith|login|10.0.1.50|success
2024-02-15T14:30:05|WARN|jsmith|access_denied|10.0.1.50|/admin/config
                    </div>
                    <p style="color: #d29922;">△ Pipe-delimited needs split() or positional regex</p>

                    <h4>Example: Unstructured/Free-form</h4>
                    <div class="example-log">
2024-02-15 14:30:00 INFO User jsmith logged in successfully from 10.0.1.50
2024-02-15 14:30:05 WARN User jsmith attempted to access /admin/config but was denied
                    </div>
                    <p style="color: #f85149;">✗ Unstructured logs need complex regex - consider asking dev team to improve logging</p>
                </div>

                <!-- Decision Tree: Parsing Approach Selection -->
                <div class="decision-tree">
                    <h3><i class="fas fa-sitemap"></i> Decision Tree: Select Parsing Approach</h3>
                    
                    <div class="decision-node">
                        <i class="fas fa-question-circle"></i>
                        <strong>What is the log format?</strong>
                        <small>Examine sample logs to identify structure</small>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow yes">JSON Format</div>
                        <div class="decision-outcome" style="border-left-color: #3fb950;">
                            <i class="fas fa-check-circle" style="color: #3fb950;"></i>
                            <strong>Use json_extract()</strong>
                            <small>Easiest method: <code>json_extract(_raw_log, "$.field_name")</code> | Handles nested objects with $.parent.child</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background-color: #58a6ff;">Key-Value Pairs</div>
                        <div class="decision-outcome" style="border-left-color: #58a6ff;">
                            <i class="fas fa-equals" style="color: #58a6ff;"></i>
                            <strong>Use regex with named groups</strong>
                            <small>Pattern: <code>USER=(?P&lt;user&gt;\S+)</code> | Works for consistent key=value formats</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background-color: #d29922;">Delimited (CSV/Pipe)</div>
                        <div class="decision-outcome" style="border-left-color: #d29922;">
                            <i class="fas fa-columns" style="color: #d29922;"></i>
                            <strong>Use split() function</strong>
                            <small>Pattern: <code>split(_raw_log, "|")</code> then <code>arrayindex()</code> for each position</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow no">Unstructured Text</div>
                        <div class="decision-node">
                            <i class="fas fa-question-circle"></i>
                            <strong>Are there consistent patterns?</strong>
                            <small>Look for repeated structures across log samples</small>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow yes">YES</div>
                            <div class="decision-outcome" style="border-left-color: #a371f7;">
                                <i class="fas fa-code" style="color: #a371f7;"></i>
                                <strong>Build complex regex</strong>
                                <small>Use capture groups for each field | Test extensively with variations</small>
                            </div>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow no">NO</div>
                            <div class="decision-outcome" style="border-left-color: #f85149;">
                                <i class="fas fa-exclamation-triangle" style="color: #f85149;"></i>
                                <strong>Request log format improvement</strong>
                                <small>Work with dev team to add structured logging (JSON) | Use generic extraction as fallback</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PHASE 2: CHOOSE INGESTION METHOD -->
                <div class="phase-header" id="phase2">
                    <span class="phase-num">PHASE 2</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Choose Ingestion Method</span>
                </div>

                <!-- Visual Decision Tree: Ingestion Method Selection -->
                <div class="decision-tree">
                    <h3><i class="fas fa-sitemap"></i> Decision Tree: Choose Ingestion Method</h3>
                    
                    <div class="decision-node">
                        <i class="fas fa-question-circle"></i>
                        <strong>Is the source an on-premises device/server?</strong>
                        <small>Network equipment, Linux/Windows servers, on-prem applications</small>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow yes">YES</div>
                        <div class="decision-node">
                            <i class="fas fa-question-circle"></i>
                            <strong>Can the source send syslog (TCP/UDP 514)?</strong>
                            <small>Most enterprise devices support syslog natively</small>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow yes">YES</div>
                            <div class="decision-outcome" style="border-left-color: #3fb950;">
                                <i class="fas fa-check-circle" style="color: #3fb950;"></i>
                                <strong>Use Broker VM Syslog</strong>
                                <small>Settings → Data Sources → Syslog Collector | Most common method for on-prem sources</small>
                            </div>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow no">NO</div>
                            <div class="decision-outcome" style="border-left-color: #d29922;">
                                <i class="fas fa-wrench" style="color: #d29922;"></i>
                                <strong>Deploy Log Forwarder</strong>
                                <small>Use NXLog, Filebeat, or rsyslog to collect and forward logs</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow no">NO - Cloud/SaaS Source</div>
                        <div class="decision-node">
                            <i class="fas fa-question-circle"></i>
                            <strong>Is there a native Cloud Collector for this source?</strong>
                            <small>Check Settings → Data Sources → Cloud Collectors for AWS, Azure, O365, etc.</small>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow yes">YES</div>
                            <div class="decision-outcome" style="border-left-color: #3fb950;">
                                <i class="fas fa-cloud" style="color: #3fb950;"></i>
                                <strong>Use Cloud Collector</strong>
                                <small>Pre-built integrations with automatic parsing and XDM mapping</small>
                            </div>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow no">NO</div>
                            <div class="decision-node">
                                <i class="fas fa-question-circle"></i>
                                <strong>Can the source send HTTP webhooks?</strong>
                                <small>Native webhook/HTTP POST capability</small>
                            </div>
                            
                            <div class="decision-branch">
                                <div class="decision-arrow yes">YES</div>
                                <div class="decision-outcome" style="border-left-color: #58a6ff;">
                                    <i class="fas fa-link" style="color: #58a6ff;"></i>
                                    <strong>Use HTTP Collector</strong>
                                    <small>Settings → Data Sources → HTTP Collector | Configure webhook URL in source</small>
                                </div>
                            </div>
                            
                            <div class="decision-branch">
                                <div class="decision-arrow no">NO</div>
                                <div class="decision-outcome" style="border-left-color: #a371f7;">
                                    <i class="fas fa-code" style="color: #a371f7;"></i>
                                    <strong>Build Custom Integration</strong>
                                    <small>Write script to pull from source API → Push to HTTP Collector</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Reference: Ingestion Method by Source Type -->
                <h3>Quick Reference: Source Type → Ingestion Method</h3>
                <div class="grid-2col">
                    <div class="concept-card">
                        <div class="concept-icon" style="background: linear-gradient(135deg, #3fb950, #238636);"><i class="fas fa-server"></i></div>
                        <h4>On-Premises Sources</h4>
                        <ul style="color: #8b949e; font-size: 0.9rem;">
                            <li><strong>Network equipment:</strong> Broker VM Syslog</li>
                            <li><strong>Linux servers:</strong> rsyslog → Broker VM</li>
                            <li><strong>Windows servers:</strong> NXLog → Broker VM</li>
                            <li><strong>Security appliances:</strong> Broker VM Syslog</li>
                        </ul>
                    </div>
                    <div class="concept-card">
                        <div class="concept-icon" style="background: linear-gradient(135deg, #58a6ff, #1f6feb);"><i class="fas fa-cloud"></i></div>
                        <h4>Cloud & SaaS Sources</h4>
                        <ul style="color: #8b949e; font-size: 0.9rem;">
                            <li><strong>AWS:</strong> Cloud Collector (S3, CloudTrail)</li>
                            <li><strong>Azure:</strong> Cloud Collector (Event Hub)</li>
                            <li><strong>Custom SaaS:</strong> HTTP Collector + API polling</li>
                            <li><strong>Webhook-enabled:</strong> HTTP Collector</li>
                        </ul>
                    </div>
                </div>

                <h3>Ingestion Methods Comparison</h3>
                <table class="field-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Best For</th>
                            <th>Requirements</th>
                            <th>Console Location</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Broker VM Syslog</strong></td>
                            <td>On-prem devices, servers, network equipment</td>
                            <td>Broker VM deployed, network access</td>
                            <td>Settings → Data Sources → Broker VM</td>
                        </tr>
                        <tr>
                            <td><strong>HTTP Collector</strong></td>
                            <td>Cloud apps, APIs, custom scripts</td>
                            <td>Source can send HTTP POST</td>
                            <td>Settings → Data Sources → HTTP Collector</td>
                        </tr>
                        <tr>
                            <td><strong>Cloud Collector</strong></td>
                            <td>AWS, Azure, GCP, SaaS apps</td>
                            <td>Native integration exists</td>
                            <td>Settings → Data Sources → Cloud Collectors</td>
                        </tr>
                        <tr>
                            <td><strong>XDR Agent</strong></td>
                            <td>Endpoint telemetry only</td>
                            <td>Agent installed on endpoint</td>
                            <td>Settings → Endpoints → Agents</td>
                        </tr>
                    </tbody>
                </table>

                <!-- PHASE 3: CONFIGURE DATA SOURCE -->
                <div class="phase-header" id="phase3">
                    <span class="phase-num">PHASE 3</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Configure Data Source in XSIAM</span>
                </div>

                <h3>3A. Syslog via Broker VM (Most Common)</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → Add Data Source</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div style="width: 100%;">
                            <strong>Navigate to Data Sources</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Click gear icon (Settings) → Data Sources → Click "+ Add Data Source"</p>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div style="width: 100%;">
                            <strong>Select "Syslog Collector"</strong>
                            <p style="color: #8b949e; margin: 4px 0;">From the list of data source types, select "Syslog Collector"</p>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div style="width: 100%;">
                            <strong>Configure Collector Settings</strong>
                            <table class="field-table" style="margin-top: 12px;">
                                <tr>
                                    <td style="width: 200px;"><strong>Name</strong></td>
                                    <td>myapp-auth-logs</td>
                                    <td style="color: #8b949e;">Descriptive name for this data source</td>
                                </tr>
                                <tr>
                                    <td><strong>Broker VM</strong></td>
                                    <td>broker-vm-datacenter-1</td>
                                    <td style="color: #8b949e;">Select your deployed Broker VM</td>
                                </tr>
                                <tr>
                                    <td><strong>Protocol</strong></td>
                                    <td>TCP</td>
                                    <td style="color: #8b949e;">TCP recommended (reliable), UDP for high volume</td>
                                </tr>
                                <tr>
                                    <td><strong>Port</strong></td>
                                    <td>514</td>
                                    <td style="color: #8b949e;">Standard syslog port, or custom (1514, 5514)</td>
                                </tr>
                                <tr>
                                    <td><strong>Vendor</strong></td>
                                    <td>Custom</td>
                                    <td style="color: #8b949e;">Select "Custom" for unsupported sources</td>
                                </tr>
                                <tr>
                                    <td><strong>Product</strong></td>
                                    <td>MyApp</td>
                                    <td style="color: #8b949e;">Your application name</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div style="width: 100%;">
                            <strong>Click "Save"</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Configuration pushes to Broker VM within 1-2 minutes</p>
                        </div>
                    </div>

                    <div class="warning-box">
                        <h4><i class="fas fa-exclamation-triangle" style="color: #d29922;"></i> Important: Dataset Name</h4>
                        <p>When you select Vendor="Custom" and Product="MyApp", XSIAM creates a dataset named:</p>
                        <p style="font-family: monospace; background: #0d1117; padding: 8px; border-radius: 4px; margin-top: 8px;">custom_myapp_raw</p>
                        <p style="margin-top: 8px;">This is the dataset you'll query in XQL. Format: <code>{vendor}_{product}_raw</code></p>
                    </div>
                </div>

                <h3>3B. Configure Source Device to Send Logs</h3>
                <div class="config-section">
                    <p>Now configure your application to send logs to the Broker VM:</p>

                    <h4>Linux Application (rsyslog)</h4>
                    <div class="arch-diagram">
# Edit rsyslog configuration
sudo nano /etc/rsyslog.d/50-myapp.conf

# Add forwarding rule (TCP to Broker VM)
if $programname == 'myapp' then @@10.0.1.50:514

# Or forward specific log file
module(load="imfile")
input(type="imfile"
      File="/var/log/myapp/application.log"
      Tag="myapp"
      Severity="info"
      Facility="local0")

local0.* @@10.0.1.50:514

# Restart rsyslog
sudo systemctl restart rsyslog
                    </div>

                    <h4>Linux Application (syslog-ng)</h4>
                    <div class="arch-diagram">
# Edit syslog-ng configuration
sudo nano /etc/syslog-ng/conf.d/myapp.conf

# Add destination
destination d_xsiam {
    tcp("10.0.1.50" port(514));
};

# Add log path
log {
    source(s_local);
    filter(f_myapp);
    destination(d_xsiam);
};

filter f_myapp {
    program("myapp");
};

# Restart syslog-ng
sudo systemctl restart syslog-ng
                    </div>

                    <h4>Windows Application (NXLog)</h4>
                    <div class="arch-diagram">
# NXLog configuration (C:\Program Files\nxlog\conf\nxlog.conf)

<Input myapp_logs>
    Module      im_file
    File        "C:\\MyApp\\logs\\*.log"
    SavePos     TRUE
</Input>

<Output xsiam_syslog>
    Module      om_tcp
    Host        10.0.1.50
    Port        514
</Output>

<Route myapp_to_xsiam>
    Path        myapp_logs => xsiam_syslog
</Route>
                    </div>

                    <h4>Application with Native Syslog Support</h4>
                    <div class="arch-diagram">
# Many applications have syslog configuration in their config file
# Example: application.yml

logging:
  syslog:
    enabled: true
    host: 10.0.1.50
    port: 514
    protocol: tcp
    facility: local0
                    </div>
                </div>

                <h3>3C. HTTP Collector (Alternative Method)</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → HTTP Collector</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div style="width: 100%;">
                            <strong>Create HTTP Collector</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Settings → Data Sources → HTTP Collector → + Add</p>
                            <table class="field-table" style="margin-top: 12px;">
                                <tr>
                                    <td style="width: 150px;"><strong>Name</strong></td>
                                    <td>myapp-http-collector</td>
                                </tr>
                                <tr>
                                    <td><strong>Vendor</strong></td>
                                    <td>Custom</td>
                                </tr>
                                <tr>
                                    <td><strong>Product</strong></td>
                                    <td>MyApp</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div style="width: 100%;">
                            <strong>Get Collector URL and Token</strong>
                            <p style="color: #8b949e; margin: 4px 0;">After saving, you'll receive:</p>
                            <div class="arch-diagram">
Collector URL: https://api-{tenant}.xsiam.paloaltonetworks.com/logs/v1/event
Authorization Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                            </div>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div style="width: 100%;">
                            <strong>Send Logs via HTTP POST</strong>
                            <div class="arch-diagram">
# Example: Send logs using curl
curl -X POST "https://api-{tenant}.xsiam.paloaltonetworks.com/logs/v1/event" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
  -H "Content-Type: application/json" \
  -d '[
    {"timestamp":"2024-02-15T14:30:00Z","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success"},
    {"timestamp":"2024-02-15T14:30:05Z","user":"jsmith","action":"logout","src_ip":"10.0.1.50"}
  ]'
                            </div>
                        </div>
                    </div>

                    <h4>Python Script Example</h4>
                    <div class="arch-diagram">
import requests
import json
from datetime import datetime

XSIAM_URL = "https://api-{tenant}.xsiam.paloaltonetworks.com/logs/v1/event"
XSIAM_TOKEN = "your-token-here"

def send_logs_to_xsiam(logs):
    headers = {
        "Authorization": f"Bearer {XSIAM_TOKEN}",
        "Content-Type": "application/json"
    }
    response = requests.post(XSIAM_URL, headers=headers, json=logs)
    return response.status_code == 200

# Example usage
logs = [
    {
        "timestamp": datetime.utcnow().isoformat() + "Z",
        "user": "jsmith",
        "action": "login",
        "src_ip": "10.0.1.50",
        "result": "success"
    }
]

if send_logs_to_xsiam(logs):
    print("Logs sent successfully")
else:
    print("Failed to send logs")
                    </div>
                </div>

                <!-- PHASE 4: CREATE CUSTOM PARSING RULES -->
                <div class="phase-header" id="phase4">
                    <span class="phase-num">PHASE 4</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Create Custom Parsing Rules</span>
                </div>

                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-info-circle"></i> What is Parsing?</h4>
                    <p><strong>Parsing</strong> extracts structured fields from raw log text. Without parsing, you only have a blob of text. With parsing, you have searchable fields like <code>user</code>, <code>src_ip</code>, <code>action</code>.</p>
                </div>

                <!-- Decision Tree: Parsing Approach by Log Format -->
                <div class="decision-tree">
                    <h3><i class="fas fa-sitemap"></i> Decision Tree: Choose Parsing Approach</h3>
                    
                    <div class="decision-node">
                        <i class="fas fa-question-circle"></i>
                        <strong>What is the log format?</strong>
                        <small>Examine sample logs to identify structure</small>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow yes">JSON Format</div>
                        <div class="decision-outcome" style="border-left-color: #3fb950;">
                            <i class="fas fa-check-circle" style="color: #3fb950;"></i>
                            <strong>Use json_extract() Functions</strong>
                            <small>Easiest to parse | json_extract(_raw_log, "$.fieldname")</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow no">Key-Value Pairs</div>
                        <div class="decision-outcome" style="border-left-color: #d29922;">
                            <i class="fas fa-code" style="color: #d29922;"></i>
                            <strong>Use regextract() Functions</strong>
                            <small>e.g., "KEY=value" format | regextract(_raw_log, "KEY=(\S+)")</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #58a6ff; color: #0d1117;">Delimited (CSV/Pipe)</div>
                        <div class="decision-outcome" style="border-left-color: #58a6ff;">
                            <i class="fas fa-columns" style="color: #58a6ff;"></i>
                            <strong>Use split() + arrayindex()</strong>
                            <small>e.g., "val1|val2|val3" | split(_raw_log, "|") then arrayindex()</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #a371f7; color: #0d1117;">CEF/LEEF</div>
                        <div class="decision-outcome" style="border-left-color: #a371f7;">
                            <i class="fas fa-shield-alt" style="color: #a371f7;"></i>
                            <strong>Use Built-in CEF/LEEF Parsing</strong>
                            <small>XSIAM has native CEF/LEEF support | Set log format in data source</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #f85149; color: #0d1117;">Unstructured Text</div>
                        <div class="decision-outcome" style="border-left-color: #f85149;">
                            <i class="fas fa-exclamation-triangle" style="color: #f85149;"></i>
                            <strong>Use Complex Regex Patterns</strong>
                            <small>Most difficult | Consider asking dev team to improve log format</small>
                        </div>
                    </div>
                </div>

                <h3>4.1 Check If Parsing is Needed</h3>
                <div class="config-section">
                    <p>First, check if XSIAM is already parsing your logs:</p>
                    <div class="console-path">Investigation → XQL Search</div>
                    
                    <div class="arch-diagram">
// Query raw data to see what's being parsed
dataset = custom_myapp_raw
| limit 10
| fields _raw_log, *
                    </div>
                    
                    <p style="margin-top: 12px;"><strong>If you see:</strong></p>
                    <ul style="color: #8b949e;">
                        <li>Only <code>_raw_log</code> field populated → Custom parsing needed</li>
                        <li>Fields like <code>user</code>, <code>action</code>, etc. → Parsing exists (may still need XDM mapping)</li>
                    </ul>
                </div>

                <h3>4.2 Create Parsing Rule</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → Parsing Rules → + New Rule</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div style="width: 100%;">
                            <strong>Navigate to Parsing Rules</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Settings → Data Sources → Parsing Rules</p>
                            <p style="color: #8b949e; margin: 4px 0;">Click "+ New Rule"</p>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div style="width: 100%;">
                            <strong>Configure Rule Metadata</strong>
                            <table class="field-table" style="margin-top: 12px;">
                                <tr>
                                    <td style="width: 150px;"><strong>Rule Name</strong></td>
                                    <td>MyApp Authentication Parser</td>
                                </tr>
                                <tr>
                                    <td><strong>Vendor</strong></td>
                                    <td>Custom (must match data source)</td>
                                </tr>
                                <tr>
                                    <td><strong>Product</strong></td>
                                    <td>MyApp (must match data source)</td>
                                </tr>
                                <tr>
                                    <td><strong>Log Format</strong></td>
                                    <td>JSON / Syslog / Custom</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div style="width: 100%;">
                            <strong>Enter Parsing Logic</strong>
                            <p style="color: #8b949e; margin: 4px 0;">The parsing logic depends on your log format:</p>
                        </div>
                    </div>
                </div>

                <h3>4.3 Parsing Logic Examples</h3>

                <h4>Example A: JSON Logs</h4>
                <div class="config-section">
                    <p><strong>Sample Log:</strong></p>
                    <div class="example-log">{"timestamp":"2024-02-15T14:30:00Z","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success"}</div>
                    
                    <p><strong>Parsing Rule (XQL-style):</strong></p>
                    <div class="arch-diagram">
[RULE: MyApp JSON Parser]
// JSON logs are parsed automatically, just map fields
alter
    event_timestamp = json_extract(_raw_log, "$.timestamp"),
    username = json_extract(_raw_log, "$.user"),
    event_action = json_extract(_raw_log, "$.action"),
    source_ip = json_extract(_raw_log, "$.src_ip"),
    event_result = json_extract(_raw_log, "$.result")
                    </div>
                </div>

                <h4>Example B: Key-Value Syslog</h4>
                <div class="config-section">
                    <p><strong>Sample Log:</strong></p>
                    <div class="example-log">Feb 15 14:30:00 app-server-01 myapp[1234]: USER=jsmith ACTION=login SRC=10.0.1.50 RESULT=success</div>
                    
                    <p><strong>Parsing Rule (Regex):</strong></p>
                    <div class="arch-diagram">
[RULE: MyApp KV Parser]
// Extract key-value pairs using regex
alter
    username = regextract(_raw_log, "USER=(\S+)"),
    event_action = regextract(_raw_log, "ACTION=(\S+)"),
    source_ip = regextract(_raw_log, "SRC=(\S+)"),
    event_result = regextract(_raw_log, "RESULT=(\S+)"),
    source_host = regextract(_raw_log, "^\w+\s+\d+\s+[\d:]+\s+(\S+)")
                    </div>
                </div>

                <h4>Example C: Pipe-Delimited</h4>
                <div class="config-section">
                    <p><strong>Sample Log:</strong></p>
                    <div class="example-log">2024-02-15T14:30:00|INFO|jsmith|login|10.0.1.50|success</div>
                    
                    <p><strong>Parsing Rule (Split):</strong></p>
                    <div class="arch-diagram">
[RULE: MyApp Delimited Parser]
// Split by pipe delimiter
alter _fields = split(_raw_log, "|")
| alter
    event_timestamp = arrayindex(_fields, 0),
    log_level = arrayindex(_fields, 1),
    username = arrayindex(_fields, 2),
    event_action = arrayindex(_fields, 3),
    source_ip = arrayindex(_fields, 4),
    event_result = arrayindex(_fields, 5)
                    </div>
                </div>

                <h4>Example D: Complex/Mixed Format</h4>
                <div class="config-section">
                    <p><strong>Sample Log:</strong></p>
                    <div class="example-log">2024-02-15 14:30:00 INFO [AuthService] User 'jsmith' logged in from 10.0.1.50 - Session: abc123</div>
                    
                    <p><strong>Parsing Rule (Multiple Regex):</strong></p>
                    <div class="arch-diagram">
[RULE: MyApp Complex Parser]
// Extract fields using multiple regex patterns
alter
    event_timestamp = regextract(_raw_log, "^(\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2})"),
    log_level = regextract(_raw_log, "^\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2}\s+(\w+)"),
    service_name = regextract(_raw_log, "\[(\w+)\]"),
    username = regextract(_raw_log, "User\s+'(\w+)'"),
    source_ip = regextract(_raw_log, "from\s+(\d+\.\d+\.\d+\.\d+)"),
    session_id = regextract(_raw_log, "Session:\s+(\S+)")
                    </div>
                </div>

                <div class="config-step">
                    <div class="step-num">4</div>
                    <div style="width: 100%;">
                        <strong>Test Parsing Rule</strong>
                        <p style="color: #8b949e; margin: 4px 0;">Click "Test" → Paste sample logs → Verify fields are extracted correctly</p>
                    </div>
                </div>

                <div class="config-step">
                    <div class="step-num">5</div>
                    <div style="width: 100%;">
                        <strong>Save and Apply</strong>
                        <p style="color: #8b949e; margin: 4px 0;">Click "Save" → Rule applies to new incoming logs</p>
                        <p style="color: #d29922; margin: 4px 0;">Note: Existing logs are NOT re-parsed. Only new logs get the parsing.</p>
                    </div>
                </div>

                <!-- PHASE 5: XDM FIELD MAPPING -->
                <div class="phase-header" id="phase5">
                    <span class="phase-num">PHASE 5</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">XDM Field Mapping</span>
                </div>

                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-info-circle"></i> Why XDM Mapping?</h4>
                    <p><strong>XDM (XSIAM Data Model)</strong> is the normalized schema. Mapping your custom fields to XDM allows:</p>
                    <ul style="color: #8b949e; margin-top: 8px;">
                        <li>Cross-source correlation (correlate MyApp with firewall, Windows, etc.)</li>
                        <li>Use built-in detection rules designed for XDM fields</li>
                        <li>Consistent field names across all data sources</li>
                    </ul>
                </div>

                <h3>5.1 Add XDM Mapping to Parsing Rule</h3>
                <div class="config-section">
                    <p>Extend your parsing rule to include XDM mappings:</p>
                    
                    <div class="arch-diagram">
[RULE: MyApp Parser with XDM Mapping]

// Step 1: Extract raw fields
alter
    username = json_extract(_raw_log, "$.user"),
    event_action = json_extract(_raw_log, "$.action"),
    source_ip = json_extract(_raw_log, "$.src_ip"),
    event_result = json_extract(_raw_log, "$.result"),
    event_timestamp = json_extract(_raw_log, "$.timestamp")

// Step 2: Map to XDM normalized fields
| alter
    xdm.source.user.username = username,
    xdm.source.ipv4 = source_ip,
    xdm.event.operation = event_action,
    xdm.event.outcome = if(event_result = "success", "SUCCESS", "FAILURE"),
    xdm.event.type = "AUTH"
                    </div>
                </div>

                <h3>5.2 Common XDM Field Mappings</h3>
                <table class="field-table">
                    <thead>
                        <tr>
                            <th>Your Field</th>
                            <th>XDM Field</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>user, username, usr</td>
                            <td><code>xdm.source.user.username</code></td>
                            <td>User performing action</td>
                        </tr>
                        <tr>
                            <td>src_ip, source_ip, client_ip</td>
                            <td><code>xdm.source.ipv4</code></td>
                            <td>Source IP address</td>
                        </tr>
                        <tr>
                            <td>dst_ip, dest_ip, target_ip</td>
                            <td><code>xdm.target.ipv4</code></td>
                            <td>Destination IP address</td>
                        </tr>
                        <tr>
                            <td>action, operation, event_type</td>
                            <td><code>xdm.event.operation</code></td>
                            <td>What happened</td>
                        </tr>
                        <tr>
                            <td>result, status, outcome</td>
                            <td><code>xdm.event.outcome</code></td>
                            <td>SUCCESS or FAILURE</td>
                        </tr>
                        <tr>
                            <td>hostname, host, server</td>
                            <td><code>xdm.source.host.hostname</code></td>
                            <td>Source hostname</td>
                        </tr>
                        <tr>
                            <td>url, request_url</td>
                            <td><code>xdm.target.url</code></td>
                            <td>Target URL</td>
                        </tr>
                        <tr>
                            <td>file_path, path</td>
                            <td><code>xdm.target.file.path</code></td>
                            <td>File path accessed</td>
                        </tr>
                        <tr>
                            <td>hash, sha256, md5</td>
                            <td><code>xdm.target.file.sha256</code></td>
                            <td>File hash</td>
                        </tr>
                    </tbody>
                </table>

                <!-- PHASE 6: VERIFY DATA -->
                <div class="phase-header" id="phase6">
                    <span class="phase-num">PHASE 6</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Verify Data Ingestion</span>
                </div>

                <h3>6.1 Check Data is Arriving</h3>
                <div class="config-section">
                    <div class="console-path">Investigation → XQL Search</div>
                    
                    <h4>Query 1: Basic Data Check</h4>
                    <div class="arch-diagram">
// Check if data exists in your dataset
dataset = custom_myapp_raw
| filter _time > ago(1h)
| limit 10
                    </div>

                    <h4>Query 2: Check Event Count Over Time</h4>
                    <div class="arch-diagram">
// See volume trend
dataset = custom_myapp_raw
| filter _time > ago(24h)
| comp count = count() by bin(_time, 1h)
| sort asc _time
                    </div>

                    <h4>Query 3: Verify Parsing is Working</h4>
                    <div class="arch-diagram">
// Check that fields are being extracted
dataset = custom_myapp_raw
| filter _time > ago(1h)
| fields _time, username, event_action, source_ip, event_result, xdm.source.user.username
| limit 20
                    </div>
                    
                    <div class="success-box">
                        <h4><i class="fas fa-check-circle" style="color: #3fb950;"></i> Success Indicators</h4>
                        <ul style="color: #8b949e;">
                            <li>Query returns results (data is arriving)</li>
                            <li>Custom fields populated (parsing working)</li>
                            <li>XDM fields populated (normalization working)</li>
                        </ul>
                    </div>
                </div>

                <h3>6.2 Check Data Source Status</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → [Your Data Source]</div>
                    
                    <p>View data source status to confirm:</p>
                    <ul style="color: #8b949e;">
                        <li><strong>Status:</strong> Active</li>
                        <li><strong>Last Event:</strong> Recent timestamp (within last few minutes)</li>
                        <li><strong>Events/Hour:</strong> Non-zero, matches expected volume</li>
                    </ul>
                </div>

                <!-- PHASE 7: CREATE DETECTION RULES -->
                <div class="phase-header" id="phase7">
                    <span class="phase-num">PHASE 7</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Create Detection Rules</span>
                </div>

                <h3>7.1 Example Detection Rules for Custom Source</h3>
                <div class="config-section">
                    <div class="console-path">Rules → Correlation Rules → + New Rule</div>

                    <h4>Rule 1: Brute Force on MyApp</h4>
                    <div class="arch-diagram">
// Detect 10+ failed logins in 5 minutes
dataset = custom_myapp_raw
| filter _time > ago(5m)
| filter event_action = "login" and event_result = "failure"
| comp failed_attempts = count() by username, source_ip
| filter failed_attempts >= 10
                    </div>
                    <p style="color: #8b949e;">Settings: Frequency=1min, Severity=High, MITRE=T1110</p>

                    <h4>Rule 2: Login from New IP (Using XDM for Cross-Source)</h4>
                    <div class="arch-diagram">
// Detect login from IP not seen in last 30 days
dataset = custom_myapp_raw
| filter _time > ago(1h)
| filter event_action = "login" and event_result = "success"
| join type=leftantijoin (
    dataset = custom_myapp_raw
    | filter _time > ago(30d) and _time < ago(1h)
    | filter event_action = "login" and event_result = "success"
    | dedup username, source_ip
  ) as historical
  on username = historical.username and source_ip = historical.source_ip
| fields _time, username, source_ip
                    </div>

                    <h4>Rule 3: Privileged Action Detection</h4>
                    <div class="arch-diagram">
// Detect admin-level actions
dataset = custom_myapp_raw
| filter _time > ago(5m)
| filter event_action in ("delete_user", "modify_permissions", "export_data", "config_change")
| fields _time, username, event_action, source_ip
                    </div>
                </div>

                <!-- PHASE 8: TROUBLESHOOTING -->
                <div class="phase-header" id="phase8">
                    <span class="phase-num">PHASE 8</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Troubleshooting</span>
                </div>

                <!-- Troubleshooting Decision Tree -->
                <div class="decision-tree">
                    <h3><i class="fas fa-sitemap"></i> Decision Tree: Troubleshoot Custom Log Issues</h3>
                    
                    <div class="decision-node">
                        <i class="fas fa-question-circle"></i>
                        <strong>Are you seeing ANY data in XQL queries?</strong>
                        <small>Query: <code>dataset = custom_yourapp_raw | limit 5</code></small>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow no">NO DATA</div>
                        <div class="decision-node">
                            <i class="fas fa-question-circle"></i>
                            <strong>Is the Broker VM receiving logs?</strong>
                            <small>Check: <code>tcpdump -i eth0 port 514</code> on Broker VM</small>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow no">NO</div>
                            <div class="decision-outcome" style="border-left-color: #f85149;">
                                <i class="fas fa-network-wired" style="color: #f85149;"></i>
                                <strong>Network/Source Issue</strong>
                                <small>Check: Source is sending logs | Firewall allows traffic | Correct Broker IP/port configured</small>
                            </div>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow yes">YES</div>
                            <div class="decision-node">
                                <i class="fas fa-question-circle"></i>
                                <strong>Is there a Data Source configured?</strong>
                                <small>Settings → Data Sources → Check for your source</small>
                            </div>
                            
                            <div class="decision-branch">
                                <div class="decision-arrow no">NO</div>
                                <div class="decision-outcome" style="border-left-color: #d29922;">
                                    <i class="fas fa-cog" style="color: #d29922;"></i>
                                    <strong>Create Data Source</strong>
                                    <small>Settings → Data Sources → + Add → Configure Vendor/Product</small>
                                </div>
                            </div>
                            
                            <div class="decision-branch">
                                <div class="decision-arrow yes">YES</div>
                                <div class="decision-outcome" style="border-left-color: #58a6ff;">
                                    <i class="fas fa-search" style="color: #58a6ff;"></i>
                                    <strong>Check Dataset Name</strong>
                                    <small>Dataset format: <code>custom_{vendor}_{product}_raw</code> | Verify exact spelling in query</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow yes">DATA EXISTS</div>
                        <div class="decision-node">
                            <i class="fas fa-question-circle"></i>
                            <strong>Are custom fields being extracted?</strong>
                            <small>Check if fields beyond _raw_log are populated</small>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow no">NO - Only _raw_log</div>
                            <div class="decision-node">
                                <i class="fas fa-question-circle"></i>
                                <strong>Does a parsing rule exist?</strong>
                                <small>Settings → Parsing Rules → Search by vendor/product</small>
                            </div>
                            
                            <div class="decision-branch">
                                <div class="decision-arrow no">NO</div>
                                <div class="decision-outcome" style="border-left-color: #d29922;">
                                    <i class="fas fa-code" style="color: #d29922;"></i>
                                    <strong>Create Parsing Rule</strong>
                                    <small>Settings → Parsing Rules → + New Rule → Match Vendor/Product to Data Source</small>
                                </div>
                            </div>
                            
                            <div class="decision-branch">
                                <div class="decision-arrow yes">YES</div>
                                <div class="decision-outcome" style="border-left-color: #a371f7;">
                                    <i class="fas fa-bug" style="color: #a371f7;"></i>
                                    <strong>Debug Parsing Rule</strong>
                                    <small>Verify: Vendor/Product match exactly | Rule enabled | Test with actual raw log | Check regex/extraction syntax</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow yes">YES - Partial</div>
                            <div class="decision-outcome" style="border-left-color: #3fb950;">
                                <i class="fas fa-wrench" style="color: #3fb950;"></i>
                                <strong>Refine Parsing Rule</strong>
                                <small>Log format variations exist | Add conditional parsing | Handle edge cases in extraction logic</small>
                            </div>
                        </div>
                    </div>
                </div>

                <h3>Common Issues and Solutions</h3>

                <div class="troubleshoot-item">
                    <h4><i class="fas fa-times-circle" style="color: #f85149;"></i> Issue: No Data in XQL Query</h4>
                    <p style="color: #8b949e; margin: 8px 0;"><strong>Symptoms:</strong> Query returns 0 results</p>
                    <p><strong>Diagnostic Steps:</strong></p>
                    <ol style="color: #8b949e; font-size: 0.9rem;">
                        <li>Check Broker VM is receiving data: <code>broker-vm> show listeners</code></li>
                        <li>Verify source is sending: <code>tcpdump -i eth0 port 514 | head</code></li>
                        <li>Check Data Source status in console</li>
                        <li>Verify dataset name matches: <code>dataset = custom_myapp_raw</code></li>
                        <li>Check time filter isn't too narrow</li>
                    </ol>
                    <p><strong>Solution:</strong> Usually network/firewall issue between source and Broker VM, or wrong dataset name.</p>
                </div>

                <div class="troubleshoot-item">
                    <h4><i class="fas fa-times-circle" style="color: #f85149;"></i> Issue: Data Arrives But Fields Not Parsed</h4>
                    <p style="color: #8b949e; margin: 8px 0;"><strong>Symptoms:</strong> Only <code>_raw_log</code> field populated</p>
                    <p><strong>Diagnostic Steps:</strong></p>
                    <ol style="color: #8b949e; font-size: 0.9rem;">
                        <li>Check parsing rule exists and is enabled</li>
                        <li>Verify Vendor/Product matches between data source and parsing rule</li>
                        <li>Test parsing rule with sample logs</li>
                        <li>Check for regex errors in parsing rule</li>
                    </ol>
                    <p><strong>Solution:</strong> Parsing rule not applied or regex/extraction logic incorrect.</p>
                </div>

                <div class="troubleshoot-item">
                    <h4><i class="fas fa-times-circle" style="color: #f85149;"></i> Issue: Some Fields Missing/Empty</h4>
                    <p style="color: #8b949e; margin: 8px 0;"><strong>Symptoms:</strong> Some fields parse, others are null</p>
                    <p><strong>Diagnostic Steps:</strong></p>
                    <ol style="color: #8b949e; font-size: 0.9rem;">
                        <li>Check raw log format matches expected pattern</li>
                        <li>Test regex against actual logs (not just samples)</li>
                        <li>Look for edge cases (different log formats from same source)</li>
                    </ol>
                    <p><strong>Solution:</strong> Log format varies; update parsing rule to handle all variations.</p>
                </div>

                <div class="troubleshoot-item">
                    <h4><i class="fas fa-times-circle" style="color: #f85149;"></i> Issue: High Latency (Logs Delayed)</h4>
                    <p style="color: #8b949e; margin: 8px 0;"><strong>Symptoms:</strong> Logs appear in XSIAM minutes/hours after generation</p>
                    <p><strong>Diagnostic Steps:</strong></p>
                    <ol style="color: #8b949e; font-size: 0.9rem;">
                        <li>Check Broker VM queue: <code>broker-vm> show upload-queue</code></li>
                        <li>Check Broker VM bandwidth to cloud</li>
                        <li>Verify source is sending in real-time (not batched)</li>
                    </ol>
                    <p><strong>Solution:</strong> Broker VM upload backlog (bandwidth issue) or source batching logs.</p>
                </div>

                <!-- COMPLETE EXAMPLES -->
                <div class="phase-header" id="examples">
                    <span class="phase-num">EXAMPLES</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Complete End-to-End Examples</span>
                </div>

                <h3>Example A: Custom Java Application</h3>
                <div class="config-section">
                    <h4>Scenario</h4>
                    <p style="color: #8b949e;">Java microservice generating JSON logs with authentication events. Running on Linux server 10.0.1.100.</p>

                    <h4>Step 1: Sample Logs</h4>
                    <div class="example-log">{"@timestamp":"2024-02-15T14:30:00.123Z","level":"INFO","logger":"AuthService","message":"User login","user_id":"jsmith","client_ip":"10.0.1.50","auth_result":"SUCCESS","session_id":"sess-abc123"}
{"@timestamp":"2024-02-15T14:30:05.456Z","level":"WARN","logger":"AuthService","message":"Failed login attempt","user_id":"admin","client_ip":"192.168.1.100","auth_result":"FAILURE","failure_reason":"invalid_password"}</div>

                    <h4>Step 2: Data Source Configuration</h4>
                    <table class="field-table">
                        <tr><td>Name</td><td>java-auth-service-logs</td></tr>
                        <tr><td>Broker VM</td><td>broker-vm-dc1</td></tr>
                        <tr><td>Protocol</td><td>TCP</td></tr>
                        <tr><td>Port</td><td>1514</td></tr>
                        <tr><td>Vendor</td><td>Custom</td></tr>
                        <tr><td>Product</td><td>JavaAuthService</td></tr>
                    </table>
                    <p style="color: #8b949e; margin-top: 8px;">Dataset created: <code>custom_javaauthservice_raw</code></p>

                    <h4>Step 3: Source Configuration (rsyslog)</h4>
                    <div class="arch-diagram">
# /etc/rsyslog.d/60-java-app.conf
module(load="imfile")
input(type="imfile"
      File="/var/log/myapp/auth.log"
      Tag="javaauth"
      Facility="local1")

local1.* @@10.0.1.50:1514
                    </div>

                    <h4>Step 4: Parsing Rule</h4>
                    <div class="arch-diagram">
[RULE: Java Auth Service Parser]
// Extract JSON fields
alter
    event_time = json_extract(_raw_log, "$.@timestamp"),
    log_level = json_extract(_raw_log, "$.level"),
    logger = json_extract(_raw_log, "$.logger"),
    message = json_extract(_raw_log, "$.message"),
    user_id = json_extract(_raw_log, "$.user_id"),
    client_ip = json_extract(_raw_log, "$.client_ip"),
    auth_result = json_extract(_raw_log, "$.auth_result"),
    session_id = json_extract(_raw_log, "$.session_id"),
    failure_reason = json_extract(_raw_log, "$.failure_reason")

// Map to XDM
| alter
    xdm.source.user.username = user_id,
    xdm.source.ipv4 = client_ip,
    xdm.event.type = "AUTH",
    xdm.event.outcome = if(auth_result = "SUCCESS", "SUCCESS", "FAILURE"),
    xdm.event.description = message,
    xdm.session.id = session_id
                    </div>

                    <h4>Step 5: Verification Query</h4>
                    <div class="arch-diagram">
dataset = custom_javaauthservice_raw
| filter _time > ago(1h)
| fields _time, user_id, client_ip, auth_result, xdm.source.user.username, xdm.event.outcome
| limit 20
                    </div>

                    <h4>Step 6: Detection Rule</h4>
                    <div class="arch-diagram">
// Java Auth Service - Brute Force Detection
dataset = custom_javaauthservice_raw
| filter _time > ago(5m)
| filter auth_result = "FAILURE"
| comp failed = count() by user_id, client_ip
| filter failed >= 5
                    </div>
                </div>

                <h3>Example B: Custom Network Appliance via HTTP</h3>
                <div class="config-section">
                    <h4>Scenario</h4>
                    <p style="color: #8b949e;">Network appliance that can only send logs via HTTP webhook (no syslog support).</p>

                    <h4>Step 1: Create HTTP Collector</h4>
                    <div class="console-path">Settings → Data Sources → HTTP Collector → + Add</div>
                    <table class="field-table">
                        <tr><td>Name</td><td>network-appliance-http</td></tr>
                        <tr><td>Vendor</td><td>Custom</td></tr>
                        <tr><td>Product</td><td>NetworkAppliance</td></tr>
                    </table>
                    <p style="color: #8b949e; margin-top: 8px;">Copy the generated URL and token.</p>

                    <h4>Step 2: Configure Appliance Webhook</h4>
                    <p style="color: #8b949e;">In appliance admin console:</p>
                    <table class="field-table">
                        <tr><td>Webhook URL</td><td>https://api-{tenant}.xsiam.paloaltonetworks.com/logs/v1/event</td></tr>
                        <tr><td>Authorization Header</td><td>Bearer eyJhbGciOiJIUzI1NiIs...</td></tr>
                        <tr><td>Content-Type</td><td>application/json</td></tr>
                    </table>

                    <h4>Step 3: Sample Logs (what appliance sends)</h4>
                    <div class="example-log">[{"event_type":"connection","timestamp":"2024-02-15T14:30:00Z","src":"10.0.1.50","dst":"8.8.8.8","port":443,"action":"allow","bytes":1024}]</div>

                    <h4>Step 4: Parsing Rule</h4>
                    <div class="arch-diagram">
[RULE: Network Appliance Parser]
alter
    event_type = json_extract(_raw_log, "$.event_type"),
    src_ip = json_extract(_raw_log, "$.src"),
    dst_ip = json_extract(_raw_log, "$.dst"),
    dst_port = json_extract(_raw_log, "$.port"),
    action = json_extract(_raw_log, "$.action"),
    bytes = json_extract(_raw_log, "$.bytes")

| alter
    xdm.source.ipv4 = src_ip,
    xdm.target.ipv4 = dst_ip,
    xdm.target.port = to_integer(dst_port),
    xdm.event.outcome = if(action = "allow", "SUCCESS", "FAILURE"),
    xdm.event.type = "NETWORK",
    xdm.network.session.bytes_sent = to_integer(bytes)
                    </div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through onboarding a custom log source that isn't natively supported by XSIAM.</button>
                        <div class="qa-answer">
                            <p>I've onboarded numerous custom sources, so I've developed a reliable process. First, I always start with discovery—I'll schedule time with the application team to understand what the log source is, get sample logs (at least 10-20 events covering different scenarios), and document expected volume. This planning phase prevents a lot of rework later.</p>
                            <p>For the technical implementation, I choose the ingestion method based on where the source lives. On-prem sources typically go through a Broker VM using syslog—I configure the Data Source in XSIAM with a descriptive name and set the Vendor to "Custom" and Product to something meaningful like "InternalCRM". For cloud or API-based sources, I use the HTTP Collector and either configure webhooks or build a small script to poll and push data.</p>
                            <p>Once data starts flowing, I build the parsing rule. I always test in the XSIAM parsing rule editor using actual raw logs, not just the samples—real logs often have variations. For JSON logs, I use json_extract() which is straightforward. For syslog with key-value pairs, I write regex with named capture groups. The critical step is XDM mapping—I map fields like username to xdm.source.user.username and IP addresses to xdm.source.ipv4 so they correlate with other data sources.</p>
                            <p>Finally, I verify by running XQL queries to confirm data arrives, fields parse correctly, and XDM fields populate. Then I create initial detection rules tailored to that source—for an auth service, that might be brute force detection or login from unusual locations. The whole process typically takes 2-4 hours for a well-structured source, longer if the log format is messy.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: You're seeing logs in XSIAM but the custom fields aren't being extracted—only _raw_log is populated. How do you troubleshoot?</button>
                        <div class="qa-answer">
                            <p>This is one of the most common issues I encounter with custom sources, and it's usually one of three things. My first check is always whether a parsing rule actually exists—I go to Settings → Parsing Rules and search for the vendor and product name. People often create the data source but forget the parsing rule, or create it for the wrong vendor/product combination.</p>
                            <p>If the parsing rule exists, I verify that the Vendor and Product values match exactly between the Data Source and the Parsing Rule. This is case-sensitive and has to be identical—I've seen "custom" vs "Custom" cause issues. Then I check if the rule is actually enabled; disabled rules won't process anything.</p>
                            <p>If those are all correct, I edit the parsing rule and use the built-in test feature. I paste an actual raw log from the dataset (not my original samples) and see if extraction works. Often the issue is that the real logs have slight format variations from the samples I used—maybe extra fields, different timestamp formats, or escape characters. When I find the discrepancy, I adjust my regex or json_extract statements to handle the actual data.</p>
                            <p>One important thing to remember: parsing only applies to new logs after the rule is created or modified. Existing logs in the dataset won't be re-parsed. So after fixing a parsing rule, I wait for new events and then query to verify the fix worked.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you decide between using the Broker VM syslog approach versus the HTTP Collector for a custom source?</button>
                        <div class="qa-answer">
                            <p>The decision really comes down to where the source lives and what capabilities it has. For on-premises sources—network equipment, Linux servers, Windows servers, security appliances—Broker VM with syslog is almost always my go-to. It's reliable, well-understood, and most enterprise devices support syslog natively. I configure the device to send to the Broker VM's IP on port 514 (or a custom port like 1514 if I need separation), and the Broker handles batching and uploading to XSIAM.</p>
                            <p>HTTP Collector makes sense when syslog isn't an option or isn't practical. Cloud-native applications, SaaS platforms, and modern APIs often prefer HTTP webhooks over syslog. If an application can natively push JSON via HTTP POST, the HTTP Collector is cleaner—no intermediate infrastructure needed. I also use it for custom integrations where I write a small Python script to pull from an API and push to XSIAM.</p>
                            <p>There are also hybrid scenarios. Sometimes an on-prem application can't send syslog but has good log files. In that case, I deploy a log shipper like rsyslog or Filebeat on the server, have it tail the log file, and forward to the Broker VM. The Broker still handles the XSIAM connectivity, but I'm using a local agent to handle the file-to-syslog conversion.</p>
                            <p>One practical consideration: Broker VM gives you more control over buffering and retry logic if network connectivity to the cloud is unreliable. HTTP Collector expects the source to handle retries, which not all applications do well.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Why is XDM mapping important when onboarding custom sources, and how do you approach it?</button>
                        <div class="qa-answer">
                            <p>XDM mapping is really the key that unlocks the value of having data in XSIAM. Without XDM, each data source lives in isolation—my custom auth logs have "user_id" and my firewall has "src_user" and my cloud logs have "userPrincipalName". They're all referring to the same concept, but correlation rules can't see that relationship.</p>
                            <p>When I map user_id to xdm.source.user.username across all sources, I can write a single correlation rule that detects an attacker moving across systems—failed VPN login followed by successful cloud authentication followed by suspicious file access. That cross-source detection is impossible without normalized fields. It's the same reason we standardize on frameworks like MITRE ATT&CK for threat detection—common language enables common detection.</p>
                            <p>My approach to XDM mapping starts with identifying the security-relevant fields in the custom source. Usernames, IP addresses, hostnames, actions, and outcomes are always priorities. I map them to the most semantically correct XDM field—if it's the user performing an action, that's xdm.source.user.username; if it's the target of an action, it might be xdm.target.user.username. For IP addresses, I consider whether it's the source of traffic (xdm.source.ipv4) or destination (xdm.target.ipv4).</p>
                            <p>I also make sure to set xdm.event.type and xdm.event.outcome when possible. Event type like "AUTH" or "NETWORK" helps in filtering across datasets, and outcome values of "SUCCESS" or "FAILURE" are critical for security detection logic. The XDM schema is extensive, so I keep the documentation handy and don't try to map everything—just the fields that matter for detection and investigation.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: A developer team wants to onboard logs from a new application. What information do you need from them, and what guidance do you give?</button>
                        <div class="qa-answer">
                            <p>I've worked with a lot of dev teams on this, and getting the right information upfront saves everyone time. My standard request list includes: sample logs covering normal operations and error conditions (at least 20 events), documentation of what each field means, expected volume (events per second or per day), the transport mechanism they can support (syslog, HTTP, file-based), and the security use cases they care about—what threats or behaviors should we detect?</p>
                            <p>For guidance, the biggest value-add I can provide is log format recommendations. If they're still designing the logging, I strongly advocate for JSON with consistent field names. I'll send them examples of well-structured logs that are easy to parse and include all the context needed for security investigation—timestamp in ISO 8601, user identifiers, source IPs, action performed, result status, and any relevant resource or target information. Structured logs with consistent schemas reduce our parsing effort from hours to minutes.</p>
                            <p>I also discuss security-relevant events with them. Developers often log everything or nothing from a security perspective. I help them identify what we actually need: authentication events (success and failure), authorization decisions, configuration changes, data access to sensitive resources, and error conditions that might indicate attacks. We don't need every debug message, but we do need the security-meaningful events.</p>
                            <p>Finally, I set expectations on timeline and process. I explain that I'll create a test data source first, validate everything works with sample data, then we'll do a phased rollout. I ask them to send a small volume initially so we can verify parsing before ramping up. This prevents the scenario where thousands of unparsed events pile up because of a format mismatch we could have caught early.</p>
                        </div>
                    </div>
                    
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle a situation where the custom log source has multiple log formats or variations?</button>
                        <div class="qa-answer">
                            <p>This is actually quite common with real-world applications. A single application might have different log formats for authentication events versus error messages versus transaction logs. My approach depends on how different the formats are and whether they should be separate datasets or unified.</p>
                            <p>If the formats are fundamentally different—like JSON for one event type and syslog for another—I often create separate data sources with separate parsing rules. This keeps the parsing logic clean and makes troubleshooting easier. The datasets might be custom_myapp_auth_raw and custom_myapp_errors_raw. I can still correlate them in detection rules using XDM fields.</p>
                            <p>If the variations are minor—same general structure but optional fields or slightly different key names—I handle it within a single parsing rule using conditional logic. In XSIAM parsing rules, I use coalesce() to handle fields that might have different names, and I structure my extraction to handle missing fields gracefully. For example, json_extract might return null for a field that doesn't exist in every event, and I just leave that XDM field unmapped rather than failing the parse.</p>
                            <p>The testing phase is critical with variable formats. I make sure to test the parsing rule against every variation I've seen in the samples, and I run validation queries after go-live to identify any events that aren't parsing correctly. A query like <code>dataset = custom_myapp_raw | filter isnull(xdm.source.user.username)</code> helps me find events where expected fields are missing, which usually indicates a format variation I didn't account for.</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>