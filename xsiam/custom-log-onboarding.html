<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Log Source Onboarding - Complete Guide | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">XSIAM Pages</div>
                                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-ingestion.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Ingestion</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="broker-vm.html" class="sidebar-nav-link">
                            <i class="fas fa-server"></i>
                            <span>Broker VM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="agents.html" class="sidebar-nav-link">
                            <i class="fas fa-microchip"></i>
                            <span>Agents</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-stream"></i>
                            <span>Parsing & Flows</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="custom-log-onboarding.html" class="sidebar-nav-link active">
                            <i class="fas fa-plus-circle"></i>
                            <span>Custom Log Onboarding</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-archive"></i>
                            <span>Retention Tiers</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>XQL Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-rocket"></i>
                            <span>XQL Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xdr-overview.html" class="sidebar-nav-link">
                            <i class="fas fa-shield-virus"></i>
                            <span>XDR & Detection</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="correlation-rules.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>Correlation Rules</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="alert-management.html" class="sidebar-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Alert Management</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xsoar-automation.html" class="sidebar-nav-link">
                            <i class="fas fa-robot"></i>
                            <span>XSOAR Automation</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-skull-crossbones"></i>
                            <span>Threat Intel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="recon-asm.html" class="sidebar-nav-link">
                            <i class="fas fa-globe"></i>
                            <span>Recon & ASM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="dashboards.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-line"></i>
                            <span>Dashboards</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="marketplace.html" class="sidebar-nav-link">
                            <i class="fas fa-store"></i>
                            <span>Marketplace</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-soc.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Enterprise SOC</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="comparison.html" class="sidebar-nav-link">
                            <i class="fas fa-balance-scale"></i>
                            <span>Platform Comparison</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Custom Log Onboarding</span>
                </div>

                <h1><i class="fas fa-file-import"></i> Custom Log Source Onboarding - Complete Guide</h1>
                <p class="lead">The definitive guide to onboarding any custom log source into XSIAM. Covers every step from initial planning through verification, with real examples, console paths, and troubleshooting.</p>

                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-bookmark"></i> What This Guide Covers</h4>
                    <p>This guide walks through onboarding a <strong>custom application log</strong> that isn't natively supported by XSIAM. By the end, you'll have:</p>
                    <ul style="color: #8b949e; margin-top: 8px;">
                        <li>Log data flowing into XSIAM</li>
                        <li>Custom parsing rules extracting fields</li>
                        <li>XDM normalization for correlation</li>
                        <li>Verification queries confirming data</li>
                        <li>Detection rules on the new source</li>
                    </ul>
                </div>

                <!-- TABLE OF CONTENTS -->
                <div class="config-section">
                    <h3><i class="fas fa-list"></i> Table of Contents</h3>
                    <ol style="color: #8b949e; line-height: 2;">
                        <li><a href="#phase1" style="color: #58a6ff;">Phase 1: Planning & Prerequisites</a></li>
                        <li><a href="#phase2" style="color: #58a6ff;">Phase 2: Choose Ingestion Method</a></li>
                        <li><a href="#phase3" style="color: #58a6ff;">Phase 3: Configure Data Source</a></li>
                        <li><a href="#phase4" style="color: #58a6ff;">Phase 4: Create Custom Parsing Rules</a></li>
                        <li><a href="#phase5" style="color: #58a6ff;">Phase 5: XDM Field Mapping</a></li>
                        <li><a href="#phase6" style="color: #58a6ff;">Phase 6: Verify Data Ingestion</a></li>
                        <li><a href="#phase7" style="color: #58a6ff;">Phase 7: Create Detection Rules</a></li>
                        <li><a href="#phase8" style="color: #58a6ff;">Phase 8: Troubleshooting</a></li>
                        <li><a href="#examples" style="color: #58a6ff;">Complete Examples</a></li>
                    </ol>
                </div>

                <!-- PHASE 1: PLANNING -->
                <div class="phase-header" id="phase1">
                    <span class="phase-num">PHASE 1</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Planning & Prerequisites</span>
                </div>

                <h3>1.1 Gather Log Source Information</h3>
                <p>Before starting configuration, collect this information:</p>

                <table class="field-table">
                    <thead>
                        <tr>
                            <th>Information Needed</th>
                            <th>Why It's Needed</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Log format</strong></td>
                            <td>Determines parsing approach</td>
                            <td>Syslog, JSON, CSV, CEF, custom</td>
                        </tr>
                        <tr>
                            <td><strong>Transport protocol</strong></td>
                            <td>Determines ingestion method</td>
                            <td>Syslog TCP/UDP, HTTP/API, file-based</td>
                        </tr>
                        <tr>
                            <td><strong>Expected volume</strong></td>
                            <td>Sizing and licensing</td>
                            <td>~5,000 events/hour = ~120K/day</td>
                        </tr>
                        <tr>
                            <td><strong>Sample logs (10-20)</strong></td>
                            <td>Build and test parsing rules</td>
                            <td>Copy from source system</td>
                        </tr>
                        <tr>
                            <td><strong>Field documentation</strong></td>
                            <td>Understand what each field means</td>
                            <td>Vendor documentation or schema</td>
                        </tr>
                        <tr>
                            <td><strong>Source IP/hostname</strong></td>
                            <td>Configure sender, troubleshoot</td>
                            <td>10.0.1.100, app-server-01</td>
                        </tr>
                        <tr>
                            <td><strong>Security relevance</strong></td>
                            <td>Prioritize which fields to extract</td>
                            <td>Auth events, errors, user actions</td>
                        </tr>
                    </tbody>
                </table>

                <h3>1.2 Get Sample Logs</h3>
                <div class="config-section">
                    <p>You need real sample logs to build parsing rules. Methods to get them:</p>
                    
                    <h4>Option A: From the Application</h4>
                    <div class="arch-diagram">
# SSH to application server
ssh admin@app-server-01

# View recent logs
tail -100 /var/log/myapp/application.log

# Copy samples to your machine
scp admin@app-server-01:/var/log/myapp/application.log ./samples/
                    </div>

                    <h4>Option B: From Existing SIEM</h4>
                    <div class="arch-diagram">
# If logs are already going to another SIEM, export samples
# Splunk example:
index=myapp earliest=-1h | head 100 | table _raw
                    </div>

                    <h4>Option C: Packet Capture</h4>
                    <div class="arch-diagram">
# Capture syslog traffic on Broker VM or network tap
tcpdump -i eth0 port 514 -w syslog_capture.pcap -c 1000

# View captured packets
tcpdump -r syslog_capture.pcap -A | head -200
                    </div>
                </div>

                <h3>1.3 Analyze Log Format</h3>
                <div class="config-section">
                    <p>Identify the log format to determine parsing approach:</p>

                    <h4>Example: JSON Format</h4>
                    <div class="example-log">
{"timestamp":"2024-02-15T14:30:00Z","level":"INFO","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success","session_id":"abc123"}
{"timestamp":"2024-02-15T14:30:05Z","level":"WARN","user":"jsmith","action":"access_denied","resource":"/admin/config","src_ip":"10.0.1.50"}
                    </div>
                    <p style="color: #3fb950;">✓ JSON is easiest to parse - use json_extract() functions</p>

                    <h4>Example: Syslog with Key-Value Pairs</h4>
                    <div class="example-log">
Feb 15 14:30:00 app-server-01 myapp[1234]: USER=jsmith ACTION=login SRC=10.0.1.50 RESULT=success
Feb 15 14:30:05 app-server-01 myapp[1234]: USER=jsmith ACTION=access_denied RESOURCE=/admin/config SRC=10.0.1.50
                    </div>
                    <p style="color: #d29922;">△ Key-value pairs need regex extraction</p>

                    <h4>Example: Delimited Format</h4>
                    <div class="example-log">
2024-02-15T14:30:00|INFO|jsmith|login|10.0.1.50|success
2024-02-15T14:30:05|WARN|jsmith|access_denied|10.0.1.50|/admin/config
                    </div>
                    <p style="color: #d29922;">△ Pipe-delimited needs split() or positional regex</p>

                    <h4>Example: Unstructured/Free-form</h4>
                    <div class="example-log">
2024-02-15 14:30:00 INFO User jsmith logged in successfully from 10.0.1.50
2024-02-15 14:30:05 WARN User jsmith attempted to access /admin/config but was denied
                    </div>
                    <p style="color: #f85149;">✗ Unstructured logs need complex regex - consider asking dev team to improve logging</p>
                </div>

                <!-- PHASE 2: CHOOSE INGESTION METHOD -->
                <div class="phase-header" id="phase2">
                    <span class="phase-num">PHASE 2</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Choose Ingestion Method</span>
                </div>

                <div class="decision-box">
                    <h3><i class="fas fa-question-circle" style="color: #d29922;"></i> Decision Tree: Which Ingestion Method?</h3>
                    
                    <div style="margin: 16px 0; padding: 16px; background: #0d1117; border-radius: 8px;">
                        <p><strong>Q1: Can the source send syslog (TCP/UDP port 514)?</strong></p>
                        <p style="margin-left: 20px;">→ YES: <strong>Use Broker VM Syslog</strong> (most common)</p>
                        <p style="margin-left: 20px;">→ NO: Continue to Q2</p>
                        
                        <p style="margin-top: 16px;"><strong>Q2: Can the source send HTTP/HTTPS POST requests?</strong></p>
                        <p style="margin-left: 20px;">→ YES: <strong>Use HTTP Collector</strong></p>
                        <p style="margin-left: 20px;">→ NO: Continue to Q3</p>
                        
                        <p style="margin-top: 16px;"><strong>Q3: Does XSIAM have a native Cloud Collector for this source?</strong></p>
                        <p style="margin-left: 20px;">→ YES: <strong>Use Cloud Collector</strong> (check Settings → Data Sources → Cloud Collectors)</p>
                        <p style="margin-left: 20px;">→ NO: Continue to Q4</p>
                        
                        <p style="margin-top: 16px;"><strong>Q4: Can you write a script to pull logs from the source API?</strong></p>
                        <p style="margin-left: 20px;">→ YES: <strong>Use Custom Integration + HTTP Collector</strong></p>
                        <p style="margin-left: 20px;">→ NO: <strong>Contact Palo Alto PS or request feature</strong></p>
                    </div>
                </div>

                <h3>Ingestion Methods Comparison</h3>
                <table class="field-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Best For</th>
                            <th>Requirements</th>
                            <th>Console Location</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Broker VM Syslog</strong></td>
                            <td>On-prem devices, servers, network equipment</td>
                            <td>Broker VM deployed, network access</td>
                            <td>Settings → Data Sources → Broker VM</td>
                        </tr>
                        <tr>
                            <td><strong>HTTP Collector</strong></td>
                            <td>Cloud apps, APIs, custom scripts</td>
                            <td>Source can send HTTP POST</td>
                            <td>Settings → Data Sources → HTTP Collector</td>
                        </tr>
                        <tr>
                            <td><strong>Cloud Collector</strong></td>
                            <td>AWS, Azure, GCP, SaaS apps</td>
                            <td>Native integration exists</td>
                            <td>Settings → Data Sources → Cloud Collectors</td>
                        </tr>
                        <tr>
                            <td><strong>XDR Agent</strong></td>
                            <td>Endpoint telemetry only</td>
                            <td>Agent installed on endpoint</td>
                            <td>Settings → Endpoints → Agents</td>
                        </tr>
                    </tbody>
                </table>

                <!-- PHASE 3: CONFIGURE DATA SOURCE -->
                <div class="phase-header" id="phase3">
                    <span class="phase-num">PHASE 3</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Configure Data Source in XSIAM</span>
                </div>

                <h3>3A. Syslog via Broker VM (Most Common)</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → Add Data Source</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div style="width: 100%;">
                            <strong>Navigate to Data Sources</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Click gear icon (Settings) → Data Sources → Click "+ Add Data Source"</p>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div style="width: 100%;">
                            <strong>Select "Syslog Collector"</strong>
                            <p style="color: #8b949e; margin: 4px 0;">From the list of data source types, select "Syslog Collector"</p>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div style="width: 100%;">
                            <strong>Configure Collector Settings</strong>
                            <table class="field-table" style="margin-top: 12px;">
                                <tr>
                                    <td style="width: 200px;"><strong>Name</strong></td>
                                    <td>myapp-auth-logs</td>
                                    <td style="color: #8b949e;">Descriptive name for this data source</td>
                                </tr>
                                <tr>
                                    <td><strong>Broker VM</strong></td>
                                    <td>broker-vm-datacenter-1</td>
                                    <td style="color: #8b949e;">Select your deployed Broker VM</td>
                                </tr>
                                <tr>
                                    <td><strong>Protocol</strong></td>
                                    <td>TCP</td>
                                    <td style="color: #8b949e;">TCP recommended (reliable), UDP for high volume</td>
                                </tr>
                                <tr>
                                    <td><strong>Port</strong></td>
                                    <td>514</td>
                                    <td style="color: #8b949e;">Standard syslog port, or custom (1514, 5514)</td>
                                </tr>
                                <tr>
                                    <td><strong>Vendor</strong></td>
                                    <td>Custom</td>
                                    <td style="color: #8b949e;">Select "Custom" for unsupported sources</td>
                                </tr>
                                <tr>
                                    <td><strong>Product</strong></td>
                                    <td>MyApp</td>
                                    <td style="color: #8b949e;">Your application name</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div style="width: 100%;">
                            <strong>Click "Save"</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Configuration pushes to Broker VM within 1-2 minutes</p>
                        </div>
                    </div>

                    <div class="warning-box">
                        <h4><i class="fas fa-exclamation-triangle" style="color: #d29922;"></i> Important: Dataset Name</h4>
                        <p>When you select Vendor="Custom" and Product="MyApp", XSIAM creates a dataset named:</p>
                        <p style="font-family: monospace; background: #0d1117; padding: 8px; border-radius: 4px; margin-top: 8px;">custom_myapp_raw</p>
                        <p style="margin-top: 8px;">This is the dataset you'll query in XQL. Format: <code>{vendor}_{product}_raw</code></p>
                    </div>
                </div>

                <h3>3B. Configure Source Device to Send Logs</h3>
                <div class="config-section">
                    <p>Now configure your application to send logs to the Broker VM:</p>

                    <h4>Linux Application (rsyslog)</h4>
                    <div class="arch-diagram">
# Edit rsyslog configuration
sudo nano /etc/rsyslog.d/50-myapp.conf

# Add forwarding rule (TCP to Broker VM)
if $programname == 'myapp' then @@10.0.1.50:514

# Or forward specific log file
module(load="imfile")
input(type="imfile"
      File="/var/log/myapp/application.log"
      Tag="myapp"
      Severity="info"
      Facility="local0")

local0.* @@10.0.1.50:514

# Restart rsyslog
sudo systemctl restart rsyslog
                    </div>

                    <h4>Linux Application (syslog-ng)</h4>
                    <div class="arch-diagram">
# Edit syslog-ng configuration
sudo nano /etc/syslog-ng/conf.d/myapp.conf

# Add destination
destination d_xsiam {
    tcp("10.0.1.50" port(514));
};

# Add log path
log {
    source(s_local);
    filter(f_myapp);
    destination(d_xsiam);
};

filter f_myapp {
    program("myapp");
};

# Restart syslog-ng
sudo systemctl restart syslog-ng
                    </div>

                    <h4>Windows Application (NXLog)</h4>
                    <div class="arch-diagram">
# NXLog configuration (C:\Program Files\nxlog\conf\nxlog.conf)

<Input myapp_logs>
    Module      im_file
    File        "C:\\MyApp\\logs\\*.log"
    SavePos     TRUE
</Input>

<Output xsiam_syslog>
    Module      om_tcp
    Host        10.0.1.50
    Port        514
</Output>

<Route myapp_to_xsiam>
    Path        myapp_logs => xsiam_syslog
</Route>
                    </div>

                    <h4>Application with Native Syslog Support</h4>
                    <div class="arch-diagram">
# Many applications have syslog configuration in their config file
# Example: application.yml

logging:
  syslog:
    enabled: true
    host: 10.0.1.50
    port: 514
    protocol: tcp
    facility: local0
                    </div>
                </div>

                <h3>3C. HTTP Collector (Alternative Method)</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → HTTP Collector</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div style="width: 100%;">
                            <strong>Create HTTP Collector</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Settings → Data Sources → HTTP Collector → + Add</p>
                            <table class="field-table" style="margin-top: 12px;">
                                <tr>
                                    <td style="width: 150px;"><strong>Name</strong></td>
                                    <td>myapp-http-collector</td>
                                </tr>
                                <tr>
                                    <td><strong>Vendor</strong></td>
                                    <td>Custom</td>
                                </tr>
                                <tr>
                                    <td><strong>Product</strong></td>
                                    <td>MyApp</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div style="width: 100%;">
                            <strong>Get Collector URL and Token</strong>
                            <p style="color: #8b949e; margin: 4px 0;">After saving, you'll receive:</p>
                            <div class="arch-diagram">
Collector URL: https://api-{tenant}.xsiam.paloaltonetworks.com/logs/v1/event
Authorization Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                            </div>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div style="width: 100%;">
                            <strong>Send Logs via HTTP POST</strong>
                            <div class="arch-diagram">
# Example: Send logs using curl
curl -X POST "https://api-{tenant}.xsiam.paloaltonetworks.com/logs/v1/event" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
  -H "Content-Type: application/json" \
  -d '[
    {"timestamp":"2024-02-15T14:30:00Z","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success"},
    {"timestamp":"2024-02-15T14:30:05Z","user":"jsmith","action":"logout","src_ip":"10.0.1.50"}
  ]'
                            </div>
                        </div>
                    </div>

                    <h4>Python Script Example</h4>
                    <div class="arch-diagram">
import requests
import json
from datetime import datetime

XSIAM_URL = "https://api-{tenant}.xsiam.paloaltonetworks.com/logs/v1/event"
XSIAM_TOKEN = "your-token-here"

def send_logs_to_xsiam(logs):
    headers = {
        "Authorization": f"Bearer {XSIAM_TOKEN}",
        "Content-Type": "application/json"
    }
    response = requests.post(XSIAM_URL, headers=headers, json=logs)
    return response.status_code == 200

# Example usage
logs = [
    {
        "timestamp": datetime.utcnow().isoformat() + "Z",
        "user": "jsmith",
        "action": "login",
        "src_ip": "10.0.1.50",
        "result": "success"
    }
]

if send_logs_to_xsiam(logs):
    print("Logs sent successfully")
else:
    print("Failed to send logs")
                    </div>
                </div>

                <!-- PHASE 4: CREATE CUSTOM PARSING RULES -->
                <div class="phase-header" id="phase4">
                    <span class="phase-num">PHASE 4</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Create Custom Parsing Rules</span>
                </div>

                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-info-circle"></i> What is Parsing?</h4>
                    <p><strong>Parsing</strong> extracts structured fields from raw log text. Without parsing, you only have a blob of text. With parsing, you have searchable fields like <code>user</code>, <code>src_ip</code>, <code>action</code>.</p>
                </div>

                <h3>4.1 Check If Parsing is Needed</h3>
                <div class="config-section">
                    <p>First, check if XSIAM is already parsing your logs:</p>
                    <div class="console-path">Investigation → XQL Search</div>
                    
                    <div class="arch-diagram">
// Query raw data to see what's being parsed
dataset = custom_myapp_raw
| limit 10
| fields _raw_log, *
                    </div>
                    
                    <p style="margin-top: 12px;"><strong>If you see:</strong></p>
                    <ul style="color: #8b949e;">
                        <li>Only <code>_raw_log</code> field populated → Custom parsing needed</li>
                        <li>Fields like <code>user</code>, <code>action</code>, etc. → Parsing exists (may still need XDM mapping)</li>
                    </ul>
                </div>

                <h3>4.2 Create Parsing Rule</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → Parsing Rules → + New Rule</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div style="width: 100%;">
                            <strong>Navigate to Parsing Rules</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Settings → Data Sources → Parsing Rules</p>
                            <p style="color: #8b949e; margin: 4px 0;">Click "+ New Rule"</p>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div style="width: 100%;">
                            <strong>Configure Rule Metadata</strong>
                            <table class="field-table" style="margin-top: 12px;">
                                <tr>
                                    <td style="width: 150px;"><strong>Rule Name</strong></td>
                                    <td>MyApp Authentication Parser</td>
                                </tr>
                                <tr>
                                    <td><strong>Vendor</strong></td>
                                    <td>Custom (must match data source)</td>
                                </tr>
                                <tr>
                                    <td><strong>Product</strong></td>
                                    <td>MyApp (must match data source)</td>
                                </tr>
                                <tr>
                                    <td><strong>Log Format</strong></td>
                                    <td>JSON / Syslog / Custom</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div style="width: 100%;">
                            <strong>Enter Parsing Logic</strong>
                            <p style="color: #8b949e; margin: 4px 0;">The parsing logic depends on your log format:</p>
                        </div>
                    </div>
                </div>

                <h3>4.3 Parsing Logic Examples</h3>

                <h4>Example A: JSON Logs</h4>
                <div class="config-section">
                    <p><strong>Sample Log:</strong></p>
                    <div class="example-log">{"timestamp":"2024-02-15T14:30:00Z","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success"}</div>
                    
                    <p><strong>Parsing Rule (XQL-style):</strong></p>
                    <div class="arch-diagram">
[RULE: MyApp JSON Parser]
// JSON logs are parsed automatically, just map fields
alter
    event_timestamp = json_extract(_raw_log, "$.timestamp"),
    username = json_extract(_raw_log, "$.user"),
    event_action = json_extract(_raw_log, "$.action"),
    source_ip = json_extract(_raw_log, "$.src_ip"),
    event_result = json_extract(_raw_log, "$.result")
                    </div>
                </div>

                <h4>Example B: Key-Value Syslog</h4>
                <div class="config-section">
                    <p><strong>Sample Log:</strong></p>
                    <div class="example-log">Feb 15 14:30:00 app-server-01 myapp[1234]: USER=jsmith ACTION=login SRC=10.0.1.50 RESULT=success</div>
                    
                    <p><strong>Parsing Rule (Regex):</strong></p>
                    <div class="arch-diagram">
[RULE: MyApp KV Parser]
// Extract key-value pairs using regex
alter
    username = regextract(_raw_log, "USER=(\S+)"),
    event_action = regextract(_raw_log, "ACTION=(\S+)"),
    source_ip = regextract(_raw_log, "SRC=(\S+)"),
    event_result = regextract(_raw_log, "RESULT=(\S+)"),
    source_host = regextract(_raw_log, "^\w+\s+\d+\s+[\d:]+\s+(\S+)")
                    </div>
                </div>

                <h4>Example C: Pipe-Delimited</h4>
                <div class="config-section">
                    <p><strong>Sample Log:</strong></p>
                    <div class="example-log">2024-02-15T14:30:00|INFO|jsmith|login|10.0.1.50|success</div>
                    
                    <p><strong>Parsing Rule (Split):</strong></p>
                    <div class="arch-diagram">
[RULE: MyApp Delimited Parser]
// Split by pipe delimiter
alter _fields = split(_raw_log, "|")
| alter
    event_timestamp = arrayindex(_fields, 0),
    log_level = arrayindex(_fields, 1),
    username = arrayindex(_fields, 2),
    event_action = arrayindex(_fields, 3),
    source_ip = arrayindex(_fields, 4),
    event_result = arrayindex(_fields, 5)
                    </div>
                </div>

                <h4>Example D: Complex/Mixed Format</h4>
                <div class="config-section">
                    <p><strong>Sample Log:</strong></p>
                    <div class="example-log">2024-02-15 14:30:00 INFO [AuthService] User 'jsmith' logged in from 10.0.1.50 - Session: abc123</div>
                    
                    <p><strong>Parsing Rule (Multiple Regex):</strong></p>
                    <div class="arch-diagram">
[RULE: MyApp Complex Parser]
// Extract fields using multiple regex patterns
alter
    event_timestamp = regextract(_raw_log, "^(\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2})"),
    log_level = regextract(_raw_log, "^\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2}\s+(\w+)"),
    service_name = regextract(_raw_log, "\[(\w+)\]"),
    username = regextract(_raw_log, "User\s+'(\w+)'"),
    source_ip = regextract(_raw_log, "from\s+(\d+\.\d+\.\d+\.\d+)"),
    session_id = regextract(_raw_log, "Session:\s+(\S+)")
                    </div>
                </div>

                <div class="config-step">
                    <div class="step-num">4</div>
                    <div style="width: 100%;">
                        <strong>Test Parsing Rule</strong>
                        <p style="color: #8b949e; margin: 4px 0;">Click "Test" → Paste sample logs → Verify fields are extracted correctly</p>
                    </div>
                </div>

                <div class="config-step">
                    <div class="step-num">5</div>
                    <div style="width: 100%;">
                        <strong>Save and Apply</strong>
                        <p style="color: #8b949e; margin: 4px 0;">Click "Save" → Rule applies to new incoming logs</p>
                        <p style="color: #d29922; margin: 4px 0;">Note: Existing logs are NOT re-parsed. Only new logs get the parsing.</p>
                    </div>
                </div>

                <!-- PHASE 5: XDM FIELD MAPPING -->
                <div class="phase-header" id="phase5">
                    <span class="phase-num">PHASE 5</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">XDM Field Mapping</span>
                </div>

                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-info-circle"></i> Why XDM Mapping?</h4>
                    <p><strong>XDM (XSIAM Data Model)</strong> is the normalized schema. Mapping your custom fields to XDM allows:</p>
                    <ul style="color: #8b949e; margin-top: 8px;">
                        <li>Cross-source correlation (correlate MyApp with firewall, Windows, etc.)</li>
                        <li>Use built-in detection rules designed for XDM fields</li>
                        <li>Consistent field names across all data sources</li>
                    </ul>
                </div>

                <h3>5.1 Add XDM Mapping to Parsing Rule</h3>
                <div class="config-section">
                    <p>Extend your parsing rule to include XDM mappings:</p>
                    
                    <div class="arch-diagram">
[RULE: MyApp Parser with XDM Mapping]

// Step 1: Extract raw fields
alter
    username = json_extract(_raw_log, "$.user"),
    event_action = json_extract(_raw_log, "$.action"),
    source_ip = json_extract(_raw_log, "$.src_ip"),
    event_result = json_extract(_raw_log, "$.result"),
    event_timestamp = json_extract(_raw_log, "$.timestamp")

// Step 2: Map to XDM normalized fields
| alter
    xdm.source.user.username = username,
    xdm.source.ipv4 = source_ip,
    xdm.event.operation = event_action,
    xdm.event.outcome = if(event_result = "success", "SUCCESS", "FAILURE"),
    xdm.event.type = "AUTH"
                    </div>
                </div>

                <h3>5.2 Common XDM Field Mappings</h3>
                <table class="field-table">
                    <thead>
                        <tr>
                            <th>Your Field</th>
                            <th>XDM Field</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>user, username, usr</td>
                            <td><code>xdm.source.user.username</code></td>
                            <td>User performing action</td>
                        </tr>
                        <tr>
                            <td>src_ip, source_ip, client_ip</td>
                            <td><code>xdm.source.ipv4</code></td>
                            <td>Source IP address</td>
                        </tr>
                        <tr>
                            <td>dst_ip, dest_ip, target_ip</td>
                            <td><code>xdm.target.ipv4</code></td>
                            <td>Destination IP address</td>
                        </tr>
                        <tr>
                            <td>action, operation, event_type</td>
                            <td><code>xdm.event.operation</code></td>
                            <td>What happened</td>
                        </tr>
                        <tr>
                            <td>result, status, outcome</td>
                            <td><code>xdm.event.outcome</code></td>
                            <td>SUCCESS or FAILURE</td>
                        </tr>
                        <tr>
                            <td>hostname, host, server</td>
                            <td><code>xdm.source.host.hostname</code></td>
                            <td>Source hostname</td>
                        </tr>
                        <tr>
                            <td>url, request_url</td>
                            <td><code>xdm.target.url</code></td>
                            <td>Target URL</td>
                        </tr>
                        <tr>
                            <td>file_path, path</td>
                            <td><code>xdm.target.file.path</code></td>
                            <td>File path accessed</td>
                        </tr>
                        <tr>
                            <td>hash, sha256, md5</td>
                            <td><code>xdm.target.file.sha256</code></td>
                            <td>File hash</td>
                        </tr>
                    </tbody>
                </table>

                <!-- PHASE 6: VERIFY DATA -->
                <div class="phase-header" id="phase6">
                    <span class="phase-num">PHASE 6</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Verify Data Ingestion</span>
                </div>

                <h3>6.1 Check Data is Arriving</h3>
                <div class="config-section">
                    <div class="console-path">Investigation → XQL Search</div>
                    
                    <h4>Query 1: Basic Data Check</h4>
                    <div class="arch-diagram">
// Check if data exists in your dataset
dataset = custom_myapp_raw
| filter _time > ago(1h)
| limit 10
                    </div>

                    <h4>Query 2: Check Event Count Over Time</h4>
                    <div class="arch-diagram">
// See volume trend
dataset = custom_myapp_raw
| filter _time > ago(24h)
| comp count = count() by bin(_time, 1h)
| sort asc _time
                    </div>

                    <h4>Query 3: Verify Parsing is Working</h4>
                    <div class="arch-diagram">
// Check that fields are being extracted
dataset = custom_myapp_raw
| filter _time > ago(1h)
| fields _time, username, event_action, source_ip, event_result, xdm.source.user.username
| limit 20
                    </div>
                    
                    <div class="success-box">
                        <h4><i class="fas fa-check-circle" style="color: #3fb950;"></i> Success Indicators</h4>
                        <ul style="color: #8b949e;">
                            <li>Query returns results (data is arriving)</li>
                            <li>Custom fields populated (parsing working)</li>
                            <li>XDM fields populated (normalization working)</li>
                        </ul>
                    </div>
                </div>

                <h3>6.2 Check Data Source Status</h3>
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → [Your Data Source]</div>
                    
                    <p>View data source status to confirm:</p>
                    <ul style="color: #8b949e;">
                        <li><strong>Status:</strong> Active</li>
                        <li><strong>Last Event:</strong> Recent timestamp (within last few minutes)</li>
                        <li><strong>Events/Hour:</strong> Non-zero, matches expected volume</li>
                    </ul>
                </div>

                <!-- PHASE 7: CREATE DETECTION RULES -->
                <div class="phase-header" id="phase7">
                    <span class="phase-num">PHASE 7</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Create Detection Rules</span>
                </div>

                <h3>7.1 Example Detection Rules for Custom Source</h3>
                <div class="config-section">
                    <div class="console-path">Rules → Correlation Rules → + New Rule</div>

                    <h4>Rule 1: Brute Force on MyApp</h4>
                    <div class="arch-diagram">
// Detect 10+ failed logins in 5 minutes
dataset = custom_myapp_raw
| filter _time > ago(5m)
| filter event_action = "login" and event_result = "failure"
| comp failed_attempts = count() by username, source_ip
| filter failed_attempts >= 10
                    </div>
                    <p style="color: #8b949e;">Settings: Frequency=1min, Severity=High, MITRE=T1110</p>

                    <h4>Rule 2: Login from New IP (Using XDM for Cross-Source)</h4>
                    <div class="arch-diagram">
// Detect login from IP not seen in last 30 days
dataset = custom_myapp_raw
| filter _time > ago(1h)
| filter event_action = "login" and event_result = "success"
| join type=leftantijoin (
    dataset = custom_myapp_raw
    | filter _time > ago(30d) and _time < ago(1h)
    | filter event_action = "login" and event_result = "success"
    | dedup username, source_ip
  ) as historical
  on username = historical.username and source_ip = historical.source_ip
| fields _time, username, source_ip
                    </div>

                    <h4>Rule 3: Privileged Action Detection</h4>
                    <div class="arch-diagram">
// Detect admin-level actions
dataset = custom_myapp_raw
| filter _time > ago(5m)
| filter event_action in ("delete_user", "modify_permissions", "export_data", "config_change")
| fields _time, username, event_action, source_ip
                    </div>
                </div>

                <!-- PHASE 8: TROUBLESHOOTING -->
                <div class="phase-header" id="phase8">
                    <span class="phase-num">PHASE 8</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Troubleshooting</span>
                </div>

                <h3>Common Issues and Solutions</h3>

                <div class="troubleshoot-item">
                    <h4><i class="fas fa-times-circle" style="color: #f85149;"></i> Issue: No Data in XQL Query</h4>
                    <p style="color: #8b949e; margin: 8px 0;"><strong>Symptoms:</strong> Query returns 0 results</p>
                    <p><strong>Diagnostic Steps:</strong></p>
                    <ol style="color: #8b949e; font-size: 0.9rem;">
                        <li>Check Broker VM is receiving data: <code>broker-vm> show listeners</code></li>
                        <li>Verify source is sending: <code>tcpdump -i eth0 port 514 | head</code></li>
                        <li>Check Data Source status in console</li>
                        <li>Verify dataset name matches: <code>dataset = custom_myapp_raw</code></li>
                        <li>Check time filter isn't too narrow</li>
                    </ol>
                    <p><strong>Solution:</strong> Usually network/firewall issue between source and Broker VM, or wrong dataset name.</p>
                </div>

                <div class="troubleshoot-item">
                    <h4><i class="fas fa-times-circle" style="color: #f85149;"></i> Issue: Data Arrives But Fields Not Parsed</h4>
                    <p style="color: #8b949e; margin: 8px 0;"><strong>Symptoms:</strong> Only <code>_raw_log</code> field populated</p>
                    <p><strong>Diagnostic Steps:</strong></p>
                    <ol style="color: #8b949e; font-size: 0.9rem;">
                        <li>Check parsing rule exists and is enabled</li>
                        <li>Verify Vendor/Product matches between data source and parsing rule</li>
                        <li>Test parsing rule with sample logs</li>
                        <li>Check for regex errors in parsing rule</li>
                    </ol>
                    <p><strong>Solution:</strong> Parsing rule not applied or regex/extraction logic incorrect.</p>
                </div>

                <div class="troubleshoot-item">
                    <h4><i class="fas fa-times-circle" style="color: #f85149;"></i> Issue: Some Fields Missing/Empty</h4>
                    <p style="color: #8b949e; margin: 8px 0;"><strong>Symptoms:</strong> Some fields parse, others are null</p>
                    <p><strong>Diagnostic Steps:</strong></p>
                    <ol style="color: #8b949e; font-size: 0.9rem;">
                        <li>Check raw log format matches expected pattern</li>
                        <li>Test regex against actual logs (not just samples)</li>
                        <li>Look for edge cases (different log formats from same source)</li>
                    </ol>
                    <p><strong>Solution:</strong> Log format varies; update parsing rule to handle all variations.</p>
                </div>

                <div class="troubleshoot-item">
                    <h4><i class="fas fa-times-circle" style="color: #f85149;"></i> Issue: High Latency (Logs Delayed)</h4>
                    <p style="color: #8b949e; margin: 8px 0;"><strong>Symptoms:</strong> Logs appear in XSIAM minutes/hours after generation</p>
                    <p><strong>Diagnostic Steps:</strong></p>
                    <ol style="color: #8b949e; font-size: 0.9rem;">
                        <li>Check Broker VM queue: <code>broker-vm> show upload-queue</code></li>
                        <li>Check Broker VM bandwidth to cloud</li>
                        <li>Verify source is sending in real-time (not batched)</li>
                    </ol>
                    <p><strong>Solution:</strong> Broker VM upload backlog (bandwidth issue) or source batching logs.</p>
                </div>

                <!-- COMPLETE EXAMPLES -->
                <div class="phase-header" id="examples">
                    <span class="phase-num">EXAMPLES</span>
                    <span style="font-size: 1.2rem; font-weight: 600;">Complete End-to-End Examples</span>
                </div>

                <h3>Example A: Custom Java Application</h3>
                <div class="config-section">
                    <h4>Scenario</h4>
                    <p style="color: #8b949e;">Java microservice generating JSON logs with authentication events. Running on Linux server 10.0.1.100.</p>

                    <h4>Step 1: Sample Logs</h4>
                    <div class="example-log">{"@timestamp":"2024-02-15T14:30:00.123Z","level":"INFO","logger":"AuthService","message":"User login","user_id":"jsmith","client_ip":"10.0.1.50","auth_result":"SUCCESS","session_id":"sess-abc123"}
{"@timestamp":"2024-02-15T14:30:05.456Z","level":"WARN","logger":"AuthService","message":"Failed login attempt","user_id":"admin","client_ip":"192.168.1.100","auth_result":"FAILURE","failure_reason":"invalid_password"}</div>

                    <h4>Step 2: Data Source Configuration</h4>
                    <table class="field-table">
                        <tr><td>Name</td><td>java-auth-service-logs</td></tr>
                        <tr><td>Broker VM</td><td>broker-vm-dc1</td></tr>
                        <tr><td>Protocol</td><td>TCP</td></tr>
                        <tr><td>Port</td><td>1514</td></tr>
                        <tr><td>Vendor</td><td>Custom</td></tr>
                        <tr><td>Product</td><td>JavaAuthService</td></tr>
                    </table>
                    <p style="color: #8b949e; margin-top: 8px;">Dataset created: <code>custom_javaauthservice_raw</code></p>

                    <h4>Step 3: Source Configuration (rsyslog)</h4>
                    <div class="arch-diagram">
# /etc/rsyslog.d/60-java-app.conf
module(load="imfile")
input(type="imfile"
      File="/var/log/myapp/auth.log"
      Tag="javaauth"
      Facility="local1")

local1.* @@10.0.1.50:1514
                    </div>

                    <h4>Step 4: Parsing Rule</h4>
                    <div class="arch-diagram">
[RULE: Java Auth Service Parser]
// Extract JSON fields
alter
    event_time = json_extract(_raw_log, "$.@timestamp"),
    log_level = json_extract(_raw_log, "$.level"),
    logger = json_extract(_raw_log, "$.logger"),
    message = json_extract(_raw_log, "$.message"),
    user_id = json_extract(_raw_log, "$.user_id"),
    client_ip = json_extract(_raw_log, "$.client_ip"),
    auth_result = json_extract(_raw_log, "$.auth_result"),
    session_id = json_extract(_raw_log, "$.session_id"),
    failure_reason = json_extract(_raw_log, "$.failure_reason")

// Map to XDM
| alter
    xdm.source.user.username = user_id,
    xdm.source.ipv4 = client_ip,
    xdm.event.type = "AUTH",
    xdm.event.outcome = if(auth_result = "SUCCESS", "SUCCESS", "FAILURE"),
    xdm.event.description = message,
    xdm.session.id = session_id
                    </div>

                    <h4>Step 5: Verification Query</h4>
                    <div class="arch-diagram">
dataset = custom_javaauthservice_raw
| filter _time > ago(1h)
| fields _time, user_id, client_ip, auth_result, xdm.source.user.username, xdm.event.outcome
| limit 20
                    </div>

                    <h4>Step 6: Detection Rule</h4>
                    <div class="arch-diagram">
// Java Auth Service - Brute Force Detection
dataset = custom_javaauthservice_raw
| filter _time > ago(5m)
| filter auth_result = "FAILURE"
| comp failed = count() by user_id, client_ip
| filter failed >= 5
                    </div>
                </div>

                <h3>Example B: Custom Network Appliance via HTTP</h3>
                <div class="config-section">
                    <h4>Scenario</h4>
                    <p style="color: #8b949e;">Network appliance that can only send logs via HTTP webhook (no syslog support).</p>

                    <h4>Step 1: Create HTTP Collector</h4>
                    <div class="console-path">Settings → Data Sources → HTTP Collector → + Add</div>
                    <table class="field-table">
                        <tr><td>Name</td><td>network-appliance-http</td></tr>
                        <tr><td>Vendor</td><td>Custom</td></tr>
                        <tr><td>Product</td><td>NetworkAppliance</td></tr>
                    </table>
                    <p style="color: #8b949e; margin-top: 8px;">Copy the generated URL and token.</p>

                    <h4>Step 2: Configure Appliance Webhook</h4>
                    <p style="color: #8b949e;">In appliance admin console:</p>
                    <table class="field-table">
                        <tr><td>Webhook URL</td><td>https://api-{tenant}.xsiam.paloaltonetworks.com/logs/v1/event</td></tr>
                        <tr><td>Authorization Header</td><td>Bearer eyJhbGciOiJIUzI1NiIs...</td></tr>
                        <tr><td>Content-Type</td><td>application/json</td></tr>
                    </table>

                    <h4>Step 3: Sample Logs (what appliance sends)</h4>
                    <div class="example-log">[{"event_type":"connection","timestamp":"2024-02-15T14:30:00Z","src":"10.0.1.50","dst":"8.8.8.8","port":443,"action":"allow","bytes":1024}]</div>

                    <h4>Step 4: Parsing Rule</h4>
                    <div class="arch-diagram">
[RULE: Network Appliance Parser]
alter
    event_type = json_extract(_raw_log, "$.event_type"),
    src_ip = json_extract(_raw_log, "$.src"),
    dst_ip = json_extract(_raw_log, "$.dst"),
    dst_port = json_extract(_raw_log, "$.port"),
    action = json_extract(_raw_log, "$.action"),
    bytes = json_extract(_raw_log, "$.bytes")

| alter
    xdm.source.ipv4 = src_ip,
    xdm.target.ipv4 = dst_ip,
    xdm.target.port = to_integer(dst_port),
    xdm.event.outcome = if(action = "allow", "SUCCESS", "FAILURE"),
    xdm.event.type = "NETWORK",
    xdm.network.session.bytes_sent = to_integer(bytes)
                    </div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through onboarding a custom log source into XSIAM.</button>
                        <div class="qa-answer">
                            <p><strong>Complete process:</strong></p>
                            <ol>
                                <li><strong>Planning:</strong> Gather sample logs, understand format, identify security-relevant fields</li>
                                <li><strong>Choose ingestion method:</strong> Syslog (Broker VM) for on-prem, HTTP Collector for cloud/API sources</li>
                                <li><strong>Create data source:</strong> Settings → Data Sources → Add → Configure Vendor/Product</li>
                                <li><strong>Configure source:</strong> Point application to Broker VM (syslog) or configure webhook (HTTP)</li>
                                <li><strong>Create parsing rule:</strong> Settings → Parsing Rules → Build extraction logic (JSON, regex, etc.)</li>
                                <li><strong>Add XDM mapping:</strong> Map custom fields to xdm.* for cross-source correlation</li>
                                <li><strong>Verify:</strong> Run XQL queries to confirm data and parsing</li>
                                <li><strong>Create detections:</strong> Build correlation rules on the new dataset</li>
                            </ol>
                            <p><strong>Key tip:</strong> Dataset name follows pattern <code>{vendor}_{product}_raw</code> - this is what you query in XQL.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: You're seeing logs in XSIAM but fields aren't being parsed. How do you troubleshoot?</button>
                        <div class="qa-answer">
                            <p><strong>Systematic troubleshooting:</strong></p>
                            <ol>
                                <li><strong>Verify parsing rule exists:</strong> Settings → Parsing Rules → Search for your vendor/product</li>
                                <li><strong>Check vendor/product match:</strong> Data source and parsing rule must have identical Vendor and Product values</li>
                                <li><strong>Test parsing rule:</strong> Edit rule → Test → Paste actual raw log → Check output</li>
                                <li><strong>Check raw log format:</strong>
                                    <div class="arch-diagram" style="margin: 8px 0;">dataset = custom_myapp_raw | fields _raw_log | limit 5</div>
                                    Compare actual format to what parsing rule expects
                                </li>
                                <li><strong>Check for variations:</strong> Some events may have different formats - parsing rule needs to handle all</li>
                                <li><strong>Verify rule is enabled:</strong> Disabled rules don't process logs</li>
                            </ol>
                            <p><strong>Remember:</strong> Parsing only applies to NEW logs after rule creation. Existing logs aren't re-parsed.</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>