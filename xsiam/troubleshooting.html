<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troubleshooting Guide | XSIAM Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">

    <style>
        /* Decision Tree Styles */
        .decision-tree {
            padding: 25px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            margin: 20px 0;
        }
        .decision-node {
            background: #21262d;
            border: 2px solid #30363d;
            border-radius: 10px;
            padding: 15px 20px;
            margin: 10px auto;
            max-width: 450px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .decision-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        .decision-node h4 {
            color: #e6edf3;
            margin: 0 0 5px 0;
            font-size: 14px;
            font-weight: 600;
        }
        .decision-node p, .decision-node small {
            color: #8b949e;
            font-size: 12px;
            margin: 0;
        }
        .decision-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 20px;
            margin: 8px 0;
        }
        .decision-branches {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        .decision-branch {
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 15px;
            min-width: 180px;
            max-width: 280px;
            background: rgba(33, 38, 45, 0.5);
        }
        .decision-branch.yes { border-color: #238636; }
        .decision-branch.no { border-color: #f85149; }
        .branch-label {
            display: block;
            text-align: center;
            font-weight: 600;
            margin-bottom: 10px;
            color: #8b949e;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .decision-outcome {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            color: white;
        }
        .decision-outcome i {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }
        .decision-outcome strong {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }
        .decision-outcome small {
            opacity: 0.9;
            font-size: 11px;
        }

        /* Flow Diagram Styles */
        .flow-diagram {
            padding: 25px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            margin: 20px 0;
        }
        .flow-step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            background: #21262d;
            border-radius: 10px;
            padding: 18px;
            margin: 12px 0;
            border-left: 4px solid #58a6ff;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .flow-step:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        .flow-icon {
            width: 45px;
            height: 45px;
            background: rgba(88, 166, 255, 0.15);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #58a6ff;
            flex-shrink: 0;
            font-size: 18px;
        }
        .flow-content h4 {
            margin: 0 0 10px 0;
            color: #e6edf3;
            font-size: 15px;
            font-weight: 600;
        }
        .flow-content ul {
            margin: 0;
            padding-left: 20px;
            color: #8b949e;
        }
        .flow-content li {
            margin: 6px 0;
            font-size: 13px;
            line-height: 1.5;
        }
        .flow-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 20px;
            margin: 8px 0;
        }

        /* Pipeline Styles */
        .pipeline-container {
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            padding: 25px;
            margin: 20px 0;
        }
        .pipeline-stage {
            margin-bottom: 20px;
        }
        .pipeline-stage .stage-bar {
            height: 8px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .pipeline-stage h4 {
            color: #e6edf3;
            font-size: 14px;
            margin: 0 0 5px 0;
        }
        .pipeline-stage p {
            color: #8b949e;
            font-size: 13px;
            margin: 0 0 5px 0;
        }
        .pipeline-stage small {
            color: #6e7681;
            font-size: 12px;
        }
        .pipeline-arrow {
            text-align: left;
            color: #8b949e;
            margin: 10px 0;
            font-size: 16px;
        }

        /* Strategy Grid Styles */
        .strategy-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 15px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            padding: 25px;
            margin: 20px 0;
        }
        .endpoint-type {
            background: #21262d;
            border-radius: 8px;
            padding: 15px;
            min-width: 150px;
            display: flex;
            align-items: center;
            font-weight: 600;
            color: #e6edf3;
            font-size: 13px;
        }
        .collection-profile {
            background: #21262d;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #58a6ff;
        }
        .collection-profile h4 {
            color: #e6edf3;
            margin: 0 0 5px 0;
            font-size: 14px;
        }
        .collection-profile p {
            color: #8b949e;
            margin: 0;
            font-size: 12px;
        }

        /* Enterprise Gap Cards */
        .enterprise-gap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .gap-card {
            background: #21262d;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #30363d;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .gap-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .gap-card h4 {
            margin: 0 0 15px 0;
            font-size: 16px;
            color: #e6edf3;
        }
        .gap-card ul {
            margin: 0;
            padding-left: 20px;
        }
        .gap-card li {
            margin: 10px 0;
            color: #8b949e;
            font-size: 13px;
            line-height: 1.5;
        }
        .gap-card li strong {
            color: #e6edf3;
        }
        .gap-critical { border-left: 4px solid #f85149; }
        .gap-warning { border-left: 4px solid #d29922; }
        .gap-info { border-left: 4px solid #58a6ff; }
        .gap-best-practice { border-left: 4px solid #238636; }

        /* Quick Reference Cards */
        .quick-ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .quick-ref-card {
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .quick-ref-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .quick-ref-card h4 {
            color: #58a6ff;
            margin: 0 0 10px 0;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .quick-ref-card p {
            color: #8b949e;
            margin: 0;
            font-size: 13px;
            line-height: 1.5;
        }

        /* Enhanced Q&A Styling */
        .qa-section {
            margin: 20px 0;
        }
        .qa-item {
            margin-bottom: 15px;
            border-radius: 10px;
            overflow: hidden;
            background: #21262d;
            border: 1px solid #30363d;
        }
        .qa-question {
            width: 100%;
            padding: 18px 20px;
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            border: none;
            color: #e6edf3;
            font-size: 14px;
            font-weight: 600;
            text-align: left;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background 0.2s;
        }
        .qa-question:hover {
            background: linear-gradient(135deg, #30363d 0%, #21262d 100%);
        }
        .qa-question i {
            color: #d29922;
            font-size: 18px;
        }
        .qa-answer {
            padding: 20px;
            background: #161b22;
            border-top: 1px solid #30363d;
            display: none;
        }
        .qa-answer p {
            color: #8b949e;
            line-height: 1.7;
            margin: 0 0 15px 0;
            font-size: 14px;
        }
        .qa-answer p:last-child {
            margin-bottom: 0;
        }

        /* Info Cards */
        .info-card {
            background: #21262d;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #30363d;
            margin: 15px 0;
        }
        .info-card.critical { border-left: 4px solid #f85149; }
        .info-card.warning { border-left: 4px solid #d29922; }
        .info-card.info { border-left: 4px solid #58a6ff; }
        .info-card.success { border-left: 4px solid #238636; }

        /* Config Sections */
        .config-section {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .config-section h3 {
            color: #58a6ff;
            margin: 0 0 15px 0;
            font-size: 16px;
        }

        /* Comparison Tables */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #21262d;
            border-radius: 10px;
            overflow: hidden;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #30363d;
        }
        .comparison-table th {
            background: #161b22;
            color: #e6edf3;
            font-weight: 600;
            font-size: 13px;
        }
        .comparison-table td {
            color: #8b949e;
            font-size: 13px;
        }

        /* Architecture Diagrams */
        .arch-diagram {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #8b949e;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        /* Grid Layouts */
        .grid-2col {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .grid-3col {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
    </style>

</head>
<body>
    <div class="app-container">
            <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link active"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>


        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Troubleshooting</span>
                </div>

                <h1><i class="fas fa-wrench"></i> XSIAM Troubleshooting Guide</h1>
                <p class="lead">Comprehensive troubleshooting procedures for XSIAM agents, Broker VMs, data ingestion, parsing failures, and common operational issues. Use this guide when things break.</p>

                <div class="warning-box">
                    <h4><i class="fas fa-exclamation-triangle"></i> Before You Start</h4>
                    <p>Always check the XSIAM Status Page and recent change tickets before deep troubleshooting. Many issues correlate with platform updates or recent configuration changes.</p>
                </div>

                <!-- Master Troubleshooting Decision Tree -->
                <h2><i class="fas fa-code-branch"></i> Master Troubleshooting Decision Tree</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What type of issue are you experiencing?</strong>
                    </div>
                    <div class="decision-branch" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 16px;">
                        <div>
                            <div class="decision-node" style="background: #4d1a1a; border-color: #f85149;">
                                <strong style="color: #f85149;">No Data</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">Logs stopped arriving<br>↓ Go to Section 1</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                <strong style="color: #d29922;">Delayed Data</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">Logs arriving late<br>↓ Go to Section 2</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                <strong style="color: #58a6ff;">Parsing Errors</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">Fields not extracted<br>↓ Go to Section 3</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-node" style="background: #3d2a5e; border-color: #a371f7;">
                                <strong style="color: #a371f7;">Agent Issues</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">Endpoint not reporting<br>↓ Go to Section 4</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 1: No Data Issues -->
                <h2><i class="fas fa-ban"></i> Section 1: No Data Arriving</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>Is this affecting a single source or multiple sources?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ Single Source</div>
                            <div class="decision-node question">
                                <strong>What type of data source?</strong>
                            </div>
                            <div class="decision-branch" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 12px;">
                                <div class="decision-node" style="background: #21262d;">
                                    <strong>XDR Agent</strong>
                                    <div style="color: #8b949e; font-size: 0.8rem;">→ Check agent status<br>→ Verify network connectivity<br>→ Check agent version</div>
                                </div>
                                <div class="decision-node" style="background: #21262d;">
                                    <strong>Syslog (Broker)</strong>
                                    <div style="color: #8b949e; font-size: 0.8rem;">→ Check source device<br>→ Verify Broker VM health<br>→ Check firewall rules</div>
                                </div>
                                <div class="decision-node" style="background: #21262d;">
                                    <strong>Cloud/API</strong>
                                    <div style="color: #8b949e; font-size: 0.8rem;">→ Check credentials<br>→ Verify API limits<br>→ Check integration status</div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Multiple Sources</div>
                            <div class="decision-node" style="background: #4d1a1a; border-color: #f85149;">
                                <strong style="color: #f85149;">Platform Issue - Escalate</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Check XSIAM Status Page<br>2. Check Broker VM health<br>3. Open support case if needed</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>No Data Diagnostic Queries</h4>
                    <div class="arch-diagram"># Check Last Event Time Per Data Source
# ═══════════════════════════════════════════════════════════════

dataset = *
| filter _time > now() - 24h
| comp max(_time) as last_event, count() as event_count by _dataset
| alter hours_since_last = timestamp_diff(now(), last_event, "HOUR")
| filter hours_since_last > 1  // Flag sources with >1 hour gap
| sort hours_since_last desc

# ═══════════════════════════════════════════════════════════════

# Check Ingestion Volume Trend (Detect Drops)
# ═══════════════════════════════════════════════════════════════

dataset = *
| filter _time > now() - 48h
| alter hour_bucket = format_time("%Y-%m-%d %H:00", _time)
| comp count() as events by hour_bucket
| sort hour_bucket desc
| limit 48

# ═══════════════════════════════════════════════════════════════

# Identify Specific Missing Hosts
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| comp max(_time) as last_seen, count() as total_events by endpoint_name
| alter days_since_seen = timestamp_diff(now(), last_seen, "DAY")
| filter days_since_seen > 1
| sort days_since_seen desc

# ═══════════════════════════════════════════════════════════════

# Check Broker VM Data Flow
# ═══════════════════════════════════════════════════════════════

dataset = panw_system_health_raw
| filter collector_type = "broker_vm"
| filter _time > now() - 24h
| comp count() as events, max(_time) as last_event by collector_name
| sort last_event asc</div>
                </div>

                <!-- Section 2: Delayed Data -->
                <h2><i class="fas fa-clock"></i> Section 2: Data Ingestion Delays</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What is the delay duration?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ &lt; 5 minutes</div>
                            <div class="decision-node" style="background: #1a4d2e; border-color: #3fb950;">
                                <strong style="color: #3fb950;">Normal - No Action</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">XSIAM has typical 1-5 min latency<br>for processing and indexing</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ 5-30 minutes</div>
                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                <strong style="color: #d29922;">Investigate</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Check ingestion queue depth<br>2. Verify Broker VM resources<br>3. Check for parsing errors</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ &gt; 30 minutes</div>
                            <div class="decision-node" style="background: #4d1a1a; border-color: #f85149;">
                                <strong style="color: #f85149;">Critical - Escalate</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Check XSIAM platform status<br>2. Open support case<br>3. Consider Broker VM restart</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>Delay Analysis Queries</h4>
                    <div class="arch-diagram"># Calculate Ingestion Delay Per Source
# ═══════════════════════════════════════════════════════════════

dataset = *
| filter _time > now() - 1h
| alter ingestion_delay_sec = timestamp_diff(_insert_time, _time, "SECOND")
| comp avg(ingestion_delay_sec) as avg_delay_sec,
        max(ingestion_delay_sec) as max_delay_sec,
        percentile(ingestion_delay_sec, 95) as p95_delay_sec
  by _dataset
| filter avg_delay_sec > 300  // More than 5 min average
| sort avg_delay_sec desc

# ═══════════════════════════════════════════════════════════════

# Identify Delay Spikes Over Time
# ═══════════════════════════════════════════════════════════════

dataset = *
| filter _time > now() - 6h
| alter delay_sec = timestamp_diff(_insert_time, _time, "SECOND")
| alter time_bucket = format_time("%Y-%m-%d %H:%M", _time)
| comp avg(delay_sec) as avg_delay by time_bucket
| sort time_bucket asc

# ═══════════════════════════════════════════════════════════════

# Check Broker VM Queue Depth
# ═══════════════════════════════════════════════════════════════

dataset = panw_broker_health_raw
| filter _time > now() - 4h
| fields _time, broker_name, queue_depth, cpu_percent, memory_percent
| filter queue_depth > 10000  // High queue
| sort _time desc</div>
                </div>

                <!-- Section 3: Parsing Issues -->
                <h2><i class="fas fa-puzzle-piece"></i> Section 3: Parsing Failures</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What parsing issue are you seeing?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ Fields Not Extracted</div>
                            <div class="decision-node" style="background: #21262d;">
                                <strong>Check Parser Configuration</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Verify parser is assigned<br>2. Check regex patterns<br>3. Test with sample logs</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Wrong Field Values</div>
                            <div class="decision-node" style="background: #21262d;">
                                <strong>Parser Mismatch</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Log format changed<br>2. Wrong parser assigned<br>3. Regex capture group issue</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Logs in _raw Only</div>
                            <div class="decision-node" style="background: #21262d;">
                                <strong>No Parser Matching</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Create custom parser<br>2. Check vendor/product tags<br>3. Verify log format</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>Parsing Diagnostic Queries</h4>
                    <div class="arch-diagram"># Find Unparsed Logs (Raw Only)
# ═══════════════════════════════════════════════════════════════

dataset = *
| filter _time > now() - 1h
| filter _raw != null
| filter xdm.event.type = null  // No XDM mapping
| comp count() as unparsed_count by _dataset, _vendor, _product
| sort unparsed_count desc

# ═══════════════════════════════════════════════════════════════

# Check Parsing Error Rate
# ═══════════════════════════════════════════════════════════════

dataset = panw_parsing_stats_raw
| filter _time > now() - 24h
| comp sum(parsed_events) as parsed,
        sum(failed_events) as failed,
        sum(dropped_events) as dropped
  by parser_name
| alter error_rate = round(failed * 100 / (parsed + failed + 0.001), 2)
| filter error_rate > 5  // More than 5% errors
| sort error_rate desc

# ═══════════════════════════════════════════════════════════════

# Sample Unparsed Events for Analysis
# ═══════════════════════════════════════════════════════════════

dataset = *
| filter _time > now() - 1h
| filter xdm.source.ipv4 = null AND xdm.target.ipv4 = null
| filter _raw contains "error" OR _raw contains "fail"
| fields _time, _dataset, _raw
| limit 50

# ═══════════════════════════════════════════════════════════════

# Check XDM Field Population Rate
# ═══════════════════════════════════════════════════════════════

dataset = *
| filter _time > now() - 1h
| comp count() as total,
        countif(xdm.source.ipv4 != null) as has_source_ip,
        countif(xdm.target.ipv4 != null) as has_target_ip,
        countif(xdm.source.user.username != null) as has_user
  by _dataset
| alter source_ip_rate = round(has_source_ip * 100 / total, 1)
| alter user_rate = round(has_user * 100 / total, 1)
| sort total desc</div>
                </div>

                <div class="config-section">
                    <h4>Common Parsing Fix Procedures</h4>
                    <div class="arch-diagram"># Parsing Troubleshooting Checklist
# ═══════════════════════════════════════════════════════════════

## Issue: Logs Not Being Parsed

Step 1: Verify log is reaching XSIAM
└── Query: dataset = * | filter _raw contains "unique_string_from_log"

Step 2: Check if parser exists for this log type
└── Settings → Parsing Rules → Search for vendor/product

Step 3: Verify parser assignment
└── Check: Is parser enabled? Is it assigned to correct collector?

Step 4: Test parser with sample log
└── Settings → Parsing Rules → Test → Paste raw log

Step 5: Check for parser conflicts
└── Multiple parsers matching same log = first match wins

## Issue: Fields Extracting Incorrectly

Step 1: Compare expected vs actual field values
└── Query: dataset = X | fields _raw, xdm.field1, xdm.field2

Step 2: Check if log format changed
└── Compare current logs to parser documentation

Step 3: Update regex patterns
└── Settings → Parsing Rules → Edit → Modify regex

Step 4: Test updated parser
└── Use Test function before saving

## Issue: New Log Format Not Recognized

Step 1: Capture sample raw logs (10-20 examples)
Step 2: Identify consistent patterns for field extraction
Step 3: Create custom parsing rule
Step 4: Map extracted fields to XDM schema
Step 5: Test with production data
Step 6: Monitor parsing success rate for 24h

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Section 4: Agent Issues -->
                <h2><i class="fas fa-desktop"></i> Section 4: XDR Agent Issues</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What is the agent symptom?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ Not Reporting</div>
                            <div class="decision-node question">
                                <strong>Can you ping the endpoint?</strong>
                            </div>
                            <div class="decision-branch">
                                <div>
                                    <div class="decision-arrow">↓ YES</div>
                                    <div class="decision-node" style="background: #21262d;">
                                        <strong>Agent/Network Issue</strong>
                                        <div style="color: #8b949e; font-size: 0.8rem;">1. Check agent service status<br>2. Verify firewall rules (443 outbound)<br>3. Check proxy configuration<br>4. Restart agent service</div>
                                    </div>
                                </div>
                                <div>
                                    <div class="decision-arrow">↓ NO</div>
                                    <div class="decision-node" style="background: #4d1a1a; border-color: #f85149;">
                                        <strong style="color: #f85149;">Endpoint Offline</strong>
                                        <div style="color: #8b949e; font-size: 0.8rem;">1. Verify endpoint power status<br>2. Check network connectivity<br>3. May be normal (laptop off)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ High Resource Usage</div>
                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                <strong style="color: #d29922;">Performance Issue</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">1. Check agent version (update if old)<br>2. Review scan exclusions<br>3. Check for conflicting security software<br>4. Collect diagnostic logs</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Installation Failed</div>
                            <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                <strong style="color: #58a6ff;">Deployment Issue</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">1. Check system requirements<br>2. Verify admin privileges<br>3. Check for conflicting AV<br>4. Review installer logs</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>Agent Troubleshooting Commands</h4>
                    <div class="arch-diagram"># Windows Agent Troubleshooting
# ═══════════════════════════════════════════════════════════════

## Check Agent Service Status
sc query "cyserver"
sc query "CortexAgentService"

## Check Agent Version
Get-WmiObject -Class Win32_Product | Where-Object {$_.Name -like "*Cortex*"}

## View Agent Logs
Get-Content "C:\ProgramData\Cyvera\Logs\agent.log" -Tail 100

## Restart Agent Service
Restart-Service -Name "CortexAgentService" -Force

## Check Network Connectivity (to XSIAM cloud)
Test-NetConnection -ComputerName "*.xdr.us.paloaltonetworks.com" -Port 443

## Verify Proxy Configuration
netsh winhttp show proxy

## Force Agent Check-in
& "C:\Program Files\Palo Alto Networks\Traps\cytool.exe" checkin

## Collect Diagnostic Bundle
& "C:\Program Files\Palo Alto Networks\Traps\cytool.exe" collect

# ═══════════════════════════════════════════════════════════════

# Linux Agent Troubleshooting
# ═══════════════════════════════════════════════════════════════

## Check Agent Service
systemctl status traps_agent

## View Agent Logs
tail -100 /var/log/traps/agent.log

## Restart Agent
sudo systemctl restart traps_agent

## Check Connectivity
curl -v https://xdr-us.paloaltonetworks.com:443

## Force Check-in
/opt/traps/bin/cytool checkin

# ═══════════════════════════════════════════════════════════════

# macOS Agent Troubleshooting
# ═══════════════════════════════════════════════════════════════

## Check Agent Status
sudo /Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool info

## View Agent Logs
tail -100 /Library/Logs/PaloAltoNetworks/Traps/agent.log

## Restart Agent
sudo launchctl unload /Library/LaunchDaemons/com.paloaltonetworks.traps.agent.plist
sudo launchctl load /Library/LaunchDaemons/com.paloaltonetworks.traps.agent.plist

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <div class="config-section">
                    <h4>Agent Status XQL Queries</h4>
                    <div class="arch-diagram"># Find Agents Not Reporting (Last 24h)
# ═══════════════════════════════════════════════════════════════

dataset = xdr_agent_inventory
| comp max(last_seen) as last_checkin by endpoint_name, endpoint_id, os_type
| alter hours_since_checkin = timestamp_diff(now(), last_checkin, "HOUR")
| filter hours_since_checkin > 24
| sort hours_since_checkin desc
| limit 100

# ═══════════════════════════════════════════════════════════════

# Agent Version Distribution
# ═══════════════════════════════════════════════════════════════

dataset = xdr_agent_inventory
| filter last_seen > now() - 7d
| comp count() as agent_count by agent_version, os_type
| sort agent_count desc

# ═══════════════════════════════════════════════════════════════

# Agents with Connectivity Issues
# ═══════════════════════════════════════════════════════════════

dataset = xdr_agent_inventory
| filter last_seen > now() - 7d
| filter connection_status != "connected"
| fields endpoint_name, endpoint_id, os_type, connection_status, last_seen
| sort last_seen desc

# ═══════════════════════════════════════════════════════════════

# High CPU Agents
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 1h
| filter actor_process_image_name contains "traps" OR actor_process_image_name contains "cortex"
| comp avg(actor_process_cpu_percent) as avg_cpu by endpoint_name
| filter avg_cpu > 10
| sort avg_cpu desc</div>
                </div>

                <!-- Section 5: Broker VM Issues -->
                <h2><i class="fas fa-server"></i> Section 5: Broker VM Issues</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What Broker VM symptom?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ Not Receiving Logs</div>
                            <div class="decision-node" style="background: #21262d;">
                                <strong>Check Syslog Flow</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">1. tcpdump on port 514/6514<br>2. Check firewall allows traffic<br>3. Verify syslog config on source<br>4. Check Broker VM listener</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Not Forwarding to XSIAM</div>
                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                <strong style="color: #d29922;">Upstream Connectivity</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">1. Check XSIAM cloud connectivity<br>2. Verify certificates<br>3. Check queue depth<br>4. Review Broker logs</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ High Resource Usage</div>
                            <div class="decision-node" style="background: #4d1a1a; border-color: #f85149;">
                                <strong style="color: #f85149;">Capacity Issue</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">1. Check EPS vs sizing<br>2. Add resources or VM<br>3. Enable HA pair<br>4. Reduce log volume</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>Broker VM Troubleshooting Commands</h4>
                    <div class="arch-diagram"># Broker VM SSH Commands
# ═══════════════════════════════════════════════════════════════

## Check Broker Service Status
systemctl status cortex-broker

## View Broker Logs
tail -100 /var/log/cortex-broker/broker.log

## Check Listening Ports
ss -tlnp | grep -E '514|6514|443'

## Monitor Incoming Syslog
tcpdump -i eth0 port 514 -c 10

## Check Queue Depth
cat /var/lib/cortex-broker/queue/status

## Check Disk Space
df -h

## Check Memory Usage
free -m

## Check CPU Load
top -b -n 1 | head -20

## Test XSIAM Connectivity
curl -v https://xdr-collectors.paloaltonetworks.com:443

## Restart Broker Service
systemctl restart cortex-broker

## Check Certificate Validity
openssl s_client -connect xdr-collectors.paloaltonetworks.com:443 -servername xdr-collectors.paloaltonetworks.com

# ═══════════════════════════════════════════════════════════════

# Broker VM Sizing Reference
# ═══════════════════════════════════════════════════════════════

EPS Range      | vCPU | RAM   | Disk
───────────────┼──────┼───────┼──────
< 5,000        | 4    | 8 GB  | 100 GB
5,000-10,000   | 8    | 16 GB | 200 GB
10,000-25,000  | 16   | 32 GB | 500 GB
> 25,000       | HA Pair recommended

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Section 6: Query/Performance Issues -->
                <h2><i class="fas fa-tachometer-alt"></i> Section 6: Query Performance Issues</h2>
                
                <div class="config-section">
                    <h4>Query Timeout Troubleshooting</h4>
                    <div class="arch-diagram"># Query Performance Best Practices
# ═══════════════════════════════════════════════════════════════

## Issue: Query Times Out

Common Causes:
1. Time range too large (reduce from 30d to 7d)
2. No filters early in query (add specific filters first)
3. Searching across all datasets (specify dataset)
4. Complex regex on large data (simplify pattern)

## Optimization Techniques

# BAD - Scans everything then filters
dataset = *
| filter user = "john"

# GOOD - Filter early
dataset = xdr_data
| filter _time > now() - 7d
| filter user = "john"

# BAD - Complex aggregation on large dataset
dataset = *
| comp count() by src_ip, dst_ip, user, application, action

# GOOD - Limit cardinality
dataset = xdr_data  
| filter _time > now() - 1d
| comp count() by src_ip, dst_ip
| sort count desc
| limit 1000

## Query Time Guidelines
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Time Range    | Expected Response
1 hour        | < 5 seconds
24 hours      | < 30 seconds  
7 days        | < 2 minutes
30 days       | < 5 minutes (may timeout)

# If query times out, try:
1. Reduce time range
2. Add more specific filters
3. Use sampling: | sample 10000
4. Schedule as background job

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Common Error Messages -->
                <h2><i class="fas fa-exclamation-circle"></i> Common Error Messages & Solutions</h2>
                
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Error Message</th>
                            <th>Likely Cause</th>
                            <th>Solution</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code style="color: #f85149;">Query execution timeout</code></td>
                            <td>Query too broad/complex</td>
                            <td>Reduce time range, add filters, specify dataset</td>
                        </tr>
                        <tr>
                            <td><code style="color: #f85149;">Rate limit exceeded</code></td>
                            <td>Too many API calls</td>
                            <td>Add delays, use batch operations, check scripts</td>
                        </tr>
                        <tr>
                            <td><code style="color: #f85149;">Authentication failed</code></td>
                            <td>Invalid/expired credentials</td>
                            <td>Regenerate API key, check service account</td>
                        </tr>
                        <tr>
                            <td><code style="color: #f85149;">Collector not reachable</code></td>
                            <td>Network/firewall issue</td>
                            <td>Check outbound 443, verify proxy settings</td>
                        </tr>
                        <tr>
                            <td><code style="color: #f85149;">Parser validation failed</code></td>
                            <td>Invalid regex or XDM mapping</td>
                            <td>Test parser with sample log, fix regex</td>
                        </tr>
                        <tr>
                            <td><code style="color: #f85149;">License limit reached</code></td>
                            <td>Exceeded GB/day or endpoints</td>
                            <td>Review usage, optimize ingestion, upgrade license</td>
                        </tr>
                        <tr>
                            <td><code style="color: #d29922;">Data delayed</code></td>
                            <td>Ingestion backlog</td>
                            <td>Check Broker health, verify EPS within limits</td>
                        </tr>
                        <tr>
                            <td><code style="color: #d29922;">Playbook execution failed</code></td>
                            <td>Integration error or timeout</td>
                            <td>Check integration credentials, review playbook logs</td>
                        </tr>
                    </tbody>
                </table>

                <!-- Escalation Procedures -->
                <h2><i class="fas fa-arrow-circle-up"></i> Escalation Procedures</h2>
                
                <div class="config-section">
                    <h4>When to Escalate to Palo Alto Support</h4>
                    <div class="arch-diagram"># Escalation Decision Matrix
# ═══════════════════════════════════════════════════════════════

## IMMEDIATE ESCALATION (P1)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- Complete data ingestion failure (all sources)
- XSIAM console inaccessible
- Security incident requiring vendor support
- Suspected platform compromise

## URGENT ESCALATION (P2)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- Major data source not ingesting (>6 hours)
- Significant ingestion delays (>1 hour)
- Agent deployment failures across multiple endpoints
- Correlation rules not firing correctly

## STANDARD ESCALATION (P3)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- Single data source issues
- Parsing problems
- Performance degradation
- Feature questions

## BEFORE ESCALATING - Gather:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. Tenant ID
2. Affected time range
3. Specific error messages (screenshots)
4. Steps to reproduce
5. Impact scope (# users, # systems)
6. Troubleshooting already attempted
7. Recent changes

## SUPPORT CONTACT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Portal: support.paloaltonetworks.com
Phone: Check regional number on support portal
TAM: Contact your Technical Account Manager for P1

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through how you would troubleshoot a data source that stopped sending logs to XSIAM.</button>
                        <div class="qa-answer">
                            <p>My approach follows a systematic path from source to destination, isolating where the break occurs.</p>
                            
                            <p><strong>Step 1: Confirm the problem</strong> - First, I verify the issue isn't a false alarm. I run a query to check when the last event arrived: <code>dataset = X | comp max(_time) as last_event</code>. If it's been hours, I confirm there's a real problem.</p>
                            
                            <p><strong>Step 2: Check the source</strong> - Is the source device actually generating logs? I'll check the device itself - is syslog enabled, is it configured to send to the right destination? For agents, is the service running? Many "SIEM problems" are actually source configuration issues.</p>
                            
                            <p><strong>Step 3: Verify network path</strong> - If logs are being generated, are they reaching the collector? For syslog, I'll tcpdump on the Broker VM to see if packets arrive. For cloud sources, I check API connectivity. Firewall rules and network changes are common culprits.</p>
                            
                            <p><strong>Step 4: Check the collector</strong> - If data reaches the Broker VM or collector, is it processing correctly? I check Broker health, queue depth, and forwarding status. High CPU or full disk can block processing.</p>
                            
                            <p><strong>Step 5: Verify cloud ingestion</strong> - Finally, if everything looks good on-prem, I check XSIAM platform status and ingestion health. Platform-side issues are rare but happen during maintenance or outages.</p>
                            
                            <p>Throughout this process, I document what I check and rule out. This creates a clear troubleshooting trail and helps if I need to escalate to support.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle a situation where XDR agents across the organization stop reporting?</button>
                        <div class="qa-answer">
                            <p>A widespread agent outage is serious and requires rapid triage to determine scope and cause.</p>
                            
                            <p><strong>First, assess scope</strong> - Is it all agents or a subset? I query agent inventory to see last check-in times across the fleet. If it's everyone, likely infrastructure issue. If it's specific segments (one site, one OS), the cause is probably more targeted.</p>
                            
                            <p><strong>Check for correlation with changes</strong> - What changed recently? Network changes, firewall rule updates, proxy configuration changes, even Windows updates can break agent connectivity. I check change management for anything deployed in the last 24-48 hours.</p>
                            
                            <p><strong>Test from an affected endpoint</strong> - I get on one of the non-reporting endpoints and check agent service status, try to force a check-in, and test network connectivity to XSIAM cloud endpoints. This tells me if the agent itself is healthy versus network blocked.</p>
                            
                            <p><strong>Common causes I've seen:</strong> Firewall rules blocking 443 outbound to Palo Alto cloud, proxy changes requiring agent reconfiguration, certificate issues after infrastructure updates, and occasionally Palo Alto platform issues affecting specific regions.</p>
                            
                            <p><strong>Recovery approach</strong> - Once I identify the cause, fix it (update firewall rules, fix proxy config, etc.) and monitor agent check-ins recovering. For platform issues, I open a support case immediately with our tenant ID and scope of impact.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: You notice parsing is failing for a major log source. How do you fix it?</button>
                        <div class="qa-answer">
                            <p>Parsing failures typically mean either the log format changed or the parser configuration is wrong. My approach is to understand what changed and fix accordingly.</p>
                            
                            <p><strong>Step 1: Get sample logs</strong> - I query for recent raw events from the affected source to see what the logs actually look like now: <code>dataset = X | fields _raw | limit 20</code>. I compare these to the expected format.</p>
                            
                            <p><strong>Step 2: Identify the change</strong> - Did the vendor update their log format? Did we change something in our infrastructure that modified the log path? Sometimes a firmware update or application upgrade changes log structure without warning.</p>
                            
                            <p><strong>Step 3: Test the existing parser</strong> - In Settings → Parsing Rules, I use the Test function with a sample raw log. This shows exactly what the parser extracts versus what it should extract. Usually, this reveals where the regex is failing.</p>
                            
                            <p><strong>Step 4: Fix the parser</strong> - If the log format changed slightly, I update the regex patterns to match the new format. If it changed dramatically, I might need to create a new parser version. I always test with multiple sample logs before deploying.</p>
                            
                            <p><strong>Step 5: Monitor after fix</strong> - After deploying the updated parser, I watch the parsing success rate and spot-check that fields are populating correctly. I also set an alert for parsing error rates on critical sources so I catch future issues faster.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) { sidebar.classList.toggle('open'); overlay.classList.toggle('active'); }
            else { sidebar.classList.toggle('collapsed'); mainWrapper.classList.toggle('expanded'); }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
