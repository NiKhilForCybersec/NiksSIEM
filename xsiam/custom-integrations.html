<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Integrations | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand"><i class="fas fa-shield-alt"></i><span>Nik's SIEM</span></a>
                <button class="sidebar-toggle" onclick="toggleSidebar()"><i class="fas fa-chevron-left"></i></button>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Integrations</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud</span></a></li>
                        <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity</span></a></li>
                        <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link active"><i class="fas fa-puzzle-piece"></i><span>Custom</span></a></li>
                        <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                    </ul>
                </div>
            </div>
        </aside>
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Custom Integrations</span>
                </div>

                <h1><i class="fas fa-puzzle-piece"></i> Custom Integrations</h1>
                <p class="lead">Building custom integrations for proprietary applications, legacy systems, and specialized log sources using XSIAM's HTTP collectors, custom parsers, and API.</p>

                <h2><i class="fas fa-code"></i> Integration Methods</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-project-diagram"></i> Custom Integration Options</div>
<pre style="color: #8b949e; font-size: 0.8rem; line-height: 1.6; overflow-x: auto;">
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                 CUSTOM INTEGRATION METHODS                                       │
├─────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                  │
│   ┌─────────────────────┐   ┌─────────────────────┐   ┌─────────────────────┐                  │
│   │   HTTP COLLECTOR    │   │   SYSLOG COLLECTOR  │   │   FILE COLLECTOR    │                  │
│   ├─────────────────────┤   ├─────────────────────┤   ├─────────────────────┤                  │
│   │ • Webhook receiver  │   │ • UDP/TCP syslog    │   │ • Log file tailing  │                  │
│   │ • REST API endpoint │   │ • TLS syslog        │   │ • Directory watch   │                  │
│   │ • JSON/XML payload  │   │ • CEF/LEEF format   │   │ • S3/Blob pickup    │                  │
│   │                     │   │ • RFC 5424          │   │                     │                  │
│   │ Best for:           │   │ Best for:           │   │ Best for:           │                  │
│   │ Modern apps, SaaS   │   │ Network devices,    │   │ Legacy apps,        │                  │
│   │ with webhook        │   │ security tools      │   │ batch processing    │                  │
│   └─────────────────────┘   └─────────────────────┘   └─────────────────────┘                  │
│                                                                                                  │
│   ─────────────────────────────────────────────────────────────────────────────────────────────  │
│                                                                                                  │
│   ┌─────────────────────┐   ┌─────────────────────┐   ┌─────────────────────┐                  │
│   │   API POLLING       │   │   DATABASE QUERY    │   │   CUSTOM SCRIPT     │                  │
│   ├─────────────────────┤   ├─────────────────────┤   ├─────────────────────┤                  │
│   │ • Pull from REST    │   │ • JDBC/ODBC query   │   │ • Python collector  │                  │
│   │ • GraphQL queries   │   │ • Scheduled pulls   │   │ • Shell scripts     │                  │
│   │ • Pagination        │   │ • Change detection  │   │ • XSOAR automation  │                  │
│   │                     │   │                     │   │                     │                  │
│   │ Best for:           │   │ Best for:           │   │ Best for:           │                  │
│   │ SaaS without push,  │   │ Audit tables,       │   │ Complex transform,  │                  │
│   │ rate-limited APIs   │   │ legacy databases    │   │ multiple sources    │                  │
│   └─────────────────────┘   └─────────────────────┘   └─────────────────────┘                  │
│                                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
                </div>

                <h2><i class="fas fa-webhook"></i> HTTP Collector Setup</h2>
                
                <div class="config-section">
                    <h4>Webhook Integration Example</h4>
                    <div class="arch-diagram"># HTTP Collector Configuration
# ═══════════════════════════════════════════════════════════════

## Step 1: Create HTTP Collector in XSIAM
# Settings → Data Sources → HTTP Log Collector → Add

Name:           custom-app-webhook
Authentication: Token-based
Token:          auto-generated or custom
Compression:    gzip supported
Format:         JSON

## Step 2: Get Collector URL
# Format: https://{tenant}.xdr.{region}.paloaltonetworks.com/logs/v1/event

## Step 3: Configure Source Application
# Example: Send events via curl

curl -X POST \
  "https://api-{tenant}.xdr.us.paloaltonetworks.com/logs/v1/event" \
  -H "Authorization: {token}" \
  -H "Content-Type: application/json" \
  -d '{
    "logs": [
      {
        "timestamp": "2024-01-15T10:30:00Z",
        "event_type": "user_login",
        "user": "jsmith@company.com",
        "source_ip": "10.0.1.50",
        "result": "success",
        "application": "custom-hr-app"
      }
    ]
  }'

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-file-code"></i> Custom Parser Development</h2>
                
                <div class="config-section">
                    <h4>Parser Rule Syntax</h4>
                    <div class="arch-diagram"># Custom Log Parser Example
# ═══════════════════════════════════════════════════════════════

## Sample Log Format (proprietary application)
2024-01-15 10:30:45 INFO [UserService] user=jsmith action=login ip=10.0.1.50 result=success

## Parser Rule Definition
[INGEST:vendor="custom", product="hr-app", target_dataset="custom_hr_app_raw"]
filter _raw_log contains "[UserService]"
| alter 
    _time = parse_timestamp("%Y-%m-%d %H:%M:%S", arrayindex(split(_raw_log, " "), 0) + " " + arrayindex(split(_raw_log, " "), 1)),
    log_level = arrayindex(split(_raw_log, " "), 2),
    user = arrayindex(regextract(_raw_log, "user=(\S+)"), 0),
    action = arrayindex(regextract(_raw_log, "action=(\S+)"), 0),
    src_ip = arrayindex(regextract(_raw_log, "ip=(\S+)"), 0),
    result = arrayindex(regextract(_raw_log, "result=(\S+)"), 0)
| alter
    xdm.source.user.username = user,
    xdm.source.ip = src_ip,
    xdm.event.type = action,
    xdm.event.outcome = if(result = "success", XDM_CONST.OUTCOME_SUCCESS, XDM_CONST.OUTCOME_FAILED);

# ═══════════════════════════════════════════════════════════════

## Testing the Parser
# Use the parsing test UI:
# Settings → Data Sources → Parsing Rules → Test

# Input sample logs and verify field extraction
# Check XDM mapping for correlation compatibility

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-code-branch"></i> Integration Decision Tree</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What can your source application do?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ Send webhooks (push)</div>
                            <div class="decision-node yes" style="background: #1a4d2e;">
                                <strong style="color: #3fb950;">HTTP Collector</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Configure webhook URL<br>Lowest latency option</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Has REST API</div>
                            <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                <strong style="color: #58a6ff;">API Polling</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Build XSOAR integration<br>or custom script</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Syslog output</div>
                            <div class="decision-node" style="background: #3d2a5e; border-color: #a371f7;">
                                <strong style="color: #a371f7;">Syslog via Broker VM</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Point to Broker VM<br>Create custom parser</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ File-based logs only</div>
                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                <strong style="color: #d29922;">File Collector</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Deploy Broker VM<br>with file tail</div>
                            </div>
                        </div>
                    </div>
                </div>

                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you integrate a proprietary application with no built-in SIEM support?</button>
                        <div class="qa-answer">
                            <p>Integrating proprietary applications requires understanding what logging capabilities exist and finding the most reliable path to get that data into XSIAM. My approach is systematic.</p>
                            
                            <p>First, I assess the application's logging capabilities. Does it write to files, database tables, Windows Event Log, or have any API? Even applications without SIEM support usually log somewhere for troubleshooting. I work with application owners to understand the logging format and content.</p>
                            
                            <p>For file-based logs, I deploy a Broker VM with the file collector configured to tail the log files. I develop a custom parser to extract structured fields from whatever format the application uses - often proprietary text formats that require regex extraction.</p>
                            
                            <p>If the application has a database with audit tables, I might query those tables periodically using a custom XSOAR integration or script. This works well for applications where the database is the source of truth and file logs are limited.</p>
                            
                            <p>For modern applications, I advocate for adding structured logging if possible. If I can influence the development team, I'd request JSON-formatted logs with consistent field names that can be sent to a webhook endpoint. This is the cleanest long-term solution.</p>
                            
                            <p>Throughout this process, I map the extracted fields to XDM for correlation compatibility. The goal is that events from this proprietary application can be correlated with events from other sources - a user action in the custom app should link to their authentication in Okta and their endpoint activity in XDR.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) { sidebar.classList.toggle('open'); overlay.classList.toggle('active'); }
            else { sidebar.classList.toggle('collapsed'); mainWrapper.classList.toggle('expanded'); }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
