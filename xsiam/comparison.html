<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSIAM vs Sentinel vs Splunk - Complete Technical Comparison | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
                <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link active"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>




        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Comparison</span>
                </div>

                <div class="page-header">
                    <span >COMPLETE TECHNICAL REFERENCE</span>
                    <h1><i class="fas fa-balance-scale"></i> XSIAM vs Sentinel vs Splunk</h1>
                    <p class="lead">Complete technical comparison covering ingestion, parsing, normalization, deployment, and automation with real-world examples</p>
                </div>
                <!-- Table of Contents -->
                <section class="content-section">
                    <h2><i class="fas fa-list"></i> What This Guide Covers</h2>
                    <div class="info-box">
                        <ul style="columns: 2; column-gap: 2rem;">
                            <li><a href="#ingestion">Data Ingestion Methods</a></li>
                            <li><a href="#parsing">Parsing & Field Extraction</a></li>
                            <li><a href="#normalization">Normalization (XDM/ASIM/CIM)</a></li>
                            <li><a href="#deployment">Deployment Architecture</a></li>
                            <li><a href="#builtin-parsers">Built-in vs Custom Parsers</a></li>
                            <li><a href="#examples">Real-World Examples</a></li>
                            <li><a href="#automation">Automation & SOAR</a></li>
                            <li><a href="#interview">Interview Preparation</a></li>
                        </ul>
                    </div>
                </section>
                <!-- Section 1: Data Ingestion Methods -->
                <section class="content-section" id="ingestion">
                    <h2><i class="fas fa-database"></i> Data Ingestion Methods - Complete Breakdown</h2>
                    <p>Each platform has fundamentally different approaches to getting data in. Understanding these is critical for architecture decisions and troubleshooting.</p>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th style="width: 18%;">Ingestion Method</th>
                                <th class="platform-header xsiam" style="width: 27%;">Cortex XSIAM</th>
                                <th class="platform-header sentinel" style="width: 27%;">Microsoft Sentinel</th>
                                <th class="platform-header splunk" style="width: 27%;">Splunk</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-server"></i> AGENT-BASED COLLECTION</td></tr>
                            <tr>
                                <td><strong>Primary Agent</strong></td>
                                <td><strong>Cortex XDR Agent</strong><br>• Full EDR capabilities<br>• Process/file/network telemetry<br>• Native XDM normalization<br>• Windows, Linux, macOS</td>
                                <td><strong>Azure Monitor Agent (AMA)</strong><br>• Replaced MMA (deprecated Aug 2024)<br>• Requires Azure Arc for on-prem<br>• Configured via DCR<br>• Windows, Linux</td>
                                <td><strong>Universal Forwarder (UF)</strong><br>• Lightweight, no parsing<br>• File monitoring, WinEventLog<br>• Sends raw data to indexer<br>• Windows, Linux, macOS</td>
                            </tr>
                            <tr>
                                <td><strong>Agent Capabilities</strong></td>
                                <td>• EDR + Data Collection<br>• Response actions (isolate, kill)<br>• Local analysis<br>• Causality chain tracking</td>
                                <td>• Data collection only<br>• No EDR (requires MDE)<br>• XPath filtering<br>• DCR-controlled collection</td>
                                <td>• Data forwarding only<br>• No parsing (unless force_local)<br>• Load balancing to indexers<br>• Scripted inputs</td>
                            </tr>
                            <tr>
                                <td><strong>Collection Agent</strong></td>
                                <td><strong>XDR Collector</strong><br>• Filebeat-based<br>• File log collection<br>• Used for third-party logs</td>
                                <td><strong>AMA</strong><br>• Same agent for all collection<br>• Multi-homing supported<br>• DCE for custom logs</td>
                                <td><strong>Heavy Forwarder (HF)</strong><br>• Full Splunk instance<br>• Can parse/transform<br>• Run modular inputs</td>
                            </tr>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-network-wired"></i> NETWORK/SYSLOG COLLECTION</td></tr>
                            <tr>
                                <td><strong>Syslog Receiver</strong></td>
                                <td><strong>Broker VM</strong><br>• Syslog Collector applet<br>• TCP/UDP/TLS<br>• CEF/LEEF auto-parsing<br>• On-prem or cloud VM</td>
                                <td><strong>AMA on Linux VM</strong><br>• rsyslog/syslog-ng → AMA<br>• CEF via CommonSecurityLog<br>• DCR controls facility/severity<br>• Azure VM or Arc-enabled</td>
                                <td><strong>Heavy Forwarder</strong><br>• Syslog input (UDP/TCP)<br>• Can parse at HF<br>• Or forward raw to indexer</td>
                            </tr>
                            <tr>
                                <td><strong>CEF/LEEF Handling</strong></td>
                                <td>Built-in CEF/LEEF parser<br>Auto-extracts to key-value<br>Maps to XDM automatically</td>
                                <td>CEF → CommonSecurityLog table<br>Built-in parser<br>ASIM via ASimCommonSecurityLog</td>
                                <td>Splunk_TA_cef<br>CIM mapping via TA<br>Search-time extraction</td>
                            </tr>
                            <tr>
                                <td><strong>Syslog Config Example</strong></td>
                                <td><code>Broker VM → Syslog Collector<br>Port: 514 (UDP/TCP)<br>TLS: 6514</code></td>
                                <td><code>DCR: facilityNames: [auth]<br>logLevels: [Warning, Error]<br>streams: Microsoft-Syslog</code></td>
                                <td><code>[udp://514]<br>sourcetype = syslog<br>connection_host = dns</code></td>
                            </tr>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-cloud"></i> API/CLOUD COLLECTION</td></tr>
                            <tr>
                                <td><strong>API Polling</strong></td>
                                <td><strong>Data Sources (Integrations)</strong><br>• Built-in API connectors<br>• Office 365, AWS, Azure<br>• Configured in UI<br>• Marketplace content packs</td>
                                <td><strong>Azure Functions + Logic Apps</strong><br>• Custom function polls API<br>• Sends via Log Ingestion API<br>• Content Hub solutions<br>• Data Connector templates</td>
                                <td><strong>Modular Inputs / Add-ons</strong><br>• Python-based inputs<br>• Run on HF or SH<br>• Splunkbase TAs<br>• HTTP Event Collector (HEC)</td>
                            </tr>
                            <tr>
                                <td><strong>HTTP/REST Ingestion</strong></td>
                                <td><strong>HTTP Log Collector</strong><br>• REST API endpoint<br>• JSON payload<br>• Authentication via API key</td>
                                <td><strong>Logs Ingestion API</strong><br>• POST to DCE endpoint<br>• DCR transforms data<br>• Custom or standard tables<br>• Requires AAD auth</td>
                                <td><strong>HTTP Event Collector (HEC)</strong><br>• REST endpoint on indexer<br>• Token-based auth<br>• JSON events<br>• Acknowledgment support</td>
                            </tr>
                            <tr>
                                <td><strong>Cloud-to-Cloud</strong></td>
                                <td>• AWS S3 polling<br>• Azure Event Hub<br>• GCP Pub/Sub<br>• Office 365 Management API</td>
                                <td>• Native Azure integration<br>• AWS S3 via Function<br>• Event Hub (best for Azure)<br>• Diagnostic Settings direct</td>
                                <td>• Splunk Add-on for AWS<br>• Splunk Add-on for Azure<br>• GCP Add-on<br>• Kinesis Firehose</td>
                            </tr>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-filter"></i> DATA FILTERING AT INGESTION</td></tr>
                            <tr>
                                <td><strong>Pre-Ingest Filtering</strong></td>
                                <td><strong>Parsing Rules</strong><br>• Drop unnecessary logs<br>• Filter at Broker VM<br>• Dataset rules</td>
                                <td><strong>DCR Transformations</strong><br>• KQL in transformKql<br>• project-away columns<br>• where clause filtering<br>• Runs before storage</td>
                                <td><strong>props.conf + transforms.conf</strong><br>• TRANSFORMS-null on HF<br>• Route to nullQueue<br>• SEDCMD for masking</td>
                            </tr>
                            <tr>
                                <td><strong>Cost Optimization</strong></td>
                                <td>Filter at Broker VM<br>Only ingest needed data<br>Dataset storage tiers</td>
                                <td>DCR filtering critical<br>Basic Logs tier (cheaper)<br>Auxiliary Logs (new 2025)<br>30 days interactive</td>
                                <td>Filter at HF layer<br>Summary indexes<br>Data model acceleration</td>
                            </tr>
                        </tbody>
                    </table>
                    <!-- Ingestion Architecture Diagrams -->
                    <h3>Data Flow Architecture</h3>
                    <div class="deep-dive">
                        <h4 style="color: #ff6b00;"><i class="fas fa-fire"></i> XSIAM Data Flow</h4>
                        <div class="architecture-diagram">
<p style="color: #8b949e;">[Diagram - see related pages for visual representation]</p>
                        </div>
                        <p><strong>Key Components:</strong></p>
                        <ul>
                            <li><strong>Cortex XDR Agent:</strong> Native endpoint telemetry, already normalized to XDM</li>
                            <li><strong>Broker VM:</strong> On-prem VM for syslog/CEF collection, runs Syslog Collector applet</li>
                            <li><strong>Parsing Rules:</strong> Extract fields from raw logs, bound to vendor/product</li>
                            <li><strong>Data Model Rules:</strong> Map extracted fields to XDM schema for correlation</li>
                        </ul>
                    </div>
                    <div class="deep-dive">
                        <h4 style="color: #0078d4;"><i class="fas fa-shield-alt"></i> Microsoft Sentinel Data Flow</h4>
                        <div class="architecture-diagram">
<p style="color: #8b949e;">[Diagram - see related pages for visual representation]</p>
                        </div>
                        <p><strong>Key Components:</strong></p>
                        <ul>
                            <li><strong>AMA (Azure Monitor Agent):</strong> Modern agent replacing legacy MMA, requires Azure Arc for on-prem</li>
                            <li><strong>DCR (Data Collection Rule):</strong> Defines WHAT to collect, HOW to transform, WHERE to send</li>
                            <li><strong>DCE (Data Collection Endpoint):</strong> HTTP endpoint for Logs Ingestion API and custom data</li>
                            <li><strong>DCRA (DCR Association):</strong> Links a DCR to specific VMs/resources</li>
                            <li><strong>Workspace Transformation DCR:</strong> Applies to data not using standard DCR (legacy connectors)</li>
                        </ul>
                    </div>
                    <div class="deep-dive">
                        <h4 style="color: #65a637;"><i class="fas fa-search"></i> Splunk Data Flow</h4>
                        <div class="architecture-diagram">
<p style="color: #8b949e;">[Diagram - see related pages for visual representation]</p>
                        </div>
                        <p><strong>Key Components:</strong></p>
                        <ul>
                            <li><strong>Universal Forwarder (UF):</strong> Lightweight agent, forwards raw data, minimal processing</li>
                            <li><strong>Heavy Forwarder (HF):</strong> Full Splunk, can parse, route, mask, run modular inputs</li>
                            <li><strong>Deployment Server:</strong> Centralized management - pushes configs to forwarders</li>
                            <li><strong>props.conf:</strong> Field extraction, line breaking, timestamp parsing</li>
                            <li><strong>transforms.conf:</strong> Field transforms, routing, masking</li>
                        </ul>
                    </div>
                </section>
                <!-- Section 2: Parsing Deep Dive -->
                <section class="content-section" id="parsing">
                    <h2><i class="fas fa-cut"></i> Parsing & Field Extraction - How Each Platform Does It</h2>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th style="width: 18%;">Parsing Aspect</th>
                                <th class="platform-header xsiam">XSIAM</th>
                                <th class="platform-header sentinel">Sentinel</th>
                                <th class="platform-header splunk">Splunk</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-clock"></i> WHEN PARSING HAPPENS</td></tr>
                            <tr>
                                <td><strong>Parsing Time</strong></td>
                                <td><strong>Ingest-time</strong><br>Parsing rules run as data arrives<br>Fields stored in dataset</td>
                                <td><strong>Both options:</strong><br>• Ingest-time: DCR transforms<br>• Query-time: ASIM parsers</td>
                                <td><strong>Both options:</strong><br>• Index-time: props/transforms<br>• Search-time: rex, props</td>
                            </tr>
                            <tr>
                                <td><strong>Default Behavior</strong></td>
                                <td>Auto-parse structured formats<br>(CEF, LEEF, JSON, Syslog)</td>
                                <td>Built-in connectors parse<br>Custom needs DCR config</td>
                                <td>Basic parsing by sourcetype<br>TAs add field extraction</td>
                            </tr>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-code"></i> PARSING SYNTAX</td></tr>
                            <tr>
                                <td><strong>Field Extraction</strong></td>
                                <td><strong>XQL in Parsing Rules</strong><br><code>alter field = regextract(_raw_log, "pattern")</code></td>
                                <td><strong>KQL in DCR</strong><br><code>| extend field = extract("pattern", 1, RawData)</code></td>
                                <td><strong>props.conf EXTRACT</strong><br><code>EXTRACT-field = (?&lt;field&gt;\d+)</code></td>
                            </tr>
                            <tr>
                                <td><strong>Timestamp Parsing</strong></td>
                                <td>Parsing rule populates _time<br>Multiple format support</td>
                                <td>TimeGenerated from source<br>or ingestion time</td>
                                <td>TIME_FORMAT in props.conf<br>TIME_PREFIX to locate</td>
                            </tr>
                            <tr>
                                <td><strong>Event Breaking</strong></td>
                                <td>Handled by collector<br>JSON auto-detected</td>
                                <td>Line-based by default<br>Multi-line via DCR</td>
                                <td>LINE_BREAKER in props.conf<br>SHOULD_LINEMERGE</td>
                            </tr>
                        </tbody>
                    </table>
                    <h3>Parsing Examples - Same Log, Three Platforms</h3>
                    <div class="example-scenario">
                        <h4>Scenario: Parse Palo Alto Firewall Traffic Log</h4>
                        <p><strong>Raw Log:</strong></p>
                        <pre><code>Jan 15 10:23:45 fw01 1,2024/01/15 10:23:45,001234567890,TRAFFIC,end,2560,2024/01/15 10:23:45,192.168.1.100,203.0.113.50,0.0.0.0,0.0.0.0,allow-outbound,,,web-browsing,vsys1,trust,untrust,ethernet1/2,ethernet1/1,Log-Forwarding,2024/01/15 10:23:45,12345,1,54321,443,0,0,0x400000,tcp,allow,1500,500,1000,10,2024/01/15 10:23:40,5,any,0</code></pre>
                    </div>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >XSIAM</span>
                            <span class="code-title">Parsing Rule + Data Model Rule</span>
                        </div>
                        <pre><code>// XSIAM Parsing Rule (extracts fields from raw)
[INGEST:VENDOR_PANW_PRODUCT_PAN_FIREWALL]
filter _raw_log ~= "TRAFFIC"
| alter 
    src_ip = arrayindex(regextract(_raw_log, ",(\d+\.\d+\.\d+\.\d+),"), 0),
    dst_ip = arrayindex(regextract(_raw_log, ",\d+\.\d+\.\d+\.\d+,(\d+\.\d+\.\d+\.\d+),"), 0),
    action = arrayindex(regextract(_raw_log, ",(allow|deny),"), 0),
    bytes_sent = to_integer(arrayindex(regextract(_raw_log, ",(\d+),\d+,\d+,\d+,"), 0)),
    app = arrayindex(regextract(_raw_log, ",([^,]+),vsys"), 0);
// Data Model Rule (maps to XDM)
[MODEL:VENDOR_PANW_PRODUCT_PAN_FIREWALL]
call PANW_FIREWALL_TRAFFIC_FIELDS
| alter
    xdm.source.ipv4 = src_ip,
    xdm.target.ipv4 = dst_ip,
    xdm.event.outcome = if(action = "allow", XDM_CONST.OUTCOME_SUCCESS, XDM_CONST.OUTCOME_FAILED),
    xdm.network.application_protocol = app,
    xdm.source.sent_bytes = bytes_sent;</code></pre>
                    </div>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >KQL</span>
                            <span class="code-title">DCR Transformation + ASIM Parser</span>
                        </div>
                        <pre><code>// DCR Transformation (ingest-time)
source
| extend 
    SrcIpAddr = extract(@",(\d+\.\d+\.\d+\.\d+),", 1, RawData),
    DstIpAddr = extract(@",\d+\.\d+\.\d+\.\d+,(\d+\.\d+\.\d+\.\d+),", 1, RawData),
    DvcAction = extract(@",(allow|deny),", 1, RawData),
    SrcBytes = toint(extract(@",(\d+),\d+,\d+,\d+,", 1, RawData)),
    NetworkApplicationProtocol = extract(@",([^,]+),vsys", 1, RawData)
| project-away RawData
// ASIM Network Session Parser (query-time normalization)
_Im_NetworkSession(starttime=ago(1h), srcipaddr_has_any_prefix=dynamic(['192.168.']))
| where EventProduct == "PAN-OS"
| project TimeGenerated, SrcIpAddr, DstIpAddr, DvcAction, SrcBytes</code></pre>
                    </div>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >Splunk</span>
                            <span class="code-title">props.conf + transforms.conf</span>
                        </div>
                        <pre><code># props.conf (on Indexer or HF)
[pan:traffic]
TIME_FORMAT = %Y/%m/%d %H:%M:%S
TIME_PREFIX = ^\w+\s+\d+\s+\d+:\d+:\d+\s+\S+\s+\d+,
MAX_TIMESTAMP_LOOKAHEAD = 30
SHOULD_LINEMERGE = false
TRANSFORMS-pan = pan_traffic_fields
# transforms.conf
[pan_traffic_fields]
REGEX = ,(?P<src_ip>\d+\.\d+\.\d+\.\d+),(?P<dst_ip>\d+\.\d+\.\d+\.\d+),.*?,(?P<action>allow|deny),.*?,(?P<app>[^,]+),vsys
FORMAT = src_ip::$1 dst_ip::$2 action::$3 app::$4
# CIM Mapping (eventtypes.conf + tags.conf)
[eventtype=pan_traffic]
search = sourcetype="pan:traffic"
[pan_traffic]
network = enabled
communicate = enabled
# Field aliases for CIM (props.conf)
FIELDALIAS-src = src_ip AS src
FIELDALIAS-dest = dst_ip AS dest</code></pre>
                    </div>
                </section>
                <!-- Section 3: Normalization Deep Dive -->
                <section class="content-section" id="normalization">
                    <h2><i class="fas fa-sitemap"></i> Normalization Frameworks - XDM vs ASIM vs CIM</h2>
                    <p>Normalization allows you to write a single query that works across all data sources. Each platform has its own schema:</p>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th style="width: 20%;">Aspect</th>
                                <th class="platform-header xsiam">XDM (XSIAM)</th>
                                <th class="platform-header sentinel">ASIM (Sentinel)</th>
                                <th class="platform-header splunk">CIM (Splunk)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Full Name</strong></td>
                                <td>eXtensible Data Model</td>
                                <td>Advanced Security Information Model</td>
                                <td>Common Information Model</td>
                            </tr>
                            <tr>
                                <td><strong>Normalization Time</strong></td>
                                <td><strong>Ingest-time only</strong><br>Data stored normalized</td>
                                <td><strong>Both:</strong><br>• Ingest-time (DCR)<br>• Query-time (parsers)</td>
                                <td><strong>Search-time only</strong><br>Raw data preserved</td>
                            </tr>
                            <tr>
                                <td><strong>Schema Definition</strong></td>
                                <td>Palo Alto defined<br>~200 XDM fields</td>
                                <td>Microsoft defined<br>OCSF-aligned</td>
                                <td>Splunk defined<br>Data model per domain</td>
                            </tr>
                            <tr>
                                <td><strong>Flexibility</strong></td>
                                <td>Fixed schema<br>Custom fields allowed</td>
                                <td>Flexible - choose approach<br>Can keep raw + normalized</td>
                                <td>Most flexible<br>Raw always available</td>
                            </tr>
                        </tbody>
                    </table>
                    <h3>Schema Comparison - Network Session Example</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Concept</th>
                                <th class="platform-header xsiam">XDM Field</th>
                                <th class="platform-header sentinel">ASIM Field</th>
                                <th class="platform-header splunk">CIM Field</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Source IP</td><td>xdm.source.ipv4</td><td>SrcIpAddr</td><td>src</td></tr>
                            <tr><td>Destination IP</td><td>xdm.target.ipv4</td><td>DstIpAddr</td><td>dest</td></tr>
                            <tr><td>Source Port</td><td>xdm.source.port</td><td>SrcPortNumber</td><td>src_port</td></tr>
                            <tr><td>Destination Port</td><td>xdm.target.port</td><td>DstPortNumber</td><td>dest_port</td></tr>
                            <tr><td>Protocol</td><td>xdm.network.ip_protocol</td><td>NetworkProtocol</td><td>protocol</td></tr>
                            <tr><td>Action</td><td>xdm.event.outcome</td><td>DvcAction</td><td>action</td></tr>
                            <tr><td>Bytes Sent</td><td>xdm.source.sent_bytes</td><td>SrcBytes</td><td>bytes_out</td></tr>
                            <tr><td>User</td><td>xdm.source.user.username</td><td>SrcUsername</td><td>user</td></tr>
                            <tr><td>Application</td><td>xdm.network.application_protocol</td><td>NetworkApplicationProtocol</td><td>app</td></tr>
                            <tr><td>Device Vendor</td><td>xdm.observer.vendor</td><td>EventVendor</td><td>vendor_product</td></tr>
                        </tbody>
                    </table>
                    <h3>Querying Normalized Data</h3>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >XQL</span>
                            <span class="code-title">Query all firewall data via XDM</span>
                        </div>
                        <pre><code>// Works across Palo Alto, Fortinet, Cisco, Check Point - all normalized to XDM
datamodel
| filter xdm.event.type = ENUM.NETWORK
| filter xdm.event.outcome = XDM_CONST.OUTCOME_FAILED  // Blocked connections
| comp count() as blocked_count by xdm.source.ipv4, xdm.target.ipv4
| sort desc blocked_count
| limit 100</code></pre>
                    </div>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >KQL</span>
                            <span class="code-title">Query all firewall data via ASIM</span>
                        </div>
                        <pre><code>// ASIM unifying parser - works across all onboarded firewalls
_Im_NetworkSession
| where DvcAction == "Deny"
| summarize BlockedCount = count() by SrcIpAddr, DstIpAddr
| sort by BlockedCount desc
| take 100
// Can also call source-specific parser for single vendor
_ASim_NetworkSession_PaloAltoNetworks
| where TimeGenerated > ago(1h)</code></pre>
                    </div>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >SPL</span>
                            <span class="code-title">Query all firewall data via CIM</span>
                        </div>
                        <pre><code>// CIM-compliant search using data model
| tstats count as blocked_count from datamodel=Network_Traffic 
  where All_Traffic.action=blocked 
  by All_Traffic.src, All_Traffic.dest
| sort -blocked_count
| head 100
// Or using tag-based search
index=* tag=network tag=communicate action=blocked
| stats count by src, dest
| sort -count</code></pre>
                    </div>
                </section>
                <!-- Section 4: Deployment & Management -->
                <section class="content-section" id="deployment">
                    <h2><i class="fas fa-server"></i> Deployment & Configuration Management</h2>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th style="width: 20%;">Management Aspect</th>
                                <th class="platform-header xsiam">XSIAM</th>
                                <th class="platform-header sentinel">Sentinel</th>
                                <th class="platform-header splunk">Splunk</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-cogs"></i> CENTRALIZED MANAGEMENT</td></tr>
                            <tr>
                                <td><strong>Config Management</strong></td>
                                <td><strong>XSIAM Console</strong><br>• Cloud-based<br>• Agent policies<br>• Data source configs</td>
                                <td><strong>DCR + Azure Policy</strong><br>• DCR defines collection<br>• Azure Policy deploys<br>• ARM templates for IaC</td>
                                <td><strong>Deployment Server</strong><br>• Pushes apps to forwarders<br>• Server classes<br>• Centralized props/transforms</td>
                            </tr>
                            <tr>
                                <td><strong>Agent Deployment</strong></td>
                                <td>• XSIAM console packages<br>• SCCM/Intune integration<br>• Broker VM installation</td>
                                <td>• Azure Policy auto-install<br>• Azure Arc for on-prem<br>• DCR auto-associates</td>
                                <td>• Deployment server apps<br>• Ansible/Puppet<br>• SCCM packages</td>
                            </tr>
                            <tr>
                                <td><strong>Scale Management</strong></td>
                                <td>Cloud-native, auto-scales</td>
                                <td>Cloud-native, auto-scales<br>Workspace-level control</td>
                                <td>Indexer cluster<br>Search head cluster<br>Manual scaling</td>
                            </tr>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-file-code"></i> CONFIGURATION FILES</td></tr>
                            <tr>
                                <td><strong>Key Config Files</strong></td>
                                <td>• Parsing Rules (YAML)<br>• Data Model Rules (YAML)<br>• Correlation Rules (UI/YAML)</td>
                                <td>• DCR (JSON/ARM)<br>• Analytics Rules (JSON/YAML)<br>• Watchlists (CSV/JSON)</td>
                                <td>• inputs.conf<br>• props.conf<br>• transforms.conf<br>• outputs.conf<br>• serverclass.conf</td>
                            </tr>
                            <tr>
                                <td><strong>Where Configs Live</strong></td>
                                <td>Cloud platform<br>Marketplace content packs</td>
                                <td>Azure Resource Manager<br>Content Hub solutions</td>
                                <td>$SPLUNK_HOME/etc/apps/<br>Deployment apps</td>
                            </tr>
                        </tbody>
                    </table>
                    <h3>Configuration Examples</h3>
                    <div class="deep-dive">
                        <h4 style="color: #0078d4;">Sentinel: DCR Configuration (JSON)</h4>
                        <pre><code>{
  "properties": {
    "dataSources": {
      "windowsEventLogs": [{
        "name": "SecurityEvents",
        "streams": ["Microsoft-SecurityEvent"],
        "xPathQueries": [
          "Security!*[System[(EventID=4624 or EventID=4625 or EventID=4648)]]",
          "Security!*[System[(EventID=4720 or EventID=4722 or EventID=4723)]]"
        ]
      }],
      "syslog": [{
        "name": "AuthLogs",
        "streams": ["Microsoft-Syslog"],
        "facilityNames": ["auth", "authpriv"],
        "logLevels": ["Warning", "Error", "Critical", "Alert", "Emergency"]
      }]
    },
    "destinations": {
      "logAnalytics": [{
        "workspaceResourceId": "/subscriptions/.../workspaces/SentinelWorkspace",
        "name": "SecurityWorkspace"
      }]
    },
    "dataFlows": [{
      "streams": ["Microsoft-SecurityEvent", "Microsoft-Syslog"],
      "destinations": ["SecurityWorkspace"],
      "transformKql": "source | where EventID != 4688 or NewProcessName !contains 'svchost'"
    }]
  }
}</code></pre>
                        <p><strong>Key Points:</strong> DCR controls what events to collect (XPath), which facilities/severities (syslog), and transformations (KQL) before storage.</p>
                    </div>
                    <div class="deep-dive">
                        <h4 style="color: #65a637;">Splunk: Deployment Server Configuration</h4>
                        <pre><code># serverclass.conf (on Deployment Server)
[serverClass:Windows_Security]
whitelist.0 = *.corp.local
machineTypesFilter = windows-x64
[serverClass:Windows_Security:app:Splunk_TA_windows]
restartSplunkWeb = false
restartSplunkd = true
[serverClass:Linux_Servers]
whitelist.0 = linux-*
machineTypesFilter = linux-x64
[serverClass:Linux_Servers:app:Splunk_TA_nix]
# inputs.conf (in deployment app for Windows)
[WinEventLog://Security]
disabled = 0
index = wineventlog
evt_resolve_ad_obj = 1
checkpointInterval = 5
# props.conf (on Indexer - index-time parsing)
[WinEventLog:Security]
TIME_FORMAT = %m/%d/%Y %I:%M:%S %p
TZ = UTC
SHOULD_LINEMERGE = false
TRANSFORMS-setnull = setnull
# transforms.conf (on Indexer - drop EventCode 4688 with svchost)
[setnull]
REGEX = EventCode=4688.*NewProcessName.*svchost
DEST_KEY = queue
FORMAT = nullQueue</code></pre>
                        <p><strong>Key Points:</strong> Deployment Server pushes apps to forwarder classes. props.conf/transforms.conf on indexer handle parsing and filtering.</p>
                    </div>
                </section>
                <!-- Section 5: Built-in vs Custom Parsers -->
                <section class="content-section" id="builtin-parsers">
                    <h2><i class="fas fa-puzzle-piece"></i> Built-in vs Custom Parsers</h2>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th style="width: 18%;">Parser Type</th>
                                <th class="platform-header xsiam">XSIAM</th>
                                <th class="platform-header sentinel">Sentinel</th>
                                <th class="platform-header splunk">Splunk</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-box"></i> BUILT-IN PARSERS</td></tr>
                            <tr>
                                <td><strong>Where to Find</strong></td>
                                <td><strong>Marketplace</strong><br>800+ content packs<br>Auto-parsing for CEF/LEEF/JSON</td>
                                <td><strong>Content Hub</strong><br>300+ solutions<br>Built-in ASIM parsers</td>
                                <td><strong>Splunkbase</strong><br>2,500+ TAs<br>CIM-compliant add-ons</td>
                            </tr>
                            <tr>
                                <td><strong>Examples</strong></td>
                                <td>• Palo Alto NGFW<br>• CrowdStrike Falcon<br>• Okta<br>• AWS CloudTrail<br>• Microsoft O365</td>
                                <td>• Microsoft Defender<br>• Azure Firewall<br>• Palo Alto (via CEF)<br>• Cisco ASA<br>• AWS (via function)</td>
                                <td>• Splunk_TA_windows<br>• Splunk_TA_paloalto<br>• Splunk_TA_cisco<br>• TA-crowdstrike<br>• Splunk_TA_aws</td>
                            </tr>
                            <tr>
                                <td><strong>Installation</strong></td>
                                <td>Install from Marketplace<br>Auto-enables parsing rules</td>
                                <td>Install from Content Hub<br>Deploy data connector</td>
                                <td>Download from Splunkbase<br>Deploy via Deployment Server</td>
                            </tr>
                            <tr class="feature-category"><td colspan="4"><i class="fas fa-wrench"></i> CUSTOM PARSERS</td></tr>
                            <tr>
                                <td><strong>When Needed</strong></td>
                                <td>• Custom application logs<br>• Unsupported vendors<br>• Non-standard formats</td>
                                <td>• Custom applications<br>• Unsupported sources<br>• Special transformations</td>
                                <td>• Custom sourcetypes<br>• Vendor without TA<br>• Unique log formats</td>
                            </tr>
                            <tr>
                                <td><strong>Creation Method</strong></td>
                                <td><strong>Parsing Rule + Data Model Rule</strong><br>XQL-based extraction<br>Map to XDM schema</td>
                                <td><strong>DCR + Custom Parser</strong><br>KQL transformation<br>Custom table or ASIM</td>
                                <td><strong>props.conf + transforms.conf</strong><br>Regex extraction<br>Field aliases for CIM</td>
                            </tr>
                        </tbody>
                    </table>
                    <h3>Custom Parser Example - In-House Application Logs</h3>
                    <div class="example-scenario">
                        <h4>Scenario: Parse custom authentication log from in-house app</h4>
                        <p><strong>Raw Log Format:</strong></p>
                        <pre><code>2025-01-15T10:23:45.123Z|AUTH|SUCCESS|user=jsmith|src_ip=192.168.1.50|method=password|session_id=abc123
2025-01-15T10:23:46.456Z|AUTH|FAILED|user=badactor|src_ip=203.0.113.10|method=password|reason=invalid_password</code></pre>
                    </div>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >XSIAM</span>
                            <span class="code-title">Custom Parsing Rule</span>
                        </div>
                        <pre><code>// Step 1: Create dataset for custom app (in data sources config)
// vendor=CUSTOM, product=MYAPP, format=Auto
// Step 2: Parsing Rule
[INGEST:VENDOR_CUSTOM_PRODUCT_MYAPP]
filter _raw_log ~= "\|AUTH\|"
| alter
    _time = parse_timestamp("%Y-%m-%dT%H:%M:%E*S%Ez", arrayindex(split(_raw_log, "|"), 0)),
    event_type = arrayindex(split(_raw_log, "|"), 1),
    outcome = arrayindex(split(_raw_log, "|"), 2),
    username = arrayindex(regextract(_raw_log, "user=([^\|]+)"), 0),
    source_ip = arrayindex(regextract(_raw_log, "src_ip=([^\|]+)"), 0),
    auth_method = arrayindex(regextract(_raw_log, "method=([^\|]+)"), 0),
    failure_reason = arrayindex(regextract(_raw_log, "reason=([^\|]+)"), 0);
// Step 3: Data Model Rule (map to XDM)
[MODEL:VENDOR_CUSTOM_PRODUCT_MYAPP]
filter event_type = "AUTH"
| alter
    xdm.event.type = ENUM.AUTHENTICATION,
    xdm.event.outcome = if(outcome = "SUCCESS", XDM_CONST.OUTCOME_SUCCESS, XDM_CONST.OUTCOME_FAILED),
    xdm.source.user.username = username,
    xdm.source.ipv4 = source_ip,
    xdm.auth.auth_method = auth_method,
    xdm.event.outcome_reason = failure_reason;</code></pre>
                    </div>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >Sentinel</span>
                            <span class="code-title">DCR + Custom Table</span>
                        </div>
                        <pre><code>// Step 1: Create Custom Table (via Azure Portal or API)
// Table name: CustomApp_Auth_CL
// Step 2: DCR with Transformation
{
  "dataFlows": [{
    "streams": ["Custom-CustomApp_Auth_CL"],
    "destinations": ["SecurityWorkspace"],
    "transformKql": "source 
      | extend Parts = split(RawData, '|')
      | extend 
          TimeGenerated = todatetime(Parts[0]),
          EventType = tostring(Parts[1]),
          Outcome = tostring(Parts[2]),
          Username = extract('user=([^|]+)', 1, RawData),
          SourceIP = extract('src_ip=([^|]+)', 1, RawData),
          AuthMethod = extract('method=([^|]+)', 1, RawData),
          FailureReason = extract('reason=([^|]+)', 1, RawData)
      | project-away RawData, Parts"
  }]
}
// Step 3: Custom ASIM Parser (optional - for normalized queries)
let CustomApp_Auth_Parser = (starttime:datetime=datetime(null)) {
    CustomApp_Auth_CL
    | where isnull(starttime) or TimeGenerated >= starttime
    | extend
        EventType = "Logon",
        EventResult = iff(Outcome == "SUCCESS", "Success", "Failure"),
        TargetUsername = Username,
        SrcIpAddr = SourceIP
};</code></pre>
                    </div>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang" >Splunk</span>
                            <span class="code-title">props.conf + transforms.conf + CIM mapping</span>
                        </div>
                        <pre><code># inputs.conf (on forwarder)
[monitor:///var/log/myapp/auth.log]
sourcetype = myapp:auth
index = security
# props.conf (on indexer)
[myapp:auth]
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N%Z
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 30
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
# Field extractions
EXTRACT-fields = ^[^\|]+\|(?P<event_type>[^\|]+)\|(?P<outcome>[^\|]+)\|user=(?P<user>[^\|]+)\|src_ip=(?P<src_ip>[^\|]+)\|method=(?P<auth_method>[^\|]+)
EXTRACT-failure = reason=(?P<failure_reason>[^\|]+)
# CIM field aliases
FIELDALIAS-user = user AS src_user
FIELDALIAS-src = src_ip AS src
FIELDALIAS-action = outcome AS action
# eventtypes.conf
[myapp_auth]
search = sourcetype="myapp:auth"
# tags.conf
[eventtype=myapp_auth]
authentication = enabled
default = enabled</code></pre>
                    </div>
                </section>
                <!-- Section 6: Real-World Examples -->
                <section class="content-section" id="examples">
                    <h2><i class="fas fa-building"></i> Real-World Deployment Examples</h2>
                    <div class="example-scenario">
                        <h4>Example 1: Collecting Windows Security Events</h4>
                        <table class="comparison-table">
                            <tr>
                                <th style="width: 15%;">Step</th>
                                <th class="platform-header xsiam">XSIAM</th>
                                <th class="platform-header sentinel">Sentinel</th>
                                <th class="platform-header splunk">Splunk</th>
                            </tr>
                            <tr>
                                <td><strong>1. Agent</strong></td>
                                <td>Install Cortex XDR Agent</td>
                                <td>Install AMA (or via Azure Arc)</td>
                                <td>Install Universal Forwarder</td>
                            </tr>
                            <tr>
                                <td><strong>2. Configure</strong></td>
                                <td>Enable Windows Event collection in agent policy</td>
                                <td>Create DCR with XPath queries for specific EventIDs</td>
                                <td>Deploy inputs.conf via Deployment Server</td>
                            </tr>
                            <tr>
                                <td><strong>3. Filter</strong></td>
                                <td>Dataset rules to filter noise</td>
                                <td>DCR transformKql to project-away or filter</td>
                                <td>transforms.conf to null queue unwanted events</td>
                            </tr>
                            <tr>
                                <td><strong>4. Normalize</strong></td>
                                <td>Auto-mapped to XDM</td>
                                <td>Built-in to SecurityEvent table + ASIM</td>
                                <td>Splunk_TA_windows provides CIM mapping</td>
                            </tr>
                            <tr>
                                <td><strong>5. Query</strong></td>
                                <td><code>datamodel | filter xdm.event.type = AUTH</code></td>
                                <td><code>SecurityEvent | where EventID == 4625</code></td>
                                <td><code>index=wineventlog EventCode=4625</code></td>
                            </tr>
                        </table>
                    </div>
                    <div class="example-scenario">
                        <h4>Example 2: Collecting Firewall Logs via Syslog</h4>
                        <table class="comparison-table">
                            <tr>
                                <th style="width: 15%;">Step</th>
                                <th class="platform-header xsiam">XSIAM</th>
                                <th class="platform-header sentinel">Sentinel</th>
                                <th class="platform-header splunk">Splunk</th>
                            </tr>
                            <tr>
                                <td><strong>1. Collector</strong></td>
                                <td>Deploy Broker VM<br>Enable Syslog Collector applet</td>
                                <td>Deploy Linux VM<br>Install AMA<br>Configure rsyslog</td>
                                <td>Deploy Heavy Forwarder<br>Configure syslog input</td>
                            </tr>
                            <tr>
                                <td><strong>2. Firewall Config</strong></td>
                                <td>Point syslog to Broker VM IP:514</td>
                                <td>Point syslog to Linux VM IP:514</td>
                                <td>Point syslog to HF IP:514</td>
                            </tr>
                            <tr>
                                <td><strong>3. Format</strong></td>
                                <td>CEF recommended (auto-parsed)</td>
                                <td>CEF → CommonSecurityLog<br>or raw syslog</td>
                                <td>CEF or vendor-native<br>TA handles parsing</td>
                            </tr>
                            <tr>
                                <td><strong>4. Parser</strong></td>
                                <td>Install vendor content pack from Marketplace</td>
                                <td>Install solution from Content Hub<br>or use built-in CEF</td>
                                <td>Install TA from Splunkbase<br>Deploy to HF and Indexer</td>
                            </tr>
                            <tr>
                                <td><strong>5. Normalize</strong></td>
                                <td>Data Model Rule maps to XDM</td>
                                <td>ASIM NetworkSession parser</td>
                                <td>TA provides CIM Network_Traffic</td>
                            </tr>
                        </table>
                    </div>
                    <div class="example-scenario">
                        <h4>Example 3: Collecting Cloud Logs (AWS CloudTrail)</h4>
                        <table class="comparison-table">
                            <tr>
                                <th style="width: 15%;">Step</th>
                                <th class="platform-header xsiam">XSIAM</th>
                                <th class="platform-header sentinel">Sentinel</th>
                                <th class="platform-header splunk">Splunk</th>
                            </tr>
                            <tr>
                                <td><strong>1. AWS Setup</strong></td>
                                <td>CloudTrail → S3<br>IAM role for XSIAM</td>
                                <td>CloudTrail → S3<br>or EventBridge → Function</td>
                                <td>CloudTrail → S3<br>or Kinesis Firehose</td>
                            </tr>
                            <tr>
                                <td><strong>2. Connection</strong></td>
                                <td>Data Sources → AWS<br>Configure S3 bucket access</td>
                                <td>Content Hub → AWS solution<br>Deploy Azure Function</td>
                                <td>Splunk Add-on for AWS<br>Configure on HF or SH</td>
                            </tr>
                            <tr>
                                <td><strong>3. Polling</strong></td>
                                <td>XSIAM polls S3 bucket</td>
                                <td>Function polls S3 or receives events</td>
                                <td>Modular input polls SQS/S3</td>
                            </tr>
                            <tr>
                                <td><strong>4. Parser</strong></td>
                                <td>AWS content pack parses JSON</td>
                                <td>AWSCloudTrail table (built-in)</td>
                                <td>Splunk_TA_aws parses to sourcetype</td>
                            </tr>
                            <tr>
                                <td><strong>5. Query</strong></td>
                                <td><code>dataset = aws_cloudtrail_raw</code></td>
                                <td><code>AWSCloudTrail | where EventName == "ConsoleLogin"</code></td>
                                <td><code>sourcetype=aws:cloudtrail eventName=ConsoleLogin</code></td>
                            </tr>
                        </table>
                    </div>
                </section>
                <!-- Section 7: Automation -->
                <section class="content-section" id="automation">
                    <h2><i class="fas fa-robot"></i> Automation & SOAR Comparison</h2>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th style="width: 18%;">Automation Aspect</th>
                                <th class="platform-header xsiam">XSIAM (XSOAR)</th>
                                <th class="platform-header sentinel">Sentinel (Logic Apps)</th>
                                <th class="platform-header splunk">Splunk SOAR</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SOAR Platform</strong></td>
                                <td>XSOAR built-in</td>
                                <td>Azure Logic Apps</td>
                                <td>Splunk SOAR (Phantom)</td>
                            </tr>
                            <tr>
                                <td><strong>Playbook Creation</strong></td>
                                <td>Visual + Python/YAML</td>
                                <td>Visual Logic Apps Designer</td>
                                <td>Visual + Python</td>
                            </tr>
                            <tr>
                                <td><strong>Integrations</strong></td>
                                <td>800+ content packs</td>
                                <td>500+ Logic Apps connectors</td>
                                <td>300+ Phantom apps</td>
                            </tr>
                            <tr>
                                <td><strong>Trigger Types</strong></td>
                                <td>• Alert/Incident<br>• Schedule<br>• Manual<br>• API webhook</td>
                                <td>• Automation Rule<br>• Manual<br>• Scheduled<br>• HTTP webhook</td>
                                <td>• Notable event<br>• Container<br>• Scheduled<br>• API webhook</td>
                            </tr>
                            <tr>
                                <td><strong>Case Management</strong></td>
                                <td>Built-in War Room<br>Incident timeline</td>
                                <td>Incidents in Defender portal<br>Tasks & evidence</td>
                                <td>Notable events<br>Mission Control</td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                <!-- Interview Preparation -->
                <section class="content-section interview-section" id="interview">
                    <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                    <div class="qa-section">
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Compare the data ingestion approaches between XSIAM, Sentinel, and Splunk. When would you choose each?</button>
                            <div class="qa-answer">
                                <p>Each platform takes a fundamentally different approach to getting data in, and understanding these differences is crucial for architecture decisions. The choice often depends on your existing infrastructure and where your data sources live.</p>
                                
                                <p>XSIAM's approach centers on the Broker VM for on-premises collection and native cloud integrations. The strength is simplicity - you deploy Broker VMs to receive syslog/CEF, and everything else is configured in the cloud console. The XDR agent handles endpoint telemetry natively. The limitation is flexibility; you're constrained to Palo Alto's supported methods and can't do complex routing or transformation at the collection layer like you can with Splunk's Heavy Forwarders.</p>
                                
                                <p>Sentinel's architecture uses Azure Monitor Agent (AMA) with Data Collection Rules (DCRs). The DCR model is powerful once you understand it - you define what to collect, how to transform it, and where to send it all in one configuration. For Azure-native workloads, ingestion is almost zero-effort with Diagnostic Settings. The complexity comes with hybrid environments where you need Azure Arc to manage on-premises machines and Azure Functions for custom API polling.</p>
                                
                                <p>Splunk offers the most flexibility with its tiered forwarder architecture. Universal Forwarders are lightweight agents that send raw data, while Heavy Forwarders can do complex processing, routing, and API polling. This flexibility is both strength and weakness - you can do almost anything, but you also have to manage more infrastructure. For organizations with diverse data sources and complex routing needs, Splunk's approach scales well.</p>
                                
                                <p>My recommendation: If you're greenfield and cloud-native, Sentinel's integration with Azure is compelling. If you need an integrated XDR/SIEM/SOAR platform, XSIAM reduces operational complexity. If you have complex on-premises infrastructure and need maximum flexibility, Splunk's mature forwarder ecosystem handles edge cases better than the alternatives.</p>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Explain the differences between XDM, ASIM, and CIM for data normalization. How does this affect detection rule portability?</button>
                            <div class="qa-answer">
                                <p>Data normalization is fundamental to effective detection because it lets you write rules that work across multiple data sources. Each platform takes a different approach to when and how normalization happens, which significantly impacts rule development and portability.</p>
                                
                                <p>XSIAM's XDM (XDR Data Model) normalizes at ingest time. When data comes in, parsing rules map source-specific fields to standardized XDM fields like xdm.source.ipv4, xdm.target.user.username, etc. Detection rules query XDM fields directly, so a single rule like "failed login from multiple sources" works across Active Directory, Linux auth, and cloud IAM without modification. The trade-off is you need proper parsing rules for each source, and if parsing is wrong, it's wrong permanently in storage.</p>
                                
                                <p>Sentinel's ASIM (Advanced Security Information Model) provides both options. You can normalize at ingest using DCR transformations, or use query-time ASIM parsers that normalize data when you search it. The query-time approach is flexible - you can fix parsing issues without re-ingesting data - but it adds query complexity and performance overhead. Most organizations use a hybrid: ingest-time normalization for high-volume sources and query-time parsers for less critical data.</p>
                                
                                <p>Splunk's CIM (Common Information Model) is primarily search-time normalization. Technology Add-ons (TAs) define field aliases and calculated fields that map source-specific fields to CIM fields when you search. This means raw data stays raw, and you can update normalization without re-indexing. The downside is every CIM-compliant search needs to run the normalization logic, which can impact performance on large datasets.</p>
                                
                                <p>For detection rule portability: XDM rules are the most portable within XSIAM since everything is pre-normalized. Moving rules between platforms requires translation - XQL to KQL to SPL isn't just syntax; the underlying data models differ. ASIM and CIM share some concepts, but XDM's structure is quite different. In practice, expect to rewrite 30-40% of rule logic when migrating between platforms, even after field mapping.</p>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do the SOAR capabilities compare between XSIAM's XSOAR, Sentinel's Logic Apps, and Splunk SOAR?</button>
                            <div class="qa-answer">
                                <p>SOAR is where these platforms diverge most significantly. XSIAM has XSOAR built-in, Sentinel leverages Azure Logic Apps, and Splunk has Splunk SOAR (formerly Phantom) as a separate product. Each approach has distinct advantages and limitations.</p>
                                
                                <p>XSOAR in XSIAM is the most integrated SOAR experience. Playbooks trigger automatically from incidents, results feed back into the incident timeline, and the War Room provides real-time collaboration. The visual playbook builder supports both drag-and-drop and Python/YAML for complex logic. With 800+ content packs in the Marketplace, most common integrations are available out-of-the-box. The limitation is it's tightly coupled to XSIAM - you can't easily use XSOAR with data from other SIEMs.</p>
                                
                                <p>Sentinel uses Azure Logic Apps for automation, which means you get access to the entire Azure ecosystem - 500+ connectors covering both security and business applications. Logic Apps are event-driven and can be triggered by analytics rules, incidents, or external webhooks. The visual designer is intuitive, and you can escalate to Azure Functions for complex Python/C# logic. The downside is Logic Apps weren't designed specifically for security operations, so some security-specific features feel bolted on. Also, each Logic App run has costs that can add up at scale.</p>
                                
                                <p>Splunk SOAR is the most mature dedicated SOAR platform. Its lineage as Phantom means it was built specifically for security orchestration. The playbook editor is powerful, Python apps provide unlimited extensibility, and case management is robust. The challenge is it's a separate product that needs integration with Splunk Enterprise - not native like XSOAR to XSIAM. This means additional infrastructure, licensing, and integration maintenance.</p>
                                
                                <p>For organizations choosing: If you're on XSIAM, the built-in XSOAR is the obvious choice - it just works. For Sentinel, Logic Apps are sufficient for most use cases, but consider third-party SOAR if you need advanced case management. For Splunk, SOAR is essential for automation but budget for the additional licensing and infrastructure. All three can achieve similar outcomes; the difference is operational complexity and total cost of ownership.</p>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: You're advising a company on SIEM platform selection. What questions would you ask, and how would each platform's strengths align with different answers?</button>
                            <div class="qa-answer">
                                <p>Platform selection should be driven by organizational context, not just feature comparisons. I'd start with questions about existing infrastructure, team capabilities, and strategic direction.</p>
                                
                                <p>First question: Where does your data live? If heavily Azure-based with M365, Azure AD, and Azure workloads, Sentinel's native integration is compelling - you're literally clicking buttons to enable data collection rather than deploying agents and forwarders. If you have significant on-premises infrastructure or multi-cloud, Splunk's mature collection ecosystem or XSIAM's Broker VM model handles hybrid better. For organizations already invested in Palo Alto firewalls and Cortex XDR, XSIAM consolidates licensing and provides tight integration.</p>
                                
                                <p>Second question: What are your team's skills? A team fluent in Python and comfortable managing infrastructure will thrive with Splunk's flexibility. A team stronger in Azure and PowerShell will be productive faster with Sentinel. XSIAM suits teams that want a managed platform with less infrastructure overhead. Training time matters - picking a platform that aligns with existing skills reduces time to value.</p>
                                
                                <p>Third question: What's your automation maturity? If you're just starting with SOAR, XSIAM's built-in XSOAR or Sentinel's Logic Apps provide low-friction starting points. If you have complex automation requirements and dedicated SOAR engineers, Splunk SOAR's depth might justify the additional complexity. Consider not just today's needs but where you want to be in 2-3 years.</p>
                                
                                <p>Fourth question: What's your budget model? XSIAM licenses by ingestion volume (GB/day). Sentinel charges per GB ingested with tiered pricing and commitment discounts. Splunk has multiple models including workload-based pricing. Each model favors different scenarios - high-volume/low-query environments might favor one platform while low-volume/high-query favors another. Total cost includes licensing, infrastructure, and personnel - don't just compare list prices.</p>
                            </div>
                        </div>
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Describe the process of migrating from one of these platforms to another. What are the major challenges?</button>
                            <div class="qa-answer">
                                <p>Platform migrations are among the most complex security projects because you're changing the foundation while keeping detection active. I approach migrations as multi-phase projects spanning 6-18 months depending on environment complexity.</p>
                                
                                <p>The first challenge is data source parity. You need to map every data source from the legacy platform to the new one. This sounds straightforward but gets complex quickly. Your legacy Splunk might have custom TAs for internal applications. Your legacy Sentinel might use deprecated connectors. Expect 70% of sources to have direct equivalents, 20% to require custom development, and 10% to need architectural changes. Start this inventory early.</p>
                                
                                <p>Detection rule migration is where most organizations underestimate effort. It's not just translating SPL to XQL or KQL - the underlying data models differ, field names change, and logic that worked on one platform may not be valid on another. I've seen organizations try automated translation tools and end up with rules that syntactically work but miss detections or create false positives. Budget for manual review and testing of every high-fidelity rule.</p>
                                
                                <p>Operational transition is the most visible challenge. Analysts need training on new interfaces and query languages. Playbooks need recreation. Integrations need reconfiguration. I recommend parallel operation for 30-90 days minimum - run both platforms, compare alert fidelity, let analysts get comfortable. Yes, this means paying for both platforms temporarily, but it's far less costly than a detection gap during cutover.</p>
                                
                                <p>The often-overlooked challenge is historical data. Compliance requirements may mandate keeping years of security logs accessible. Your new platform can't query the old platform's storage. Options include: maintaining read-only access to legacy platform, exporting historical data to a data lake queryable by both platforms, or accepting that historical data requires switching contexts. Plan this early because it affects architecture decisions.</p>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Quick Reference Summary -->
                <section class="content-section interview-section">
                    <h2><i class="fas fa-flag-checkered"></i> Quick Reference Summary</h2>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Aspect</th>
                                <th class="platform-header xsiam">XSIAM</th>
                                <th class="platform-header sentinel">Sentinel</th>
                                <th class="platform-header splunk">Splunk</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Agent</strong></td><td>XDR Agent + XDR Collector</td><td>AMA (Azure Monitor Agent)</td><td>UF + HF</td></tr>
                            <tr><td><strong>Syslog Collector</strong></td><td>Broker VM</td><td>Linux VM + AMA</td><td>Heavy Forwarder</td></tr>
                            <tr><td><strong>Config Management</strong></td><td>Cloud console + Marketplace</td><td>DCR + Azure Policy</td><td>Deployment Server</td></tr>
                            <tr><td><strong>Parsing Config</strong></td><td>Parsing Rules (XQL)</td><td>DCR transformKql (KQL)</td><td>props.conf/transforms.conf</td></tr>
                            <tr><td><strong>Normalization</strong></td><td>XDM (ingest-time)</td><td>ASIM (both options)</td><td>CIM (search-time)</td></tr>
                            <tr><td><strong>Built-in Content</strong></td><td>Marketplace (800+)</td><td>Content Hub (300+)</td><td>Splunkbase (2500+)</td></tr>
                            <tr><td><strong>API Ingestion</strong></td><td>HTTP Log Collector</td><td>Logs Ingestion API + DCE</td><td>HEC</td></tr>
                            <tr><td><strong>SOAR</strong></td><td>XSOAR built-in</td><td>Logic Apps</td><td>Splunk SOAR</td></tr>
                        </tbody>
                    </table>
                </section>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>