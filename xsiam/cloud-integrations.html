<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Integrations | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
                    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link active"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>



        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Cloud Integrations</span>
                </div>

                <h1><i class="fas fa-cloud"></i> Cloud Integrations</h1>
                <p class="lead">Integrating XSIAM with AWS, Azure, and GCP for comprehensive cloud security monitoring, including CloudTrail, Azure Activity Logs, and GCP Audit Logs.</p>

                <h2><i class="fas fa-layer-group"></i> Cloud Integration Overview</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-cloud-upload-alt"></i> Multi-Cloud Integration Architecture</div>
<pre style="color: #8b949e; font-size: 0.8rem; line-height: 1.6; overflow-x: auto;">
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    CLOUD INTEGRATIONS                                            │
├─────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                  │
│   ┌───────────────────────┐   ┌───────────────────────┐   ┌───────────────────────┐            │
│   │         AWS           │   │        AZURE          │   │         GCP           │            │
│   ├───────────────────────┤   ├───────────────────────┤   ├───────────────────────┤            │
│   │ • CloudTrail          │   │ • Activity Logs       │   │ • Audit Logs          │            │
│   │ • GuardDuty           │   │ • Entra ID Logs       │   │ • Cloud Logging       │            │
│   │ • Security Hub        │   │ • Defender for Cloud  │   │ • Security Command    │            │
│   │ • VPC Flow Logs       │   │ • NSG Flow Logs       │   │ • VPC Flow Logs       │            │
│   │ • WAF Logs            │   │ • WAF Logs            │   │ • Cloud Armor         │            │
│   │ • S3 Access Logs      │   │ • Storage Analytics   │   │ • Cloud Storage       │            │
│   └───────────┬───────────┘   └───────────┬───────────┘   └───────────┬───────────┘            │
│               │                           │                           │                         │
│               │         API / Event Hub / Pub/Sub                     │                         │
│               └───────────────────────────┼───────────────────────────┘                         │
│                                           │                                                      │
│                                           ▼                                                      │
│                           ┌───────────────────────────────┐                                     │
│                           │           XSIAM               │                                     │
│                           │   Cloud Security Analytics    │                                     │
│                           │   • Unified cloud visibility  │                                     │
│                           │   • Cross-cloud correlation   │                                     │
│                           │   • Cloud-native detection    │                                     │
│                           └───────────────────────────────┘                                     │
│                                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
                </div>

                <h2><i class="fas fa-code-branch"></i> Cloud Integration Decision Tree</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>Which cloud provider needs integration?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ AWS</div>
                            <div class="decision-node question">
                                <strong>Log volume expectation?</strong>
                            </div>
                            <div class="decision-branch">
                                <div>
                                    <div class="decision-arrow">↓ High (>10K EPS)</div>
                                    <div class="decision-node yes" style="background: #1a4d2e;">
                                        <strong style="color: #3fb950;">S3 + SQS Streaming</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">CloudTrail → S3 → SQS → XSIAM<br>Most reliable for high volume</div>
                                    </div>
                                </div>
                                <div>
                                    <div class="decision-arrow">↓ Low-Medium</div>
                                    <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                        <strong style="color: #58a6ff;">Direct API Integration</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">Simpler setup<br>XSIAM polls AWS APIs</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Azure</div>
                            <div class="decision-node question">
                                <strong>Which logs are priority?</strong>
                            </div>
                            <div class="decision-branch">
                                <div>
                                    <div class="decision-arrow">↓ Identity (Entra ID)</div>
                                    <div class="decision-node yes" style="background: #1a4d2e;">
                                        <strong style="color: #3fb950;">Graph API + Event Hub</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">Sign-in + Audit logs<br>Risk detections included</div>
                                    </div>
                                </div>
                                <div>
                                    <div class="decision-arrow">↓ Activity/Resource</div>
                                    <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                        <strong style="color: #58a6ff;">Event Hub Streaming</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">Diagnostic settings<br>All Azure resources</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ GCP</div>
                            <div class="decision-node yes" style="background: #1a4d2e;">
                                <strong style="color: #3fb950;">Pub/Sub Export</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Log sink → Pub/Sub → XSIAM<br>Standard pattern for all GCP</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Multi-Cloud</div>
                            <div class="decision-node" style="background: #3d2a5e; border-color: #a371f7;">
                                <strong style="color: #a371f7;">Unified Collection Strategy</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Configure each cloud separately<br>Normalize to common XDM schema</div>
                            </div>
                        </div>
                    </div>
                </div>

                <h2><i class="fab fa-aws"></i> AWS Integration</h2>
                
                <div class="config-section">
                    <h4>AWS CloudTrail Configuration</h4>
                    <div class="arch-diagram"># AWS CloudTrail Integration Setup
# ═══════════════════════════════════════════════════════════════

## Step 1: Create IAM Role for XSIAM
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::PALO_ALTO_ACCOUNT_ID:root"
      },
      "Action": "sts:AssumeRole",
      "Condition": {
        "StringEquals": {
          "sts:ExternalId": "YOUR_EXTERNAL_ID"
        }
      }
    }
  ]
}

## Step 2: Attach Required Policies
# For CloudTrail:
- cloudtrail:LookupEvents
- cloudtrail:DescribeTrails
- s3:GetObject (for CloudTrail S3 bucket)
- s3:ListBucket

# For GuardDuty:
- guardduty:GetFindings
- guardduty:ListDetectors
- guardduty:ListFindings

# For Security Hub:
- securityhub:GetFindings
- securityhub:BatchGetSecurityControls

## Step 3: Configure in XSIAM
# Settings → Integrations → AWS → Add Account
# Provide: Role ARN, External ID, Regions to monitor

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <div class="config-section">
                    <h4>AWS Log Source Priority Matrix</h4>
                    <div class="arch-diagram"># AWS Log Source Prioritization
# ═══════════════════════════════════════════════════════════════

## TIER 1 - CRITICAL (Always Enable)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Source              EPS Est.    Detection Value
CloudTrail          10-100      API activity, user actions, config changes
GuardDuty           1-50        ML-based threat detection
Security Hub        10-100      Aggregated findings, compliance

## TIER 2 - HIGH VALUE (Enable for Security)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
VPC Flow Logs       100-10K     Network visibility, lateral movement
WAF Logs            10-1000     Web attack detection
Route 53 DNS        10-100      DNS analytics, C2 detection

## TIER 3 - OPERATIONAL (Enable as Needed)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S3 Access Logs      Variable    Data access auditing
RDS Audit Logs      10-100      Database activity
Lambda Logs         Variable    Serverless execution
EKS Audit Logs      100-1000    Kubernetes activity

## COST OPTIMIZATION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- VPC Flow Logs: Filter to REJECT only (90% reduction)
- S3 Logs: Enable only for sensitive buckets
- Consider sampling for high-volume, low-value sources

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>AWS Service</th>
                            <th>Log Type</th>
                            <th>Use Case</th>
                            <th>EPS Estimate</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong style="color: #ff9900;">CloudTrail</strong></td>
                            <td>API calls, management events</td>
                            <td>User activity, config changes</td>
                            <td>10-100 per account</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #ff9900;">GuardDuty</strong></td>
                            <td>Threat findings</td>
                            <td>Threat detection, anomalies</td>
                            <td>1-50 per account</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #ff9900;">VPC Flow Logs</strong></td>
                            <td>Network traffic metadata</td>
                            <td>Network visibility, forensics</td>
                            <td>100-10K per VPC</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #ff9900;">Security Hub</strong></td>
                            <td>Aggregated findings</td>
                            <td>Compliance, posture</td>
                            <td>10-100 per account</td>
                        </tr>
                    </tbody>
                </table>

                <h2><i class="fab fa-microsoft"></i> Azure Integration</h2>
                
                <div class="config-section">
                    <h4>Azure Activity & Entra ID Logs</h4>
                    <div class="arch-diagram"># Azure Integration Setup
# ═══════════════════════════════════════════════════════════════

## Method 1: Event Hub Streaming (Recommended)
# Most reliable for high-volume logs

1. Create Event Hub Namespace
   az eventhubs namespace create \
     --name xsiam-logs \
     --resource-group security-rg \
     --sku Standard

2. Create Event Hub
   az eventhubs eventhub create \
     --name activity-logs \
     --namespace-name xsiam-logs \
     --resource-group security-rg

3. Create Diagnostic Setting
   az monitor diagnostic-settings create \
     --name send-to-xsiam \
     --resource /subscriptions/{sub-id} \
     --event-hub activity-logs \
     --event-hub-rule {auth-rule-id} \
     --logs '[{"category":"Administrative","enabled":true},
              {"category":"Security","enabled":true}]'

4. Configure XSIAM with Event Hub connection string

## Method 2: API Integration
# For lower-volume, simpler setup

1. Register App in Entra ID
2. Grant API permissions:
   - AuditLog.Read.All
   - SignInLogsRead.All
   - SecurityEvents.Read.All
3. Configure in XSIAM with App ID, Secret, Tenant ID

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fab fa-google"></i> GCP Integration</h2>
                
                <div class="config-section">
                    <h4>GCP Audit Logs Configuration</h4>
                    <div class="arch-diagram"># GCP Integration Setup
# ═══════════════════════════════════════════════════════════════

## Step 1: Create Service Account
gcloud iam service-accounts create xsiam-integration \
  --display-name="XSIAM Log Integration"

## Step 2: Grant Required Roles
gcloud projects add-iam-policy-binding PROJECT_ID \
  --member="serviceAccount:xsiam-integration@PROJECT_ID.iam.gserviceaccount.com" \
  --role="roles/logging.viewer"

gcloud projects add-iam-policy-binding PROJECT_ID \
  --member="serviceAccount:xsiam-integration@PROJECT_ID.iam.gserviceaccount.com" \
  --role="roles/pubsub.subscriber"

## Step 3: Create Pub/Sub for Log Export
gcloud pubsub topics create xsiam-audit-logs
gcloud pubsub subscriptions create xsiam-sub \
  --topic=xsiam-audit-logs

## Step 4: Create Log Sink
gcloud logging sinks create xsiam-sink \
  pubsub.googleapis.com/projects/PROJECT_ID/topics/xsiam-audit-logs \
  --log-filter='logName:"cloudaudit.googleapis.com"'

## Step 5: Configure in XSIAM
# Provide: Service Account JSON key, Project ID, Subscription name

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-search"></i> Cloud Security Detection Examples</h2>
                
                <div class="config-section">
                    <h4>Cross-Cloud Detection Rules</h4>
                    <div class="arch-diagram"># Detect Unusual Cross-Cloud Activity
# ═══════════════════════════════════════════════════════════════

# AWS: Detect root account usage
dataset = aws_cloudtrail_raw
| filter userIdentity_type = "Root"
| filter eventName not in ("ConsoleLogin", "GetSessionToken")
| fields _time, eventName, sourceIPAddress, userAgent

# Azure: Detect high-risk sign-in
dataset = azure_signin_raw
| filter riskLevel in ("high", "medium")
| fields _time, userPrincipalName, ipAddress, riskLevel, location

# GCP: Detect IAM policy changes
dataset = gcp_audit_raw
| filter methodName contains "SetIamPolicy"
| fields _time, principalEmail, resourceName, methodName

# Cross-Cloud: Correlate user activity across platforms
dataset in (aws_cloudtrail_raw, azure_signin_raw, gcp_audit_raw)
| filter _time > now() - 1h
| alter normalized_user = coalesce(userIdentity_userName, 
                                    userPrincipalName,
                                    principalEmail)
| comp count() as activity_count by normalized_user
| filter activity_count > 100  // Unusual volume

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you architect cloud log collection for a multi-cloud environment?</button>
                        <div class="qa-answer">
                            <p>Multi-cloud log collection requires balancing completeness, reliability, cost, and operational complexity. My approach focuses on standardization and prioritization.</p>
                            
                            <p>First, I prioritize log sources by security value. Critical sources include identity logs (CloudTrail, Azure AD, GCP IAM), security findings (GuardDuty, Defender, Security Command Center), and configuration changes. Secondary sources include VPC flow logs, WAF logs, and service-specific logs. Tertiary sources are application logs that might be high volume but lower security value.</p>
                            
                            <p>For collection architecture, I use each cloud's native streaming mechanism - S3 + SQS for AWS, Event Hubs for Azure, Pub/Sub for GCP. These are more reliable than API polling for high-volume sources. XSIAM connects to these streaming endpoints for near-real-time ingestion.</p>
                            
                            <p>I normalize data early in the pipeline. Each cloud uses different schemas, so mapping to a common data model (XDM in XSIAM) is essential for cross-cloud correlation. A user creating resources in AWS, Azure, and GCP should appear consistently in queries.</p>
                            
                            <p>For cost management, I'm strategic about what flows into XSIAM at full fidelity versus what gets summarized or sampled. VPC flow logs at full detail can be massive and expensive; I might filter to only denied traffic or summarize by hour for baseline purposes.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) { sidebar.classList.toggle('open'); overlay.classList.toggle('active'); }
            else { sidebar.classList.toggle('collapsed'); mainWrapper.classList.toggle('expanded'); }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
