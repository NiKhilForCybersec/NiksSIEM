<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Identity Analytics | XSIAM Detection</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand"><i class="fas fa-shield-alt"></i><span>Nik's SIEM</span></a>
                <button class="sidebar-toggle" onclick="toggleSidebar()"><i class="fas fa-chevron-left"></i></button>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Detection & Response</div>
                    <ul class="sidebar-nav">
                        <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                        <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                        <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                        <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link active"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    </ul>
                </div>
            </div>
        </aside>
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Identity Analytics</span>
                </div>

                <h1><i class="fas fa-user-secret"></i> Identity Analytics</h1>
                <p class="lead">XSIAM's identity-focused threat detection capabilities including identity risk scoring, access pattern analysis, and privileged account monitoring.</p>

                <h2><i class="fas fa-id-badge"></i> Identity-Centric Security</h2>
                
                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-info-circle"></i> Identity as the New Perimeter</h4>
                    <p>With cloud adoption and remote work, identity has become the primary security boundary. XSIAM's Identity Analytics correlates authentication events, access patterns, and behavioral data to detect identity-based threats that traditional perimeter security would miss.</p>
                </div>

                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-project-diagram"></i> Identity Analytics Data Flow</div>
<pre style="color: #8b949e; font-size: 0.8rem; line-height: 1.6; overflow-x: auto;">
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                  IDENTITY ANALYTICS PIPELINE                                     │
├─────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                  │
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                           │
│   │   Okta      │  │  Azure AD   │  │   Active    │  │  CyberArk   │                           │
│   │   Logs      │  │   Logs      │  │  Directory  │  │   PAM       │                           │
│   └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘                           │
│          │                │                │                │                                    │
│          └────────────────┴────────────────┴────────────────┘                                    │
│                                     │                                                            │
│                                     ▼                                                            │
│                    ┌────────────────────────────────────┐                                       │
│                    │      IDENTITY CORRELATION          │                                       │
│                    │  • Unified identity view           │                                       │
│                    │  • Cross-source linkage            │                                       │
│                    │  • Entity resolution               │                                       │
│                    └────────────────┬───────────────────┘                                       │
│                                     │                                                            │
│          ┌──────────────────────────┼──────────────────────────┐                                │
│          ▼                          ▼                          ▼                                │
│   ┌─────────────┐          ┌─────────────┐          ┌─────────────┐                            │
│   │  Risk       │          │  Access     │          │  Privilege  │                            │
│   │  Scoring    │          │  Analytics  │          │  Monitoring │                            │
│   │             │          │             │          │             │                            │
│   │ • User risk │          │ • Patterns  │          │ • Admin     │                            │
│   │ • Session   │          │ • Anomalies │          │   activity  │                            │
│   │   risk      │          │ • Peer      │          │ • Role      │                            │
│   │             │          │   deviation │          │   changes   │                            │
│   └─────────────┘          └─────────────┘          └─────────────┘                            │
│                                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
                </div>

                <h2><i class="fas fa-thermometer-half"></i> Identity Risk Scoring</h2>
                
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Risk Factor</th>
                            <th>Weight</th>
                            <th>Detection Logic</th>
                            <th>Risk Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong style="color: #f85149;">Impossible Travel</strong></td>
                            <td>High (+25)</td>
                            <td>Login from distant location within short time</td>
                            <td>Credential compromise indicator</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #d29922;">New Device/Location</strong></td>
                            <td>Medium (+15)</td>
                            <td>First-time login from device/location</td>
                            <td>Potential account takeover</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #a371f7;">Multiple Failed MFA</strong></td>
                            <td>High (+20)</td>
                            <td>>3 MFA failures in 15 minutes</td>
                            <td>MFA fatigue or bypass attempt</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #58a6ff;">Off-Hours Activity</strong></td>
                            <td>Low (+10)</td>
                            <td>Activity outside normal working hours</td>
                            <td>Unusual but may be legitimate</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #3fb950;">Privilege Escalation</strong></td>
                            <td>High (+30)</td>
                            <td>Role assignment to privileged group</td>
                            <td>Potential insider threat</td>
                        </tr>
                    </tbody>
                </table>

                <div class="config-section">
                    <h4>Risk Score Calculation Query</h4>
                    <div class="arch-diagram"># Identity Risk Score Aggregation
# ═══════════════════════════════════════════════════════════════

dataset in (okta_raw, azure_ad_signin_raw, xdr_identity_raw)
| filter _time > now() - 24h
| alter normalized_user = coalesce(actor_alternateId, 
                                    userPrincipalName, 
                                    user_email)
| alter risk_points = case(
    event_type = "impossible_travel", 25,
    event_type = "new_device", 15,
    event_type = "mfa_failure" AND failure_count > 3, 20,
    event_type = "off_hours_login", 10,
    event_type = "privilege_change", 30,
    0
  )
| comp sum(risk_points) as total_risk_score,
        count_distinct(event_type) as risk_factors
  by normalized_user
| filter total_risk_score > 50
| sort total_risk_score desc

# Risk Thresholds:
# 0-25:   Low risk (green)
# 26-50:  Medium risk (yellow) 
# 51-75:  High risk (orange)
# 76+:    Critical risk (red) - investigate immediately

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-crown"></i> Privileged Account Monitoring</h2>
                
                <div class="config-section">
                    <h4>Privileged Activity Detections</h4>
                    <div class="arch-diagram"># Privileged Account Monitoring Queries
# ═══════════════════════════════════════════════════════════════

## Detect Admin Activity Outside Business Hours
dataset = azure_ad_audit_raw
| filter initiatedBy_user_roles contains "Administrator"
| filter hour(_time) < 7 OR hour(_time) > 19
| filter dayofweek(_time) in (0, 6)  // Weekend
| fields _time, initiatedBy_user_userPrincipalName, 
         activityDisplayName, result

# ═══════════════════════════════════════════════════════════════

## Monitor Service Account Usage
dataset = xdr_identity_raw
| filter account_type = "service_account"
| filter event_type = "interactive_login"  // Should never happen
| fields _time, account_name, source_ip, authentication_method

# ═══════════════════════════════════════════════════════════════

## Track Privilege Changes
dataset = azure_ad_audit_raw
| filter activityDisplayName in (
    "Add member to role",
    "Remove member from role",
    "Add owner to service principal",
    "Add app role assignment grant to user"
  )
| filter targetResources contains "Global Administrator" OR
         targetResources contains "Privileged"
| fields _time, initiatedBy_user_userPrincipalName,
         activityDisplayName, targetResources_displayName

# ═══════════════════════════════════════════════════════════════

## Dormant Admin Account Activation
dataset = azure_ad_signin_raw
| filter userType = "Admin"
| comp max(_time) as last_login by userPrincipalName
| join type=left (
    dataset = xdr_identity_raw
    | filter _time > now() - 1d
    | fields userPrincipalName, recent_login = 1
  ) as recent on userPrincipalName
| filter timestamp_diff(now(), last_login, "DAY") > 90
| filter recent_login = 1  // Login within last day after 90+ days inactive

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-code-branch"></i> Identity Threat Response Decision Tree</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>High-risk identity alert received</strong>
                        <div style="color: #8b949e; font-size: 0.85rem;">Risk score > 75</div>
                    </div>
                    <div class="decision-arrow">↓</div>
                    <div class="decision-node question">
                        <strong>Is the user a privileged account?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ YES (Admin/Service)</div>
                            <div class="decision-node" style="background: #4d1a1a; border-color: #f85149;">
                                <strong style="color: #f85149;">CRITICAL - Immediate Action</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Disable account (XSOAR)<br>2. Revoke sessions<br>3. Alert security leadership<br>4. Begin incident investigation</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ NO (Standard user)</div>
                            <div class="decision-node question">
                                <strong>Is there confirmed malicious activity?</strong>
                            </div>
                            <div class="decision-branch">
                                <div>
                                    <div class="decision-arrow">↓ YES</div>
                                    <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                        <strong style="color: #d29922;">Contain & Investigate</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">1. Force password reset<br>2. Revoke tokens<br>3. Contact user for verification<br>4. Review access logs</div>
                                    </div>
                                </div>
                                <div>
                                    <div class="decision-arrow">↓ NO (Suspicious only)</div>
                                    <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                        <strong style="color: #58a6ff;">Monitor & Verify</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">1. Increase monitoring<br>2. Contact user to verify activity<br>3. Document findings<br>4. Close or escalate based on response</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you design identity threat detection for a hybrid AD/Azure AD environment?</button>
                        <div class="qa-answer">
                            <p>Hybrid identity environments are common but complex because identity events span both on-premises Active Directory and cloud Azure AD. My design focuses on unified visibility and correlated detection.</p>
                            
                            <p>First, ensure complete log collection from both sides. On-premises AD requires Windows Security Event logs (4624, 4625, 4768, 4769, etc.) collected via XDR agents or Windows Event Forwarding to Broker VM. Azure AD requires sign-in logs, audit logs, and identity protection logs via Event Hub or Graph API.</p>
                            
                            <p>The critical piece is identity correlation. The same user appears differently in each system - samAccountName in AD, userPrincipalName in Azure AD. Create mapping rules that link identities so alerts can correlate activity across environments. A user authenticating via AD on-premises and then accessing Azure resources should be visible as a unified identity.</p>
                            
                            <p>For detection rules, I'd focus on hybrid-specific threats. Pass-through authentication attacks where compromised on-prem credentials enable cloud access. Azure AD Connect synchronization attacks. Lateral movement from compromised on-prem accounts to cloud resources. These require correlation rules that span both data sources.</p>
                            
                            <p>Privileged account monitoring needs special attention in hybrid. Global Administrators, Azure AD roles, Domain Admins, and service accounts should all be in a privileged identity watchlist with enhanced monitoring and lower alert thresholds.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle identity-based alerts with high false positive rates?</button>
                        <div class="qa-answer">
                            <p>Identity alerts often have high false positive rates because legitimate user behavior can look suspicious - travel, new devices, unusual hours. My approach balances reducing FPs without missing real threats.</p>
                            
                            <p>First, I analyze the FP patterns. Are they concentrated on specific users (executives who travel, IT admins with unusual access), specific rules (new location too sensitive), or specific times (batch processing triggering off-hours alerts)? Understanding the pattern guides the tuning strategy.</p>
                            
                            <p>For user-specific FPs, I use risk adjustments rather than exclusions. Instead of excluding an executive from travel alerts entirely, I might adjust their baseline to expect multi-location activity, or reduce the risk score impact for expected patterns while still alerting on truly anomalous activity.</p>
                            
                            <p>For rule tuning, I look at the detection logic. If "new location" fires too often, maybe the definition of "new" needs adjustment - perhaps requiring the location to be genuinely new (never seen) rather than just uncommon. If "off-hours" fires for legitimate global collaboration, I might adjust to only alert when combined with other risk factors.</p>
                            
                            <p>I also implement progressive response. Low-confidence identity alerts might trigger enhanced monitoring rather than immediate action. If additional risk factors accumulate, the response escalates. This reduces analyst fatigue while maintaining detection capability.</p>
                            
                            <p>Finally, I build in feedback loops. Analysts marking alerts as FP should feed back into the models. Over time, the system learns which patterns are truly risky versus normal variation in your specific environment.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) { sidebar.classList.toggle('open'); overlay.classList.toggle('active'); }
            else { sidebar.classList.toggle('collapsed'); mainWrapper.classList.toggle('expanded'); }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
