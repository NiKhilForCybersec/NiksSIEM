<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cost Optimization | XSIAM Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link active"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Cost Optimization</span>
                </div>

                <h1><i class="fas fa-dollar-sign"></i> XSIAM Cost Optimization Guide</h1>
                <p class="lead">Strategies for optimizing XSIAM licensing costs, reducing log volumes, managing retention efficiently, and maximizing ROI from your security investment.</p>

                <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> XSIAM Licensing Model</h4>
                    <p>XSIAM is typically licensed based on data ingestion (GB/day) and/or number of protected endpoints. Cost optimization focuses on reducing unnecessary log volume while maintaining security visibility.</p>
                </div>

                <!-- Cost Drivers -->
                <h2><i class="fas fa-chart-pie"></i> XSIAM Cost Drivers</h2>
                
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Cost Driver</th>
                            <th>Impact</th>
                            <th>Optimization Potential</th>
                            <th>Approach</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Data Ingestion (GB/day)</strong></td>
                            <td style="color: #f85149;">High</td>
                            <td style="color: #3fb950;">20-40% reduction possible</td>
                            <td>Log filtering, deduplication, sampling</td>
                        </tr>
                        <tr>
                            <td><strong>Endpoint Licenses</strong></td>
                            <td style="color: #d29922;">Medium</td>
                            <td style="color: #d29922;">5-15% reduction</td>
                            <td>Accurate inventory, license reclamation</td>
                        </tr>
                        <tr>
                            <td><strong>Hot Storage (Retention)</strong></td>
                            <td style="color: #d29922;">Medium</td>
                            <td style="color: #3fb950;">30-50% reduction</td>
                            <td>Tiered retention, cold storage migration</td>
                        </tr>
                        <tr>
                            <td><strong>Add-on Modules</strong></td>
                            <td style="color: #58a6ff;">Low-Medium</td>
                            <td style="color: #d29922;">Varies</td>
                            <td>Usage review, consolidation</td>
                        </tr>
                    </tbody>
                </table>

                <!-- Log Volume Reduction -->
                <h2><i class="fas fa-compress-arrows-alt"></i> Log Volume Reduction Strategies</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>Where is most of your log volume coming from?</strong>
                    </div>
                    <div class="decision-branch" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 16px;">
                        <div>
                            <div class="decision-node" style="background: #4d1a1a; border-color: #f85149;">
                                <strong style="color: #f85149;">Network Logs</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">Firewall, Flow, DNS<br>Usually 40-60% of volume<br>→ Highest optimization potential</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                <strong style="color: #d29922;">Endpoint Logs</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">EDR, Windows Events<br>Usually 20-30% of volume<br>→ Moderate optimization</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                <strong style="color: #58a6ff;">Application Logs</strong>
                                <div style="color: #8b949e; font-size: 0.8rem;">Web, Database, Cloud<br>Usually 15-25% of volume<br>→ Selective optimization</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>Log Volume Analysis Queries</h4>
                    <div class="arch-diagram"># Log Volume Analysis
# ═══════════════════════════════════════════════════════════════

# Daily Volume by Data Source (GB)
dataset = *
| filter _time > now() - 7d
| alter day = format_time("%Y-%m-%d", _time)
| comp sum(length(_raw)) as bytes by _dataset, day
| alter gb_per_day = round(bytes / 1000000000, 2)
| sort day desc, gb_per_day desc

# ═══════════════════════════════════════════════════════════════

# Top 10 Log Sources by Volume
dataset = *
| filter _time > now() - 24h
| comp count() as events, sum(length(_raw)) as bytes by _dataset
| alter gb = round(bytes / 1000000000, 2)
| alter avg_event_size = round(bytes / events, 0)
| sort gb desc
| limit 10

# ═══════════════════════════════════════════════════════════════

# Volume by Event Type (Within Top Sources)
dataset = [TOP_DATASET]
| filter _time > now() - 24h
| comp count() as events, sum(length(_raw)) as bytes by event_type
| alter pct_of_total = round(events * 100 / sum(events), 1)
| sort events desc
| limit 20

# ═══════════════════════════════════════════════════════════════

# Identify Duplicate/Redundant Logs
dataset = *
| filter _time > now() - 1h
| comp count() as occurrences by _raw
| filter occurrences > 10  // Frequent duplicates
| sort occurrences desc
| limit 20

# ═══════════════════════════════════════════════════════════════

# Volume Trend Over Time (Detect Spikes)
dataset = *
| filter _time > now() - 30d
| alter day = format_time("%Y-%m-%d", _time)
| comp sum(length(_raw)) as bytes by day
| alter gb = round(bytes / 1000000000, 2)
| sort day asc</div>
                </div>

                <!-- Network Log Optimization -->
                <h2><i class="fas fa-network-wired"></i> Network Log Optimization</h2>
                
                <div class="config-section">
                    <h4>Firewall Log Reduction Strategies</h4>
                    <div class="arch-diagram"># Firewall Log Optimization
# ═══════════════════════════════════════════════════════════════

## STRATEGY 1: Filter ALLOW Actions for High-Volume Traffic
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Problem: Most firewall volume is ALLOW logs for normal traffic
Solution: Only ingest DENY/DROP and ALLOW for specific zones

On Firewall:
- Log DENY/DROP: All
- Log ALLOW: Only for DMZ, internet-facing, or sensitive segments
- Skip logging: Internal-to-internal allowed traffic

Savings: 30-50% of firewall volume

## STRATEGY 2: Aggregate DNS Query Logs
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Problem: DNS logs are extremely high volume
Solution: Log only unique queries per hour, or sample

Options:
a) Log only blocked/malicious DNS queries
b) Sample 10% of allowed queries
c) Aggregate: 1 log per domain/hour instead of per query

Savings: 50-80% of DNS volume

## STRATEGY 3: VPC Flow Log Filtering
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Problem: VPC flow logs are massive in cloud environments
Solution: Filter at source before ingestion

AWS VPC Flow Logs:
- Only log REJECT (not ACCEPT)
- Exclude known internal traffic
- Use sampling for baseline visibility

Azure NSG Flow Logs:
- Filter to specific NSGs
- Exclude internal subnet-to-subnet

Savings: 60-80% of flow log volume

## STRATEGY 4: Deduplication at Broker
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Configure Broker VM to deduplicate identical logs
within time windows (e.g., same log within 60 seconds)

Savings: 5-15% overall

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Endpoint Log Optimization -->
                <h2><i class="fas fa-desktop"></i> Endpoint Log Optimization</h2>
                
                <div class="config-section">
                    <h4>Windows Event Log Optimization</h4>
                    <div class="arch-diagram"># Windows Event Log Optimization
# ═══════════════════════════════════════════════════════════════

## HIGH-VALUE EVENTS (Always Collect)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Security:
- 4624, 4625: Logon success/failure
- 4648: Explicit credential logon
- 4672: Special privileges assigned
- 4688: Process creation (with command line)
- 4698-4702: Scheduled tasks
- 4720-4738: Account management
- 4776: Credential validation

System:
- 7045: Service installed
- 1102: Audit log cleared

PowerShell:
- 4103, 4104: Script block logging

## MEDIUM-VALUE (Selective Collection)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- 5156, 5158: Windows Firewall (sample or filter)
- 4663: Object access (limit to sensitive paths)
- 4660: Object deleted (limit scope)

## LOW-VALUE (Consider Excluding)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- 4634: Logoff (usually not needed with logon)
- 5145: Network share access (very high volume)
- 4658: Handle closed (minimal value)
- Informational events from non-critical apps

## IMPLEMENTATION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Option A: Filter at Windows Event Forwarding (WEF)
Option B: Filter at Broker VM with syslog-ng rules
Option C: Configure XDR agent collection policy

Savings: 20-40% of Windows event volume

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Retention Optimization -->
                <h2><i class="fas fa-archive"></i> Retention Tier Optimization</h2>
                
                <div class="config-section">
                    <h4>Tiered Retention Strategy</h4>
                    <div class="arch-diagram"># Retention Tier Strategy
# ═══════════════════════════════════════════════════════════════

## HOT TIER (Fast Query, Expensive)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Duration: 30-90 days
Data: All data sources
Use: Active investigations, real-time alerting

## WARM TIER (Slower Query, Moderate Cost)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Duration: 90-365 days
Data: Security-relevant logs only
Use: Historical investigations, compliance

Candidates for Warm:
- Authentication logs
- Alert/incident data
- High-value endpoint events
- Email security logs

## COLD TIER (Archive, Low Cost)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Duration: 1-7 years
Data: Compliance-required logs
Use: Audit, legal hold, rare investigations

Candidates for Cold:
- Network flow logs (aggregated)
- Firewall allow logs
- Application debug logs
- Raw syslog archives

## RETENTION BY DATA TYPE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Data Type              | Hot    | Warm   | Cold
───────────────────────┼────────┼────────┼────────
XDR Alerts/Incidents   | 90d    | 1yr    | 7yr
Authentication         | 90d    | 1yr    | 3yr
Endpoint Telemetry     | 30d    | 90d    | 1yr
Firewall Deny          | 90d    | 1yr    | 3yr
Firewall Allow         | 7d     | 30d    | 1yr
DNS Queries            | 7d     | 30d    | 90d
VPC Flow Logs          | 7d     | -      | 90d
Debug/Verbose          | 3d     | -      | -

Savings: 30-50% storage costs with proper tiering

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- License Optimization -->
                <h2><i class="fas fa-id-card"></i> Endpoint License Optimization</h2>
                
                <div class="config-section">
                    <h4>License Reclamation Queries</h4>
                    <div class="arch-diagram"># Endpoint License Optimization
# ═══════════════════════════════════════════════════════════════

# Find Inactive Agents (License Reclamation Candidates)
dataset = xdr_agent_inventory
| comp max(last_seen) as last_checkin by endpoint_id, endpoint_name
| alter days_inactive = timestamp_diff(now(), last_checkin, "DAY")
| filter days_inactive > 30
| sort days_inactive desc

# Action: Remove agents inactive >30 days, reclaim licenses

# ═══════════════════════════════════════════════════════════════

# Find Duplicate Agents (Same Host, Multiple Entries)
dataset = xdr_agent_inventory
| comp count() as agent_count by endpoint_name
| filter agent_count > 1
| sort agent_count desc

# Action: Remove duplicate entries, keep most recent

# ═══════════════════════════════════════════════════════════════

# Agents on Decommissioned Systems
dataset = xdr_agent_inventory
| filter last_seen > now() - 90d
| fields endpoint_name, endpoint_id, os_type, last_seen
| join type=left (
    // Your CMDB or asset inventory
    dataset = asset_inventory
    | fields hostname, status
  ) as assets on endpoint_name = assets.hostname
| filter assets.status = "decommissioned" OR assets.hostname = null

# ═══════════════════════════════════════════════════════════════

# License Usage Summary
dataset = xdr_agent_inventory
| filter last_seen > now() - 30d
| comp count() as active_agents by os_type
| alter total = sum(active_agents)

# Compare to licensed count to identify over/under licensing

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- ROI Metrics -->
                <h2><i class="fas fa-chart-line"></i> ROI & Value Metrics</h2>
                
                <div class="config-section">
                    <h4>Demonstrating XSIAM Value</h4>
                    <div class="arch-diagram"># XSIAM ROI Metrics
# ═══════════════════════════════════════════════════════════════

## EFFICIENCY METRICS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Mean Time to Detect (MTTD):    Track reduction over time
Mean Time to Respond (MTTR):   Track reduction over time
Alerts per Analyst per Day:    Should decrease with tuning
Automation Rate:               % alerts auto-resolved

## COST AVOIDANCE METRICS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Incidents Prevented:           Blocked malware, phishing
Breach Cost Avoided:           Industry avg $4.45M
Compliance Fines Avoided:      GDPR, HIPAA, PCI penalties
Tool Consolidation Savings:    Replaced legacy tools

## OPERATIONAL METRICS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
True Positive Rate:            Improves with tuning
Alert Volume Trend:            Should stabilize/decrease
Coverage Gaps Closed:          New log sources added
Detection Rule Effectiveness:  Rules with confirmed detections

## SAMPLE ROI CALCULATION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Annual XSIAM Cost:             $500,000

Value Generated:
- 2 breaches prevented:        $200,000 (conservative)
- 50% faster response:         $150,000 (analyst time)
- Tool consolidation:          $100,000 (replaced 3 tools)
- Compliance automation:       $75,000 (audit time saved)
                               ─────────
Total Value:                   $525,000

ROI = (525,000 - 500,000) / 500,000 = 5% Year 1
(Typically improves to 50-100%+ by Year 2-3)

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Your SIEM costs are 40% over budget due to log volume. How do you reduce costs without compromising security?</button>
                        <div class="qa-answer">
                            <p>This requires a data-driven approach to identify waste without creating security blind spots.</p>
                            
                            <p><strong>First, analyze where volume is coming from:</strong> I run queries to identify the top 10 data sources by GB/day. Usually, 3-4 sources account for 70%+ of volume. Common culprits are firewall allow logs, DNS queries, and VPC flow logs.</p>
                            
                            <p><strong>Question the security value:</strong> For each high-volume source, I ask: "What detections depend on this data?" Firewall ALLOW logs for internal traffic rarely trigger alerts - they're just baseline noise. DNS query logs for known-good domains add volume without detection value.</p>
                            
                            <p><strong>Filter at source, not destination:</strong> The most effective optimization happens before logs reach the SIEM. I work with network teams to configure firewalls to only log DENY actions and critical ALLOW categories. For cloud, I filter VPC flow logs to REJECT only.</p>
                            
                            <p><strong>Implement tiered retention:</strong> Not all data needs 365-day hot storage. I move low-value logs to cold storage after 7-30 days, keeping security-critical data in hot tier for the full retention period.</p>
                            
                            <p><strong>Validate with detection engineering:</strong> Before cutting any log source, I verify with the detection team that no active rules depend on that data. I also check historical incidents to ensure we haven't relied on that data for investigations.</p>
                            
                            <p><strong>Target:</strong> A well-optimized SIEM should be 30-40% smaller than an unoptimized deployment with equivalent security coverage.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you justify SIEM costs to leadership who sees it as "just logging"?</button>
                        <div class="qa-answer">
                            <p>Framing is everything. SIEM isn't a logging tool - it's risk reduction and business protection infrastructure.</p>
                            
                            <p><strong>Speak in business terms:</strong> I don't talk about "events per second" to executives. I talk about "time to detect a breach" (MTTD) and "time to contain an incident" (MTTR). I show trends over time - "We've reduced our average detection time from 48 hours to 4 hours."</p>
                            
                            <p><strong>Quantify cost avoidance:</strong> Every blocked malware infection, every prevented phishing compromise, every insider threat caught early represents avoided costs. The average breach costs $4.45M - if we've prevented even one significant incident, the SIEM has paid for itself multiple times over.</p>
                            
                            <p><strong>Compliance as a floor:</strong> Many organizations are required by regulation or contract to have security monitoring. "We need this to maintain our SOC 2 certification" or "Our enterprise customers require it" makes it non-negotiable.</p>
                            
                            <p><strong>Tool consolidation story:</strong> XSIAM often replaces multiple point products - SIEM, SOAR, EDR, threat intel platform. I show the total cost comparison: "We're spending $500K on XSIAM but we eliminated $300K in other tools, so net cost is $200K for significantly better capability."</p>
                            
                            <p><strong>Demonstrate concrete value:</strong> I maintain a "SIEM wins" log - every incident where detection led to early containment, every phishing campaign we caught, every compliance finding we addressed. These real examples resonate more than theoretical risk discussions.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) { sidebar.classList.toggle('open'); overlay.classList.toggle('active'); }
            else { sidebar.classList.toggle('collapsed'); mainWrapper.classList.toggle('expanded'); }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
