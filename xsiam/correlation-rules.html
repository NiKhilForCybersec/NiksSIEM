<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Correlation Rules - Complete Configuration Guide | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .config-section { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .console-path { background: #0d1117; padding: 8px 12px; border-radius: 4px; font-family: monospace; font-size: 0.85rem; color: #58a6ff; margin: 8px 0; display: inline-block; }
        .config-step { display: flex; gap: 16px; padding: 16px; background: #21262d; border-radius: 8px; margin: 12px 0; }
        .step-num { width: 32px; height: 32px; background: #58a6ff; color: #0d1117; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; flex-shrink: 0; }
        .code-block { background: #0d1117; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 12px 0; font-family: 'Fira Code', monospace; font-size: 0.85rem; overflow-x: auto; white-space: pre; }
        .rule-card { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .severity-badge { padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; }
        .severity-critical { background: #4d0f0f; color: #f85149; }
        .severity-high { background: #4d2d0d; color: #db6d28; }
        .severity-medium { background: #4d3a0d; color: #d29922; }
        .mitre-tag { background: #1c3a5e; color: #58a6ff; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; margin-right: 4px; }
        .field-ref { background: #21262d; padding: 2px 6px; border-radius: 4px; font-family: monospace; font-size: 0.85rem; }
    </style>
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">XSIAM Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> vs Competitors</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="custom-log-onboarding.html" class="nav-link"><i class="fas fa-file-import"></i> Custom Log Onboarding</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM</a>
                    <a href="agents.html" class="nav-link"><i class="fas fa-desktop"></i> Cortex Agents</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & XDM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> XQL Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> XQL Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="correlation-rules.html" class="nav-link active"><i class="fas fa-project-diagram"></i> Correlation Rules</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intelligence</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                    <a href="xdr-overview.html" class="nav-link"><i class="fas fa-crosshairs"></i> XDR Capabilities</a>
                    <a href="recon-asm.html" class="nav-link"><i class="fas fa-globe"></i> ASM / Xpanse</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention & Storage</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                    <a href="enterprise-soc.html" class="nav-link"><i class="fas fa-building"></i> Enterprise SOC</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Correlation Rules</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-project-diagram"></i> Correlation Rules - Complete Configuration Guide</h1>
                <p class="lead">Step-by-step guide to creating, testing, and tuning detection rules in XSIAM. Includes console navigation, XQL syntax, production-ready examples, and tuning procedures.</p>

                <!-- What Are Correlation Rules -->
                <h2><i class="fas fa-question-circle"></i> What Are Correlation Rules?</h2>
                
                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-info-circle"></i> Definition</h4>
                    <p><strong>Correlation rules</strong> are XQL queries that run continuously against ingested data to detect threats. When the query conditions are met, an alert is generated.</p>
                    <p style="margin-top: 8px;"><strong>Why "correlation"?</strong> Because they can correlate multiple events together (e.g., "10 failed logins followed by 1 success from same IP" = brute force).</p>
                </div>

                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Detection Type</th>
                                <th>What It Does</th>
                                <th>When to Use</th>
                                <th>Where in Console</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Correlation Rules</strong></td>
                                <td>Custom XQL-based detection logic</td>
                                <td>Known attack patterns, custom use cases</td>
                                <td>Rules → Correlation Rules</td>
                            </tr>
                            <tr>
                                <td><strong>BIOC Rules</strong></td>
                                <td>Behavioral IOC detection</td>
                                <td>Endpoint-specific behavioral patterns</td>
                                <td>Rules → BIOC Rules</td>
                            </tr>
                            <tr>
                                <td><strong>IOC Matching</strong></td>
                                <td>Hash/IP/Domain blocklists</td>
                                <td>Known malicious indicators</td>
                                <td>Threat Intel → IOC Rules</td>
                            </tr>
                            <tr>
                                <td><strong>Analytics (ML)</strong></td>
                                <td>Machine learning anomaly detection</td>
                                <td>Unknown/novel threats, baseline deviations</td>
                                <td>Analytics → ML Analytics</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- How to Create a Correlation Rule -->
                <h2><i class="fas fa-plus-circle"></i> How to Create a Correlation Rule</h2>
                
                <div class="config-section">
                    <h3>Step-by-Step in XSIAM Console</h3>
                    <div class="console-path">XSIAM Console → Rules → Correlation Rules → + New Rule</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Navigate to Correlation Rules</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Left navigation → Rules → Correlation Rules</p>
                            <p style="color: #8b949e; margin: 4px 0;">Click <strong>+ New Rule</strong> button (top right)</p>
                        </div>
                    </div>
                    
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Configure Rule Metadata</strong>
                            <table style="color: #8b949e; font-size: 0.9rem; margin-top: 8px; width: 100%;">
                                <tr style="border-bottom: 1px solid #30363d;">
                                    <td style="padding: 8px; width: 150px;"><strong>Rule Name:</strong></td>
                                    <td style="padding: 8px;">Brute Force Authentication Detected</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #30363d;">
                                    <td style="padding: 8px;"><strong>Description:</strong></td>
                                    <td style="padding: 8px;">Detects 10+ failed logins followed by success from same source</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #30363d;">
                                    <td style="padding: 8px;"><strong>Severity:</strong></td>
                                    <td style="padding: 8px;">High (dropdown: Informational, Low, Medium, High, Critical)</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #30363d;">
                                    <td style="padding: 8px;"><strong>MITRE ATT&CK:</strong></td>
                                    <td style="padding: 8px;">T1110 - Brute Force (select from dropdown)</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px;"><strong>Category:</strong></td>
                                    <td style="padding: 8px;">Credential Access</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Enter XQL Query</strong>
                            <p style="color: #8b949e; margin: 4px 0;">This is the detection logic. Paste your XQL query into the query editor.</p>
                            <div class="code-block">
<span style="color: #8b949e;">// Brute Force Detection Query</span>
<span style="color: #ff7b72;">dataset</span> = xdr_data
| <span style="color: #ff7b72;">filter</span> event_type = AUTH
| <span style="color: #ff7b72;">filter</span> _time > ago(10m)
| <span style="color: #ff7b72;">comp</span> failed = <span style="color: #d2a8ff;">countif</span>(action_outcome = FAILURE),
       success = <span style="color: #d2a8ff;">countif</span>(action_outcome = SUCCESS)
       <span style="color: #ff7b72;">by</span> xdm.source.ipv4, xdm.target.user.username
| <span style="color: #ff7b72;">filter</span> failed >= 10 <span style="color: #ff7b72;">and</span> success >= 1
                            </div>
                        </div>
                    </div>
                    
                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div>
                            <strong>Configure Execution Settings</strong>
                            <table style="color: #8b949e; font-size: 0.9rem; margin-top: 8px; width: 100%;">
                                <tr style="border-bottom: 1px solid #30363d;">
                                    <td style="padding: 8px; width: 150px;"><strong>Frequency:</strong></td>
                                    <td style="padding: 8px;">Every 5 minutes (options: 1m, 5m, 15m, 1h, etc.)</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #30363d;">
                                    <td style="padding: 8px;"><strong>Query Window:</strong></td>
                                    <td style="padding: 8px;">Last 10 minutes (should match your ago() in query)</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px;"><strong>Alert Grouping:</strong></td>
                                    <td style="padding: 8px;">Group by source IP (prevents duplicate alerts)</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="config-step">
                        <div class="step-num">5</div>
                        <div>
                            <strong>Test the Rule</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Click <strong>"Test Rule"</strong> button to run against historical data</p>
                            <p style="color: #d29922; margin: 4px 0;">Review results: How many alerts would it have generated? Any false positives?</p>
                        </div>
                    </div>
                    
                    <div class="config-step">
                        <div class="step-num">6</div>
                        <div>
                            <strong>Enable the Rule</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Toggle <strong>Enabled</strong> to ON</p>
                            <p style="color: #8b949e; margin: 4px 0;">Click <strong>Save</strong></p>
                            <p style="color: #3fb950; margin: 4px 0;">Rule is now active and will generate alerts when conditions are met!</p>
                        </div>
                    </div>
                </div>

                <!-- Production-Ready Detection Rules -->
                <h2><i class="fas fa-shield-alt"></i> Production-Ready Detection Rules</h2>

                <div class="rule-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="margin: 0;">Rule 1: Brute Force Authentication</h3>
                        <div>
                            <span class="severity-badge severity-high">HIGH</span>
                            <span class="mitre-tag">T1110</span>
                        </div>
                    </div>
                    
                    <p style="color: #8b949e;"><strong>What:</strong> Detects multiple failed login attempts followed by a success - classic brute force pattern.</p>
                    <p style="color: #8b949e;"><strong>Why:</strong> Attackers use automated tools to guess passwords. Success after many failures = compromised account.</p>
                    <p style="color: #8b949e;"><strong>When to alert:</strong> 10+ failures then 1+ success within 10 minutes from same IP.</p>
                    
                    <div class="console-path">Rules → Correlation Rules → + New Rule</div>
                    
                    <h4>XQL Query</h4>
                    <div class="code-block">
<span style="color: #ff7b72;">dataset</span> = xdr_data
| <span style="color: #ff7b72;">filter</span> event_type = AUTH
| <span style="color: #ff7b72;">filter</span> _time > ago(10m)
| <span style="color: #ff7b72;">comp</span> failed = <span style="color: #d2a8ff;">countif</span>(action_outcome = FAILURE),
       success = <span style="color: #d2a8ff;">countif</span>(action_outcome = SUCCESS),
       target_users = <span style="color: #d2a8ff;">array_distinct</span>(<span style="color: #d2a8ff;">arrayconcat</span>(xdm.target.user.username))
       <span style="color: #ff7b72;">by</span> xdm.source.ipv4
| <span style="color: #ff7b72;">filter</span> failed >= 10 <span style="color: #ff7b72;">and</span> success >= 1
| <span style="color: #ff7b72;">fields</span> xdm.source.ipv4, failed, success, target_users
                    </div>
                    
                    <h4>Console Settings</h4>
                    <table style="color: #8b949e; font-size: 0.85rem; width: 100%;">
                        <tr><td style="padding: 4px; width: 120px;">Frequency:</td><td>5 minutes</td></tr>
                        <tr><td style="padding: 4px;">Query Window:</td><td>10 minutes</td></tr>
                        <tr><td style="padding: 4px;">Severity:</td><td>High</td></tr>
                        <tr><td style="padding: 4px;">MITRE:</td><td>T1110 - Brute Force</td></tr>
                    </table>
                    
                    <h4>Tuning Tips</h4>
                    <ul style="color: #8b949e; font-size: 0.9rem;">
                        <li>Exclude service accounts that legitimately fail often (e.g., monitoring)</li>
                        <li>Adjust threshold based on your environment (some orgs may need 20+)</li>
                        <li>Add: <code>| filter xdm.source.ipv4 not in ("10.0.0.5", "10.0.0.6")</code> for exclusions</li>
                    </ul>
                </div>

                <div class="rule-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="margin: 0;">Rule 2: Encoded PowerShell Execution</h3>
                        <div>
                            <span class="severity-badge severity-high">HIGH</span>
                            <span class="mitre-tag">T1059.001</span>
                            <span class="mitre-tag">T1027</span>
                        </div>
                    </div>
                    
                    <p style="color: #8b949e;"><strong>What:</strong> Detects PowerShell running with encoded commands - common attacker technique to evade detection.</p>
                    <p style="color: #8b949e;"><strong>Why:</strong> Legitimate scripts rarely use base64 encoding. Attackers use it to hide malicious payloads.</p>
                    <p style="color: #8b949e;"><strong>When to alert:</strong> Any PowerShell execution with -enc, -encodedcommand, or FromBase64String.</p>
                    
                    <div class="console-path">Rules → Correlation Rules → + New Rule</div>
                    
                    <h4>XQL Query</h4>
                    <div class="code-block">
<span style="color: #ff7b72;">dataset</span> = xdr_data
| <span style="color: #ff7b72;">filter</span> event_type = PROCESS
| <span style="color: #ff7b72;">filter</span> action_process_image_name ~= "powershell|pwsh"
| <span style="color: #ff7b72;">filter</span> action_process_command_line ~= "(?i)(-enc|-encodedcommand|FromBase64String|::Decompress)"
| <span style="color: #ff7b72;">fields</span> _time, agent_hostname, actor_process_image_name, 
         action_process_image_name, action_process_command_line,
         action_process_username
                    </div>
                    
                    <h4>Console Settings</h4>
                    <table style="color: #8b949e; font-size: 0.85rem; width: 100%;">
                        <tr><td style="padding: 4px; width: 120px;">Frequency:</td><td>1 minute (near real-time)</td></tr>
                        <tr><td style="padding: 4px;">Query Window:</td><td>2 minutes</td></tr>
                        <tr><td style="padding: 4px;">Severity:</td><td>High</td></tr>
                        <tr><td style="padding: 4px;">MITRE:</td><td>T1059.001 - PowerShell, T1027 - Obfuscated Files</td></tr>
                    </table>
                    
                    <h4>Tuning Tips</h4>
                    <ul style="color: #8b949e; font-size: 0.9rem;">
                        <li>Some legitimate tools use encoding (SCCM, Intune) - whitelist by parent process</li>
                        <li>Add: <code>| filter actor_process_image_name not in ("ccmexec.exe", "svchost.exe")</code></li>
                        <li>Consider decoding the base64 in response playbook for investigation</li>
                    </ul>
                </div>

                <div class="rule-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="margin: 0;">Rule 3: Large Data Exfiltration</h3>
                        <div>
                            <span class="severity-badge severity-critical">CRITICAL</span>
                            <span class="mitre-tag">T1048</span>
                        </div>
                    </div>
                    
                    <p style="color: #8b949e;"><strong>What:</strong> Detects single endpoint sending unusually large amounts of data externally.</p>
                    <p style="color: #8b949e;"><strong>Why:</strong> Data theft typically involves transferring large volumes. Normal workstations don't upload gigabytes.</p>
                    <p style="color: #8b949e;"><strong>When to alert:</strong> >1 GB outbound to external IP in 1 hour from single endpoint.</p>
                    
                    <div class="console-path">Rules → Correlation Rules → + New Rule</div>
                    
                    <h4>XQL Query</h4>
                    <div class="code-block">
<span style="color: #ff7b72;">dataset</span> = xdr_data
| <span style="color: #ff7b72;">filter</span> event_type = NETWORK
| <span style="color: #ff7b72;">filter</span> _time > ago(1h)
| <span style="color: #ff7b72;">filter</span> action_external_port != null  <span style="color: #8b949e;">// External connections only</span>
| <span style="color: #ff7b72;">filter</span> xdm.target.ipv4 !~= "^(10\.|172\.(1[6-9]|2[0-9]|3[01])\.|192\.168\.)"  <span style="color: #8b949e;">// Not RFC1918</span>
| <span style="color: #ff7b72;">comp</span> total_bytes = <span style="color: #d2a8ff;">sum</span>(action_network_bytes_sent) <span style="color: #ff7b72;">by</span> agent_hostname, xdm.target.ipv4
| <span style="color: #ff7b72;">alter</span> total_gb = <span style="color: #d2a8ff;">round</span>(total_bytes / 1073741824, 2)  <span style="color: #8b949e;">// Convert to GB</span>
| <span style="color: #ff7b72;">filter</span> total_gb >= 1
| <span style="color: #ff7b72;">sort</span> desc total_gb
                    </div>
                    
                    <h4>Tuning Tips</h4>
                    <ul style="color: #8b949e; font-size: 0.9rem;">
                        <li>Exclude known backup destinations and cloud sync services</li>
                        <li>Adjust GB threshold based on business (dev machines may upload more)</li>
                        <li>Add destination IP reputation check in playbook</li>
                    </ul>
                </div>

                <div class="rule-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="margin: 0;">Rule 4: LSASS Memory Access (Credential Dumping)</h3>
                        <div>
                            <span class="severity-badge severity-critical">CRITICAL</span>
                            <span class="mitre-tag">T1003.001</span>
                        </div>
                    </div>
                    
                    <p style="color: #8b949e;"><strong>What:</strong> Detects processes accessing LSASS memory - used by Mimikatz and similar tools.</p>
                    <p style="color: #8b949e;"><strong>Why:</strong> LSASS contains cached credentials. Accessing it = attempting to steal passwords.</p>
                    <p style="color: #8b949e;"><strong>When to alert:</strong> Non-system process accessing lsass.exe memory.</p>
                    
                    <h4>XQL Query</h4>
                    <div class="code-block">
<span style="color: #ff7b72;">dataset</span> = xdr_data
| <span style="color: #ff7b72;">filter</span> event_type = PROCESS
| <span style="color: #ff7b72;">filter</span> causality_actor_process_image_name ~= "lsass\.exe"
| <span style="color: #ff7b72;">filter</span> action_process_image_name not in ("svchost.exe", "csrss.exe", "wininit.exe", "MsMpEng.exe")
| <span style="color: #ff7b72;">fields</span> _time, agent_hostname, action_process_image_name, 
         action_process_command_line, action_process_username,
         actor_process_image_name
                    </div>
                </div>

                <!-- How to Tune Rules -->
                <h2><i class="fas fa-sliders-h"></i> How to Tune Rules (Reduce False Positives)</h2>
                
                <div class="config-section">
                    <h3>Step-by-Step Tuning Process</h3>
                    <div class="console-path">Rules → Correlation Rules → [Select Rule] → Edit</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Identify False Positives</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Go to Incidents → Filter by rule name → Review closed incidents marked as "False Positive"</p>
                            <p style="color: #8b949e; margin: 4px 0;">Look for patterns: Same user? Same host? Same process?</p>
                        </div>
                    </div>
                    
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Add Exclusions to Query</strong>
                            <div class="code-block">
<span style="color: #8b949e;">// BEFORE (too noisy)</span>
<span style="color: #ff7b72;">dataset</span> = xdr_data
| <span style="color: #ff7b72;">filter</span> action_process_image_name ~= "powershell"
| <span style="color: #ff7b72;">filter</span> action_process_command_line ~= "-enc"

<span style="color: #8b949e;">// AFTER (with exclusions)</span>
<span style="color: #ff7b72;">dataset</span> = xdr_data
| <span style="color: #ff7b72;">filter</span> action_process_image_name ~= "powershell"
| <span style="color: #ff7b72;">filter</span> action_process_command_line ~= "-enc"
<span style="color: #3fb950;">| filter actor_process_image_name not in ("ccmexec.exe", "intune.exe")  // Exclude SCCM/Intune</span>
<span style="color: #3fb950;">| filter agent_hostname not ~= "^BUILD-"  // Exclude build servers</span>
<span style="color: #3fb950;">| filter action_process_username != "svc_automation"  // Exclude automation account</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Test Tuned Query</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Click "Test Rule" to see if exclusions would have prevented the false positives</p>
                            <p style="color: #8b949e; margin: 4px 0;">Verify you're not excluding true positives</p>
                        </div>
                    </div>
                    
                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div>
                            <strong>Save and Monitor</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Save changes → Monitor for 1 week → Check true positive rate</p>
                            <p style="color: #3fb950; margin: 4px 0;">Target: >30% true positive rate</p>
                        </div>
                    </div>
                </div>

                <h3>Common Tuning Patterns</h3>
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Tuning Method</th>
                                <th>XQL Syntax</th>
                                <th>When to Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Exclude specific hosts</strong></td>
                                <td><code>| filter agent_hostname not in ("HOST1", "HOST2")</code></td>
                                <td>Build servers, test environments</td>
                            </tr>
                            <tr>
                                <td><strong>Exclude by hostname pattern</strong></td>
                                <td><code>| filter agent_hostname not ~= "^DEV-"</code></td>
                                <td>Dev/test naming conventions</td>
                            </tr>
                            <tr>
                                <td><strong>Exclude users</strong></td>
                                <td><code>| filter xdm.source.user.username not in ("svc_backup")</code></td>
                                <td>Service accounts with known behavior</td>
                            </tr>
                            <tr>
                                <td><strong>Exclude parent processes</strong></td>
                                <td><code>| filter actor_process_image_name not in ("sccm.exe")</code></td>
                                <td>Legitimate management tools</td>
                            </tr>
                            <tr>
                                <td><strong>Raise threshold</strong></td>
                                <td><code>| filter failed >= 20</code> (was 10)</td>
                                <td>Too many alerts, need higher bar</td>
                            </tr>
                            <tr>
                                <td><strong>Narrow time window</strong></td>
                                <td><code>| filter _time > ago(5m)</code> (was 10m)</td>
                                <td>Events should be closer together</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through creating a correlation rule in XSIAM.</button>
                        <div class="qa-answer">
                            <p><strong>Step-by-step process:</strong></p>
                            <ol>
                                <li><strong>Navigate:</strong> Rules → Correlation Rules → + New Rule</li>
                                <li><strong>Define metadata:</strong> Name, description, severity (Informational to Critical), MITRE ATT&CK technique</li>
                                <li><strong>Write XQL query:</strong> Start with dataset, add filters for the attack pattern, use comp for aggregation if needed</li>
                                <li><strong>Set execution:</strong> Frequency (how often to run), query window (how far back to look)</li>
                                <li><strong>Test:</strong> Click "Test Rule" to run against historical data, review results</li>
                                <li><strong>Enable:</strong> Toggle on and save</li>
                            </ol>
                            <p><strong>Example for brute force:</strong> Query looks for 10+ failed logins followed by success from same IP in 10 minutes, runs every 5 minutes, generates High severity alert.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: A correlation rule has a 10% true positive rate. How do you tune it?</button>
                        <div class="qa-answer">
                            <p><strong>Systematic tuning approach:</strong></p>
                            <ol>
                                <li><strong>Analyze false positives:</strong> Review closed FP incidents, look for patterns (same host? same user? same parent process?)</li>
                                <li><strong>Identify exclusion candidates:</strong> Service accounts, build servers, legitimate tools that trigger the rule</li>
                                <li><strong>Modify query:</strong> Add exclusion filters:
                                    <div class="code-block" style="margin: 8px 0;">| filter agent_hostname not in ("BUILD-01", "BUILD-02")
| filter actor_process_image_name not in ("sccm.exe")
| filter xdm.source.user.username not ~= "^svc_"</div>
                                </li>
                                <li><strong>Adjust thresholds:</strong> If too sensitive, raise the threshold (e.g., 10 failures → 20)</li>
                                <li><strong>Test before deploying:</strong> Use "Test Rule" to verify changes would have caught true positives but not FPs</li>
                                <li><strong>Monitor:</strong> Track TP rate over 1-2 weeks after changes</li>
                            </ol>
                            <p><strong>Target:</strong> >30% true positive rate is considered healthy for most environments.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you prioritize which detection rules to build first?</button>
                        <div class="qa-answer">
                            <p><strong>Prioritization framework:</strong></p>
                            <ol>
                                <li><strong>Threat intelligence:</strong> What techniques are threat actors using against your industry? Check MITRE ATT&CK for sector-specific threats.</li>
                                <li><strong>Data availability:</strong> Can't detect what you can't see. Prioritize rules where you have good data coverage.</li>
                                <li><strong>Impact:</strong> Focus on high-impact techniques first:
                                    <ul>
                                        <li>Initial Access (phishing, exposed services)</li>
                                        <li>Credential Access (Mimikatz, brute force)</li>
                                        <li>Lateral Movement (RDP, PsExec)</li>
                                        <li>Exfiltration (large transfers, unusual destinations)</li>
                                    </ul>
                                </li>
                                <li><strong>MITRE coverage gaps:</strong> Map existing rules to ATT&CK, identify gaps, prioritize filling them.</li>
                                <li><strong>Incident history:</strong> What have you seen in past incidents? Build rules to detect similar attacks.</li>
                            </ol>
                        </div>
                    </div>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium - Security Operations Reference</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>
