<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parsing & XDM | XSIAM | Nik's SIEM Compendium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">XSIAM Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> vs Competitors</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM</a>
                    <a href="agents.html" class="nav-link"><i class="fas fa-desktop"></i> Cortex Agents</a>
                    <a href="parsing-flows.html" class="nav-link active"><i class="fas fa-stream"></i> Parsing & XDM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="correlation-rules.html" class="nav-link"><i class="fas fa-bell"></i> Correlation Rules</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention Tiers</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Parsing & XDM</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-stream"></i> Parsing & XDM Normalization</h1>
                <p class="lead">XSIAM uses a sophisticated parsing pipeline to transform raw logs into structured, normalized data. Understanding this process is essential for custom parser development and troubleshooting.</p>

                <!-- PARSING DECISION TREE -->
                <h2><i class="fas fa-route"></i> Parser Selection Decision Tree</h2>
                
                <div class="decision-tree">
                    <div class="decision-node">
                        <div class="decision-node-question">Does XSIAM have a built-in parser for this log source?</div>
                    </div>
                    <div class="decision-paths">
                        <div class="decision-path">
                            <div class="decision-path-label yes">Yes - Built-in exists</div>
                            <div class="decision-path-content">
                                <p style="color: #3fb950; font-weight: 600;">→ Use Built-in Parser</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">800+ parsers included. Auto-selected based on vendor/product detection.</p>
                            </div>
                        </div>
                        <div class="decision-path">
                            <div class="decision-path-label no">No built-in parser</div>
                            <div class="decision-path-content">
                                <p style="color: #f85149; font-weight: 600;">→ Create Custom Parser</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">Use Parsing Rules to define extraction logic.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="decision-tree">
                    <div class="decision-node">
                        <div class="decision-node-question">Is the log format standard (CEF/LEEF/JSON/Syslog RFC)?</div>
                    </div>
                    <div class="decision-paths">
                        <div class="decision-path">
                            <div class="decision-path-label yes">Standard Format</div>
                            <div class="decision-path-content">
                                <p style="color: #3fb950; font-weight: 600;">→ Use Format-based Parser</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">CEF, LEEF, JSON automatically parsed. Just map fields to XDM.</p>
                            </div>
                        </div>
                        <div class="decision-path">
                            <div class="decision-path-label no">Custom/Proprietary Format</div>
                            <div class="decision-path-content">
                                <p style="color: #d29922; font-weight: 600;">→ Build Regex Parser</p>
                                <p style="color: #8b949e; font-size: 0.85rem;">Define regex patterns for field extraction.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PARSING PIPELINE -->
                <h2><i class="fas fa-cogs"></i> Complete Parsing Pipeline</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-stream"></i> Log Processing Stages</div>
                    
                    <div class="flow-row centered">
                        <div class="flow-box"><div class="flow-box-title">Raw Log</div><div class="flow-box-subtitle">Unprocessed bytes</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box primary"><div class="flow-box-title">1. Receive</div><div class="flow-box-subtitle">Ingest layer</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box success"><div class="flow-box-title">2. Identify</div><div class="flow-box-subtitle">Source detection</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box warning"><div class="flow-box-title">3. Parse</div><div class="flow-box-subtitle">Field extraction</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box purple"><div class="flow-box-title">4. Normalize</div><div class="flow-box-subtitle">XDM mapping</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box danger"><div class="flow-box-title">5. Enrich</div><div class="flow-box-subtitle">Context add</div></div>
                        <span class="flow-arrow">→</span>
                        <div class="flow-box"><div class="flow-box-title">6. Store</div><div class="flow-box-subtitle">Data Lake</div></div>
                    </div>
                </div>

                <!-- STAGE DETAILS -->
                <h2><i class="fas fa-search-plus"></i> Stage-by-Stage Breakdown</h2>

                <!-- Stage 1: Source Identification -->
                <div class="method-card">
                    <div class="method-card-header">
                        <div class="method-card-icon blue"><i class="fas fa-fingerprint"></i></div>
                        <div>
                            <div class="method-card-title">Stage 1: Source Identification</div>
                            <div class="method-card-desc">Determine what type of log this is and which parser to use</div>
                        </div>
                    </div>
                    <div class="method-card-content">
                        <div class="method-detail">
                            <div class="method-detail-label">Detection Method 1</div>
                            <div class="method-detail-value"><strong>Port-based:</strong> UDP 514 = syslog, TCP 6514 = syslog-TLS</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Detection Method 2</div>
                            <div class="method-detail-value"><strong>Format signature:</strong> "CEF:0|" prefix = CEF format</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Detection Method 3</div>
                            <div class="method-detail-value"><strong>Vendor identification:</strong> "PAN-OS" in header = Palo Alto</div>
                        </div>
                        <div class="method-detail">
                            <div class="method-detail-label">Detection Method 4</div>
                            <div class="method-detail-value"><strong>API source:</strong> Collector type determines parser</div>
                        </div>
                    </div>
                </div>

                <!-- Stage 2: Parsing -->
                <div class="method-card">
                    <div class="method-card-header">
                        <div class="method-card-icon green"><i class="fas fa-code"></i></div>
                        <div>
                            <div class="method-card-title">Stage 2: Field Extraction (Parsing)</div>
                            <div class="method-card-desc">Extract structured fields from raw log text</div>
                        </div>
                    </div>
                </div>

                <!-- Parsing Examples -->
                <h3>Parsing Examples by Format</h3>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> CEF Format (Auto-parsed)</div>
<pre style="color: #8b949e; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Raw CEF log:</span>
<span style="color: #f0f6fc;">CEF:0|Palo Alto Networks|PAN-OS|10.0|THREAT|url|3|src=192.168.1.100 dst=8.8.8.8 
spt=54321 dpt=443 cs1=malware-site.com cs1Label=URL</span>

<span style="color: #8b949e;">// Auto-extracted fields:</span>
<span style="color: #3fb950;">vendor</span> = "Palo Alto Networks"
<span style="color: #3fb950;">product</span> = "PAN-OS"
<span style="color: #3fb950;">version</span> = "10.0"
<span style="color: #3fb950;">signature_id</span> = "THREAT"
<span style="color: #3fb950;">name</span> = "url"
<span style="color: #3fb950;">severity</span> = "3"
<span style="color: #3fb950;">src</span> = "192.168.1.100"
<span style="color: #3fb950;">dst</span> = "8.8.8.8"
<span style="color: #3fb950;">spt</span> = "54321"
<span style="color: #3fb950;">dpt</span> = "443"
<span style="color: #3fb950;">cs1</span> = "malware-site.com" <span style="color: #8b949e;">(URL)</span>
</pre>
                </div>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> JSON Format (Auto-parsed)</div>
<pre style="color: #8b949e; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Raw JSON log (AWS CloudTrail):</span>
<span style="color: #f0f6fc;">{
  "eventVersion": "1.08",
  "eventSource": "iam.amazonaws.com",
  "eventName": "CreateUser",
  "awsRegion": "us-east-1",
  "sourceIPAddress": "203.0.113.50",
  "userIdentity": {
    "type": "IAMUser",
    "userName": "admin"
  }
}</span>

<span style="color: #8b949e;">// Auto-extracted fields (dot notation):</span>
<span style="color: #3fb950;">eventVersion</span> = "1.08"
<span style="color: #3fb950;">eventSource</span> = "iam.amazonaws.com"
<span style="color: #3fb950;">eventName</span> = "CreateUser"
<span style="color: #3fb950;">userIdentity.type</span> = "IAMUser"
<span style="color: #3fb950;">userIdentity.userName</span> = "admin"
</pre>
                </div>

                <div class="code-block">
                    <div class="code-header"><i class="fas fa-code"></i> Custom Format (Regex Parser Required)</div>
<pre style="color: #8b949e; background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto;">
<span style="color: #8b949e;">// Raw proprietary log:</span>
<span style="color: #f0f6fc;">2024-01-15 10:30:45 AUTH-FAIL user=jsmith ip=10.0.0.50 reason="invalid password"</span>

<span style="color: #8b949e;">// Custom regex pattern:</span>
<span style="color: #d29922;">^(?P&lt;timestamp&gt;\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) (?P&lt;event_type&gt;[\w-]+) 
user=(?P&lt;username&gt;\w+) ip=(?P&lt;src_ip&gt;[\d.]+) reason="(?P&lt;reason&gt;[^"]+)"$</span>

<span style="color: #8b949e;">// Extracted fields:</span>
<span style="color: #3fb950;">timestamp</span> = "2024-01-15 10:30:45"
<span style="color: #3fb950;">event_type</span> = "AUTH-FAIL"
<span style="color: #3fb950;">username</span> = "jsmith"
<span style="color: #3fb950;">src_ip</span> = "10.0.0.50"
<span style="color: #3fb950;">reason</span> = "invalid password"
</pre>
                </div>

                <!-- XDM NORMALIZATION -->
                <h2><i class="fas fa-exchange-alt"></i> XDM Normalization</h2>
                
                <div class="info-box">
                    <h4><i class="fas fa-lightbulb"></i> What is XDM?</h4>
                    <p><strong>XDM (Cross Data Model)</strong> is XSIAM's standardized schema. It maps vendor-specific field names to common fields, enabling:</p>
                    <ul>
                        <li>Cross-vendor correlation rules</li>
                        <li>Unified XQL queries</li>
                        <li>Consistent dashboards</li>
                        <li>Portable detection content</li>
                    </ul>
                </div>

                <h3>XDM Field Categories</h3>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr><th>XDM Category</th><th>Common Fields</th><th>Example Mapping</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>xdm.source.*</strong></td>
                                <td>ipv4, ipv6, host, user, port, process</td>
                                <td>src_ip → xdm.source.ipv4</td>
                            </tr>
                            <tr>
                                <td><strong>xdm.target.*</strong></td>
                                <td>ipv4, ipv6, host, user, port, resource</td>
                                <td>dst_ip → xdm.target.ipv4</td>
                            </tr>
                            <tr>
                                <td><strong>xdm.network.*</strong></td>
                                <td>protocol, direction, bytes, packets</td>
                                <td>proto → xdm.network.ip_protocol</td>
                            </tr>
                            <tr>
                                <td><strong>xdm.auth.*</strong></td>
                                <td>outcome, method, service</td>
                                <td>status → xdm.auth.outcome</td>
                            </tr>
                            <tr>
                                <td><strong>xdm.event.*</strong></td>
                                <td>type, outcome, description</td>
                                <td>action → xdm.event.type</td>
                            </tr>
                            <tr>
                                <td><strong>xdm.alert.*</strong></td>
                                <td>severity, category, name</td>
                                <td>threat_level → xdm.alert.severity</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- XDM Mapping Examples -->
                <h3>XDM Mapping Examples by Vendor</h3>

                <div class="comparison-grid">
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #4d3a0d; color: #d29922;"><i class="fas fa-fire"></i></div>
                            <div class="comparison-item-title">Palo Alto NGFW</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-arrow-right"></i> src → xdm.source.ipv4</li>
                            <li><i class="fas fa-arrow-right"></i> dst → xdm.target.ipv4</li>
                            <li><i class="fas fa-arrow-right"></i> sport → xdm.source.port</li>
                            <li><i class="fas fa-arrow-right"></i> dport → xdm.target.port</li>
                            <li><i class="fas fa-arrow-right"></i> user → xdm.source.user.username</li>
                            <li><i class="fas fa-arrow-right"></i> app → xdm.network.application_protocol</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1c3a5e; color: #58a6ff;"><i class="fab fa-windows"></i></div>
                            <div class="comparison-item-title">Windows Security</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-arrow-right"></i> IpAddress → xdm.source.ipv4</li>
                            <li><i class="fas fa-arrow-right"></i> TargetUserName → xdm.target.user.username</li>
                            <li><i class="fas fa-arrow-right"></i> SubjectUserName → xdm.source.user.username</li>
                            <li><i class="fas fa-arrow-right"></i> WorkstationName → xdm.source.host.hostname</li>
                            <li><i class="fas fa-arrow-right"></i> EventID → xdm.event.id</li>
                            <li><i class="fas fa-arrow-right"></i> Status → xdm.auth.outcome</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #1a4d2e; color: #3fb950;"><i class="fas fa-id-card"></i></div>
                            <div class="comparison-item-title">Okta</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-arrow-right"></i> client.ipAddress → xdm.source.ipv4</li>
                            <li><i class="fas fa-arrow-right"></i> actor.displayName → xdm.source.user.username</li>
                            <li><i class="fas fa-arrow-right"></i> outcome.result → xdm.auth.outcome</li>
                            <li><i class="fas fa-arrow-right"></i> eventType → xdm.event.type</li>
                            <li><i class="fas fa-arrow-right"></i> target[0].displayName → xdm.target.resource.name</li>
                            <li><i class="fas fa-arrow-right"></i> client.userAgent → xdm.source.user_agent</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-item-header">
                            <div class="comparison-item-icon" style="background: #3d2a5e; color: #a371f7;"><i class="fab fa-aws"></i></div>
                            <div class="comparison-item-title">AWS CloudTrail</div>
                        </div>
                        <ul class="comparison-item-list">
                            <li><i class="fas fa-arrow-right"></i> sourceIPAddress → xdm.source.ipv4</li>
                            <li><i class="fas fa-arrow-right"></i> userIdentity.userName → xdm.source.user.username</li>
                            <li><i class="fas fa-arrow-right"></i> eventName → xdm.event.operation</li>
                            <li><i class="fas fa-arrow-right"></i> awsRegion → xdm.target.cloud.region</li>
                            <li><i class="fas fa-arrow-right"></i> errorCode → xdm.event.outcome</li>
                            <li><i class="fas fa-arrow-right"></i> userAgent → xdm.source.user_agent</li>
                        </ul>
                    </div>
                </div>

                <!-- CUSTOM PARSING RULES -->
                <h2><i class="fas fa-wrench"></i> Creating Custom Parsing Rules</h2>

                <div class="pipeline">
                    <div class="pipeline-stage" data-step="1">
                        <div class="pipeline-stage-title">Identify Log Format</div>
                        <div class="pipeline-stage-desc">Analyze sample logs to understand structure</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>Collect 10-20 sample log entries</li>
                                <li>Identify delimiters (space, comma, pipe)</li>
                                <li>Note timestamp format</li>
                                <li>Identify key fields needed for security</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="2">
                        <div class="pipeline-stage-title">Build Regex Pattern</div>
                        <div class="pipeline-stage-desc">Create extraction pattern with named groups</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>Use named capture groups: (?P&lt;field&gt;pattern)</li>
                                <li>Test pattern against all sample logs</li>
                                <li>Handle edge cases and optional fields</li>
                                <li>Optimize for performance (avoid backtracking)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="3">
                        <div class="pipeline-stage-title">Map to XDM</div>
                        <div class="pipeline-stage-desc">Define XDM field mappings for extracted fields</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>Map source IP to xdm.source.ipv4</li>
                                <li>Map username to xdm.source.user.username</li>
                                <li>Map action/outcome to xdm.event.* fields</li>
                                <li>Preserve original fields for reference</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="pipeline-stage" data-step="4">
                        <div class="pipeline-stage-title">Test & Deploy</div>
                        <div class="pipeline-stage-desc">Validate parsing and deploy to production</div>
                        <div class="pipeline-stage-details">
                            <ul>
                                <li>Test with historical data</li>
                                <li>Verify XDM fields populate correctly</li>
                                <li>Check for parsing errors in logs</li>
                                <li>Monitor for unparsed events</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Enterprise Example -->
                <div class="enterprise-example">
                    <div class="enterprise-example-header">
                        <i class="fas fa-building"></i>
                        <div class="enterprise-example-title">Enterprise Example: Custom Application Parser</div>
                    </div>
                    <div class="enterprise-example-scenario">
                        <strong>Scenario:</strong> Custom internal application generates security-relevant logs but has no XSIAM parser. Need to create custom parsing rule.
                    </div>
                    
                    <div class="code-block" style="margin-top: 16px;">
                        <div class="code-header"><i class="fas fa-file-alt"></i> Sample Log Entry</div>
<pre style="color: #f0f6fc; background: #0d1117; padding: 16px; border-radius: 8px;">
[2024-01-15T10:30:45.123Z] SECURITY event=LOGIN_FAILED user=jsmith@company.com 
client_ip=192.168.1.100 app=HR_Portal reason="invalid_credentials" mfa=false
</pre>
                    </div>

                    <div class="code-block" style="margin-top: 16px;">
                        <div class="code-header"><i class="fas fa-code"></i> Custom Parsing Rule</div>
<pre style="color: #8b949e; background: #0d1117; padding: 16px; border-radius: 8px;">
<span style="color: #d29922;">// Regex Pattern</span>
^\[(?P&lt;timestamp&gt;[^\]]+)\] (?P&lt;log_level&gt;\w+) event=(?P&lt;event_type&gt;\w+) 
user=(?P&lt;username&gt;[^\s]+) client_ip=(?P&lt;src_ip&gt;[\d.]+) app=(?P&lt;application&gt;\w+) 
reason="(?P&lt;reason&gt;[^"]*)" mfa=(?P&lt;mfa_used&gt;\w+)

<span style="color: #3fb950;">// XDM Mappings</span>
timestamp → _time
src_ip → xdm.source.ipv4
username → xdm.source.user.username  
event_type → xdm.event.type
application → xdm.target.application.name
reason → xdm.event.outcome_reason
mfa_used → xdm.auth.mfa.is_valid
</pre>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question">Q: How does XSIAM determine which parser to use for incoming logs?</button>
                        <div class="qa-answer">
                            <p><strong>Parser selection process:</strong></p>
                            <ol>
                                <li><strong>API source:</strong> If from cloud collector, parser is predetermined</li>
                                <li><strong>Port-based:</strong> Certain ports map to specific formats (514=syslog)</li>
                                <li><strong>Format detection:</strong> Check for CEF:, LEEF:, JSON opening brace</li>
                                <li><strong>Vendor signature:</strong> Scan for vendor identifiers in log content</li>
                                <li><strong>Fallback:</strong> Generic syslog parser if no match</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: What do you do when logs aren't parsing correctly?</button>
                        <div class="qa-answer">
                            <p><strong>Troubleshooting steps:</strong></p>
                            <ol>
                                <li><strong>Check raw logs:</strong> Query xdr_data with raw_log field</li>
                                <li><strong>Verify parser assignment:</strong> Check vendor/product detection</li>
                                <li><strong>Review parsing errors:</strong> Look for _parsing_error field</li>
                                <li><strong>Test regex:</strong> Use regex tester with sample logs</li>
                                <li><strong>Check timestamp:</strong> Verify TIME_FORMAT matches log format</li>
                                <li><strong>Create override:</strong> Custom parser if built-in doesn't work</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question">Q: Why is XDM normalization important for detection?</button>
                        <div class="qa-answer">
                            <p><strong>XDM enables:</strong></p>
                            <ul>
                                <li><strong>Cross-vendor correlation:</strong> One rule detects across Palo Alto, Windows, AWS</li>
                                <li><strong>Query portability:</strong> XQL using xdm.source.ipv4 works for any source</li>
                                <li><strong>Consistent analytics:</strong> ML models trained on normalized data</li>
                                <li><strong>Content reuse:</strong> Download detection rules that work out-of-box</li>
                            </ul>
                            <p><strong>Example:</strong> A "brute force" rule using xdm.auth.outcome="FAILURE" and xdm.source.user.username detects attacks from Windows, Okta, VPN, and cloud providers - all with one rule.</p>
                        </div>
                    </div>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) {
                    answer.style.display = 'block';
                    btn.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
