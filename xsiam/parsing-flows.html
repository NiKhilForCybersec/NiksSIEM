<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parsing & XDM Normalization | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .config-section { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .console-path { background: #0d1117; padding: 8px 12px; border-radius: 4px; font-family: monospace; font-size: 0.85rem; color: #58a6ff; margin: 8px 0; display: inline-block; }
        .code-block { background: #0d1117; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 12px 0; font-family: 'Fira Code', monospace; font-size: 0.85rem; overflow-x: auto; white-space: pre; }
        .field-mapping { display: grid; grid-template-columns: 1fr auto 1fr; gap: 12px; align-items: center; padding: 8px 0; border-bottom: 1px solid #30363d; }
        .field-raw { background: #21262d; padding: 4px 8px; border-radius: 4px; font-family: monospace; font-size: 0.85rem; }
        .field-xdm { background: #1a4d2e; padding: 4px 8px; border-radius: 4px; font-family: monospace; font-size: 0.85rem; color: #3fb950; }
        .arrow { color: #58a6ff; font-weight: bold; }
    </style>
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">XSIAM Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> vs Competitors</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="custom-log-onboarding.html" class="nav-link"><i class="fas fa-file-import"></i> Custom Log Onboarding</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM</a>
                    <a href="agents.html" class="nav-link"><i class="fas fa-desktop"></i> Cortex Agents</a>
                    <a href="parsing-flows.html" class="nav-link active"><i class="fas fa-stream"></i> Parsing & XDM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> XQL Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> XQL Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="correlation-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> Correlation Rules</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intelligence</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                    <a href="xdr-overview.html" class="nav-link"><i class="fas fa-crosshairs"></i> XDR Capabilities</a>
                    <a href="recon-asm.html" class="nav-link"><i class="fas fa-globe"></i> ASM / Xpanse</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention & Storage</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                    <a href="enterprise-soc.html" class="nav-link"><i class="fas fa-building"></i> Enterprise SOC</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Parsing & XDM</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-stream"></i> Parsing & XDM Normalization</h1>
                <p class="lead">Understanding how XSIAM parses raw logs and maps them to the XDM (XSIAM Data Model) is crucial for effective querying and detection engineering. This guide covers the parsing pipeline, XDM field reference, and custom parser creation.</p>

                <!-- What is XDM -->
                <h2><i class="fas fa-database"></i> What is XDM (XSIAM Data Model)?</h2>
                
                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-lightbulb"></i> XDM Explained</h4>
                    <p><strong>XDM is XSIAM's normalization schema</strong> - a standard set of field names that all log sources are mapped to. This means you can write ONE query that works across firewalls, endpoints, cloud logs, and any other source.</p>
                </div>

                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-random"></i> Why XDM Matters</div>
                    <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; margin-top: 16px; align-items: center;">
                        <div>
                            <h4 style="color: #f85149; text-align: center;">Without Normalization</h4>
                            <div style="background: #21262d; padding: 12px; border-radius: 6px; font-family: monospace; font-size: 0.8rem;">
                                <div style="margin-bottom: 8px;"><span style="color: #8b949e;">Palo Alto:</span> src_ip</div>
                                <div style="margin-bottom: 8px;"><span style="color: #8b949e;">Cisco ASA:</span> srcAddress</div>
                                <div style="margin-bottom: 8px;"><span style="color: #8b949e;">AWS:</span> sourceIPAddress</div>
                                <div><span style="color: #8b949e;">Windows:</span> IpAddress</div>
                            </div>
                            <p style="color: #f85149; font-size: 0.85rem; text-align: center; margin-top: 8px;">4 different queries needed!</p>
                        </div>
                        <div style="font-size: 2rem; color: #58a6ff;">→</div>
                        <div>
                            <h4 style="color: #3fb950; text-align: center;">With XDM</h4>
                            <div style="background: #1a4d2e; padding: 12px; border-radius: 6px; font-family: monospace; font-size: 0.8rem;">
                                <div style="margin-bottom: 8px;"><span style="color: #8b949e;">All sources:</span> <span style="color: #3fb950;">xdm.source.ipv4</span></div>
                            </div>
                            <p style="color: #3fb950; font-size: 0.85rem; text-align: center; margin-top: 8px;">ONE query works everywhere!</p>
                        </div>
                    </div>
                </div>

                <!-- XDM Field Categories -->
                <h2><i class="fas fa-layer-group"></i> XDM Field Categories</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Prefix</th>
                                <th>Common Fields</th>
                                <th>Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Source</strong></td>
                                <td><code>xdm.source.*</code></td>
                                <td>ipv4, ipv6, host.hostname, port, user.username</td>
                                <td>Where traffic/action originated</td>
                            </tr>
                            <tr>
                                <td><strong>Target</strong></td>
                                <td><code>xdm.target.*</code></td>
                                <td>ipv4, ipv6, host.hostname, port, user.username</td>
                                <td>Destination of traffic/action</td>
                            </tr>
                            <tr>
                                <td><strong>Event</strong></td>
                                <td><code>xdm.event.*</code></td>
                                <td>type, outcome, description, original_event_type</td>
                                <td>What happened</td>
                            </tr>
                            <tr>
                                <td><strong>Network</strong></td>
                                <td><code>xdm.network.*</code></td>
                                <td>protocol, application_protocol, direction</td>
                                <td>Network context</td>
                            </tr>
                            <tr>
                                <td><strong>Auth</strong></td>
                                <td><code>xdm.auth.*</code></td>
                                <td>auth_method, outcome, privilege_level</td>
                                <td>Authentication events</td>
                            </tr>
                            <tr>
                                <td><strong>Observer</strong></td>
                                <td><code>xdm.observer.*</code></td>
                                <td>type, name, vendor, product</td>
                                <td>Device that generated log</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Complete XDM Field Reference -->
                <h2><i class="fas fa-book"></i> XDM Field Reference (Most Used)</h2>
                
                <div class="config-section">
                    <h3>Source Fields (xdm.source.*)</h3>
                    <div style="font-family: monospace; font-size: 0.85rem;">
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.ipv4</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source IPv4 address</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.ipv6</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source IPv6 address</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.port</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source port number</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.host.hostname</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source hostname</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.user.username</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source username</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.user.domain</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source user domain</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.process.name</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source process name</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.source.process.pid</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Source process ID</span>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h3>Target Fields (xdm.target.*)</h3>
                    <div style="font-family: monospace; font-size: 0.85rem;">
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.ipv4</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Destination IPv4 address</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.port</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Destination port number</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.host.hostname</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Destination hostname</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.user.username</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Target username (for auth events)</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.url</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Target URL</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.file.path</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Target file path</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.target.file.sha256</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Target file SHA256 hash</span>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h3>Event Fields (xdm.event.*)</h3>
                    <div style="font-family: monospace; font-size: 0.85rem;">
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.type</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Event type (NETWORK, AUTH, PROCESS, FILE)</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.outcome</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Outcome (SUCCESS, FAILURE, UNKNOWN)</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.operation</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Operation performed</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.description</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Human-readable description</span>
                        </div>
                        <div class="field-mapping">
                            <span class="field-xdm">xdm.event.original_event_type</span>
                            <span style="color: #8b949e;">→</span>
                            <span style="color: #8b949e;">Original event type from source</span>
                        </div>
                    </div>
                </div>

                <!-- Example Mappings by Source -->
                <h2><i class="fas fa-exchange-alt"></i> Example Field Mappings by Source</h2>
                
                <div class="config-section">
                    <h3>Palo Alto NGFW → XDM</h3>
                    <div class="code-block">
<span style="color: #8b949e;">// Raw Palo Alto fields → XDM normalized fields</span>

src                     →  xdm.source.ipv4
dst                     →  xdm.target.ipv4
sport                   →  xdm.source.port
dport                   →  xdm.target.port
srcuser                 →  xdm.source.user.username
action                  →  xdm.event.outcome (allow=SUCCESS, deny=FAILURE)
app                     →  xdm.network.application_protocol
rule                    →  xdm.alert.name
bytes_sent              →  xdm.source.sent_bytes
bytes_received          →  xdm.target.sent_bytes
                    </div>
                </div>

                <div class="config-section">
                    <h3>Windows Security Events → XDM</h3>
                    <div class="code-block">
<span style="color: #8b949e;">// Windows Event ID 4624 (Successful Logon) → XDM</span>

TargetUserName          →  xdm.target.user.username
TargetDomainName        →  xdm.target.user.domain
IpAddress               →  xdm.source.ipv4
LogonType               →  xdm.auth.auth_method
WorkstationName         →  xdm.source.host.hostname
SubjectUserName         →  xdm.source.user.username
EventID                 →  xdm.event.original_event_type
Status                  →  xdm.event.outcome

<span style="color: #8b949e;">// Logon Type mapping:</span>
<span style="color: #8b949e;">// 2 = Interactive, 3 = Network, 10 = RemoteInteractive (RDP)</span>
                    </div>
                </div>

                <div class="config-section">
                    <h3>AWS CloudTrail → XDM</h3>
                    <div class="code-block">
<span style="color: #8b949e;">// AWS CloudTrail fields → XDM</span>

sourceIPAddress         →  xdm.source.ipv4
userIdentity.userName   →  xdm.source.user.username
eventName               →  xdm.event.operation
eventSource             →  xdm.observer.name
awsRegion               →  xdm.observer.location
errorCode               →  xdm.event.outcome (null=SUCCESS, else=FAILURE)
eventType               →  xdm.event.type
                    </div>
                </div>

                <!-- Using XDM in Queries -->
                <h2><i class="fas fa-terminal"></i> Using XDM Fields in XQL Queries</h2>
                
                <div class="config-section">
                    <h4>Query That Works Across ALL Sources</h4>
                    <div class="code-block">
<span style="color: #8b949e;">// Find all failed authentications from any source</span>
<span style="color: #ff7b72;">dataset</span> = xdr_data, panw_ngfw_traffic_raw, microsoft_windows_raw, aws_cloudtrail_raw
| <span style="color: #ff7b72;">filter</span> xdm.event.type = "AUTH"
| <span style="color: #ff7b72;">filter</span> xdm.event.outcome = "FAILURE"
| <span style="color: #ff7b72;">comp</span> failed_attempts = <span style="color: #d2a8ff;">count</span>() <span style="color: #ff7b72;">by</span> xdm.target.user.username, xdm.source.ipv4
| <span style="color: #ff7b72;">filter</span> failed_attempts >= 5
| <span style="color: #ff7b72;">sort</span> desc failed_attempts
                    </div>
                    <p style="color: #3fb950; margin-top: 12px;">This single query detects brute force attacks whether they hit your firewall, Windows servers, or cloud resources!</p>
                </div>

                <div class="config-section">
                    <h4>Network Connections to Specific Port</h4>
                    <div class="code-block">
<span style="color: #8b949e;">// Find all connections to port 3389 (RDP) from any source</span>
<span style="color: #ff7b72;">dataset</span> = xdr_data, panw_ngfw_traffic_raw
| <span style="color: #ff7b72;">filter</span> xdm.target.port = 3389
| <span style="color: #ff7b72;">fields</span> _time, xdm.source.ipv4, xdm.target.ipv4, xdm.source.user.username
| <span style="color: #ff7b72;">sort</span> desc _time
| <span style="color: #ff7b72;">limit</span> 100
                    </div>
                </div>

                <!-- Custom Parser Creation -->
                <h2><i class="fas fa-plus-circle"></i> Creating Custom Parsers</h2>
                
                <div class="config-section">
                    <div class="console-path">Settings → Data Sources → Parsing Rules → + New Parsing Rule</div>
                    
                    <div class="info-box" style="border-color: #d29922;">
                        <h4><i class="fas fa-exclamation-triangle"></i> When You Need Custom Parsers</h4>
                        <ul style="color: #8b949e;">
                            <li>Ingesting logs from unsupported vendors</li>
                            <li>Custom application logs</li>
                            <li>Logs with non-standard formats</li>
                            <li>Need to extract additional fields not in default parser</li>
                        </ul>
                    </div>

                    <h4>Custom Parser Example (JSON Log)</h4>
                    <div class="code-block">
<span style="color: #8b949e;">// Sample raw log (custom application):</span>
{"timestamp":"2024-02-15T14:30:00Z","user":"jsmith","action":"login","src_ip":"10.0.1.50","result":"success"}

<span style="color: #8b949e;">// Parsing rule definition:</span>
[PARSER]
name = custom_app_auth
vendor = CustomCorp
product = MyApp
format = json

[MAPPING]
_time = json_extract(raw, "$.timestamp")
xdm.source.user.username = json_extract(raw, "$.user")
xdm.event.operation = json_extract(raw, "$.action")
xdm.source.ipv4 = json_extract(raw, "$.src_ip")
xdm.event.outcome = if(json_extract(raw, "$.result") = "success", "SUCCESS", "FAILURE")
                    </div>

                    <h4>Custom Parser Example (Syslog/Regex)</h4>
                    <div class="code-block">
<span style="color: #8b949e;">// Sample raw log (legacy syslog):</span>
Feb 15 14:30:00 server01 myapp: USER=jsmith ACTION=login SRC=10.0.1.50 STATUS=OK

<span style="color: #8b949e;">// Parsing rule with regex:</span>
[PARSER]
name = legacy_app_syslog
vendor = LegacyCorp
product = LegacyApp
format = syslog

[EXTRACT]
pattern = USER=(?P&lt;user&gt;\S+)\s+ACTION=(?P&lt;action&gt;\S+)\s+SRC=(?P&lt;src_ip&gt;\S+)\s+STATUS=(?P&lt;status&gt;\S+)

[MAPPING]
xdm.source.user.username = user
xdm.event.operation = action
xdm.source.ipv4 = src_ip
xdm.event.outcome = if(status = "OK", "SUCCESS", "FAILURE")
                    </div>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is XDM and why is it important for detection engineering?</button>
                        <div class="qa-answer">
                            <p><strong>XDM (XSIAM Data Model) is XSIAM's normalization schema that maps all log sources to standard field names.</strong></p>
                            <p><strong>Why it matters:</strong></p>
                            <ul>
                                <li><strong>Write once, detect everywhere:</strong> One correlation rule can detect attacks across firewall, endpoint, cloud, and identity logs</li>
                                <li><strong>Faster investigations:</strong> No need to remember that Palo Alto uses "src" while Windows uses "IpAddress" - both map to xdm.source.ipv4</li>
                                <li><strong>Easier onboarding:</strong> New data sources automatically work with existing rules if properly mapped</li>
                            </ul>
                            <p><strong>Key XDM categories:</strong></p>
                            <ul>
                                <li><code>xdm.source.*</code> - Where it came from (IP, user, process)</li>
                                <li><code>xdm.target.*</code> - Where it went (IP, port, file)</li>
                                <li><code>xdm.event.*</code> - What happened (type, outcome)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you create a detection rule that works across multiple log sources?</button>
                        <div class="qa-answer">
                            <p><strong>Use XDM normalized fields instead of raw fields:</strong></p>
                            <div class="code-block" style="margin: 8px 0;">// WRONG - Only works for Palo Alto
dataset = panw_ngfw_traffic_raw
| filter src_ip = "10.0.0.5"

// RIGHT - Works for ANY source
dataset = panw_ngfw_traffic_raw, xdr_data, aws_cloudtrail_raw
| filter xdm.source.ipv4 = "10.0.0.5"</div>
                            <p><strong>Key principle:</strong> Always use xdm.* fields in correlation rules. Raw fields (src_ip, sourceIPAddress, etc.) are source-specific and won't match across different log types.</p>
                        </div>
                    </div>
                </div>

            </main>
            <footer class="main-footer">
                <div class="footer-content">
                    <p>Nik's SIEM Compendium - Security Operations Reference</p>
                </div>
            </footer>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>
