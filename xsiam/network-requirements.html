<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Requirements | XSIAM Architecture</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
                <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link active"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>




        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Network Requirements</span>
                </div>

                <h1><i class="fas fa-network-wired"></i> Network Requirements</h1>
                <p class="lead">Complete network architecture guide for XSIAM deployment including firewall rules, proxy configuration, bandwidth requirements, and connectivity troubleshooting.</p>

                <!-- Network Architecture Overview -->
                <h2><i class="fas fa-sitemap"></i> Network Architecture Overview</h2>
                
                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-info-circle"></i> XSIAM Network Model</h4>
                    <p>XSIAM is a cloud-native platform. All components communicate outbound to Palo Alto Networks cloud infrastructure. There are no inbound connections required from the internet to your network. Understanding the communication flows helps design firewall rules and troubleshoot connectivity issues.</p>
                </div>

                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-project-diagram"></i> XSIAM Network Communication Flows</div>
<pre style="color: #8b949e; font-size: 0.75rem; line-height: 1.5; overflow-x: auto;">
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    YOUR NETWORK                                                  │
│                                                                                                  │
│   ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐                        │
│   │   ENDPOINTS     │      │   BROKER VM     │      │   SOC USERS     │                        │
│   │   (Agents)      │      │   (Collector)   │      │   (Browser)     │                        │
│   │                 │      │                 │      │                 │                        │
│   │ Windows/Mac/    │      │ Syslog/CEF/     │      │ Web Console     │                        │
│   │ Linux Servers   │      │ LEEF Receivers  │      │ Access          │                        │
│   └────────┬────────┘      └────────┬────────┘      └────────┬────────┘                        │
│            │                        │                        │                                  │
│            │ :443 (HTTPS)           │ :443 (HTTPS)           │ :443 (HTTPS)                    │
│            │                        │                        │                                  │
└────────────┼────────────────────────┼────────────────────────┼──────────────────────────────────┘
             │                        │                        │
             │    ┌───────────────────┼────────────────────────┘
             │    │                   │
             ▼    ▼                   ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                              FIREWALL / PROXY                                                    │
│                                                                                                  │
│   Required Outbound Rules:                                                                       │
│   • *.paloaltonetworks.com:443 (Agent + Broker + Console)                                       │
│   • *.panw.cloud:443 (Telemetry)                                                                │
│   • CDN endpoints for content updates                                                           │
│                                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
             │
             │  All traffic is OUTBOUND on TCP/443
             │  TLS 1.2+ encrypted
             │  Certificate pinning on agents
             ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│                           PALO ALTO NETWORKS CLOUD                                               │
│                                                                                                  │
│   ┌──────────────────────────────────────────────────────────────────────────────────────────┐  │
│   │                              REGIONAL CLOUD INSTANCE                                      │  │
│   │                                                                                           │  │
│   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │  │
│   │  │ Ingestion   │  │ Processing  │  │ Detection   │  │ Storage     │  │ API/Portal  │    │  │
│   │  │ Gateway     │  │ Pipeline    │  │ Engine      │  │ Layer       │  │ Services    │    │  │
│   │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │  │
│   │                                                                                           │  │
│   └──────────────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                                  │
│   Regions: US, EU, UK, AU, JP, SG, CA, IN                                                       │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
                </div>

                <!-- Required Endpoints -->
                <h2><i class="fas fa-list-alt"></i> Required Network Endpoints</h2>
                
                <div class="warning-box">
                    <h4><i class="fas fa-exclamation-triangle"></i> Important Note</h4>
                    <p>Palo Alto Networks uses dynamic cloud infrastructure. While specific IPs are available, they may change. <strong>Always configure firewall rules using FQDNs</strong> where possible. If IP-based rules are required, subscribe to Palo Alto's IP change notifications.</p>
                </div>

                <h3>Core Platform Endpoints</h3>
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>FQDN Pattern</th>
                            <th>Port</th>
                            <th>Protocol</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong style="color: #3fb950;">XDR Agent</strong></td>
                            <td>*.xdr.*.paloaltonetworks.com</td>
                            <td>443</td>
                            <td>HTTPS</td>
                            <td>Agent communication, telemetry</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #3fb950;">XDR Agent</strong></td>
                            <td>distributions.traps.paloaltonetworks.com</td>
                            <td>443</td>
                            <td>HTTPS</td>
                            <td>Agent updates, content</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #58a6ff;">Broker VM</strong></td>
                            <td>*.broker.xdr.*.paloaltonetworks.com</td>
                            <td>443</td>
                            <td>HTTPS</td>
                            <td>Log forwarding</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #a371f7;">Web Console</strong></td>
                            <td>[tenant].xdr.*.paloaltonetworks.com</td>
                            <td>443</td>
                            <td>HTTPS</td>
                            <td>User interface access</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #d29922;">API</strong></td>
                            <td>api-[tenant].xdr.*.paloaltonetworks.com</td>
                            <td>443</td>
                            <td>HTTPS</td>
                            <td>API integrations</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #f85149;">Threat Intel</strong></td>
                            <td>*.autofocus.paloaltonetworks.com</td>
                            <td>443</td>
                            <td>HTTPS</td>
                            <td>Threat intelligence feeds</td>
                        </tr>
                        <tr>
                            <td><strong>WildFire</strong></td>
                            <td>wildfire.paloaltonetworks.com</td>
                            <td>443</td>
                            <td>HTTPS</td>
                            <td>Malware analysis</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Regional Endpoint Reference</h3>
                <div class="config-section">
                    <h4>Endpoint URLs by Region</h4>
                    <div class="arch-diagram"># XSIAM Regional Endpoints
# ═══════════════════════════════════════════════════════════════

## United States (US)
Agent/Broker:     *.xdr.us.paloaltonetworks.com
Console:          [tenant].xdr.us.paloaltonetworks.com
API:              api-[tenant].xdr.us.paloaltonetworks.com

## Europe (EU - Netherlands)
Agent/Broker:     *.xdr.eu.paloaltonetworks.com
Console:          [tenant].xdr.eu.paloaltonetworks.com
API:              api-[tenant].xdr.eu.paloaltonetworks.com

## United Kingdom (UK)
Agent/Broker:     *.xdr.uk.paloaltonetworks.com
Console:          [tenant].xdr.uk.paloaltonetworks.com
API:              api-[tenant].xdr.uk.paloaltonetworks.com

## Japan (JP)
Agent/Broker:     *.xdr.jp.paloaltonetworks.com
Console:          [tenant].xdr.jp.paloaltonetworks.com
API:              api-[tenant].xdr.jp.paloaltonetworks.com

## Singapore (SG)
Agent/Broker:     *.xdr.sg.paloaltonetworks.com
Console:          [tenant].xdr.sg.paloaltonetworks.com
API:              api-[tenant].xdr.sg.paloaltonetworks.com

## Australia (AU)
Agent/Broker:     *.xdr.au.paloaltonetworks.com
Console:          [tenant].xdr.au.paloaltonetworks.com
API:              api-[tenant].xdr.au.paloaltonetworks.com

## Canada (CA)
Agent/Broker:     *.xdr.ca.paloaltonetworks.com
Console:          [tenant].xdr.ca.paloaltonetworks.com
API:              api-[tenant].xdr.ca.paloaltonetworks.com

# ═══════════════════════════════════════════════════════════════
# NOTE: Replace [tenant] with your actual tenant identifier
# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Firewall Rules -->
                <h2><i class="fas fa-shield-alt"></i> Firewall Rule Configuration</h2>
                
                <div class="config-section">
                    <h4>Palo Alto NGFW Configuration</h4>
                    <div class="arch-diagram"># Palo Alto NGFW - XSIAM Allow Rules
# ═══════════════════════════════════════════════════════════════

# Application-based rules (recommended approach)

## Rule 1: XDR Agent Communication
Name:           Allow-XDR-Agents
Source Zone:    Trust (or endpoint zones)
Source:         Any (or endpoint subnets)
Destination:    Any
Application:    cortex-xdr
Service:        application-default (443/tcp)
Action:         Allow
Log:            At session end

## Rule 2: Broker VM Communication  
Name:           Allow-XDR-Broker
Source Zone:    DMZ (or Broker VM zone)
Source:         Broker-VM-Subnet
Destination:    Any
Application:    cortex-xdr
Service:        application-default (443/tcp)
Action:         Allow
Log:            At session end

## Rule 3: SOC User Console Access
Name:           Allow-XDR-Console
Source Zone:    Trust
Source:         SOC-User-Subnet
Destination:    Any
Application:    ssl, web-browsing
URL Category:   paloaltonetworks-cloud
Service:        application-default
Action:         Allow
Log:            At session end

# ═══════════════════════════════════════════════════════════════
# If using URL filtering, create custom category for:
# *.paloaltonetworks.com
# *.panw.cloud
# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <div class="config-section">
                    <h4>Generic Firewall Rules (Non-PANW)</h4>
                    <div class="arch-diagram"># Generic Firewall Rules for XSIAM
# ═══════════════════════════════════════════════════════════════

## Rule 1: XDR Agent Outbound
Source:         Internal endpoint subnets
Destination:    *.xdr.*.paloaltonetworks.com
                *.traps.paloaltonetworks.com
                distributions.traps.paloaltonetworks.com
Port:           TCP/443
Action:         ALLOW

## Rule 2: Broker VM Outbound
Source:         Broker VM IP addresses
Destination:    *.broker.xdr.*.paloaltonetworks.com
                *.xdr.*.paloaltonetworks.com
Port:           TCP/443
Action:         ALLOW

## Rule 3: Console/API Access
Source:         SOC workstations, automation servers
Destination:    [tenant].xdr.*.paloaltonetworks.com
                api-[tenant].xdr.*.paloaltonetworks.com
Port:           TCP/443
Action:         ALLOW

## Rule 4: Content & Updates
Source:         Endpoints, Broker VMs
Destination:    *.paloaltonetworks.com
                *.panw.cloud
Port:           TCP/443
Action:         ALLOW

## Rule 5: Threat Intelligence
Source:         Broker VMs, XSOAR
Destination:    *.autofocus.paloaltonetworks.com
                wildfire.paloaltonetworks.com
Port:           TCP/443
Action:         ALLOW

# ═══════════════════════════════════════════════════════════════
# NOTE: If your firewall requires IP addresses instead of FQDNs,
# consult Palo Alto documentation for current IP ranges
# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Proxy Configuration -->
                <h2><i class="fas fa-server"></i> Proxy Configuration</h2>
                
                <div class="info-box" style="border-color: #a371f7;">
                    <h4><i class="fas fa-lightbulb"></i> Proxy Support</h4>
                    <p>XSIAM components support proxy configurations for environments where direct internet access is restricted. The Cortex XDR agent, Broker VM, and XSOAR all support HTTP/HTTPS proxy with optional authentication.</p>
                </div>

                <h3>Proxy Decision Tree</h3>
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>Does your environment require a proxy for internet access?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ NO</div>
                            <div class="decision-node yes" style="background: #1a4d2e;">
                                <strong style="color: #3fb950;">Direct Connection</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Configure firewall rules only<br>No proxy configuration needed</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ YES</div>
                            <div class="decision-node question">
                                <strong>Does your proxy require authentication?</strong>
                            </div>
                            <div class="decision-branch">
                                <div>
                                    <div class="decision-arrow">↓ NO</div>
                                    <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                        <strong>Transparent/Anonymous Proxy</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">Configure proxy URL only<br>http://proxy.company.com:8080</div>
                                    </div>
                                </div>
                                <div>
                                    <div class="decision-arrow">↓ YES</div>
                                    <div class="decision-node question">
                                        <strong>What authentication type?</strong>
                                    </div>
                                    <div class="decision-branch">
                                        <div>
                                            <div class="decision-arrow">↓ Basic Auth</div>
                                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                                <strong>Basic Authentication</strong>
                                                <div style="color: #8b949e; font-size: 0.85rem;">http://user:pass@proxy:8080<br>Supported by all components</div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="decision-arrow">↓ NTLM/Kerberos</div>
                                            <div class="decision-node no" style="background: #4d1a1a;">
                                                <strong style="color: #f85149;">Complex Auth</strong>
                                                <div style="color: #8b949e; font-size: 0.85rem;">May need proxy exception<br>or intermediate proxy</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>XDR Agent Proxy Configuration</h4>
                    <div class="arch-diagram"># Windows Agent Proxy Configuration
# ═══════════════════════════════════════════════════════════════

## Method 1: During Installation (MSI)
msiexec /i cortex.msi PROXY_SERVER="http://proxy.company.com:8080"

## Method 2: Post-Installation (Registry)
# Key: HKLM\SOFTWARE\Palo Alto Networks\Traps
# Value: ProxyServer (REG_SZ)
# Data: http://proxy.company.com:8080

## Method 3: With Authentication
# URL format with basic auth:
http://username:password@proxy.company.com:8080

## Method 4: Using cytool (command line)
# Check current proxy:
cytool proxy show

# Set proxy:
cytool proxy set http://proxy.company.com:8080

# Clear proxy:
cytool proxy clear

# ═══════════════════════════════════════════════════════════════

# Linux Agent Proxy Configuration
# ═══════════════════════════════════════════════════════════════

## Method 1: Environment Variable
export HTTPS_PROXY="http://proxy.company.com:8080"

## Method 2: Configuration File
# Edit: /etc/traps/traps.conf
# Add: proxy_server=http://proxy.company.com:8080

## Method 3: Installation Parameter
./cortex-install.sh --proxy http://proxy.company.com:8080

# ═══════════════════════════════════════════════════════════════

# macOS Agent Proxy Configuration
# ═══════════════════════════════════════════════════════════════

## Uses system proxy settings by default
# Or set via cytool:
sudo /Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool proxy set http://proxy.company.com:8080</div>
                </div>

                <div class="config-section">
                    <h4>Broker VM Proxy Configuration</h4>
                    <div class="arch-diagram"># Broker VM Proxy Configuration
# ═══════════════════════════════════════════════════════════════

## Method 1: During Initial Setup
# When running the Broker installer, provide proxy when prompted:
Enter proxy URL (or press Enter for none): http://proxy.company.com:8080

## Method 2: Post-Installation Configuration
# SSH to Broker VM and edit configuration:

sudo vi /etc/panw/broker/broker.conf

# Add or modify:
[proxy]
enabled = true
server = proxy.company.com
port = 8080
username = proxyuser        # Optional, for authenticated proxy
password = proxypassword    # Optional, for authenticated proxy

# Restart Broker service:
sudo systemctl restart panw-broker

## Method 3: Environment Variables
# Add to /etc/environment or broker service file:
HTTPS_PROXY=http://proxy.company.com:8080
HTTP_PROXY=http://proxy.company.com:8080
NO_PROXY=localhost,127.0.0.1,.company.internal

# ═══════════════════════════════════════════════════════════════
# IMPORTANT: Broker VM needs to reach:
# - *.paloaltonetworks.com (data upload)
# - Log sources (internal - typically no proxy)
# 
# Configure proxy bypass for internal log sources
# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- Bandwidth Requirements -->
                <h2><i class="fas fa-tachometer-alt"></i> Bandwidth Requirements</h2>
                
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Direction</th>
                            <th>Typical Bandwidth</th>
                            <th>Peak Bandwidth</th>
                            <th>Calculation Basis</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong style="color: #3fb950;">XDR Agent</strong></td>
                            <td>Outbound</td>
                            <td>50-200 Kbps/endpoint</td>
                            <td>500 Kbps/endpoint</td>
                            <td>Telemetry, file uploads</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #58a6ff;">Broker VM</strong></td>
                            <td>Outbound</td>
                            <td>Variable (see formula)</td>
                            <td>2x average</td>
                            <td>Based on EPS × event size</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #a371f7;">Agent Updates</strong></td>
                            <td>Outbound</td>
                            <td>Burst during updates</td>
                            <td>100+ Mbps</td>
                            <td>~200MB per agent update</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #d29922;">Console Users</strong></td>
                            <td>Outbound</td>
                            <td>1-5 Mbps/user</td>
                            <td>10 Mbps/user</td>
                            <td>UI, queries, dashboards</td>
                        </tr>
                    </tbody>
                </table>

                <div class="config-section">
                    <h4>Bandwidth Calculation Formulas</h4>
                    <div class="arch-diagram"># XSIAM Bandwidth Estimation
# ═══════════════════════════════════════════════════════════════

## Broker VM Bandwidth Formula
Bandwidth (Mbps) = (EPS × Avg_Event_Size_Bytes × 8) / 1,000,000 × Compression_Factor

Where:
- EPS = Events per second
- Avg_Event_Size_Bytes = Typical 500-1500 bytes
- Compression_Factor = 0.3-0.5 (XSIAM compresses data)

Example: 10,000 EPS, 1000 byte average, 0.4 compression
Bandwidth = (10,000 × 1,000 × 8) / 1,000,000 × 0.4
Bandwidth = 32 Mbps sustained

## Agent Fleet Bandwidth Formula
Total_Agent_BW (Mbps) = (Endpoint_Count × Per_Endpoint_Kbps) / 1,000

Example: 5,000 endpoints, 100 Kbps average
Total = (5,000 × 100) / 1,000 = 500 Mbps

## Update Bandwidth (Peak Events)
Update_Peak = (Endpoints × Update_Size_MB × 8) / Update_Window_Seconds

Example: 5,000 endpoints, 200 MB update, 4-hour window
Peak = (5,000 × 200 × 8) / 14,400 = 555 Mbps

Recommendation: Stagger updates across maintenance windows

# ═══════════════════════════════════════════════════════════════
# NETWORK DESIGN RECOMMENDATIONS
# ═══════════════════════════════════════════════════════════════

## Internet Circuit Sizing
- Calculate total sustained bandwidth for all components
- Add 50% headroom for peaks and growth
- Consider QoS for security traffic prioritization

## WAN Considerations (Branch Offices)
- Deploy local Broker VMs in large branches
- Or use Prisma SD-WAN for optimized routing
- Agent traffic can traverse WAN to central egress</div>
                </div>

                <!-- Connectivity Troubleshooting -->
                <h2><i class="fas fa-tools"></i> Connectivity Troubleshooting</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-search"></i> Connectivity Issue Diagnosis Flow</div>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 16px;">
                        <div class="flow-step" style="background: #1c3a5e; border-color: #58a6ff;">
                            <div class="flow-icon"><i class="fas fa-question"></i></div>
                            <div class="flow-content">
                                <strong>1. Identify Symptom</strong>
                                <ul>
                                    <li>Agent disconnected?</li>
                                    <li>Broker not forwarding?</li>
                                    <li>Console inaccessible?</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #3d2a5e; border-color: #a371f7;">
                            <div class="flow-icon"><i class="fas fa-globe"></i></div>
                            <div class="flow-content">
                                <strong>2. Test DNS</strong>
                                <ul>
                                    <li>nslookup [endpoint]</li>
                                    <li>Verify resolution</li>
                                    <li>Check DNS servers</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #4d3a0d; border-color: #d29922;">
                            <div class="flow-icon"><i class="fas fa-plug"></i></div>
                            <div class="flow-content">
                                <strong>3. Test Connectivity</strong>
                                <ul>
                                    <li>telnet [endpoint] 443</li>
                                    <li>curl -v https://...</li>
                                    <li>openssl s_client</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #1a4d2e; border-color: #3fb950;">
                            <div class="flow-icon"><i class="fas fa-certificate"></i></div>
                            <div class="flow-content">
                                <strong>4. Check TLS/Certs</strong>
                                <ul>
                                    <li>Certificate valid?</li>
                                    <li>TLS inspection?</li>
                                    <li>Proxy MITM?</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>Diagnostic Commands</h4>
                    <div class="arch-diagram"># XSIAM Connectivity Diagnostic Commands
# ═══════════════════════════════════════════════════════════════

## DNS Resolution Test
# Windows
nslookup distributions.traps.paloaltonetworks.com
nslookup [tenant].xdr.us.paloaltonetworks.com

# Linux/Mac
dig distributions.traps.paloaltonetworks.com
host [tenant].xdr.us.paloaltonetworks.com

## TCP Connectivity Test
# Windows (PowerShell)
Test-NetConnection -ComputerName distributions.traps.paloaltonetworks.com -Port 443

# Linux/Mac
nc -zv distributions.traps.paloaltonetworks.com 443
telnet distributions.traps.paloaltonetworks.com 443

## TLS/Certificate Test
# Linux/Mac
openssl s_client -connect distributions.traps.paloaltonetworks.com:443 -servername distributions.traps.paloaltonetworks.com

# Check certificate chain
openssl s_client -connect distributions.traps.paloaltonetworks.com:443 2>/dev/null | openssl x509 -noout -dates -subject

## HTTP Connectivity Test (via proxy)
# With proxy:
curl -v --proxy http://proxy.company.com:8080 https://distributions.traps.paloaltonetworks.com/

# Without proxy:
curl -v https://distributions.traps.paloaltonetworks.com/

## Agent-Specific Diagnostics
# Windows - Check agent connectivity status:
"C:\Program Files\Palo Alto Networks\Traps\cytool.exe" connectivity test

# Windows - View agent logs:
Get-Content "C:\ProgramData\Cyvera\Logs\*" -Tail 100

# Linux:
sudo /opt/traps/bin/cytool connectivity test
sudo tail -100 /var/log/traps/*.log

# ═══════════════════════════════════════════════════════════════

## Broker VM Diagnostics
# Check Broker connectivity:
sudo /opt/broker/bin/broker-cli connectivity-test

# Check Broker service status:
sudo systemctl status panw-broker

# View Broker logs:
sudo tail -f /var/log/broker/broker.log

# Check outbound connections:
sudo netstat -an | grep :443 | grep ESTABLISHED</div>
                </div>

                <!-- Common Issues -->
                <h2><i class="fas fa-exclamation-circle"></i> Common Connectivity Issues</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What error or symptom are you seeing?</strong>
                    </div>
                    <div class="decision-branch" style="grid-template-columns: repeat(3, 1fr);">
                        <div>
                            <div class="decision-arrow">↓ DNS Failure</div>
                            <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                <strong>DNS Resolution Failed</strong>
                                <div style="color: #8b949e; font-size: 0.85rem; text-align: left;">
                                    <strong>Causes:</strong><br>
                                    • DNS server can't resolve<br>
                                    • DNS filtering blocking<br>
                                    • Split DNS misconfigured<br><br>
                                    <strong>Fix:</strong><br>
                                    • Check DNS server config<br>
                                    • Whitelist domains<br>
                                    • Test with public DNS
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Connection Timeout</div>
                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                <strong>Connection Timed Out</strong>
                                <div style="color: #8b949e; font-size: 0.85rem; text-align: left;">
                                    <strong>Causes:</strong><br>
                                    • Firewall blocking<br>
                                    • Proxy not configured<br>
                                    • Network ACL deny<br><br>
                                    <strong>Fix:</strong><br>
                                    • Check firewall rules<br>
                                    • Configure proxy settings<br>
                                    • Verify routing
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Certificate Error</div>
                            <div class="decision-node" style="background: #4d1a1a; border-color: #f85149;">
                                <strong>TLS/Certificate Error</strong>
                                <div style="color: #8b949e; font-size: 0.85rem; text-align: left;">
                                    <strong>Causes:</strong><br>
                                    • SSL inspection enabled<br>
                                    • Proxy MITM cert<br>
                                    • Clock skew<br><br>
                                    <strong>Fix:</strong><br>
                                    • Bypass SSL inspection<br>
                                    • Add exception for PANW<br>
                                    • Sync system time
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="warning-box">
                    <h4><i class="fas fa-lock"></i> SSL/TLS Inspection Warning</h4>
                    <p><strong>SSL inspection must be bypassed for XSIAM traffic.</strong> The Cortex XDR agent uses certificate pinning for security. If a proxy or firewall performs SSL inspection (MITM), the agent will reject the modified certificate and fail to connect. Create bypass rules for all *.paloaltonetworks.com domains.</p>
                </div>

                <!-- Network Checklist -->
                <h2><i class="fas fa-tasks"></i> Network Configuration Checklist</h2>
                
                <div class="config-section">
                    <h4>Pre-Deployment Network Checklist</h4>
                    <div style="background: #21262d; padding: 16px; border-radius: 8px; margin: 12px 0;">
                        <div style="display: grid; gap: 8px;">
                            <label style="display: flex; align-items: center; gap: 8px; color: #c9d1d9;">
                                <input type="checkbox" style="width: 18px; height: 18px;">
                                <span>☐ Firewall rules created for *.paloaltonetworks.com on TCP/443</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; color: #c9d1d9;">
                                <input type="checkbox" style="width: 18px; height: 18px;">
                                <span>☐ SSL inspection bypassed for Palo Alto Networks domains</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; color: #c9d1d9;">
                                <input type="checkbox" style="width: 18px; height: 18px;">
                                <span>☐ DNS resolution verified for all required FQDNs</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; color: #c9d1d9;">
                                <input type="checkbox" style="width: 18px; height: 18px;">
                                <span>☐ Proxy configuration documented (if required)</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; color: #c9d1d9;">
                                <input type="checkbox" style="width: 18px; height: 18px;">
                                <span>☐ Bandwidth requirements calculated and verified</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; color: #c9d1d9;">
                                <input type="checkbox" style="width: 18px; height: 18px;">
                                <span>☐ Test connectivity from endpoint subnet</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; color: #c9d1d9;">
                                <input type="checkbox" style="width: 18px; height: 18px;">
                                <span>☐ Test connectivity from Broker VM subnet</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; color: #c9d1d9;">
                                <input type="checkbox" style="width: 18px; height: 18px;">
                                <span>☐ Test connectivity from SOC workstation subnet</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What network requirements does XSIAM have, and how would you configure firewall rules?</button>
                        <div class="qa-answer">
                            <p>XSIAM is cloud-native, so all communication is outbound from your network to Palo Alto Networks cloud infrastructure. This actually simplifies network security - you don't need to open any inbound ports or expose services to the internet.</p>
                            
                            <p>The core requirement is outbound HTTPS (TCP/443) to *.paloaltonetworks.com domains. Different components communicate with different subdomains: agents talk to *.xdr.[region].paloaltonetworks.com, Broker VMs use similar endpoints for log forwarding, and the console and API have their own tenant-specific URLs. If your firewall supports FQDN-based rules, that's the cleanest approach - one rule allowing *.paloaltonetworks.com:443 covers most needs.</p>
                            
                            <p>For Palo Alto firewalls specifically, there's a built-in application signature for cortex-xdr that simplifies this further. You can create an application-based rule that allows cortex-xdr traffic without specifying individual URLs. This also ensures the traffic gets proper identification and logging.</p>
                            
                            <p>The critical gotcha is SSL inspection. Many enterprises run SSL inspection on their firewalls or proxies to examine encrypted traffic. The Cortex XDR agent uses certificate pinning for security - it validates that it's talking to the real Palo Alto servers, not a MITM proxy. If SSL inspection modifies the certificate, the agent rejects the connection. You must create bypass rules for Palo Alto Networks domains to exempt them from SSL inspection.</p>
                            
                            <p>I'd also consider segmentation. Endpoint subnets need agent communication paths, but maybe don't need console access. Broker VMs need both internal log source connectivity and external cloud connectivity. SOC workstations need console and API access. Creating specific rules per source zone gives better security and audit trails than one blanket rule.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you troubleshoot an agent that shows as disconnected in XSIAM?</button>
                        <div class="qa-answer">
                            <p>Disconnected agent troubleshooting follows a systematic approach - you're essentially testing the network path from endpoint to cloud, layer by layer.</p>
                            
                            <p>First, verify the agent service is running. On Windows, check Services for "Cortex XDR" or "Traps" service. On Linux, systemctl status traps. If the service isn't running, that's your problem - check agent logs for why it stopped. Common causes include resource exhaustion, conflicts with other security software, or crash loops.</p>
                            
                            <p>If the service is running, test network connectivity. Start with DNS - can the endpoint resolve distributions.traps.paloaltonetworks.com? If DNS fails, you've found the issue. Check DNS server configuration, check if DNS filtering is blocking Palo Alto domains, try using an alternate DNS server to verify.</p>
                            
                            <p>If DNS works, test TCP connectivity. Use PowerShell Test-NetConnection or telnet to verify you can reach the XSIAM endpoints on port 443. If this fails, something is blocking the traffic - firewall, proxy, network ACL. Check if the endpoint is supposed to go through a proxy. If so, verify proxy settings are configured in the agent.</p>
                            
                            <p>If TCP connects but the agent is still disconnected, check TLS. Use openssl s_client to examine the certificate chain. If you see a certificate from your organization's proxy or firewall instead of DigiCert/Palo Alto, SSL inspection is breaking the connection. The agent uses certificate pinning and will reject modified certificates.</p>
                            
                            <p>The cytool command-line utility on the endpoint is your friend here. "cytool connectivity test" runs a comprehensive connectivity check and reports what's failing. Check the agent logs in C:\ProgramData\Cyvera\Logs\ for specific error messages that point to the root cause.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you handle XSIAM deployment in an environment with strict proxy requirements?</button>
                        <div class="qa-answer">
                            <p>Strict proxy environments add complexity but are fully supported. The key is understanding which components need proxy configuration and ensuring the proxy itself doesn't break XSIAM functionality.</p>
                            
                            <p>First, document your proxy requirements. Is it transparent or explicit? Does it require authentication? If authenticated, what method - basic auth, NTLM, Kerberos? Does it perform SSL inspection? These factors determine your configuration approach.</p>
                            
                            <p>For explicit proxy without authentication, configuration is straightforward. The agent accepts proxy settings during installation or via cytool command. Broker VMs have a configuration file where you specify proxy URL. Format is simple: http://proxy.company.com:8080.</p>
                            
                            <p>Authenticated proxy with basic auth is similar - you include credentials in the URL: http://username:password@proxy.company.com:8080. This works for agents and Broker VMs. The downside is credentials in configuration files, so ensure proper file permissions.</p>
                            
                            <p>NTLM or Kerberos authentication is harder. The Cortex agent has limited support for complex authentication schemes. Options include: deploying an intermediate proxy that handles NTLM/Kerberos and presents basic auth internally, creating proxy exceptions for XSIAM traffic to bypass authentication, or using PAC files if your environment supports them.</p>
                            
                            <p>The SSL inspection issue applies regardless of proxy type. If your proxy performs SSL inspection, you need exceptions for Palo Alto Networks domains. Work with your proxy team to create bypass rules based on destination domain. Without this, agents will fail to connect due to certificate pinning.</p>
                            
                            <p>Testing is critical. Before mass deployment, configure a test endpoint with your proxy settings and verify full connectivity. Check that telemetry flows, updates download, and the agent shows connected. Only then proceed with broader rollout.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you calculate bandwidth requirements for a large XSIAM deployment?</button>
                        <div class="qa-answer">
                            <p>Bandwidth planning for XSIAM involves calculating the steady-state telemetry load plus accounting for burst events like updates. The math is straightforward but you need accurate inputs about your environment.</p>
                            
                            <p>For agent telemetry, each endpoint generates 50-200 Kbps average depending on activity level. Servers with lots of process activity generate more than quiet workstations. For planning, I use 100 Kbps average as a reasonable estimate. Multiply by endpoint count: 5,000 endpoints × 100 Kbps = 500 Mbps sustained. This is aggregate across your internet egress points.</p>
                            
                            <p>Broker VM bandwidth depends on the EPS you're forwarding. Formula: (EPS × average event size in bytes × 8) / 1,000,000 gives you Mbps. XSIAM compresses data, so multiply by 0.3-0.4 for effective bandwidth. Example: 20,000 EPS × 1000 bytes × 8 / 1,000,000 × 0.4 = 64 Mbps. Add 50% buffer for peaks.</p>
                            
                            <p>Update bandwidth is bursty but significant. Agent updates are around 200 MB each. If you push updates to 5,000 endpoints in a 4-hour window, that's 5,000 × 200 MB = 1 TB total, or about 555 Mbps sustained during that window. Stagger updates across maintenance windows to avoid overwhelming your internet circuit.</p>
                            
                            <p>For large deployments, consider local distribution points. XSIAM supports caching agents locally so updates don't all pull from the cloud. This dramatically reduces external bandwidth during update cycles.</p>
                            
                            <p>Don't forget console and API usage. SOC analysts running queries and viewing dashboards generate traffic too - roughly 1-5 Mbps per active user. During incident response when multiple analysts are running queries, this adds up.</p>
                            
                            <p>My recommendation: calculate all components, sum them up, add 50% buffer for growth and peaks, and ensure your internet circuits can handle it. If you're constrained, prioritize QoS for security traffic - you don't want a large file download to cause agent connectivity issues.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>
