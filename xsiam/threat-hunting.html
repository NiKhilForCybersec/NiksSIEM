<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Hunting | XSIAM Detection & Response</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
                <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link active"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>



        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Threat Hunting</span>
                </div>

                <h1><i class="fas fa-crosshairs"></i> Threat Hunting</h1>
                <p class="lead">Proactive threat hunting methodologies, hypothesis development, MITRE ATT&CK-based hunts, and XQL hunting queries using XSIAM's unified data model.</p>

                <!-- Hunting Framework -->
                <h2><i class="fas fa-compass"></i> Threat Hunting Framework</h2>
                
                <div class="info-box" style="border-color: #a371f7;">
                    <h4><i class="fas fa-info-circle"></i> Hunting vs Detection</h4>
                    <p><strong>Detection</strong> is automated and reactive - rules fire when known patterns match. <strong>Hunting</strong> is human-driven and proactive - analysts search for threats that evade automated detection. XSIAM's XQL and unified data model make it ideal for both structured and exploratory hunting.</p>
                </div>

                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-project-diagram"></i> Hypothesis-Driven Hunting Cycle</div>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 16px;">
                        <div class="flow-step" style="background: #1c3a5e; border-color: #58a6ff;">
                            <div class="flow-icon"><i class="fas fa-lightbulb"></i></div>
                            <div class="flow-content">
                                <strong>1. Hypothesis</strong>
                                <ul>
                                    <li>Threat intel driven</li>
                                    <li>MITRE ATT&CK technique</li>
                                    <li>Industry-specific threat</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #3d2a5e; border-color: #a371f7;">
                            <div class="flow-icon"><i class="fas fa-database"></i></div>
                            <div class="flow-content">
                                <strong>2. Data Identification</strong>
                                <ul>
                                    <li>Required datasets</li>
                                    <li>Timeframe selection</li>
                                    <li>Scope definition</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #4d3a0d; border-color: #d29922;">
                            <div class="flow-icon"><i class="fas fa-search"></i></div>
                            <div class="flow-content">
                                <strong>3. Hunt Execution</strong>
                                <ul>
                                    <li>XQL query development</li>
                                    <li>Iterative refinement</li>
                                    <li>Anomaly investigation</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #1a4d2e; border-color: #3fb950;">
                            <div class="flow-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="flow-content">
                                <strong>4. Findings</strong>
                                <ul>
                                    <li>Document results</li>
                                    <li>Create detections</li>
                                    <li>Share knowledge</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h2><i class="fas fa-code-branch"></i> Hunt Methodology Decision Tree</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>What is driving this hunt?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ Threat Intel (IOC/TTPs)</div>
                            <div class="decision-node yes" style="background: #1a4d2e;">
                                <strong style="color: #3fb950;">Intel-Driven Hunt</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Extract IOCs from report<br>2. Search across all data sources<br>3. Look for related activity</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Detection Gap</div>
                            <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                <strong style="color: #58a6ff;">Coverage-Driven Hunt</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Map MITRE gaps<br>2. Build technique queries<br>3. Baseline normal behavior<br>4. Create detections</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Anomaly/Baseline</div>
                            <div class="decision-node" style="background: #3d2a5e; border-color: #a371f7;">
                                <strong style="color: #a371f7;">Anomaly-Driven Hunt</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Establish baselines<br>2. Find statistical outliers<br>3. Investigate deviations<br>4. Determine malicious vs benign</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ Incident Follow-up</div>
                            <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                <strong style="color: #d29922;">Incident-Driven Hunt</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">1. Extract IOCs from incident<br>2. Search for additional victims<br>3. Timeline expansion<br>4. Lateral movement traces</div>
                            </div>
                        </div>
                    </div>
                </div>

                <h2><i class="fas fa-cog"></i> Hunt Configuration & Planning</h2>
                
                <div class="config-section">
                    <h4>Hunt Planning Template</h4>
                    <div class="arch-diagram"># Hunt Planning Document Template
# ═══════════════════════════════════════════════════════════════

## HUNT METADATA
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Hunt ID:        HUNT-2024-001
Hunt Name:      [Descriptive name]
Hunter:         [Analyst name]
Date Started:   [YYYY-MM-DD]
Status:         Planning | In Progress | Complete

## HYPOTHESIS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Statement:      "Adversaries are using [technique] to [objective] 
                which would appear as [observable] in our telemetry"

Confidence:     High | Medium | Low
Source:         [Threat intel report / MITRE technique / Anomaly]

## DATA REQUIREMENTS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Primary Dataset:    xdr_data (endpoint telemetry)
Secondary:          panw_ngfw_traffic_raw (network)
Supporting:         azure_ad_signin_raw (identity)

Timeframe:          Last 30 days
Scope:              All endpoints | Specific OU | High-value targets

## HUNT QUERIES
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Query 1: [Initial broad search]
Query 2: [Refinement based on Q1 results]
Query 3: [Investigation of anomalies]

## SUCCESS CRITERIA
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- Compromised systems identified: [Yes/No + count]
- False positive patterns documented
- Detection rule created: [Rule ID]
- Coverage gap closed: [MITRE technique]

## FINDINGS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[Document all findings, including negatives]

# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <div class="config-section">
                    <h4>Data Source Selection Matrix</h4>
                    <div class="arch-diagram"># Hunt Data Source Selection
# ═══════════════════════════════════════════════════════════════

## ENDPOINT TELEMETRY (xdr_data)
Best for:
├── Process execution chains
├── File operations
├── Registry modifications
├── Memory injections
├── Persistence mechanisms
└── LOLBin abuse

## NETWORK TRAFFIC (panw_ngfw_traffic)
Best for:
├── C2 communications
├── Data exfiltration
├── Lateral movement
├── DNS tunneling
├── Beaconing patterns
└── Protocol anomalies

## IDENTITY LOGS (azure_ad, okta, windows_security)
Best for:
├── Account compromise
├── Privilege escalation
├── Impossible travel
├── Brute force
├── Credential access
└── Lateral movement

## CLOUD LOGS (aws_cloudtrail, azure_activity)
Best for:
├── Cloud resource abuse
├── API key compromise
├── Configuration changes
├── Data access patterns
├── Service enumeration
└── Persistence in cloud

# ═══════════════════════════════════════════════════════════════
# Tip: Most effective hunts combine multiple data sources
# ═══════════════════════════════════════════════════════════════</div>
                </div>

                <!-- MITRE ATT&CK Hunting -->
                <h2><i class="fas fa-sitemap"></i> MITRE ATT&CK-Based Hunts</h2>
                
                <div class="config-section">
                    <h4>Initial Access (TA0001)</h4>
                    <div class="arch-diagram"># Hunt: Spearphishing Attachment Execution
# Technique: T1566.001
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter actor_process_image_name in ("OUTLOOK.EXE", "WINWORD.EXE", "EXCEL.EXE", "POWERPNT.EXE")
| filter action_process_image_name in ("powershell.exe", "cmd.exe", "wscript.exe", "cscript.exe", "mshta.exe", "regsvr32.exe")
| fields _time, endpoint_name, user_name, actor_process_image_name, action_process_image_name, action_process_command_line
| sort _time desc

# Hypothesis: Attackers deliver malicious documents that spawn scripting engines
# Expected: Legitimate macros exist - look for unusual command lines, first-time occurrences</div>

                    <h4>Execution (TA0002)</h4>
                    <div class="arch-diagram"># Hunt: Living Off the Land Binaries (LOLBins)
# Technique: T1218 (various)
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter action_process_image_name in (
    "mshta.exe", "regsvr32.exe", "rundll32.exe", "msiexec.exe",
    "certutil.exe", "bitsadmin.exe", "wmic.exe", "cmstp.exe",
    "installutil.exe", "regasm.exe", "regsvcs.exe"
)
| filter action_process_command_line contains_any ("http://", "https://", "\\\\", "javascript:", "vbscript:")
| comp count() as executions by endpoint_name, action_process_image_name, action_process_command_line
| sort executions desc

# Hunt: Encoded PowerShell Commands
# Technique: T1059.001
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter action_process_image_name ~= "powershell"
| filter action_process_command_line contains_any ("-enc", "-encoded", "-e ", "frombase64", "decompress")
| fields _time, endpoint_name, user_name, action_process_command_line
| sort _time desc</div>

                    <h4>Persistence (TA0003)</h4>
                    <div class="arch-diagram"># Hunt: Registry Run Key Modifications
# Technique: T1547.001
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter event_type = "REGISTRY"
| filter action_registry_key_name contains_any (
    "\\Run\\", "\\RunOnce\\", "\\RunServices\\", 
    "\\Policies\\Explorer\\Run", "\\CurrentVersion\\Run"
)
| filter action_registry_data != null
| comp count() as modifications by endpoint_name, action_registry_key_name, action_registry_data
| sort modifications desc

# Hunt: Scheduled Task Creation
# Technique: T1053.005
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter action_process_image_name = "schtasks.exe"
| filter action_process_command_line contains "/create"
| fields _time, endpoint_name, user_name, action_process_command_line
| sort _time desc</div>

                    <h4>Credential Access (TA0006)</h4>
                    <div class="arch-diagram"># Hunt: LSASS Memory Access
# Technique: T1003.001
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter target_process_image_name = "lsass.exe"
| filter event_type in ("INJECTION", "PROCESS_ACCESS")
| filter actor_process_image_name not in ("csrss.exe", "services.exe", "svchost.exe", "wininit.exe")
| fields _time, endpoint_name, actor_process_image_name, actor_process_command_line
| sort _time desc

# Hunt: Credential Dumping Tools
# Technique: T1003
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter action_process_command_line contains_any (
    "mimikatz", "sekurlsa", "procdump", "comsvcs.dll", 
    "ntdsutil", "vssadmin", "shadow", "SAM", "SYSTEM"
)
| fields _time, endpoint_name, user_name, action_process_image_name, action_process_command_line
| sort _time desc</div>

                    <h4>Lateral Movement (TA0008)</h4>
                    <div class="arch-diagram"># Hunt: Remote Service Execution
# Technique: T1021.002 (SMB/Windows Admin Shares)
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter action_process_image_name in ("psexec.exe", "psexesvc.exe")
   or action_process_command_line contains "\\\\*\\ADMIN$"
   or action_process_command_line contains "\\\\*\\C$"
| fields _time, endpoint_name, src_ip, user_name, action_process_command_line
| sort _time desc

# Hunt: WMI Remote Execution
# Technique: T1047
# ═══════════════════════════════════════════════════════════════

dataset = xdr_data
| filter _time > now() - 7d
| filter action_process_image_name = "wmic.exe"
| filter action_process_command_line contains "/node:"
| fields _time, endpoint_name, user_name, action_process_command_line
| comp count() as wmi_remote by endpoint_name, user_name
| filter wmi_remote > 5
| sort wmi_remote desc</div>
                </div>

                <!-- Hunt Prioritization -->
                <h2><i class="fas fa-sort-amount-down"></i> Hunt Prioritization Matrix</h2>
                
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Priority</th>
                            <th>Trigger</th>
                            <th>Example Hunts</th>
                            <th>Frequency</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #4d1a1a;">
                            <td><strong style="color: #f85149;">Critical</strong></td>
                            <td>Active threat intel, industry-targeted campaign</td>
                            <td>Specific APT IOCs, zero-day exploitation</td>
                            <td>Immediate</td>
                        </tr>
                        <tr style="background: #4d3a0d;">
                            <td><strong style="color: #d29922;">High</strong></td>
                            <td>New TTPs, gaps in detection coverage</td>
                            <td>Living off the land, supply chain</td>
                            <td>Weekly</td>
                        </tr>
                        <tr style="background: #1c3a5e;">
                            <td><strong style="color: #58a6ff;">Medium</strong></td>
                            <td>Regular coverage validation</td>
                            <td>Persistence mechanisms, credential access</td>
                            <td>Bi-weekly</td>
                        </tr>
                        <tr style="background: #1a4d2e;">
                            <td><strong style="color: #3fb950;">Standard</strong></td>
                            <td>Baseline hunting program</td>
                            <td>Anomaly detection, behavioral baselines</td>
                            <td>Monthly</td>
                        </tr>
                    </tbody>
                </table>

                <!-- Hunt Documentation Template -->
                <h2><i class="fas fa-file-alt"></i> Hunt Documentation Template</h2>
                
                <div class="config-section">
                    <div class="arch-diagram"># THREAT HUNT REPORT
# ═══════════════════════════════════════════════════════════════

## Hunt Metadata
Hunt ID:           TH-2024-001
Hunt Name:         Cobalt Strike Beacon Detection
Date Executed:     2024-01-15
Analyst:           [Name]
Duration:          4 hours
Data Timeframe:    Last 30 days

## Hypothesis
Based on recent threat intelligence indicating increased Cobalt Strike 
usage against our industry sector, we hypothesize that threat actors 
may have deployed Cobalt Strike beacons in our environment that are 
evading current detection rules.

## MITRE ATT&CK Mapping
- T1071.001: Web Protocols (C2)
- T1059.001: PowerShell
- T1055: Process Injection

## Data Sources Used
- xdr_data (endpoint telemetry)
- panw_ngfw_traffic (network flows)
- dns_logs (DNS queries)

## Queries Executed
[Include all XQL queries with explanations]

## Findings
☐ No evidence found (hypothesis disproven)
☐ Suspicious activity requiring investigation
☐ Confirmed malicious activity - Incident created

### Details
[Document specific findings, artifacts, endpoints affected]

## Recommendations
1. Detection gap identified: [description]
2. New correlation rule created: [rule name]
3. Additional data source needed: [source]

## Follow-up Actions
- [ ] Create detection rule for [technique]
- [ ] Update threat intel feed with new IOCs
- [ ] Brief SOC team on new TTP</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you develop a threat hunting hypothesis?</button>
                        <div class="qa-answer">
                            <p>A good hunting hypothesis is specific, testable, and grounded in real threat intelligence. Random searching isn't hunting - you need a focused question to investigate. I use several sources to develop hypotheses.</p>
                            
                            <p>Threat intelligence is the primary driver. When I read about a new campaign targeting my industry, I ask: "Could this technique be present in our environment?" If APT29 is using a new persistence mechanism, I hypothesize that similar activity might exist in our network undetected. This gives me a specific technique to hunt for, not just general "look for bad things."</p>
                            
                            <p>Detection gaps drive hypotheses too. I regularly review our detection coverage against MITRE ATT&CK. If we have strong coverage for credential dumping via Mimikatz but weak coverage for DCSync attacks, I hypothesize that an attacker using DCSync might be operating undetected. The gap itself becomes the hypothesis: "Attackers may be using techniques we don't detect."</p>
                            
                            <p>Anomalies and intuition also matter. If I notice unusual patterns during routine analysis - like a server suddenly making more outbound connections than usual - that's a hypothesis: "This behavior change might indicate compromise." Not every anomaly is malicious, but investigating them systematically is hunting.</p>
                            
                            <p>A well-formed hypothesis includes: what threat behavior I'm looking for, what data I need to find it, what would constitute evidence (positive or negative), and what the expected baseline looks like so I can identify deviations. Without these elements, you're just running queries without a plan.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through hunting for lateral movement in XSIAM.</button>
                        <div class="qa-answer">
                            <p>Lateral movement hunting requires looking at how attackers move between systems once they have initial access. XSIAM's unified data model is excellent for this because you can correlate endpoint, network, and authentication data.</p>
                            
                            <p>I start with known lateral movement techniques from MITRE ATT&CK. The big ones are: remote services (RDP, SSH, SMB), remote execution tools (PsExec, WMI, WinRM), and pass-the-hash/pass-the-ticket attacks. For each technique, I build queries that identify the expected artifacts.</p>
                            
                            <p>For remote execution, I hunt for tools like PsExec by looking for the PsExec service binary or command-line patterns. But I also look for the behavior without the tool - like services being created remotely or unusual parent-child process relationships on target systems. An attacker might use a renamed PsExec or a custom tool, but the underlying behavior is similar.</p>
                            
                            <p>WMI lateral movement shows up as wmic.exe with /node: parameters, or wmiprvse.exe spawning unexpected child processes on the target. I query for these patterns and look for anomalies - which accounts are using WMI remotely, are they normally admins, are the target systems ones they typically manage?</p>
                            
                            <p>Authentication patterns are crucial context. I correlate endpoint activity with authentication logs. If I see remote execution on Server B, I look at what account authenticated there and from where. An admin logging in from their workstation and running tools is normal. That same admin account authenticating from a server they never use is suspicious.</p>
                            
                            <p>Network data adds another dimension. Look for SMB connections between workstations (unusual), internal RDP from non-admin systems, or authentication traffic to domain controllers from unexpected sources. Lateral movement requires network connections - finding the anomalous connections often reveals the path.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you measure the effectiveness of a threat hunting program?</button>
                        <div class="qa-answer">
                            <p>Measuring hunting effectiveness is challenging because the goal is finding things that weren't detected by other means. You can't use traditional metrics like "threats detected" because a quiet month might mean good defenses or ineffective hunting.</p>
                            
                            <p>I track several categories of metrics. First, hunt outcomes: how many hunts resulted in findings (suspicious, confirmed malicious, or valuable context even if not malicious), how many led to new detections being created, and how many validated existing detection coverage. A hunt that confirms "we're not compromised by this technique" is still valuable - it proves the hypothesis and validates defenses.</p>
                            
                            <p>Detection improvement is a key metric. Count how many new correlation rules or detection signatures came from hunting discoveries. Track the coverage improvement against ATT&CK - if hunting identified gaps that are now covered, that's measurable progress. The hunting program should be feeding the detection engineering pipeline.</p>
                            
                            <p>Time to discovery matters for the threats you do find. If a hunt discovers a compromise that had been present for 60 days undetected, that's useful information about detection gaps. Track dwell time for hunting-discovered threats versus alert-discovered threats.</p>
                            
                            <p>Coverage metrics show program maturity. What percentage of high-priority ATT&CK techniques have been hunted in the past quarter? Are you rotating through all relevant techniques, or stuck on the same few? A mature program systematically covers the threat landscape.</p>
                            
                            <p>Finally, I track efficiency metrics: time spent hunting versus administrative overhead, query reuse rates (building a library of useful queries), and hypothesis quality (what percentage of hunts produce actionable findings versus dead ends). These help optimize the program over time.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
