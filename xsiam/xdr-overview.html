<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XDR Detection Engine | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">XSIAM Pages</div>
                <ul class="sidebar-nav">
                                                                                                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
<li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-ingestion.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Ingestion</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="broker-vm.html" class="sidebar-nav-link">
                            <i class="fas fa-server"></i>
                            <span>Broker VM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="agents.html" class="sidebar-nav-link">
                            <i class="fas fa-microchip"></i>
                            <span>Agents</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-stream"></i>
                            <span>Parsing & Flows</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="custom-log-onboarding.html" class="sidebar-nav-link">
                            <i class="fas fa-plus-circle"></i>
                            <span>Custom Log Onboarding</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-archive"></i>
                            <span>Retention Tiers</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>XQL Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xql-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-rocket"></i>
                            <span>XQL Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xdr-overview.html" class="sidebar-nav-link active">
                            <i class="fas fa-shield-virus"></i>
                            <span>XDR & Detection</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="correlation-rules.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>Correlation Rules</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="alert-management.html" class="sidebar-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Alert Management</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="xsoar-automation.html" class="sidebar-nav-link">
                            <i class="fas fa-robot"></i>
                            <span>XSOAR Automation</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-skull-crossbones"></i>
                            <span>Threat Intel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="recon-asm.html" class="sidebar-nav-link">
                            <i class="fas fa-globe"></i>
                            <span>Recon & ASM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="dashboards.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-line"></i>
                            <span>Dashboards</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="marketplace.html" class="sidebar-nav-link">
                            <i class="fas fa-store"></i>
                            <span>Marketplace</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-soc.html" class="sidebar-nav-link">
                            <i class="fas fa-building"></i>
                            <span>Enterprise SOC</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="comparison.html" class="sidebar-nav-link">
                            <i class="fas fa-balance-scale"></i>
                            <span>Platform Comparison</span>
                        </a>
                    </li>
</ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Xdr Overview</span>
                </div>

                <!-- Page Header -->
        <header class="page-header">
            <h1>XDR Detection & Analytics</h1>
            <p class="subtitle">Master Cortex XDR's detection capabilities including BIOC rules, Analytics BIOC, alert management, and the detection-to-incident pipeline within XSIAM</p>
            <div class="page-meta">
                <span>üìö Comprehensive Guide</span>
                <span>‚è±Ô∏è 25 min read</span>
                <span>üéØ Detection Engineering Focus</span>
            </div>
        </header>
        <!-- XDR Introduction -->
        
            <h2><i class="fas fa-question-circle"></i> Understanding XDR</h2>
            <div class="xdr-intro-card">
                <div class="xdr-definition">
                    <strong>XDR (Extended Detection and Response)</strong> extends traditional EDR by correlating data across endpoints, networks, cloud, and identity sources to provide unified threat detection and response.
                </div>
                <p>In XSIAM, Cortex XDR is the detection engine that processes normalized data (XDM) and generates alerts using behavioral analytics, machine learning, and rule-based detection.</p>
                <div class="xdr-evolution">
                    <div class="evolution-step">
                        <div class="year">2013</div>
                        <div class="name">EDR</div>
                        <div class="desc">Endpoint only</div>
                    </div>
                    <div class="evolution-step">
                        <div class="year">2018</div>
                        <div class="name">XDR</div>
                        <div class="desc">Cross-domain correlation</div>
                    </div>
                    <div class="evolution-step">
                        <div class="year">2021</div>
                        <div class="name">XSIAM</div>
                        <div class="desc">XDR + SIEM unified</div>
                    </div>
                    <div class="evolution-step">
                        <div class="year">Now</div>
                        <div class="name">AI-SOC</div>
                        <div class="desc">ML-native platform</div>
                    </div>
                </div>
            </div>
            <div class="memory-box">
                <div class="memory-box-title">üß† Memory Trick: XDR vs EDR vs SIEM</div>
                <div class="mnemonic">"E-X-S"</div>
                <ul>
                    <li><strong>E</strong>DR = <strong>E</strong>ndpoint only (single source)</li>
                    <li><strong>X</strong>DR = e<strong>X</strong>tended across sources (endpoint + network + cloud)</li>
                    <li><strong>S</strong>IAM = <strong>S</strong>ingle platform (XDR + SIEM + SOAR unified)</li>
                </ul>
            </div>
        
        <!-- Detection Architecture -->
        
            <h2><i class="fas fa-sitemap"></i> Detection Architecture</h2>
            <div class="info-box">
                <h4><i class="fas fa-info-circle"></i> Diagram</h4>
                <p style="color: #8b949e;">See Data Ingestion page for detailed visual diagrams of this architecture.</p>
            </div>
            <div class="detection-pipeline">
                <div class="pipeline-arrow">‚Üí</div>
                <div class="pipeline-step">
                    <div class="step-icon">üîÑ</div>
                    <div class="step-name">Normalize</div>
                    <div class="step-desc">XDM schema</div>
                </div>
                <div class="pipeline-arrow">‚Üí</div>
                <div class="pipeline-step">
                    <div class="step-icon">üîç</div>
                    <div class="step-name">Detect</div>
                    <div class="step-desc">Rules + ML</div>
                </div>
                <div class="pipeline-arrow">‚Üí</div>
                <div class="pipeline-step">
                    <div class="step-icon">üö®</div>
                    <div class="step-name">Alert</div>
                    <div class="step-desc">Prioritized</div>
                </div>
                <div class="pipeline-arrow">‚Üí</div>
                <div class="pipeline-step">
                    <div class="step-icon">üìã</div>
                    <div class="step-name">Incident</div>
                    <div class="step-desc">Grouped & enriched</div>
                </div>
                <div class="pipeline-arrow">‚Üí</div>
                <div class="pipeline-step">
                    <div class="step-icon">‚ö°</div>
                    <div class="step-name">Respond</div>
                    <div class="step-desc">Automated/manual</div>
                </div>
            </div>
        
        <!-- Detection Types -->
        
            <h2><i class="fas fa-shield-alt"></i> Detection Types in XSIAM</h2>
            <div class="detection-grid">
                <div class="detection-card">
                    <div class="card-icon">üéØ</div>
                    <h4>BIOC Rules</h4>
                    <p>Behavioral Indicators of Compromise - endpoint-focused rules that detect suspicious process, file, network, and registry behaviors.</p>
                    <ul class="card-features">
                        <li>Real-time endpoint detection</li>
                        <li>Process tree analysis</li>
                        <li>File/registry monitoring</li>
                        <li>Network connection tracking</li>
                        <li>Pre-built Palo Alto rules</li>
                    </ul>
                </div>
                <div class="detection-card">
                    <div class="card-icon">ü§ñ</div>
                    <h4>Analytics BIOC</h4>
                    <p>Machine learning-enhanced detection that learns baselines and identifies anomalies without explicit rules.</p>
                    <ul class="card-features">
                        <li>Behavioral baselining</li>
                        <li>Anomaly scoring</li>
                        <li>User/entity analytics (UEBA)</li>
                        <li>Adaptive thresholds</li>
                        <li>Reduces false positives</li>
                    </ul>
                </div>
                <div class="detection-card">
                    <div class="card-icon">üîó</div>
                    <h4>Correlation Rules</h4>
                    <p>Custom XQL-based rules that correlate events across multiple data sources for complex attack detection.</p>
                    <ul class="card-features">
                        <li>Cross-source correlation</li>
                        <li>Custom XQL logic</li>
                        <li>Time-window analysis</li>
                        <li>Threshold alerts</li>
                        <li>MITRE ATT&CK mapping</li>
                    </ul>
                </div>
            </div>
            <div class="info-box info">
                <div class="info-box-title">‚ÑπÔ∏è Detection Type Selection</div>
                <p><strong>Use BIOC</strong> for endpoint-specific behaviors (process chains, file operations). <strong>Use Analytics BIOC</strong> for anomaly detection where you don't know exact patterns. <strong>Use Correlation Rules</strong> for cross-source detection combining network, cloud, and endpoint data.</p>
            </div>
        
        <!-- BIOC Rules Deep Dive -->
        
            <h2><i class="fas fa-code"></i> BIOC Rules - Deep Dive</h2>
            <p>BIOC (Behavioral Indicator of Compromise) rules are the core endpoint detection mechanism in Cortex XDR. They detect malicious behaviors based on process execution, file operations, network connections, and registry modifications.</p>
            <div class="config-section">
                <h3 class="subsection-title">BIOC Rule Categories</h3>
                <div class="bioc-types">
                    <div class="bioc-type-card">
                        <div class="bioc-type-header">
                            <span>üîÑ</span>
                            <h4>Process BIOC</h4>
                        </div>
                        <div class="bioc-type-body">
                            <p>Detects suspicious process behaviors including execution chains, command-line arguments, and parent-child relationships.</p>
                            <ul class="content-list">
                                <li>Process name patterns (e.g., mimikatz, psexec)</li>
                                <li>Suspicious parent-child (Word ‚Üí PowerShell)</li>
                                <li>Command-line encoding detection</li>
                                <li>Process injection indicators</li>
                                <li>Living-off-the-land binaries (LOLBins)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="bioc-type-card">
                        <div class="bioc-type-header behavioral">
                            <span>üìÅ</span>
                            <h4>File BIOC</h4>
                        </div>
                        <div class="bioc-type-body">
                            <p>Monitors file system operations for indicators of malicious activity, ransomware, or data exfiltration.</p>
                            <ul class="content-list">
                                <li>File creation in suspicious paths</li>
                                <li>Mass file modifications (ransomware)</li>
                                <li>Extension changes (document ‚Üí executable)</li>
                                <li>Sensitive file access patterns</li>
                                <li>Script drops in temp directories</li>
                            </ul>
                        </div>
                    </div>
                    <div class="bioc-type-card">
                        <div class="bioc-type-header analytic">
                            <span>üåê</span>
                            <h4>Network BIOC</h4>
                        </div>
                        <div class="bioc-type-body">
                            <p>Analyzes network connections initiated by endpoint processes for C2 communication and data exfiltration.</p>
                            <ul class="content-list">
                                <li>Connections to rare destinations</li>
                                <li>Non-standard port usage</li>
                                <li>DNS tunneling indicators</li>
                                <li>Beaconing patterns</li>
                                <li>Large outbound data transfers</li>
                            </ul>
                        </div>
                    </div>
                    <div class="bioc-type-card">
                        <div class="bioc-type-header">
                            <span>üîß</span>
                            <h4>Registry BIOC</h4>
                        </div>
                        <div class="bioc-type-body">
                            <p>Tracks Windows registry modifications that indicate persistence, privilege escalation, or defense evasion.</p>
                            <ul class="content-list">
                                <li>Run/RunOnce key additions</li>
                                <li>Service creation (persistence)</li>
                                <li>Security policy modifications</li>
                                <li>Scheduled task registry changes</li>
                                <li>COM object hijacking</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="config-section">
                <h3 class="subsection-title">BIOC Rule Structure</h3>
                <p>Understanding the anatomy of a BIOC rule is essential for creating custom detections and tuning existing ones.</p>
                <div class="bioc-structure">
                    <div class="bioc-field">Rule Name</div>
                    <div class="bioc-value">Human-readable identifier (e.g., "Suspicious PowerShell Encoded Command")</div>
                    <div class="bioc-field">Rule ID</div>
                    <div class="bioc-value">Unique identifier for tracking and reference</div>
                    <div class="bioc-field">OS Type</div>
                    <div class="bioc-value">Windows, macOS, Linux (or All)</div>
                    <div class="bioc-field">Detection Type</div>
                    <div class="bioc-value">Process, File, Network, Registry, or Combined</div>
                    <div class="bioc-field">Logic Conditions</div>
                    <div class="bioc-value">AND/OR conditions matching fields (process_name, cmd_line, etc.)</div>
                    <div class="bioc-field">Severity</div>
                    <div class="bioc-value">Low, Medium, High, Critical</div>
                    <div class="bioc-field">MITRE Mapping</div>
                    <div class="bioc-value">Tactics and techniques (T1059.001, TA0002, etc.)</div>
                    <div class="bioc-field">Response Actions</div>
                    <div class="bioc-value">Alert only, Block, Quarantine, or Custom response</div>
                </div>
                <div class="arch-diagram">
                    <div class="code-header">
                        <span class="code-title">Example BIOC Rule: Encoded PowerShell Detection</span>
                        <span class="code-lang">BIOC</span>
                    </div>
                    <div class="code-content">
<p style="color: #8b949e;">[Diagram - see related pages for visual representation]</p>
                    </div>
                </div>
            </div>
            <div class="config-section">
                <h3 class="subsection-title">Creating Custom BIOC Rules</h3>
                <p>Custom BIOC rules allow you to extend detection capabilities for organization-specific threats.</p>
                <div class="arch-diagram">
                    <div class="code-header">
                        <span class="code-title">Custom BIOC: Detect Credential Dumping Tools</span>
                        <span class="code-lang">BIOC</span>
                    </div>
                    <div class="code-content">
<p style="color: #8b949e;">[Diagram - see related pages for visual representation]</p>
                    </div>
                </div>
                <div class="arch-diagram">
                    <div class="code-header">
                        <span class="code-title">Custom BIOC: Office Macro Spawning Shell</span>
                        <span class="code-lang">BIOC</span>
                    </div>
                    <div class="code-content">
<p style="color: #8b949e;">[Diagram - see related pages for visual representation]</p>
                    </div>
                </div>
            </div>
            <div class="interview-box">
                <div class="interview-box-title">üíº Interview Answer: BIOC Rule Development Process</div>
                <div class="question">"Walk me through how you would create a custom BIOC rule for a new threat."</div>
                <div class="answer">
                    <p><strong>Step 1: Threat Research</strong> - Analyze the threat's TTPs from threat intel, sandbox analysis, or incident reports. Identify unique behavioral patterns.</p>
                    <p><strong>Step 2: Field Identification</strong> - Determine which XDM fields can detect this behavior: process name, command line, parent process, file paths, network connections.</p>
                    <p><strong>Step 3: Logic Design</strong> - Build AND/OR conditions that are specific enough to catch the threat but not so broad they generate false positives.</p>
                    <p><strong>Step 4: Testing in Query</strong> - Use XQL in Investigation to test the logic against historical data. Validate true positives and check for false positives.</p>
                    <p><strong>Step 5: Create BIOC Rule</strong> - Configure the rule with appropriate severity, MITRE mapping, and response actions.</p>
                    <p><strong>Step 6: Monitor & Tune</strong> - Deploy in alert-only mode first, monitor for a week, add exclusions for legitimate tools, then enable blocking if appropriate.</p>
                </div>
            </div>
        
        <!-- Analytics BIOC -->
        
            <h2><i class="fas fa-brain"></i> Analytics BIOC - ML-Powered Detection</h2>
            <p>Analytics BIOC uses machine learning to detect threats without predefined signatures. It learns normal behavior baselines and identifies anomalies that may indicate compromise.</p>
            <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> Diagram</h4>
                    <p style="color: #8b949e;">See Data Ingestion page for detailed visual diagrams of this architecture.</p>
                </div>
            <div class="config-section">
                <h3 class="subsection-title">Analytics BIOC vs Rule-Based Comparison</h3>
                <div class="comparison-grid">
                    <div class="compare-card">
                        <div class="compare-card-header xsiam">BIOC Rules</div>
                        <div class="compare-card-body">
                            <h5>Deterministic Detection</h5>
                            <p>Exact matching based on defined conditions</p>
                            <ul>
                                <li>Known threat patterns</li>
                                <li>Consistent, predictable</li>
                                <li>Low false positives when tuned</li>
                                <li>Misses unknown variants</li>
                                <li>Requires constant updates</li>
                            </ul>
                        </div>
                    </div>
                    <div class="compare-card">
                        <div class="compare-card-header sentinel">Analytics BIOC</div>
                        <div class="compare-card-body">
                            <h5>Behavioral Detection</h5>
                            <p>ML-based anomaly identification</p>
                            <ul>
                                <li>Unknown threat detection</li>
                                <li>Adapts to environment</li>
                                <li>Detects insider threats</li>
                                <li>Higher initial false positives</li>
                                <li>Needs baselining time</li>
                            </ul>
                        </div>
                    </div>
                    <div class="compare-card">
                        <div class="compare-card-header splunk">Combined Approach</div>
                        <div class="compare-card-body">
                            <h5>Best Practice</h5>
                            <p>Use both for defense in depth</p>
                            <ul>
                                <li>BIOC for known threats</li>
                                <li>Analytics for unknowns</li>
                                <li>Correlation for context</li>
                                <li>Lower overall false negatives</li>
                                <li>Comprehensive coverage</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="memory-box">
                <div class="memory-box-title">üß† Memory Trick: When to Use Each Detection Type</div>
                <div class="mnemonic">"K-U-C" Rule</div>
                <ul>
                    <li><strong>K</strong>nown threat ‚Üí <strong>BIOC Rule</strong> (signature-like, deterministic)</li>
                    <li><strong>U</strong>nknown threat ‚Üí <strong>Analytics BIOC</strong> (behavioral anomaly)</li>
                    <li><strong>C</strong>omplex attack ‚Üí <strong>Correlation Rule</strong> (multi-source, custom logic)</li>
                </ul>
            </div>
        
        <!-- Alert Severity & MITRE -->
        
            <h2><i class="fas fa-exclamation-triangle"></i> Alert Severity & MITRE Mapping</h2>
            <div class="config-section">
                <h3 class="subsection-title">Severity Levels</h3>
                <div class="severity-grid">
                    <div class="severity-card critical">
                        <div class="level">CRITICAL</div>
                        <div class="desc">Active compromise, immediate response needed</div>
                    </div>
                    <div class="severity-card high">
                        <div class="level">HIGH</div>
                        <div class="desc">Strong indicator of attack, investigate within hours</div>
                    </div>
                    <div class="severity-card medium">
                        <div class="level">MEDIUM</div>
                        <div class="desc">Suspicious activity, investigate within 24 hours</div>
                    </div>
                    <div class="severity-card low">
                        <div class="level">LOW</div>
                        <div class="desc">Informational, review during normal operations</div>
                    </div>
                </div>
                <div class="info-box tip">
                    <div class="info-box-title">üí° Severity Assignment Best Practices</div>
                    <p>Consider: (1) Confidence level of the detection, (2) Potential impact if true positive, (3) Attack stage (later stages = higher severity), (4) Asset criticality involved. A low-confidence detection on a critical asset may warrant medium severity, while high-confidence on a regular workstation might be medium.</p>
                </div>
            </div>
            <div class="config-section">
                <h3 class="subsection-title">MITRE ATT&CK Integration</h3>
                <p>XSIAM automatically maps detections to MITRE ATT&CK framework, enabling coverage visualization and gap analysis.</p>
                <div class="mitre-grid">
                    <div class="mitre-card">
                        <div class="tactic">Initial Access</div>
                        <div class="technique">Phishing</div>
                        <div class="id">T1566</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Execution</div>
                        <div class="technique">PowerShell</div>
                        <div class="id">T1059.001</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Persistence</div>
                        <div class="technique">Registry Run Keys</div>
                        <div class="id">T1547.001</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Privilege Escalation</div>
                        <div class="technique">Token Manipulation</div>
                        <div class="id">T1134</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Defense Evasion</div>
                        <div class="technique">Obfuscated Files</div>
                        <div class="id">T1027</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Credential Access</div>
                        <div class="technique">LSASS Memory</div>
                        <div class="id">T1003.001</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Discovery</div>
                        <div class="technique">Network Scanning</div>
                        <div class="id">T1046</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Lateral Movement</div>
                        <div class="technique">Remote Services</div>
                        <div class="id">T1021</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Collection</div>
                        <div class="technique">Archive Data</div>
                        <div class="id">T1560</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Exfiltration</div>
                        <div class="technique">Exfil Over C2</div>
                        <div class="id">T1041</div>
                    </div>
                </div>
                <div class="arch-diagram">
                    <div class="code-header">
                        <span class="code-title">XQL: Query Alerts by MITRE Tactic</span>
                        <span class="code-lang">XQL</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Find all alerts mapped to Credential Access tactic</span>
<span class="dataset">dataset</span> = <span class="value">xdr_data</span>
| <span class="keyword">filter</span> <span class="field">event_type</span> = <span class="string">"ALERT"</span>
| <span class="keyword">filter</span> <span class="field">mitre_tactic</span> <span class="operator">contains</span> <span class="string">"Credential Access"</span>
| <span class="keyword">fields</span> <span class="field">alert_name</span>, <span class="field">mitre_technique_id</span>, <span class="field">severity</span>, <span class="field">host_name</span>, <span class="field">user_name</span>
| <span class="keyword">sort</span> <span class="field">_time</span> <span class="keyword">desc</span>
| <span class="keyword">limit</span> <span class="number">100</span></pre>
                    </div>
                </div>
            </div>
        
        <!-- Detection Use Cases -->
        
            <h2><i class="fas fa-crosshairs"></i> Detection Use Cases</h2>
            <div class="use-case-grid">
                <div class="use-case-card">
                    <h4>üîê Credential Theft <span class="attack-type">T1003</span></h4>
                    <p>Detect attempts to dump credentials from LSASS, SAM database, or credential stores.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> BIOC rule for procdump/mimikatz + Analytics for unusual LSASS access patterns
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>üé£ Phishing Payload <span class="attack-type">T1566</span></h4>
                    <p>Detect malicious documents or links leading to payload execution.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> BIOC for Office ‚Üí cmd/PowerShell chains + file reputation analysis
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>üîÑ Lateral Movement <span class="attack-type">T1021</span></h4>
                    <p>Identify attackers moving between systems using valid credentials or exploits.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> Analytics BIOC for unusual internal RDP/SMB + Correlation for auth anomalies
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>üì° C2 Communication <span class="attack-type">T1071</span></h4>
                    <p>Detect beaconing and command-and-control traffic to attacker infrastructure.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> Network BIOC for beaconing patterns + Analytics for rare domain connections
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>üì§ Data Exfiltration <span class="attack-type">T1041</span></h4>
                    <p>Identify large data transfers or staging activities before exfiltration.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> Correlation rule for high outbound + Analytics for abnormal upload volumes
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>üîí Ransomware <span class="attack-type">T1486</span></h4>
                    <p>Detect encryption activity, shadow copy deletion, and ransom note creation.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> BIOC for vssadmin/wmic shadow delete + file BIOC for mass modifications
                    </div>
                </div>
            </div>
        
        <!-- Platform Comparison: Detection -->
        
            <h2><i class="fas fa-balance-scale"></i> Detection Capabilities Comparison</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Capability</th>
                            <th>XSIAM/Cortex XDR</th>
                            <th>Microsoft Sentinel</th>
                            <th>Splunk Enterprise Security</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Endpoint Detection</strong></td>
                            <td>Native Cortex Agent (BIOC)</td>
                            <td>MDE integration</td>
                            <td>Third-party EDR required</td>
                        </tr>
                        <tr>
                            <td><strong>Behavioral Rules</strong></td>
                            <td>BIOC (endpoint-native)</td>
                            <td>Analytics Rules (KQL)</td>
                            <td>Correlation Searches (SPL)</td>
                        </tr>
                        <tr>
                            <td><strong>ML Detection</strong></td>
                            <td>Analytics BIOC (built-in)</td>
                            <td>UEBA (requires license)</td>
                            <td>MLTK (addon toolkit)</td>
                        </tr>
                        <tr>
                            <td><strong>Cross-Source Correlation</strong></td>
                            <td>XQL Correlation Rules</td>
                            <td>Fusion Rules, Scheduled</td>
                            <td>Correlation Searches</td>
                        </tr>
                        <tr>
                            <td><strong>MITRE Mapping</strong></td>
                            <td>Automatic, native</td>
                            <td>Automatic, native</td>
                            <td>ES Content (manual)</td>
                        </tr>
                        <tr>
                            <td><strong>Rule Language</strong></td>
                            <td>XQL + GUI builder</td>
                            <td>KQL + GUI builder</td>
                            <td>SPL only</td>
                        </tr>
                        <tr>
                            <td><strong>Pre-built Rules</strong></td>
                            <td>Cortex Content Packs</td>
                            <td>Content Hub Solutions</td>
                            <td>ES Content Updates</td>
                        </tr>
                        <tr>
                            <td><strong>Alert Grouping</strong></td>
                            <td>Auto-stitched Incidents</td>
                            <td>Alert Grouping Rules</td>
                            <td>Notable Events</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        
        <!-- Incident Management -->
        
            <h2><i class="fas fa-project-diagram"></i> Alert to Incident Pipeline</h2>
            <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> Diagram</h4>
                    <p style="color: #8b949e;">See Data Ingestion page for detailed visual diagrams of this architecture.</p>
                </div>
            <div class="interview-box">
                <div class="interview-box-title">üíº Interview Answer: Detection Engineering Philosophy</div>
                <div class="question">"How do you approach building detection content for a new environment?"</div>
                <div class="answer">
                    <p><strong>1. Baseline First:</strong> Understand what's normal in the environment. Run discovery queries to see common processes, network patterns, authentication flows.</p>
                    <p><strong>2. Crown Jewels:</strong> Identify critical assets and build detections specifically protecting them - database servers, domain controllers, executive endpoints.</p>
                    <p><strong>3. Kill Chain Coverage:</strong> Ensure detection at multiple attack stages. If initial access is missed, catch them at execution. If execution is missed, catch lateral movement.</p>
                    <p><strong>4. Layer Detections:</strong> Use BIOC for endpoint behaviors, Analytics for anomalies, Correlation for cross-source attacks. Defense in depth applies to detection too.</p>
                    <p><strong>5. Iterate:</strong> Detection engineering is never "done." Review alerts weekly, tune false positives, add new detections based on threat intel, and validate coverage with purple team exercises.</p>
                </div>
            </div>
        
        <!-- Navigation Cards -->
        <div class="nav-cards">
            <a href="xql-advanced.html" class="nav-card">
                <div class="nav-direction">‚Üê Previous</div>
                <div class="nav-title">Advanced XQL</div>
            </a>
            <a href="xsoar-automation.html" class="nav-card">
                <div class="nav-direction">Next ‚Üí</div>
                <div class="nav-title">XSOAR Automation</div>
            </a>
        </div>
            
                

                
                </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>