<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XDR Detection Engine | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam active"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="../splunk/index.html" class="platform-tab splunk"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
<nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Ingestion</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention Tiers</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM Setup</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> XQL Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced XQL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="xdr-overview.html" class="nav-link active"><i class="fas fa-shield-virus"></i> XDR Detection</a>
                    <a href="correlation-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> Correlation Rules</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Threat Intelligence</div>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intel</a>
                    <a href="recon-asm.html" class="nav-link"><i class="fas fa-globe"></i> Recon & ASM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> Platform Comparison</a>
                    <a href="enterprise-soc.html" class="nav-link"><i class="fas fa-building"></i> Enterprise SOC Ops</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">XDR Detection</span>
                </div>
                <div class="top-actions">
                    <button class="top-btn" onclick="window.print()"><i class="fas fa-print"></i> Print</button>
                </div>
            </header>
            <main class="main-content">
<!-- Page Header -->
        <header class="page-header">
            <h1>XDR Detection & Analytics</h1>
            <p class="subtitle">Master Cortex XDR's detection capabilities including BIOC rules, Analytics BIOC, alert management, and the detection-to-incident pipeline within XSIAM</p>
            <div class="page-meta">
                <span>ğŸ“š Comprehensive Guide</span>
                <span>â±ï¸ 25 min read</span>
                <span>ğŸ¯ Detection Engineering Focus</span>
            </div>
        </header>
        <!-- XDR Introduction -->
        <section class="section">
            <h2 class="section-title">Understanding XDR</h2>
            <div class="xdr-intro-card">
                <div class="xdr-definition">
                    <strong>XDR (Extended Detection and Response)</strong> extends traditional EDR by correlating data across endpoints, networks, cloud, and identity sources to provide unified threat detection and response.
                </div>
                <p>In XSIAM, Cortex XDR is the detection engine that processes normalized data (XDM) and generates alerts using behavioral analytics, machine learning, and rule-based detection.</p>
                <div class="xdr-evolution">
                    <div class="evolution-step">
                        <div class="year">2013</div>
                        <div class="name">EDR</div>
                        <div class="desc">Endpoint only</div>
                    </div>
                    <div class="evolution-step">
                        <div class="year">2018</div>
                        <div class="name">XDR</div>
                        <div class="desc">Cross-domain correlation</div>
                    </div>
                    <div class="evolution-step">
                        <div class="year">2021</div>
                        <div class="name">XSIAM</div>
                        <div class="desc">XDR + SIEM unified</div>
                    </div>
                    <div class="evolution-step">
                        <div class="year">Now</div>
                        <div class="name">AI-SOC</div>
                        <div class="desc">ML-native platform</div>
                    </div>
                </div>
            </div>
            <div class="memory-box">
                <div class="memory-box-title">ğŸ§  Memory Trick: XDR vs EDR vs SIEM</div>
                <div class="mnemonic">"E-X-S"</div>
                <ul>
                    <li><strong>E</strong>DR = <strong>E</strong>ndpoint only (single source)</li>
                    <li><strong>X</strong>DR = e<strong>X</strong>tended across sources (endpoint + network + cloud)</li>
                    <li><strong>S</strong>IAM = <strong>S</strong>ingle platform (XDR + SIEM + SOAR unified)</li>
                </ul>
            </div>
        </section>
        <!-- Detection Architecture -->
        <section class="section">
            <h2 class="section-title">Detection Architecture</h2>
            <div class="diagram-box">
                <div class="diagram-title">ğŸ“Š XSIAM Detection Pipeline</div>
                <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA COLLECTION LAYER                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Cortex     â”‚   Network   â”‚   Cloud     â”‚  Identity   â”‚    Third-Party          â”‚
â”‚  Agent      â”‚   Sensors   â”‚   API       â”‚   (Azure AD)â”‚    (Syslog, API)        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚             â”‚             â”‚                   â”‚
       â–¼             â–¼             â–¼             â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         XDM NORMALIZATION LAYER                                  â”‚
â”‚   Raw Data â†’ Parsed â†’ Enriched â†’ Normalized to Common Schema (XDM)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DETECTION ENGINE                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      BIOC Rules     â”‚   Analytics BIOC    â”‚      Correlation Rules              â”‚
â”‚   (Behavioral IOC)  â”‚   (ML-Enhanced)     â”‚    (Cross-Source XQL)               â”‚
â”‚                     â”‚                     â”‚                                      â”‚
â”‚  â€¢ Process behavior â”‚  â€¢ Anomaly detectionâ”‚  â€¢ Custom detection logic           â”‚
â”‚  â€¢ File operations  â”‚  â€¢ Baseline compare â”‚  â€¢ Multi-source correlation         â”‚
â”‚  â€¢ Network activity â”‚  â€¢ Risk scoring     â”‚  â€¢ Threshold-based alerts           â”‚
â”‚  â€¢ Registry changes â”‚  â€¢ Pattern learning â”‚  â€¢ Time-window aggregations         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ALERT GENERATION                                       â”‚
â”‚   Severity Assignment â†’ MITRE Mapping â†’ Alert Grouping â†’ Deduplication          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         INCIDENT MANAGEMENT                                      â”‚
â”‚   Alert Stitching â†’ Incident Creation â†’ Auto-Investigation â†’ XSOAR Playbooks   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </pre>
            </div>
            <div class="analytics-pipeline">
                <div class="pipeline-step">
                    <div class="step-icon">ğŸ“¥</div>
                    <div class="step-name">Collect</div>
                    <div class="step-desc">Multi-source data</div>
                </div>
                <div class="pipeline-arrow">â†’</div>
                <div class="pipeline-step">
                    <div class="step-icon">ğŸ”„</div>
                    <div class="step-name">Normalize</div>
                    <div class="step-desc">XDM schema</div>
                </div>
                <div class="pipeline-arrow">â†’</div>
                <div class="pipeline-step">
                    <div class="step-icon">ğŸ”</div>
                    <div class="step-name">Detect</div>
                    <div class="step-desc">Rules + ML</div>
                </div>
                <div class="pipeline-arrow">â†’</div>
                <div class="pipeline-step">
                    <div class="step-icon">ğŸš¨</div>
                    <div class="step-name">Alert</div>
                    <div class="step-desc">Prioritized</div>
                </div>
                <div class="pipeline-arrow">â†’</div>
                <div class="pipeline-step">
                    <div class="step-icon">ğŸ“‹</div>
                    <div class="step-name">Incident</div>
                    <div class="step-desc">Grouped & enriched</div>
                </div>
                <div class="pipeline-arrow">â†’</div>
                <div class="pipeline-step">
                    <div class="step-icon">âš¡</div>
                    <div class="step-name">Respond</div>
                    <div class="step-desc">Automated/manual</div>
                </div>
            </div>
        </section>
        <!-- Detection Types -->
        <section class="section">
            <h2 class="section-title">Detection Types in XSIAM</h2>
            <div class="detection-grid">
                <div class="detection-card">
                    <div class="card-icon">ğŸ¯</div>
                    <h4>BIOC Rules</h4>
                    <p>Behavioral Indicators of Compromise - endpoint-focused rules that detect suspicious process, file, network, and registry behaviors.</p>
                    <ul class="card-features">
                        <li>Real-time endpoint detection</li>
                        <li>Process tree analysis</li>
                        <li>File/registry monitoring</li>
                        <li>Network connection tracking</li>
                        <li>Pre-built Palo Alto rules</li>
                    </ul>
                </div>
                <div class="detection-card">
                    <div class="card-icon">ğŸ¤–</div>
                    <h4>Analytics BIOC</h4>
                    <p>Machine learning-enhanced detection that learns baselines and identifies anomalies without explicit rules.</p>
                    <ul class="card-features">
                        <li>Behavioral baselining</li>
                        <li>Anomaly scoring</li>
                        <li>User/entity analytics (UEBA)</li>
                        <li>Adaptive thresholds</li>
                        <li>Reduces false positives</li>
                    </ul>
                </div>
                <div class="detection-card">
                    <div class="card-icon">ğŸ”—</div>
                    <h4>Correlation Rules</h4>
                    <p>Custom XQL-based rules that correlate events across multiple data sources for complex attack detection.</p>
                    <ul class="card-features">
                        <li>Cross-source correlation</li>
                        <li>Custom XQL logic</li>
                        <li>Time-window analysis</li>
                        <li>Threshold alerts</li>
                        <li>MITRE ATT&CK mapping</li>
                    </ul>
                </div>
            </div>
            <div class="info-box info">
                <div class="info-box-title">â„¹ï¸ Detection Type Selection</div>
                <p><strong>Use BIOC</strong> for endpoint-specific behaviors (process chains, file operations). <strong>Use Analytics BIOC</strong> for anomaly detection where you don't know exact patterns. <strong>Use Correlation Rules</strong> for cross-source detection combining network, cloud, and endpoint data.</p>
            </div>
        </section>
        <!-- BIOC Rules Deep Dive -->
        <section class="section">
            <h2 class="section-title">BIOC Rules - Deep Dive</h2>
            <p>BIOC (Behavioral Indicator of Compromise) rules are the core endpoint detection mechanism in Cortex XDR. They detect malicious behaviors based on process execution, file operations, network connections, and registry modifications.</p>
            <div class="subsection">
                <h3 class="subsection-title">BIOC Rule Categories</h3>
                <div class="bioc-types">
                    <div class="bioc-type-card">
                        <div class="bioc-type-header">
                            <span>ğŸ”„</span>
                            <h4>Process BIOC</h4>
                        </div>
                        <div class="bioc-type-body">
                            <p>Detects suspicious process behaviors including execution chains, command-line arguments, and parent-child relationships.</p>
                            <ul class="content-list">
                                <li>Process name patterns (e.g., mimikatz, psexec)</li>
                                <li>Suspicious parent-child (Word â†’ PowerShell)</li>
                                <li>Command-line encoding detection</li>
                                <li>Process injection indicators</li>
                                <li>Living-off-the-land binaries (LOLBins)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="bioc-type-card">
                        <div class="bioc-type-header behavioral">
                            <span>ğŸ“</span>
                            <h4>File BIOC</h4>
                        </div>
                        <div class="bioc-type-body">
                            <p>Monitors file system operations for indicators of malicious activity, ransomware, or data exfiltration.</p>
                            <ul class="content-list">
                                <li>File creation in suspicious paths</li>
                                <li>Mass file modifications (ransomware)</li>
                                <li>Extension changes (document â†’ executable)</li>
                                <li>Sensitive file access patterns</li>
                                <li>Script drops in temp directories</li>
                            </ul>
                        </div>
                    </div>
                    <div class="bioc-type-card">
                        <div class="bioc-type-header analytic">
                            <span>ğŸŒ</span>
                            <h4>Network BIOC</h4>
                        </div>
                        <div class="bioc-type-body">
                            <p>Analyzes network connections initiated by endpoint processes for C2 communication and data exfiltration.</p>
                            <ul class="content-list">
                                <li>Connections to rare destinations</li>
                                <li>Non-standard port usage</li>
                                <li>DNS tunneling indicators</li>
                                <li>Beaconing patterns</li>
                                <li>Large outbound data transfers</li>
                            </ul>
                        </div>
                    </div>
                    <div class="bioc-type-card">
                        <div class="bioc-type-header">
                            <span>ğŸ”§</span>
                            <h4>Registry BIOC</h4>
                        </div>
                        <div class="bioc-type-body">
                            <p>Tracks Windows registry modifications that indicate persistence, privilege escalation, or defense evasion.</p>
                            <ul class="content-list">
                                <li>Run/RunOnce key additions</li>
                                <li>Service creation (persistence)</li>
                                <li>Security policy modifications</li>
                                <li>Scheduled task registry changes</li>
                                <li>COM object hijacking</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">BIOC Rule Structure</h3>
                <p>Understanding the anatomy of a BIOC rule is essential for creating custom detections and tuning existing ones.</p>
                <div class="bioc-structure">
                    <div class="bioc-field">Rule Name</div>
                    <div class="bioc-value">Human-readable identifier (e.g., "Suspicious PowerShell Encoded Command")</div>
                    <div class="bioc-field">Rule ID</div>
                    <div class="bioc-value">Unique identifier for tracking and reference</div>
                    <div class="bioc-field">OS Type</div>
                    <div class="bioc-value">Windows, macOS, Linux (or All)</div>
                    <div class="bioc-field">Detection Type</div>
                    <div class="bioc-value">Process, File, Network, Registry, or Combined</div>
                    <div class="bioc-field">Logic Conditions</div>
                    <div class="bioc-value">AND/OR conditions matching fields (process_name, cmd_line, etc.)</div>
                    <div class="bioc-field">Severity</div>
                    <div class="bioc-value">Low, Medium, High, Critical</div>
                    <div class="bioc-field">MITRE Mapping</div>
                    <div class="bioc-value">Tactics and techniques (T1059.001, TA0002, etc.)</div>
                    <div class="bioc-field">Response Actions</div>
                    <div class="bioc-value">Alert only, Block, Quarantine, or Custom response</div>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-title">Example BIOC Rule: Encoded PowerShell Detection</span>
                        <span class="code-lang">BIOC</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// BIOC Rule: Detect Base64 Encoded PowerShell Commands</span>
<span class="field">Rule Name:</span> <span class="string">"PowerShell Encoded Command Execution"</span>
<span class="field">Rule ID:</span> <span class="string">"BIOC-PS-001"</span>
<span class="field">OS:</span> <span class="value">Windows</span>
<span class="field">Type:</span> <span class="value">Process</span>
<span class="field">Severity:</span> <span class="value">High</span>
<span class="field">Conditions:</span>
  <span class="keyword">AND</span>
    â”œâ”€ <span class="field">process_name</span> <span class="operator">~=</span> <span class="string">"powershell.exe"</span> <span class="keyword">OR</span> <span class="string">"pwsh.exe"</span>
    â”œâ”€ <span class="field">cmd_line</span> <span class="operator">contains</span> <span class="string">"-enc"</span> <span class="keyword">OR</span> <span class="string">"-EncodedCommand"</span>
    â””â”€ <span class="field">actor_process_name</span> <span class="operator">NOT IN</span> [<span class="string">"sccm"</span>, <span class="string">"intune"</span>, <span class="string">"chef"</span>]
<span class="field">MITRE:</span>
  <span class="value">Tactic:</span> Execution (TA0002)
  <span class="value">Technique:</span> Command and Scripting Interpreter: PowerShell (T1059.001)
<span class="field">Response:</span> <span class="value">Alert + Collect Forensics</span></pre>
                    </div>
                </div>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">Creating Custom BIOC Rules</h3>
                <p>Custom BIOC rules allow you to extend detection capabilities for organization-specific threats.</p>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-title">Custom BIOC: Detect Credential Dumping Tools</span>
                        <span class="code-lang">BIOC</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Detect common credential dumping tool executions</span>
<span class="field">Rule Name:</span> <span class="string">"Credential Dumping Tool Execution"</span>
<span class="field">OS:</span> <span class="value">Windows</span>
<span class="field">Severity:</span> <span class="value">Critical</span>
<span class="field">Conditions:</span>
  <span class="keyword">OR</span>
    â”œâ”€ <span class="field">process_name</span> <span class="operator">~=</span> <span class="string">"mimikatz"</span>
    â”œâ”€ <span class="field">process_name</span> <span class="operator">~=</span> <span class="string">"procdump"</span> <span class="keyword">AND</span> <span class="field">cmd_line</span> <span class="operator">contains</span> <span class="string">"lsass"</span>
    â”œâ”€ <span class="field">cmd_line</span> <span class="operator">~=</span> <span class="string">"sekurlsa::logonpasswords"</span>
    â”œâ”€ <span class="field">cmd_line</span> <span class="operator">contains</span> <span class="string">"comsvcs.dll"</span> <span class="keyword">AND</span> <span class="string">"MiniDump"</span>
    â””â”€ <span class="field">file_sha256</span> <span class="operator">IN</span> [<span class="string">known_mimikatz_hashes</span>]
<span class="field">Exclusions:</span>
  <span class="keyword">NOT</span>
    â””â”€ <span class="field">signer</span> <span class="operator">=</span> <span class="string">"Microsoft Corporation"</span> <span class="keyword">AND</span> <span class="field">signed</span> <span class="operator">=</span> <span class="value">true</span>
<span class="field">MITRE:</span> T1003.001 (LSASS Memory), TA0006 (Credential Access)</pre>
                    </div>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-title">Custom BIOC: Office Macro Spawning Shell</span>
                        <span class="code-lang">BIOC</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Detect Office applications spawning command shells</span>
<span class="field">Rule Name:</span> <span class="string">"Office Application Spawns Shell"</span>
<span class="field">OS:</span> <span class="value">Windows</span>
<span class="field">Severity:</span> <span class="value">High</span>
<span class="field">Conditions:</span>
  <span class="keyword">AND</span>
    â”œâ”€ <span class="field">actor_process_name</span> <span class="operator">IN</span> [<span class="string">"WINWORD.EXE"</span>, <span class="string">"EXCEL.EXE"</span>, <span class="string">"POWERPNT.EXE"</span>, <span class="string">"OUTLOOK.EXE"</span>]
    â””â”€ <span class="field">process_name</span> <span class="operator">IN</span> [<span class="string">"cmd.exe"</span>, <span class="string">"powershell.exe"</span>, <span class="string">"wscript.exe"</span>, <span class="string">"cscript.exe"</span>, <span class="string">"mshta.exe"</span>]
<span class="field">MITRE:</span>
  T1204.002 (User Execution: Malicious File)
  T1059 (Command and Scripting Interpreter)</pre>
                    </div>
                </div>
            </div>
            <div class="interview-box">
                <div class="interview-box-title">ğŸ’¼ Interview Answer: BIOC Rule Development Process</div>
                <div class="question">"Walk me through how you would create a custom BIOC rule for a new threat."</div>
                <div class="answer">
                    <p><strong>Step 1: Threat Research</strong> - Analyze the threat's TTPs from threat intel, sandbox analysis, or incident reports. Identify unique behavioral patterns.</p>
                    <p><strong>Step 2: Field Identification</strong> - Determine which XDM fields can detect this behavior: process name, command line, parent process, file paths, network connections.</p>
                    <p><strong>Step 3: Logic Design</strong> - Build AND/OR conditions that are specific enough to catch the threat but not so broad they generate false positives.</p>
                    <p><strong>Step 4: Testing in Query</strong> - Use XQL in Investigation to test the logic against historical data. Validate true positives and check for false positives.</p>
                    <p><strong>Step 5: Create BIOC Rule</strong> - Configure the rule with appropriate severity, MITRE mapping, and response actions.</p>
                    <p><strong>Step 6: Monitor & Tune</strong> - Deploy in alert-only mode first, monitor for a week, add exclusions for legitimate tools, then enable blocking if appropriate.</p>
                </div>
            </div>
        </section>
        <!-- Analytics BIOC -->
        <section class="section">
            <h2 class="section-title">Analytics BIOC - ML-Powered Detection</h2>
            <p>Analytics BIOC uses machine learning to detect threats without predefined signatures. It learns normal behavior baselines and identifies anomalies that may indicate compromise.</p>
            <div class="diagram-box">
                <div class="diagram-title">ğŸ“Š Analytics BIOC Learning Process</div>
                <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BASELINING PHASE (14-30 days)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚   Historical Data    â”€â”€â–º    ML Models Learn    â”€â”€â–º    Baseline Profiles      â”‚
â”‚   â€¢ Process patterns         â€¢ Normal behaviors       â€¢ Per-user baselines    â”‚
â”‚   â€¢ Network flows            â€¢ Time-of-day patterns   â€¢ Per-host baselines    â”‚
â”‚   â€¢ User behaviors           â€¢ Peer group analysis    â€¢ Department norms      â”‚
â”‚   â€¢ Authentication           â€¢ Resource access        â€¢ Network segments      â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DETECTION PHASE                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚   Real-time Events   â”€â”€â–º   Compare to Baseline  â”€â”€â–º  Anomaly Score (0-100)   â”‚
â”‚                                                                               â”‚
â”‚   Score Interpretation:                                                       â”‚
â”‚   â€¢ 0-30:  Normal behavior, no alert                                         â”‚
â”‚   â€¢ 31-60: Unusual but not suspicious, low-priority alert                    â”‚
â”‚   â€¢ 61-80: Suspicious deviation, medium alert + investigation                â”‚
â”‚   â€¢ 81-100: High-confidence anomaly, high/critical alert                     â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </pre>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">Analytics BIOC Types</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Analytics Type</th>
                                <th>What It Detects</th>
                                <th>Example Scenario</th>
                                <th>Data Sources</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>User Behavior Analytics</strong></td>
                                <td>Abnormal user activity patterns</td>
                                <td>User logging in at 3 AM when they never work nights</td>
                                <td>Auth logs, Azure AD, VPN</td>
                            </tr>
                            <tr>
                                <td><strong>Process Analytics</strong></td>
                                <td>Unusual process executions</td>
                                <td>Accounting user running PowerShell for first time</td>
                                <td>Endpoint telemetry</td>
                            </tr>
                            <tr>
                                <td><strong>Network Analytics</strong></td>
                                <td>Abnormal network behaviors</td>
                                <td>Host suddenly connecting to 50 new external IPs</td>
                                <td>Firewall, proxy, endpoint</td>
                            </tr>
                            <tr>
                                <td><strong>Data Access Analytics</strong></td>
                                <td>Unusual data access patterns</td>
                                <td>User downloading 10x more files than normal</td>
                                <td>File access, DLP, CASB</td>
                            </tr>
                            <tr>
                                <td><strong>Lateral Movement</strong></td>
                                <td>Internal reconnaissance/spreading</td>
                                <td>Host contacting 20 internal servers in 5 minutes</td>
                                <td>Network flow, auth logs</td>
                            </tr>
                            <tr>
                                <td><strong>Impossible Travel</strong></td>
                                <td>Physically impossible logins</td>
                                <td>Login from NYC, then 10 min later from Tokyo</td>
                                <td>Auth logs with geolocation</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">Analytics BIOC vs Rule-Based Comparison</h3>
                <div class="comparison-grid">
                    <div class="compare-card">
                        <div class="compare-card-header xsiam">BIOC Rules</div>
                        <div class="compare-card-body">
                            <h5>Deterministic Detection</h5>
                            <p>Exact matching based on defined conditions</p>
                            <ul>
                                <li>Known threat patterns</li>
                                <li>Consistent, predictable</li>
                                <li>Low false positives when tuned</li>
                                <li>Misses unknown variants</li>
                                <li>Requires constant updates</li>
                            </ul>
                        </div>
                    </div>
                    <div class="compare-card">
                        <div class="compare-card-header sentinel">Analytics BIOC</div>
                        <div class="compare-card-body">
                            <h5>Behavioral Detection</h5>
                            <p>ML-based anomaly identification</p>
                            <ul>
                                <li>Unknown threat detection</li>
                                <li>Adapts to environment</li>
                                <li>Detects insider threats</li>
                                <li>Higher initial false positives</li>
                                <li>Needs baselining time</li>
                            </ul>
                        </div>
                    </div>
                    <div class="compare-card">
                        <div class="compare-card-header splunk">Combined Approach</div>
                        <div class="compare-card-body">
                            <h5>Best Practice</h5>
                            <p>Use both for defense in depth</p>
                            <ul>
                                <li>BIOC for known threats</li>
                                <li>Analytics for unknowns</li>
                                <li>Correlation for context</li>
                                <li>Lower overall false negatives</li>
                                <li>Comprehensive coverage</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="memory-box">
                <div class="memory-box-title">ğŸ§  Memory Trick: When to Use Each Detection Type</div>
                <div class="mnemonic">"K-U-C" Rule</div>
                <ul>
                    <li><strong>K</strong>nown threat â†’ <strong>BIOC Rule</strong> (signature-like, deterministic)</li>
                    <li><strong>U</strong>nknown threat â†’ <strong>Analytics BIOC</strong> (behavioral anomaly)</li>
                    <li><strong>C</strong>omplex attack â†’ <strong>Correlation Rule</strong> (multi-source, custom logic)</li>
                </ul>
            </div>
        </section>
        <!-- Alert Severity & MITRE -->
        <section class="section">
            <h2 class="section-title">Alert Severity & MITRE Mapping</h2>
            <div class="subsection">
                <h3 class="subsection-title">Severity Levels</h3>
                <div class="severity-grid">
                    <div class="severity-card critical">
                        <div class="level">CRITICAL</div>
                        <div class="desc">Active compromise, immediate response needed</div>
                    </div>
                    <div class="severity-card high">
                        <div class="level">HIGH</div>
                        <div class="desc">Strong indicator of attack, investigate within hours</div>
                    </div>
                    <div class="severity-card medium">
                        <div class="level">MEDIUM</div>
                        <div class="desc">Suspicious activity, investigate within 24 hours</div>
                    </div>
                    <div class="severity-card low">
                        <div class="level">LOW</div>
                        <div class="desc">Informational, review during normal operations</div>
                    </div>
                </div>
                <div class="info-box tip">
                    <div class="info-box-title">ğŸ’¡ Severity Assignment Best Practices</div>
                    <p>Consider: (1) Confidence level of the detection, (2) Potential impact if true positive, (3) Attack stage (later stages = higher severity), (4) Asset criticality involved. A low-confidence detection on a critical asset may warrant medium severity, while high-confidence on a regular workstation might be medium.</p>
                </div>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">MITRE ATT&CK Integration</h3>
                <p>XSIAM automatically maps detections to MITRE ATT&CK framework, enabling coverage visualization and gap analysis.</p>
                <div class="mitre-grid">
                    <div class="mitre-card">
                        <div class="tactic">Initial Access</div>
                        <div class="technique">Phishing</div>
                        <div class="id">T1566</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Execution</div>
                        <div class="technique">PowerShell</div>
                        <div class="id">T1059.001</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Persistence</div>
                        <div class="technique">Registry Run Keys</div>
                        <div class="id">T1547.001</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Privilege Escalation</div>
                        <div class="technique">Token Manipulation</div>
                        <div class="id">T1134</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Defense Evasion</div>
                        <div class="technique">Obfuscated Files</div>
                        <div class="id">T1027</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Credential Access</div>
                        <div class="technique">LSASS Memory</div>
                        <div class="id">T1003.001</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Discovery</div>
                        <div class="technique">Network Scanning</div>
                        <div class="id">T1046</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Lateral Movement</div>
                        <div class="technique">Remote Services</div>
                        <div class="id">T1021</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Collection</div>
                        <div class="technique">Archive Data</div>
                        <div class="id">T1560</div>
                    </div>
                    <div class="mitre-card">
                        <div class="tactic">Exfiltration</div>
                        <div class="technique">Exfil Over C2</div>
                        <div class="id">T1041</div>
                    </div>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-title">XQL: Query Alerts by MITRE Tactic</span>
                        <span class="code-lang">XQL</span>
                    </div>
                    <div class="code-content">
<pre><span class="comment">// Find all alerts mapped to Credential Access tactic</span>
<span class="dataset">dataset</span> = <span class="value">xdr_data</span>
| <span class="keyword">filter</span> <span class="field">event_type</span> = <span class="string">"ALERT"</span>
| <span class="keyword">filter</span> <span class="field">mitre_tactic</span> <span class="operator">contains</span> <span class="string">"Credential Access"</span>
| <span class="keyword">fields</span> <span class="field">alert_name</span>, <span class="field">mitre_technique_id</span>, <span class="field">severity</span>, <span class="field">host_name</span>, <span class="field">user_name</span>
| <span class="keyword">sort</span> <span class="field">_time</span> <span class="keyword">desc</span>
| <span class="keyword">limit</span> <span class="number">100</span></pre>
                    </div>
                </div>
            </div>
        </section>
        <!-- Detection Use Cases -->
        <section class="section">
            <h2 class="section-title">Detection Use Cases</h2>
            <div class="use-case-grid">
                <div class="use-case-card">
                    <h4>ğŸ” Credential Theft <span class="attack-type">T1003</span></h4>
                    <p>Detect attempts to dump credentials from LSASS, SAM database, or credential stores.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> BIOC rule for procdump/mimikatz + Analytics for unusual LSASS access patterns
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>ğŸ£ Phishing Payload <span class="attack-type">T1566</span></h4>
                    <p>Detect malicious documents or links leading to payload execution.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> BIOC for Office â†’ cmd/PowerShell chains + file reputation analysis
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>ğŸ”„ Lateral Movement <span class="attack-type">T1021</span></h4>
                    <p>Identify attackers moving between systems using valid credentials or exploits.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> Analytics BIOC for unusual internal RDP/SMB + Correlation for auth anomalies
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>ğŸ“¡ C2 Communication <span class="attack-type">T1071</span></h4>
                    <p>Detect beaconing and command-and-control traffic to attacker infrastructure.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> Network BIOC for beaconing patterns + Analytics for rare domain connections
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>ğŸ“¤ Data Exfiltration <span class="attack-type">T1041</span></h4>
                    <p>Identify large data transfers or staging activities before exfiltration.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> Correlation rule for high outbound + Analytics for abnormal upload volumes
                    </div>
                </div>
                <div class="use-case-card">
                    <h4>ğŸ”’ Ransomware <span class="attack-type">T1486</span></h4>
                    <p>Detect encryption activity, shadow copy deletion, and ransom note creation.</p>
                    <div class="detection-method">
                        <strong>Detection:</strong> BIOC for vssadmin/wmic shadow delete + file BIOC for mass modifications
                    </div>
                </div>
            </div>
        </section>
        <!-- Platform Comparison: Detection -->
        <section class="section">
            <h2 class="section-title">Detection Capabilities Comparison</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Capability</th>
                            <th>XSIAM/Cortex XDR</th>
                            <th>Microsoft Sentinel</th>
                            <th>Splunk Enterprise Security</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Endpoint Detection</strong></td>
                            <td>Native Cortex Agent (BIOC)</td>
                            <td>MDE integration</td>
                            <td>Third-party EDR required</td>
                        </tr>
                        <tr>
                            <td><strong>Behavioral Rules</strong></td>
                            <td>BIOC (endpoint-native)</td>
                            <td>Analytics Rules (KQL)</td>
                            <td>Correlation Searches (SPL)</td>
                        </tr>
                        <tr>
                            <td><strong>ML Detection</strong></td>
                            <td>Analytics BIOC (built-in)</td>
                            <td>UEBA (requires license)</td>
                            <td>MLTK (addon toolkit)</td>
                        </tr>
                        <tr>
                            <td><strong>Cross-Source Correlation</strong></td>
                            <td>XQL Correlation Rules</td>
                            <td>Fusion Rules, Scheduled</td>
                            <td>Correlation Searches</td>
                        </tr>
                        <tr>
                            <td><strong>MITRE Mapping</strong></td>
                            <td>Automatic, native</td>
                            <td>Automatic, native</td>
                            <td>ES Content (manual)</td>
                        </tr>
                        <tr>
                            <td><strong>Rule Language</strong></td>
                            <td>XQL + GUI builder</td>
                            <td>KQL + GUI builder</td>
                            <td>SPL only</td>
                        </tr>
                        <tr>
                            <td><strong>Pre-built Rules</strong></td>
                            <td>Cortex Content Packs</td>
                            <td>Content Hub Solutions</td>
                            <td>ES Content Updates</td>
                        </tr>
                        <tr>
                            <td><strong>Alert Grouping</strong></td>
                            <td>Auto-stitched Incidents</td>
                            <td>Alert Grouping Rules</td>
                            <td>Notable Events</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
        <!-- Incident Management -->
        <section class="section">
            <h2 class="section-title">Alert to Incident Pipeline</h2>
            <div class="diagram-box">
                <div class="diagram-title">ğŸ“Š Alert Lifecycle in XSIAM</div>
                <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               ALERT GENERATION                                    â”‚
â”‚                                                                                   â”‚
â”‚   BIOC Match          Analytics Anomaly         Correlation Rule Match           â”‚
â”‚       â–¼                      â–¼                          â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        RAW ALERT CREATED                                 â”‚   â”‚
â”‚   â”‚   â€¢ Source detection type                                                â”‚   â”‚
â”‚   â”‚   â€¢ Initial severity                                                     â”‚   â”‚
â”‚   â”‚   â€¢ Raw event data                                                       â”‚   â”‚
â”‚   â”‚   â€¢ Timestamp                                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               ALERT ENRICHMENT                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   â€¢ Asset context (hostname, IP, user, criticality)                      â”‚   â”‚
â”‚   â”‚   â€¢ Threat intelligence lookup (IOC matching)                            â”‚   â”‚
â”‚   â”‚   â€¢ Historical context (previous alerts on same entity)                  â”‚   â”‚
â”‚   â”‚   â€¢ MITRE ATT&CK mapping                                                 â”‚   â”‚
â”‚   â”‚   â€¢ Risk score calculation                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             ALERT STITCHING                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   Correlate related alerts into INCIDENTS based on:                      â”‚   â”‚
â”‚   â”‚   â€¢ Same host/user within time window                                    â”‚   â”‚
â”‚   â”‚   â€¢ Same attack chain (MITRE tactics progression)                        â”‚   â”‚
â”‚   â”‚   â€¢ Same IOC or campaign indicators                                      â”‚   â”‚
â”‚   â”‚   â€¢ Causally related events (process â†’ network â†’ file)                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                   â”‚
â”‚   Alert 1 â”€â”€â”                                                                     â”‚
â”‚   Alert 2 â”€â”€â”¼â”€â”€â–º INCIDENT #12345                                                 â”‚
â”‚   Alert 3 â”€â”€â”˜    (Severity: High, 3 alerts, Host: WORKSTATION01)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            AUTO-INVESTIGATION                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   â€¢ Causality chain analysis (what caused what)                          â”‚   â”‚
â”‚   â”‚   â€¢ Timeline reconstruction                                              â”‚   â”‚
â”‚   â”‚   â€¢ Impact scope assessment (affected systems/users)                     â”‚   â”‚
â”‚   â”‚   â€¢ Automated verdict (True Positive / False Positive / Inconclusive)    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          RESPONSE OPTIONS                                         â”‚
â”‚                                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚  Manual Review â”‚  â”‚ XSOAR Playbook â”‚  â”‚  Auto-Remediateâ”‚  â”‚   Escalate    â”‚ â”‚
â”‚   â”‚  (Analyst)     â”‚  â”‚ (Automated)    â”‚  â”‚  (Block/Isolate)â”‚ â”‚   (Tier 2/3)  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </pre>
            </div>
            <div class="info-box tip">
                <div class="info-box-title">ğŸ’¡ Alert Stitching Benefit</div>
                <p>Alert stitching reduces analyst workload by 70-90% by grouping related alerts into single incidents. Instead of investigating 50 individual alerts for a ransomware attack, analysts see 1 incident with full attack timeline.</p>
            </div>
        </section>
        <!-- Best Practices -->
        <section class="section">
            <h2 class="section-title">Detection Engineering Best Practices</h2>
            <div class="subsection">
                <h3 class="subsection-title">Rule Development Workflow</h3>
                <ul class="content-list">
                    <li><strong>Threat-Informed:</strong> Start with threat intelligence - what TTPs are adversaries using against your industry?</li>
                    <li><strong>Test Before Deploy:</strong> Always test detection logic with XQL queries against historical data before creating rules</li>
                    <li><strong>Baseline False Positives:</strong> Identify legitimate behaviors that might trigger the rule and add exclusions</li>
                    <li><strong>Severity Alignment:</strong> Match severity to actual risk - not every detection needs to be "Critical"</li>
                    <li><strong>MITRE Coverage:</strong> Map rules to MITRE ATT&CK and identify gaps in your detection coverage</li>
                    <li><strong>Documentation:</strong> Document rule logic, expected true positives, known false positives, and tuning history</li>
                    <li><strong>Continuous Tuning:</strong> Review rule performance monthly - adjust thresholds and exclusions as environment changes</li>
                </ul>
            </div>
            <div class="subsection">
                <h3 class="subsection-title">Common Detection Pitfalls</h3>
                <div class="info-box warning">
                    <div class="info-box-title">âš ï¸ Pitfall: Over-Broad Detection</div>
                    <p>Detecting "any PowerShell execution" generates thousands of false positives. Focus on suspicious characteristics: encoding, download cradles, bypass flags, spawned from unusual parents.</p>
                </div>
                <div class="info-box warning">
                    <div class="info-box-title">âš ï¸ Pitfall: Missing Context</div>
                    <p>A detection for "cmd.exe spawned by explorer.exe" is normal (user opening command prompt). Add context: is it running encoded commands? Accessing sensitive directories? Making network connections?</p>
                </div>
                <div class="info-box warning">
                    <div class="info-box-title">âš ï¸ Pitfall: Ignoring Evasion</div>
                    <p>Attackers know common detections. Don't just detect "mimikatz.exe" - detect behaviors like LSASS access, regardless of tool name. Use multiple detection points for the same attack.</p>
                </div>
            </div>
            <div class="interview-box">
                <div class="interview-box-title">ğŸ’¼ Interview Answer: Detection Engineering Philosophy</div>
                <div class="question">"How do you approach building detection content for a new environment?"</div>
                <div class="answer">
                    <p><strong>1. Baseline First:</strong> Understand what's normal in the environment. Run discovery queries to see common processes, network patterns, authentication flows.</p>
                    <p><strong>2. Crown Jewels:</strong> Identify critical assets and build detections specifically protecting them - database servers, domain controllers, executive endpoints.</p>
                    <p><strong>3. Kill Chain Coverage:</strong> Ensure detection at multiple attack stages. If initial access is missed, catch them at execution. If execution is missed, catch lateral movement.</p>
                    <p><strong>4. Layer Detections:</strong> Use BIOC for endpoint behaviors, Analytics for anomalies, Correlation for cross-source attacks. Defense in depth applies to detection too.</p>
                    <p><strong>5. Iterate:</strong> Detection engineering is never "done." Review alerts weekly, tune false positives, add new detections based on threat intel, and validate coverage with purple team exercises.</p>
                </div>
            </div>
        </section>
        <!-- Navigation Cards -->
        <div class="nav-cards">
            <a href="xql-advanced.html" class="nav-card">
                <div class="nav-direction">â† Previous</div>
                <div class="nav-title">Advanced XQL</div>
            </a>
            <a href="xsoar-automation.html" class="nav-card">
                <div class="nav-direction">Next â†’</div>
                <div class="nav-title">XSOAR Automation</div>
            </a>
        </div>
            </main>
            <footer class="main-footer">
                <p>Nik's SIEM - Security Operations Knowledge Base</p>
                <p>Created for interview preparation and operational reference</p>
            </footer>
        </div>
    </div>
    <script src="../assets/js/main.js"></script>
</body>
</html>
