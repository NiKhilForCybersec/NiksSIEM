<!DOCTYPE html>
<html lang="en" data-theme="dark" data-platform="xsiam">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cortex XDR Agents | XSIAM | Nik's SIEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">SIEM Reference Guide</span>
                    </div>
                </a>
            </div>
            <div class="platform-selector">
                <div class="platform-tabs">
                    <a href="../xsiam/index.html" class="platform-tab xsiam active"><i class="fas fa-fire"></i> XSIAM</a>
                    <a href="../sentinel/index.html" class="platform-tab sentinel"><i class="fas fa-shield-alt"></i> Sentinel</a>
                    <a href="../splunk/index.html" class="platform-tab splunk"><i class="fas fa-search"></i> Splunk</a>
                    <a href="../mde/index.html" class="platform-tab mde"><i class="fas fa-desktop"></i> MDE</a>
                </div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="agents.html" class="nav-link active"><i class="fas fa-user-secret"></i> Cortex Agents</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Ingestion</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing Flows</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention Tiers</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM Setup</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> XQL Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> Advanced XQL</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="xdr-overview.html" class="nav-link"><i class="fas fa-shield-virus"></i> XDR Detection</a>
                    <a href="correlation-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> Correlation Rules</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Threat Intelligence</div>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Intel</a>
                    <a href="recon-asm.html" class="nav-link"><i class="fas fa-globe"></i> Recon & ASM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reference</div>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> Platform Comparison</a>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-line"></i> Dashboards</a>
                </div>
            </nav>
        </aside>
        
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Cortex Agents</span>
                </div>
            </header>
            
            <main class="main-content">
                <h1><i class="fas fa-user-secret"></i> Cortex XDR Agents</h1>
                <p class="lead">The Cortex XDR agent provides unified endpoint protection, detection, and response capabilities, collecting rich telemetry while preventing malware, exploits, and fileless attacks.</p>
                
                <div class="concept-box">
                    <h3><i class="fas fa-question-circle"></i> Agent vs. Agentless</h3>
                    <p>XSIAM supports both agent-based and agentless data collection:</p>
                    <ul>
                        <li><strong>Cortex Agent:</strong> Full protection + telemetry, response actions, behavioral analysis</li>
                        <li><strong>Agentless:</strong> Log collection only via Broker VM, cloud APIs, or direct forwarding</li>
                    </ul>
                    <p>For complete endpoint visibility and protection, the Cortex agent is essential.</p>
                </div>
                
                <h2><i class="fas fa-shield-alt"></i> Agent Capabilities</h2>
                
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Capability</th>
                                <th>Description</th>
                                <th>Configurable</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Malware Protection</strong></td>
                                <td>AI-driven detection of known and unknown malware</td>
                                <td>Block/Detect/Disabled modes</td>
                            </tr>
                            <tr>
                                <td><strong>Exploit Protection</strong></td>
                                <td>Memory corruption, code injection, technique-based prevention</td>
                                <td>Per-technique settings</td>
                            </tr>
                            <tr>
                                <td><strong>Behavioral Threat Protection</strong></td>
                                <td>ML-based analysis of process behavior chains</td>
                                <td>Sensitivity levels</td>
                            </tr>
                            <tr>
                                <td><strong>Ransomware Protection</strong></td>
                                <td>Encryption behavior detection and prevention</td>
                                <td>Block/Detect</td>
                            </tr>
                            <tr>
                                <td><strong>Device Control</strong></td>
                                <td>USB and removable media management</td>
                                <td>Allow/Block/Read-only</td>
                            </tr>
                            <tr>
                                <td><strong>Host Firewall</strong></td>
                                <td>Network traffic control per endpoint</td>
                                <td>Rule-based policies</td>
                            </tr>
                            <tr>
                                <td><strong>Disk Encryption</strong></td>
                                <td>BitLocker/FileVault management and reporting</td>
                                <td>Enforce/Report</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2><i class="fas fa-laptop"></i> Supported Platforms</h2>
                
                <div class="card-grid">
                    <div class="card" style="cursor: default;">
                        <div class="card-icon"><i class="fab fa-windows"></i></div>
                        <h3>Windows</h3>
                        <p>Windows 10/11, Server 2016-2022. Full feature support including host firewall.</p>
                    </div>
                    <div class="card" style="cursor: default;">
                        <div class="card-icon"><i class="fab fa-apple"></i></div>
                        <h3>macOS</h3>
                        <p>macOS 11+ (Big Sur and later). Kernel extensions or System Extensions.</p>
                    </div>
                    <div class="card" style="cursor: default;">
                        <div class="card-icon"><i class="fab fa-linux"></i></div>
                        <h3>Linux</h3>
                        <p>RHEL, Ubuntu, CentOS, Debian, SUSE. Server and container support.</p>
                    </div>
                    <div class="card" style="cursor: default;">
                        <div class="card-icon"><i class="fab fa-android"></i></div>
                        <h3>Android</h3>
                        <p>Android 8.0+. Mobile threat defense with app analysis.</p>
                    </div>
                    <div class="card" style="cursor: default;">
                        <div class="card-icon"><i class="fab fa-apple"></i></div>
                        <h3>iOS</h3>
                        <p>iOS 14+. Jailbreak detection, network protection, app inventory.</p>
                    </div>
                    <div class="card" style="cursor: default;">
                        <div class="card-icon"><i class="fas fa-cloud"></i></div>
                        <h3>Kubernetes</h3>
                        <p>Container runtime security, pod-level visibility.</p>
                    </div>
                </div>
                
                <h2><i class="fas fa-download"></i> Agent Deployment</h2>
                
                <h3>Deployment Methods</h3>
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Best For</th>
                                <th>Requirements</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Manual Install</strong></td>
                                <td>Testing, small deployments</td>
                                <td>Local admin rights</td>
                            </tr>
                            <tr>
                                <td><strong>Group Policy (GPO)</strong></td>
                                <td>Windows domain environments</td>
                                <td>Active Directory, network share</td>
                            </tr>
                            <tr>
                                <td><strong>SCCM/Intune</strong></td>
                                <td>Enterprise Windows deployment</td>
                                <td>Management infrastructure</td>
                            </tr>
                            <tr>
                                <td><strong>Jamf Pro</strong></td>
                                <td>macOS enterprise</td>
                                <td>Jamf instance</td>
                            </tr>
                            <tr>
                                <td><strong>Ansible/Chef/Puppet</strong></td>
                                <td>Linux servers, DevOps</td>
                                <td>Configuration management</td>
                            </tr>
                            <tr>
                                <td><strong>Container Sidecar</strong></td>
                                <td>Kubernetes clusters</td>
                                <td>Helm charts, DaemonSet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Windows Installation</h3>
                <div class="code-block">
                    <div class="code-header">Silent Installation (Command Line)</div>
                    <pre># Download installer from XSIAM console
# Settings → Endpoints → Agent Installation

# Silent install with distribution ID
msiexec /i cortex-xdr-agent.msi /qn DISTRIBUTION_ID=&lt;YOUR_DIST_ID&gt;

# With proxy configuration
msiexec /i cortex-xdr-agent.msi /qn DISTRIBUTION_ID=&lt;ID&gt; ^
    PROXY_URL=http://proxy.corp.com:8080

# Verify installation
sc query cyserver
"C:\Program Files\Palo Alto Networks\Traps\cytool.exe" info</pre>
                </div>
                
                <h3>macOS Installation</h3>
                <div class="code-block">
                    <div class="code-header">macOS Deployment</div>
                    <pre># Download PKG from XSIAM console

# Install via command line
sudo installer -pkg Cortex_XDR_Agent.pkg -target /

# Grant Full Disk Access (required)
# System Preferences → Security & Privacy → Privacy → Full Disk Access
# Add: /Library/Application Support/PaloAltoNetworks/Traps/bin/pmd

# Grant Network Extension approval
# System Preferences → Security & Privacy → General → Allow Palo Alto

# Verify installation
/Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool info</pre>
                </div>
                
                <h3>Linux Installation</h3>
                <div class="code-block">
                    <div class="code-header">Linux Agent Deployment</div>
                    <pre># RHEL/CentOS
sudo rpm -ivh cortex-xdr-agent-*.rpm

# Ubuntu/Debian
sudo dpkg -i cortex-xdr-agent-*.deb

# With distribution ID
sudo /opt/traps/bin/cytool configure distid &lt;YOUR_DIST_ID&gt;

# Verify service status
sudo systemctl status traps_pmd

# Check agent connectivity
sudo /opt/traps/bin/cytool info
sudo /opt/traps/bin/cytool connectivity check</pre>
                </div>
                
                <h2><i class="fas fa-cogs"></i> Agent Configuration</h2>
                
                <h3>Security Profiles</h3>
                <div class="info-box">
                    <h4>Profile Types</h4>
                    <ul>
                        <li><strong>Malware Profile:</strong> AI analysis mode, scan settings, exclusions</li>
                        <li><strong>Exploit Profile:</strong> Technique-specific protection settings</li>
                        <li><strong>Restrictions Profile:</strong> Application restrictions, script control</li>
                        <li><strong>Device Control Profile:</strong> USB and removable media policies</li>
                        <li><strong>Host Firewall Profile:</strong> Network access rules</li>
                    </ul>
                </div>
                
                <h3>Common Exclusions</h3>
                <div class="code-block">
                    <div class="code-header">Typical Exclusion Patterns</div>
                    <pre># Process Exclusions (for performance/compatibility)
# Add via: Endpoints → Profiles → Malware → Exclusions

# Backup Software
C:\Program Files\Veeam\*
C:\Program Files\Commvault\*

# Database Engines
C:\Program Files\Microsoft SQL Server\*\MSSQL\Binn\sqlservr.exe
/u01/app/oracle/product/*/bin/oracle

# Development Tools
C:\Program Files\Microsoft Visual Studio\*
/opt/jetbrains/*

# Virtualization
C:\Program Files\VMware\*

# Security Tools (if compatibility issues)
# Be cautious - verify necessity before excluding</pre>
                </div>
                
                <h2><i class="fas fa-heartbeat"></i> Agent Health Monitoring</h2>
                
                <div class="code-block">
                    <div class="code-header">XQL: Agent Health Dashboard Queries</div>
                    <pre>// Agent connectivity status
dataset = endpoints
| comp count() as count by agent_status
| alter pct = round(multiply(divide(count, sum(count)), 100), 1)

// Agents not checking in (offline > 24h)
dataset = endpoints
| filter agent_status = "DISCONNECTED"
| filter last_seen < ago(24h)
| fields hostname, ip_address, os_type, last_seen, agent_version
| sort asc last_seen

// Agent version distribution
dataset = endpoints
| comp count() as count by agent_version
| sort desc count

// Endpoints missing agent
dataset = asset_inventory
| join type = left (
    dataset = endpoints
    | fields hostname, agent_status
) as agents on hostname = agents.hostname
| filter agents.hostname = null
| fields hostname, ip_address, os_type, asset_source</pre>
                </div>
                
                <h3>Troubleshooting Commands</h3>
                <div class="code-block">
                    <div class="code-header">Agent Diagnostic Commands</div>
                    <pre># Windows - cytool commands
"C:\Program Files\Palo Alto Networks\Traps\cytool.exe" info
"C:\Program Files\Palo Alto Networks\Traps\cytool.exe" connectivity check
"C:\Program Files\Palo Alto Networks\Traps\cytool.exe" log collect

# Check service status
sc query cyserver
Get-Service -Name "Cortex XDR*"

# View agent logs
Get-Content "C:\ProgramData\Cyvera\Logs\*.log" -Tail 100

# Linux
sudo /opt/traps/bin/cytool info
sudo /opt/traps/bin/cytool connectivity check
sudo journalctl -u traps_pmd -f

# macOS
/Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool info
/Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool connectivity check</pre>
                </div>
                
                <h3>Common Issues & Solutions</h3>
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Issue</th>
                                <th>Symptoms</th>
                                <th>Resolution</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Agent offline</td>
                                <td>No check-in, disconnected status</td>
                                <td>Verify network/proxy, check service running, verify FQDN resolution</td>
                            </tr>
                            <tr>
                                <td>High CPU usage</td>
                                <td>Endpoint performance issues</td>
                                <td>Add process exclusions for known heavy apps, check scan schedule</td>
                            </tr>
                            <tr>
                                <td>Application blocked</td>
                                <td>Legitimate app prevented</td>
                                <td>Add hash/path exception, review exploit profile</td>
                            </tr>
                            <tr>
                                <td>macOS permissions</td>
                                <td>Reduced protection features</td>
                                <td>Grant Full Disk Access, approve kernel/system extension</td>
                            </tr>
                            <tr>
                                <td>Version mismatch</td>
                                <td>Features not working</td>
                                <td>Update agent to latest, check content updates</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2><i class="fas fa-terminal"></i> Live Terminal (Response)</h2>
                
                <div class="info-box">
                    <h4>Live Terminal Capabilities</h4>
                    <p>Remote shell access to endpoints for investigation and response:</p>
                    <ul>
                        <li>Execute commands on endpoint</li>
                        <li>Collect files for analysis</li>
                        <li>Push scripts for remediation</li>
                        <li>Kill processes, quarantine files</li>
                        <li>Network isolation</li>
                    </ul>
                </div>
                
                <div class="code-block">
                    <div class="code-header">Common Live Terminal Commands</div>
                    <pre># Process investigation
processlist
processlist -filter "name contains powershell"

# File operations
filelist "C:\Users\*\Downloads"
fileinfo "C:\Windows\Temp\suspicious.exe"
getfile "C:\Windows\Temp\suspicious.exe"

# Registry investigation (Windows)
reglist "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"

# Network connections
netstat
netstat -filter "state=ESTABLISHED"

# Kill malicious process
processkill -pid 1234

# Quarantine file
filequarantine "C:\malware.exe"

# Network isolation
isolate  # Cuts all network except XSIAM communication
unisolate  # Restores network</pre>
                </div>
                
                <div class="interview-box">
                    <h4><i class="fas fa-user-tie"></i> Interview Answer: "How do you handle agent deployment at scale?"</h4>
                    <p>"For enterprise agent deployment, I use existing management infrastructure. For Windows, I create an SCCM or Intune deployment package with the MSI and distribution ID pre-configured for silent installation. I use GPO startup scripts as a fallback for machines not in SCCM. For macOS, I deploy via Jamf Pro with a PreStage enrollment that includes the Cortex agent and pre-approves the required privacy permissions via PPPC profiles. For Linux servers, I use Ansible playbooks that handle package installation and distribution ID configuration. I start with a pilot group of 5-10% of endpoints, monitor for compatibility issues for a week, then roll out in phases. I track deployment progress via XSIAM dashboards showing agent coverage percentage and any installation failures."</p>
                </div>
                
                <div class="interview-box">
                    <h4><i class="fas fa-user-tie"></i> Interview Answer: "How do you troubleshoot an agent that's not connecting?"</h4>
                    <p>"I follow a systematic process. First, I verify the agent service is running - on Windows, check 'cyserver' service status. Then I run 'cytool connectivity check' to test communication with the XSIAM cloud. If that fails, I check network connectivity: can the endpoint reach the XSIAM URLs on port 443? Are there proxy requirements not configured? I review the agent logs for specific error messages. Common issues include firewall blocking outbound HTTPS, incorrect proxy settings, or certificate inspection interfering with the connection. For certificate issues, I add the XSIAM URLs to the SSL inspection bypass list. If the agent was working before, I check what changed - Windows updates, new security software, or network changes. As a last resort, I uninstall and reinstall the agent with fresh configuration."</p>
                </div>
                
            </main>
            
            <footer class="main-footer">
                <div class="footer-content">
                    <div class="footer-links">
                        <a href="../index.html">Home</a>
                        <a href="index.html">XSIAM</a>
                        <a href="xdr-overview.html">XDR Detection</a>
                        <a href="architecture.html">Architecture</a>
                    </div>
                    <div class="footer-copy">Nik's SIEM - Security Operations Knowledge Base</div>
                </div>
            </footer>
        </div>
    </div>
    
    <button class="sidebar-toggle"><i class="fas fa-bars"></i></button>
    <script src="../assets/js/main.js"></script>
</body>
</html>
