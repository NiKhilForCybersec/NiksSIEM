<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cortex XDR Agent - Complete Configuration Guide | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">

    <style>
        /* Decision Tree Styles */
        .decision-tree {
            padding: 25px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            margin: 20px 0;
        }
        .decision-node {
            background: #21262d;
            border: 2px solid #30363d;
            border-radius: 10px;
            padding: 15px 20px;
            margin: 10px auto;
            max-width: 450px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .decision-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        .decision-node h4 {
            color: #e6edf3;
            margin: 0 0 5px 0;
            font-size: 14px;
            font-weight: 600;
        }
        .decision-node p, .decision-node small {
            color: #8b949e;
            font-size: 12px;
            margin: 0;
        }
        .decision-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 20px;
            margin: 8px 0;
        }
        .decision-branches {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        .decision-branch {
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 15px;
            min-width: 180px;
            max-width: 280px;
            background: rgba(33, 38, 45, 0.5);
        }
        .decision-branch.yes { border-color: #238636; }
        .decision-branch.no { border-color: #f85149; }
        .branch-label {
            display: block;
            text-align: center;
            font-weight: 600;
            margin-bottom: 10px;
            color: #8b949e;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .decision-outcome {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            color: white;
        }
        .decision-outcome i {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }
        .decision-outcome strong {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }
        .decision-outcome small {
            opacity: 0.9;
            font-size: 11px;
        }

        /* Flow Diagram Styles */
        .flow-diagram {
            padding: 25px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            margin: 20px 0;
        }
        .flow-step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            background: #21262d;
            border-radius: 10px;
            padding: 18px;
            margin: 12px 0;
            border-left: 4px solid #58a6ff;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .flow-step:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        .flow-icon {
            width: 45px;
            height: 45px;
            background: rgba(88, 166, 255, 0.15);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #58a6ff;
            flex-shrink: 0;
            font-size: 18px;
        }
        .flow-content h4 {
            margin: 0 0 10px 0;
            color: #e6edf3;
            font-size: 15px;
            font-weight: 600;
        }
        .flow-content ul {
            margin: 0;
            padding-left: 20px;
            color: #8b949e;
        }
        .flow-content li {
            margin: 6px 0;
            font-size: 13px;
            line-height: 1.5;
        }
        .flow-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 20px;
            margin: 8px 0;
        }

        /* Pipeline Styles */
        .pipeline-container {
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            padding: 25px;
            margin: 20px 0;
        }
        .pipeline-stage {
            margin-bottom: 20px;
        }
        .pipeline-stage .stage-bar {
            height: 8px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .pipeline-stage h4 {
            color: #e6edf3;
            font-size: 14px;
            margin: 0 0 5px 0;
        }
        .pipeline-stage p {
            color: #8b949e;
            font-size: 13px;
            margin: 0 0 5px 0;
        }
        .pipeline-stage small {
            color: #6e7681;
            font-size: 12px;
        }
        .pipeline-arrow {
            text-align: left;
            color: #8b949e;
            margin: 10px 0;
            font-size: 16px;
        }

        /* Strategy Grid Styles */
        .strategy-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 15px;
            background: linear-gradient(135deg, #161b22 0%, #0d1117 100%);
            border-radius: 12px;
            border: 1px solid #30363d;
            padding: 25px;
            margin: 20px 0;
        }
        .endpoint-type {
            background: #21262d;
            border-radius: 8px;
            padding: 15px;
            min-width: 150px;
            display: flex;
            align-items: center;
            font-weight: 600;
            color: #e6edf3;
            font-size: 13px;
        }
        .collection-profile {
            background: #21262d;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #58a6ff;
        }
        .collection-profile h4 {
            color: #e6edf3;
            margin: 0 0 5px 0;
            font-size: 14px;
        }
        .collection-profile p {
            color: #8b949e;
            margin: 0;
            font-size: 12px;
        }

        /* Enterprise Gap Cards */
        .enterprise-gap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .gap-card {
            background: #21262d;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #30363d;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .gap-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .gap-card h4 {
            margin: 0 0 15px 0;
            font-size: 16px;
            color: #e6edf3;
        }
        .gap-card ul {
            margin: 0;
            padding-left: 20px;
        }
        .gap-card li {
            margin: 10px 0;
            color: #8b949e;
            font-size: 13px;
            line-height: 1.5;
        }
        .gap-card li strong {
            color: #e6edf3;
        }
        .gap-critical { border-left: 4px solid #f85149; }
        .gap-warning { border-left: 4px solid #d29922; }
        .gap-info { border-left: 4px solid #58a6ff; }
        .gap-best-practice { border-left: 4px solid #238636; }

        /* Quick Reference Cards */
        .quick-ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .quick-ref-card {
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .quick-ref-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .quick-ref-card h4 {
            color: #58a6ff;
            margin: 0 0 10px 0;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .quick-ref-card p {
            color: #8b949e;
            margin: 0;
            font-size: 13px;
            line-height: 1.5;
        }

        /* Enhanced Q&A Styling */
        .qa-section {
            margin: 20px 0;
        }
        .qa-item {
            margin-bottom: 15px;
            border-radius: 10px;
            overflow: hidden;
            background: #21262d;
            border: 1px solid #30363d;
        }
        .qa-question {
            width: 100%;
            padding: 18px 20px;
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            border: none;
            color: #e6edf3;
            font-size: 14px;
            font-weight: 600;
            text-align: left;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background 0.2s;
        }
        .qa-question:hover {
            background: linear-gradient(135deg, #30363d 0%, #21262d 100%);
        }
        .qa-question i {
            color: #d29922;
            font-size: 18px;
        }
        .qa-answer {
            padding: 20px;
            background: #161b22;
            border-top: 1px solid #30363d;
            display: none;
        }
        .qa-answer p {
            color: #8b949e;
            line-height: 1.7;
            margin: 0 0 15px 0;
            font-size: 14px;
        }
        .qa-answer p:last-child {
            margin-bottom: 0;
        }

        /* Info Cards */
        .info-card {
            background: #21262d;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #30363d;
            margin: 15px 0;
        }
        .info-card.critical { border-left: 4px solid #f85149; }
        .info-card.warning { border-left: 4px solid #d29922; }
        .info-card.info { border-left: 4px solid #58a6ff; }
        .info-card.success { border-left: 4px solid #238636; }

        /* Config Sections */
        .config-section {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .config-section h3 {
            color: #58a6ff;
            margin: 0 0 15px 0;
            font-size: 16px;
        }

        /* Comparison Tables */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #21262d;
            border-radius: 10px;
            overflow: hidden;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #30363d;
        }
        .comparison-table th {
            background: #161b22;
            color: #e6edf3;
            font-weight: 600;
            font-size: 13px;
        }
        .comparison-table td {
            color: #8b949e;
            font-size: 13px;
        }

        /* Architecture Diagrams */
        .arch-diagram {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #8b949e;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        /* Grid Layouts */
        .grid-2col {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .grid-3col {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
    </style>

</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
                <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link active"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>




        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Agents</span>
                </div>

                <h1><i class="fas fa-desktop"></i> Cortex XDR Agent - Complete Configuration Guide</h1>
                <p class="lead">The Cortex XDR agent is the endpoint sensor that collects telemetry and enables response actions. This guide covers installation, policy configuration, data collection tuning, and troubleshooting with actual console paths and commands.</p>

                <!-- Agent Deployment Decision Tree -->
                <h2><i class="fas fa-project-diagram"></i> Agent Deployment Decision Tree</h2>
                <p>Use this decision tree to determine the best deployment method for your environment:</p>

                <div class="decision-tree">
                    <div class="decision-node" style="background: linear-gradient(135deg, #238636, #2ea043);">
                        <i class="fas fa-question-circle"></i>
                        <span>How many endpoints need the agent?</span>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #58a6ff;">1-10 Endpoints</div>
                        <div class="decision-node" style="background: #21262d; border: 2px solid #3fb950;">
                            <i class="fas fa-user"></i>
                            <span>Manual Installation</span>
                            <small style="display: block; margin-top: 8px; color: #8b949e;">Download MSI/PKG directly from XSIAM console</small>
                        </div>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #d29922;">10-500 Endpoints</div>
                        <div class="decision-node" style="background: #21262d;">
                            <i class="fas fa-question-circle"></i>
                            <span>Do you have MDM/SCCM?</span>
                        </div>
                        <div class="decision-branch" style="margin-left: 40px;">
                            <div class="decision-arrow" style="background: #3fb950;">Yes → Intune/SCCM</div>
                            <div class="decision-arrow" style="background: #f85149;">No → GPO or Script</div>
                        </div>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #f85149;">500+ Endpoints</div>
                        <div class="decision-node" style="background: #21262d; border: 2px solid #58a6ff;">
                            <i class="fas fa-building"></i>
                            <span>Phased Enterprise Deployment</span>
                            <small style="display: block; margin-top: 8px; color: #8b949e;">Pilot (100) → Wave 1 (1000) → Full deployment</small>
                        </div>
                    </div>
                </div>

                <!-- Agent Overview -->
                <h2><i class="fas fa-info-circle"></i> What Data Does the Agent Collect?</h2>
                
                <div class="info-box" style="border-color: #58a6ff;">
                    <h4><i class="fas fa-database"></i> Agent Telemetry Categories</h4>
                    <p>The Cortex XDR agent collects the following data types (all configurable via policy):</p>
                </div>

                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Data Type</th>
                                <th>What It Captures</th>
                                <th>XDM Dataset</th>
                                <th>Typical Volume</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Process Execution</strong></td>
                                <td>Every process start: path, command line, parent process, user, hash</td>
                                <td><span class="field-ref">xdr_data</span> event_type=PROCESS</td>
                                <td>~500-2000 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>File Operations</strong></td>
                                <td>Create, modify, delete, rename of files (configurable paths)</td>
                                <td><span class="field-ref">xdr_data</span> event_type=FILE</td>
                                <td>~1000-5000 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>Network Connections</strong></td>
                                <td>Outbound/inbound connections: IP, port, process, bytes</td>
                                <td><span class="field-ref">xdr_data</span> event_type=NETWORK</td>
                                <td>~200-1000 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>Registry (Windows)</strong></td>
                                <td>Key creation, modification, deletion (security-relevant keys)</td>
                                <td><span class="field-ref">xdr_data</span> event_type=REGISTRY</td>
                                <td>~100-500 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>Module/DLL Loads</strong></td>
                                <td>Libraries loaded by processes</td>
                                <td><span class="field-ref">xdr_data</span> event_type=LOAD_IMAGE</td>
                                <td>~500-2000 events/endpoint/day</td>
                            </tr>
                            <tr>
                                <td><strong>Authentication</strong></td>
                                <td>Local logons, logoffs, failed attempts</td>
                                <td><span class="field-ref">xdr_data</span> event_type=AUTH</td>
                                <td>~10-100 events/endpoint/day</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Data Collection Strategy Decision Tree -->
                <h2><i class="fas fa-sliders-h"></i> Data Collection Strategy by Endpoint Type</h2>
                <p>Different endpoint types need different collection profiles. Use this guide to optimize detection vs. performance:</p>

                <div class="decision-tree">
                    <div class="decision-node" style="background: linear-gradient(135deg, #58a6ff, #1f6feb);">
                        <i class="fas fa-laptop"></i>
                        <span>What type of endpoint?</span>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #3fb950;">Standard Workstation</div>
                        <div class="decision-node" style="background: #21262d; border: 2px solid #3fb950;">
                            <i class="fas fa-check-double"></i>
                            <span>Full Collection Profile</span>
                            <small style="display: block; margin-top: 8px; color: #8b949e;">Process + CMD Line + Network + Registry + Files + Scripts</small>
                        </div>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #d29922;">High-Security (Executives)</div>
                        <div class="decision-node" style="background: #21262d; border: 2px solid #d29922;">
                            <i class="fas fa-shield-alt"></i>
                            <span>Maximum Collection Profile</span>
                            <small style="display: block; margin-top: 8px; color: #8b949e;">All above + Module Loads + DNS Queries</small>
                        </div>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #58a6ff;">Application Server</div>
                        <div class="decision-node" style="background: #21262d; border: 2px solid #58a6ff;">
                            <i class="fas fa-server"></i>
                            <span>Optimized Server Profile</span>
                            <small style="display: block; margin-top: 8px; color: #8b949e;">Process + CMD Line + Network (exclude Module Loads)</small>
                        </div>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #f85149;">Database/High-IO Server</div>
                        <div class="decision-node" style="background: #21262d; border: 2px solid #f85149;">
                            <i class="fas fa-database"></i>
                            <span>Minimal Server Profile</span>
                            <small style="display: block; margin-top: 8px; color: #8b949e;">Process + CMD Line + Scripts only (exclude File ops)</small>
                        </div>
                    </div>
                </div>

                <!-- Installation Methods -->
                <h2><i class="fas fa-download"></i> Agent Installation Methods</h2>

                <h3>Method 1: Manual Installation (Single Endpoint)</h3>
                <div class="config-section">
                    <h4>Step 1: Download Agent Package</h4>
                    <div class="console-path">XSIAM Console → Settings → Endpoints → Agent Installation</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Navigate to Agent Downloads</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Go to Settings (gear icon) → Endpoints → Agent Installation</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Select Platform & Version</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Choose: Windows (64-bit), macOS, or Linux. Select latest stable version.</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Download Package</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Download includes: installer + distribution ID (auto-configured)</p>
                        </div>
                    </div>

                    <h4>Windows Installation Command</h4>
                    <div class="arch-diagram">
<span class="code-comment"># Run as Administrator</span>
<span class="code-command">msiexec</span> /i CortexXDR_x64.msi /qn <span class="code-param">DISTRIBUTION_ID</span>=<span class="code-value">"your-distribution-id"</span>

<span class="code-comment"># With custom installation path</span>
<span class="code-command">msiexec</span> /i CortexXDR_x64.msi /qn <span class="code-param">DISTRIBUTION_ID</span>=<span class="code-value">"your-distribution-id"</span> <span class="code-param">INSTALLDIR</span>=<span class="code-value">"C:\Program Files\Cortex XDR"</span>

<span class="code-comment"># Silent install with logging</span>
<span class="code-command">msiexec</span> /i CortexXDR_x64.msi /qn /l*v <span class="code-value">C:\temp\cortex_install.log</span> <span class="code-param">DISTRIBUTION_ID</span>=<span class="code-value">"your-distribution-id"</span>
                    </div>

                    <h4>macOS Installation Command</h4>
                    <div class="arch-diagram">
<span class="code-comment"># Install the PKG file</span>
<span class="code-command">sudo</span> installer -pkg CortexXDR.pkg -target /

<span class="code-comment"># The distribution ID is embedded in the package</span>
<span class="code-comment"># Verify installation</span>
<span class="code-command">/Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool</span> info
                    </div>

                    <h4>Linux Installation Commands</h4>
                    <div class="arch-diagram">
<span class="code-comment"># RHEL/CentOS (RPM)</span>
<span class="code-command">sudo</span> rpm -ivh cortex-xdr-agent.rpm

<span class="code-comment"># Ubuntu/Debian (DEB)</span>
<span class="code-command">sudo</span> dpkg -i cortex-xdr-agent.deb

<span class="code-comment"># Verify agent status</span>
<span class="code-command">sudo</span> /opt/traps/bin/cytool runtime status
                    </div>
                </div>

                <h3>Method 2: Mass Deployment via SCCM/Intune</h3>
                <div class="config-section">
                    <h4>Microsoft Intune Deployment</h4>
                    <div class="console-path">Intune Admin Center → Apps → Windows → Add → Line-of-business app</div>
                    
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Prepare the MSI Package</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Download MSI from XSIAM console. Note: Intune requires the MSI, not EXE.</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Create App in Intune</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Apps → Windows → Add → Select "Line-of-business app" → Upload MSI</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Configure Command Line Arguments</strong>
                            <div class="arch-diagram" style="margin-top: 8px;">
<span class="code-comment"># Command line arguments field:</span>
<span class="code-param">DISTRIBUTION_ID</span>=<span class="code-value">"your-distribution-id"</span> <span class="code-param">REBOOT</span>=<span class="code-value">ReallySuppress</span>
                            </div>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">4</div>
                        <div>
                            <strong>Assign to Device Groups</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Assignments → Add group → Select "All devices" or specific device groups</p>
                        </div>
                    </div>

                    <h4>SCCM Deployment</h4>
                    <div class="arch-diagram">
<span class="code-comment"># Create Application in SCCM</span>
<span class="code-comment"># Software Library → Applications → Create Application</span>

<span class="code-comment"># Installation Program:</span>
<span class="code-command">msiexec</span> /i CortexXDR_x64.msi /qn DISTRIBUTION_ID=<span class="code-value">"your-id"</span> REBOOT=ReallySuppress

<span class="code-comment"># Detection Method: File exists</span>
Path: C:\Program Files\Palo Alto Networks\Traps
File: cyserver.exe

<span class="code-comment"># Uninstall Program:</span>
<span class="code-command">msiexec</span> /x {Product-GUID} /qn
                    </div>

                    <h4>GPO Deployment</h4>
                    <div class="arch-diagram">
<span class="code-comment"># 1. Copy MSI to network share accessible by all computers</span>
\\server\share\CortexXDR_x64.msi

<span class="code-comment"># 2. Create GPO: Computer Configuration → Policies → Software Settings</span>
<span class="code-comment"># 3. Right-click "Software Installation" → New → Package</span>
<span class="code-comment"># 4. Browse to MSI on network share</span>
<span class="code-comment"># 5. Select "Assigned" deployment method</span>

<span class="code-comment"># For command-line parameters, use MST transform file or startup script instead</span>
                    </div>
                </div>

                <!-- Enterprise Deployment Workflow -->
                <h2><i class="fas fa-rocket"></i> Enterprise Deployment Workflow</h2>
                <p>For large deployments (500+ endpoints), follow this phased approach to minimize risk:</p>

                <div class="flow-diagram">
                    <div class="flow-step">
                        <div class="flow-icon" style="background: #58a6ff;">
                            <i class="fas fa-flask"></i>
                        </div>
                        <div class="flow-content">
                            <strong>Phase 1: Pilot</strong>
                            <p>Deploy to 50-100 diverse endpoints</p>
                            <ul style="font-size: 0.85rem; color: #8b949e; margin: 4px 0;">
                                <li>Mix of workstations and servers</li>
                                <li>Include IT team endpoints for monitoring</li>
                                <li>Run for 1-2 weeks</li>
                            </ul>
                        </div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">
                        <div class="flow-icon" style="background: #3fb950;">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="flow-content">
                            <strong>Phase 2: Validate</strong>
                            <p>Verify telemetry and performance</p>
                            <ul style="font-size: 0.85rem; color: #8b949e; margin: 4px 0;">
                                <li>Check XQL for data quality</li>
                                <li>Monitor CPU/memory impact</li>
                                <li>Tune exclusions if needed</li>
                            </ul>
                        </div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">
                        <div class="flow-icon" style="background: #d29922;">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </div>
                        <div class="flow-content">
                            <strong>Phase 3: Wave 1</strong>
                            <p>Expand to 1,000 endpoints</p>
                            <ul style="font-size: 0.85rem; color: #8b949e; margin: 4px 0;">
                                <li>Deploy by department/OU</li>
                                <li>Monitor rollout dashboard</li>
                                <li>1 week stabilization</li>
                            </ul>
                        </div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">
                        <div class="flow-icon" style="background: #a371f7;">
                            <i class="fas fa-globe"></i>
                        </div>
                        <div class="flow-content">
                            <strong>Phase 4: Full Deployment</strong>
                            <p>Complete enterprise rollout</p>
                            <ul style="font-size: 0.85rem; color: #8b949e; margin: 4px 0;">
                                <li>Deploy remaining 80%</li>
                                <li>Regional waves if global</li>
                                <li>Final coverage verification</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Agent Profiles & Policies -->
                <h2><i class="fas fa-cog"></i> Agent Profiles & Policy Configuration</h2>
                
                <div class="info-box" style="border-color: #d29922;">
                    <h4><i class="fas fa-exclamation-triangle"></i> Understanding Agent Policies</h4>
                    <p>Agent behavior is controlled by <strong>Endpoint Profiles</strong>. Each profile defines what data to collect, what to block, and response capabilities. Profiles are assigned to <strong>Endpoint Groups</strong> based on rules (OS, hostname pattern, AD group, etc.).</p>
                </div>

                <div class="console-path">XSIAM Console → Settings → Endpoints → Policy Management → Profiles</div>

                <h3>Creating an Endpoint Profile</h3>
                <div class="config-section">
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>Navigate to Profiles</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Settings → Endpoints → Policy Management → Profiles → + New Profile</p>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">2</div>
                        <div>
                            <strong>Select Profile Type</strong>
                            <ul style="color: #8b949e; margin: 4px 0; font-size: 0.9rem;">
                                <li><strong>Windows Workstation</strong> - For desktops/laptops</li>
                                <li><strong>Windows Server</strong> - Optimized for server workloads</li>
                                <li><strong>macOS</strong> - Mac endpoints</li>
                                <li><strong>Linux</strong> - Linux servers/workstations</li>
                            </ul>
                        </div>
                    </div>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Configure Profile Settings</strong>
                            <p style="color: #8b949e; margin: 4px 0;">See detailed settings below</p>
                        </div>
                    </div>
                </div>

                <h3>Profile Settings Deep Dive</h3>

                <h4>Malware Protection Settings</h4>
                <div class="config-section">
                    <table class="policy-table">
                        <thead>
                            <tr>
                                <th>Setting</th>
                                <th>Options</th>
                                <th>Recommendation</th>
                                <th>Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Malware Protection</strong></td>
                                <td>Enabled / Disabled</td>
                                <td><span class="toggle-on">Enabled</span></td>
                                <td>Real-time scanning of files</td>
                            </tr>
                            <tr>
                                <td><strong>Malware Protection Action</strong></td>
                                <td>Block and Quarantine / Report Only</td>
                                <td>Block and Quarantine</td>
                                <td>Blocks execution of known malware</td>
                            </tr>
                            <tr>
                                <td><strong>Behavioral Threat Protection</strong></td>
                                <td>Enabled / Disabled</td>
                                <td><span class="toggle-on">Enabled</span></td>
                                <td>Detects suspicious behavior patterns</td>
                            </tr>
                            <tr>
                                <td><strong>Anti-Ransomware</strong></td>
                                <td>Enabled / Disabled</td>
                                <td><span class="toggle-on">Enabled</span></td>
                                <td>Protects against encryption attacks</td>
                            </tr>
                            <tr>
                                <td><strong>Exploit Protection</strong></td>
                                <td>Enabled / Disabled</td>
                                <td><span class="toggle-on">Enabled</span></td>
                                <td>Blocks memory exploitation techniques</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h4>Data Collection Settings (THE KEY PART)</h4>
                <div class="config-section">
                    <div class="console-path">Profile → Data Collection → Extended Data Collection</div>
                    
                    <div class="info-box" style="border-color: #3fb950;">
                        <h4><i class="fas fa-database"></i> This Is Where You Control What Data Gets Sent to XSIAM</h4>
                        <p>The "Extended Data Collection" section determines the telemetry richness. More collection = better detection but more data volume.</p>
                    </div>

                    <table class="policy-table">
                        <thead>
                            <tr>
                                <th>Collection Setting</th>
                                <th>What It Collects</th>
                                <th>Recommendation</th>
                                <th>Volume Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Process Execution</strong></td>
                                <td>All process starts with full command line, parent process, user</td>
                                <td><span class="toggle-on">Always Enable</span></td>
                                <td>High - but essential</td>
                            </tr>
                            <tr>
                                <td><strong>Command Line Logging</strong></td>
                                <td>Full command line arguments for every process</td>
                                <td><span class="toggle-on">Always Enable</span></td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>File Operations</strong></td>
                                <td>File create/modify/delete/rename events</td>
                                <td><span class="toggle-on">Enable</span></td>
                                <td>High</td>
                            </tr>
                            <tr>
                                <td><strong>Network Connections</strong></td>
                                <td>All TCP/UDP connections with process context</td>
                                <td><span class="toggle-on">Enable</span></td>
                                <td>Medium-High</td>
                            </tr>
                            <tr>
                                <td><strong>Registry Operations</strong></td>
                                <td>Registry key changes (Windows only)</td>
                                <td><span class="toggle-on">Enable</span></td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>Module/Image Loads</strong></td>
                                <td>DLL/SO loads by processes</td>
                                <td>Enable for high-security endpoints</td>
                                <td>Very High</td>
                            </tr>
                            <tr>
                                <td><strong>Script Execution</strong></td>
                                <td>PowerShell, VBScript, JScript content</td>
                                <td><span class="toggle-on">Always Enable</span></td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>DNS Queries</strong></td>
                                <td>All DNS lookups from endpoint</td>
                                <td>Enable if no NGFW DNS logging</td>
                                <td>High</td>
                            </tr>
                        </tbody>
                    </table>

                    <div style="margin-top: 16px; padding: 16px; background: #21262d; border-radius: 8px;">
                        <strong style="color: #d29922;">Critical for Detection:</strong>
                        <p style="color: #8b949e; margin: 8px 0 0 0;">Without <strong>Command Line Logging</strong> and <strong>Script Execution</strong> enabled, you will miss most attack techniques. These are essential for detecting encoded PowerShell, living-off-the-land attacks, and lateral movement.</p>
                    </div>
                </div>

                <h4>Response Actions Configuration</h4>
                <div class="config-section">
                    <div class="console-path">Profile → Response Actions</div>
                    
                    <table class="policy-table">
                        <thead>
                            <tr>
                                <th>Capability</th>
                                <th>What It Enables</th>
                                <th>Recommendation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Live Terminal</strong></td>
                                <td>Remote command execution on endpoint</td>
                                <td><span class="toggle-on">Enable</span> (requires approval workflow)</td>
                            </tr>
                            <tr>
                                <td><strong>File Retrieval</strong></td>
                                <td>Download files from endpoint for analysis</td>
                                <td><span class="toggle-on">Enable</span></td>
                            </tr>
                            <tr>
                                <td><strong>Network Isolation</strong></td>
                                <td>Isolate endpoint from network (except XSIAM)</td>
                                <td><span class="toggle-on">Enable</span></td>
                            </tr>
                            <tr>
                                <td><strong>Process Termination</strong></td>
                                <td>Kill running processes remotely</td>
                                <td><span class="toggle-on">Enable</span></td>
                            </tr>
                            <tr>
                                <td><strong>File Quarantine</strong></td>
                                <td>Quarantine malicious files</td>
                                <td><span class="toggle-on">Enable</span></td>
                            </tr>
                            <tr>
                                <td><strong>Script Execution</strong></td>
                                <td>Run remediation scripts remotely</td>
                                <td>Enable with approval</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Assigning Profiles to Endpoints -->
                <h2><i class="fas fa-users-cog"></i> Assigning Profiles to Endpoints</h2>
                
                <div class="config-section">
                    <div class="console-path">Settings → Endpoints → Policy Management → Endpoint Groups</div>
                    
                    <h4>Step 1: Create Endpoint Group</h4>
                    <div class="config-step">
                        <div class="step-num">1</div>
                        <div>
                            <strong>New Endpoint Group</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Endpoint Groups → + New Group → Name: "Windows Workstations"</p>
                        </div>
                    </div>
                    
                    <h4>Step 2: Define Group Rules</h4>
                    <p style="color: #8b949e;">Groups are dynamic - endpoints automatically join based on matching rules:</p>
                    
                    <div class="arch-diagram">
<span class="code-comment"># Example Group Rules:</span>

<span class="code-comment"># All Windows 10/11 workstations</span>
<span class="code-param">os_type</span> = <span class="code-value">"Windows"</span> AND <span class="code-param">os_version</span> contains <span class="code-value">"10"</span>

<span class="code-comment"># Servers by hostname pattern</span>
<span class="code-param">hostname</span> matches <span class="code-value">"SRV-*"</span> OR <span class="code-param">hostname</span> matches <span class="code-value">"*-SERVER"</span>

<span class="code-comment"># By Active Directory OU</span>
<span class="code-param">ad_ou</span> contains <span class="code-value">"OU=Finance"</span>

<span class="code-comment"># By IP range</span>
<span class="code-param">ip_address</span> in_subnet <span class="code-value">"10.50.0.0/16"</span>

<span class="code-comment"># High-security endpoints (executives)</span>
<span class="code-param">ad_groups</span> contains <span class="code-value">"Executive-Laptops"</span>
                    </div>

                    <h4>Step 3: Assign Profile to Group</h4>
                    <div class="config-step">
                        <div class="step-num">3</div>
                        <div>
                            <strong>Link Profile</strong>
                            <p style="color: #8b949e; margin: 4px 0;">Edit Group → Profile Assignment → Select your profile → Save</p>
                            <p style="color: #d29922; margin: 4px 0; font-size: 0.9rem;">Note: Changes propagate to endpoints within 5-15 minutes</p>
                        </div>
                    </div>
                </div>

                <!-- Verifying Data Collection -->
                <h2><i class="fas fa-search"></i> Verifying Data Collection is Working</h2>
                
                <div class="config-section">
                    <h4>Method 1: Check in XSIAM Console</h4>
                    <div class="console-path">Investigation → XQL Search</div>
                    
                    <div class="arch-diagram">
<span class="code-comment">// Verify process events from specific endpoint</span>
<span class="code-command">dataset</span> = xdr_data
| <span class="code-command">filter</span> agent_hostname = <span class="code-value">"WORKSTATION-001"</span>
| <span class="code-command">filter</span> event_type = PROCESS
| <span class="code-command">fields</span> _time, action_process_image_name, action_process_command_line, actor_process_image_name
| <span class="code-command">sort</span> desc _time
| <span class="code-command">limit</span> 100
                    </div>

                    <div class="arch-diagram">
<span class="code-comment">// Check all event types from endpoint in last hour</span>
<span class="code-command">dataset</span> = xdr_data
| <span class="code-command">filter</span> agent_hostname = <span class="code-value">"WORKSTATION-001"</span>
| <span class="code-command">filter</span> _time > ago(1h)
| <span class="code-command">comp</span> count = <span class="code-command">count</span>() by event_type
| <span class="code-command">sort</span> desc count
                    </div>

                    <h4>Expected Output (Healthy Endpoint)</h4>
                    <div class="arch-diagram">
<span class="code-comment">// You should see something like:</span>
event_type          count
----------------------------
PROCESS             847
FILE                1,234
NETWORK             312
REGISTRY            156
LOAD_IMAGE          2,891
AUTH                23
                    </div>

                    <h4>Method 2: Check on Endpoint Locally</h4>
                    <div class="arch-diagram">
<span class="code-comment"># Windows - Check agent status</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> info

<span class="code-comment"># Expected output includes:</span>
<span class="code-comment"># Agent Status: Protected</span>
<span class="code-comment"># Server Connectivity: Connected</span>
<span class="code-comment"># Last Check-in: [recent timestamp]</span>

<span class="code-comment"># Check what's being collected</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> runtime status

<span class="code-comment"># macOS</span>
<span class="code-command">/Library/Application\ Support/PaloAltoNetworks/Traps/bin/cytool</span> info

<span class="code-comment"># Linux</span>
<span class="code-command">sudo</span> /opt/traps/bin/cytool runtime status
                    </div>
                </div>

                <!-- Troubleshooting Decision Tree -->
                <h2><i class="fas fa-bug"></i> Troubleshooting Decision Tree</h2>
                <p>Use this flowchart to diagnose agent issues:</p>

                <div class="decision-tree">
                    <div class="decision-node" style="background: linear-gradient(135deg, #f85149, #da3633);">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>What's the symptom?</span>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #58a6ff;">Agent Not Appearing in Console</div>
                        <div class="decision-node" style="background: #21262d;">
                            <span>Check: cytool info shows "Connected"?</span>
                        </div>
                        <div class="decision-branch" style="margin-left: 40px;">
                            <div class="decision-arrow" style="background: #3fb950;">Yes → Wait 15 min, check Distribution ID</div>
                            <div class="decision-arrow" style="background: #f85149;">No → Check firewall: *.paloaltonetworks.com:443</div>
                        </div>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #d29922;">No Data in XQL</div>
                        <div class="decision-node" style="background: #21262d;">
                            <span>Check: Profile has Data Collection enabled?</span>
                        </div>
                        <div class="decision-branch" style="margin-left: 40px;">
                            <div class="decision-arrow" style="background: #3fb950;">Yes → Force cytool checkin, wait 10 min</div>
                            <div class="decision-arrow" style="background: #f85149;">No → Enable collection in profile, reassign</div>
                        </div>
                    </div>
                    <div class="decision-branch">
                        <div class="decision-arrow" style="background: #a371f7;">High CPU Usage</div>
                        <div class="decision-node" style="background: #21262d;">
                            <span>Check: Application causing scans?</span>
                        </div>
                        <div class="decision-branch" style="margin-left: 40px;">
                            <div class="decision-arrow" style="background: #3fb950;">Yes → Add exclusion in profile</div>
                            <div class="decision-arrow" style="background: #f85149;">No → Disable Module Loads, reduce File ops</div>
                        </div>
                    </div>
                </div>

                <!-- Common Issues Table -->
                <h3>Common Issues Reference</h3>
                <div class="styled-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Issue</th>
                                <th>Symptoms</th>
                                <th>Resolution</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>No data in XSIAM</strong></td>
                                <td>XQL returns no events for endpoint</td>
                                <td>Check agent connectivity: <code>cytool info</code>. Verify endpoint can reach *.paloaltonetworks.com:443</td>
                            </tr>
                            <tr>
                                <td><strong>Missing command lines</strong></td>
                                <td>Process events show but command_line is empty</td>
                                <td>Enable "Command Line Logging" in profile. Check Windows audit policy (Process Creation auditing)</td>
                            </tr>
                            <tr>
                                <td><strong>Missing network events</strong></td>
                                <td>No NETWORK event_type in data</td>
                                <td>Enable "Network Connections" in profile Data Collection settings</td>
                            </tr>
                            <tr>
                                <td><strong>Agent not updating policy</strong></td>
                                <td>Old profile settings still active</td>
                                <td>Force policy refresh: <code>cytool checkin</code> or wait 15 minutes</td>
                            </tr>
                            <tr>
                                <td><strong>High CPU usage</strong></td>
                                <td>Agent consuming >5% CPU constantly</td>
                                <td>Check for scanning exclusion needs. Reduce "Module Loads" collection on busy servers.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Diagnostic Commands</h3>
                <div class="arch-diagram">
<span class="code-comment"># Full diagnostic dump (Windows)</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> diagnostic create

<span class="code-comment"># Check connectivity to XSIAM</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> connectivity test

<span class="code-comment"># Force immediate check-in</span>
<span class="code-command">"C:\Program Files\Palo Alto Networks\Traps\cytool.exe"</span> checkin

<span class="code-comment"># View local agent logs</span>
<span class="code-comment"># Windows: C:\ProgramData\Cyvera\Logs\</span>
<span class="code-comment"># macOS: /Library/Application Support/PaloAltoNetworks/Traps/logs/</span>
<span class="code-comment"># Linux: /var/log/traps/</span>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you deploy Cortex XDR agent to 10,000 Windows endpoints?</button>
                        <div class="qa-answer">
                            <p>For an enterprise deployment at that scale, I'd take a phased approach using existing infrastructure. First, I'd identify the deployment tool - if the organization has Intune or SCCM, those are the obvious choices. If not, we'd look at GPO or a third-party deployment tool.</p>
                            
                            <p>I'd start with a pilot of about 100 endpoints across different departments and endpoint types - some workstations, some laptops, maybe a few servers. This helps catch any compatibility issues early. During pilot, I'd monitor CPU and memory impact, verify telemetry is flowing properly with XQL queries, and check for any application conflicts.</p>
                            
                            <p>For the actual deployment, I'd use Intune's line-of-business app deployment with the MSI package from XSIAM console. The key parameters are DISTRIBUTION_ID (ties the agent to your tenant) and REBOOT=ReallySuppress (prevents unwanted reboots). I'd deploy in waves - maybe 1,000 endpoints per wave, with a day or two between waves to catch any issues.</p>
                            
                            <p>Throughout the rollout, I'd use XSIAM's deployment dashboard to track coverage and identify any endpoints that failed installation. Common issues include network connectivity (endpoints need to reach *.paloaltonetworks.com:443), conflicting security software, or insufficient disk space. For failed deployments, I'd use SCCM's retry mechanism or create a remediation script collection.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you configure the Cortex XDR agent to collect specific data types, and what's your approach to balancing visibility vs. performance?</button>
                        <div class="qa-answer">
                            <p>Data collection is controlled through Endpoint Profiles under Settings → Endpoints → Policy Management. The key section is "Extended Data Collection" where you toggle different telemetry types. My baseline for any workstation includes Process Execution, Command Line Logging, Network Connections, Registry Operations, and Script Execution. These are non-negotiable because without them, you miss most attack techniques.</p>
                            
                            <p>The performance-sensitive settings are Module/Image Loads and DNS Queries. Module loads generate massive volume - we're talking 3-5x more events than process telemetry - because every DLL load creates an event. I typically only enable this for high-security endpoints like executive laptops or jump servers where I want maximum visibility for forensic investigations.</p>
                            
                            <p>For servers, especially busy database or application servers, I'd create a separate "Optimized Server" profile. I'd keep Process and Command Line (critical for detecting lateral movement and privilege escalation), keep Network (for C2 detection), but disable File Operations and Module Loads. The trade-off is reduced ransomware visibility, but servers usually have fewer interactive users so the risk is different.</p>
                            
                            <p>After deploying profiles, I verify with an XQL query that groups event counts by event_type for a sample of endpoints. If I see zero NETWORK events, I know the collection setting didn't apply - either profile isn't assigned correctly or the endpoint hasn't checked in yet. A quick cytool checkin on the endpoint forces a policy refresh.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: An endpoint shows as connected in the console but you're not seeing expected telemetry. Walk me through your troubleshooting process.</button>
                        <div class="qa-answer">
                            <p>First, I'd verify exactly what telemetry is missing versus what's expected. I'd run an XQL query: dataset=xdr_data | filter agent_hostname="HOSTNAME" | comp count() by event_type. This shows me what event types are actually arriving. If I'm seeing PROCESS events but no NETWORK events, that tells me specifically what to investigate.</p>
                            
                            <p>Next, I'd check the profile assignment. In the console, I'd look up the endpoint and see which profile is assigned. Then I'd open that profile and verify the Data Collection settings have the expected telemetry types enabled. A common gotcha is having multiple endpoint groups with overlapping rules - the endpoint might be getting a different profile than expected.</p>
                            
                            <p>If the profile looks correct, I'd check the endpoint locally. On Windows, I'd run "cytool runtime status" to see what the agent thinks its collection settings are. If there's a mismatch between console and local, I'd force a check-in with "cytool checkin" and wait 10-15 minutes. Sometimes policies just haven't propagated yet.</p>
                            
                            <p>For more stubborn issues, I'd check the local agent logs in C:\ProgramData\Cyvera\Logs\. Look for any errors related to data upload or policy parsing. If the endpoint is behind a proxy, verify the proxy settings are configured correctly - some proxies block the large volume of telemetry data even though connectivity checks pass.</p>
                            
                            <p>One specific scenario I've seen: command lines are missing. This is usually because Windows itself isn't configured to audit command line arguments. You need either a GPO or local policy setting to enable "Include command line in process creation events" under Audit Policy. The Cortex agent can only collect what Windows provides.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle Cortex XDR agent exclusions, and what's your philosophy on when to add them?</button>
                        <div class="qa-answer">
                            <p>Exclusions are a double-edged sword. Every exclusion is a potential blind spot, so I approach them with healthy skepticism. My philosophy is: prove the exclusion is necessary, document why it's needed, review them periodically, and scope them as narrowly as possible.</p>
                            
                            <p>The most common legitimate need for exclusions is performance impact from scanning conflicts. If you have another security tool like AV doing real-time scanning, and Cortex is also scanning the same files, you get double scanning overhead. In this case, I'd exclude the other tool's working directories from Cortex scanning, and vice versa.</p>
                            
                            <p>For applications that generate tons of file I/O - like databases, dev environments, or backup software - I'd first try the "Optimized Server" profile approach of disabling file telemetry entirely. If that's not acceptable because the endpoint still needs file monitoring, then I'd add path-based exclusions just for those specific application directories.</p>
                            
                            <p>When adding exclusions, I always scope them narrowly. Instead of excluding "C:\Program Files\*", I'd exclude "C:\Program Files\SpecificApp\Cache\*". I document each exclusion in our security runbook with the reason, who requested it, and a review date. Every quarter, I audit exclusions to see if they're still needed.</p>
                            
                            <p>One thing I never do is exclude based on process name alone without a path. Excluding "backup.exe" would let any malware named "backup.exe" run undetected. Always combine process name with a full path exclusion.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does the Cortex XDR agent compare to other EDR agents you've worked with, and what are its strengths and weaknesses?</button>
                        <div class="qa-answer">
                            <p>I've worked with CrowdStrike Falcon, Microsoft Defender for Endpoint, and Carbon Black in addition to Cortex XDR. Each has its strengths. Cortex's biggest advantage is the native integration with XSIAM - the telemetry flows directly into the SIEM/SOAR without any integration work. With other EDRs, you're typically shipping data to a separate SIEM and dealing with format differences, delays, and additional licensing.</p>
                            
                            <p>Cortex's behavioral threat protection is solid, comparable to CrowdStrike and MDE. Where it really shines is the response capabilities when combined with XSOAR. You can build automated playbooks that take response actions across endpoints without switching tools. Isolate an endpoint, retrieve files, run scripts - all orchestrated automatically.</p>
                            
                            <p>One weakness I've noticed is the initial deployment can be more complex than CrowdStrike. CrowdStrike's sensor is more "drop it in and it works" - Cortex requires more thought about profiles and groups upfront. That's not necessarily bad - it gives you more control - but it means more initial configuration work.</p>
                            
                            <p>Performance-wise, Cortex is reasonable but not the lightest. On older hardware or very busy servers, I've had to tune down collection settings more than I would with CrowdStrike. The module load telemetry in particular is heavier than equivalent CrowdStrike data.</p>
                            
                            <p>The console UI is decent but can feel slower than CrowdStrike's for quick investigations. However, once you learn XQL, the querying capabilities are actually more powerful than CrowdStrike's Spotlight or MDE's KQL - especially for complex multi-stage attack hunting.</p>
                        </div>
                    </div>

                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What response actions are available through the Cortex XDR agent, and how do you decide when to use each one?</button>
                        <div class="qa-answer">
                            <p>The Cortex agent supports several response actions: Network Isolation, Process Termination, File Quarantine, File Retrieval, Live Terminal, and Script Execution. Each has specific use cases and risk levels.</p>
                            
                            <p>Network Isolation is my go-to for confirmed compromises. It cuts the endpoint off from everything except the XSIAM cloud connection, stopping lateral movement and C2 communication immediately. I use this when I have high confidence of active compromise - like confirmed ransomware execution or active C2 beacon. The user loses network access, so there's business impact, but it's the fastest containment option.</p>
                            
                            <p>Process Termination is for surgical strikes - kill a specific malicious process without disrupting the whole endpoint. I use this for cryptominers, persistent malware, or attacker tools that I've identified. It's lower impact than isolation since the user can keep working, but the attacker might have other persistence mechanisms I haven't found yet.</p>
                            
                            <p>File Quarantine moves a malicious file to a secure vault on the endpoint. Good for malware that hasn't executed yet, or for cleaning up after you've terminated the process. I always quarantine rather than delete because you might need the file for forensics later.</p>
                            
                            <p>File Retrieval downloads suspicious files for analysis. I use this before taking any destructive action - grab the malware sample, any dropped files, relevant logs. This feeds your threat intel and helps understand the full scope of compromise.</p>
                            
                            <p>Live Terminal and Script Execution are the most powerful but riskiest. They give you full remote shell access. I use these for complex remediation - clearing persistence mechanisms, checking for additional compromise, running forensic tools. These require approval workflows in my environments because the potential for mistakes is high.</p>
                        </div>
                    </div>
                </div>

                
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>
