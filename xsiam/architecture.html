<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSIAM Architecture | SOC Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .config-section { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .console-path { background: #0d1117; padding: 8px 12px; border-radius: 4px; font-family: monospace; font-size: 0.85rem; color: #f97316; margin: 8px 0; display: inline-block; }
        .code-block { background: #0d1117; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 12px 0; font-family: 'Fira Code', monospace; font-size: 0.85rem; overflow-x: auto; white-space: pre; }
        .arch-diagram { background: #0d1117; padding: 24px; border-radius: 8px; font-family: monospace; font-size: 0.85rem; line-height: 1.4; }
        .component-card { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; border-left: 4px solid #f97316; }
        .feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 24px 0; }
        .feature-card { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; }
        .tier-badge { display: inline-block; padding: 4px 12px; border-radius: 4px; font-size: 0.8rem; font-weight: 600; margin-right: 8px; }
        .tier-hot { background: #f85149; color: white; }
        .tier-warm { background: #d29922; color: #0d1117; }
        .tier-cold { background: #58a6ff; color: white; }
    </style>
</head>
<body>
    <div class="app-container">
                                                                                                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">XSIAM Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link active"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="comparison.html" class="nav-link"><i class="fas fa-balance-scale"></i> vs Competitors</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Ingestion Methods</a>
                    <a href="custom-log-onboarding.html" class="nav-link"><i class="fas fa-file-import"></i> Custom Log Onboarding</a>
                    <a href="broker-vm.html" class="nav-link"><i class="fas fa-server"></i> Broker VM</a>
                    <a href="agents.html" class="nav-link"><i class="fas fa-desktop"></i> Cortex Agents</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & XDM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">XQL Query Language</div>
                    <a href="xql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> XQL Fundamentals</a>
                    <a href="xql-advanced.html" class="nav-link"><i class="fas fa-code"></i> XQL Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="correlation-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> Correlation Rules</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intelligence</a>
                    <a href="xsoar-automation.html" class="nav-link"><i class="fas fa-robot"></i> XSOAR Automation</a>
                    <a href="xdr-overview.html" class="nav-link"><i class="fas fa-crosshairs"></i> XDR Capabilities</a>
                    <a href="recon-asm.html" class="nav-link"><i class="fas fa-globe"></i> ASM / Xpanse</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Retention & Storage</a>
                    <a href="marketplace.html" class="nav-link"><i class="fas fa-store"></i> Marketplace</a>
                    <a href="enterprise-soc.html" class="nav-link"><i class="fas fa-building"></i> Enterprise SOC</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">XSIAM</a><span class="separator">/</span>
                    <span class="current">Architecture</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-sitemap"></i> XSIAM Architecture</h1>
                <p class="lead">Deep dive into Palo Alto Networks XSIAM architecture. Understand how data flows from collection through analysis, storage, and response.</p>

                <!-- Architecture Overview -->
                <h2><i class="fas fa-layer-group"></i> Architecture Overview</h2>
                <div class="config-section">
                    <p>XSIAM is a cloud-native platform that converges SIEM, SOAR, ASM, and XDR capabilities into a unified architecture. The platform is built on Palo Alto Networks' Cortex Data Lake infrastructure.</p>
                    
                    <div class="arch-diagram">
<span style="color: #8b949e;">┌─────────────────────────────────────────────────────────────────────────────────────┐</span>
<span style="color: #8b949e;">│</span>                              <span style="color: #f97316; font-weight: bold;">DATA SOURCES</span>                                         <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │ Endpoints│ │ Network  │ │  Cloud   │ │   IAM    │ │   Apps   │ │ Third    │    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │ (XDR)    │ │ (NGFW)   │ │ (Prisma) │ │ (Okta)   │ │ (O365)   │ │ Party    │    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  └────┬─────┘ └────┬─────┘ └────┬─────┘ └────┬─────┘ └────┬─────┘ └────┬─────┘    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">└───────┼────────────┼────────────┼────────────┼────────────┼────────────┼──────────┘</span>
        │            │            │            │            │            │
        ▼            ▼            ▼            ▼            ▼            ▼
<span style="color: #8b949e;">┌─────────────────────────────────────────────────────────────────────────────────────┐</span>
<span style="color: #8b949e;">│</span>                            <span style="color: #d29922; font-weight: bold;">COLLECTION LAYER</span>                                       <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  ┌───────────────────┐  ┌───────────────────┐  ┌───────────────────────────────┐  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │   Cortex Agents   │  │    Broker VM      │  │      Cloud Collectors         │  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │   (Endpoints)     │  │  (Syslog/HTTP)    │  │   (API/Native Integration)    │  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  └─────────┬─────────┘  └─────────┬─────────┘  └───────────────┬───────────────┘  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">└─────────────┼────────────────────────┼──────────────────────────┼───────────────────┘</span>
              │                        │                          │
              ▼                        ▼                          ▼
<span style="color: #8b949e;">┌─────────────────────────────────────────────────────────────────────────────────────┐</span>
<span style="color: #8b949e;">│</span>                          <span style="color: #3fb950; font-weight: bold;">CORTEX DATA LAKE</span>                                        <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  ┌─────────────────────────────────────────────────────────────────────────────┐  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │                         INGESTION PIPELINE                                  │  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │   Parsing → Normalization (XDM) → Enrichment → Indexing → Storage          │  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  └─────────────────────────────────────────────────────────────────────────────┘  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>                                                                                     <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │  <span class="tier-hot">HOT</span> (7 days)  │  │ <span class="tier-warm">WARM</span> (30 days) │  │ <span class="tier-cold">COLD</span> (Archive) │                    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │  Fast queries   │  │ Standard query  │  │ On-demand load  │                    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  └─────────────────┘  └─────────────────┘  └─────────────────┘                    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">└─────────────────────────────────────────────────────────────────────────────────────┘</span>
                                        │
                                        ▼
<span style="color: #8b949e;">┌─────────────────────────────────────────────────────────────────────────────────────┐</span>
<span style="color: #8b949e;">│</span>                           <span style="color: #58a6ff; font-weight: bold;">ANALYTICS ENGINE</span>                                        <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌──────────────┐  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │  Correlation    │  │   ML/AI         │  │   UEBA          │  │  Threat      │  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │  Rules Engine   │  │   Detection     │  │   Analytics     │  │  Intel       │  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  └─────────────────┘  └─────────────────┘  └─────────────────┘  └──────────────┘  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">└─────────────────────────────────────────────────────────────────────────────────────┘</span>
                                        │
                                        ▼
<span style="color: #8b949e;">┌─────────────────────────────────────────────────────────────────────────────────────┐</span>
<span style="color: #8b949e;">│</span>                         <span style="color: #a371f7; font-weight: bold;">RESPONSE & AUTOMATION</span>                                    <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌──────────────┐  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │  Incident       │  │   XSOAR         │  │   Playbooks     │  │  Response    │  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  │  Management     │  │   Automation    │  │   & Workflows   │  │  Actions     │  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">│</span>  └─────────────────┘  └─────────────────┘  └─────────────────┘  └──────────────┘  <span style="color: #8b949e;">│</span>
<span style="color: #8b949e;">└─────────────────────────────────────────────────────────────────────────────────────┘</span>
                    </div>
                </div>

                <!-- Data Collection Layer -->
                <h2><i class="fas fa-download"></i> Data Collection Layer</h2>
                
                <div class="component-card">
                    <h3><i class="fas fa-laptop" style="color: #f97316;"></i> Cortex XDR Agents</h3>
                    <p>Lightweight agents installed on endpoints that provide:</p>
                    <ul style="color: #8b949e;">
                        <li><strong>Process Telemetry:</strong> Process creation, command lines, parent/child relationships</li>
                        <li><strong>Network Activity:</strong> Connections, DNS queries, data transfers</li>
                        <li><strong>File Operations:</strong> File creation, modification, deletion, hashes</li>
                        <li><strong>Registry Changes:</strong> Registry key modifications (Windows)</li>
                        <li><strong>User Activity:</strong> Logon events, privilege escalation</li>
                        <li><strong>Prevention:</strong> Malware blocking, exploit prevention, behavioral protection</li>
                    </ul>
                    <table class="styled-table" style="margin-top: 16px;">
                        <thead>
                            <tr><th>Platform</th><th>Agent Type</th><th>Data Rate</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Windows</td><td>Full agent</td><td>~50-200 MB/day/endpoint</td></tr>
                            <tr><td>macOS</td><td>Full agent</td><td>~30-100 MB/day/endpoint</td></tr>
                            <tr><td>Linux</td><td>Full agent</td><td>~20-80 MB/day/endpoint</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="component-card">
                    <h3><i class="fas fa-server" style="color: #f97316;"></i> Broker VM</h3>
                    <p>On-premises virtual machine that collects logs from sources that cannot send directly to cloud:</p>
                    <ul style="color: #8b949e;">
                        <li><strong>Syslog Collection:</strong> UDP/TCP syslog on configurable ports</li>
                        <li><strong>HTTP Collection:</strong> REST API endpoint for log submission</li>
                        <li><strong>Filebeat Integration:</strong> Collect from file-based sources</li>
                        <li><strong>Kafka Consumer:</strong> Stream from Kafka topics</li>
                    </ul>
                    <div class="code-block"># Broker VM Sizing Guidelines
Small:   4 vCPU, 16 GB RAM  → Up to 5 GB/day
Medium:  8 vCPU, 32 GB RAM  → Up to 50 GB/day
Large:  16 vCPU, 64 GB RAM  → Up to 200 GB/day
XLarge: 32 vCPU, 128 GB RAM → Up to 500 GB/day</div>
                </div>

                <div class="component-card">
                    <h3><i class="fas fa-cloud" style="color: #f97316;"></i> Cloud Collectors</h3>
                    <p>Native integrations for cloud and SaaS data sources:</p>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Category</th><th>Sources</th><th>Method</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Cloud Infrastructure</td><td>AWS, Azure, GCP</td><td>API polling, Event streaming</td></tr>
                            <tr><td>Identity</td><td>Okta, Azure AD, Ping</td><td>API polling</td></tr>
                            <tr><td>Productivity</td><td>O365, Google Workspace</td><td>API polling</td></tr>
                            <tr><td>Security Tools</td><td>CrowdStrike, Proofpoint</td><td>API polling</td></tr>
                            <tr><td>Network</td><td>Palo Alto NGFW, Prisma</td><td>Native streaming</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Cortex Data Lake -->
                <h2><i class="fas fa-database"></i> Cortex Data Lake</h2>
                <div class="config-section">
                    <p>The Cortex Data Lake is the central storage and processing engine for all XSIAM data.</p>
                    
                    <h4>Ingestion Pipeline</h4>
                    <ol style="color: #8b949e;">
                        <li><strong>Parsing:</strong> Raw logs are parsed according to vendor-specific parsers</li>
                        <li><strong>Normalization:</strong> Fields are mapped to XDM (Experience Data Model) schema</li>
                        <li><strong>Enrichment:</strong> Threat intel, geo-IP, asset context added</li>
                        <li><strong>Indexing:</strong> Data indexed for fast XQL queries</li>
                        <li><strong>Storage:</strong> Data stored in appropriate tier based on age</li>
                    </ol>

                    <h4>XDM (Experience Data Model)</h4>
                    <p style="color: #8b949e;">XDM is the normalized schema used across all XSIAM data. Key benefits:</p>
                    <ul style="color: #8b949e;">
                        <li>Consistent field names across all data sources</li>
                        <li>Write one query, search all sources</li>
                        <li>Built-in correlation capabilities</li>
                        <li>Simplified detection rule creation</li>
                    </ul>

                    <div class="code-block"># XDM Field Examples
xdm.source.host.hostname     # Source hostname (normalized)
xdm.target.host.hostname     # Target hostname
xdm.source.user.username     # Source user
xdm.network.ip_protocol      # Network protocol
xdm.event.type               # Event type classification
xdm.event.outcome            # Success/failure
xdm.alert.severity           # Alert severity level</div>
                </div>

                <!-- Storage Tiers -->
                <h2><i class="fas fa-layer-group"></i> Storage Tiers</h2>
                <div class="config-section">
                    <div class="feature-grid">
                        <div class="feature-card" style="border-left: 4px solid #f85149;">
                            <h4><span class="tier-badge tier-hot">HOT</span> Online Storage</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem;">
                                <li><strong>Duration:</strong> 7 days default (configurable)</li>
                                <li><strong>Query Speed:</strong> Milliseconds to seconds</li>
                                <li><strong>Use Case:</strong> Active investigation, real-time detection</li>
                                <li><strong>Cost:</strong> Highest per GB</li>
                            </ul>
                        </div>
                        <div class="feature-card" style="border-left: 4px solid #d29922;">
                            <h4><span class="tier-badge tier-warm">WARM</span> Nearline Storage</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem;">
                                <li><strong>Duration:</strong> 30 days default</li>
                                <li><strong>Query Speed:</strong> Seconds to minutes</li>
                                <li><strong>Use Case:</strong> Historical analysis, threat hunting</li>
                                <li><strong>Cost:</strong> Medium per GB</li>
                            </ul>
                        </div>
                        <div class="feature-card" style="border-left: 4px solid #58a6ff;">
                            <h4><span class="tier-badge tier-cold">COLD</span> Archive Storage</h4>
                            <ul style="color: #8b949e; font-size: 0.9rem;">
                                <li><strong>Duration:</strong> Up to 7+ years</li>
                                <li><strong>Query Speed:</strong> Minutes to hours (requires restore)</li>
                                <li><strong>Use Case:</strong> Compliance, forensics, legal hold</li>
                                <li><strong>Cost:</strong> Lowest per GB</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Analytics Engine -->
                <h2><i class="fas fa-brain"></i> Analytics Engine</h2>
                <div class="config-section">
                    <h4>Detection Capabilities</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Engine</th><th>Description</th><th>Use Cases</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Correlation Rules</strong></td>
                                <td>XQL-based detection rules with scheduling</td>
                                <td>Known attack patterns, IOC matching</td>
                            </tr>
                            <tr>
                                <td><strong>BIOC (Behavioral IOC)</strong></td>
                                <td>Real-time behavioral detection from agents</td>
                                <td>Process chains, LOLBins, lateral movement</td>
                            </tr>
                            <tr>
                                <td><strong>ML Analytics</strong></td>
                                <td>Machine learning anomaly detection</td>
                                <td>Unusual behavior, insider threats</td>
                            </tr>
                            <tr>
                                <td><strong>UEBA</strong></td>
                                <td>User and entity behavior analytics</td>
                                <td>Compromised accounts, privilege abuse</td>
                            </tr>
                            <tr>
                                <td><strong>Threat Intel</strong></td>
                                <td>IOC matching against threat feeds</td>
                                <td>Known malicious IPs, domains, hashes</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Alert Aggregation</h4>
                    <p style="color: #8b949e;">XSIAM automatically groups related alerts into incidents:</p>
                    <ul style="color: #8b949e;">
                        <li><strong>Causality Chain:</strong> Alerts linked by process ancestry</li>
                        <li><strong>Entity Correlation:</strong> Alerts sharing same user/host/IP</li>
                        <li><strong>Time Window:</strong> Alerts within configurable time frame</li>
                        <li><strong>MITRE Mapping:</strong> Alerts mapped to ATT&CK tactics/techniques</li>
                    </ul>
                </div>

                <!-- Response Layer -->
                <h2><i class="fas fa-bolt"></i> Response & Automation Layer</h2>
                <div class="config-section">
                    <h4>XSOAR Integration</h4>
                    <p style="color: #8b949e;">Built-in SOAR capabilities for automated response:</p>
                    <ul style="color: #8b949e;">
                        <li><strong>Playbooks:</strong> Visual workflow automation</li>
                        <li><strong>Integrations:</strong> 900+ pre-built integrations</li>
                        <li><strong>War Room:</strong> Collaborative incident investigation</li>
                        <li><strong>Case Management:</strong> Full incident lifecycle tracking</li>
                    </ul>

                    <h4>Response Actions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Category</th><th>Actions</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Endpoint</td><td>Isolate host, Kill process, Quarantine file, Run script</td></tr>
                            <tr><td>Network</td><td>Block IP/domain (via NGFW), Update EDL</td></tr>
                            <tr><td>Identity</td><td>Disable user, Force password reset, Revoke sessions</td></tr>
                            <tr><td>Enrichment</td><td>VirusTotal, WhoIs, GeoIP, Asset lookup</td></tr>
                            <tr><td>Notification</td><td>Email, Slack, Teams, PagerDuty, ServiceNow</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Multi-Tenancy -->
                <h2><i class="fas fa-building"></i> Multi-Tenancy & RBAC</h2>
                <div class="config-section">
                    <h4>Tenant Architecture</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Single Tenant:</strong> Standard deployment for single organization</li>
                        <li><strong>Multi-Tenant (MSSP):</strong> Separate tenant per customer with central management</li>
                        <li><strong>Data Isolation:</strong> Complete data separation between tenants</li>
                    </ul>

                    <h4>RBAC Model</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Role</th><th>Permissions</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Instance Administrator</td><td>Full platform configuration</td></tr>
                            <tr><td>Security Admin</td><td>Manage detection rules, playbooks</td></tr>
                            <tr><td>Analyst</td><td>Investigate incidents, run queries</td></tr>
                            <tr><td>Responder</td><td>Execute response actions</td></tr>
                            <tr><td>Viewer</td><td>Read-only dashboard access</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- High Availability -->
                <h2><i class="fas fa-shield-alt"></i> High Availability & DR</h2>
                <div class="config-section">
                    <h4>Cloud-Native Resilience</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Multi-Region:</strong> Data replicated across availability zones</li>
                        <li><strong>Auto-Scaling:</strong> Automatic scaling based on ingestion volume</li>
                        <li><strong>99.9% SLA:</strong> Platform availability guarantee</li>
                        <li><strong>Geo-Redundancy:</strong> Optional cross-region replication</li>
                    </ul>

                    <h4>Broker VM HA</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Active-Active:</strong> Multiple brokers with load balancing</li>
                        <li><strong>Failover:</strong> Automatic failover if primary fails</li>
                        <li><strong>Clustering:</strong> Broker clusters for high-volume environments</li>
                    </ul>
                </div>

                <!-- Network Requirements -->
                <h2><i class="fas fa-network-wired"></i> Network Requirements</h2>
                <div class="config-section">
                    <h4>Outbound Connectivity</h4>
                    <div class="code-block"># Required outbound destinations
*.xdr.us.paloaltonetworks.com     TCP/443    # US region
*.xdr.eu.paloaltonetworks.com     TCP/443    # EU region
*.xdr.sg.paloaltonetworks.com     TCP/443    # APAC region

# Agent communication
distributions.traps.paloaltonetworks.com    TCP/443
updates.xdr.paloaltonetworks.com            TCP/443

# Broker VM
*.cortex-gateway.paloaltonetworks.com       TCP/443</div>

                    <h4>Bandwidth Estimation</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Source Type</th><th>Typical Volume</th><th>Peak Factor</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Endpoint (per 1000)</td><td>50-200 GB/day</td><td>2x during incidents</td></tr>
                            <tr><td>NGFW (per device)</td><td>1-50 GB/day</td><td>Depends on traffic</td></tr>
                            <tr><td>Cloud (per account)</td><td>5-50 GB/day</td><td>Varies by activity</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Console Paths -->
                <h2><i class="fas fa-map-signs"></i> Key Console Paths</h2>
                <div class="config-section">
                    <table class="styled-table">
                        <thead>
                            <tr><th>Task</th><th>Path</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>View Architecture Status</td><td><span class="console-path">Settings → Configurations → General</span></td></tr>
                            <tr><td>Manage Data Sources</td><td><span class="console-path">Settings → Configurations → Data Sources</span></td></tr>
                            <tr><td>Configure Broker VM</td><td><span class="console-path">Settings → Configurations → Data Brokers</span></td></tr>
                            <tr><td>View Storage Usage</td><td><span class="console-path">Settings → Configurations → Data Management</span></td></tr>
                            <tr><td>Manage RBAC</td><td><span class="console-path">Settings → Access Management → Roles</span></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Interview Q&A -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Describe the XSIAM architecture and data flow.</button>
                        <div class="qa-answer">
                            <p><strong>XSIAM has four main layers:</strong></p>
                            <ol>
                                <li><strong>Collection Layer:</strong> Cortex agents on endpoints, Broker VMs for syslog/network devices, cloud collectors for SaaS/cloud APIs</li>
                                <li><strong>Cortex Data Lake:</strong> Central storage with ingestion pipeline (parsing → XDM normalization → enrichment → indexing). Three storage tiers: Hot (7d), Warm (30d), Cold (archive)</li>
                                <li><strong>Analytics Engine:</strong> Correlation rules, BIOC, ML analytics, UEBA, threat intelligence matching</li>
                                <li><strong>Response Layer:</strong> XSOAR automation, playbooks, response actions across endpoints/network/identity</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is XDM and why is it important?</button>
                        <div class="qa-answer">
                            <p><strong>XDM (Experience Data Model)</strong> is XSIAM's normalized schema:</p>
                            <ul>
                                <li>Provides consistent field names across all data sources</li>
                                <li>Enables "write once, search everywhere" queries</li>
                                <li>Simplifies correlation rule creation</li>
                                <li>Reduces analyst learning curve (one schema vs many)</li>
                            </ul>
                            <p><strong>Example:</strong> <code>xdm.source.user.username</code> works whether the source is Windows events, AWS CloudTrail, or Okta logs.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How does XSIAM differ from traditional SIEM architecture?</button>
                        <div class="qa-answer">
                            <p><strong>Key differences:</strong></p>
                            <ul>
                                <li><strong>Cloud-Native:</strong> No on-prem infrastructure to manage (except Broker VM)</li>
                                <li><strong>Converged Platform:</strong> SIEM + SOAR + XDR + ASM in one platform</li>
                                <li><strong>Native XDR:</strong> Endpoint agents provide rich telemetry and response</li>
                                <li><strong>Built-in Automation:</strong> XSOAR included, not separate</li>
                                <li><strong>Schema-First:</strong> XDM normalization at ingestion, not query time</li>
                                <li><strong>Tiered Storage:</strong> Automatic data lifecycle management</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>

                <!-- Data Flow Details -->
                <h2><i class="fas fa-stream"></i> Detailed Data Flow</h2>
                <div class="config-section">
                    <h4>Step 1: Data Collection</h4>
                    <p style="color: #8b949e;">Data enters XSIAM through multiple collection methods:</p>
                    <div class="code-block"># Collection Methods by Source Type

ENDPOINTS
├── Cortex XDR Agent
│   ├── Streams: Process, Network, File, Registry, User
│   ├── Protocol: HTTPS to Cortex Cloud
│   └── Compression: LZ4 compressed batches

NETWORK DEVICES  
├── Broker VM (Syslog)
│   ├── UDP/TCP: Port 514 (standard) or custom
│   ├── TLS: Encrypted syslog supported
│   └── Buffer: Local disk queue for reliability
├── NGFW (Native)
│   ├── Log Forwarding Profile → Cortex Data Lake
│   └── Enhanced App Logging for full visibility

CLOUD SOURCES
├── API Polling
│   ├── Interval: 1-15 minutes configurable
│   ├── Auth: OAuth2, API Key, or Service Account
│   └── Pagination: Automatic handling
├── Event Streaming (where supported)
│   ├── Real-time: AWS EventBridge, Azure Event Hub
│   └── Latency: Seconds vs minutes for polling</div>

                    <h4>Step 2: Ingestion Pipeline</h4>
                    <div class="code-block"># Ingestion Pipeline Stages

STAGE 1: PARSING
├── Vendor-specific parsers extract fields
├── Timestamp normalization to UTC
├── Character encoding handling
└── Multi-line event assembly

STAGE 2: XDM MAPPING
├── Raw fields → XDM schema fields
├── Standard field naming (xdm.source.*, xdm.target.*)
├── Data type conversion
└── Array/nested field handling

STAGE 3: ENRICHMENT
├── Threat Intelligence matching
│   ├── IP reputation
│   ├── Domain reputation  
│   ├── File hash lookup
│   └── URL categorization
├── Geo-IP lookup
├── Asset context (from asset inventory)
└── User context (from identity sources)

STAGE 4: INDEXING
├── Full-text indexing for search
├── Time-series indexing for analytics
├── Field-level indexing for filters
└── Bloom filters for fast negative lookups

STAGE 5: STORAGE
├── Write to Hot tier (SSD-backed)
├── Automatic compression
├── Replication for durability
└── Metadata catalog update</div>

                    <h4>Step 3: Query Processing</h4>
                    <div class="code-block"># XQL Query Execution

QUERY: dataset = xdr_data | filter ... | comp ...

1. QUERY PARSING
   └── XQL → Abstract Syntax Tree (AST)

2. QUERY OPTIMIZATION
   ├── Predicate pushdown (filters to storage)
   ├── Column pruning (only needed fields)
   ├── Time range partitioning
   └── Index selection

3. DISTRIBUTED EXECUTION
   ├── Query coordinator receives request
   ├── Fan-out to storage nodes
   ├── Parallel processing
   └── Result aggregation

4. RESULT DELIVERY
   ├── Streaming results to UI
   ├── Pagination for large results
   └── Export for downloads</div>
                </div>

                <!-- Scaling Considerations -->
                <h2><i class="fas fa-expand-arrows-alt"></i> Scaling Considerations</h2>
                <div class="config-section">
                    <h4>Ingestion Scaling</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Tier</th><th>Daily Ingestion</th><th>Endpoints</th><th>Broker VMs</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Small</td><td>Up to 100 GB</td><td>Up to 5,000</td><td>1-2 Small</td></tr>
                            <tr><td>Medium</td><td>100 GB - 500 GB</td><td>5,000 - 25,000</td><td>2-4 Medium</td></tr>
                            <tr><td>Large</td><td>500 GB - 2 TB</td><td>25,000 - 100,000</td><td>4-8 Large</td></tr>
                            <tr><td>Enterprise</td><td>2 TB - 10 TB</td><td>100,000+</td><td>8+ XLarge</td></tr>
                        </tbody>
                    </table>

                    <h4>Query Performance Factors</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Time Range:</strong> Shorter ranges = faster queries</li>
                        <li><strong>Data Volume:</strong> More data scanned = longer queries</li>
                        <li><strong>Filter Selectivity:</strong> More specific filters = faster queries</li>
                        <li><strong>Aggregation Complexity:</strong> Simple stats faster than complex analytics</li>
                        <li><strong>Storage Tier:</strong> Hot fastest, Cold requires restore</li>
                    </ul>

                    <h4>Best Practices for Scale</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Data Source Planning:</strong> Prioritize high-value sources, filter verbose logs</li>
                        <li><strong>Parsing Rules:</strong> Custom parsers for non-standard formats</li>
                        <li><strong>Retention Policies:</strong> Match retention to compliance requirements</li>
                        <li><strong>Query Optimization:</strong> Use time filters, limit result sets</li>
                        <li><strong>Broker Placement:</strong> Place brokers near data sources</li>
                    </ul>
                </div>

                <!-- Integration Points -->
                <h2><i class="fas fa-plug"></i> Integration Points</h2>
                <div class="config-section">
                    <h4>API Capabilities</h4>
                    <div class="code-block"># XSIAM API Categories

PUBLIC API
├── /incidents      - Incident CRUD operations
├── /alerts         - Alert management
├── /endpoints      - Endpoint operations
├── /xql            - Run XQL queries
├── /distributions  - Agent package management
└── /audit-logs     - Platform audit trail

INTEGRATION API
├── /push           - Push external alerts
├── /enrichment     - Custom enrichment lookup
└── /webhook        - Outbound notifications

XSOAR API
├── /playbooks      - Playbook execution
├── /integrations   - Integration configuration
├── /war-room       - Incident collaboration
└── /indicators     - IOC management</div>

                    <h4>Common Integration Patterns</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Use Case</th><th>Integration</th><th>Direction</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Ticketing</td><td>ServiceNow, Jira</td><td>Bidirectional</td></tr>
                            <tr><td>CMDB</td><td>ServiceNow CMDB, Device42</td><td>Inbound</td></tr>
                            <tr><td>Threat Intel</td><td>MISP, ThreatConnect, Recorded Future</td><td>Inbound</td></tr>
                            <tr><td>Identity</td><td>Active Directory, Okta, Azure AD</td><td>Inbound</td></tr>
                            <tr><td>Vulnerability</td><td>Qualys, Tenable, Rapid7</td><td>Inbound</td></tr>
                            <tr><td>Communication</td><td>Slack, Teams, PagerDuty</td><td>Outbound</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Compliance & Data Residency -->
                <h2><i class="fas fa-balance-scale"></i> Compliance & Data Residency</h2>
                <div class="config-section">
                    <h4>Data Residency Options</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Region</th><th>Data Center Location</th><th>Compliance</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Americas</td><td>US (multiple AZs)</td><td>FedRAMP, SOC2, HIPAA</td></tr>
                            <tr><td>Europe</td><td>EU (Germany, UK options)</td><td>GDPR, SOC2</td></tr>
                            <tr><td>Asia Pacific</td><td>Singapore, Japan, Australia</td><td>SOC2, regional</td></tr>
                        </tbody>
                    </table>

                    <h4>Compliance Certifications</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>SOC 2 Type II:</strong> Security, availability, confidentiality</li>
                        <li><strong>ISO 27001:</strong> Information security management</li>
                        <li><strong>GDPR:</strong> EU data protection compliance</li>
                        <li><strong>FedRAMP:</strong> US government cloud security (select regions)</li>
                        <li><strong>HIPAA:</strong> Healthcare data compliance (BAA available)</li>
                    </ul>

                    <h4>Data Handling</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Encryption at Rest:</strong> AES-256 for all stored data</li>
                        <li><strong>Encryption in Transit:</strong> TLS 1.2+ for all connections</li>
                        <li><strong>Key Management:</strong> Customer-managed keys optional</li>
                        <li><strong>Data Deletion:</strong> Cryptographic deletion when expired</li>
                    </ul>
                </div>

                <!-- Troubleshooting Architecture Issues -->
                <h2><i class="fas fa-wrench"></i> Architecture Troubleshooting</h2>
                <div class="config-section">
                    <h4>Common Issues</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Symptom</th><th>Possible Cause</th><th>Resolution</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Data not appearing</td>
                                <td>Collection issue</td>
                                <td>Check agent/broker connectivity, verify data source config</td>
                            </tr>
                            <tr>
                                <td>Slow queries</td>
                                <td>Large time range or data volume</td>
                                <td>Narrow time range, add filters, use indexed fields</td>
                            </tr>
                            <tr>
                                <td>Parsing errors</td>
                                <td>Log format mismatch</td>
                                <td>Review parser, create custom parsing rule</td>
                            </tr>
                            <tr>
                                <td>High latency</td>
                                <td>Network or broker overload</td>
                                <td>Check bandwidth, scale broker, optimize sources</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Health Monitoring Queries</h4>
                    <div class="code-block">// Check data ingestion rates by source
dataset = panw_ngfw_traffic_raw
| comp count() as events by _vendor, _product
| sort events desc

// Check for parsing failures
dataset = xdr_data
| filter _raw_log != null and _time = null
| comp count() as parse_failures by log_source_name

// Monitor agent connectivity
dataset = xdr_agent_data
| filter event_type = "agent_connectivity"
| comp count() by connectivity_status</div>
                </div>

            </main>

                <!-- Deployment Models -->
                <h2><i class="fas fa-cloud-upload-alt"></i> Deployment Models</h2>
                <div class="config-section">
                    <h4>Standard Cloud Deployment</h4>
                    <p style="color: #8b949e;">The default XSIAM deployment is fully cloud-hosted:</p>
                    <ul style="color: #8b949e;">
                        <li>All processing, storage, and analytics in Palo Alto Networks cloud</li>
                        <li>Agents and Broker VMs connect outbound to cloud</li>
                        <li>No on-premises infrastructure except collection points</li>
                        <li>Automatic updates and scaling</li>
                    </ul>

                    <h4>Hybrid Considerations</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Broker VM:</strong> Required for on-prem sources that can't reach cloud directly</li>
                        <li><strong>Air-Gapped Networks:</strong> Broker with data diode for OT/ICS environments</li>
                        <li><strong>Data Sovereignty:</strong> Select appropriate regional instance</li>
                        <li><strong>Bandwidth:</strong> Consider local aggregation for high-volume sources</li>
                    </ul>

                    <h4>MSSP Multi-Tenant Model</h4>
                    <div class="code-block"># MSSP Architecture
                    
MSSP MANAGEMENT TENANT
├── Central visibility across all customers
├── Shared playbooks and detection content
├── Unified reporting and metrics
└── Role-based access per customer

CUSTOMER TENANT 1          CUSTOMER TENANT 2
├── Isolated data           ├── Isolated data
├── Customer-specific       ├── Customer-specific
│   detection rules         │   detection rules
├── Dedicated agents        ├── Dedicated agents
└── Custom retention        └── Custom retention</div>
                </div>

                <!-- Capacity Planning -->
                <h2><i class="fas fa-chart-bar"></i> Capacity Planning</h2>
                <div class="config-section">
                    <h4>Sizing Worksheet</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Source Category</th><th>Count</th><th>GB/Day Each</th><th>Total GB/Day</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Windows Endpoints</td><td>10,000</td><td>0.1</td><td>1,000</td></tr>
                            <tr><td>Linux Servers</td><td>500</td><td>0.05</td><td>25</td></tr>
                            <tr><td>Palo Alto NGFWs</td><td>20</td><td>10</td><td>200</td></tr>
                            <tr><td>Cloud (AWS/Azure)</td><td>3 accounts</td><td>20</td><td>60</td></tr>
                            <tr><td>Identity (Okta)</td><td>1</td><td>5</td><td>5</td></tr>
                            <tr><td>Other Syslog</td><td>Various</td><td>-</td><td>50</td></tr>
                            <tr style="font-weight: bold;"><td colspan="3">TOTAL</td><td>1,340 GB/day</td></tr>
                        </tbody>
                    </table>

                    <h4>License Considerations</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Endpoint License:</strong> Per-endpoint pricing for XDR agents</li>
                        <li><strong>Data License:</strong> Per-GB ingestion for third-party sources</li>
                        <li><strong>Retention:</strong> Base retention included, extended available</li>
                        <li><strong>Add-ons:</strong> Attack Surface Management, Threat Intel Premium</li>
                    </ul>
                </div>

                <!-- Disaster Recovery -->
                <h2><i class="fas fa-life-ring"></i> Disaster Recovery</h2>
                <div class="config-section">
                    <h4>Platform DR (Built-in)</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Data Replication:</strong> Automatic replication across availability zones</li>
                        <li><strong>RTO:</strong> Platform recovery within minutes (cloud-native)</li>
                        <li><strong>RPO:</strong> Near-zero data loss for ingested data</li>
                        <li><strong>Geo-Redundancy:</strong> Optional cross-region backup</li>
                    </ul>

                    <h4>Broker VM DR</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Active-Passive:</strong> Secondary broker in standby</li>
                        <li><strong>Load Balancer:</strong> Distribute across multiple brokers</li>
                        <li><strong>Local Buffer:</strong> Broker queues data if cloud unreachable</li>
                        <li><strong>Backup Configuration:</strong> Export broker config for recovery</li>
                    </ul>

                    <h4>Agent Resilience</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Offline Mode:</strong> Agents continue protection if disconnected</li>
                        <li><strong>Local Cache:</strong> Events queued locally until connectivity restored</li>
                        <li><strong>Automatic Reconnect:</strong> Agents reconnect automatically</li>
                    </ul>
                </div>


            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>
