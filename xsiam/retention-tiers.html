<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Retention Tiers - Complete Guide Across All SIEMs | XSIAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
                <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="../xsiam/index.html" class="sidebar-nav-link active" data-platform="xsiam"><span class="platform-dot"></span><span>XSIAM</span></a></li>
                    <li class="sidebar-nav-item"><a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk"><span class="platform-dot"></span><span>Splunk</span></a></li>
                    <li class="sidebar-nav-item"><a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel"><span class="platform-dot"></span><span>Sentinel</span></a></li>
                    <li class="sidebar-nav-item"><a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike"><span class="platform-dot"></span><span>CrowdStrike</span></a></li>
                    <li class="sidebar-nav-item"><a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex"><span class="platform-dot"></span><span>Cortex XDR</span></a></li>
                    <li class="sidebar-nav-item"><a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde"><span class="platform-dot"></span><span>Defender for Endpoint</span></a></li>
                    <li class="sidebar-nav-item"><a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations"><span class="platform-dot"></span><span>SOC Operations</span></a></li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Getting Started -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Getting Started</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="index.html" class="sidebar-nav-link"><i class="fas fa-home"></i><span>Overview</span></a></li>
                    <li class="sidebar-nav-item"><a href="architecture.html" class="sidebar-nav-link"><i class="fas fa-sitemap"></i><span>Architecture</span></a></li>
                    <li class="sidebar-nav-item"><a href="comparison.html" class="sidebar-nav-link"><i class="fas fa-balance-scale"></i><span>Platform Comparison</span></a></li>
                </ul>
            </div>
            
            <!-- Data Collection -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Data Collection</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="data-ingestion.html" class="sidebar-nav-link"><i class="fas fa-database"></i><span>Data Ingestion</span></a></li>
                    <li class="sidebar-nav-item"><a href="broker-vm.html" class="sidebar-nav-link"><i class="fas fa-server"></i><span>Broker VM</span></a></li>
                    <li class="sidebar-nav-item"><a href="agents.html" class="sidebar-nav-link"><i class="fas fa-microchip"></i><span>Agents</span></a></li>
                    <li class="sidebar-nav-item"><a href="parsing-flows.html" class="sidebar-nav-link"><i class="fas fa-stream"></i><span>Parsing & Flows</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-log-onboarding.html" class="sidebar-nav-link"><i class="fas fa-plus-circle"></i><span>Custom Log Onboarding</span></a></li>
                    <li class="sidebar-nav-item"><a href="retention-tiers.html" class="sidebar-nav-link active"><i class="fas fa-archive"></i><span>Retention Tiers</span></a></li>
                </ul>
            </div>
            
            <!-- Query & Analysis -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Query & Analysis</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xql-fundamentals.html" class="sidebar-nav-link"><i class="fas fa-terminal"></i><span>XQL Fundamentals</span></a></li>
                    <li class="sidebar-nav-item"><a href="xql-advanced.html" class="sidebar-nav-link"><i class="fas fa-rocket"></i><span>XQL Advanced</span></a></li>
                    <li class="sidebar-nav-item"><a href="dashboards.html" class="sidebar-nav-link"><i class="fas fa-chart-line"></i><span>Dashboards</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-search"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
            
            <!-- Detection & Response -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="ml-ueba.html" class="sidebar-nav-link"><i class="fas fa-brain"></i><span>ML & UEBA</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-analytics.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Identity Analytics</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                </ul>
            </div>
            
            <!-- Incident Playbooks (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Incident Playbooks</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="ransomware-response.html" class="sidebar-nav-link"><i class="fas fa-lock"></i><span>Ransomware Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="bec-investigation.html" class="sidebar-nav-link"><i class="fas fa-envelope"></i><span>BEC Investigation</span></a></li>
                    <li class="sidebar-nav-item"><a href="insider-threat.html" class="sidebar-nav-link"><i class="fas fa-user-secret"></i><span>Insider Threat</span></a></li>
                </ul>
            </div>
            
            <!-- Automation & Intel -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Automation & Intel</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xsoar-automation.html" class="sidebar-nav-link"><i class="fas fa-robot"></i><span>XSOAR Automation</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-intel.html" class="sidebar-nav-link"><i class="fas fa-skull-crossbones"></i><span>Threat Intel</span></a></li>
                    <li class="sidebar-nav-item"><a href="recon-asm.html" class="sidebar-nav-link"><i class="fas fa-globe"></i><span>Recon & ASM</span></a></li>
                </ul>
            </div>
            
            <!-- Integrations -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Integrations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="cloud-integrations.html" class="sidebar-nav-link"><i class="fas fa-cloud"></i><span>Cloud (AWS/Azure/GCP)</span></a></li>
                    <li class="sidebar-nav-item"><a href="identity-integrations.html" class="sidebar-nav-link"><i class="fas fa-id-card"></i><span>Identity (Okta/AD)</span></a></li>
                    <li class="sidebar-nav-item"><a href="custom-integrations.html" class="sidebar-nav-link"><i class="fas fa-puzzle-piece"></i><span>Custom Integrations</span></a></li>
                    <li class="sidebar-nav-item"><a href="marketplace.html" class="sidebar-nav-link"><i class="fas fa-store"></i><span>Marketplace</span></a></li>
                </ul>
            </div>
            
            <!-- Operations (NEW) -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Operations</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="troubleshooting.html" class="sidebar-nav-link"><i class="fas fa-wrench"></i><span>Troubleshooting</span></a></li>
                    <li class="sidebar-nav-item"><a href="day2-operations.html" class="sidebar-nav-link"><i class="fas fa-tasks"></i><span>Day-2 Operations</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-tuning.html" class="sidebar-nav-link"><i class="fas fa-sliders-h"></i><span>Alert Tuning</span></a></li>
                    <li class="sidebar-nav-item"><a href="cost-optimization.html" class="sidebar-nav-link"><i class="fas fa-dollar-sign"></i><span>Cost Optimization</span></a></li>
                </ul>
            </div>
            
            <!-- Administration -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Administration</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="rbac-access-control.html" class="sidebar-nav-link"><i class="fas fa-users-cog"></i><span>RBAC & Access</span></a></li>
                    <li class="sidebar-nav-item"><a href="health-monitoring.html" class="sidebar-nav-link"><i class="fas fa-heartbeat"></i><span>Health Monitoring</span></a></li>
                    <li class="sidebar-nav-item"><a href="backup-recovery.html" class="sidebar-nav-link"><i class="fas fa-undo"></i><span>Backup & Recovery</span></a></li>
                    <li class="sidebar-nav-item"><a href="api-administration.html" class="sidebar-nav-link"><i class="fas fa-code"></i><span>API Administration</span></a></li>
                </ul>
            </div>
            
            <!-- Architecture & Planning -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Architecture & Planning</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="capacity-planning.html" class="sidebar-nav-link"><i class="fas fa-calculator"></i><span>Capacity Planning</span></a></li>
                    <li class="sidebar-nav-item"><a href="network-requirements.html" class="sidebar-nav-link"><i class="fas fa-network-wired"></i><span>Network Requirements</span></a></li>
                    <li class="sidebar-nav-item"><a href="multi-tenant.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Multi-Tenant</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-residency.html" class="sidebar-nav-link"><i class="fas fa-map-marked-alt"></i><span>Data Residency</span></a></li>
                    <li class="sidebar-nav-item"><a href="migration-guide.html" class="sidebar-nav-link"><i class="fas fa-exchange-alt"></i><span>Migration Guide</span></a></li>
                </ul>
            </div>
            
            <!-- Compliance & Governance -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Compliance & Governance</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="compliance-frameworks.html" class="sidebar-nav-link"><i class="fas fa-clipboard-check"></i><span>Compliance Frameworks</span></a></li>
                    <li class="sidebar-nav-item"><a href="audit-reporting.html" class="sidebar-nav-link"><i class="fas fa-file-alt"></i><span>Audit & Reporting</span></a></li>
                    <li class="sidebar-nav-item"><a href="data-privacy.html" class="sidebar-nav-link"><i class="fas fa-user-shield"></i><span>Data Privacy</span></a></li>
                    <li class="sidebar-nav-item"><a href="soc-metrics.html" class="sidebar-nav-link"><i class="fas fa-tachometer-alt"></i><span>SOC Metrics & KPIs</span></a></li>
                </ul>
            </div>
            
            <!-- Enterprise -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Enterprise</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="enterprise-soc.html" class="sidebar-nav-link"><i class="fas fa-building"></i><span>Enterprise SOC</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>




        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Retention Tiers</span>
                </div>

                <div class="page-header">
                    <h1><i class="fas fa-archive"></i> Data Retention Tiers - Complete Guide</h1>
                    <p class="lead">Understanding storage tiers, cost optimization, and when to use each tier across XSIAM, Sentinel, and Splunk with real raw log examples</p>
                </div>
                <!-- Overview Comparison -->
                <section class="content-section">
                    <h2><i class="fas fa-table"></i> Retention Tiers Comparison - All Platforms</h2>
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Tier</th>
                                <th>Sentinel</th>
                                <th>Splunk</th>
                                <th>XSIAM</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Hot / Analytics</strong></td>
                                <td>Analytics Logs (default)</td>
                                <td>Hot Buckets (searchable)</td>
                                <td>Online Storage</td>
                            </tr>
                            <tr>
                                <td><strong>Warm / Basic</strong></td>
                                <td>Basic Logs (limited query)</td>
                                <td>Warm Buckets</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td><strong>Cold / Auxiliary</strong></td>
                                <td>Auxiliary Logs (GA Apr 2025)</td>
                                <td>Cold Buckets</td>
                                <td>Archive Storage</td>
                            </tr>
                            <tr>
                                <td><strong>Archive / Frozen</strong></td>
                                <td>Archive tier (long-term)</td>
                                <td>Frozen (S3/Blob)</td>
                                <td>Data Lake Export</td>
                            </tr>
                            <tr>
                                <td><strong>Query Speed</strong></td>
                                <td>Analytics: Fast<br>Basic: Slower<br>Auxiliary: Slowest</td>
                                <td>Hot: Instant<br>Warm: Fast<br>Cold: Minutes<br>Frozen: Hours</td>
                                <td>Online: Fast<br>Archive: Slower</td>
                            </tr>
                            <tr>
                                <td><strong>Cost Ratio</strong></td>
                                <td>Analytics: 1x<br>Basic: 0.5x<br>Auxiliary: 0.1x</td>
                                <td>Based on license model</td>
                                <td>Based on data units</td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                
                <!-- Decision Tree: Choosing Storage Tier -->
                <div class="decision-tree">
                    <h3><i class="fas fa-sitemap"></i> Decision Tree: Choose the Right Storage Tier</h3>
                    
                    <div class="decision-node">
                        <i class="fas fa-question-circle"></i>
                        <strong>Does this data power detection/correlation rules?</strong>
                        <small>Analytics rules, correlation searches, real-time alerts</small>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow yes">YES</div>
                        <div class="decision-outcome" style="border-left-color: #3fb950;">
                            <i class="fas fa-fire" style="color: #f85149;"></i>
                            <strong>Analytics / Hot Tier Required</strong>
                            <small>Sentinel: Analytics Logs | Splunk: Hot/Warm | XSIAM: Online Storage | Detection rules require fast access</small>
                        </div>
                    </div>
                    
                    <div class="decision-branch">
                        <div class="decision-arrow no">NO</div>
                        <div class="decision-node">
                            <i class="fas fa-question-circle"></i>
                            <strong>Is this data queried daily for investigations?</strong>
                            <small>SOC analysts actively searching this data</small>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow yes">YES</div>
                            <div class="decision-outcome" style="border-left-color: #58a6ff;">
                                <i class="fas fa-search" style="color: #58a6ff;"></i>
                                <strong>Analytics / Warm Tier Recommended</strong>
                                <small>Fast queries needed for investigation workflow | Consider 30-90 day retention</small>
                            </div>
                        </div>
                        
                        <div class="decision-branch">
                            <div class="decision-arrow no">NO</div>
                            <div class="decision-node">
                                <i class="fas fa-question-circle"></i>
                                <strong>Is this data needed for occasional forensics?</strong>
                                <small>Incident response, root cause analysis, threat hunting</small>
                            </div>
                            
                            <div class="decision-branch">
                                <div class="decision-arrow yes">YES</div>
                                <div class="decision-outcome" style="border-left-color: #d29922;">
                                    <i class="fas fa-archive" style="color: #d29922;"></i>
                                    <strong>Basic / Cold Tier</strong>
                                    <small>Sentinel: Basic Logs | Splunk: Cold Path | XSIAM: Archive | Slower queries acceptable</small>
                                </div>
                            </div>
                            
                            <div class="decision-branch">
                                <div class="decision-arrow no">NO</div>
                                <div class="decision-node">
                                    <i class="fas fa-question-circle"></i>
                                    <strong>Is there a compliance/legal requirement to retain?</strong>
                                    <small>PCI, SOX, HIPAA, legal hold, audit requirements</small>
                                </div>
                                
                                <div class="decision-branch">
                                    <div class="decision-arrow yes">YES</div>
                                    <div class="decision-outcome" style="border-left-color: #a371f7;">
                                        <i class="fas fa-gavel" style="color: #a371f7;"></i>
                                        <strong>Auxiliary / Archive / Export</strong>
                                        <small>Sentinel: Auxiliary | Splunk: Frozen/S3 | XSIAM: Data Lake Export | Cheapest long-term storage</small>
                                    </div>
                                </div>
                                
                                <div class="decision-branch">
                                    <div class="decision-arrow no">NO</div>
                                    <div class="decision-node">
                                        <i class="fas fa-question-circle"></i>
                                        <strong>Does this data have any security value?</strong>
                                        <small>Could it be useful for future unknown threats?</small>
                                    </div>
                                    
                                    <div class="decision-branch">
                                        <div class="decision-arrow yes">MAYBE</div>
                                        <div class="decision-outcome" style="border-left-color: #d29922;">
                                            <i class="fas fa-filter" style="color: #d29922;"></i>
                                            <strong>Filter at Ingestion</strong>
                                            <small>Reduce volume by filtering to security-relevant events only | Keep summary data</small>
                                        </div>
                                    </div>
                                    
                                    <div class="decision-branch">
                                        <div class="decision-arrow no">NO</div>
                                        <div class="decision-outcome" style="border-left-color: #f85149;">
                                            <i class="fas fa-trash-alt" style="color: #f85149;"></i>
                                            <strong>Don't Collect</strong>
                                            <small>Why are we ingesting this? Remove the data source or filter at collection</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Lifecycle Flow Diagram -->
                <h2><i class="fas fa-project-diagram"></i> Data Lifecycle Flow</h2>
                <div class="flow-diagram">
                    <div class="flow-step" style="border-left-color: #f85149;">
                        <div class="flow-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                        <div class="flow-content">
                            <h4>Ingestion</h4>
                            <ul>
                                <li>Data arrives from sources</li>
                                <li>Parsing and normalization applied</li>
                                <li>Routed to appropriate tier based on config</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #f85149;">
                        <div class="flow-icon"><i class="fas fa-fire-alt"></i></div>
                        <div class="flow-content">
                            <h4>Hot / Analytics Tier</h4>
                            <ul>
                                <li>Real-time detection rules execute</li>
                                <li>Fastest query performance</li>
                                <li>Typically 30-90 days retention</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #d29922;">
                        <div class="flow-icon"><i class="fas fa-temperature-low"></i></div>
                        <div class="flow-content">
                            <h4>Warm / Basic Tier</h4>
                            <ul>
                                <li>Aged out of hot based on policy</li>
                                <li>Still searchable, slightly slower</li>
                                <li>Lower cost storage</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #58a6ff;">
                        <div class="flow-icon"><i class="fas fa-snowflake"></i></div>
                        <div class="flow-content">
                            <h4>Cold / Archive Tier</h4>
                            <ul>
                                <li>Searchable with delay (restore required)</li>
                                <li>Significantly cheaper storage</li>
                                <li>Forensic and compliance access</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #a371f7;">
                        <div class="flow-icon"><i class="fas fa-archive"></i></div>
                        <div class="flow-content">
                            <h4>Frozen / Long-term Archive</h4>
                            <ul>
                                <li>Exported to object storage (S3, Blob)</li>
                                <li>Cheapest possible retention</li>
                                <li>Hours to restore for queries</li>
                            </ul>
                        </div>
                        <div class="flow-arrow"></div>
                    </div>
                    
                    <div class="flow-step" style="border-left-color: #8b949e;">
                        <div class="flow-icon"><i class="fas fa-trash"></i></div>
                        <div class="flow-content">
                            <h4>Deletion / Expiry</h4>
                            <ul>
                                <li>Retention period exceeded</li>
                                <li>Data permanently removed</li>
                                <li>Ensure compliance before deletion</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- ==================== MICROSOFT SENTINEL ==================== -->
                <section class="content-section platform-section platform-sentinel">
                    <h2><i class="fas fa-shield-alt" style="color: #0078d4;"></i> Microsoft Sentinel Retention Tiers</h2>
                    <!-- Analytics Logs -->
                    <div class="tier-card tier-analytics">
                        <h3>üìä Analytics Logs (Default Tier)</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div>
                                <p><strong>What it is:</strong> Full-featured storage with complete query capabilities and analytics rule support.</p>
                                <p><strong>Cost:</strong> ~$2.76/GB ingestion (Pay-As-You-Go, US East)</p>
                                <p><strong>Retention:</strong> 90 days interactive (free), up to 2 years with cost</p>
                                <p><strong>Query:</strong> Full KQL, joins, analytics rules, workbooks</p>
                            </div>
                            <div>
                                <p><strong>Best for:</strong></p>
                                <ul>
                                    <li>Security events needing real-time correlation</li>
                                    <li>Data sources used in analytics rules</li>
                                    <li>High-value logs requiring fast investigation</li>
                                    <li>Authentication logs (SigninLogs, SecurityEvent)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Basic Logs -->
                    <div class="tier-card tier-basic">
                        <h3>üì¶ Basic Logs (Cost-Optimized)</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div>
                                <p><strong>What it is:</strong> Lower-cost storage with limited query capabilities.</p>
                                <p><strong>Cost:</strong> ~$0.60/GB ingestion + $0.007/GB query</p>
                                <p><strong>Retention:</strong> 30 days (fixed), then archive</p>
                                <p><strong>Query Limits:</strong></p>
                                <ul>
                                    <li>8 days lookback per query</li>
                                    <li>Simple queries only (limited joins)</li>
                                    <li>No analytics rules</li>
                                    <li>No workbook visualizations</li>
                                </ul>
                            </div>
                            <div>
                                <p><strong>Best for:</strong></p>
                                <ul>
                                    <li>Verbose debug/trace logs</li>
                                    <li>NetFlow/traffic metadata</li>
                                    <li>Compliance data rarely queried</li>
                                    <li>Low-value high-volume logs</li>
                                </ul>
                                <p><strong>Configure via:</strong></p>
                                <code>Log Analytics Workspace ‚Üí Tables ‚Üí Select table ‚Üí Manage table ‚Üí Change plan to Basic</code>
                            </div>
                        </div>
                    </div>
                    <!-- Auxiliary Logs -->
                    <div class="tier-card tier-auxiliary">
                        <h3>üóÑÔ∏è Auxiliary Logs (Ultra Low Cost - GA April 2025)</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div>
                                <p><strong>What it is:</strong> Cheapest storage tier for massive volumes with minimal query needs.</p>
                                <p><strong>Cost:</strong> ~$0.15/GB ingestion (US East)</p>
                                <p><strong>Retention:</strong> Up to 12 years</p>
                                <p><strong>Query:</strong> Very limited - batch search jobs only</p>
                            </div>
                            <div>
                                <p><strong>Best for:</strong></p>
                                <ul>
                                    <li>Compliance/regulatory archives</li>
                                    <li>Massive log volumes (CDN, load balancer)</li>
                                    <li>Forensic investigation archives</li>
                                    <li>Data you must keep but rarely search</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Archive -->
                    <div class="tier-card tier-archive">
                        <h3>‚ùÑÔ∏è Archive Tier (Long-Term Retention)</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div>
                                <p><strong>What it is:</strong> Data moved from interactive retention to archive storage.</p>
                                <p><strong>Cost:</strong> ~$0.023/GB/month storage</p>
                                <p><strong>Retention:</strong> Up to 12 years</p>
                                <p><strong>Query:</strong> Search jobs only (async, minutes to complete)</p>
                            </div>
                            <div>
                                <p><strong>How it works:</strong></p>
                                <ul>
                                    <li>After interactive retention expires, data moves to archive</li>
                                    <li>Configure: Table ‚Üí Manage ‚Üí Total retention period</li>
                                    <li>Query via Search Jobs in Logs blade</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Decision Framework -->
                    <h3>üéØ Decision Framework: Which Sentinel Tier?</h3>
                    <div class="decision-box">
                        <table class="styled-table">
                            <thead>
                                <tr>
                                    <th>Log Type</th>
                                    <th>Volume</th>
                                    <th>Query Need</th>
                                    <th>Recommended Tier</th>
                                    <th>Rationale</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>SecurityEvent</td>
                                    <td>High</td>
                                    <td>Real-time correlation</td>
                                    <td><strong>Analytics</strong></td>
                                    <td>Needed for analytics rules, incident investigation</td>
                                </tr>
                                <tr>
                                    <td>SigninLogs</td>
                                    <td>Medium</td>
                                    <td>Real-time + historical</td>
                                    <td><strong>Analytics</strong></td>
                                    <td>Critical for identity threat detection</td>
                                </tr>
                                <tr>
                                    <td>AADNonInteractiveSignInLogs</td>
                                    <td>Very High</td>
                                    <td>Occasional investigation</td>
                                    <td><strong>Basic</strong></td>
                                    <td>Verbose, rarely triggers alerts directly</td>
                                </tr>
                                <tr>
                                    <td>AzureNetworkAnalytics_CL</td>
                                    <td>Very High</td>
                                    <td>Forensic only</td>
                                    <td><strong>Basic or Auxiliary</strong></td>
                                    <td>Network flow data, huge volume</td>
                                </tr>
                                <tr>
                                    <td>ContainerLog</td>
                                    <td>Extreme</td>
                                    <td>Debug only</td>
                                    <td><strong>Basic</strong></td>
                                    <td>Developer logs, not security critical</td>
                                </tr>
                                <tr>
                                    <td>StorageBlobLogs</td>
                                    <td>Extreme</td>
                                    <td>Compliance archive</td>
                                    <td><strong>Auxiliary</strong></td>
                                    <td>Regulatory requirement, never queried</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- Raw Log Example with Parsing -->
                    <h3>üìù Real Log Example: Windows Security Event</h3>
                    <h4>Step 1: Raw Event on Windows Server</h4>
                    <div class="raw-log">&lt;Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"&gt;
  &lt;System&gt;
    &lt;Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-a5ba-3e3b0328c30d}"/&gt;
    &lt;EventID&gt;4625&lt;/EventID&gt;
    &lt;Version&gt;0&lt;/Version&gt;
    &lt;Level&gt;0&lt;/Level&gt;
    &lt;Task&gt;12544&lt;/Task&gt;
    &lt;Opcode&gt;0&lt;/Opcode&gt;
    &lt;Keywords&gt;0x8010000000000000&lt;/Keywords&gt;
    &lt;TimeCreated SystemTime="2025-01-09T14:32:15.123456789Z"/&gt;
    &lt;EventRecordID&gt;987654321&lt;/EventRecordID&gt;
    &lt;Correlation/&gt;
    &lt;Execution ProcessID="672" ThreadID="756"/&gt;
    &lt;Channel&gt;Security&lt;/Channel&gt;
    &lt;Computer&gt;DC01.contoso.com&lt;/Computer&gt;
    &lt;Security/&gt;
  &lt;/System&gt;
  &lt;EventData&gt;
    &lt;Data Name="SubjectUserSid"&gt;S-1-0-0&lt;/Data&gt;
    &lt;Data Name="SubjectUserName"&gt;-&lt;/Data&gt;
    &lt;Data Name="SubjectDomainName"&gt;-&lt;/Data&gt;
    &lt;Data Name="SubjectLogonId"&gt;0x0&lt;/Data&gt;
    &lt;Data Name="TargetUserSid"&gt;S-1-0-0&lt;/Data&gt;
    &lt;Data Name="TargetUserName"&gt;administrator&lt;/Data&gt;
    &lt;Data Name="TargetDomainName"&gt;CONTOSO&lt;/Data&gt;
    &lt;Data Name="Status"&gt;0xc000006d&lt;/Data&gt;
    &lt;Data Name="FailureReason"&gt;%%2313&lt;/Data&gt;
    &lt;Data Name="SubStatus"&gt;0xc0000064&lt;/Data&gt;
    &lt;Data Name="LogonType"&gt;3&lt;/Data&gt;
    &lt;Data Name="LogonProcessName"&gt;NtLmSsp&lt;/Data&gt;
    &lt;Data Name="AuthenticationPackageName"&gt;NTLM&lt;/Data&gt;
    &lt;Data Name="WorkstationName"&gt;ATTACKER-PC&lt;/Data&gt;
    &lt;Data Name="TransmittedServices"&gt;-&lt;/Data&gt;
    &lt;Data Name="LmPackageName"&gt;-&lt;/Data&gt;
    &lt;Data Name="KeyLength"&gt;0&lt;/Data&gt;
    &lt;Data Name="ProcessId"&gt;0x0&lt;/Data&gt;
    &lt;Data Name="ProcessName"&gt;-&lt;/Data&gt;
    &lt;Data Name="IpAddress"&gt;192.168.1.100&lt;/Data&gt;
    &lt;Data Name="IpPort"&gt;49521&lt;/Data&gt;
  &lt;/EventData&gt;
&lt;/Event&gt;</div>
                    <h4>Step 2: AMA Collection via DCR</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">DCR XPath</span>
                            <span class="code-title">Collection Rule</span>
                        </div>
                        <pre><code>// XPath query in DCR that matches this event:
Security!*[System[(EventID=4625)]]
// The AMA reads this event because:
// - Log: Security
// - EventID: 4625 matches our XPath</code></pre>
                    </div>
                    <h4>Step 3: DCR Transformation (Optional)</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <span class="code-title">transformKql in DCR</span>
                        </div>
                        <pre><code>// Filter out machine account failures (often noisy)
source
| where TargetUserName !endswith "$"
| where IpAddress != "127.0.0.1"</code></pre>
                    </div>
                    <h4>Step 4: Parsed Output in SecurityEvent Table</h4>
                    <div class="parsed-output">
                        <table style="width: 100%; font-size: 0.85rem;">
                            <tr><td class="field-highlight">TimeGenerated</td><td class="value-highlight">2025-01-09T14:32:15.123Z</td></tr>
                            <tr><td class="field-highlight">Computer</td><td class="value-highlight">DC01.contoso.com</td></tr>
                            <tr><td class="field-highlight">EventID</td><td class="value-highlight">4625</td></tr>
                            <tr><td class="field-highlight">Account</td><td class="value-highlight">CONTOSO\administrator</td></tr>
                            <tr><td class="field-highlight">TargetUserName</td><td class="value-highlight">administrator</td></tr>
                            <tr><td class="field-highlight">TargetDomainName</td><td class="value-highlight">CONTOSO</td></tr>
                            <tr><td class="field-highlight">LogonType</td><td class="value-highlight">3</td></tr>
                            <tr><td class="field-highlight">LogonTypeName</td><td class="value-highlight">Network</td></tr>
                            <tr><td class="field-highlight">IpAddress</td><td class="value-highlight">192.168.1.100</td></tr>
                            <tr><td class="field-highlight">WorkstationName</td><td class="value-highlight">ATTACKER-PC</td></tr>
                            <tr><td class="field-highlight">Status</td><td class="value-highlight">0xc000006d</td></tr>
                            <tr><td class="field-highlight">FailureReason</td><td class="value-highlight">Unknown user name or bad password</td></tr>
                            <tr><td class="field-highlight">AuthenticationPackageName</td><td class="value-highlight">NTLM</td></tr>
                        </table>
                    </div>
                    <h4>Step 5: Query in Sentinel</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <span class="code-title">Analytics Rule Query</span>
                        </div>
                        <pre><code>// Detect brute force attack
SecurityEvent
| where TimeGenerated > ago(1h)
| where EventID == 4625
| where LogonType == 3
| summarize 
    FailedAttempts = count(),
    TargetAccounts = make_set(TargetUserName),
    SourceIPs = make_set(IpAddress)
by Computer, bin(TimeGenerated, 5m)
| where FailedAttempts > 10</code></pre>
                    </div>
                </section>
                <!-- ==================== SPLUNK ==================== -->
                <section class="content-section platform-section platform-splunk">
                    <h2><i class="fas fa-search" style="color: #65a637;"></i> Splunk Data Tiers & Buckets</h2>
                    <p>Splunk uses a bucket lifecycle model where data moves through tiers based on age and access patterns.</p>
                    <!-- Splunk Bucket Lifecycle -->
                    <div class="architecture-diagram" >
<p style="color: #8b949e;">[Diagram - see related pages for visual representation]</p>
                    </div>
                    <!-- Tier Details -->
                    <div class="tier-card tier-analytics">
                        <h3>üî• Hot Buckets</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div>
                                <p><strong>What:</strong> Actively receiving data, stored on fast SSD</p>
                                <p><strong>Storage:</strong> $SPLUNK_DB/&lt;index&gt;/db/hot_*</p>
                                <p><strong>Characteristics:</strong></p>
                                <ul>
                                    <li>Writable - still receiving events</li>
                                    <li>Fastest search performance</li>
                                    <li>Most expensive storage</li>
                                </ul>
                            </div>
                            <div>
                                <p><strong>Roll to Warm when:</strong></p>
                                <ul>
                                    <li>Bucket size exceeds maxDataSize (default 750MB)</li>
                                    <li>Time exceeds maxHotSpanSecs</li>
                                    <li>Splunk restart</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="tier-card tier-basic">
                        <h3>üå°Ô∏è Warm Buckets</h3>
                        <p><strong>What:</strong> Read-only, frequently searched, still on primary storage</p>
                        <p><strong>Roll to Cold when:</strong> Bucket count exceeds maxWarmDBCount (default 300)</p>
                    </div>
                    <div class="tier-card tier-auxiliary">
                        <h3>‚ùÑÔ∏è Cold Buckets</h3>
                        <p><strong>What:</strong> Read-only, searchable but slower, can be on cheaper storage (NAS, HDD)</p>
                        <p><strong>Configure:</strong> <code>coldPath</code> in indexes.conf</p>
                        <p><strong>Roll to Frozen when:</strong> frozenTimePeriodInSecs exceeded OR coldPath volume limit hit</p>
                    </div>
                    <div class="tier-card tier-archive">
                        <h3>üßä Frozen Buckets</h3>
                        <p><strong>What:</strong> Removed from Splunk, archived to external storage</p>
                        <p><strong>Options:</strong></p>
                        <ul>
                            <li><strong>Delete:</strong> coldToFrozenDir not set - data is deleted</li>
                            <li><strong>Archive:</strong> coldToFrozenDir = /archive/splunk - moves raw data</li>
                            <li><strong>SmartStore (Cloud):</strong> S3/GCS/Azure Blob - remote storage with cache</li>
                        </ul>
                        <p><strong>To search:</strong> Must thaw (restore) to warm/cold path first</p>
                    </div>
                    <!-- Splunk indexes.conf -->
                    <h3>üìù indexes.conf Configuration</h3>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">conf</span>
                            <span class="code-title">indexes.conf - Tiered Retention Example</span>
                        </div>
                        <pre><code># $SPLUNK_HOME/etc/apps/my_indexes/local/indexes.conf
[main]
homePath = $SPLUNK_DB/main/db          # Hot/Warm on fast storage
coldPath = $SPLUNK_DB/main/colddb      # Cold on slower storage
thawedPath = $SPLUNK_DB/main/thaweddb  # For restored frozen data
maxTotalDataSizeMB = 500000            # 500GB total for this index
frozenTimePeriodInSecs = 7776000       # 90 days before freeze
# High-value security logs - keep longer
[security]
homePath = $SPLUNK_DB/security/db
coldPath = /mnt/cold_storage/security/colddb
thawedPath = $SPLUNK_DB/security/thaweddb
maxTotalDataSizeMB = 1000000           # 1TB
frozenTimePeriodInSecs = 31536000      # 365 days
coldToFrozenDir = /mnt/archive/security # Archive instead of delete
# High-volume network logs - short retention
[netflow]
homePath = $SPLUNK_DB/netflow/db
coldPath = $SPLUNK_DB/netflow/colddb
thawedPath = $SPLUNK_DB/netflow/thaweddb
maxTotalDataSizeMB = 2000000           # 2TB
frozenTimePeriodInSecs = 604800        # 7 days only
# No coldToFrozenDir = data deleted after 7 days</code></pre>
                    </div>
                    <!-- Splunk SmartStore -->
                    <h3>‚òÅÔ∏è SmartStore (Cloud Tiering)</h3>
                    <div class="info-box">
                        <p>SmartStore moves warm/cold data to S3/GCS/Azure Blob while keeping hot data local. This is the modern approach for cloud deployments.</p>
                        <div class="arch-diagram">
                            <div class="code-header">
                                <span class="code-lang">conf</span>
                                <span class="code-title">indexes.conf with SmartStore</span>
                            </div>
                            <pre><code>[volume:remote_store]
storageType = remote
path = s3://my-splunk-bucket/
remote.s3.access_key = AKIAXXXXXXXX
remote.s3.secret_key = xxxxxxxxxx
[security]
remotePath = volume:remote_store/$_index_name
maxDataSize = auto_high_volume
# Hot data stays local, warm/cold goes to S3</code></pre>
                        </div>
                    </div>
                    <!-- Raw Log Example - Splunk -->
                    <h3>üìù Real Log Example: Palo Alto Firewall</h3>
                    <h4>Step 1: Raw Syslog Received at Heavy Forwarder</h4>
                    <div class="raw-log">&lt;14&gt;Jan  9 14:32:15 PA-3260 1,2025/01/09 14:32:15,001234567890,TRAFFIC,end,2816,2025/01/09 14:32:15,192.168.1.100,8.8.8.8,10.0.0.1,8.8.8.8,Allow_DNS,contoso\jsmith,dns-base,vsys1,Trust,Untrust,ethernet1/1,ethernet1/2,Log-Default,2025/01/09 14:32:15,12345,1,54321,53,0,53,0x400000,udp,allow,196,128,68,2,2025/01/09 14:32:10,0,any,0,987654321,0x0,192.168.0.0-192.168.255.255,United States,0,1,1,aged-out,0,0,0,0,,PA-3260,from-policy,,,0,,0,,N/A,0,0,0,0,12ab34cd-5678-90ef-gh12-ijklmnop3456,0,0,,,,,,,</div>
                    <h4>Step 2: inputs.conf on Heavy Forwarder</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">conf</span>
                            <span class="code-title">inputs.conf</span>
                        </div>
                        <pre><code># Receive syslog on UDP 514
[udp://514]
connection_host = dns
sourcetype = pan:traffic
index = pan_logs</code></pre>
                    </div>
                    <h4>Step 3: props.conf Parsing</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">conf</span>
                            <span class="code-title">props.conf (from Palo Alto TA)</span>
                        </div>
                        <pre><code>[pan:traffic]
TIME_FORMAT = %Y/%m/%d %H:%M:%S
TIME_PREFIX = ^[^,]*,
MAX_TIMESTAMP_LOOKAHEAD = 32
SHOULD_LINEMERGE = false
TRUNCATE = 0
# Field extractions
REPORT-pan_traffic = pan_traffic_fields
FIELDALIAS-src = src_ip AS src
FIELDALIAS-dest = dest_ip AS dest
FIELDALIAS-action = action AS vendor_action
# CIM compliance
EVAL-action = case(action=="allow", "allowed", action=="deny", "blocked", 1=1, action)
EVAL-bytes = bytes_sent + bytes_received</code></pre>
                    </div>
                    <h4>Step 4: transforms.conf Field Extraction</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">conf</span>
                            <span class="code-title">transforms.conf</span>
                        </div>
                        <pre><code>[pan_traffic_fields]
REGEX = ^[^,]*,[^,]*,[^,]*,[^,]*,TRAFFIC,[^,]*,[^,]*,[^,]*,(?P&lt;src_ip&gt;[^,]*),(?P&lt;dest_ip&gt;[^,]*),(?P&lt;nat_src_ip&gt;[^,]*),(?P&lt;nat_dest_ip&gt;[^,]*),(?P&lt;rule&gt;[^,]*),(?P&lt;src_user&gt;[^,]*)
FORMAT = src_ip::$1 dest_ip::$2 nat_src_ip::$3 nat_dest_ip::$4 rule::$5 src_user::$6</code></pre>
                    </div>
                    <h4>Step 5: Parsed Event in Splunk</h4>
                    <div class="parsed-output">
                        <table style="width: 100%; font-size: 0.85rem;">
                            <tr><td class="field-highlight">_time</td><td class="value-highlight">2025-01-09 14:32:15</td></tr>
                            <tr><td class="field-highlight">sourcetype</td><td class="value-highlight">pan:traffic</td></tr>
                            <tr><td class="field-highlight">index</td><td class="value-highlight">pan_logs</td></tr>
                            <tr><td class="field-highlight">src_ip</td><td class="value-highlight">192.168.1.100</td></tr>
                            <tr><td class="field-highlight">dest_ip</td><td class="value-highlight">8.8.8.8</td></tr>
                            <tr><td class="field-highlight">dest_port</td><td class="value-highlight">53</td></tr>
                            <tr><td class="field-highlight">src_user</td><td class="value-highlight">contoso\jsmith</td></tr>
                            <tr><td class="field-highlight">rule</td><td class="value-highlight">Allow_DNS</td></tr>
                            <tr><td class="field-highlight">action</td><td class="value-highlight">allowed</td></tr>
                            <tr><td class="field-highlight">bytes_sent</td><td class="value-highlight">128</td></tr>
                            <tr><td class="field-highlight">bytes_received</td><td class="value-highlight">68</td></tr>
                            <tr><td class="field-highlight">src (CIM)</td><td class="value-highlight">192.168.1.100</td></tr>
                            <tr><td class="field-highlight">dest (CIM)</td><td class="value-highlight">8.8.8.8</td></tr>
                        </table>
                    </div>
                    <h4>Step 6: Search with CIM</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">SPL</span>
                            <span class="code-title">Search Query</span>
                        </div>
                        <pre><code>| tstats count from datamodel=Network_Traffic 
    where All_Traffic.action=blocked 
    by All_Traffic.src, All_Traffic.dest, All_Traffic.dest_port
| rename All_Traffic.* AS *
| sort -count</code></pre>
                    </div>
                </section>
                <!-- ==================== XSIAM ==================== -->
                <section class="content-section platform-section platform-xsiam">
                    <h2><i class="fas fa-fire" style="color: #ff6b00;"></i> Palo Alto XSIAM Data Storage</h2>
                    <p>XSIAM uses a cloud-native data lake architecture with different storage tiers and data units for billing.</p>
                    <div class="tier-card tier-analytics">
                        <h3>üî• Online Storage</h3>
                        <p><strong>What:</strong> Primary queryable storage for all ingested data</p>
                        <p><strong>Retention:</strong> Configurable per dataset (30 days to 2 years)</p>
                        <p><strong>Query:</strong> Full XQL with sub-second response</p>
                        <p><strong>Billing:</strong> Based on Data Units (DUs) consumed</p>
                    </div>
                    <div class="tier-card tier-archive">
                        <h3>üóÑÔ∏è Archive Storage</h3>
                        <p><strong>What:</strong> Long-term retention at lower cost</p>
                        <p><strong>Access:</strong> Restore to online before querying (takes minutes)</p>
                        <p><strong>Use case:</strong> Compliance, forensic investigations</p>
                    </div>
                    <div class="tier-card tier-auxiliary">
                        <h3>üåä Data Lake Export</h3>
                        <p><strong>What:</strong> Export data to your own data lake (Snowflake, Databricks, S3)</p>
                        <p><strong>Format:</strong> Parquet files, configurable schedule</p>
                        <p><strong>Use case:</strong> Long-term analytics, ML, compliance archives</p>
                    </div>
                    <!-- Raw Log Example - XSIAM -->
                    <h3>üìù Real Log Example: CEF from Firewall</h3>
                    <h4>Step 1: Raw CEF Log Received at Broker VM</h4>
                    <div class="raw-log">CEF:0|Palo Alto Networks|PAN-OS|10.2.0|TRAFFIC|end|3|rt=Jan 09 2025 14:32:15 GMT src=192.168.1.100 dst=8.8.8.8 spt=54321 dpt=53 proto=UDP act=allow deviceInboundInterface=ethernet1/1 deviceOutboundInterface=ethernet1/2 cs1=Allow_DNS cs1Label=Rule duser=contoso\\jsmith in=128 out=68 cn1=12345 cn1Label=SessionID</div>
                    <h4>Step 2: Broker VM Syslog Collector</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">Config</span>
                            <span class="code-title">Broker VM Applet Configuration</span>
                        </div>
                        <pre><code># Syslog Collector applet on Broker VM
Port: 514 (UDP/TCP)
Format: Auto-detect (CEF detected)
Vendor: Palo Alto Networks
Content Pack: Applied automatically</code></pre>
                    </div>
                    <h4>Step 3: Parsing Rule (Auto-applied from Marketplace)</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">XQL</span>
                            <span class="code-title">Parsing Rule</span>
                        </div>
                        <pre><code>// CEF auto-parsing extracts standard fields
// Custom parsing rule can add more:
[INGEST:PAN_TRAFFIC]
| alter 
    src_ip = regextract(_raw_log, "src=(\d+\.\d+\.\d+\.\d+)"),
    dst_ip = regextract(_raw_log, "dst=(\d+\.\d+\.\d+\.\d+)"),
    src_port = to_integer(regextract(_raw_log, "spt=(\d+)")),
    dst_port = to_integer(regextract(_raw_log, "dpt=(\d+)")),
    action = regextract(_raw_log, "act=(\w+)"),
    user = regextract(_raw_log, "duser=([^\s]+)"),
    rule_name = regextract(_raw_log, "cs1=([^\s]+)")</code></pre>
                    </div>
                    <h4>Step 4: Data Model Rule (XDM Mapping)</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">XQL</span>
                            <span class="code-title">XDM Mapping Rule</span>
                        </div>
                        <pre><code>// Map parsed fields to XDM schema
[MODEL:PAN_TRAFFIC]
| alter
    xdm.source.ipv4 = src_ip,
    xdm.target.ipv4 = dst_ip,
    xdm.source.port = src_port,
    xdm.target.port = dst_port,
    xdm.event.outcome = if(action = "allow", XDM_CONST.OUTCOME_SUCCESS, XDM_CONST.OUTCOME_FAILED),
    xdm.source.user.username = user,
    xdm.network.rule = rule_name,
    xdm.event.type = "NETWORK"</code></pre>
                    </div>
                    <h4>Step 5: Queryable in XQL</h4>
                    <div class="parsed-output">
                        <table style="width: 100%; font-size: 0.85rem;">
                            <tr><td class="field-highlight">_time</td><td class="value-highlight">2025-01-09T14:32:15Z</td></tr>
                            <tr><td class="field-highlight">xdm.source.ipv4</td><td class="value-highlight">192.168.1.100</td></tr>
                            <tr><td class="field-highlight">xdm.target.ipv4</td><td class="value-highlight">8.8.8.8</td></tr>
                            <tr><td class="field-highlight">xdm.target.port</td><td class="value-highlight">53</td></tr>
                            <tr><td class="field-highlight">xdm.source.user.username</td><td class="value-highlight">contoso\jsmith</td></tr>
                            <tr><td class="field-highlight">xdm.network.rule</td><td class="value-highlight">Allow_DNS</td></tr>
                            <tr><td class="field-highlight">xdm.event.outcome</td><td class="value-highlight">SUCCESS</td></tr>
                            <tr><td class="field-highlight">xdm.event.type</td><td class="value-highlight">NETWORK</td></tr>
                        </table>
                    </div>
                    <h4>Step 6: XQL Query</h4>
                    <div class="arch-diagram">
                        <div class="code-header">
                            <span class="code-lang">XQL</span>
                            <span class="code-title">Threat Hunting Query</span>
                        </div>
                        <pre><code>datamodel
| filter xdm.event.type = "NETWORK"
| filter xdm.event.outcome = XDM_CONST.OUTCOME_FAILED
| comp count() as blocked_count by xdm.source.ipv4, xdm.target.ipv4
| filter blocked_count > 100
| sort desc blocked_count</code></pre>
                    </div>
                </section>
                <!-- Decision Framework Summary -->
                <section class="content-section">
                    <h2><i class="fas fa-balance-scale"></i> Master Decision Framework</h2>
                    <div class="decision-box">
                        <h3>üéØ Quick Decision Matrix</h3>
                        <table class="styled-table">
                            <thead>
                                <tr>
                                    <th>Question</th>
                                    <th>If YES ‚Üí Tier</th>
                                    <th>If NO ‚Üí Continue</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Do analytics rules need this data?</td>
                                    <td><strong>Analytics / Hot</strong></td>
                                    <td>‚Üì</td>
                                </tr>
                                <tr>
                                    <td>Is this used for real-time correlation?</td>
                                    <td><strong>Analytics / Hot</strong></td>
                                    <td>‚Üì</td>
                                </tr>
                                <tr>
                                    <td>Queried daily for investigations?</td>
                                    <td><strong>Analytics / Warm</strong></td>
                                    <td>‚Üì</td>
                                </tr>
                                <tr>
                                    <td>Occasional queries for forensics?</td>
                                    <td><strong>Basic / Cold</strong></td>
                                    <td>‚Üì</td>
                                </tr>
                                <tr>
                                    <td>Required only for compliance?</td>
                                    <td><strong>Auxiliary / Frozen</strong></td>
                                    <td>‚Üì</td>
                                </tr>
                                <tr>
                                    <td>High volume, low security value?</td>
                                    <td><strong>Filter at ingestion or don't collect</strong></td>
                                    <td>Reassess need</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                <!-- Interview Section -->
                <section class="content-section interview-section">
                    <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                    <div class="qa-section">
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you approach data retention strategy for a SIEM deployment? Walk me through your decision process.</button>
                            <div class="qa-answer">
                                <p>My approach to retention strategy starts with understanding the operational and compliance requirements, then optimizing for cost without sacrificing security capability. I work through a structured process that considers data value, query patterns, and budget constraints.</p>
                                <p>First, I categorize data sources by their security value and query frequency. High-value data that powers detection rules‚Äîlike authentication events, endpoint telemetry, and firewall logs‚Äîneeds to be in the hot/analytics tier for real-time correlation. This is non-negotiable because detection rules require fast access. I typically keep security-critical data in the analytics tier for 90-180 days depending on the organization's investigation practices.</p>
                                <p>Next, I identify the high-volume, lower-value data that can move to cheaper tiers. Things like verbose network flow data, container logs, or debug-level application logs often fall into this category. These might only be needed for forensic investigation after an incident is identified, so they can live in basic or cold storage where queries are slower but storage is cheaper. I've seen organizations reduce their SIEM costs by 40-50% just by properly tiering their data.</p>
                                <p>Compliance requirements drive the longest retention periods. If we need to keep audit logs for 7 years for SOX or PCI, that data goes to archive or auxiliary tiers where it's cheap to store but expensive to query. The key is ensuring we can restore and search it if needed for an audit or legal matter, even if it takes hours to retrieve.</p>
                                <p>Finally, I build the technical implementation‚Äîconfiguring index retention policies in Splunk, table plans in Sentinel, or dataset settings in XSIAM. I also set up monitoring for data volumes and costs so we can adjust the strategy as the environment evolves.</p>
                            </div>
                        </div>
                        
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Compare the storage tier models between Sentinel, Splunk, and XSIAM. What are the key differences?</button>
                            <div class="qa-answer">
                                <p>Each platform has a different philosophy on storage tiers, which reflects their architectural origins and pricing models.</p>
                                <p>Microsoft Sentinel uses table-level tiers with Analytics, Basic, and the new Auxiliary logs. Analytics is full-featured with rule support and fast queries. Basic is about 80% cheaper on ingestion but limits you to 8-day lookback and no analytics rules‚Äîit's basically for compliance data you rarely search. Auxiliary, coming in 2025, will be even cheaper for massive volumes. Sentinel's model is simple but somewhat inflexible‚Äîyou pick a tier per table, and changing it affects all data in that table.</p>
                                <p>Splunk uses the classic hot/warm/cold/frozen bucket model, which is more granular but operationally complex. Data automatically ages through tiers based on time and volume thresholds you configure in indexes.conf. The advantage is fine-grained control‚Äîyou can have different policies per index. The complexity is that you need to manage storage paths, monitor bucket counts, and plan capacity carefully. SmartStore in cloud deployments simplifies this by automatically tiering to object storage.</p>
                                <p>XSIAM takes a cloud-native approach with Online storage and Archive. It's the simplest model operationally‚Äîyou set retention per dataset and the platform handles the rest. The trade-off is less granularity compared to Splunk. XSIAM also has Data Lake Export for customers who want to own their data long-term in Snowflake or Databricks, which is unique among the three.</p>
                                <p>When I'm advising organizations, I consider their operational maturity. Splunk offers the most control but requires the most expertise. Sentinel is in the middle with a balance of features and simplicity. XSIAM is the most hands-off but also the least customizable. The right choice depends on the team's capabilities and how much time they want to spend on data management versus security operations.</p>
                            </div>
                        </div>
                        
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: You're asked to reduce SIEM costs by 30% without losing critical detection capability. How do you approach this?</button>
                            <div class="qa-answer">
                                <p>This is a common ask, and it requires a data-driven approach. I start by analyzing what we're actually ingesting, how much it costs, and what value it provides. You'd be surprised how often organizations are collecting data they never query.</p>
                                <p>First, I pull volume reports by data source. In Splunk that's the License Usage Report, in Sentinel it's the Usage blade, in XSIAM it's the Data Usage dashboard. I sort by volume to find the biggest contributors‚Äîthis is where the money is. Typically, a few sources account for 60-70% of the total volume.</p>
                                <p>Next, I assess each high-volume source against three criteria: Is it used in detection rules? Is it queried regularly for investigations? Is it required for compliance? If a source fails all three, we can consider dropping it entirely. If it passes the compliance check but not the others, we move it to a cheaper tier.</p>
                                <p>For sources we keep, I look at filtering opportunities. Network flow logs are a classic example‚Äîdo we need every internal-to-internal connection, or can we filter to only internet-facing traffic and blocked connections? Windows Security logs often have verbose audit categories enabled that nobody uses‚ÄîEvent IDs in the 4600s and 4700s for object access logging can generate massive volume with limited security value.</p>
                                <p>I also examine whether we're over-retaining. If we're keeping network logs for 90 days in the analytics tier but only query them for the last 7 days, we can reduce online retention and archive older data. The storage cost difference between tiers can be 5-10x.</p>
                                <p>The key is getting stakeholder buy-in before making changes. I document the proposed changes, the expected savings, and any capability impact. I also recommend starting with one change at a time and measuring the impact before proceeding to the next.</p>
                            </div>
                        </div>
                        
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What happens when you need to query archived or frozen data? Walk me through the process.</button>
                            <div class="qa-answer">
                                <p>Querying archived data is fundamentally different from hot data‚Äîit's designed for rare, targeted access rather than exploratory searches. The process varies by platform, but the concept is similar: you need to restore or rehydrate the data before querying.</p>
                                <p>In Splunk with frozen data, you use the "thaw" process. You identify the time range you need, locate the frozen bucket files (usually in your coldToFrozenDir path or S3 for SmartStore), and copy them to the thawedPath for your index. Then you restart Splunk or run a command to rebuild the bucket. The data becomes searchable but only in that thawed location. It's manual and time-consuming‚ÄîI've seen restores take hours for large time ranges.</p>
                                <p>Sentinel uses Search Jobs for archived data. You go to the Logs blade, click "Search jobs," and submit an asynchronous query that runs against archived tables. The job can take minutes to hours depending on data volume and query complexity. Results are delivered to a new table you can then query normally. It's more user-friendly than Splunk's approach but still much slower than interactive queries.</p>
                                <p>XSIAM's archive restore is similar in concept‚Äîyou submit a restore request for a dataset and time range, wait for it to complete (usually minutes, not hours), and then the data is temporarily available for querying in the online tier. Palo Alto has invested in making this faster than traditional SIEM archive access.</p>
                                <p>The practical implication is that you need to plan ahead for forensic investigations. If an incident might need archived data, start the restore immediately‚Äîdon't wait until you've exhausted online data and then discover you need another 4 hours for the archive query. I also recommend documenting the restore process and practicing it during tabletop exercises so the team isn't figuring it out during a real incident.</p>
                            </div>
                        </div>
                        
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle compliance requirements that mandate multi-year retention when your SIEM is expensive to store data long-term?</button>
                            <div class="qa-answer">
                                <p>This is where you need to think beyond the SIEM as the sole storage solution. SIEMs are optimized for security analytics, not long-term archival storage, and trying to use them for 7-year compliance retention gets expensive fast.</p>
                                <p>My recommended approach is to use the SIEM for operational retention‚Äîtypically 90 days to 1 year depending on the data type‚Äîand then export to cheaper long-term storage for compliance. For Splunk, this means configuring coldToFrozenDir to archive to S3 or Azure Blob with appropriate lifecycle policies. For Sentinel, you can use Data Export Rules to continuously stream data to a storage account. XSIAM has native Data Lake Export to Snowflake, Databricks, or your own storage.</p>
                                <p>The key is maintaining searchability for compliance audits even with archived data. I configure the archive storage with a structure that makes it possible to find specific time ranges and data types‚Äîtypically partitioned by date and source. I also document the archive location, retention policies, and restore procedures so that when an auditor asks for data from 3 years ago, we can retrieve it.</p>
                                <p>For regulatory frameworks like PCI, SOX, or HIPAA, I work with the compliance team to understand exactly what data needs to be retained and for how long. Often the requirement is for audit logs and authentication events, not necessarily every piece of telemetry the SIEM collects. By scoping the compliance requirement precisely, we can minimize what needs expensive long-term retention.</p>
                                <p>I also recommend testing the archive and restore process annually. I've seen organizations discover during an audit that their 5-year-old archive isn't actually readable because the format changed or the restore procedure wasn't documented. A yearly fire drill where you restore and query archived data catches these issues before they become problems.</p>
                            </div>
                        </div>
                        
                        <div class="qa-item">
                            <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Explain Splunk bucket mechanics‚Äîwhat triggers data to roll from hot to warm to cold?</button>
                            <div class="qa-answer">
                                <p>Splunk's bucket lifecycle is driven by a combination of size, time, and count thresholds that you configure per index. Understanding these mechanics is essential for capacity planning and troubleshooting.</p>
                                <p>Hot buckets are actively receiving data. They roll to warm when any of these conditions are met: the bucket size exceeds maxDataSize (default is "auto" which means about 750MB), the bucket age exceeds maxHotSpanSecs (default 7776000 seconds or 90 days), or Splunk restarts. There's also maxHotBuckets which limits how many hot buckets can exist simultaneously per index‚Äîif you hit this limit, the oldest hot bucket rolls to warm.</p>
                                <p>Warm buckets are read-only and stay on primary storage. They roll to cold when the number of warm buckets exceeds maxWarmDBCount (default 300). This is a count threshold, not time-based, which can be counterintuitive. It means a high-volume index will roll to cold faster than a low-volume one, even if the data is the same age.</p>
                                <p>Cold buckets stay until either frozenTimePeriodInSecs is reached (the age of the data) or the cold path volume fills up. At that point, buckets either get deleted (if coldToFrozenDir isn't set) or archived to the frozen path. In SmartStore deployments, the cold tier effectively lives in object storage with local caching, which changes the mechanics somewhat.</p>
                                <p>When I'm troubleshooting retention issues‚Äîlike data disappearing earlier than expected‚ÄîI check these settings in indexes.conf and compare to the actual bucket inventory using dbinspect or the monitoring console. Common issues include misconfigured volume limits, unexpected bucket counts from burst ingestion, or coldToFrozenDir not being set when people assumed data would be archived.</p>
                            </div>
                        </div>
                    </div>
                </section>
                </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>