<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Response | XSIAM Detection & Response</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <div class="sidebar-section">
                <div class="sidebar-section-title">Detection & Response</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"><a href="xdr-overview.html" class="sidebar-nav-link"><i class="fas fa-shield-virus"></i><span>XDR & Detection</span></a></li>
                    <li class="sidebar-nav-item"><a href="correlation-rules.html" class="sidebar-nav-link"><i class="fas fa-project-diagram"></i><span>Correlation Rules</span></a></li>
                    <li class="sidebar-nav-item"><a href="alert-management.html" class="sidebar-nav-link"><i class="fas fa-bell"></i><span>Alert Management</span></a></li>
                    <li class="sidebar-nav-item"><a href="incident-response.html" class="sidebar-nav-link active"><i class="fas fa-ambulance"></i><span>Incident Response</span></a></li>
                    <li class="sidebar-nav-item"><a href="threat-hunting.html" class="sidebar-nav-link"><i class="fas fa-crosshairs"></i><span>Threat Hunting</span></a></li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
        
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">XSIAM</a>
                    <span class="separator">/</span>
                    <span class="current">Incident Response</span>
                </div>

                <h1><i class="fas fa-ambulance"></i> Incident Response</h1>
                <p class="lead">Comprehensive incident response workflows, containment procedures, investigation playbooks, and response actions using XSIAM's integrated capabilities.</p>

                <!-- IR Framework -->
                <h2><i class="fas fa-sitemap"></i> XSIAM Incident Response Framework</h2>
                
                <div class="flow-diagram">
                    <div class="flow-diagram-title"><i class="fas fa-project-diagram"></i> NIST-Aligned IR Process in XSIAM</div>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 16px;">
                        <div class="flow-step" style="background: #1c3a5e; border-color: #58a6ff;">
                            <div class="flow-icon"><i class="fas fa-bell"></i></div>
                            <div class="flow-content">
                                <strong>1. Detection</strong>
                                <ul>
                                    <li>XDR analytics detect threat</li>
                                    <li>Correlation rules fire</li>
                                    <li>Alert → Incident creation</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #3d2a5e; border-color: #a371f7;">
                            <div class="flow-icon"><i class="fas fa-search"></i></div>
                            <div class="flow-content">
                                <strong>2. Analysis</strong>
                                <ul>
                                    <li>Causality chain review</li>
                                    <li>Scope determination</li>
                                    <li>Impact assessment</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #4d1a1a; border-color: #f85149;">
                            <div class="flow-icon"><i class="fas fa-ban"></i></div>
                            <div class="flow-content">
                                <strong>3. Containment</strong>
                                <ul>
                                    <li>Endpoint isolation</li>
                                    <li>User account disable</li>
                                    <li>Network blocking</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #4d3a0d; border-color: #d29922;">
                            <div class="flow-icon"><i class="fas fa-broom"></i></div>
                            <div class="flow-content">
                                <strong>4. Eradication</strong>
                                <ul>
                                    <li>Malware removal</li>
                                    <li>Persistence cleanup</li>
                                    <li>Credential reset</li>
                                </ul>
                            </div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step" style="background: #1a4d2e; border-color: #3fb950;">
                            <div class="flow-icon"><i class="fas fa-undo"></i></div>
                            <div class="flow-content">
                                <strong>5. Recovery</strong>
                                <ul>
                                    <li>Unisolate endpoints</li>
                                    <li>Re-enable accounts</li>
                                    <li>Validate clean state</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Response Actions -->
                <h2><i class="fas fa-bolt"></i> Response Actions Reference</h2>
                
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Action</th>
                            <th>Scope</th>
                            <th>Impact</th>
                            <th>Reversible</th>
                            <th>Approval</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong style="color: #f85149;">Endpoint Isolation</strong></td>
                            <td>Single endpoint</td>
                            <td>High - blocks all network</td>
                            <td>✅ Yes</td>
                            <td>L2/L3 Analyst</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #d29922;">Kill Process</strong></td>
                            <td>Single process</td>
                            <td>Medium - terminates process</td>
                            <td>❌ No (can restart)</td>
                            <td>L1+ Analyst</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #a371f7;">Quarantine File</strong></td>
                            <td>Single file</td>
                            <td>Low - moves to vault</td>
                            <td>✅ Yes</td>
                            <td>L1+ Analyst</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #58a6ff;">Block Hash</strong></td>
                            <td>All endpoints</td>
                            <td>Medium - prevents execution</td>
                            <td>✅ Yes</td>
                            <td>L2+ Analyst</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #3fb950;">Scan Endpoint</strong></td>
                            <td>Single/Multiple</td>
                            <td>Low - detection only</td>
                            <td>N/A</td>
                            <td>L1+ Analyst</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #f85149;">Disable User (via SOAR)</strong></td>
                            <td>Identity</td>
                            <td>High - blocks all access</td>
                            <td>✅ Yes</td>
                            <td>IR Lead + Manager</td>
                        </tr>
                    </tbody>
                </table>

                <!-- Containment Decision Tree -->
                <h2><i class="fas fa-code-branch"></i> Containment Decision Tree</h2>
                
                <div class="decision-tree">
                    <div class="decision-node question">
                        <strong>Confirmed Malicious Activity on Endpoint</strong>
                        <div style="color: #8b949e; font-size: 0.85rem;">Threat validated, not false positive</div>
                    </div>
                    <div class="decision-arrow">↓</div>
                    <div class="decision-node question">
                        <strong>Is there active command & control or data exfiltration?</strong>
                    </div>
                    <div class="decision-branch">
                        <div>
                            <div class="decision-arrow">↓ YES - Active Threat</div>
                            <div class="decision-node no" style="background: #4d1a1a;">
                                <strong style="color: #f85149;">Immediate Isolation</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Isolate now, investigate later<br>Document business impact</div>
                            </div>
                        </div>
                        <div>
                            <div class="decision-arrow">↓ NO - Historical/Dormant</div>
                            <div class="decision-node question">
                                <strong>Is the endpoint business-critical?</strong>
                                <div style="color: #8b949e; font-size: 0.85rem;">Production server, executive, critical system</div>
                            </div>
                            <div class="decision-branch">
                                <div>
                                    <div class="decision-arrow">↓ YES - Critical</div>
                                    <div class="decision-node" style="background: #4d3a0d; border-color: #d29922;">
                                        <strong style="color: #d29922;">Coordinate Containment</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">Notify stakeholders first<br>Schedule isolation window<br>Prepare backup access</div>
                                    </div>
                                </div>
                                <div>
                                    <div class="decision-arrow">↓ NO - Standard</div>
                                    <div class="decision-node" style="background: #1c3a5e; border-color: #58a6ff;">
                                        <strong style="color: #58a6ff;">Standard Containment</strong>
                                        <div style="color: #8b949e; font-size: 0.85rem;">Isolate endpoint<br>Kill malicious processes<br>Quarantine files</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Investigation Queries -->
                <h2><i class="fas fa-terminal"></i> Investigation Queries</h2>
                
                <div class="config-section">
                    <h4>Scope Assessment Queries</h4>
                    <div class="arch-diagram"># Query 1: Find all endpoints with same malware hash
# ═══════════════════════════════════════════════════════════════
dataset = xdr_data
| filter _time > now() - 7d
| filter action_file_sha256 = "MALWARE_HASH_HERE"
| comp earliest(_time) as first_seen, 
        latest(_time) as last_seen,
        count() as occurrences
  by endpoint_name, endpoint_id
| sort first_seen asc

# Query 2: Lateral movement from compromised endpoint
# ═══════════════════════════════════════════════════════════════
dataset = xdr_data
| filter _time > now() - 24h
| filter src_endpoint_name = "COMPROMISED_HOST"
| filter event_type in ("NETWORK_CONNECTION", "REMOTE_SESSION")
| filter dst_ip != src_ip
| comp count() as connections by dst_ip, dst_endpoint_name, action_remote_port
| sort connections desc

# Query 3: Timeline of attacker activity
# ═══════════════════════════════════════════════════════════════
dataset = xdr_data
| filter _time > now() - 7d
| filter endpoint_name = "COMPROMISED_HOST"
| filter action_process_image_name in ("powershell.exe", "cmd.exe", "wscript.exe", "cscript.exe", "mshta.exe")
| fields _time, action_process_image_name, action_process_command_line, actor_process_image_name
| sort _time asc

# Query 4: Data exfiltration indicators
# ═══════════════════════════════════════════════════════════════
dataset = xdr_data
| filter _time > now() - 24h
| filter endpoint_name = "COMPROMISED_HOST"
| filter action_network_connection_bytes_sent > 10000000  // >10MB
| comp sum(action_network_connection_bytes_sent) as total_bytes by dst_ip, action_remote_port
| alter total_mb = divide(total_bytes, 1048576)
| sort total_mb desc</div>
                </div>

                <!-- Incident Severity Matrix -->
                <h2><i class="fas fa-exclamation-triangle"></i> Incident Severity Matrix</h2>
                
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Severity</th>
                            <th>Criteria</th>
                            <th>Response Time</th>
                            <th>Escalation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #4d1a1a;">
                            <td><strong style="color: #f85149;">P1 - Critical</strong></td>
                            <td>Active breach, data exfil, ransomware, executive compromise</td>
                            <td>15 minutes</td>
                            <td>CISO, Legal, Exec team immediately</td>
                        </tr>
                        <tr style="background: #4d3a0d;">
                            <td><strong style="color: #d29922;">P2 - High</strong></td>
                            <td>Confirmed malware, C2 detected, credential theft</td>
                            <td>1 hour</td>
                            <td>Security Manager within 2 hours</td>
                        </tr>
                        <tr style="background: #1c3a5e;">
                            <td><strong style="color: #58a6ff;">P3 - Medium</strong></td>
                            <td>Suspicious activity, policy violation, potential threat</td>
                            <td>4 hours</td>
                            <td>Team lead if unresolved in 24 hours</td>
                        </tr>
                        <tr style="background: #1a4d2e;">
                            <td><strong style="color: #3fb950;">P4 - Low</strong></td>
                            <td>Low-risk findings, informational alerts</td>
                            <td>24 hours</td>
                            <td>Standard workflow</td>
                        </tr>
                    </tbody>
                </table>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through how you would handle a confirmed ransomware incident in XSIAM.</button>
                        <div class="qa-answer">
                            <p>Ransomware is a P1 critical incident requiring immediate coordinated response. Speed matters because encryption can spread rapidly, but so does precision - isolating the wrong systems causes unnecessary business impact.</p>
                            
                            <p>In the first five minutes, I focus on containment. Use XSIAM's endpoint isolation feature to immediately isolate confirmed infected endpoints - this blocks all network traffic except to XSIAM, stopping lateral spread and C2 communication. Simultaneously, I'd pull the causality chain to understand the initial infection vector and identify all endpoints showing the same indicators. If the ransomware hash is known, push a global block rule immediately.</p>
                            
                            <p>For scope assessment, I run XQL queries to find every endpoint that has seen the ransomware file hash, any associated C2 domains, or the same initial access technique. Ransomware often has a dwell time before detonation - the attacker may have been in the environment for days. Query for the earliest appearance of IOCs and work forward from there. Identify all potentially compromised endpoints, not just those actively encrypting.</p>
                            
                            <p>Communication and escalation happen in parallel. This is a P1 - page the IR lead immediately, notify the CISO, and prepare for potential legal and regulatory notification requirements. Stand up a war room or bridge call. Business stakeholders need to know which systems are isolated and for how long.</p>
                            
                            <p>Eradication involves using XSIAM's response actions to kill malicious processes, quarantine ransomware files, and remove persistence mechanisms. But don't just clean up visible artifacts - look for backdoors the attacker may have planted for re-entry. After cleanup, scan all endpoints to confirm eradication.</p>
                            
                            <p>Recovery requires validation. Before unisolating any endpoint, confirm it's clean through deep scans and behavioral monitoring. Restore from backups if necessary. Monitor closely for 48-72 hours after recovery for any signs of reinfection. Finally, conduct a thorough post-incident review to understand how the attacker got in and improve defenses.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: When would you choose to isolate an endpoint versus other containment options?</button>
                        <div class="qa-answer">
                            <p>Endpoint isolation is the most impactful containment action - it completely severs network connectivity except for the agent's connection to XSIAM. This makes it highly effective but also disruptive. My decision framework balances threat severity against business impact.</p>
                            
                            <p>I immediately isolate for confirmed active threats: active C2 communication, ongoing data exfiltration, ransomware execution in progress, or any situation where the attacker has real-time control. In these cases, stopping the threat outweighs any business disruption. The endpoint can't be trusted while an attacker has access - even a production server should be isolated rather than allowing continued compromise.</p>
                            
                            <p>For historical or dormant threats - like malware that ran weeks ago but isn't currently active - I have more flexibility. If it's a regular workstation, I'd still isolate and investigate without much concern. But if it's a critical production server or executive laptop during an important meeting, I might choose targeted containment first: kill the malicious process, quarantine the malware file, block the C2 domain at the network level. This contains the immediate threat while allowing time to schedule full isolation and investigation.</p>
                            
                            <p>I avoid isolation for low-confidence detections that might be false positives. Isolating an endpoint is very visible to the user and disruptive to their work. If I'm not confident the threat is real, I'd use less disruptive investigation first - pull forensic data, run scans, validate the detection - before cutting network access.</p>
                            
                            <p>There's also a middle ground with selective network blocking. If the threat is communicating with a specific C2 server, blocking that destination at the firewall or endpoint might be sufficient containment while allowing legitimate business traffic. XSIAM's block rules can prevent specific process behaviors without full isolation.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you determine the full scope of an incident using XSIAM?</button>
                        <div class="qa-answer">
                            <p>Scope determination is critical - you can't contain what you haven't found. XSIAM provides excellent tools for this through its unified data model and causality chains, but you need a systematic approach.</p>
                            
                            <p>Start with the causality chain of the initial alert. This shows the process tree - what spawned what, what files were created, what network connections were made. Expand outward from there: every file hash, every C2 domain, every technique becomes a pivot point for broader queries. If malware created a file with hash X, query for that hash across all endpoints. If it connected to domain Y, find every endpoint that's contacted that domain.</p>
                            
                            <p>Use time as a dimension. Find the earliest indicator of compromise - often earlier than when the alert fired. Query backward in time from that point: how did the attacker get initial access? Was it phishing, exploitation, credential theft? The initial access point often reveals additional compromised systems. Query forward from first compromise: what did the attacker do after gaining access? Map their entire activity timeline.</p>
                            
                            <p>Look for lateral movement indicators. Query for authentication events from compromised accounts, remote execution tools like PSExec or WMI, file copies between systems, and network connections from compromised hosts to other internal systems. Each new system you identify needs the same investigation - it may have its own lateral movement to other hosts.</p>
                            
                            <p>Don't forget identity scope. If an attacker compromised user credentials, find everywhere those credentials were used - not just the initial compromised endpoint. Query authentication logs, VPN access, cloud service logins. A compromised password might have been used from multiple locations.</p>
                            
                            <p>Finally, validate your scope with negative queries. Once you think you've found everything, construct queries to prove it. "Are there any other endpoints with these IOCs that I haven't already identified?" "Are there any other accounts that accessed these compromised systems?" Scope determination isn't complete until you're confident you've found the boundaries.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
    </script>
</body>
</html>
