<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sensor Deployment | CrowdStrike Falcon</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">CrowdStrike Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="fundamentals.html" class="nav-link"><i class="fas fa-book"></i> Fundamentals</a>
                    <a href="sensor-deployment.html" class="nav-link active"><i class="fas fa-download"></i> Sensor Deployment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="ioa-rules.html" class="nav-link"><i class="fas fa-code"></i> IOA Rules</a>
                    <a href="detection-tuning.html" class="nav-link"><i class="fas fa-sliders-h"></i> Detection Tuning</a>
                    <a href="falcon-intelligence.html" class="nav-link"><i class="fas fa-brain"></i> Falcon Intelligence</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Investigation</div>
                    <a href="threat-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Hunting</a>
                    <a href="incident-management.html" class="nav-link"><i class="fas fa-clipboard-list"></i> Incident Management</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Response</div>
                    <a href="response-actions.html" class="nav-link"><i class="fas fa-bolt"></i> Response Actions</a>
                    <a href="rtr.html" class="nav-link"><i class="fas fa-terminal"></i> Real Time Response</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">CrowdStrike</a><span class="separator">/</span>
                    <span class="current">Sensor Deployment</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-download"></i> Sensor Deployment</h1>
                <p class="lead">Deploy CrowdStrike Falcon sensors across your enterprise. Learn installation methods, group policies, and deployment best practices.</p>

                <!-- Sensor Overview -->
                <h2><i class="fas fa-info-circle"></i> Sensor Overview</h2>
                <div class="config-section">
                    <p><span class="console-path">Host setup and management → Sensor downloads</span></p>

                    <h4>Sensor Capabilities</h4>
                    <div class="code-block">Falcon Sensor Features:

DETECTION:
├── Real-time process monitoring
├── Network connection tracking
├── File system monitoring
├── Registry monitoring (Windows)
├── Kernel-level visibility
└── ML-based malware detection

PREVENTION:
├── Malware blocking
├── Exploit prevention
├── Script control
├── Behavioral blocking
└── Ransomware protection

VISIBILITY:
├── Process trees
├── Network connections
├── File modifications
├── User context
├── Threat intelligence correlation
└── MITRE ATT&CK mapping</div>

                    <h4>Supported Platforms</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Platform</th><th>Versions</th><th>Architecture</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Windows</strong></td><td>7 SP1+, Server 2008 R2+, 10, 11, Server 2016-2022</td><td>x64</td></tr>
                            <tr><td><strong>macOS</strong></td><td>10.15+ (Catalina and later)</td><td>Intel, Apple Silicon</td></tr>
                            <tr><td><strong>Linux</strong></td><td>RHEL 6+, Ubuntu 16.04+, Amazon Linux, SUSE</td><td>x64, ARM64</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Windows Deployment -->
                <h2><i class="fab fa-windows"></i> Windows Deployment</h2>
                <div class="config-section">
                    <h4>Manual Installation</h4>
                    <div class="code-block"># Download sensor from Falcon console
# Host setup and management → Sensor downloads

# Silent install with CID
WindowsSensor.exe /install /quiet /norestart CID=<YOUR_CID>

# With proxy
WindowsSensor.exe /install /quiet /norestart CID=<YOUR_CID> APP_PROXYNAME=proxy.domain.com APP_PROXYPORT=8080

# With provisioning token (for new CIDs)
WindowsSensor.exe /install /quiet /norestart CID=<YOUR_CID> ProvToken=<TOKEN>

# Uninstall
WindowsSensor.exe /uninstall /quiet

# Uninstall with maintenance token (if required)
WindowsSensor.exe /uninstall /quiet MAINTENANCE_TOKEN=<TOKEN></div>

                    <h4>SCCM/MECM Deployment</h4>
                    <div class="code-block">SCCM Deployment Steps:

1. CREATE APPLICATION
   Software Library → Applications → Create Application
   ├── Type: Windows Installer (MSI or script)
   ├── Content location: \\server\share\CrowdStrike\
   └── Install command: WindowsSensor.exe /install /quiet /norestart CID=<CID>

2. DETECTION METHOD
   ├── File system: C:\Windows\System32\drivers\CrowdStrike\csagent.sys
   └── Or Registry: HKLM\SYSTEM\CrowdStrike\{9b03c1d9-...}\AgentID

3. DEPLOYMENT
   ├── Collection: Target device collection
   ├── Purpose: Required
   ├── Schedule: As soon as possible
   └── Maintenance window: Respect or override

4. MONITORING
   Monitoring → Deployments → Filter by application</div>

                    <h4>Group Policy Deployment</h4>
                    <div class="code-block">GPO Startup Script Method:

1. Create network share for installer
   \\dc\NETLOGON\CrowdStrike\WindowsSensor.exe

2. Create PowerShell deployment script:

# deploy-falcon.ps1
$installerPath = "\\dc\NETLOGON\CrowdStrike\WindowsSensor.exe"
$cid = "YOUR_CID_HERE"
$logPath = "C:\Windows\Temp\falcon_install.log"

# Check if already installed
$service = Get-Service -Name "CSFalconService" -ErrorAction SilentlyContinue
if ($service) {
    Write-Output "Falcon already installed" | Out-File $logPath
    exit 0
}

# Install
Start-Process -FilePath $installerPath -ArgumentList "/install /quiet /norestart CID=$cid" -Wait

3. GPO Configuration:
   Computer Configuration → Policies → Windows Settings → 
   Scripts → Startup → Add PowerShell script</div>
                </div>

                <!-- Linux Deployment -->
                <h2><i class="fab fa-linux"></i> Linux Deployment</h2>
                <div class="config-section">
                    <div class="code-block"># RHEL/CentOS Installation
sudo yum install falcon-sensor-<version>.rpm
sudo /opt/CrowdStrike/falconctl -s --cid=<YOUR_CID>
sudo systemctl start falcon-sensor
sudo systemctl enable falcon-sensor

# Ubuntu/Debian Installation  
sudo dpkg -i falcon-sensor_<version>_amd64.deb
sudo /opt/CrowdStrike/falconctl -s --cid=<YOUR_CID>
sudo systemctl start falcon-sensor
sudo systemctl enable falcon-sensor

# With proxy
sudo /opt/CrowdStrike/falconctl -s --cid=<YOUR_CID> --apd=proxy.domain.com --aph=8080

# Verify installation
sudo /opt/CrowdStrike/falconctl -g --cid
sudo systemctl status falcon-sensor

# Uninstall
# RHEL: sudo yum remove falcon-sensor
# Ubuntu: sudo dpkg -r falcon-sensor</div>

                    <h4>Ansible Deployment</h4>
                    <div class="code-block"># falcon-deploy.yml
---
- name: Deploy CrowdStrike Falcon Sensor
  hosts: all
  become: yes
  vars:
    falcon_cid: "YOUR_CID_HERE"
    falcon_package: "falcon-sensor-6.x.x.rpm"
    
  tasks:
    - name: Copy Falcon sensor package
      copy:
        src: "files/{{ falcon_package }}"
        dest: "/tmp/{{ falcon_package }}"
        
    - name: Install Falcon sensor (RHEL)
      yum:
        name: "/tmp/{{ falcon_package }}"
        state: present
      when: ansible_os_family == "RedHat"
      
    - name: Configure CID
      command: /opt/CrowdStrike/falconctl -s --cid={{ falcon_cid }}
      
    - name: Start and enable Falcon service
      systemd:
        name: falcon-sensor
        state: started
        enabled: yes
        
    - name: Verify Falcon is running
      command: /opt/CrowdStrike/falconctl -g --cid
      register: falcon_status
      
    - debug:
        var: falcon_status.stdout</div>
                </div>

                <!-- macOS Deployment -->
                <h2><i class="fab fa-apple"></i> macOS Deployment</h2>
                <div class="config-section">
                    <div class="code-block"># Manual Installation
# Download FalconSensorMacOS.pkg from console

# Install with CID
sudo installer -pkg FalconSensorMacOS.pkg -target /
sudo /Applications/Falcon.app/Contents/Resources/falconctl license <YOUR_CID>

# With provisioning token
sudo /Applications/Falcon.app/Contents/Resources/falconctl license <YOUR_CID> <PROV_TOKEN>

# Verify
sudo /Applications/Falcon.app/Contents/Resources/falconctl stats

# Required: Approve System Extensions
System Preferences → Security & Privacy → Allow CrowdStrike

# Required: Grant Full Disk Access
System Preferences → Security & Privacy → Privacy → Full Disk Access
Add: /Applications/Falcon.app</div>

                    <h4>Jamf Deployment</h4>
                    <div class="code-block">Jamf Pro Deployment:

1. UPLOAD PACKAGE
   Settings → Packages → New
   Upload FalconSensorMacOS.pkg

2. CREATE POLICY
   Policies → New
   ├── General: Name "Deploy CrowdStrike"
   ├── Packages: Add FalconSensorMacOS.pkg
   ├── Files and Processes: Run script (post-install)
   └── Scope: Target computers/groups

3. POST-INSTALL SCRIPT
#!/bin/bash
CID="YOUR_CID_HERE"
/Applications/Falcon.app/Contents/Resources/falconctl license $CID

4. MDM PROFILE FOR APPROVALS
   Create configuration profile for:
   ├── System Extension approval
   ├── Full Disk Access
   ├── Network Filter
   └── Notifications</div>
                </div>

                <!-- Host Groups -->
                <h2><i class="fas fa-layer-group"></i> Host Groups</h2>
                <div class="config-section">
                    <p><span class="console-path">Host setup and management → Host groups</span></p>

                    <div class="code-block">Host Groups:

PURPOSE:
├── Apply different policies per group
├── Organize by function, location, risk
├── Control sensor settings
└── Staged rollouts

GROUP TYPES:
├── Static: Manual assignment
└── Dynamic: Automatic based on rules

DYNAMIC ASSIGNMENT RULES:
├── Hostname contains "WKS" → Workstations group
├── OS contains "Windows Server" → Servers group
├── OU contains "Finance" → High-Risk group
├── Platform equals "Mac" → macOS group
└── Site equals "NYC" → NYC Office group

POLICY ASSIGNMENT:
├── Prevention policies per group
├── Response policies per group
├── Sensor update policies per group
└── USB device control per group</div>
                </div>

                <!-- Troubleshooting -->
                <h2><i class="fas fa-wrench"></i> Troubleshooting</h2>
                <div class="config-section">
                    <div class="code-block"># Windows - Check sensor status
sc query csagent
Get-Service CSFalconService

# Windows - Check connectivity
Test-NetConnection ts01-b.cloudsink.net -Port 443

# Windows - Logs
C:\Windows\System32\drivers\CrowdStrike\hbfw.log

# Linux - Check status
sudo systemctl status falcon-sensor
sudo /opt/CrowdStrike/falconctl -g --cid
sudo /opt/CrowdStrike/falconctl -g --aid

# Linux - Logs  
sudo journalctl -u falcon-sensor

# macOS - Check status
sudo /Applications/Falcon.app/Contents/Resources/falconctl stats

COMMON ISSUES:

1. SENSOR NOT APPEARING IN CONSOLE
   □ Check CID is correct
   □ Verify network connectivity to CrowdStrike cloud
   □ Check proxy settings
   □ Wait 10-15 minutes for registration

2. SENSOR NOT STARTING
   □ Check system requirements
   □ Verify kernel compatibility (Linux)
   □ Check for conflicting security software
   □ Review installation logs

3. PREVENTION NOT WORKING
   □ Check prevention policy assignment
   □ Verify sensor in correct host group
   □ Check policy is enabled
   □ Review sensor version (update if old)</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you deploy CrowdStrike at scale?</button>
                        <div class="qa-answer">
                            <p>Enterprise deployment methods:</p>
                            <ul>
                                <li><strong>Windows:</strong> SCCM/MECM, Intune, GPO startup scripts</li>
                                <li><strong>Linux:</strong> Ansible, Puppet, Chef, package managers</li>
                                <li><strong>macOS:</strong> Jamf Pro, Kandji, Mosyle with MDM profiles</li>
                            </ul>
                            <p>Key considerations: silent install flags, CID configuration, staged rollout via host groups.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What are host groups and why use them?</button>
                        <div class="qa-answer">
                            <p>Host groups organize endpoints for policy management:</p>
                            <ul>
                                <li>Apply different prevention policies (servers vs workstations)</li>
                                <li>Staged sensor updates (pilot → production)</li>
                                <li>Different response policies by risk level</li>
                                <li>Dynamic groups auto-assign based on hostname, OS, OU</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Sensor installed but not appearing in console - troubleshooting?</button>
                        <div class="qa-answer">
                            <ol>
                                <li>Verify CID is correct (check falconctl output)</li>
                                <li>Test connectivity to CrowdStrike cloud (ts01-b.cloudsink.net:443)</li>
                                <li>Check if proxy is needed and configured</li>
                                <li>Review sensor logs for errors</li>
                                <li>Wait 10-15 minutes for initial check-in</li>
                                <li>Verify no firewall blocking outbound HTTPS</li>
                            </ol>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>