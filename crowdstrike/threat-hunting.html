<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Hunting | CrowdStrike Falcon</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <style>
        .config-section { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; }
        .code-block { background: #0d1117; border: 1px solid #30363d; border-radius: 8px; padding: 16px; margin: 12px 0; font-family: 'Fira Code', monospace; font-size: 0.85rem; overflow-x: auto; white-space: pre; }
        .console-path { background: #0d1117; padding: 8px 12px; border-radius: 4px; font-family: monospace; font-size: 0.85rem; color: #f85149; margin: 8px 0; display: inline-block; }
        .mitre-tag { background: #1f6feb; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; color: white; margin-right: 4px; }
        .hunt-card { background: #161b22; border: 1px solid #30363d; border-radius: 8px; padding: 20px; margin: 16px 0; border-left: 4px solid #f85149; }
    </style>
</head>
<body>
    <div class="app-container">
                                                                                <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">CrowdStrike Falcon</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="sensor-deployment.html" class="nav-link"><i class="fas fa-download"></i> Sensor Deployment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection</div>
                    <a href="ioa-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> IOA Custom Rules</a>
                    <a href="detection-tuning.html" class="nav-link"><i class="fas fa-sliders-h"></i> Detection Tuning</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Hunting & Response</div>
                    <a href="threat-hunting.html" class="nav-link active"><i class="fas fa-search"></i> Threat Hunting</a>
                    <a href="rtr.html" class="nav-link"><i class="fas fa-terminal"></i> Real Time Response</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">CrowdStrike</a><span class="separator">/</span>
                    <span class="current">Threat Hunting</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-crosshairs"></i> Threat Hunting in CrowdStrike Falcon</h1>
                <p class="lead">Proactively search for threats using CrowdStrike Falcon's Event Search and Investigate features. Access endpoint telemetry with Splunk-like query syntax.</p>

                <!-- Accessing Threat Hunting -->
                <h2><i class="fas fa-terminal"></i> Accessing Threat Hunting</h2>
                <div class="config-section">
                    <p><span class="console-path">Falcon Console → Investigate → Event Search</span></p>
                    <p style="color: #8b949e;">Alternative: <span class="console-path">Endpoint Security → Investigate</span></p>
                    
                    <h4>Key Event Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event Type</th><th>Description</th><th>Key Fields</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ProcessRollup2</td>
                                <td>Process execution events</td>
                                <td>FileName, CommandLine, ParentBaseFileName</td>
                            </tr>
                            <tr>
                                <td>NetworkConnectIP4</td>
                                <td>IPv4 network connections</td>
                                <td>RemoteAddressIP4, RemotePort, LocalPort</td>
                            </tr>
                            <tr>
                                <td>NetworkConnectIP6</td>
                                <td>IPv6 network connections</td>
                                <td>RemoteAddressIP6, RemotePort</td>
                            </tr>
                            <tr>
                                <td>DnsRequest</td>
                                <td>DNS queries</td>
                                <td>DomainName, RequestType</td>
                            </tr>
                            <tr>
                                <td>FileWritten</td>
                                <td>File creation/modification</td>
                                <td>FileName, FilePath, SHA256HashData</td>
                            </tr>
                            <tr>
                                <td>RegistryOperationUpdate</td>
                                <td>Registry modifications</td>
                                <td>RegistryPath, RegistryValue</td>
                            </tr>
                            <tr>
                                <td>UserLogon</td>
                                <td>User authentication</td>
                                <td>UserName, LogonType, RemoteAddressIP4</td>
                            </tr>
                            <tr>
                                <td>ModuleLoad</td>
                                <td>DLL/module loading</td>
                                <td>FileName, FilePath, SHA256HashData</td>
                            </tr>
                            <tr>
                                <td>ScriptContent</td>
                                <td>Script execution content</td>
                                <td>ScriptContent, ScriptEngine</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Query Syntax -->
                <h2><i class="fas fa-code"></i> Query Syntax Basics</h2>
                <div class="config-section">
                    <p>CrowdStrike uses a Splunk-like query syntax in Event Search:</p>
                    
                    <h4>Basic Search Structure</h4>
                    <div class="code-block">event_simpleName=ProcessRollup2 FileName=powershell.exe
| stats count by ComputerName, CommandLine
| sort -count
| head 10</div>

                    <h4>Field Operators</h4>
                    <div class="code-block"># Exact match
FileName=cmd.exe

# Wildcard
FileName=*powershell*
CommandLine=*-enc*

# Not equal
FileName!=explorer.exe

# Multiple values (OR)
FileName IN (cmd.exe, powershell.exe, wscript.exe)

# Regular expression
CommandLine=/.*-enc.*/i

# Field exists
FileName=*

# Field does not exist
NOT FileName=*</div>

                    <h4>Boolean Operators</h4>
                    <div class="code-block"># AND (implicit or explicit)
event_simpleName=ProcessRollup2 FileName=cmd.exe
event_simpleName=ProcessRollup2 AND FileName=cmd.exe

# OR
FileName=cmd.exe OR FileName=powershell.exe

# NOT
event_simpleName=ProcessRollup2 NOT FileName=explorer.exe

# Grouping
event_simpleName=ProcessRollup2 (FileName=cmd.exe OR FileName=powershell.exe)</div>

                    <h4>Time Filters</h4>
                    <div class="code-block"># Last 24 hours (UI default)
# Last 7 days
# Custom range via UI date picker

# In query (relative)
earliest=-24h
earliest=-7d latest=-1d

# Specific time
earliest="2024-01-15T00:00:00Z" latest="2024-01-15T23:59:59Z"</div>
                </div>

                <!-- Execution Hunting -->
                <h2><i class="fas fa-play"></i> Execution Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1059.001</span> PowerShell Encoded Commands</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2 
FileName IN (powershell.exe, pwsh.exe)
CommandLine=*-enc* OR CommandLine=*-encodedcommand*
| table timestamp, ComputerName, UserName, CommandLine, ParentBaseFileName
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1059.001</span> PowerShell Download Activity</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
FileName IN (powershell.exe, pwsh.exe)
(CommandLine=*DownloadString* OR CommandLine=*DownloadFile* OR 
 CommandLine=*Invoke-WebRequest* OR CommandLine=*Net.WebClient* OR
 CommandLine=*Start-BitsTransfer* OR CommandLine=*iwr* OR CommandLine=*curl*)
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1059.005</span> Suspicious VBScript/JScript</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
FileName IN (wscript.exe, cscript.exe)
(CommandLine=*http* OR CommandLine=*https* OR CommandLine=*\\\\*)
| table timestamp, ComputerName, UserName, CommandLine, ParentBaseFileName
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1218</span> LOLBin Execution</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
FileName IN (certutil.exe, mshta.exe, regsvr32.exe, rundll32.exe, 
             msiexec.exe, cmstp.exe, wmic.exe, installutil.exe)
(CommandLine=*http* OR CommandLine=*https* OR CommandLine=*ftp* OR 
 CommandLine=*\\\\* OR CommandLine=*-decode* OR CommandLine=*/i:*)
| table timestamp, ComputerName, UserName, FileName, CommandLine
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1059</span> Office Spawning Command Interpreter</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
ParentBaseFileName IN (WINWORD.EXE, EXCEL.EXE, POWERPNT.EXE, OUTLOOK.EXE)
FileName IN (cmd.exe, powershell.exe, wscript.exe, cscript.exe, mshta.exe)
| table timestamp, ComputerName, UserName, ParentBaseFileName, FileName, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Persistence Hunting -->
                <h2><i class="fas fa-anchor"></i> Persistence Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1547.001</span> Registry Run Key Modifications</h3>
                    <div class="code-block">event_simpleName=RegistryOperationUpdate
RegistryPath=*\\CurrentVersion\\Run*
| table timestamp, ComputerName, UserName, RegistryPath, RegistryValue
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1053.005</span> Scheduled Task Creation</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
FileName=schtasks.exe
CommandLine=*/create*
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp

# Alternative: Check for ScheduledTaskRegistered event
event_simpleName=ScheduledTaskRegistered
| table timestamp, ComputerName, TaskName, TaskExecCommand, UserName</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1543.003</span> Service Creation</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
FileName=sc.exe
CommandLine=*create*
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp

# Service installed event
event_simpleName=ServiceInstalled
| table timestamp, ComputerName, ServiceName, ServiceImagePath</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1546.003</span> WMI Event Subscription</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
(CommandLine=*__EventFilter* OR CommandLine=*__EventConsumer* OR 
 CommandLine=*__FilterToConsumerBinding*)
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Credential Access Hunting -->
                <h2><i class="fas fa-key"></i> Credential Access Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1003.001</span> LSASS Access Indicators</h3>
                    <div class="code-block"># Credential dumping tools
event_simpleName=ProcessRollup2
(FileName=mimikatz.exe OR FileName=procdump.exe OR FileName=procdump64.exe OR
 CommandLine=*sekurlsa* OR CommandLine=*lsass* OR CommandLine=*minidump*)
| table timestamp, ComputerName, UserName, FileName, CommandLine
| sort -timestamp

# Direct LSASS access (requires additional telemetry)
event_simpleName=LsassHandleOperation
| table timestamp, ComputerName, CallerProcessName, GrantedAccess</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1003.002</span> SAM Database Access</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
(CommandLine=*\\SAM* OR CommandLine=*\\SYSTEM* OR CommandLine=*\\SECURITY* OR
 CommandLine=*reg*save*sam* OR CommandLine=*reg*save*system*)
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1003.003</span> NTDS.dit Access</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
(CommandLine=*ntds.dit* OR CommandLine=*ntdsutil* OR 
 (FileName=vssadmin.exe CommandLine=*shadow*))
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Lateral Movement Hunting -->
                <h2><i class="fas fa-arrows-alt"></i> Lateral Movement Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1021.002</span> SMB Lateral Movement</h3>
                    <div class="code-block"># Many connections to port 445
event_simpleName=NetworkConnectIP4
RemotePort=445
| stats dc(RemoteAddressIP4) as unique_targets by ComputerName, UserName
| where unique_targets > 5
| sort -unique_targets</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1021.001</span> RDP Connections</h3>
                    <div class="code-block"># Outbound RDP
event_simpleName=NetworkConnectIP4
RemotePort=3389
| table timestamp, ComputerName, UserName, RemoteAddressIP4
| sort -timestamp

# RDP Logons
event_simpleName=UserLogon
LogonType=10
| table timestamp, ComputerName, UserName, RemoteAddressIP4</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1047</span> WMI Remote Execution</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
FileName=wmic.exe
CommandLine=*/node:*
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp

# WMI provider host spawning processes
event_simpleName=ProcessRollup2
ParentBaseFileName=wmiprvse.exe
FileName IN (cmd.exe, powershell.exe)
| table timestamp, ComputerName, UserName, FileName, CommandLine</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1570</span> PsExec Usage</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
(FileName=psexec.exe OR FileName=psexec64.exe OR FileName=PSEXESVC.exe)
| table timestamp, ComputerName, UserName, FileName, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Defense Evasion Hunting -->
                <h2><i class="fas fa-eye-slash"></i> Defense Evasion Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1070.001</span> Event Log Clearing</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
FileName=wevtutil.exe
(CommandLine=*cl* OR CommandLine=*clear-log*)
| table timestamp, ComputerName, UserName, CommandLine

# PowerShell log clearing
event_simpleName=ProcessRollup2
FileName IN (powershell.exe, pwsh.exe)
CommandLine=*Clear-EventLog*
| table timestamp, ComputerName, UserName, CommandLine</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1562.001</span> Security Tool Tampering</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
(CommandLine=*Set-MpPreference*DisableRealtimeMonitoring* OR
 CommandLine=*sc*stop*WinDefend* OR
 CommandLine=*net*stop*WinDefend* OR
 CommandLine=*DisableBehaviorMonitoring*)
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1036</span> Masquerading Detection</h3>
                    <div class="code-block"># System binaries running from wrong locations
event_simpleName=ProcessRollup2
FileName IN (cmd.exe, powershell.exe, svchost.exe, lsass.exe, csrss.exe)
NOT FilePath=C:\\Windows\\*
| table timestamp, ComputerName, FileName, FilePath, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Network Hunting -->
                <h2><i class="fas fa-network-wired"></i> Network-Based Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1071</span> Suspicious DNS Queries</h3>
                    <div class="code-block"># High-entropy domain names (potential DGA)
event_simpleName=DnsRequest
| regex DomainName="^[a-z0-9]{15,}\\."
| table timestamp, ComputerName, DomainName
| sort -timestamp

# Rare TLDs
event_simpleName=DnsRequest
DomainName IN (*.tk, *.ml, *.ga, *.cf, *.gq, *.top, *.xyz, *.pw)
| table timestamp, ComputerName, DomainName, ContextProcessName</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1571</span> Non-Standard Port Usage</h3>
                    <div class="code-block">event_simpleName=NetworkConnectIP4
NOT RemotePort IN (80, 443, 8080, 8443, 53, 21, 22, 25, 110, 143, 993, 995)
RemotePort < 49152
| stats count by RemoteAddressIP4, RemotePort, ContextProcessName
| where count > 10
| sort -count</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1048</span> Large Data Transfers</h3>
                    <div class="code-block">event_simpleName=NetworkConnectIP4
| stats sum(BytesSent) as TotalBytesSent by ComputerName, RemoteAddressIP4
| where TotalBytesSent > 104857600
| eval MB_Sent = round(TotalBytesSent/1048576, 2)
| table ComputerName, RemoteAddressIP4, MB_Sent
| sort -MB_Sent</div>
                </div>

                <!-- File Hunting -->
                <h2><i class="fas fa-file"></i> File-Based Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1105</span> Suspicious File Drops</h3>
                    <div class="code-block">event_simpleName=FileWritten
(FilePath=*\\Temp\\* OR FilePath=*\\AppData\\* OR FilePath=*\\ProgramData\\*)
FileName=*.exe OR FileName=*.dll OR FileName=*.ps1 OR FileName=*.bat
| table timestamp, ComputerName, FilePath, FileName, SHA256HashData
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1027</span> Double Extension Files</h3>
                    <div class="code-block">event_simpleName=FileWritten
| regex FileName="\\.\\w{2,4}\\.(exe|dll|scr|bat|cmd|ps1|vbs|js)$"
| table timestamp, ComputerName, FilePath, FileName
| sort -timestamp</div>
                </div>

                <!-- Script Content Analysis -->
                <h2><i class="fas fa-scroll"></i> Script Content Analysis</h2>
                <div class="config-section">
                    <p>CrowdStrike captures script content for PowerShell and other script engines:</p>
                    <div class="code-block"># Search script content for suspicious patterns
event_simpleName=ScriptContent
(ScriptContent=*Invoke-Mimikatz* OR ScriptContent=*Invoke-Empire* OR
 ScriptContent=*Get-Keystrokes* OR ScriptContent=*Get-GPPPassword* OR
 ScriptContent=*Invoke-Shellcode*)
| table timestamp, ComputerName, UserName, ScriptEngine, ScriptContent
| sort -timestamp

# Base64 encoded content in scripts
event_simpleName=ScriptContent
ScriptContent=*FromBase64String*
| table timestamp, ComputerName, ScriptContent</div>
                </div>

                <!-- Investigation Workflow -->
                <h2><i class="fas fa-search-plus"></i> Investigation Workflow</h2>
                <div class="config-section">
                    <h4>Step 1: Initial Triage</h4>
                    <div class="code-block"># Get all activity for a specific host
ComputerName="SUSPECT-HOST"
| table timestamp, event_simpleName, FileName, CommandLine, RemoteAddressIP4
| sort timestamp</div>

                    <h4>Step 2: Process Tree Analysis</h4>
                    <div class="code-block"># Trace process lineage
event_simpleName=ProcessRollup2
ComputerName="SUSPECT-HOST"
| table timestamp, FileName, CommandLine, ParentBaseFileName, 
       ParentProcessId_decimal, TargetProcessId_decimal
| sort timestamp</div>

                    <h4>Step 3: Network Activity for Host</h4>
                    <div class="code-block">event_simpleName IN (NetworkConnectIP4, DnsRequest)
ComputerName="SUSPECT-HOST"
| table timestamp, event_simpleName, RemoteAddressIP4, RemotePort, 
       DomainName, ContextProcessName
| sort timestamp</div>

                    <h4>Step 4: File Activity</h4>
                    <div class="code-block">event_simpleName=FileWritten
ComputerName="SUSPECT-HOST"
| table timestamp, FileName, FilePath, SHA256HashData, ContextProcessName
| sort timestamp</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you hunt for lateral movement in CrowdStrike?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Network connections:</strong> Look for internal connections on SMB (445), RDP (3389), WinRM (5985/5986)</li>
                                <li><strong>Remote execution tools:</strong> Search for PsExec, WMI /node:, PowerShell remoting</li>
                                <li><strong>Logon events:</strong> UserLogon events with LogonType 3 (network) or 10 (RDP)</li>
                                <li><strong>Process spawning:</strong> wmiprvse.exe or services.exe spawning unusual processes</li>
                            </ol>
                            <div class="code-block"># Quick lateral movement hunt
event_simpleName=NetworkConnectIP4 RemotePort=445
| stats dc(RemoteAddressIP4) as targets by ComputerName
| where targets > 5</div>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between ProcessRollup2 and ProcessBlocked?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>ProcessRollup2:</strong> Records process execution that was ALLOWED. Shows normal process activity including potentially malicious processes that weren't blocked.</li>
                                <li><strong>ProcessBlocked:</strong> Records processes that were PREVENTED from executing by Falcon's prevention capabilities.</li>
                            </ul>
                            <p>For hunting, use ProcessRollup2 to find threats that bypassed prevention. Review ProcessBlocked for attack attempts that were stopped.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you investigate a detection in CrowdStrike?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Review detection details:</strong> Check the detection summary for IOCs, MITRE mapping, and affected host</li>
                                <li><strong>Process Tree:</strong> View the process tree in Falcon UI to understand execution chain</li>
                                <li><strong>Pivot to Event Search:</strong> Search for all activity on affected host around detection time</li>
                                <li><strong>Network activity:</strong> Check for C2 connections, data exfiltration</li>
                                <li><strong>Scope the incident:</strong> Search for IOCs across all endpoints</li>
                                <li><strong>Containment:</strong> If confirmed, use Network Contain or RTR for response</li>
                            </ol>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>

                <!-- Additional Hunting Scenarios -->
                <h2><i class="fas fa-binoculars"></i> Advanced Hunting Scenarios</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1486</span> Ransomware Indicators</h3>
                    <div class="code-block"># Mass file encryption indicators
event_simpleName=FileWritten
| stats count as file_count by ComputerName, ContextProcessName, bin(timestamp, 5m)
| where file_count > 100
| sort -file_count

# Ransom note creation
event_simpleName=FileWritten
(FileName=*readme* OR FileName=*decrypt* OR FileName=*ransom* OR FileName=*recover*)
(FileName=*.txt OR FileName=*.html OR FileName=*.hta)
| table timestamp, ComputerName, FileName, FilePath, ContextProcessName

# Volume shadow copy deletion
event_simpleName=ProcessRollup2
(CommandLine=*vssadmin*delete* OR CommandLine=*wmic*shadowcopy*delete* OR
 CommandLine=*bcdedit*/set*recoveryenabled*no*)
| table timestamp, ComputerName, CommandLine</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1055</span> Process Injection Indicators</h3>
                    <div class="code-block"># Common injection techniques
event_simpleName=ProcessRollup2
(CommandLine=*VirtualAlloc* OR CommandLine=*WriteProcessMemory* OR
 CommandLine=*CreateRemoteThread* OR CommandLine=*NtCreateThreadEx* OR
 CommandLine=*QueueUserAPC*)
| table timestamp, ComputerName, FileName, CommandLine

# Unusual DLL loads
event_simpleName=ModuleLoad
NOT FilePath=C:\\Windows\\*
NOT FilePath=C:\\Program?Files*
| stats count by ComputerName, FilePath, FileName
| where count < 5
| sort count</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1087</span> Account Discovery</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
(CommandLine=*net*user* OR CommandLine=*net*group* OR CommandLine=*net*localgroup* OR
 CommandLine=*whoami* OR CommandLine=*quser* OR CommandLine=*query*user*)
| stats count, values(CommandLine) as commands by ComputerName, UserName, bin(timestamp, 1h)
| where count > 3
| sort -count</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1082</span> System Discovery</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
(FileName=systeminfo.exe OR FileName=hostname.exe OR 
 CommandLine=*ipconfig*/all* OR CommandLine=*netstat* OR
 CommandLine=*tasklist* OR CommandLine=*wmic*os*)
| stats count, values(CommandLine) as commands by ComputerName, UserName, bin(timestamp, 1h)
| where count > 5
| sort -count</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1018</span> Remote System Discovery</h3>
                    <div class="code-block">event_simpleName=ProcessRollup2
(FileName=net.exe CommandLine=*view* OR
 FileName=nltest.exe OR
 CommandLine=*dsquery*computer* OR
 FileName=arp.exe CommandLine=*-a* OR
 FileName=ping.exe)
| stats count by ComputerName, UserName, bin(timestamp, 1h)
| where count > 5
| sort -count</div>
                </div>

                <!-- OverWatch Hunting Tips -->
                <h2><i class="fas fa-eye"></i> OverWatch-Style Hunting Tips</h2>
                <div class="config-section">
                    <p>CrowdStrike's OverWatch team uses these techniques. Apply similar methodologies:</p>
                    
                    <h4>Hunt for Anomalies</h4>
                    <div class="code-block"># Rare processes (first-time execution)
event_simpleName=ProcessRollup2
| stats earliest(timestamp) as first_seen, count by FileName
| where count < 5
| sort first_seen desc

# Processes running from unusual paths
event_simpleName=ProcessRollup2
NOT FilePath=C:\\Windows\\*
NOT FilePath=C:\\Program?Files*
NOT FilePath=*\\AppData\\Local\\Microsoft\\*
| stats count by FileName, FilePath
| where count < 10
| sort count</div>

                    <h4>Hunt by Time Anomaly</h4>
                    <div class="code-block"># Activity outside business hours
event_simpleName=ProcessRollup2
| eval hour=strftime(timestamp, "%H")
| where hour < "06" OR hour > "22"
| stats count by ComputerName, UserName, FileName
| where count > 0
| sort -count</div>

                    <h4>Hunt by Parent-Child Relationship</h4>
                    <div class="code-block"># Unusual parent-child relationships
event_simpleName=ProcessRollup2
| stats count by ParentBaseFileName, FileName
| where count < 10
| sort count

# Specific suspicious relationships
event_simpleName=ProcessRollup2
ParentBaseFileName IN (services.exe, svchost.exe) 
FileName IN (cmd.exe, powershell.exe, wscript.exe)
| table timestamp, ComputerName, ParentBaseFileName, FileName, CommandLine</div>
                </div>

                <!-- Real-Time Response Integration -->
                <h2><i class="fas fa-terminal"></i> Hunting with Real-Time Response (RTR)</h2>
                <div class="config-section">
                    <p>After identifying suspicious activity, use RTR for deeper investigation:</p>
                    
                    <h4>Common RTR Commands for Hunting</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Command</th><th>Purpose</th><th>Example</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>ps</code></td>
                                <td>List running processes</td>
                                <td><code>ps</code></td>
                            </tr>
                            <tr>
                                <td><code>netstat</code></td>
                                <td>Show network connections</td>
                                <td><code>netstat</code></td>
                            </tr>
                            <tr>
                                <td><code>ls / dir</code></td>
                                <td>List directory contents</td>
                                <td><code>ls C:\Users\Public</code></td>
                            </tr>
                            <tr>
                                <td><code>cat / type</code></td>
                                <td>View file contents</td>
                                <td><code>cat C:\temp\suspicious.txt</code></td>
                            </tr>
                            <tr>
                                <td><code>reg query</code></td>
                                <td>Query registry</td>
                                <td><code>reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code></td>
                            </tr>
                            <tr>
                                <td><code>get</code></td>
                                <td>Download file for analysis</td>
                                <td><code>get C:\temp\malware.exe</code></td>
                            </tr>
                            <tr>
                                <td><code>memdump</code></td>
                                <td>Memory dump process</td>
                                <td><code>memdump 1234</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Custom IOA Rules -->
                <h2><i class="fas fa-shield-alt"></i> Creating Custom IOA Rules</h2>
                <div class="config-section">
                    <p><span class="console-path">Falcon Console → Configuration → Custom IOAs</span></p>
                    
                    <h4>IOA Rule Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Monitors</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Process Creation</td><td>New processes</td><td>Suspicious command execution</td></tr>
                            <tr><td>Network Connection</td><td>Outbound connections</td><td>C2 communication</td></tr>
                            <tr><td>File Write</td><td>File creation/modification</td><td>Malware drops</td></tr>
                            <tr><td>DNS Request</td><td>DNS queries</td><td>DGA domains</td></tr>
                            <tr><td>Registry</td><td>Registry changes</td><td>Persistence</td></tr>
                        </tbody>
                    </table>

                    <h4>Example Custom IOA: PowerShell Download Cradle</h4>
                    <div class="code-block">Rule Name: PowerShell Download Cradle Detection
Rule Type: Process Creation
Severity: High
Action: Detect

Conditions:
  Image File Name: 
    - equals: powershell.exe
    - equals: pwsh.exe
  
  Command Line (any):
    - contains: DownloadString
    - contains: DownloadFile
    - contains: Invoke-WebRequest
    - contains: Net.WebClient
    - contains: Start-BitsTransfer
  
  AND Command Line:
    - contains: http

Exclusions:
  User Name:
    - equals: SYSTEM (if from known deployment tool)
  Parent Image File Name:
    - equals: sccm.exe</div>
                </div>

                <!-- Hunting Metrics -->
                <h2><i class="fas fa-chart-bar"></i> Hunting Metrics and Reporting</h2>
                <div class="config-section">
                    <h4>Key Metrics to Track</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Metric</th><th>Description</th><th>Target</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Hunts Conducted</td><td>Number of hunting exercises</td><td>4-8 per week</td></tr>
                            <tr><td>Findings Rate</td><td>Hunts resulting in actionable findings</td><td>> 20%</td></tr>
                            <tr><td>True Positive Rate</td><td>Confirmed threats / Total findings</td><td>> 50%</td></tr>
                            <tr><td>MITRE Coverage</td><td>Techniques covered by hunts</td><td>Priority techniques</td></tr>
                            <tr><td>Dwell Time Reduction</td><td>Time threat present before detection</td><td>Decreasing trend</td></tr>
                        </tbody>
                    </table>

                    <h4>Sample Hunting Report Structure</h4>
                    <div class="code-block">Hunting Report: [Hunt Name]
Date: [Date]
Analyst: [Name]

Hypothesis:
[What threat behavior were you looking for?]

Methodology:
[Queries used, data sources examined]

Findings:
- [Finding 1 with evidence]
- [Finding 2 with evidence]

False Positives Identified:
- [FP 1 - recommended tuning]

Recommendations:
- [Detection rule to create]
- [Configuration change]

MITRE Mapping:
- Technique: [T-code]
- Tactic: [Tactic name]</div>
                </div>

                <!-- Additional Interview Questions -->
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What data sources does CrowdStrike collect for threat hunting?</button>
                        <div class="qa-answer">
                            <p>CrowdStrike Falcon collects extensive endpoint telemetry:</p>
                            <ul>
                                <li><strong>Process events:</strong> Creation, termination, command lines, parent-child relationships</li>
                                <li><strong>Network events:</strong> Connections, DNS queries, URLs accessed</li>
                                <li><strong>File events:</strong> Creation, modification, deletion, hashes</li>
                                <li><strong>Registry events:</strong> Key/value modifications</li>
                                <li><strong>User events:</strong> Logons, authentication</li>
                                <li><strong>Module loads:</strong> DLLs and other modules loaded</li>
                                <li><strong>Script content:</strong> PowerShell, VBScript, etc.</li>
                            </ul>
                            <p>Data is retained for varying periods based on subscription tier (typically 7-90 days).</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do Custom IOAs differ from built-in detections?</button>
                        <div class="qa-answer">
                            <p><strong>Built-in Detections:</strong></p>
                            <ul>
                                <li>Created and maintained by CrowdStrike</li>
                                <li>Based on threat intelligence and research</li>
                                <li>Regularly updated automatically</li>
                                <li>Optimized for broad detection</li>
                            </ul>
                            <p><strong>Custom IOAs:</strong></p>
                            <ul>
                                <li>Created by your security team</li>
                                <li>Tailored to your environment</li>
                                <li>Can detect organization-specific threats</li>
                                <li>Useful for: policy violations, specific applications, hunting hypotheses</li>
                                <li>Require ongoing maintenance</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Describe your approach to hypothesis-driven hunting in CrowdStrike.</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Form hypothesis:</strong> Based on threat intel, MITRE ATT&CK, or incident reports. Example: "Attackers may be using encoded PowerShell to download second-stage payloads"</li>
                                <li><strong>Identify data sources:</strong> Which event types contain relevant data (ProcessRollup2, ScriptContent)</li>
                                <li><strong>Build query:</strong> Create search query targeting the specific behavior</li>
                                <li><strong>Execute and analyze:</strong> Run query, review results, investigate anomalies</li>
                                <li><strong>Refine and iterate:</strong> Adjust query based on findings, reduce false positives</li>
                                <li><strong>Document findings:</strong> Report results, create detection rules for ongoing monitoring</li>
                            </ol>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>
