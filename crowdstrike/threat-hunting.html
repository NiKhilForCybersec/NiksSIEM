<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Hunting | CrowdStrike</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link active" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">CrowdStrike Pages</div>
                <ul class="sidebar-nav">
                                        <li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-book"></i>
                            <span>Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="sensor-deployment.html" class="sidebar-nav-link">
                            <i class="fas fa-download"></i>
                            <span>Sensor Deployment</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="host-management.html" class="sidebar-nav-link">
                            <i class="fas fa-server"></i>
                            <span>Host Management</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="detection-engineering.html" class="sidebar-nav-link">
                            <i class="fas fa-shield-alt"></i>
                            <span>Detection Engineering</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="ioa-rules.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>IOA Rules</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="detection-tuning.html" class="sidebar-nav-link">
                            <i class="fas fa-sliders-h"></i>
                            <span>Detection Tuning</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="falcon-intelligence.html" class="sidebar-nav-link">
                            <i class="fas fa-brain"></i>
                            <span>Falcon Intelligence</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-hunting.html" class="sidebar-nav-link active">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Hunting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="incident-response.html" class="sidebar-nav-link">
                            <i class="fas fa-ambulance"></i>
                            <span>Incident Response</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="real-time-response.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>Real Time Response</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="reporting.html" class="sidebar-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Reporting</span>
                        </a>
                    </li>
<li class="sidebar-nav-item">
                        <a href="incident-management.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Incident Management</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="ioa-rules.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>Ioa Rules</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="response-actions.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>Response Actions</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="rtr.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Rtr</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="sensor-deployment.html" class="sidebar-nav-link">
                            <i class="fas fa-download"></i>
                            <span>Sensor Deployment</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-hunting.html" class="sidebar-nav-link active">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Hunting</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">CrowdStrike</a>
                    <span class="separator">/</span>
                    <span class="current">Threat Hunting</span>
                </div>

                <h1><i class="fas fa-crosshairs"></i> Threat Hunting in CrowdStrike Falcon</h1>
                <p class="lead">Proactively search for threats using CrowdStrike Falcon's Event Search and Investigate features. Access endpoint telemetry with Splunk-like query syntax.</p>

                <!-- Accessing Threat Hunting -->
                <h2><i class="fas fa-terminal"></i> Accessing Threat Hunting</h2>
                <div class="config-section">
                    <p><span class="console-path">Falcon Console → Investigate → Event Search</span></p>
                    <p style="color: #8b949e;">Alternative: <span class="console-path">Endpoint Security → Investigate</span></p>
                    
                    <h4>Key Event Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Event Type</th><th>Description</th><th>Key Fields</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ProcessRollup2</td>
                                <td>Process execution events</td>
                                <td>FileName, CommandLine, ParentBaseFileName</td>
                            </tr>
                            <tr>
                                <td>NetworkConnectIP4</td>
                                <td>IPv4 network connections</td>
                                <td>RemoteAddressIP4, RemotePort, LocalPort</td>
                            </tr>
                            <tr>
                                <td>NetworkConnectIP6</td>
                                <td>IPv6 network connections</td>
                                <td>RemoteAddressIP6, RemotePort</td>
                            </tr>
                            <tr>
                                <td>DnsRequest</td>
                                <td>DNS queries</td>
                                <td>DomainName, RequestType</td>
                            </tr>
                            <tr>
                                <td>FileWritten</td>
                                <td>File creation/modification</td>
                                <td>FileName, FilePath, SHA256HashData</td>
                            </tr>
                            <tr>
                                <td>RegistryOperationUpdate</td>
                                <td>Registry modifications</td>
                                <td>RegistryPath, RegistryValue</td>
                            </tr>
                            <tr>
                                <td>UserLogon</td>
                                <td>User authentication</td>
                                <td>UserName, LogonType, RemoteAddressIP4</td>
                            </tr>
                            <tr>
                                <td>ModuleLoad</td>
                                <td>DLL/module loading</td>
                                <td>FileName, FilePath, SHA256HashData</td>
                            </tr>
                            <tr>
                                <td>ScriptContent</td>
                                <td>Script execution content</td>
                                <td>ScriptContent, ScriptEngine</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Query Syntax -->
                <h2><i class="fas fa-code"></i> Query Syntax Basics</h2>
                <div class="config-section">
                    <p>CrowdStrike uses a Splunk-like query syntax in Event Search:</p>
                    
                    <h4>Basic Search Structure</h4>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2 FileName=powershell.exe
| stats count by ComputerName, CommandLine
| sort -count
| head 10</div>

                    <h4>Field Operators</h4>
                    <div class="arch-diagram"># Exact match
FileName=cmd.exe

# Wildcard
FileName=*powershell*
CommandLine=*-enc*

# Not equal
FileName!=explorer.exe

# Multiple values (OR)
FileName IN (cmd.exe, powershell.exe, wscript.exe)

# Regular expression
CommandLine=/.*-enc.*/i

# Field exists
FileName=*

# Field does not exist
NOT FileName=*</div>

                    <h4>Boolean Operators</h4>
                    <div class="arch-diagram"># AND (implicit or explicit)
event_simpleName=ProcessRollup2 FileName=cmd.exe
event_simpleName=ProcessRollup2 AND FileName=cmd.exe

# OR
FileName=cmd.exe OR FileName=powershell.exe

# NOT
event_simpleName=ProcessRollup2 NOT FileName=explorer.exe

# Grouping
event_simpleName=ProcessRollup2 (FileName=cmd.exe OR FileName=powershell.exe)</div>

                    <h4>Time Filters</h4>
                    <div class="arch-diagram"># Last 24 hours (UI default)
# Last 7 days
# Custom range via UI date picker

# In query (relative)
earliest=-24h
earliest=-7d latest=-1d

# Specific time
earliest="2024-01-15T00:00:00Z" latest="2024-01-15T23:59:59Z"</div>
                </div>

                <!-- Execution Hunting -->
                <h2><i class="fas fa-play"></i> Execution Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1059.001</span> PowerShell Encoded Commands</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2 
FileName IN (powershell.exe, pwsh.exe)
CommandLine=*-enc* OR CommandLine=*-encodedcommand*
| table timestamp, ComputerName, UserName, CommandLine, ParentBaseFileName
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1059.001</span> PowerShell Download Activity</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
FileName IN (powershell.exe, pwsh.exe)
(CommandLine=*DownloadString* OR CommandLine=*DownloadFile* OR 
 CommandLine=*Invoke-WebRequest* OR CommandLine=*Net.WebClient* OR
 CommandLine=*Start-BitsTransfer* OR CommandLine=*iwr* OR CommandLine=*curl*)
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1059.005</span> Suspicious VBScript/JScript</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
FileName IN (wscript.exe, cscript.exe)
(CommandLine=*http* OR CommandLine=*https* OR CommandLine=*\\\\*)
| table timestamp, ComputerName, UserName, CommandLine, ParentBaseFileName
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1218</span> LOLBin Execution</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
FileName IN (certutil.exe, mshta.exe, regsvr32.exe, rundll32.exe, 
             msiexec.exe, cmstp.exe, wmic.exe, installutil.exe)
(CommandLine=*http* OR CommandLine=*https* OR CommandLine=*ftp* OR 
 CommandLine=*\\\\* OR CommandLine=*-decode* OR CommandLine=*/i:*)
| table timestamp, ComputerName, UserName, FileName, CommandLine
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1059</span> Office Spawning Command Interpreter</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
ParentBaseFileName IN (WINWORD.EXE, EXCEL.EXE, POWERPNT.EXE, OUTLOOK.EXE)
FileName IN (cmd.exe, powershell.exe, wscript.exe, cscript.exe, mshta.exe)
| table timestamp, ComputerName, UserName, ParentBaseFileName, FileName, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Persistence Hunting -->
                <h2><i class="fas fa-anchor"></i> Persistence Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1547.001</span> Registry Run Key Modifications</h3>
                    <div class="arch-diagram">event_simpleName=RegistryOperationUpdate
RegistryPath=*\\CurrentVersion\\Run*
| table timestamp, ComputerName, UserName, RegistryPath, RegistryValue
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1053.005</span> Scheduled Task Creation</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
FileName=schtasks.exe
CommandLine=*/create*
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp

# Alternative: Check for ScheduledTaskRegistered event
event_simpleName=ScheduledTaskRegistered
| table timestamp, ComputerName, TaskName, TaskExecCommand, UserName</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1543.003</span> Service Creation</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
FileName=sc.exe
CommandLine=*create*
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp

# Service installed event
event_simpleName=ServiceInstalled
| table timestamp, ComputerName, ServiceName, ServiceImagePath</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1546.003</span> WMI Event Subscription</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
(CommandLine=*__EventFilter* OR CommandLine=*__EventConsumer* OR 
 CommandLine=*__FilterToConsumerBinding*)
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Credential Access Hunting -->
                <h2><i class="fas fa-key"></i> Credential Access Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1003.001</span> LSASS Access Indicators</h3>
                    <div class="arch-diagram"># Credential dumping tools
event_simpleName=ProcessRollup2
(FileName=mimikatz.exe OR FileName=procdump.exe OR FileName=procdump64.exe OR
 CommandLine=*sekurlsa* OR CommandLine=*lsass* OR CommandLine=*minidump*)
| table timestamp, ComputerName, UserName, FileName, CommandLine
| sort -timestamp

# Direct LSASS access (requires additional telemetry)
event_simpleName=LsassHandleOperation
| table timestamp, ComputerName, CallerProcessName, GrantedAccess</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1003.002</span> SAM Database Access</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
(CommandLine=*\\SAM* OR CommandLine=*\\SYSTEM* OR CommandLine=*\\SECURITY* OR
 CommandLine=*reg*save*sam* OR CommandLine=*reg*save*system*)
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1003.003</span> NTDS.dit Access</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
(CommandLine=*ntds.dit* OR CommandLine=*ntdsutil* OR 
 (FileName=vssadmin.exe CommandLine=*shadow*))
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Lateral Movement Hunting -->
                <h2><i class="fas fa-arrows-alt"></i> Lateral Movement Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1021.002</span> SMB Lateral Movement</h3>
                    <div class="arch-diagram"># Many connections to port 445
event_simpleName=NetworkConnectIP4
RemotePort=445
| stats dc(RemoteAddressIP4) as unique_targets by ComputerName, UserName
| where unique_targets > 5
| sort -unique_targets</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1021.001</span> RDP Connections</h3>
                    <div class="arch-diagram"># Outbound RDP
event_simpleName=NetworkConnectIP4
RemotePort=3389
| table timestamp, ComputerName, UserName, RemoteAddressIP4
| sort -timestamp

# RDP Logons
event_simpleName=UserLogon
LogonType=10
| table timestamp, ComputerName, UserName, RemoteAddressIP4</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1047</span> WMI Remote Execution</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
FileName=wmic.exe
CommandLine=*/node:*
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp

# WMI provider host spawning processes
event_simpleName=ProcessRollup2
ParentBaseFileName=wmiprvse.exe
FileName IN (cmd.exe, powershell.exe)
| table timestamp, ComputerName, UserName, FileName, CommandLine</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1570</span> PsExec Usage</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
(FileName=psexec.exe OR FileName=psexec64.exe OR FileName=PSEXESVC.exe)
| table timestamp, ComputerName, UserName, FileName, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Defense Evasion Hunting -->
                <h2><i class="fas fa-eye-slash"></i> Defense Evasion Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1070.001</span> Event Log Clearing</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
FileName=wevtutil.exe
(CommandLine=*cl* OR CommandLine=*clear-log*)
| table timestamp, ComputerName, UserName, CommandLine

# PowerShell log clearing
event_simpleName=ProcessRollup2
FileName IN (powershell.exe, pwsh.exe)
CommandLine=*Clear-EventLog*
| table timestamp, ComputerName, UserName, CommandLine</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1562.001</span> Security Tool Tampering</h3>
                    <div class="arch-diagram">event_simpleName=ProcessRollup2
(CommandLine=*Set-MpPreference*DisableRealtimeMonitoring* OR
 CommandLine=*sc*stop*WinDefend* OR
 CommandLine=*net*stop*WinDefend* OR
 CommandLine=*DisableBehaviorMonitoring*)
| table timestamp, ComputerName, UserName, CommandLine
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1036</span> Masquerading Detection</h3>
                    <div class="arch-diagram"># System binaries running from wrong locations
event_simpleName=ProcessRollup2
FileName IN (cmd.exe, powershell.exe, svchost.exe, lsass.exe, csrss.exe)
NOT FilePath=C:\\Windows\\*
| table timestamp, ComputerName, FileName, FilePath, CommandLine
| sort -timestamp</div>
                </div>

                <!-- Network Hunting -->
                <h2><i class="fas fa-network-wired"></i> Network-Based Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1071</span> Suspicious DNS Queries</h3>
                    <div class="arch-diagram"># High-entropy domain names (potential DGA)
event_simpleName=DnsRequest
| regex DomainName="^[a-z0-9]{15,}\\."
| table timestamp, ComputerName, DomainName
| sort -timestamp

# Rare TLDs
event_simpleName=DnsRequest
DomainName IN (*.tk, *.ml, *.ga, *.cf, *.gq, *.top, *.xyz, *.pw)
| table timestamp, ComputerName, DomainName, ContextProcessName</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1571</span> Non-Standard Port Usage</h3>
                    <div class="arch-diagram">event_simpleName=NetworkConnectIP4
NOT RemotePort IN (80, 443, 8080, 8443, 53, 21, 22, 25, 110, 143, 993, 995)
RemotePort < 49152
| stats count by RemoteAddressIP4, RemotePort, ContextProcessName
| where count > 10
| sort -count</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1048</span> Large Data Transfers</h3>
                    <div class="arch-diagram">event_simpleName=NetworkConnectIP4
| stats sum(BytesSent) as TotalBytesSent by ComputerName, RemoteAddressIP4
| where TotalBytesSent > 104857600
| eval MB_Sent = round(TotalBytesSent/1048576, 2)
| table ComputerName, RemoteAddressIP4, MB_Sent
| sort -MB_Sent</div>
                </div>

                <!-- File Hunting -->
                <h2><i class="fas fa-file"></i> File-Based Hunting</h2>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1105</span> Suspicious File Drops</h3>
                    <div class="arch-diagram">event_simpleName=FileWritten
(FilePath=*\\Temp\\* OR FilePath=*\\AppData\\* OR FilePath=*\\ProgramData\\*)
FileName=*.exe OR FileName=*.dll OR FileName=*.ps1 OR FileName=*.bat
| table timestamp, ComputerName, FilePath, FileName, SHA256HashData
| sort -timestamp</div>
                </div>

                <div class="hunt-card">
                    <h3><span class="mitre-tag">T1027</span> Double Extension Files</h3>
                    <div class="arch-diagram">event_simpleName=FileWritten
| regex FileName="\\.\\w{2,4}\\.(exe|dll|scr|bat|cmd|ps1|vbs|js)$"
| table timestamp, ComputerName, FilePath, FileName
| sort -timestamp</div>
                </div>

                <!-- Script Content Analysis -->
                <h2><i class="fas fa-scroll"></i> Script Content Analysis</h2>
                <div class="config-section">
                    <p>CrowdStrike captures script content for PowerShell and other script engines:</p>
                    <div class="arch-diagram"># Search script content for suspicious patterns
event_simpleName=ScriptContent
(ScriptContent=*Invoke-Mimikatz* OR ScriptContent=*Invoke-Empire* OR
 ScriptContent=*Get-Keystrokes* OR ScriptContent=*Get-GPPPassword* OR
 ScriptContent=*Invoke-Shellcode*)
| table timestamp, ComputerName, UserName, ScriptEngine, ScriptContent
| sort -timestamp

# Base64 encoded content in scripts
event_simpleName=ScriptContent
ScriptContent=*FromBase64String*
| table timestamp, ComputerName, ScriptContent</div>
                </div>

                <!-- Investigation Workflow -->
                <h2><i class="fas fa-search-plus"></i> Investigation Workflow</h2>
                <div class="config-section">
                    <h4>Step 1: Initial Triage</h4>
                    <div class="arch-diagram"># Get all activity for a specific host
ComputerName="SUSPECT-HOST"
| table timestamp, event_simpleName, FileName, CommandLine, RemoteAddressIP4
| sort timestamp</div>

                    <h4>Step 2: Process Tree Analysis</h4>
                    <div class="arch-diagram"># Trace process lineage
event_simpleName=ProcessRollup2
ComputerName="SUSPECT-HOST"
| table timestamp, FileName, CommandLine, ParentBaseFileName, 
       ParentProcessId_decimal, TargetProcessId_decimal
| sort timestamp</div>

                    <h4>Step 3: Network Activity for Host</h4>
                    <div class="arch-diagram">event_simpleName IN (NetworkConnectIP4, DnsRequest)
ComputerName="SUSPECT-HOST"
| table timestamp, event_simpleName, RemoteAddressIP4, RemotePort, 
       DomainName, ContextProcessName
| sort timestamp</div>

                    <h4>Step 4: File Activity</h4>
                    <div class="arch-diagram">event_simpleName=FileWritten
ComputerName="SUSPECT-HOST"
| table timestamp, FileName, FilePath, SHA256HashData, ContextProcessName
| sort timestamp</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you hunt for lateral movement in CrowdStrike?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Network connections:</strong> Look for internal connections on SMB (445), RDP (3389), WinRM (5985/5986)</li>
                                <li><strong>Remote execution tools:</strong> Search for PsExec, WMI /node:, PowerShell remoting</li>
                                <li><strong>Logon events:</strong> UserLogon events with LogonType 3 (network) or 10 (RDP)</li>
                                <li><strong>Process spawning:</strong> wmiprvse.exe or services.exe spawning unusual processes</li>
                            </ol>
                            <div class="arch-diagram"># Quick lateral movement hunt
event_simpleName=NetworkConnectIP4 RemotePort=445
| stats dc(RemoteAddressIP4) as targets by ComputerName
| where targets > 5</div>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between ProcessRollup2 and ProcessBlocked?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>ProcessRollup2:</strong> Records process execution that was ALLOWED. Shows normal process activity including potentially malicious processes that weren't blocked.</li>
                                <li><strong>ProcessBlocked:</strong> Records processes that were PREVENTED from executing by Falcon's prevention capabilities.</li>
                            </ul>
                            <p>For hunting, use ProcessRollup2 to find threats that bypassed prevention. Review ProcessBlocked for attack attempts that were stopped.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you investigate a detection in CrowdStrike?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Review detection details:</strong> Check the detection summary for IOCs, MITRE mapping, and affected host</li>
                                <li><strong>Process Tree:</strong> View the process tree in Falcon UI to understand execution chain</li>
                                <li><strong>Pivot to Event Search:</strong> Search for all activity on affected host around detection time</li>
                                <li><strong>Network activity:</strong> Check for C2 connections, data exfiltration</li>
                                <li><strong>Scope the incident:</strong> Search for IOCs across all endpoints</li>
                                <li><strong>Containment:</strong> If confirmed, use Network Contain or RTR for response</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>