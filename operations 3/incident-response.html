<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Response | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="soc-operations.html" class="nav-link"><i class="fas fa-users"></i> SOC Operations</a>
                    <a href="shift-handoff.html" class="nav-link"><i class="fas fa-exchange-alt"></i> Shift Handoff</a>
                    <a href="metrics-kpis.html" class="nav-link"><i class="fas fa-chart-bar"></i> Metrics & KPIs</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Alert Management</div>
                    <a href="triage-methodology.html" class="nav-link"><i class="fas fa-filter"></i> Triage Methodology</a>
                    <a href="triage-handbook.html" class="nav-link"><i class="fas fa-book"></i> Triage Handbook</a>
                    <a href="incident-classification.html" class="nav-link"><i class="fas fa-tags"></i> Classification</a>
                    <a href="escalation-matrix.html" class="nav-link"><i class="fas fa-level-up-alt"></i> Escalation Matrix</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="use-case-lifecycle.html" class="nav-link"><i class="fas fa-recycle"></i> Use Case Lifecycle</a>
                    <a href="tuning-optimization.html" class="nav-link"><i class="fas fa-sliders-h"></i> Tuning & Optimization</a>
                    <a href="mitre-mapping.html" class="nav-link"><i class="fas fa-map"></i> MITRE Mapping</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Incident Response</div>
                    <a href="incident-response.html" class="nav-link active"><i class="fas fa-fire-extinguisher"></i> IR Process</a>
                    <a href="containment-procedures.html" class="nav-link"><i class="fas fa-lock"></i> Containment</a>
                    <a href="playbook-library.html" class="nav-link"><i class="fas fa-book-open"></i> Playbook Library</a>
                    <a href="ir-integration.html" class="nav-link"><i class="fas fa-plug"></i> IR Integration</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Analysis Guides</div>
                    <a href="log-analysis.html" class="nav-link"><i class="fas fa-file-alt"></i> Log Analysis</a>
                    <a href="malware-analysis.html" class="nav-link"><i class="fas fa-bug"></i> Malware Analysis</a>
                    <a href="phishing-analysis.html" class="nav-link"><i class="fas fa-fish"></i> Phishing Analysis</a>
                    <a href="forensics.html" class="nav-link"><i class="fas fa-microscope"></i> Forensics</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Domains</div>
                    <a href="identity-security.html" class="nav-link"><i class="fas fa-user-shield"></i> Identity Security</a>
                    <a href="network-security.html" class="nav-link"><i class="fas fa-network-wired"></i> Network Security</a>
                    <a href="cloud-security.html" class="nav-link"><i class="fas fa-cloud"></i> Cloud Security</a>
                    <a href="threat-intelligence.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intel</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Planning & Governance</div>
                    <a href="siem-project-planning.html" class="nav-link"><i class="fas fa-project-diagram"></i> SIEM Planning</a>
                    <a href="data-source-priority.html" class="nav-link"><i class="fas fa-sort-amount-down"></i> Data Priority</a>
                    <a href="compliance-mapping.html" class="nav-link"><i class="fas fa-clipboard-check"></i> Compliance</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Operations</a><span class="separator">/</span>
                    <span class="current">Incident Response</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-ambulance"></i> Incident Response</h1>
                <p class="lead">A structured approach to handling security incidents from detection through recovery. This methodology ensures consistent, effective response to minimize damage and enable rapid recovery.</p>

                <!-- IR Framework -->
                <h2><i class="fas fa-sitemap"></i> Incident Response Framework</h2>
                <div class="config-section">
                    <p>Based on NIST SP 800-61 (Computer Security Incident Handling Guide):</p>
                    
                    <div class="phase-card">
                        <span class="phase-header">Phase 1: Preparation</span>
                        <p style="color: #8b949e; margin-top: 8px;">Before incidents occur - building capabilities and readiness.</p>
                    </div>
                    <div class="phase-card">
                        <span class="phase-header">Phase 2: Detection & Analysis</span>
                        <p style="color: #8b949e; margin-top: 8px;">Identifying incidents and understanding their scope.</p>
                    </div>
                    <div class="phase-card">
                        <span class="phase-header">Phase 3: Containment, Eradication & Recovery</span>
                        <p style="color: #8b949e; margin-top: 8px;">Stopping the attack, removing threats, restoring systems.</p>
                    </div>
                    <div class="phase-card">
                        <span class="phase-header">Phase 4: Post-Incident Activity</span>
                        <p style="color: #8b949e; margin-top: 8px;">Learning from incidents to improve future response.</p>
                    </div>
                </div>

                <!-- Severity Classification -->
                <h2><i class="fas fa-thermometer-half"></i> Incident Severity Classification</h2>
                <div class="config-section">
                    <table class="styled-table">
                        <thead>
                            <tr><th>Severity</th><th>Criteria</th><th>Response Time</th><th>Examples</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="severity-critical">Critical</span></td>
                                <td>Active attack, data breach, business disruption</td>
                                <td>Immediate (24/7)</td>
                                <td>Ransomware, active data exfiltration, critical system compromise</td>
                            </tr>
                            <tr>
                                <td><span class="severity-high">High</span></td>
                                <td>Confirmed compromise, potential for spread</td>
                                <td>Within 1 hour</td>
                                <td>Malware execution, credential theft, lateral movement</td>
                            </tr>
                            <tr>
                                <td><span class="severity-medium">Medium</span></td>
                                <td>Suspicious activity, limited impact</td>
                                <td>Within 4 hours</td>
                                <td>Suspicious process execution, policy violation</td>
                            </tr>
                            <tr>
                                <td><span class="severity-low">Low</span></td>
                                <td>Minor security event, no immediate threat</td>
                                <td>Within 24 hours</td>
                                <td>Failed login attempts, blocked malware</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Detection and Analysis -->
                <h2><i class="fas fa-search"></i> Phase 2: Detection & Analysis</h2>
                <div class="config-section">
                    <h4>Initial Detection Sources</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>SIEM/XDR alerts:</strong> Automated detection rules</li>
                        <li><strong>EDR alerts:</strong> Endpoint-based detections</li>
                        <li><strong>User reports:</strong> Phishing reports, suspicious activity</li>
                        <li><strong>Threat intelligence:</strong> IOC matches, threat feeds</li>
                        <li><strong>External notification:</strong> Law enforcement, vendors, CERT</li>
                    </ul>

                    <h4>Analysis Steps</h4>
                    <div class="code-block">1. Validate the Alert
   - Is this a true positive?
   - What triggered the alert?
   - What's the confidence level?

2. Scope the Incident
   - How many systems affected?
   - Which users involved?
   - What data at risk?

3. Identify Attack Vector
   - How did attacker gain access?
   - What technique was used?
   - Map to MITRE ATT&CK

4. Assess Impact
   - Business impact?
   - Data sensitivity?
   - Regulatory implications?

5. Determine Severity
   - Based on scope + impact
   - Triggers escalation path</div>

                    <h4>Key Questions to Answer</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Category</th><th>Questions</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>What</strong></td>
                                <td>What type of attack? What systems? What data?</td>
                            </tr>
                            <tr>
                                <td><strong>When</strong></td>
                                <td>When did it start? How long has it been active?</td>
                            </tr>
                            <tr>
                                <td><strong>Where</strong></td>
                                <td>Which networks? Which locations? Cloud or on-prem?</td>
                            </tr>
                            <tr>
                                <td><strong>Who</strong></td>
                                <td>Which accounts compromised? Who is the attacker?</td>
                            </tr>
                            <tr>
                                <td><strong>How</strong></td>
                                <td>How did they get in? How are they persisting?</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Containment -->
                <h2><i class="fas fa-shield-alt"></i> Phase 3a: Containment</h2>
                <div class="config-section">
                    <h4>Containment Strategies</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Strategy</th><th>When to Use</th><th>Actions</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Network Isolation</strong></td>
                                <td>Active lateral movement, C2 communication</td>
                                <td>Block at firewall, VLAN isolation, EDR network contain</td>
                            </tr>
                            <tr>
                                <td><strong>Host Isolation</strong></td>
                                <td>Confirmed endpoint compromise</td>
                                <td>EDR isolation, disable network adapter</td>
                            </tr>
                            <tr>
                                <td><strong>Account Disable</strong></td>
                                <td>Compromised credentials</td>
                                <td>Disable account, reset password, revoke tokens</td>
                            </tr>
                            <tr>
                                <td><strong>Block IOCs</strong></td>
                                <td>Known malicious indicators</td>
                                <td>Block IPs/domains at firewall/proxy, hash blocklist</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Containment Decision Matrix</h4>
                    <div class="code-block">IF active ransomware:
   └─ IMMEDIATE: Isolate all affected systems
   └─ Block lateral movement paths
   └─ Preserve evidence before containment

IF data exfiltration in progress:
   └─ Block destination IPs/domains
   └─ Isolate source systems
   └─ Preserve network captures

IF credential compromise:
   └─ Disable affected accounts
   └─ Force password reset
   └─ Revoke all active sessions
   └─ Check for persistence

IF C2 communication active:
   └─ Block C2 domains/IPs
   └─ Isolate communicating hosts
   └─ Monitor for fallback channels</div>

                    <h4>Containment Commands by Platform</h4>
                    <div class="code-block">// Cortex XDR - Isolate Endpoint
!xdr-isolate-endpoint endpoint_id="xxx" 

// CrowdStrike - Network Contain
!cs-falcon-network-contain ids="xxx"

// Microsoft Defender - Isolate Machine
!microsoft-atp-isolate-machine machine_id="xxx" isolation_type="Full"

// Active Directory - Disable Account
!ad-disable-account username="compromised_user"

// Palo Alto Firewall - Block IP
!pan-os-block-ip ip="1.2.3.4"</div>
                </div>

                <!-- Eradication -->
                <h2><i class="fas fa-trash-alt"></i> Phase 3b: Eradication</h2>
                <div class="config-section">
                    <h4>Eradication Checklist</h4>
                    <div class="code-block">□ Remove malware from all affected systems
□ Delete persistence mechanisms
   - Registry run keys
   - Scheduled tasks
   - Services
   - WMI subscriptions
   - Startup folders
□ Remove attacker tools
□ Patch exploited vulnerabilities
□ Reset all compromised credentials
□ Revoke any attacker-created accounts
□ Remove unauthorized access (VPN, SSH keys)
□ Clean up attacker's foothold</div>

                    <h4>Persistence Locations to Check</h4>
                    <div class="code-block">Windows Persistence:
├─ Registry Run Keys
│   HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
│   HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
├─ Scheduled Tasks
│   C:\Windows\System32\Tasks\
├─ Services
│   HKLM\SYSTEM\CurrentControlSet\Services
├─ Startup Folders
│   C:\Users\*\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
├─ WMI Event Subscriptions
│   Get-WMIObject -Namespace root\Subscription -Class __EventFilter
└─ DLL Search Order Hijacking
    Check for unsigned DLLs in application directories

Linux Persistence:
├─ Cron jobs: /etc/crontab, /etc/cron.d/*, user crontabs
├─ Systemd services: /etc/systemd/system/
├─ Init scripts: /etc/init.d/
├─ SSH authorized_keys: ~/.ssh/authorized_keys
├─ Shell profiles: .bashrc, .profile, .bash_profile
└─ LD_PRELOAD: /etc/ld.so.preload</div>
                </div>

                <!-- Recovery -->
                <h2><i class="fas fa-sync-alt"></i> Phase 3c: Recovery</h2>
                <div class="config-section">
                    <h4>Recovery Steps</h4>
                    <ol style="color: #8b949e;">
                        <li><strong>Verify eradication:</strong> Confirm no active threats remain</li>
                        <li><strong>Restore from backup:</strong> Use known-good backups if needed</li>
                        <li><strong>Rebuild systems:</strong> Reimage compromised systems when necessary</li>
                        <li><strong>Restore services:</strong> Bring systems back online in priority order</li>
                        <li><strong>Validate functionality:</strong> Test systems before full restoration</li>
                        <li><strong>Enhanced monitoring:</strong> Increase monitoring for recurrence</li>
                    </ol>

                    <h4>Recovery Validation</h4>
                    <div class="code-block">Before returning system to production:

□ Full malware scan completed (clean)
□ All patches applied
□ Credentials reset
□ Persistence mechanisms removed (verified)
□ No suspicious processes running
□ Network connections normal
□ User tested core functionality
□ Enhanced monitoring in place
□ Recovery documented</div>

                    <h4>Prioritization for Recovery</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Priority</th><th>Systems</th><th>Rationale</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1 - Critical</td>
                                <td>Domain controllers, authentication, security tools</td>
                                <td>Required for other recovery</td>
                            </tr>
                            <tr>
                                <td>2 - High</td>
                                <td>Core business applications, databases</td>
                                <td>Business operations</td>
                            </tr>
                            <tr>
                                <td>3 - Medium</td>
                                <td>User workstations, email</td>
                                <td>Employee productivity</td>
                            </tr>
                            <tr>
                                <td>4 - Low</td>
                                <td>Development, test systems</td>
                                <td>Non-critical operations</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Post-Incident -->
                <h2><i class="fas fa-clipboard-check"></i> Phase 4: Post-Incident</h2>
                <div class="config-section">
                    <h4>Post-Incident Review (Lessons Learned)</h4>
                    <div class="code-block">Post-Incident Review Meeting Agenda:

1. Incident Timeline
   - When was it detected?
   - How long did response take?
   - Key milestones

2. What Happened
   - Root cause analysis
   - Attack vector
   - Impact assessment

3. What Went Well
   - Effective detections
   - Fast response actions
   - Good communication

4. What Could Improve
   - Detection gaps
   - Response delays
   - Process issues
   - Tool limitations

5. Action Items
   - Detection improvements
   - Process changes
   - Training needs
   - Tool enhancements

6. Metrics Review
   - Time to detect
   - Time to contain
   - Time to recover</div>

                    <h4>Documentation Requirements</h4>
                    <div class="code-block">Incident Report Template:

EXECUTIVE SUMMARY
- Brief description of incident
- Business impact
- Resolution status

INCIDENT DETAILS
- Incident ID and classification
- Date/time detected
- Date/time contained
- Date/time resolved
- Systems affected
- Data affected

TIMELINE
- Chronological list of events
- Detection → Analysis → Containment → Eradication → Recovery

TECHNICAL ANALYSIS
- Attack vector
- Techniques used (MITRE ATT&CK)
- IOCs discovered
- Root cause

RESPONSE ACTIONS
- Containment actions taken
- Eradication steps
- Recovery procedures

LESSONS LEARNED
- Detection gaps
- Process improvements
- Recommendations

ATTACHMENTS
- IOC list
- Affected asset inventory
- Evidence log</div>
                </div>

                <!-- Common Incident Types -->
                <h2><i class="fas fa-exclamation-circle"></i> Common Incident Playbooks</h2>
                <div class="config-section">
                    <h4>Ransomware Response</h4>
                    <div class="code-block">IMMEDIATE ACTIONS (First 30 minutes):
1. Isolate affected systems from network
2. Identify ransomware variant (ransom note, extension)
3. Stop spread - block internal lateral movement
4. Preserve evidence (memory dump if possible)
5. Notify IR lead and management

ASSESSMENT:
- Scope: How many systems encrypted?
- Data: What data is affected?
- Backups: Are backups intact and clean?
- Decrypt: Is decryption possible? (check NoMoreRansom.org)

CONTAINMENT:
- Network isolation of affected segments
- Block C2 communication
- Disable vulnerable services
- Password reset for affected domain

RECOVERY:
- Do NOT pay ransom (generally)
- Restore from clean backups
- Rebuild systems from gold images
- Validate before reconnecting

POST-INCIDENT:
- Root cause analysis
- Improve backup procedures
- Enhance monitoring</div>

                    <h4>Business Email Compromise</h4>
                    <div class="code-block">IMMEDIATE ACTIONS:
1. Disable compromised account
2. Revoke all active sessions
3. Check for mail forwarding rules
4. Review recent email activity
5. Notify potentially affected parties

INVESTIGATION:
- How was account compromised? (phishing, credential stuffing)
- What emails were sent from the account?
- What data was accessed?
- Were any financial transactions initiated?

CONTAINMENT:
- Remove malicious mail rules
- Block attacker's IP addresses
- Enable MFA if not already
- Check for OAuth app consents

RECOVERY:
- Reset password with strong unique password
- Re-enable account with MFA
- Monitor for suspicious activity
- Notify recipients of fraudulent emails

FINANCIAL FRAUD RESPONSE:
- Contact bank immediately
- Work with finance to recall wire transfers
- Preserve evidence for law enforcement
- Consider FBI IC3 report</div>

                    <h4>Data Breach Response</h4>
                    <div class="code-block">IMMEDIATE ACTIONS:
1. Stop active exfiltration
2. Preserve evidence
3. Notify legal/privacy team
4. Begin scope assessment

ASSESSMENT:
- What data was accessed/stolen?
- How many records affected?
- What type of data? (PII, PHI, financial)
- Who are the data subjects?

LEGAL/REGULATORY:
- Determine notification requirements
  - GDPR: 72-hour notification
  - HIPAA: 60-day notification
  - State breach laws vary
- Engage legal counsel
- Prepare breach notification

COMMUNICATION:
- Internal: Leadership, legal, PR
- External: Regulators, affected individuals
- Consider credit monitoring offering

DOCUMENTATION:
- Maintain chain of custody
- Document all response actions
- Preserve for potential litigation</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk me through how you would respond to a ransomware incident.</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Immediate isolation:</strong> Disconnect affected systems from network to stop spread</li>
                                <li><strong>Identify variant:</strong> Check ransom note, file extension for decryption possibility</li>
                                <li><strong>Scope assessment:</strong> Determine how many systems affected, what data encrypted</li>
                                <li><strong>Preserve evidence:</strong> Memory dumps, logs before wiping</li>
                                <li><strong>Check backups:</strong> Verify backups are intact and not encrypted</li>
                                <li><strong>Eradicate:</strong> Remove ransomware, persistence mechanisms</li>
                                <li><strong>Recover:</strong> Restore from backups, rebuild if necessary</li>
                                <li><strong>Post-incident:</strong> Root cause analysis, improve defenses</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you balance evidence preservation with containment?</button>
                        <div class="qa-answer">
                            <p><strong>General principle:</strong> Containment takes priority if attack is ongoing and causing damage.</p>
                            <ul>
                                <li><strong>Memory capture:</strong> If time allows, capture memory before isolation</li>
                                <li><strong>Log preservation:</strong> Ensure logs are forwarded to SIEM before wiping</li>
                                <li><strong>Disk imaging:</strong> Can often do after containment if system is isolated</li>
                                <li><strong>Documentation:</strong> Document what was done and when</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Order of priority:</strong></p>
                            <ol>
                                <li>Stop active damage (containment)</li>
                                <li>Preserve volatile evidence (memory)</li>
                                <li>Preserve non-volatile evidence (disk)</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What metrics do you use to measure incident response effectiveness?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>MTTD (Mean Time to Detect):</strong> Time from attack start to detection</li>
                                <li><strong>MTTC (Mean Time to Contain):</strong> Time from detection to containment</li>
                                <li><strong>MTTR (Mean Time to Recover):</strong> Time from containment to full recovery</li>
                                <li><strong>Incidents per analyst:</strong> Workload metric</li>
                                <li><strong>Escalation rate:</strong> % requiring escalation</li>
                                <li><strong>Recurrence rate:</strong> % of incidents that reoccur</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>