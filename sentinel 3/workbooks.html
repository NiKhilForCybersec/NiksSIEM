<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workbooks | Microsoft Sentinel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Sentinel Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Data Tiers & Costs</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-connectors.html" class="nav-link"><i class="fas fa-plug"></i> Data Connectors</a>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="dcr-dce-guide.html" class="nav-link"><i class="fas fa-route"></i> DCR/DCE Pipeline</a>
                    <a href="custom-log-onboarding.html" class="nav-link"><i class="fas fa-file-import"></i> Custom Onboarding</a>
                    <a href="event-hub.html" class="nav-link"><i class="fas fa-broadcast-tower"></i> Event Hub</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & ASIM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">KQL Query Language</div>
                    <a href="kql-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> KQL Fundamentals</a>
                    <a href="kql-intermediate.html" class="nav-link"><i class="fas fa-code"></i> KQL Intermediate</a>
                    <a href="kql-advanced.html" class="nav-link"><i class="fas fa-rocket"></i> KQL Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection & Response</div>
                    <a href="analytics-rules.html" class="nav-link"><i class="fas fa-project-diagram"></i> Analytics Rules</a>
                    <a href="threat-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Hunting</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intelligence</a>
                    <a href="automation.html" class="nav-link"><i class="fas fa-robot"></i> Automation</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Tools & Content</div>
                    <a href="workbooks.html" class="nav-link active"><i class="fas fa-chart-bar"></i> Workbooks</a>
                    <a href="content-hub.html" class="nav-link"><i class="fas fa-store"></i> Content Hub</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Sentinel</a><span class="separator">/</span>
                    <span class="current">Workbooks</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-chart-bar"></i> Workbooks</h1>
                <p class="lead">Create interactive dashboards and reports in Microsoft Sentinel using Workbooks. Visualize security data, track metrics, and build SOC operational views.</p>

                <!-- Workbooks Overview -->
                <h2><i class="fas fa-info-circle"></i> Workbooks Overview</h2>
                <div class="config-section">
                    <p><span class="console-path">Sentinel → Threat Management → Workbooks</span></p>

                    <h4>Workbook Capabilities</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Visualizations:</strong> Charts, grids, tiles, maps</li>
                        <li><strong>Interactive:</strong> Parameters, filters, drill-downs</li>
                        <li><strong>Data sources:</strong> Logs, metrics, Azure Resource Graph</li>
                        <li><strong>Templates:</strong> Pre-built and custom</li>
                        <li><strong>Sharing:</strong> Save and share with team</li>
                    </ul>

                    <h4>Workbook Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Description</th><th>Use Case</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Templates</strong></td>
                                <td>Pre-built from Content Hub</td>
                                <td>Quick start, standard views</td>
                            </tr>
                            <tr>
                                <td><strong>My Workbooks</strong></td>
                                <td>Personal saved workbooks</td>
                                <td>Custom analysis</td>
                            </tr>
                            <tr>
                                <td><strong>Shared</strong></td>
                                <td>Team-accessible workbooks</td>
                                <td>SOC dashboards</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Essential Workbooks -->
                <h2><i class="fas fa-star"></i> Essential Security Workbooks</h2>
                <div class="config-section">
                    <h4>Built-in Templates</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Workbook</th><th>Purpose</th><th>Key Metrics</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Security Operations Efficiency</strong></td>
                                <td>SOC performance tracking</td>
                                <td>MTTD, MTTR, alert volume</td>
                            </tr>
                            <tr>
                                <td><strong>Azure AD Sign-in Logs</strong></td>
                                <td>Authentication analysis</td>
                                <td>Sign-ins, failures, MFA</td>
                            </tr>
                            <tr>
                                <td><strong>Investigation Insights</strong></td>
                                <td>Entity investigation</td>
                                <td>User/host activity</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Defender for Endpoint</strong></td>
                                <td>Endpoint security</td>
                                <td>Alerts, devices, vulnerabilities</td>
                            </tr>
                            <tr>
                                <td><strong>Threat Intelligence</strong></td>
                                <td>IOC analysis</td>
                                <td>IOC matches, sources</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Creating Workbooks -->
                <h2><i class="fas fa-plus-circle"></i> Creating Custom Workbooks</h2>
                <div class="config-section">
                    <p><span class="console-path">Workbooks → Add workbook</span></p>

                    <h4>Workbook Elements</h4>
                    <div class="code-block">Available Elements:

Text:
- Markdown formatted text
- Headers and descriptions
- Links and documentation

Parameters:
- Time range picker
- Dropdown selections
- Resource picker
- Text input

Query:
- KQL queries
- Visualizations (chart, grid, tile)
- Conditional formatting

Links:
- Navigation between views
- External links
- Action buttons

Groups:
- Organize elements
- Tabs and sections
- Collapsible areas</div>

                    <h4>Adding a Query Visualization</h4>
                    <div class="code-block">1. Click "Add" → "Add query"

2. Enter KQL Query:
SecurityAlert
| where TimeGenerated > ago(7d)
| summarize Count = count() by AlertSeverity
| order by Count desc

3. Select Visualization:
- Bar chart
- Pie chart
- Line chart
- Grid (table)
- Tiles

4. Configure Settings:
- Chart title
- Legend position
- Colors
- Size

5. Save workbook</div>
                </div>

                <!-- Parameters -->
                <h2><i class="fas fa-sliders-h"></i> Parameters</h2>
                <div class="config-section">
                    <h4>Parameter Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Description</th><th>Example</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Time Range</strong></td>
                                <td>Date/time picker</td>
                                <td>Last 24 hours, 7 days</td>
                            </tr>
                            <tr>
                                <td><strong>Dropdown</strong></td>
                                <td>Selection list</td>
                                <td>Severity filter</td>
                            </tr>
                            <tr>
                                <td><strong>Text</strong></td>
                                <td>Free text input</td>
                                <td>User search</td>
                            </tr>
                            <tr>
                                <td><strong>Resource</strong></td>
                                <td>Azure resource picker</td>
                                <td>Workspace selection</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Time Range Parameter</h4>
                    <div class="code-block">Creating Time Range Parameter:

1. Add → Add parameter
2. Parameter name: TimeRange
3. Parameter type: Time range picker
4. Required: Yes
5. Default: Last 24 hours

Using in Queries:
SecurityAlert
| where TimeGenerated {TimeRange}
| summarize count() by AlertName</div>

                    <h4>Dropdown Parameter</h4>
                    <div class="code-block">Creating Severity Dropdown:

1. Add → Add parameter
2. Parameter name: Severity
3. Parameter type: Dropdown
4. Get data from: Query

Query:
SecurityAlert
| distinct AlertSeverity
| order by AlertSeverity asc

Using in Queries:
SecurityAlert
| where TimeGenerated {TimeRange}
| where AlertSeverity == "{Severity}" or "{Severity}" == "All"
| summarize count() by AlertName</div>
                </div>

                <!-- SOC Dashboard Examples -->
                <h2><i class="fas fa-tachometer-alt"></i> SOC Dashboard Examples</h2>
                <div class="config-section">
                    <h4>Alert Overview Dashboard</h4>
                    <div class="code-block">// Total Alerts Tile
SecurityAlert
| where TimeGenerated {TimeRange}
| count

// Alerts by Severity (Pie Chart)
SecurityAlert
| where TimeGenerated {TimeRange}
| summarize Count = count() by AlertSeverity
| order by Count desc

// Alerts Trend (Line Chart)
SecurityAlert
| where TimeGenerated {TimeRange}
| summarize Count = count() by bin(TimeGenerated, 1h)
| order by TimeGenerated asc

// Top Alert Types (Bar Chart)
SecurityAlert
| where TimeGenerated {TimeRange}
| summarize Count = count() by AlertName
| top 10 by Count
| order by Count desc

// Recent Alerts (Grid)
SecurityAlert
| where TimeGenerated {TimeRange}
| project TimeGenerated, AlertName, AlertSeverity, 
          ProviderName, Status
| order by TimeGenerated desc
| take 100</div>

                    <h4>Incident Status Dashboard</h4>
                    <div class="code-block">// Open Incidents by Severity
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status != "Closed"
| summarize Count = count() by Severity

// Incidents by Status
SecurityIncident
| where TimeGenerated > ago(30d)
| summarize Count = count() by Status

// Mean Time to Triage
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status != "New"
| extend MTTT = datetime_diff('minute', FirstModifiedTime, CreatedTime)
| summarize AvgMTTT = avg(MTTT)

// Incidents by Owner
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Active"
| summarize Count = count() by Owner.assignedTo
| order by Count desc</div>
                </div>

                <!-- Investigation Workbook -->
                <h2><i class="fas fa-search"></i> Investigation Workbooks</h2>
                <div class="config-section">
                    <h4>User Investigation Template</h4>
                    <div class="code-block">Parameters:
- TimeRange: Time range picker
- UserAccount: Text input

// User Sign-in Activity
SigninLogs
| where TimeGenerated {TimeRange}
| where UserPrincipalName =~ "{UserAccount}"
| project TimeGenerated, ResultType, IPAddress, 
          AppDisplayName, Location = strcat(LocationDetails.city)
| order by TimeGenerated desc

// Failed Sign-ins
SigninLogs
| where TimeGenerated {TimeRange}
| where UserPrincipalName =~ "{UserAccount}"
| where ResultType != 0
| summarize FailedCount = count() by IPAddress, ResultDescription
| order by FailedCount desc

// User Alerts
SecurityAlert
| where TimeGenerated {TimeRange}
| where Entities contains "{UserAccount}"
| project TimeGenerated, AlertName, AlertSeverity, Description

// User Audit Activity
AuditLogs
| where TimeGenerated {TimeRange}
| where InitiatedBy.user.userPrincipalName =~ "{UserAccount}"
| project TimeGenerated, OperationName, Result, TargetResources</div>

                    <h4>Host Investigation Template</h4>
                    <div class="code-block">Parameters:
- TimeRange: Time range picker
- HostName: Text input

// Device Alerts
SecurityAlert
| where TimeGenerated {TimeRange}
| where Entities contains "{HostName}"
| project TimeGenerated, AlertName, AlertSeverity

// Process Executions
DeviceProcessEvents
| where TimeGenerated {TimeRange}
| where DeviceName =~ "{HostName}"
| project TimeGenerated, FileName, ProcessCommandLine, AccountName

// Network Connections
DeviceNetworkEvents
| where TimeGenerated {TimeRange}
| where DeviceName =~ "{HostName}"
| summarize Connections = count() by RemoteIP, RemotePort
| order by Connections desc

// Logon Events
DeviceLogonEvents
| where TimeGenerated {TimeRange}
| where DeviceName =~ "{HostName}"
| project TimeGenerated, AccountName, LogonType, RemoteIP</div>
                </div>

                <!-- Visualization Best Practices -->
                <h2><i class="fas fa-palette"></i> Visualization Best Practices</h2>
                <div class="config-section">
                    <div class="code-block">Visualization Selection:

TILES: Single metrics, KPIs
- Total alerts
- Open incidents
- MTTR value

PIE CHARTS: Proportions
- Alerts by severity
- Incidents by status
- Traffic by protocol

BAR CHARTS: Comparisons
- Top attack sources
- Alerts by type
- Users with most failures

LINE CHARTS: Trends over time
- Alert volume trend
- Login attempts
- Incident creation rate

GRIDS: Detailed data
- Alert list
- Investigation results
- Audit trail

MAPS: Geographic data
- Attack sources
- User locations
- Global threat view</div>

                    <h4>Design Tips</h4>
                    <ul style="color: #8b949e;">
                        <li><strong>Keep it simple:</strong> Don't overcrowd</li>
                        <li><strong>Use consistent colors:</strong> Red for critical, etc.</li>
                        <li><strong>Add context:</strong> Text explanations</li>
                        <li><strong>Enable interactivity:</strong> Drill-down capability</li>
                        <li><strong>Optimize queries:</strong> Fast-loading dashboards</li>
                    </ul>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How would you build a SOC metrics dashboard in Sentinel?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Define metrics:</strong> MTTD, MTTR, alert volume, FP rate</li>
                                <li><strong>Create parameters:</strong> Time range, severity filter</li>
                                <li><strong>Build KQL queries:</strong> Calculate each metric</li>
                                <li><strong>Choose visualizations:</strong> Tiles for KPIs, trends for charts</li>
                                <li><strong>Add drill-downs:</strong> Click to see details</li>
                                <li><strong>Share with team:</strong> Save as shared workbook</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What's the difference between workbooks and dashboards?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Workbooks:</strong> Interactive, parameters, multiple pages, detailed analysis</li>
                                <li><strong>Azure Dashboards:</strong> Fixed layout, quick overview, pins from various sources</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Use Workbooks for:</strong> Detailed investigation, SOC operations, interactive analysis</p>
                            <p><strong>Use Dashboards for:</strong> At-a-glance monitoring, executive view, cross-service visibility</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you use parameters to make workbooks interactive?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Time range:</strong> Filter all queries by selected period</li>
                                <li><strong>Dropdown:</strong> Filter by severity, user, etc.</li>
                                <li><strong>Text input:</strong> Search for specific entity</li>
                                <li><strong>Resource:</strong> Select workspace or subscription</li>
                            </ul>
                            <p style="margin-top: 12px;">Reference parameters in queries using {ParameterName} syntax. This creates dynamic, user-driven dashboards.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>