<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MITRE ATT&CK Mapping | SOC Operations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <main class="main-content">
            <a href="../index.html" class="back-home"><i class="fas fa-arrow-left"></i> Nik's SIEM</a>
            
            <div class="breadcrumb">
                <a href="../index.html">Home</a>
                <span class="separator">/</span>
                <a href="index.html">SOC Operations</a>
                <span class="separator">/</span>
                <span class="current">MITRE ATT&CK Mapping</span>
            </div>

<h1><i class="fas fa-map"></i> MITRE ATT&CK Mapping</h1>
                <p class="lead">Master the MITRE ATT&CK framework for SOC operations. Learn tactics, techniques, and procedures (TTPs), coverage mapping, detection gap analysis, and how to operationalize ATT&CK for threat detection.</p>

                <!-- MITRE ATT&CK Overview -->
                <h2><i class="fas fa-info-circle"></i> MITRE ATT&CK Overview</h2>
                <div class="config-section">
                    <h4>What is MITRE ATT&CK?</h4>
                    <div class="code-block">MITRE ATT&CK Framework:

DEFINITION:
Adversarial Tactics, Techniques, and Common Knowledge - 
A globally accessible knowledge base of adversary 
tactics and techniques based on real-world observations.

FRAMEWORK STRUCTURE:
├── Tactics: The "why" - adversary goals
├── Techniques: The "how" - methods to achieve goals
├── Sub-techniques: Specific implementations
└── Procedures: Real-world examples

MATRICES AVAILABLE:
├── Enterprise: Windows, macOS, Linux, Cloud, Network
├── Mobile: Android, iOS
├── ICS: Industrial Control Systems
└── Containers: Container-specific techniques

KEY COMPONENTS:
├── Tactics (14): High-level adversary goals
├── Techniques (~200): Methods to achieve goals
├── Sub-techniques (~400): Specific variations
├── Mitigations: How to prevent techniques
├── Detections: How to identify techniques
├── Groups: Threat actor profiles
├── Software: Malware and tools
└── Data Sources: Logs needed for detection

USE CASES:
├── Detection engineering prioritization
├── Gap analysis and coverage mapping
├── Threat intelligence correlation
├── Red team/purple team exercises
├── Security posture assessment
└── Vendor evaluation</div>

                    <h4>Enterprise Tactics</h4>
                    <div class="code-block">MITRE ATT&CK Enterprise Tactics (Kill Chain):

TA0043 - RECONNAISSANCE
├── Gathering information about target
├── Examples: Active scanning, search open websites
└── Often before initial access

TA0042 - RESOURCE DEVELOPMENT
├── Establishing infrastructure
├── Examples: Acquire domains, develop malware
└── Preparation phase

TA0001 - INITIAL ACCESS
├── Getting into the network
├── Examples: Phishing, valid accounts, exploits
└── Entry point detection critical

TA0002 - EXECUTION
├── Running malicious code
├── Examples: PowerShell, WMI, command line
└── High detection opportunity

TA0003 - PERSISTENCE
├── Maintaining access
├── Examples: Registry run keys, scheduled tasks
└── Detectable through change monitoring

TA0004 - PRIVILEGE ESCALATION
├── Gaining higher permissions
├── Examples: Token manipulation, exploits
└── Watch for unexpected privilege changes

TA0005 - DEFENSE EVASION
├── Avoiding detection
├── Examples: Obfuscation, disabling security tools
└── Hardest to detect

TA0006 - CREDENTIAL ACCESS
├── Stealing credentials
├── Examples: LSASS dump, keylogging, Kerberoasting
└── Critical detection point

TA0007 - DISCOVERY
├── Learning about environment
├── Examples: Network scanning, system enumeration
└── Can be noisy, good detection opportunity

TA0008 - LATERAL MOVEMENT
├── Moving through network
├── Examples: RDP, SMB, PsExec, WinRM
└── Critical for containing breaches

TA0009 - COLLECTION
├── Gathering target data
├── Examples: Screen capture, email collection
└── Pre-exfiltration activity

TA0011 - COMMAND AND CONTROL
├── Communicating with compromised systems
├── Examples: Web protocols, DNS tunneling
└── Network-based detection

TA0010 - EXFILTRATION
├── Stealing data
├── Examples: Cloud storage, HTTP(S), DNS
└── DLP and network monitoring

TA0040 - IMPACT
├── Disrupting systems
├── Examples: Ransomware, data destruction
└── Often the final stage</div>
                </div>

                <!-- Key Techniques -->
                <h2><i class="fas fa-code"></i> Key Techniques for SOC</h2>
                <div class="config-section">
                    <h4>High-Priority Detection Techniques</h4>
                    <div class="code-block">Priority Techniques for SOC Detection:

EXECUTION:
├── T1059.001 - PowerShell
│   ├── Detection: Command line logging, script block logging
│   └── Data: Windows Event 4104, 4103, process events
├── T1059.003 - Windows Command Shell
│   ├── Detection: Command line monitoring
│   └── Data: Process events with command line
├── T1047 - WMI
│   ├── Detection: WMI event logging
│   └── Data: WMI-Activity/Operational log
└── T1053.005 - Scheduled Task
    ├── Detection: Task creation monitoring
    └── Data: Windows Event 4698, registry

PERSISTENCE:
├── T1547.001 - Registry Run Keys
│   ├── Detection: Registry monitoring
│   └── Data: Registry events, Sysmon 13
├── T1543.003 - Windows Service
│   ├── Detection: Service creation
│   └── Data: Windows Event 7045, 4697
└── T1136 - Create Account
    ├── Detection: Account creation monitoring
    └── Data: Windows Event 4720

CREDENTIAL ACCESS:
├── T1003.001 - LSASS Memory
│   ├── Detection: Process access to LSASS
│   └── Data: Sysmon 10, EDR telemetry
├── T1558.003 - Kerberoasting
│   ├── Detection: Abnormal TGS requests
│   └── Data: Windows Event 4769
└── T1110 - Brute Force
    ├── Detection: Failed logon patterns
    └── Data: Windows Event 4625, auth logs

LATERAL MOVEMENT:
├── T1021.001 - Remote Desktop
│   ├── Detection: RDP session monitoring
│   └── Data: Windows Event 4624 (Type 10)
├── T1021.002 - SMB/Windows Admin Shares
│   ├── Detection: Share access monitoring
│   └── Data: Windows Event 5140, 5145
└── T1021.006 - Windows Remote Management
    ├── Detection: WinRM connections
    └── Data: Windows Event 4624 (Type 3), WinRM logs</div>

                    <h4>Technique Data Sources</h4>
                    <div class="code-block">Data Sources by Technique Category:

PROCESS MONITORING:
├── Required for: Execution, Defense Evasion
├── Sources:
│   ├── Windows Event 4688 (with command line)
│   ├── Sysmon Event 1
│   ├── EDR process telemetry
│   └── PowerShell logging (4103, 4104)
├── Key fields: Process name, command line, parent, user
└── Coverage: ~60% of techniques

AUTHENTICATION:
├── Required for: Credential Access, Lateral Movement
├── Sources:
│   ├── Windows Event 4624, 4625, 4648
│   ├── Azure AD Sign-in logs
│   ├── VPN authentication logs
│   └── Application auth logs
├── Key fields: User, source IP, logon type, status
└── Coverage: ~20% of techniques

NETWORK:
├── Required for: C2, Exfiltration, Lateral Movement
├── Sources:
│   ├── Firewall logs
│   ├── Proxy logs
│   ├── DNS logs
│   ├── NetFlow/IPFIX
│   └── EDR network events
├── Key fields: Source/dest IP, port, protocol, bytes
└── Coverage: ~15% of techniques

FILE/REGISTRY:
├── Required for: Persistence, Collection
├── Sources:
│   ├── Sysmon Event 11, 13
│   ├── Windows Event 4663
│   ├── EDR file/registry events
│   └── FIM solutions
├── Key fields: Path, action, process, user
└── Coverage: ~25% of techniques</div>
                </div>

                <!-- Coverage Mapping -->
                <h2><i class="fas fa-chart-pie"></i> Coverage Mapping</h2>
                <div class="config-section">
                    <h4>Coverage Assessment Process</h4>
                    <div class="code-block">Detection Coverage Assessment:

STEP 1: INVENTORY DETECTIONS
├── Export all analytics rules/correlation searches
├── Document rule logic and data sources
├── Note severity and confidence
└── Include both custom and vendor rules

STEP 2: MAP TO ATT&CK
├── For each detection, identify:
│   ├── Primary technique(s)
│   ├── Sub-techniques covered
│   ├── Detection confidence (high/medium/low)
│   └── Data sources used
└── Use ATT&CK Navigator for visualization

STEP 3: IDENTIFY GAPS
├── Highlight unmapped techniques
├── Prioritize by:
│   ├── Threat intelligence (what's targeting you)
│   ├── Industry prevalence
│   ├── Attack chain criticality
│   └── Data source availability
└── Create gap remediation roadmap

STEP 4: ASSESS QUALITY
├── Detection coverage != detection quality
├── For each mapped technique:
│   ├── Can we detect all sub-techniques?
│   ├── What's the detection latency?
│   ├── What's the false positive rate?
│   └── Can adversary easily evade?
└── Score: None, Low, Medium, High

COVERAGE METRICS:
├── Technique Coverage: % of techniques with detection
├── Tactic Coverage: % per tactic
├── Data Source Coverage: % of needed sources ingested
└── Quality Score: Weighted coverage by quality</div>

                    <h4>ATT&CK Navigator</h4>
                    <div class="code-block">ATT&CK Navigator Usage:

URL: https://mitre-attack.github.io/attack-navigator/

LAYER CREATION:
├── Manual selection of techniques
├── Import from JSON/Excel
├── Score-based coloring
└── Multiple layers for comparison

SCORING SCHEME (Example):
├── 0 (None): No detection capability
├── 1 (Low): Basic detection, high FP rate
├── 2 (Medium): Good detection, some gaps
├── 3 (High): Comprehensive, tested detection
└── 4 (Excellent): Advanced, tuned, validated

COLOR CODING:
├── Red: No coverage (high priority)
├── Orange: Low coverage (medium priority)
├── Yellow: Medium coverage (ongoing improvement)
├── Green: High coverage (maintain)
└── Blue: Excellent coverage (complete)

LAYER COMPARISON:
├── Current state vs target state
├── Detection vs prevention coverage
├── Coverage by data source
├── Before/after improvements
└── Team A vs Team B assessments

EXPORT OPTIONS:
├── JSON for version control
├── Excel for reporting
├── SVG/PNG for presentations
└── Share via URL</div>
                </div>

                <!-- Operationalizing ATT&CK -->
                <h2><i class="fas fa-cogs"></i> Operationalizing ATT&CK</h2>
                <div class="config-section">
                    <h4>Detection Engineering Workflow</h4>
                    <div class="code-block">ATT&CK-Driven Detection Engineering:

1. THREAT INTEL → TECHNIQUE IDENTIFICATION
   ├── Review threat reports for TTPs
   ├── Map adversary tools to techniques
   ├── Identify techniques targeting your industry
   └── Prioritize based on risk

2. TECHNIQUE → DATA SOURCE ANALYSIS
   ├── What data do we need?
   ├── Do we have the data?
   ├── Is the data quality sufficient?
   └── What's the ingestion gap?

3. DATA SOURCE → DETECTION LOGIC
   ├── What does the technique look like?
   ├── What are the indicators?
   ├── How do we distinguish from legitimate?
   └── What are the evasion methods?

4. DETECTION → VALIDATION
   ├── Test with Atomic Red Team
   ├── Purple team exercises
   ├── Detection engineering lab
   └── Production validation

5. VALIDATION → PRODUCTION
   ├── Deploy to production SIEM
   ├── Monitor for false positives
   ├── Tune as needed
   └── Document in ATT&CK mapping

EXAMPLE WORKFLOW:
Threat Intel: APT29 using T1059.001 (PowerShell)
↓
Data Needed: PowerShell script block logging (4104)
↓
Detection Logic: Encoded commands, download cradles
↓
Test: Atomic Red Team T1059.001
↓
Deploy: Correlation rule in Sentinel/Splunk
↓
Map: Update ATT&CK Navigator layer</div>

                    <h4>Incident Investigation with ATT&CK</h4>
                    <div class="code-block">Using ATT&CK During Incident Investigation:

INITIAL ALERT → TECHNIQUE IDENTIFICATION:
├── What technique triggered the alert?
├── What tactic does it represent?
├── Where in kill chain are we?
└── What typically comes before/after?

TACTIC-BASED HUNTING:
Example: Alert for T1059.001 (PowerShell Execution)

HUNT BACKWARD (How did they get here?):
├── Initial Access (TA0001):
│   └── Check email, web downloads
├── Previous Execution:
│   └── What triggered PowerShell?
└── Persistence:
    └── Already established? How long?

HUNT FORWARD (What might they do next?):
├── Persistence (TA0003):
│   └── Check for new scheduled tasks, run keys
├── Credential Access (TA0006):
│   └── Check for LSASS access, mimikatz
├── Lateral Movement (TA0008):
│   └── Check for RDP, SMB, WinRM
└── Discovery (TA0007):
    └── Check for recon commands

TIMELINE CORRELATION:
├── Map all events to ATT&CK techniques
├── Build kill chain timeline
├── Identify gaps (what might we have missed?)
└── Scope impact based on technique progression</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What is MITRE ATT&CK and how do you use it?</button>
                        <div class="qa-answer">
                            <p><strong>MITRE ATT&CK</strong> is a knowledge base of adversary tactics, techniques, and procedures (TTPs) based on real-world observations.</p>
                            <p><strong>SOC uses:</strong></p>
                            <ul>
                                <li>Detection engineering prioritization</li>
                                <li>Gap analysis - what techniques can't we detect?</li>
                                <li>Incident investigation - mapping alerts to kill chain</li>
                                <li>Threat intelligence - understanding adversary behavior</li>
                                <li>Communication - common language for threats</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you assess detection coverage?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Inventory:</strong> Export all detection rules</li>
                                <li><strong>Map:</strong> Associate each rule with ATT&CK technique(s)</li>
                                <li><strong>Visualize:</strong> Use ATT&CK Navigator to show coverage</li>
                                <li><strong>Score:</strong> Rate detection quality (none/low/medium/high)</li>
                                <li><strong>Prioritize gaps:</strong> Based on threat intel and risk</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Name some high-priority techniques for detection.</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>T1059.001:</strong> PowerShell - very common for execution</li>
                                <li><strong>T1003.001:</strong> LSASS Memory - credential theft</li>
                                <li><strong>T1547.001:</strong> Registry Run Keys - persistence</li>
                                <li><strong>T1021.001:</strong> RDP - lateral movement</li>
                                <li><strong>T1071.001:</strong> Web Protocols - C2 communication</li>
                            </ul>
                            <p>Prioritize based on your threat landscape and data availability.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How do you use ATT&CK during incident investigation?</button>
                        <div class="qa-answer">
                            <ol>
                                <li>Identify technique from initial alert</li>
                                <li>Determine position in kill chain (tactic)</li>
                                <li>Hunt backward: What techniques came before?</li>
                                <li>Hunt forward: What might come next?</li>
                                <li>Build timeline mapped to techniques</li>
                                <li>Use ATT&CK to identify investigation gaps</li>
                            </ol>
                        </div>
                    </div>
                </div>

        </main>
    </div>
    <script>
        // Q&A toggle functionality
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) { answer.style.display = 'block'; }
            });
        });
    </script>
</body>
</html>