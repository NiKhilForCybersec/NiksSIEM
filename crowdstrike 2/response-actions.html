<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Response Actions | CrowdStrike Falcon</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">CrowdStrike Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="fundamentals.html" class="nav-link"><i class="fas fa-book"></i> Fundamentals</a>
                    <a href="sensor-deployment.html" class="nav-link"><i class="fas fa-download"></i> Sensor Deployment</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection</div>
                    <a href="detection-engineering.html" class="nav-link"><i class="fas fa-cog"></i> Detection Engineering</a>
                    <a href="ioa-rules.html" class="nav-link"><i class="fas fa-code"></i> IOA Rules</a>
                    <a href="detection-tuning.html" class="nav-link"><i class="fas fa-sliders-h"></i> Detection Tuning</a>
                    <a href="falcon-intelligence.html" class="nav-link"><i class="fas fa-brain"></i> Falcon Intelligence</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Investigation</div>
                    <a href="threat-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Hunting</a>
                    <a href="incident-management.html" class="nav-link"><i class="fas fa-clipboard-list"></i> Incident Management</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Response</div>
                    <a href="response-actions.html" class="nav-link active"><i class="fas fa-bolt"></i> Response Actions</a>
                    <a href="rtr.html" class="nav-link"><i class="fas fa-terminal"></i> Real Time Response</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">CrowdStrike</a><span class="separator">/</span>
                    <span class="current">Response Actions</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-shield-alt"></i> Response Actions</h1>
                <p class="lead">Master incident response in CrowdStrike Falcon. Learn containment, Real Time Response (RTR), remediation, and threat mitigation techniques.</p>

                <!-- Response Actions Overview -->
                <h2><i class="fas fa-bolt"></i> Response Capabilities</h2>
                <div class="config-section">
                    <h4>Available Response Actions</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Action</th><th>Description</th><th>Location</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Network Contain</strong></td>
                                <td>Isolate from network</td>
                                <td>Host Details / Detection</td>
                            </tr>
                            <tr>
                                <td><strong>Real Time Response</strong></td>
                                <td>Remote shell access</td>
                                <td>Host Details</td>
                            </tr>
                            <tr>
                                <td><strong>Kill Process</strong></td>
                                <td>Terminate running process</td>
                                <td>Detection / RTR</td>
                            </tr>
                            <tr>
                                <td><strong>Quarantine File</strong></td>
                                <td>Remove and secure file</td>
                                <td>Detection / RTR</td>
                            </tr>
                            <tr>
                                <td><strong>Add to Blocklist</strong></td>
                                <td>Block hash globally</td>
                                <td>Detection / IOC Mgmt</td>
                            </tr>
                            <tr>
                                <td><strong>On-Demand Scan</strong></td>
                                <td>Run AV scan</td>
                                <td>Host Details</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Network Containment -->
                <h2><i class="fas fa-unlink"></i> Network Containment</h2>
                <div class="config-section">
                    <p><span class="console-path">Investigate → Hosts → [Host] → Network Contain</span></p>

                    <h4>Containment Behavior</h4>
                    <div class="code-block">Network Containment Effects:

What's Blocked:
- All inbound network traffic
- All outbound network traffic
- Lateral movement prevented
- C2 communication stopped

What's Allowed:
- CrowdStrike cloud communication
- Sensor telemetry continues
- RTR sessions work
- Policy updates received

User Experience:
- No network connectivity
- Applications may hang
- VPN disconnected
- Can still log in locally</div>

                    <h4>Containment Workflow</h4>
                    <div class="code-block">1. Initiate Containment
   From Host: Host Details → Network Contain
   From Detection: Click "Network Contain" button

2. Confirm Action
   - Add note explaining reason
   - Click "Contain"
   - Status updates to "Contained"

3. Continue Investigation
   - Start RTR session (still works)
   - Review detection details
   - Check for lateral movement
   - Identify scope of compromise

4. Remediate
   - Use RTR to clean malware
   - Remove persistence
   - Kill malicious processes

5. Lift Containment
   - Verify threat eliminated
   - Click "Lift Containment"
   - Monitor for recurrence</div>

                    <h4>Containment Considerations</h4>
                    <div class="code-block">Before Containing:

☐ Is this a critical server?
☐ Will users be impacted?
☐ Is after-hours coordination needed?
☐ Is the threat actively spreading?

Contain Immediately When:
✓ Active ransomware
✓ Confirmed C2 communication
✓ Credential theft observed
✓ Lateral movement in progress

Consider Alternatives When:
- Low severity detection
- Possible false positive
- Critical business system
- Can achieve same result with less impact</div>
                </div>

                <!-- Real Time Response -->
                <h2><i class="fas fa-terminal"></i> Real Time Response (RTR)</h2>
                <div class="config-section">
                    <p><span class="console-path">Investigate → Hosts → [Host] → Connect to RTR</span></p>

                    <h4>RTR Session Types</h4>
                    <div class="code-block">RTR Permission Levels:

Read-Only Analyst:
- View files and processes
- No modifications allowed
- Basic investigation

Active Responder:
- Kill processes
- Delete files
- Run put/get commands

RTR Administrator:
- Full access
- Run custom scripts
- Registry modifications
- Execute any command</div>

                    <h4>Basic RTR Commands</h4>
                    <div class="code-block"># Navigation and Listing
cd [directory]         # Change directory
ls / dir               # List files
pwd                    # Print working directory

# File Information
cat [file]             # View file contents
filehash [file]        # Get MD5/SHA256 hash
xmemdump               # Memory acquisition

# Process Information
ps                     # List processes
netstat                # Network connections

# Registry (Windows)
reg query [key]        # Query registry key
reg delete [key]       # Delete registry key/value

# System Information
ifconfig / ipconfig    # Network configuration
users                  # Logged in users
history                # Command history</div>

                    <h4>Active Response Commands</h4>
                    <div class="code-block"># Process Control
kill [pid]             # Terminate process
killall [name]         # Kill by process name

# File Operations
rm [file]              # Delete file
get [file]             # Download file
put [file]             # Upload file

# Remediation
remediate              # Auto-remediate threats
quarantine [file]      # Quarantine file

# Script Execution
runscript -CloudFile="[script]"   # Run cloud script
runscript -Raw="[command]"        # Run raw command

# Memory
memdump [pid]          # Dump process memory
xmemdump               # Full memory acquisition</div>

                    <h4>RTR Investigation Examples</h4>
                    <div class="code-block"># Investigate suspicious process
ps
# Find suspicious PID from output
netstat | grep [pid]
filehash C:\path\to\suspicious.exe

# Check persistence mechanisms
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
reg query HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run

# Check scheduled tasks (Windows)
runscript -Raw="schtasks /query /fo LIST /v"

# Collect file for analysis
cd C:\Users\victim\Downloads
ls
get malware.exe

# Kill and quarantine malicious process
kill [pid]
quarantine C:\path\to\malware.exe

# Check for other instances
runscript -Raw="Get-Process | Where-Object {$_.Path -like '*malware*'}"</div>
                </div>

                <!-- Remediation -->
                <h2><i class="fas fa-broom"></i> Remediation Actions</h2>
                <div class="config-section">
                    <h4>From Detection View</h4>
                    <div class="code-block">Quick Actions from Detection:

Right-Click Process Node:
- Kill Process
- Kill Process Tree
- Quarantine File
- Get Full Details
- View in RTR

Right-Click File:
- Quarantine
- Download for Analysis
- Add to Blocklist
- View File Details
- Submit to Sandbox

Right-Click Network:
- Add to Blocklist (IP/Domain)
- Look up in VirusTotal
- View Related Detections</div>

                    <h4>Bulk Remediation</h4>
                    <div class="code-block">Bulk Response via API:

# Contain multiple hosts
POST /devices/entities/devices-actions/v2
{
  "action_name": "contain",
  "ids": ["device1", "device2", "device3"]
}

# Block hash across environment
POST /indicators/entities/iocs/v1
{
  "type": "sha256",
  "value": "[hash]",
  "action": "prevent",
  "severity": "critical"
}

Fusion Workflows:
- Automated containment on critical alerts
- Auto-block known malicious hashes
- Trigger on OverWatch notifications</div>
                </div>

                <!-- IOC Management -->
                <h2><i class="fas fa-crosshairs"></i> IOC Management</h2>
                <div class="config-section">
                    <p><span class="console-path">Configuration → IOC Management</span></p>

                    <h4>IOC Types</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Type</th><th>Format</th><th>Actions</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SHA256</strong></td>
                                <td>64 char hex</td>
                                <td>Detect, Prevent</td>
                            </tr>
                            <tr>
                                <td><strong>MD5</strong></td>
                                <td>32 char hex</td>
                                <td>Detect, Prevent</td>
                            </tr>
                            <tr>
                                <td><strong>Domain</strong></td>
                                <td>FQDN</td>
                                <td>Detect, Prevent</td>
                            </tr>
                            <tr>
                                <td><strong>IPv4/IPv6</strong></td>
                                <td>IP address</td>
                                <td>Detect, Prevent</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Creating IOCs</h4>
                    <div class="code-block">IOC Configuration:

Required Fields:
- Type: hash/domain/IP
- Value: The indicator
- Action: detect or prevent
- Severity: informational to critical

Optional Fields:
- Description: What this IOC represents
- Tags: Categorization
- Expiration: Auto-remove date
- Platforms: Windows/Mac/Linux

Best Practices:
- Use SHA256 over MD5 (more specific)
- Set expiration for campaign-specific IOCs
- Document source and reason
- Review IOCs regularly</div>
                </div>

                <!-- Response Scripts -->
                <h2><i class="fas fa-code"></i> Custom Response Scripts</h2>
                <div class="config-section">
                    <p><span class="console-path">Configuration → Response Scripts</span></p>

                    <h4>Script Library</h4>
                    <div class="code-block">Script Management:

Script Types:
- PowerShell (Windows)
- Bash (Linux/Mac)
- Python (cross-platform)

Uploading Scripts:
1. Navigate to Response Scripts
2. Click "Create Script"
3. Paste or upload script
4. Set permissions (who can run)
5. Save and test

Running Scripts in RTR:
runscript -CloudFile="ScriptName"
runscript -CloudFile="ScriptName" -CommandLine="arg1 arg2"</div>

                    <h4>Example Response Scripts</h4>
                    <div class="code-block"># Collect-Persistence.ps1
# Gather persistence mechanisms

$output = @()

# Registry Run Keys
$runKeys = @(
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run",
    "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run",
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce",
    "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"
)

foreach ($key in $runKeys) {
    if (Test-Path $key) {
        $items = Get-ItemProperty $key
        $output += "=== $key ==="
        $output += $items | Format-List | Out-String
    }
}

# Scheduled Tasks
$output += "=== Scheduled Tasks ==="
$output += Get-ScheduledTask | Where-Object {$_.State -eq 'Ready'} | 
    Select-Object TaskName, TaskPath, State | Format-Table | Out-String

# Services (non-Microsoft)
$output += "=== Non-Microsoft Services ==="
$output += Get-CimInstance Win32_Service | 
    Where-Object {$_.PathName -notlike '*Microsoft*' -and $_.PathName -notlike '*Windows*'} |
    Select-Object Name, PathName, StartMode | Format-Table | Out-String

$output | Out-File C:\Windows\Temp\persistence_check.txt
Write-Output "Results saved to C:\Windows\Temp\persistence_check.txt"</div>
                </div>

                <!-- Response Playbooks -->
                <h2><i class="fas fa-book"></i> Response Playbooks</h2>
                <div class="config-section">
                    <h4>Ransomware Response</h4>
                    <div class="code-block">Ransomware Playbook:

IMMEDIATE (First 5 Minutes):
□ Network contain affected host(s)
□ Block ransomware hash globally
□ Identify ransomware family
□ Alert stakeholders

SCOPE (15-30 Minutes):
□ Search for hash across environment
□ Check for lateral movement
□ Identify initial access vector
□ Find all affected systems

CONTAIN (30-60 Minutes):
□ Contain all affected hosts
□ Block C2 infrastructure
□ Preserve evidence (memory dump)
□ Disable compromised accounts

ERADICATE (Hours):
□ RTR to remove ransomware
□ Clear persistence mechanisms
□ Verify removal on all systems
□ Scan for remnants

RECOVER:
□ Lift containment gradually
□ Restore from backups if needed
□ Monitor for re-infection
□ Update detections</div>

                    <h4>Credential Theft Response</h4>
                    <div class="code-block">Credential Theft Playbook:

IMMEDIATE:
□ Contain source device
□ Identify tool used (mimikatz, etc.)
□ Determine accounts accessed
□ Reset affected passwords

INVESTIGATE:
□ Check for LSASS access
□ Review authentication logs
□ Look for pass-the-hash
□ Check for DCSync attempts

SCOPE:
□ Search for tool across environment
□ Check for persistence
□ Identify lateral movement
□ Find all compromised accounts

REMEDIATE:
□ Reset all compromised passwords
□ Revoke Kerberos tickets (krbtgt reset if DC compromised)
□ Remove attacker access
□ Enable additional protections</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What happens when you network contain a host in CrowdStrike?</button>
                        <div class="qa-answer">
                            <ul>
                                <li>All network traffic blocked except CrowdStrike cloud</li>
                                <li>RTR sessions still function for investigation</li>
                                <li>Telemetry continues flowing to cloud</li>
                                <li>User sees no network connectivity</li>
                                <li>Must manually lift containment when ready</li>
                            </ul>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: Walk through your RTR investigation workflow.</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Review detection:</strong> Understand what triggered</li>
                                <li><strong>Check processes:</strong> ps command, look for suspicious</li>
                                <li><strong>Network connections:</strong> netstat for C2</li>
                                <li><strong>File analysis:</strong> Get suspicious files, hash them</li>
                                <li><strong>Persistence:</strong> Check run keys, scheduled tasks</li>
                                <li><strong>Remediate:</strong> Kill processes, quarantine files</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you handle a detection on a critical server?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Assess severity:</strong> Is it critical or can it wait?</li>
                                <li><strong>Coordinate:</strong> Contact system owner if non-critical</li>
                                <li><strong>Investigate first:</strong> Use RTR without containment if possible</li>
                                <li><strong>Document business impact:</strong> What happens if we contain?</li>
                                <li><strong>Escalate decision:</strong> If containment needed, get approval</li>
                                <li><strong>Minimize downtime:</strong> Plan remediation before containment</li>
                            </ol>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>