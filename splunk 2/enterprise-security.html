<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Security | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-brand">
                    <div class="brand-icon"><i class="fas fa-shield-halved"></i></div>
                    <div class="brand-text">
                        <span class="brand-title">Nik's SIEM</span>
                        <span class="brand-subtitle">Security Operations</span>
                    </div>
                </a>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Splunk Platform</div>
                    <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Overview</a>
                    <a href="architecture.html" class="nav-link"><i class="fas fa-sitemap"></i> Architecture</a>
                    <a href="es-overview.html" class="nav-link"><i class="fas fa-shield-alt"></i> Enterprise Security</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Data Collection</div>
                    <a href="data-ingestion.html" class="nav-link"><i class="fas fa-database"></i> Data Ingestion</a>
                    <a href="forwarders.html" class="nav-link"><i class="fas fa-share"></i> Forwarders</a>
                    <a href="custom-log-onboarding.html" class="nav-link"><i class="fas fa-file-import"></i> Custom Onboarding</a>
                    <a href="parsing-flows.html" class="nav-link"><i class="fas fa-stream"></i> Parsing & Fields</a>
                    <a href="data-models.html" class="nav-link"><i class="fas fa-cubes"></i> Data Models & CIM</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">SPL Query Language</div>
                    <a href="spl-fundamentals.html" class="nav-link"><i class="fas fa-terminal"></i> SPL Fundamentals</a>
                    <a href="spl-intermediate.html" class="nav-link"><i class="fas fa-code"></i> SPL Intermediate</a>
                    <a href="spl-advanced.html" class="nav-link"><i class="fas fa-rocket"></i> SPL Advanced</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Operations</div>
                    <a href="correlation-searches.html" class="nav-link"><i class="fas fa-project-diagram"></i> Correlation Searches</a>
                    <a href="notable-events.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> Notable Events</a>
                    <a href="risk-based-alerting.html" class="nav-link"><i class="fas fa-chart-line"></i> Risk-Based Alerting</a>
                    <a href="threat-hunting.html" class="nav-link"><i class="fas fa-crosshairs"></i> Threat Hunting</a>
                    <a href="threat-intel.html" class="nav-link"><i class="fas fa-skull-crossbones"></i> Threat Intelligence</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Administration</div>
                    <a href="administration.html" class="nav-link"><i class="fas fa-cog"></i> Administration</a>
                    <a href="apps-tas.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> Apps & Add-ons</a>
                    <a href="dashboards.html" class="nav-link"><i class="fas fa-chart-bar"></i> Dashboards</a>
                    <a href="retention-tiers.html" class="nav-link"><i class="fas fa-archive"></i> Storage Tiers</a>
                </div>
            </nav>
        </aside>
        <div class="main-wrapper">
            <header class="top-bar">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a><span class="separator">/</span>
                    <a href="index.html">Splunk</a><span class="separator">/</span>
                    <span class="current">Enterprise Security</span>
                </div>
            </header>
            <main class="main-content">
                <h1><i class="fas fa-shield-alt"></i> Splunk Enterprise Security</h1>
                <p class="lead">Master Splunk Enterprise Security (ES), the premium SIEM solution. Learn to use Notable Events, Incident Review, Risk-Based Alerting, and threat intelligence integration.</p>

                <!-- ES Overview -->
                <h2><i class="fas fa-info-circle"></i> Enterprise Security Overview</h2>
                <div class="config-section">
                    <h4>ES Components</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Component</th><th>Purpose</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Security Posture</strong></td><td>Executive dashboard, key metrics</td></tr>
                            <tr><td><strong>Incident Review</strong></td><td>Analyst workflow, notable events</td></tr>
                            <tr><td><strong>Risk Analysis</strong></td><td>Risk-based alerting dashboard</td></tr>
                            <tr><td><strong>Threat Intelligence</strong></td><td>IOC management and matching</td></tr>
                            <tr><td><strong>Asset & Identity</strong></td><td>Entity enrichment framework</td></tr>
                            <tr><td><strong>Content Management</strong></td><td>Correlation searches, use cases</td></tr>
                        </tbody>
                    </table>

                    <h4>ES Data Model Acceleration</h4>
                    <div class="code-block">Key ES Data Models:

Authentication:
- Login success/failure
- Account lockouts
- Privilege changes

Network_Traffic:
- Firewall logs
- IDS/IPS
- Proxy logs

Endpoint:
- Process execution
- File changes
- Registry modifications

Web:
- HTTP requests
- URL access
- Web proxy

Malware:
- AV detections
- Malware alerts

Data Model Acceleration:
- Pre-summarizes data
- Enables fast tstats queries
- Required for ES dashboards</div>
                </div>

                <!-- Incident Review -->
                <h2><i class="fas fa-clipboard-list"></i> Incident Review</h2>
                <div class="config-section">
                    <p><span class="console-path">Enterprise Security → Incident Review</span></p>

                    <h4>Notable Event Fields</h4>
                    <table class="styled-table">
                        <thead>
                            <tr><th>Field</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>rule_name</strong></td><td>Correlation search that triggered</td></tr>
                            <tr><td><strong>urgency</strong></td><td>Critical, High, Medium, Low, Info</td></tr>
                            <tr><td><strong>status</strong></td><td>New, In Progress, Pending, Resolved, Closed</td></tr>
                            <tr><td><strong>owner</strong></td><td>Assigned analyst</td></tr>
                            <tr><td><strong>src</strong></td><td>Source IP/host</td></tr>
                            <tr><td><strong>dest</strong></td><td>Destination IP/host</td></tr>
                            <tr><td><strong>user</strong></td><td>Associated user account</td></tr>
                        </tbody>
                    </table>

                    <h4>Notable Event Workflow</h4>
                    <div class="code-block">Incident Review Workflow:

1. TRIAGE
   - Review notable event details
   - Check related events
   - Assess urgency and impact

2. ASSIGN
   - Take ownership
   - Set status to "In Progress"
   - Add initial notes

3. INVESTIGATE
   - Drill down to raw events
   - Use investigation tools
   - Correlate with other data

4. DISPOSITION
   - True Positive: Escalate/remediate
   - False Positive: Tune rule
   - Benign: Document and close

5. CLOSE
   - Set final status
   - Document findings
   - Update knowledge base</div>

                    <h4>Incident Review Search</h4>
                    <div class="code-block">// Query notable events
index=notable
| table _time, rule_name, urgency, status, owner, src, dest, user

// My assigned notables
index=notable owner=analyst@company.com status="In Progress"
| table _time, rule_name, urgency, src, dest

// Unassigned high urgency
index=notable urgency IN ("high", "critical") owner=""
| stats count by rule_name, urgency
| sort -urgency, -count

// Notable event trend
index=notable
| timechart span=1h count by urgency</div>
                </div>

                <!-- Correlation Searches -->
                <h2><i class="fas fa-search-plus"></i> Correlation Searches</h2>
                <div class="config-section">
                    <p><span class="console-path">Configure → Content → Content Management</span></p>

                    <h4>Correlation Search Structure</h4>
                    <div class="code-block">Correlation Search Components:

SEARCH:
- SPL query detecting threat
- Uses data models or raw data
- Returns events to create notables

SCHEDULING:
- Cron schedule
- Time range to search
- Throttling settings

NOTABLE EVENT:
- Title and description
- Security domain
- Severity calculation

ADAPTIVE RESPONSE:
- Actions to trigger
- Email, script, ticket
- SOAR integration</div>

                    <h4>Example Correlation Searches</h4>
                    <div class="code-block">// Brute Force Detection
| tstats summariesonly=true count from datamodel=Authentication 
  where Authentication.action=failure by Authentication.src, Authentication.user, _time span=5m
| rename Authentication.* as *
| where count > 10
| eval rule_name="Brute Force Attack"
| eval urgency="high"

// Excessive Failed Logins
| tstats summariesonly=true count from datamodel=Authentication 
  where Authentication.action=failure by Authentication.user
| rename Authentication.* as *
| where count > 5
| lookup identity_lookup_expanded identity as user OUTPUT priority, bunit
| eval urgency=if(priority="critical", "critical", "high")

// Malware Detection
| tstats summariesonly=true count from datamodel=Malware 
  where Malware.action!=allowed by Malware.dest, Malware.signature, Malware.file_name
| rename Malware.* as *</div>

                    <h4>Creating Correlation Search</h4>
                    <div class="code-block">Steps to Create:

1. Write and Test Search
   - Develop SPL query
   - Test against historical data
   - Verify results make sense

2. Configure in Content Management
   - Name and description
   - Security domain (Access, Endpoint, Network)
   - Enable correlation search

3. Set Schedule
   - Real-time or scheduled
   - Time range (relative to now)
   - Throttle to prevent duplicates

4. Configure Notable Event
   - Title with dynamic fields
   - Urgency field mapping
   - Drill-down search

5. Add Adaptive Response
   - Email notification
   - Create ticket
   - Run script</div>
                </div>

                <!-- Risk-Based Alerting -->
                <h2><i class="fas fa-chart-line"></i> Risk-Based Alerting (RBA)</h2>
                <div class="config-section">
                    <p><span class="console-path">Enterprise Security → Risk Analysis</span></p>

                    <h4>RBA Concept</h4>
                    <div class="code-block">Risk-Based Alerting Philosophy:

Traditional Alerting:
- Each detection = 1 notable
- Many low-confidence alerts
- Alert fatigue

Risk-Based Alerting:
- Detections add risk points to entities
- Risk accumulates over time
- Notable when threshold exceeded

Benefits:
- Reduces alert volume
- Higher fidelity notables
- Correlates related activity
- Prioritizes by entity risk</div>

                    <h4>Risk Framework</h4>
                    <div class="code-block">Risk Components:

RISK OBJECT:
- Entity being tracked
- User, host, IP, etc.

RISK SCORE:
- Points assigned per detection
- Based on severity and confidence

RISK MODIFIERS:
- Asset criticality
- User privilege level
- Department sensitivity

RISK THRESHOLD:
- Score triggering notable
- Per entity type
- Time-decay optional</div>

                    <h4>Risk Searches</h4>
                    <div class="code-block">// Add risk to user
| makeresults
| eval risk_object="jdoe@company.com"
| eval risk_object_type="user"
| eval risk_score=25
| eval risk_message="Suspicious login from new country"
| collect index=risk

// View user risk
index=risk risk_object_type=user
| stats sum(risk_score) as total_risk by risk_object
| sort -total_risk

// Risk notable threshold search
index=risk
| stats sum(risk_score) as total_risk, 
        values(risk_message) as risks,
        dc(source) as detection_count
        by risk_object, risk_object_type
| where total_risk > 100
| eval urgency=case(
    total_risk > 200, "critical",
    total_risk > 150, "high",
    total_risk > 100, "medium")</div>
                </div>

                <!-- Threat Intelligence -->
                <h2><i class="fas fa-brain"></i> Threat Intelligence Framework</h2>
                <div class="config-section">
                    <p><span class="console-path">Configure → Data Enrichment → Threat Intelligence</span></p>

                    <h4>TI Management</h4>
                    <div class="code-block">Threat Intelligence Sources:

Built-in:
- Splunk Intelligence Management
- STIX/TAXII feeds
- CSV uploads

Integration:
- Recorded Future
- Anomali
- MISP
- AlienVault OTX

Intelligence Types:
- ip_intel: Malicious IPs
- domain_intel: Bad domains
- file_intel: Malicious hashes
- email_intel: Phishing addresses
- http_intel: Malicious URLs</div>

                    <h4>TI Lookups</h4>
                    <div class="code-block">// Check IP against threat intel
index=firewall
| lookup ip_intel ip as dest_ip OUTPUT threat_category, threat_collection
| where isnotnull(threat_category)
| table _time, src_ip, dest_ip, threat_category, threat_collection

// Domain intelligence lookup
index=dns
| lookup domain_intel domain as query OUTPUT threat_category
| where isnotnull(threat_category)

// File hash lookup
index=endpoint
| lookup file_intel hash as file_hash OUTPUT threat_category, description
| where isnotnull(threat_category)</div>
                </div>

                <!-- Asset and Identity -->
                <h2><i class="fas fa-users"></i> Asset and Identity Framework</h2>
                <div class="config-section">
                    <p><span class="console-path">Configure → Data Enrichment → Asset & Identity Management</span></p>

                    <h4>Asset Lookup</h4>
                    <div class="code-block">Asset Fields:
- ip: IP address
- mac: MAC address
- dns: Hostname
- nt_host: NetBIOS name
- owner: Asset owner
- priority: critical/high/medium/low
- bunit: Business unit
- category: server/workstation/network
- is_expected: Expected asset flag

// Enrich with asset data
index=network
| lookup asset_lookup_by_str ip as dest_ip 
  OUTPUT priority, bunit, owner, category
| where priority="critical"</div>

                    <h4>Identity Lookup</h4>
                    <div class="code-block">Identity Fields:
- identity: Username
- email: Email address
- first: First name
- last: Last name
- priority: User priority
- bunit: Business unit
- category: employee/contractor/service
- watchlist: true/false
- endDate: Account expiration

// Enrich with identity data
index=authentication
| lookup identity_lookup_expanded identity as user 
  OUTPUT priority, bunit, category, watchlist
| where watchlist=true</div>
                </div>

                <!-- Investigation Tools -->
                <h2><i class="fas fa-search"></i> Investigation Tools</h2>
                <div class="config-section">
                    <h4>Asset Investigator</h4>
                    <div class="code-block">Asset Investigator Views:

Summary:
- Asset details
- Risk score
- Notable events

Timeline:
- Activity over time
- Correlated events

Identity:
- Associated users
- Access patterns

Network:
- Connections
- Traffic volume

Files:
- File activity
- Hash lookups</div>

                    <h4>Protocol Intelligence</h4>
                    <div class="code-block">Protocol Analysis:

HTTP Category Analysis:
| tstats count from datamodel=Web 
  by Web.url_domain, Web.category
| sort -count

DNS Analysis:
| tstats count from datamodel=Network_Resolution 
  by DNS.query, DNS.reply_code
| where DNS.reply_code!="No Error"

Network Traffic:
| tstats sum(All_Traffic.bytes) as bytes 
  from datamodel=Network_Traffic 
  by All_Traffic.src, All_Traffic.dest
| sort -bytes</div>
                </div>

                <!-- ES Administration -->
                <h2><i class="fas fa-cogs"></i> ES Administration</h2>
                <div class="config-section">
                    <h4>Key Admin Tasks</h4>
                    <div class="code-block">ES Administration:

Data Model Acceleration:
Settings → Data Models → Accelerate

Notable Event Status:
Configure → Incident Management → Notable Event Statuses

Urgency Levels:
Configure → Incident Management → Urgency Levels

Suppression:
Configure → Incident Management → Notable Event Suppressions

Adaptive Response:
Configure → Incident Management → Adaptive Response Actions</div>

                    <h4>Performance Tuning</h4>
                    <div class="code-block">Performance Best Practices:

DATA MODELS:
- Accelerate only needed models
- Monitor acceleration status
- Tune acceleration time range

CORRELATION SEARCHES:
- Use tstats when possible
- Avoid expensive searches
- Set appropriate schedules

NOTABLE EVENTS:
- Tune to reduce volume
- Use suppression effectively
- Implement RBA to reduce noise

LOOKUPS:
- Keep asset/identity updated
- Optimize lookup size
- Use automatic lookups</div>
                </div>

                <!-- Interview Questions -->
                <h2><i class="fas fa-comments"></i> Interview Questions</h2>
                <div class="qa-section">
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What is Risk-Based Alerting and why use it?</button>
                        <div class="qa-answer">
                            <p><strong>RBA assigns risk points to entities instead of creating immediate alerts:</strong></p>
                            <ul>
                                <li>Detections add risk scores to users/hosts</li>
                                <li>Risk accumulates over time</li>
                                <li>Notable created when threshold exceeded</li>
                                <li>Correlates multiple low-confidence detections</li>
                            </ul>
                            <p style="margin-top: 12px;"><strong>Benefits:</strong> Reduces alert fatigue, higher fidelity notables, surfaces compromised entities through accumulated risk.</p>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: How do you tune a noisy correlation search?</button>
                        <div class="qa-answer">
                            <ol>
                                <li><strong>Analyze false positives:</strong> What's causing them?</li>
                                <li><strong>Add exclusions:</strong> Filter known-good activity</li>
                                <li><strong>Adjust thresholds:</strong> Increase count/time requirements</li>
                                <li><strong>Use asset/identity:</strong> Exclude service accounts, expected behavior</li>
                                <li><strong>Convert to RBA:</strong> Add risk instead of notable</li>
                                <li><strong>Add suppression:</strong> Time-based suppression for known events</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-item">
                        <button class="qa-question"><i class="fas fa-lightbulb" style="color: #d29922;"></i> Q: What are the key ES data models?</button>
                        <div class="qa-answer">
                            <ul>
                                <li><strong>Authentication:</strong> Login events, successes, failures</li>
                                <li><strong>Network_Traffic:</strong> Firewall, IDS, network flows</li>
                                <li><strong>Endpoint:</strong> Process, file, registry events</li>
                                <li><strong>Web:</strong> Proxy, HTTP requests</li>
                                <li><strong>Malware:</strong> AV detections</li>
                                <li><strong>Change:</strong> Configuration changes</li>
                            </ul>
                            <p style="margin-top: 12px;">Data models normalize data for consistent searching using tstats and power ES dashboards.</p>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    <script>
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                document.querySelectorAll('.qa-question').forEach(b => b.classList.remove('active'));
                if (!isOpen) { answer.style.display = 'block'; btn.classList.add('active'); }
            });
        });
    </script>
</body>
</html>