<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture & Enterprise Deployments | Splunk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <div class="app-container">
        
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Nik's SIEM</span>
            </a>
            <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Platforms Section -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Platforms</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="../xsiam/index.html" class="sidebar-nav-link" data-platform="xsiam">
                            <span class="platform-dot"></span>
                            <span>XSIAM</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../splunk/index.html" class="sidebar-nav-link active" data-platform="splunk">
                            <span class="platform-dot"></span>
                            <span>Splunk</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../sentinel/index.html" class="sidebar-nav-link" data-platform="sentinel">
                            <span class="platform-dot"></span>
                            <span>Sentinel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../crowdstrike/index.html" class="sidebar-nav-link" data-platform="crowdstrike">
                            <span class="platform-dot"></span>
                            <span>CrowdStrike</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../cortex/index.html" class="sidebar-nav-link" data-platform="cortex">
                            <span class="platform-dot"></span>
                            <span>Cortex XDR</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../mde/index.html" class="sidebar-nav-link" data-platform="mde">
                            <span class="platform-dot"></span>
                            <span>Defender for Endpoint</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="../operations/index.html" class="sidebar-nav-link" data-platform="operations">
                            <span class="platform-dot"></span>
                            <span>SOC Operations</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-divider"></div>
            
            <!-- Current Platform Pages -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Splunk Pages</div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="administration.html" class="sidebar-nav-link">
                            <i class="fas fa-cog"></i>
                            <span>Administration</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="apps-tas.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Apps Tas</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="architecture.html" class="sidebar-nav-link active">
                            <i class="fas fa-sitemap"></i>
                            <span>Architecture</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="correlation-searches.html" class="sidebar-nav-link">
                            <i class="fas fa-project-diagram"></i>
                            <span>Correlation Searches</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="custom-log-onboarding.html" class="sidebar-nav-link">
                            <i class="fas fa-download"></i>
                            <span>Custom Log Onboarding</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="dashboards.html" class="sidebar-nav-link">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboards</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-ingestion.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Ingestion</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="data-models.html" class="sidebar-nav-link">
                            <i class="fas fa-database"></i>
                            <span>Data Models</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-scenarios.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Enterprise Scenarios</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="enterprise-security.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Enterprise Security</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="es-overview.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Es Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="forwarders.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Forwarders</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="index.html" class="sidebar-nav-link">
                            <i class="fas fa-home"></i>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="notable-events.html" class="sidebar-nav-link">
                            <i class="fas fa-exclamation-circle"></i>
                            <span>Notable Events</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="parsing-flows.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Parsing Flows</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="retention-tiers.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Retention Tiers</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="risk-based-alerting.html" class="sidebar-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Risk Based Alerting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="security-usecases.html" class="sidebar-nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Security Usecases</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="soar.html" class="sidebar-nav-link">
                            <i class="fas fa-robot"></i>
                            <span>Soar</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-advanced.html" class="sidebar-nav-link">
                            <i class="fas fa-terminal"></i>
                            <span>Spl Advanced</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-fundamentals.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Spl Fundamentals</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="spl-intermediate.html" class="sidebar-nav-link">
                            <i class="fas fa-code"></i>
                            <span>Spl Intermediate</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-hunting.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Hunting</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="threat-intel.html" class="sidebar-nav-link">
                            <i class="fas fa-crosshairs"></i>
                            <span>Threat Intel</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="troubleshooting.html" class="sidebar-nav-link">
                            <i class="fas fa-wrench"></i>
                            <span>Troubleshooting</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        
        <!-- Main Content Wrapper -->
        <div class="main-wrapper" id="mainWrapper">
            <button class="mobile-toggle" onclick="toggleSidebar()" title="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <main class="main-content">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="index.html">Splunk</a>
                    <span class="separator">/</span>
                    <span class="current">Architecture</span>
                </div>

                <h1><i class="fas fa-sitemap"></i> Splunk Architecture & Enterprise Deployments</h1>
            <p class="lead">Complete technical architecture of Splunk Enterprise and Splunk Cloud with real-world enterprise deployment examples. Understand component roles, data flows, clustering, and deployment patterns.</p>

            <!-- Architecture Overview -->
            <h2><i class="fas fa-layer-group"></i> Core Architecture Overview</h2>
            
            <div class="config-section">
                <h3>Splunk Component Architecture</h3>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                         SPLUNK ENTERPRISE ARCHITECTURE                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   DATA SOURCES                FORWARDERS                 INDEXER CLUSTER            │
│   ════════════                ══════════                 ═══════════════            │
│                                                                                      │
│   ┌────────────┐            ┌──────────────────┐       ┌────────────────────────┐   │
│   │ SERVERS    │            │                  │       │    INDEXER CLUSTER     │   │
│   │ ────────   │            │  UNIVERSAL       │       │    ════════════════    │   │
│   │ • Windows  │───────────▶│  FORWARDER (UF)  │       │                        │   │
│   │ • Linux    │   Logs     │                  │       │  ┌─────────────────┐   │   │
│   │ • Apps     │            │  • Lightweight   │       │  │ Cluster Master  │   │   │
│   └────────────┘            │  • No parsing    │       │  │ (Manager Node)  │   │   │
│                             │  • TLS transport │       │  │ • Replication   │   │   │
│   ┌────────────┐            │  • Load balance  │       │  │ • Search factor │   │   │
│   │ NETWORK    │            │                  │       │  └────────┬────────┘   │   │
│   │ ────────   │            └────────┬─────────┘       │           │            │   │
│   │ • Firewalls│                     │                 │  ┌────────▼────────┐   │   │
│   │ • Routers  │                     │                 │  │                 │   │   │
│   │ • Switches │                     │                 │  │   PEER NODES    │   │   │
│   │ • Proxies  │──┐                  │                 │  │   ══════════    │   │   │
│   └────────────┘  │                  │                 │  │                 │   │   │
│                   │                  │                 │  │ ┌─────┐ ┌─────┐ │   │   │
│   ┌────────────┐  │  ┌───────────────▼───────────┐    │  │ │IDX-1│ │IDX-2│ │   │   │
│   │ CLOUD      │  │  │                           │    │  │ └──┬──┘ └──┬──┘ │   │   │
│   │ ────────   │  │  │  HEAVY FORWARDER (HF)     │───▶│  │    │       │    │   │   │
│   │ • AWS      │  │  │                           │    │  │ ┌──▼──┐ ┌──▼──┐ │   │   │
│   │ • Azure    │  └─▶│  • Full Splunk instance   │    │  │ │IDX-3│ │IDX-4│ │   │   │
│   │ • GCP      │     │  • Parsing/transforms     │    │  │ └─────┘ └─────┘ │   │   │
│   │ • O365     │     │  • Routing decisions      │    │  │                 │   │   │
│   └────────────┘     │  • Data masking           │    │  │ Replication     │   │   │
│                      │  • API collection         │    │  │ Factor: 2       │   │   │
│   ┌────────────┐     │                           │    │  │ Search          │   │   │
│   │ CUSTOM     │     └───────────────────────────┘    │  │ Factor: 2       │   │   │
│   │ ────────   │                                      │  │                 │   │   │
│   │ • HEC      │──────────────────────────────────────│  └─────────────────┘   │   │
│   │ • REST API │                                      │           │            │   │
│   │ • Scripted │     HTTP Event Collector (HEC)       │           │            │   │
│   └────────────┘     ══════════════════════════       │           ▼            │   │
│                      • Port 8088 (HTTPS)              │  ┌─────────────────┐   │   │
│                      • Token-based auth               │  │   HOT/WARM/     │   │   │
│                      • Direct to indexers             │  │   COLD STORAGE  │   │   │
│                      • JSON/raw formats               │  │   ════════════  │   │   │
│                                                       │  │ • Hot: SSD      │   │   │
│                                                       │  │ • Warm: HDD     │   │   │
│                                                       │  │ • Cold: Archive │   │   │
│                                                       │  └─────────────────┘   │   │
│                                                       └────────────────────────┘   │
│                                                                    │               │
│                                                                    ▼               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                SEARCH TIER                                          │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   SEARCH HEAD CLUSTER (SHC)                    DEPLOYER                     │   │
│   │   ═════════════════════════                    ════════                     │   │
│   │                                                                             │   │
│   │   ┌─────────┐ ┌─────────┐ ┌─────────┐         ┌─────────────────┐          │   │
│   │   │  SH-1   │ │  SH-2   │ │  SH-3   │         │    DEPLOYER     │          │   │
│   │   │(Captain)│ │         │ │         │◀────────│                 │          │   │
│   │   └────┬────┘ └────┬────┘ └────┬────┘  Push   │  • Push apps    │          │   │
│   │        │           │           │       Apps   │  • Manage SHC   │          │   │
│   │        └───────────┼───────────┘              │  • Configs      │          │   │
│   │                    │                          └─────────────────┘          │   │
│   │              Load Balancer                                                  │   │
│   │                    │                                                        │   │
│   │   ┌────────────────▼────────────────┐                                       │   │
│   │   │        SEARCH FUNCTIONS         │                                       │   │
│   │   │        ════════════════         │                                       │   │
│   │   │  • Ad-hoc searches              │                                       │   │
│   │   │  • Scheduled searches           │                                       │   │
│   │   │  • Dashboard rendering          │                                       │   │
│   │   │  • Report generation            │                                       │   │
│   │   │  • Alert processing             │                                       │   │
│   │   └─────────────────────────────────┘                                       │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                           ENTERPRISE SECURITY (ES)                                  │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐    │   │
│   │   │ NOTABLE   │ │CORRELATION│ │   RISK    │ │  THREAT   │ │  ASSET    │    │   │
│   │   │  EVENTS   │ │  SEARCHES │ │  SCORING  │ │   INTEL   │ │ INVENTORY │    │   │
│   │   │ ───────── │ │ ───────── │ │ ───────── │ │ ───────── │ │ ───────── │    │   │
│   │   │ • Triage  │ │ • 700+    │ │ • Risk    │ │ • STIX    │ │ • Asset   │    │   │
│   │   │ • Assign  │ │   OOTB    │ │   Rules   │ │ • TAXII   │ │   lookup  │    │   │
│   │   │ • Status  │ │ • Custom  │ │ • Entity  │ │ • IOC     │ │ • Owner   │    │   │
│   │   │ • Comment │ │ • Sched.  │ │   risk    │ │   match   │ │ • Priority│    │   │
│   │   └───────────┘ └───────────┘ └───────────┘ └───────────┘ └───────────┘    │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                            MANAGEMENT & DEPLOYMENT                                  │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │   │
│   │   │  DEPLOYMENT     │    │   LICENSE       │    │   MONITORING    │        │   │
│   │   │  SERVER         │    │   MANAGER       │    │   CONSOLE       │        │   │
│   │   │  ═══════════    │    │   ═══════════   │    │   ═══════════   │        │   │
│   │   │                 │    │                 │    │                 │        │   │
│   │   │  • Push apps    │    │  • License      │    │  • Health       │        │   │
│   │   │    to UFs       │    │    pooling      │    │    monitoring   │        │   │
│   │   │  • Manage       │    │  • Usage        │    │  • Platform     │        │   │
│   │   │    configs      │    │    tracking     │    │    alerts       │        │   │
│   │   │  • Server       │    │  • Violations   │    │  • Forwarder    │        │   │
│   │   │    classes      │    │    alerts       │    │    management   │        │   │
│   │   │                 │    │                 │    │                 │        │   │
│   │   └─────────────────┘    └─────────────────┘    └─────────────────┘        │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- Component Deep Dive -->
            <h2><i class="fas fa-cogs"></i> Component Deep Dive</h2>

            <div class="config-section">
                <h3>Forwarder Types</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Purpose</th>
                            <th>Resources</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Universal Forwarder (UF)</strong></td>
                            <td>Lightweight log collection</td>
                            <td>~20MB RAM, minimal CPU</td>
                            <td>Endpoints, servers, standard collection</td>
                        </tr>
                        <tr>
                            <td><strong>Heavy Forwarder (HF)</strong></td>
                            <td>Parsing, routing, enrichment</td>
                            <td>8-16GB RAM, 4+ cores</td>
                            <td>Syslog aggregation, data masking, API collection</td>
                        </tr>
                        <tr>
                            <td><strong>HTTP Event Collector</strong></td>
                            <td>Direct HTTP/S ingestion</td>
                            <td>Part of indexer</td>
                            <td>Applications, containers, cloud services</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="config-section">
                <h3>Indexer Cluster Concepts</h3>
                
                <div class="arch-diagram">
INDEXER CLUSTER TERMINOLOGY:

┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   REPLICATION FACTOR (RF) = 2                                   │
│   ─────────────────────────                                     │
│   Each bucket is replicated to 2 indexers                       │
│   Protects against single indexer failure                       │
│                                                                 │
│   ┌─────────┐              ┌─────────┐                          │
│   │  IDX-1  │   Replicate  │  IDX-2  │                          │
│   │ ┌─────┐ │─────────────▶│ ┌─────┐ │                          │
│   │ │Bkt-A│ │              │ │Bkt-A│ │  (Copy)                   │
│   │ └─────┘ │              │ └─────┘ │                          │
│   └─────────┘              └─────────┘                          │
│                                                                 │
│   SEARCH FACTOR (SF) = 2                                        │
│   ──────────────────────                                        │
│   Each bucket is searchable from 2 indexers                     │
│   Allows searches to continue if one indexer down               │
│                                                                 │
│   SITE REPLICATION (Multisite Cluster)                          │
│   ─────────────────────────────────────                         │
│   site_replication_factor = origin:1, total:2                   │
│   site_search_factor = origin:1, total:2                        │
│                                                                 │
│   ┌─────────────────┐         ┌─────────────────┐               │
│   │    SITE 1       │         │    SITE 2       │               │
│   │    (Primary)    │         │    (DR)         │               │
│   │  ┌─────┐┌─────┐ │ Sync    │  ┌─────┐┌─────┐ │               │
│   │  │IDX-1││IDX-2│ │────────▶│  │IDX-3││IDX-4│ │               │
│   │  └─────┘└─────┘ │         │  └─────┘└─────┘ │               │
│   └─────────────────┘         └─────────────────┘               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                </div>
            </div>

            <!-- Enterprise Deployment Examples -->
            <h2><i class="fas fa-building"></i> Enterprise Deployment Examples</h2>

            <!-- Example 1: Retail -->
            <div class="config-section">
                <h3>🛒 Case Study: RetailMax Corporation (25,000 Employees)</h3>
                
                <div class="info-box">
                    <h4>Company Profile</h4>
                    <p><strong>Industry:</strong> Retail | <strong>Employees:</strong> 25,000 | <strong>Locations:</strong> 500 stores + 3 DCs | <strong>Compliance:</strong> PCI-DSS</p>
                </div>

                <h4>Multi-Site Architecture</h4>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                    RETAILMAX - SPLUNK ENTERPRISE DEPLOYMENT                         │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   RETAIL STORES (500 locations)                                                      │
│   ═════════════════════════════                                                      │
│                                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                             │   │
│   │   STORE TYPE A (Large - 200 stores)      STORE TYPE B (Small - 300 stores)  │   │
│   │   ════════════════════════════════       ═════════════════════════════════  │   │
│   │                                                                             │   │
│   │   ┌─────────────────────────┐           ┌─────────────────────────┐        │   │
│   │   │   POS Systems (10)      │           │   POS Systems (4)       │        │   │
│   │   │   ┌─────────────────┐   │           │   ┌─────────────────┐   │        │   │
│   │   │   │ Universal Fwdr  │   │           │   │ Universal Fwdr  │   │        │   │
│   │   │   │ on each POS     │   │           │   │ on each POS     │   │        │   │
│   │   │   └────────┬────────┘   │           │   └────────┬────────┘   │        │   │
│   │   │            │            │           │            │            │        │   │
│   │   │   ┌────────▼────────┐   │           │            │            │        │   │
│   │   │   │ Store Server    │   │           │            │            │        │   │
│   │   │   │ (Heavy Fwdr)    │   │           │            │            │        │   │
│   │   │   │ • Local buffer  │   │           │            │            │        │   │
│   │   │   │ • PCI masking   │   │           │            │ Direct     │        │   │
│   │   │   └────────┬────────┘   │           │            │ to HQ      │        │   │
│   │   │            │            │           │            │            │        │   │
│   │   │   ┌────────▼────────┐   │           │            │            │        │   │
│   │   │   │ Store Firewall  │   │           │   ┌────────▼────────┐   │        │   │
│   │   │   │ (Palo Alto)     │───┼───────────┼───│ Store Firewall  │   │        │   │
│   │   │   └─────────────────┘   │           │   └─────────────────┘   │        │   │
│   │   │                         │           │                         │        │   │
│   │   └─────────────────────────┘           └─────────────────────────┘        │   │
│   │                                                                             │   │
│   │   Total from stores: ~2,000 UFs + 200 HFs                                   │   │
│   │   Daily volume: ~500 GB (POS transactions, firewall, endpoint)              │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                       │
│                                              │ MPLS/Internet                         │
│                                              ▼                                       │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                         HEADQUARTERS DATA CENTER                             │   │
│   │                         ════════════════════════                             │   │
│   │                                                                             │   │
│   │   RECEIVING TIER                                                             │   │
│   │   ══════════════                                                             │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────────────────┐        ┌─────────────────────┐           │   │   │
│   │   │   │  HEAVY FORWARDER    │        │  HEAVY FORWARDER    │           │   │   │
│   │   │   │  CLUSTER (HF-1/2)   │        │  (SYSLOG)           │           │   │   │
│   │   │   │  ─────────────────  │        │  ─────────────────  │           │   │   │
│   │   │   │  • Store data recv  │        │  • Network devices  │           │   │   │
│   │   │   │  • PCI-DSS masking  │        │  • Security tools   │           │   │   │
│   │   │   │  • Index routing    │        │  • Linux/Unix       │           │   │   │
│   │   │   │                     │        │                     │           │   │   │
│   │   │   │  Specs: 16 vCPU     │        │  Specs: 8 vCPU      │           │   │   │
│   │   │   │        64 GB RAM    │        │        32 GB RAM    │           │   │   │
│   │   │   └──────────┬──────────┘        └──────────┬──────────┘           │   │   │
│   │   │              │                              │                      │   │   │
│   │   └──────────────┼──────────────────────────────┼──────────────────────┘   │   │
│   │                  │                              │                          │   │
│   │                  ▼                              ▼                          │   │
│   │   INDEXER CLUSTER (Multisite)                                              │   │
│   │   ═══════════════════════════                                              │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   SITE 1 (PRIMARY - HQ)              SITE 2 (DR - Remote DC)        │   │   │
│   │   │   ═════════════════════              ════════════════════════       │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌──────────────────┐               ┌──────────────────┐           │   │   │
│   │   │   │ CLUSTER MANAGER  │               │ (Standby CM)     │           │   │   │
│   │   │   │ (cm1.retail.com) │◀─────────────▶│                  │           │   │   │
│   │   │   └──────────────────┘               └──────────────────┘           │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────┐ ┌─────┐ ┌─────┐            ┌─────┐ ┌─────┐ ┌─────┐       │   │   │
│   │   │   │IDX-1│ │IDX-2│ │IDX-3│◀──────────▶│IDX-4│ │IDX-5│ │IDX-6│       │   │   │
│   │   │   └─────┘ └─────┘ └─────┘  Replicate └─────┘ └─────┘ └─────┘       │   │   │
│   │   │                                                                     │   │   │
│   │   │   Each indexer:                      Each indexer:                  │   │   │
│   │   │   • 16 vCPU, 64 GB RAM               • 16 vCPU, 64 GB RAM          │   │   │
│   │   │   • 20 TB storage (NVMe)             • 20 TB storage               │   │   │
│   │   │                                                                     │   │   │
│   │   │   RF=2 (origin:1, total:2)                                          │   │   │
│   │   │   SF=2 (origin:1, total:2)                                          │   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                  │                                                          │   │
│   │                  ▼                                                          │   │
│   │   SEARCH HEAD CLUSTER                                                       │   │
│   │   ═══════════════════                                                       │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────┐   ┌─────────┐   ┌─────────┐                          │   │   │
│   │   │   │  SH-1   │   │  SH-2   │   │  SH-3   │     ┌──────────────┐     │   │   │
│   │   │   │(Captain)│   │         │   │         │     │   DEPLOYER   │     │   │   │
│   │   │   └────┬────┘   └────┬────┘   └────┬────┘◀────│              │     │   │   │
│   │   │        │             │             │          │  • ES App    │     │   │   │
│   │   │        └─────────────┼─────────────┘          │  • TAs       │     │   │   │
│   │   │                      │                        │  • Lookups   │     │   │   │
│   │   │           ┌──────────▼──────────┐             └──────────────┘     │   │   │
│   │   │           │    LOAD BALANCER    │                                  │   │   │
│   │   │           │    (F5 BigIP)       │                                  │   │   │
│   │   │           └─────────────────────┘                                  │   │   │
│   │   │                      │                                              │   │   │
│   │   │        ┌─────────────┼─────────────┐                               │   │   │
│   │   │        ▼             ▼             ▼                               │   │   │
│   │   │   ┌─────────┐   ┌─────────┐   ┌─────────┐                          │   │   │
│   │   │   │ SOC     │   │ Fraud   │   │ IT Ops  │                          │   │   │
│   │   │   │ Analyst │   │ Team    │   │ Team    │                          │   │   │
│   │   │   └─────────┘   └─────────┘   └─────────┘                          │   │   │
│   │   │                                                                     │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   │   MANAGEMENT                                                                │   │
│   │   ══════════                                                                │   │
│   │   ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐          │   │
│   │   │ DEPLOYMENT SVR  │   │ LICENSE MASTER  │   │ MONITORING      │          │   │
│   │   │ • 3,500 UFs     │   │ • 5 TB/day      │   │ CONSOLE         │          │   │
│   │   │ • Server classes│   │   license       │   │ • Platform      │          │   │
│   │   │ • App deploy    │   │ • Usage reports │   │   health        │          │   │
│   │   └─────────────────┘   └─────────────────┘   └─────────────────┘          │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
│   DAILY INGESTION: ~5 TB/day                                                         │
│   ══════════════════════════                                                         │
│   • POS transactions:      2.0 TB (500 stores × 4 GB avg)                            │
│   • Endpoint (UF):         1.0 TB (3,500 servers/workstations)                       │
│   • Network/firewall:      1.0 TB (500 store FWs + DC)                               │
│   • E-commerce platform:   0.5 TB (web logs, API, CDN)                               │
│   • Identity/Access:       0.3 TB (AD, PAM, badge systems)                           │
│   • Security tools:        0.2 TB (EDR, DLP, email security)                         │
│                                                                                      │
│   STORAGE: 120 TB total (6 indexers × 20 TB)                                         │
│   RETENTION: 90 days hot/warm, 1 year frozen (PCI compliance)                        │
│                                                                                      │
│   ESTIMATED ANNUAL COST: ~$2.5M                                                      │
│   (5 TB/day license + infrastructure + support)                                      │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>

                <h4>Key Design Decisions</h4>
                <ul>
                    <li><strong>PCI-DSS data masking:</strong> Heavy Forwarders mask credit card data (SEDCMD) before indexing</li>
                    <li><strong>Multisite cluster:</strong> Automatic DR failover, data replicated to secondary site</li>
                    <li><strong>Store HF buffering:</strong> Large stores have local HF to handle WAN outages</li>
                    <li><strong>Index segregation:</strong> Separate indexes for POS, network, security (RBAC + retention)</li>
                    <li><strong>SmartStore:</strong> Enabled for cold data tier to reduce storage costs</li>
                </ul>

                <h4>PCI-DSS Correlation Searches</h4>
                <div class="arch-diagram">
Enterprise Security Correlation Searches (Custom):
├── PCI-001: Credit card data in clear text (regex in non-PCI index)
├── PCI-002: POS system accessed from non-POS network segment
├── PCI-003: After-hours POS refund transactions
├── PCI-004: POS malware indicators (RAM scraper signatures)
├── PCI-005: Unauthorized POS software installation
├── PCI-006: PCI segment firewall rule change
├── PCI-007: Excessive card declines (card testing attack)
└── PCI-008: Admin access to POS systems outside change window

Risk-Based Alerting:
├── High-value transaction anomaly (+10 risk per event)
├── Employee discount abuse pattern (+25 risk per day)
├── Gift card fraud indicators (+30 risk per event)
└── Return fraud pattern detection (+20 risk per event)
                </div>
            </div>

            <!-- Example 2: Manufacturing -->
            <div class="config-section">
                <h3>🏭 Case Study: IndustrialTech Manufacturing (12,000 Employees)</h3>
                
                <div class="info-box">
                    <h4>Company Profile</h4>
                    <p><strong>Industry:</strong> Manufacturing | <strong>Employees:</strong> 12,000 | <strong>Sites:</strong> 8 factories + HQ | <strong>OT/ICS:</strong> Yes | <strong>Compliance:</strong> NIST CSF</p>
                </div>

                <h4>IT/OT Converged Architecture</h4>
                <div class="arch-diagram">
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                 INDUSTRIALTECH - SPLUNK IT/OT DEPLOYMENT                            │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│   FACTORY FLOOR (OT Network - Air-Gapped)                                            │
│   ═══════════════════════════════════════                                            │
│                                                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │   LEVEL 0-2: INDUSTRIAL CONTROL SYSTEMS                                     │   │
│   │   ═════════════════════════════════════                                     │   │
│   │                                                                             │   │
│   │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐   │   │
│   │   │     PLCs     │  │    HMIs      │  │    SCADA     │  │  Historians  │   │   │
│   │   │  ──────────  │  │  ──────────  │  │  ──────────  │  │  ──────────  │   │   │
│   │   │ • Rockwell   │  │ • Operator   │  │ • Ignition   │  │ • OSIsoft PI │   │   │
│   │   │ • Siemens    │  │   stations   │  │ • Wonderware │  │ • AspenTech  │   │   │
│   │   │ • ABB        │  │ • No agents! │  │              │  │              │   │   │
│   │   └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘   │   │
│   │          │                 │                 │                 │            │   │
│   │          └─────────────────┼─────────────────┼─────────────────┘            │   │
│   │                            │                 │                              │   │
│   │                            ▼                 ▼                              │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                     OT SECURITY STACK                               │   │
│   │   │                     ════════════════════                            │   │
│   │   │                                                                     │   │
│   │   │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐    │   │
│   │   │   │ Claroty/Nozomi  │  │  OT Firewall    │  │  Network TAP    │    │   │
│   │   │   │ (OT NDR)        │  │  (Palo Alto)    │  │  (Gigamon)      │    │   │
│   │   │   │ • Asset disco-  │  │  • IT/OT segmen-│  │  • Full packet  │    │   │
│   │   │   │   very          │  │    tation       │  │    capture      │    │   │
│   │   │   │ • Anomaly det.  │  │  • Allow-list   │  │  • ICS protocol │    │   │
│   │   │   │ • ICS protocols │  │    rules only   │  │    decode       │    │   │
│   │   │   └────────┬────────┘  └────────┬────────┘  └────────┬────────┘    │   │
│   │   │            │                    │                    │             │   │
│   │   └────────────┼────────────────────┼────────────────────┼─────────────┘   │   │
│   │                │                    │                    │                  │   │
│   │                ▼                    ▼                    ▼                  │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                     OT DMZ (Level 3.5)                              │   │   │
│   │   │                     ══════════════════                              │   │   │
│   │   │                                                                     │   │   │
│   │   │   ┌─────────────────────────────────────────────────────────────┐   │   │
│   │   │   │              SPLUNK HEAVY FORWARDER                         │   │   │
│   │   │   │              ══════════════════════                         │   │   │
│   │   │   │                                                             │   │   │
│   │   │   │   • Air-gapped from corporate                               │   │   │
│   │   │   │   • Receives: Claroty alerts, OT FW logs, historian data    │   │   │
│   │   │   │   • Forwards via DATA DIODE (one-way) to corporate Splunk   │   │   │
│   │   │   │   • NO return traffic to OT network                         │   │   │
│   │   │   │                                                             │   │   │
│   │   │   │   Specs: 8 vCPU, 32 GB RAM, 500 GB local buffer             │   │   │
│   │   │   │                                                             │   │   │
│   │   │   └─────────────────────────────────────────────────────────────┘   │   │
│   │   │                              │                                      │   │
│   │   │                              │ DATA DIODE                           │   │
│   │   │                              │ (Waterfall, Owl)                     │   │
│   │   │                              │ One-way only ↓                       │   │
│   │   │                              ▼                                      │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                       │
│                                              ▼                                       │
│   ┌─────────────────────────────────────────────────────────────────────────────┐   │
│   │                         CORPORATE IT NETWORK                                │   │
│   │                         ════════════════════                                │   │
│   │                                                                             │   │
│   │   STANDARD IT SOURCES              SPLUNK INFRASTRUCTURE                    │   │
│   │   ════════════════════             ══════════════════════                   │   │
│   │                                                                             │   │
│   │   ┌─────────────────┐             ┌─────────────────────────────────────┐   │   │
│   │   │ Endpoints       │             │         INDEXER CLUSTER             │   │   │
│   │   │ • 10,000 Windows│             │         ════════════════            │   │   │
│   │   │ • 2,000 Linux   │             │                                     │   │   │
│   │   └────────┬────────┘             │   ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐  │   │   │
│   │            │                      │   │IDX-1│ │IDX-2│ │IDX-3│ │IDX-4│  │   │   │
│   │   ┌────────▼────────┐             │   └─────┘ └─────┘ └─────┘ └─────┘  │   │   │
│   │   │ Universal Fwdrs │─────────────│                                     │   │   │
│   │   └─────────────────┘             │   INDEX STRUCTURE:                  │   │   │
│   │                                   │   • idx_ot_scada (OT logs)          │   │   │
│   │   ┌─────────────────┐             │   • idx_ot_network (OT firewall)    │   │   │
│   │   │ Network/Security│             │   • idx_security (IT security)      │   │   │
│   │   │ • Firewalls     │             │   • idx_network (IT network)        │   │   │
│   │   │ • IDS/IPS       │             │   • idx_endpoint (IT endpoints)     │   │   │
│   │   │ • Email gateway │             │                                     │   │   │
│   │   └────────┬────────┘             └─────────────────────────────────────┘   │   │
│   │            │                                     │                          │   │
│   │   ┌────────▼────────┐             ┌──────────────▼──────────────┐          │   │
│   │   │ Heavy Forwarders│─────────────│     SEARCH HEAD CLUSTER     │          │   │
│   │   │ (Syslog recv)   │             │     ════════════════════    │          │   │
│   │   └─────────────────┘             │                             │          │   │
│   │                                   │   ┌─────┐ ┌─────┐ ┌─────┐   │          │   │
│   │   ┌─────────────────┐             │   │SH-1 │ │SH-2 │ │SH-3 │   │          │   │
│   │   │ Cloud Services  │             │   └─────┘ └─────┘ └─────┘   │          │   │
│   │   │ • Azure AD      │             │                             │          │   │
│   │   │ • O365          │─────────────│   APPS INSTALLED:           │          │   │
│   │   │ • AWS (limited) │             │   • Enterprise Security     │          │   │
│   │   └─────────────────┘             │   • Splunk OT Security      │          │   │
│   │                                   │   • MITRE ATT&CK for ICS    │          │   │
│   │                                   │                             │          │   │
│   │                                   └─────────────────────────────┘          │   │
│   │                                                                             │   │
│   └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                      │
│   DAILY INGESTION: ~2 TB/day                                                         │
│   ══════════════════════════                                                         │
│   • IT Endpoints:          600 GB                                                    │
│   • IT Network/Security:   500 GB                                                    │
│   • OT SCADA/Historian:    300 GB (via data diode)                                   │
│   • OT Network (Claroty):  400 GB                                                    │
│   • Cloud/SaaS:            200 GB                                                    │
│                                                                                      │
│   OT-SPECIFIC DETECTIONS:                                                            │
│   • ICS protocol anomaly (Modbus, DNP3, EtherNet/IP)                                │
│   • PLC program change outside change window                                         │
│   • HMI login from unexpected source                                                 │
│   • Safety system modification                                                       │
│   • Historian query from non-engineering workstation                                 │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
                </div>

                <h4>OT Security Considerations</h4>
                <ul>
                    <li><strong>Data diode:</strong> One-way data flow from OT to IT, no return path</li>
                    <li><strong>No agents on ICS:</strong> OT devices monitored via network traffic analysis only</li>
                    <li><strong>OT-specific TAs:</strong> Splunk Add-on for OT Security, Claroty TA, Nozomi TA</li>
                    <li><strong>MITRE ATT&CK for ICS:</strong> Detection rules mapped to ICS-specific techniques</li>
                    <li><strong>Separate indexes:</strong> OT data in dedicated indexes with restricted access</li>
                </ul>
            </div>

            <!-- Sizing and Cost -->
            <h2><i class="fas fa-calculator"></i> Sizing Guidelines</h2>

            <div class="config-section">
                <h3>Component Sizing Reference</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Daily Volume</th>
                            <th>Indexers</th>
                            <th>Search Heads</th>
                            <th>Heavy Fwdrs</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt;100 GB</td>
                            <td>1-2 (single)</td>
                            <td>1</td>
                            <td>1-2</td>
                        </tr>
                        <tr>
                            <td>100-500 GB</td>
                            <td>3-4 (cluster)</td>
                            <td>2-3 (SHC)</td>
                            <td>2-4</td>
                        </tr>
                        <tr>
                            <td>500 GB - 2 TB</td>
                            <td>4-8 (cluster)</td>
                            <td>3 (SHC)</td>
                            <td>4-8</td>
                        </tr>
                        <tr>
                            <td>2-5 TB</td>
                            <td>6-12 (multisite)</td>
                            <td>3-5 (SHC)</td>
                            <td>8-16</td>
                        </tr>
                        <tr>
                            <td>&gt;5 TB</td>
                            <td>12+ (multisite)</td>
                            <td>5+ (SHC)</td>
                            <td>16+</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Interview Q&A -->
            <h2><i class="fas fa-comments"></i> Interview Questions</h2>

            <div class="qa-section">
                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: Explain the difference between Universal Forwarder and Heavy Forwarder.</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Universal Forwarder is lightweight (~20MB RAM) and does minimal processing - it just collects logs and forwards them. It cannot parse, transform, or route data. Heavy Forwarder is a full Splunk instance that can parse logs (props.conf/transforms.conf), route to different destinations, mask sensitive data, and run searches. I use UF for standard collection from endpoints and servers, HF for syslog aggregation, data masking requirements (like PCI-DSS), and when I need to pre-process data before indexing."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: What are Search Factor and Replication Factor?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "Replication Factor (RF) is how many copies of raw data exist across the cluster - RF=2 means every bucket exists on 2 indexers. Search Factor (SF) is how many searchable copies exist - SF=2 means you can search data even if one indexer is down. SF must always be less than or equal to RF. For production, I typically recommend RF=3, SF=2 for single-site, and for multisite clusters: site_replication_factor=origin:1,total:2 meaning 1 copy at primary, 2 total copies across sites."</p>
                    </div>
                </div>

                <div class="qa-item">
                    <button class="qa-question"><i class="fas fa-lightbulb"></i> Q: How would you design Splunk for a company with 500 retail stores?</button>
                    <div class="qa-answer">
                        <p><strong>A:</strong> "I'd design a hub-and-spoke model: Universal Forwarders on POS systems at each store forwarding to either a local Heavy Forwarder (for large stores needing buffering during WAN outages and PCI data masking) or directly to HQ (small stores). At HQ, I'd have Heavy Forwarder pairs for receiving and processing, then an indexer cluster with multisite replication to a DR site. Critical for retail: PCI-DSS compliance means masking card data at the Heavy Forwarder before indexing using SEDCMD in transforms.conf. I'd separate indexes by data type for different retention requirements and RBAC."</p>
                    </div>
                </div>
            </div>
            </main>
        </div>
    </div>
    
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainWrapper = document.getElementById('mainWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainWrapper.classList.toggle('expanded');
            }
        }
        
        // Q&A toggle
        document.querySelectorAll('.qa-question').forEach(btn => {
            btn.addEventListener('click', () => {
                const answer = btn.nextElementSibling;
                const isOpen = answer.style.display === 'block';
                document.querySelectorAll('.qa-answer').forEach(a => a.style.display = 'none');
                if (!isOpen) answer.style.display = 'block';
            });
        });
        
        // Close sidebar on resize
        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        });
    </script>
</body>
</html>